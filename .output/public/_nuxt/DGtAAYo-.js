import{e as ke,f as we,r as u,i as U,N as ae,c as o,b as Ce,a as t,j as i,h as y,O as se,F as C,k as _,n as ne,l as x,t as l,v as re,P as _e,d as Oe,o as n,Q as Se,J as Pe}from"./DGuyXcn4.js";import{H as Ue}from"./BIONW9Jj.js";import{S as oe}from"./BAXhlMnO.js";import"./DlAUqK2U.js";const De={class:"flex flex-col min-h-screen"},Ve={class:"flex-1 bg-[ffffff] dark:bg-[ffffff] py-8 px-6 md:px-8"},qe={class:"max-w-3xl mx-auto grid gap-8"},Te={key:0,class:"bg-white dark:bg-[#10673b] rounded-lg shadow p-6"},Ee={key:0},Ne={class:"mb-4"},Ae=["value"],Ie={class:"mb-4"},Re=["disabled"],je=["value"],Be={key:2,class:"mt-4 dark:text-white"},Fe=["onClick"],Ge={class:"font-bold"},Me={class:"text-blue-500"},$e={key:1,class:"bg-white dark:bg-gray-900 rounded-lg shadow p-6"},Je={class:"mb-4"},Le={key:0,class:"text-red-500 mt-2"},He={class:"block text-gray-700 dark:text-gray-300 mb-2"},Qe=["disabled"],ze={class:"mb-4"},Ye={class:"block text-gray-700 dark:text-gray-300 mb-2"},Ke={class:"mb-4 text-gray-700 dark:text-gray-300"},We=["for"],Xe=["onUpdate:modelValue","id","type","pattern","disabled"],Ze={class:"block text-gray-500 dark:text-gray-400"},et=["disabled"],lt={__name:"donate",setup(tt){const D=ke(),{state:c,setOffering:le,createExchange:ie,formatAmount:de,deductAmount:at,filterOfferings:ue,satisfiesOfferingRequirements:ce,getOfferingById:fe}=we(),h=u(1),v=u(""),k=u(""),O=u(!1),s=u(null),d=u(""),S=u(""),b=u({}),P=u([]),m=U(()=>!ce(s.value,c.customerCredentials)),pe=U(()=>c.payinCurrencies.length==0),V=u(!1);ae(v,()=>{T()}),ae(pe,()=>{he()});const q=U(()=>{var f,g;if(!s.value||!s.value.data.payin.max||!s.value.data.payin.min)return!0;const r=(f=s.value)==null?void 0:f.data.payin.min,e=(g=s.value)==null?void 0:g.data.payin.max;return d.value>=r&&d.value<=e}),T=()=>{if(v.value){const r=c.offerings.filter(f=>f.data.payin.currencyCode===v.value),e=new Set;r.forEach(f=>{e.add(f.data.payout.currencyCode)}),c.payoutCurrencies=Array.from(e),O.value=!0}else c.payoutCurrencies=[],O.value=!1},ve=()=>{v.value&&k.value&&(P.value=ue(v.value,k.value))},be=r=>{s.value=r,le(r),xe(),h.value=2},me=()=>{d.value&&s.value&&(S.value=de(d.value*s.value.data.payoutUnitsPerPayinUnit))},ge=()=>{if(!d.value){alert("Please enter the amount.");return}for(const r in s.value.data.payout.methods[0].requiredPaymentDetails.properties){if(!b.value[r]){alert(`Please enter ${s.value.data.payout.methods[0].requiredPaymentDetails.properties[r].title}.`);return}const e=s.value.data.payout.methods[0].requiredPaymentDetails.properties[r].pattern;if(e&&!b.value[r].match(e)){alert(`Please enter a valid ${s.value.data.payout.methods[0].requiredPaymentDetails.properties[r].title}.`);return}}ye()},ye=async()=>{V.value=!0,await ie(s.value,d.value,b.value),D.push("/")},xe=()=>{m.value&&(localStorage.setItem("selectedOffering",JSON.stringify(s.value)),D.push("/credentials"))},he=()=>{if(localStorage.getItem("selectedOffering")){const r=JSON.parse(localStorage.getItem("selectedOffering"));s.value=fe(r.metadata.id),localStorage.removeItem("selectedOffering"),h.value=2}};return(r,e)=>{var f,g,E,N,A,I,R,j,B,F,G,M,$,J,L,H,Q,z,Y,K,W,X,Z,ee,te;return n(),o("div",De,[Ce(Ue),t("main",Ve,[t("div",qe,[h.value===1?(n(),o("div",Te,[e[10]||(e[10]=t("h2",{class:"text-2xl font-bold mb-4 dark:text-white"},"Donate Funds",-1)),i(c).payinCurrencies.length?(n(),o("div",Ee,[t("div",Ne,[e[6]||(e[6]=t("label",{class:"block text-gray-700 dark:text-gray-300 mb-2"},"From Currency",-1)),y(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>v.value=a),onChange:T,class:"w-full p-2 border rounded"},[e[5]||(e[5]=t("option",{disabled:"",value:""},"Select currency",-1)),(n(!0),o(C,null,_(i(c).payinCurrencies,a=>(n(),o("option",{key:a,value:a},l(a),9,Ae))),128))],544),[[se,v.value]])]),t("div",Ie,[e[8]||(e[8]=t("label",{class:"block text-gray-700 dark:text-gray-300 mb-2"},"To Currency",-1)),y(t("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>k.value=a),disabled:!O.value,class:"w-full p-2 border rounded"},[e[7]||(e[7]=t("option",{disabled:"",value:""},"Select currency",-1)),(n(!0),o(C,null,_(i(c).payoutCurrencies,a=>(n(),o("option",{key:a,value:a},l(a),9,je))),128))],8,Re),[[se,k.value]])]),t("button",{onClick:ve,class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 disabled:bg-gray-800 dark:text-white border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"}," Get Offerings ")])):(n(),ne(oe,{key:1})),P.value.length?(n(),o("div",Be,[e[9]||(e[9]=t("h2",{class:"text-2xl font-bold mb-4"},"Exchange Rate Offerings",-1)),t("ul",null,[(n(!0),o(C,null,_(P.value,a=>{var p;return n(),o("li",{key:a.id,onClick:w=>be(a),class:"cursor-pointer p-4 border rounded mb-2 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors"},[t("h3",Ge,l((p=i(c).pfiAllowlist.find(w=>w.pfiUri===a.metadata.from))==null?void 0:p.pfiName),1),t("p",null,l(a.data.description),1),t("p",Me,l(a.data.payoutUnitsPerPayinUnit)+" "+l(a.data.payout.currencyCode)+" for 1 "+l(a.data.payin.currencyCode),1)],8,Fe)}),128))])])):x("",!0)])):x("",!0),h.value===2?(n(),o("div",$e,[e[11]||(e[11]=t("h2",{class:"text-2xl font-bold mb-4 dark:text-white"},"Enter Transaction Details",-1)),t("div",Je,[!i(q)&&d.value!==""?(n(),o("p",Le," Amount must be between "+l((E=(g=(f=s.value)==null?void 0:f.data)==null?void 0:g.payin)==null?void 0:E.min)+" and "+l((I=(A=(N=s.value)==null?void 0:N.data)==null?void 0:A.payin)==null?void 0:I.max),1)):x("",!0),t("label",He,"You Send ("+l((B=(j=(R=s.value)==null?void 0:R.data)==null?void 0:j.payin)==null?void 0:B.currencyCode)+")",1),y(t("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>d.value=a),onInput:me,type:"number",required:"",class:_e(["w-full p-2 border rounded disabled:bg-slate-200",{"border-red-500":!i(q)&&d.value!==""}]),disabled:i(m)},null,42,Qe),[[re,d.value]])]),t("div",ze,[t("label",Ye,"They Get ("+l((M=(G=(F=s.value)==null?void 0:F.data)==null?void 0:G.payout)==null?void 0:M.currencyCode)+")",1),y(t("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>S.value=a),type:"number",disabled:"",class:"w-full p-2 border rounded disabled:bg-slate-200"},null,512),[[re,S.value]])]),t("div",Ke," Exchange Rate: "+l((J=($=s.value)==null?void 0:$.data)==null?void 0:J.payoutUnitsPerPayinUnit)+" "+l((Q=(H=(L=s.value)==null?void 0:L.data)==null?void 0:H.payout)==null?void 0:Q.currencyCode)+" for 1 "+l((K=(Y=(z=s.value)==null?void 0:z.data)==null?void 0:Y.payin)==null?void 0:K.currencyCode),1),(n(!0),o(C,null,_((te=(ee=(Z=(X=(W=s.value)==null?void 0:W.data)==null?void 0:X.payout)==null?void 0:Z.methods[0])==null?void 0:ee.requiredPaymentDetails)==null?void 0:te.properties,(a,p)=>(n(),o("div",{key:p,class:"mb-4"},[t("label",{for:p,class:"block text-gray-700 dark:text-gray-300 mb-2"},l(a.title),9,We),y(t("input",{"onUpdate:modelValue":w=>b.value[p]=w,id:p,type:a.type,pattern:a.pattern,required:"",class:"w-full p-2 border rounded disabled:bg-slate-200",disabled:i(m)},null,8,Xe),[[Se,b.value[p]]]),t("small",Ze,l(a.description),1)]))),128)),e[12]||(e[12]=t("p",{class:"text-xs text-green-400 mb-2 flex"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"green","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"h-5 w-5"},[t("path",{d:"M20 6 9 17l-5-5"})]),Oe(" Required credentials available. ")],-1)),i(m)?(n(),o("button",{key:0,class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 disabled:bg-slate-400 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2 mr-2 dark:text-white",onClick:e[4]||(e[4]=a=>("navigateTo"in r?r.navigateTo:i(Pe))("/credentials"))},"Verify Identity")):x("",!0),V.value?(n(),ne(oe,{key:2})):(n(),o("button",{key:1,onClick:ge,class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 disabled:bg-slate-400 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2 dark:text-white",disabled:i(m)}," Request for Quote ",8,et))])):x("",!0)])])])}}};export{lt as default};
