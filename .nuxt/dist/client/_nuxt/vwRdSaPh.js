const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./poMTNPwX.js","./BDp76w7U.js","./DlAUqK2U.js","./CDAHeyLu.js","./Cx2pMvRd.js","./BVHvhCMQ.js","./Spinner.-d7mfuZZ.css","./dashboard.D3rqu6o3.css","./fa5uTXjd.js","./BDw1-wBm.js","./C3M34awQ.js","./error-404.DXySnQZL.css","./Bvm2D7oQ.js","./error-500.CIkJDsQj.css"])))=>i.map(i=>d[i]);
var PG=Object.defineProperty;var CG=(t,e,r)=>e in t?PG(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Se=(t,e,r)=>CG(t,typeof e!="symbol"?e+"":e,r);/**
* @vue/shared v3.5.4
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function vC(t){const e=Object.create(null);for(const r of t.split(","))e[r]=1;return r=>r in e}const qr={},Lm=[],Nu=()=>{},IG=()=>!1,Tw=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),wC=t=>t.startsWith("onUpdate:"),Wn=Object.assign,_C=(t,e)=>{const r=t.indexOf(e);r>-1&&t.splice(r,1)},kG=Object.prototype.hasOwnProperty,Dr=(t,e)=>kG.call(t,e),dt=Array.isArray,Km=t=>jy(t)==="[object Map]",My=t=>jy(t)==="[object Set]",m5=t=>jy(t)==="[object Date]",$G=t=>jy(t)==="[object RegExp]",Pt=t=>typeof t=="function",an=t=>typeof t=="string",zu=t=>typeof t=="symbol",Mr=t=>t!==null&&typeof t=="object",H3=t=>(Mr(t)||Pt(t))&&Pt(t.then)&&Pt(t.catch),z3=Object.prototype.toString,jy=t=>z3.call(t),OG=t=>jy(t).slice(8,-1),W3=t=>jy(t)==="[object Object]",bC=t=>an(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Vm=vC(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),DA=t=>{const e=Object.create(null);return r=>e[r]||(e[r]=t(r))},RG=/-(\w)/g,Ka=DA(t=>t.replace(RG,(e,r)=>r?r.toUpperCase():"")),NG=/\B([A-Z])/g,$p=DA(t=>t.replace(NG,"-$1").toLowerCase()),xA=DA(t=>t.charAt(0).toUpperCase()+t.slice(1)),u2=DA(t=>t?`on${xA(t)}`:""),df=(t,e)=>!Object.is(t,e),qm=(t,...e)=>{for(let r=0;r<t.length;r++)t[r](...e)},G3=(t,e,r,n=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:n,value:r})},rE=t=>{const e=parseFloat(t);return isNaN(e)?t:e},J3=t=>{const e=an(t)?Number(t):NaN;return isNaN(e)?t:e};let y5;const X3=()=>y5||(y5=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function PA(t){if(dt(t)){const e={};for(let r=0;r<t.length;r++){const n=t[r],s=an(n)?jG(n):PA(n);if(s)for(const i in s)e[i]=s[i]}return e}else if(an(t)||Mr(t))return t}const BG=/;(?![^(]*\))/g,FG=/:([^]+)/,MG=/\/\*[^]*?\*\//g;function jG(t){const e={};return t.replace(MG,"").split(BG).forEach(r=>{if(r){const n=r.split(FG);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function CA(t){let e="";if(an(t))e=t;else if(dt(t))for(let r=0;r<t.length;r++){const n=CA(t[r]);n&&(e+=n+" ")}else if(Mr(t))for(const r in t)t[r]&&(e+=r+" ");return e.trim()}function UG(t){if(!t)return null;let{class:e,style:r}=t;return e&&!an(e)&&(t.class=CA(e)),r&&(t.style=PA(r)),t}const LG="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",KG=vC(LG);function Y3(t){return!!t||t===""}function VG(t,e){if(t.length!==e.length)return!1;let r=!0;for(let n=0;r&&n<t.length;n++)r=dp(t[n],e[n]);return r}function dp(t,e){if(t===e)return!0;let r=m5(t),n=m5(e);if(r||n)return r&&n?t.getTime()===e.getTime():!1;if(r=zu(t),n=zu(e),r||n)return t===e;if(r=dt(t),n=dt(e),r||n)return r&&n?VG(t,e):!1;if(r=Mr(t),n=Mr(e),r||n){if(!r||!n)return!1;const s=Object.keys(t).length,i=Object.keys(e).length;if(s!==i)return!1;for(const o in t){const a=t.hasOwnProperty(o),u=e.hasOwnProperty(o);if(a&&!u||!a&&u||!dp(t[o],e[o]))return!1}}return String(t)===String(e)}function EC(t,e){return t.findIndex(r=>dp(r,e))}const Z3=t=>!!(t&&t.__v_isRef===!0),qG=t=>an(t)?t:t==null?"":dt(t)||Mr(t)&&(t.toString===z3||!Pt(t.toString))?Z3(t)?qG(t.value):JSON.stringify(t,Q3,2):String(t),Q3=(t,e)=>Z3(e)?Q3(t,e.value):Km(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((r,[n,s],i)=>(r[c2(n,i)+" =>"]=s,r),{})}:My(e)?{[`Set(${e.size})`]:[...e.values()].map(r=>c2(r))}:zu(e)?c2(e):Mr(e)&&!dt(e)&&!W3(e)?String(e):e,c2=(t,e="")=>{var r;return zu(t)?`Symbol(${(r=t.description)!=null?r:e})`:t};/**
* @vue/reactivity v3.5.4
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ro;class e4{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=ro,!e&&ro&&(this.index=(ro.scopes||(ro.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,r;if(this.scopes)for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].pause();for(e=0,r=this.effects.length;e<r;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,r;if(this.scopes)for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].resume();for(e=0,r=this.effects.length;e<r;e++)this.effects[e].resume()}}run(e){if(this._active){const r=ro;try{return ro=this,e()}finally{ro=r}}}on(){ro=this}off(){ro=this.parent}stop(e){if(this._active){let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.scopes)for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function HG(t){return new e4(t)}function t4(){return ro}let Kr;const l2=new WeakSet;class r4{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.nextEffect=void 0,this.cleanup=void 0,this.scheduler=void 0,ro&&ro.active&&ro.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,l2.has(this)&&(l2.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||(this.flags|=8,this.nextEffect=W0,W0=this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,g5(this),i4(this);const e=Kr,r=Fa;Kr=this,Fa=!0;try{return this.fn()}finally{s4(this),Kr=e,Fa=r,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)TC(e);this.deps=this.depsTail=void 0,g5(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?l2.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){jD(this)&&this.run()}get dirty(){return jD(this)}}let n4=0,W0;function AC(){n4++}function SC(){if(--n4>0)return;let t;for(;W0;){let e=W0;for(W0=void 0;e;){const r=e.nextEffect;if(e.nextEffect=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){t||(t=n)}e=r}}if(t)throw t}function i4(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function s4(t){let e,r=t.depsTail;for(let n=r;n;n=n.prevDep)n.version===-1?(n===r&&(r=n.prevDep),TC(n),zG(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0;t.deps=e,t.depsTail=r}function jD(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&o4(e.dep.computed)||e.dep.version!==e.version)return!0;return!!t._dirty}function o4(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===Pv))return;t.globalVersion=Pv;const e=t.dep;if(t.flags|=2,e.version>0&&!t.isSSR&&!jD(t)){t.flags&=-3;return}const r=Kr,n=Fa;Kr=t,Fa=!0;try{i4(t);const s=t.fn(t._value);(e.version===0||df(s,t._value))&&(t._value=s,e.version++)}catch(s){throw e.version++,s}finally{Kr=r,Fa=n,s4(t),t.flags&=-3}}function TC(t){const{dep:e,prevSub:r,nextSub:n}=t;if(r&&(r.nextSub=n,t.prevSub=void 0),n&&(n.prevSub=r,t.nextSub=void 0),e.subs===t&&(e.subs=r),!e.subs&&e.computed){e.computed.flags&=-5;for(let s=e.computed.deps;s;s=s.nextDep)TC(s)}}function zG(t){const{prevDep:e,nextDep:r}=t;e&&(e.nextDep=r,t.prevDep=void 0),r&&(r.prevDep=e,t.nextDep=void 0)}let Fa=!0;const a4=[];function Af(){a4.push(Fa),Fa=!1}function Sf(){const t=a4.pop();Fa=t===void 0?!0:t}function g5(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const r=Kr;Kr=void 0;try{e()}finally{Kr=r}}}let Pv=0;class DC{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0}track(e){if(!Kr||!Fa||Kr===this.computed)return;let r=this.activeLink;if(r===void 0||r.sub!==Kr)r=this.activeLink={dep:this,sub:Kr,version:this.version,nextDep:void 0,prevDep:void 0,nextSub:void 0,prevSub:void 0,prevActiveLink:void 0},Kr.deps?(r.prevDep=Kr.depsTail,Kr.depsTail.nextDep=r,Kr.depsTail=r):Kr.deps=Kr.depsTail=r,Kr.flags&4&&u4(r);else if(r.version===-1&&(r.version=this.version,r.nextDep)){const n=r.nextDep;n.prevDep=r.prevDep,r.prevDep&&(r.prevDep.nextDep=n),r.prevDep=Kr.depsTail,r.nextDep=void 0,Kr.depsTail.nextDep=r,Kr.depsTail=r,Kr.deps===r&&(Kr.deps=n)}return r}trigger(e){this.version++,Pv++,this.notify(e)}notify(e){AC();try{for(let r=this.subs;r;r=r.prevSub)r.sub.notify()}finally{SC()}}}function u4(t){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)u4(n)}const r=t.dep.subs;r!==t&&(t.prevSub=r,r&&(r.nextSub=t)),t.dep.subs=t}const nE=new WeakMap,Hh=Symbol(""),UD=Symbol(""),Cv=Symbol("");function es(t,e,r){if(Fa&&Kr){let n=nE.get(t);n||nE.set(t,n=new Map);let s=n.get(r);s||n.set(r,s=new DC),s.track()}}function ol(t,e,r,n,s,i){const o=nE.get(t);if(!o){Pv++;return}const a=u=>{u&&u.trigger()};if(AC(),e==="clear")o.forEach(a);else{const u=dt(t),l=u&&bC(r);if(u&&r==="length"){const c=Number(n);o.forEach((d,h)=>{(h==="length"||h===Cv||!zu(h)&&h>=c)&&a(d)})}else switch(r!==void 0&&a(o.get(r)),l&&a(o.get(Cv)),e){case"add":u?l&&a(o.get("length")):(a(o.get(Hh)),Km(t)&&a(o.get(UD)));break;case"delete":u||(a(o.get(Hh)),Km(t)&&a(o.get(UD)));break;case"set":Km(t)&&a(o.get(Hh));break}}SC()}function WG(t,e){var r;return(r=nE.get(t))==null?void 0:r.get(e)}function Zp(t){const e=hr(t);return e===t?e:(es(e,"iterate",Cv),ea(t)?e:e.map(Yi))}function IA(t){return es(t=hr(t),"iterate",Cv),t}const GG={__proto__:null,[Symbol.iterator](){return d2(this,Symbol.iterator,Yi)},concat(...t){return Zp(this).concat(...t.map(e=>dt(e)?Zp(e):e))},entries(){return d2(this,"entries",t=>(t[1]=Yi(t[1]),t))},every(t,e){return fc(this,"every",t,e,void 0,arguments)},filter(t,e){return fc(this,"filter",t,e,r=>r.map(Yi),arguments)},find(t,e){return fc(this,"find",t,e,Yi,arguments)},findIndex(t,e){return fc(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return fc(this,"findLast",t,e,Yi,arguments)},findLastIndex(t,e){return fc(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return fc(this,"forEach",t,e,void 0,arguments)},includes(...t){return f2(this,"includes",t)},indexOf(...t){return f2(this,"indexOf",t)},join(t){return Zp(this).join(t)},lastIndexOf(...t){return f2(this,"lastIndexOf",t)},map(t,e){return fc(this,"map",t,e,void 0,arguments)},pop(){return gg(this,"pop")},push(...t){return gg(this,"push",t)},reduce(t,...e){return v5(this,"reduce",t,e)},reduceRight(t,...e){return v5(this,"reduceRight",t,e)},shift(){return gg(this,"shift")},some(t,e){return fc(this,"some",t,e,void 0,arguments)},splice(...t){return gg(this,"splice",t)},toReversed(){return Zp(this).toReversed()},toSorted(t){return Zp(this).toSorted(t)},toSpliced(...t){return Zp(this).toSpliced(...t)},unshift(...t){return gg(this,"unshift",t)},values(){return d2(this,"values",Yi)}};function d2(t,e,r){const n=IA(t),s=n[e]();return n!==t&&!ea(t)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=r(i.value)),i}),s}const JG=Array.prototype;function fc(t,e,r,n,s,i){const o=IA(t),a=o!==t&&!ea(t),u=o[e];if(u!==JG[e]){const d=u.apply(t,i);return a?Yi(d):d}let l=r;o!==t&&(a?l=function(d,h){return r.call(this,Yi(d),h,t)}:r.length>2&&(l=function(d,h){return r.call(this,d,h,t)}));const c=u.call(o,l,n);return a&&s?s(c):c}function v5(t,e,r,n){const s=IA(t);let i=r;return s!==t&&(ea(t)?r.length>3&&(i=function(o,a,u){return r.call(this,o,a,u,t)}):i=function(o,a,u){return r.call(this,o,Yi(a),u,t)}),s[e](i,...n)}function f2(t,e,r){const n=hr(t);es(n,"iterate",Cv);const s=n[e](...r);return(s===-1||s===!1)&&IC(r[0])?(r[0]=hr(r[0]),n[e](...r)):s}function gg(t,e,r=[]){Af(),AC();const n=hr(t)[e].apply(t,r);return SC(),Sf(),n}const XG=vC("__proto__,__v_isRef,__isVue"),c4=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(zu));function YG(t){zu(t)||(t=String(t));const e=hr(this);return es(e,"has",t),e.hasOwnProperty(t)}class l4{constructor(e=!1,r=!1){this._isReadonly=e,this._isShallow=r}get(e,r,n){const s=this._isReadonly,i=this._isShallow;if(r==="__v_isReactive")return!s;if(r==="__v_isReadonly")return s;if(r==="__v_isShallow")return i;if(r==="__v_raw")return n===(s?i?lJ:p4:i?h4:f4).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const o=dt(e);if(!s){let u;if(o&&(u=GG[r]))return u;if(r==="hasOwnProperty")return YG}const a=Reflect.get(e,r,ui(e)?e:n);return(zu(r)?c4.has(r):XG(r))||(s||es(e,"get",r),i)?a:ui(a)?o&&bC(r)?a:a.value:Mr(a)?s?m4(a):Sl(a):a}}class d4 extends l4{constructor(e=!1){super(!1,e)}set(e,r,n,s){let i=e[r];if(!this._isShallow){const u=ff(i);if(!ea(n)&&!ff(n)&&(i=hr(i),n=hr(n)),!dt(e)&&ui(i)&&!ui(n))return u?!1:(i.value=n,!0)}const o=dt(e)&&bC(r)?Number(r)<e.length:Dr(e,r),a=Reflect.set(e,r,n,ui(e)?e:s);return e===hr(s)&&(o?df(n,i)&&ol(e,"set",r,n):ol(e,"add",r,n)),a}deleteProperty(e,r){const n=Dr(e,r);e[r];const s=Reflect.deleteProperty(e,r);return s&&n&&ol(e,"delete",r,void 0),s}has(e,r){const n=Reflect.has(e,r);return(!zu(r)||!c4.has(r))&&es(e,"has",r),n}ownKeys(e){return es(e,"iterate",dt(e)?"length":Hh),Reflect.ownKeys(e)}}class ZG extends l4{constructor(e=!1){super(!0,e)}set(e,r){return!0}deleteProperty(e,r){return!0}}const QG=new d4,eJ=new ZG,tJ=new d4(!0);const xC=t=>t,kA=t=>Reflect.getPrototypeOf(t);function T_(t,e,r=!1,n=!1){t=t.__v_raw;const s=hr(t),i=hr(e);r||(df(e,i)&&es(s,"get",e),es(s,"get",i));const{has:o}=kA(s),a=n?xC:r?kC:Yi;if(o.call(s,e))return a(t.get(e));if(o.call(s,i))return a(t.get(i));t!==s&&t.get(e)}function D_(t,e=!1){const r=this.__v_raw,n=hr(r),s=hr(t);return e||(df(t,s)&&es(n,"has",t),es(n,"has",s)),t===s?r.has(t):r.has(t)||r.has(s)}function x_(t,e=!1){return t=t.__v_raw,!e&&es(hr(t),"iterate",Hh),Reflect.get(t,"size",t)}function w5(t,e=!1){!e&&!ea(t)&&!ff(t)&&(t=hr(t));const r=hr(this);return kA(r).has.call(r,t)||(r.add(t),ol(r,"add",t,t)),this}function _5(t,e,r=!1){!r&&!ea(e)&&!ff(e)&&(e=hr(e));const n=hr(this),{has:s,get:i}=kA(n);let o=s.call(n,t);o||(t=hr(t),o=s.call(n,t));const a=i.call(n,t);return n.set(t,e),o?df(e,a)&&ol(n,"set",t,e):ol(n,"add",t,e),this}function b5(t){const e=hr(this),{has:r,get:n}=kA(e);let s=r.call(e,t);s||(t=hr(t),s=r.call(e,t)),n&&n.call(e,t);const i=e.delete(t);return s&&ol(e,"delete",t,void 0),i}function E5(){const t=hr(this),e=t.size!==0,r=t.clear();return e&&ol(t,"clear",void 0,void 0),r}function P_(t,e){return function(n,s){const i=this,o=i.__v_raw,a=hr(o),u=e?xC:t?kC:Yi;return!t&&es(a,"iterate",Hh),o.forEach((l,c)=>n.call(s,u(l),u(c),i))}}function C_(t,e,r){return function(...n){const s=this.__v_raw,i=hr(s),o=Km(i),a=t==="entries"||t===Symbol.iterator&&o,u=t==="keys"&&o,l=s[t](...n),c=r?xC:e?kC:Yi;return!e&&es(i,"iterate",u?UD:Hh),{next(){const{value:d,done:h}=l.next();return h?{value:d,done:h}:{value:a?[c(d[0]),c(d[1])]:c(d),done:h}},[Symbol.iterator](){return this}}}}function Nl(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function rJ(){const t={get(i){return T_(this,i)},get size(){return x_(this)},has:D_,add:w5,set:_5,delete:b5,clear:E5,forEach:P_(!1,!1)},e={get(i){return T_(this,i,!1,!0)},get size(){return x_(this)},has:D_,add(i){return w5.call(this,i,!0)},set(i,o){return _5.call(this,i,o,!0)},delete:b5,clear:E5,forEach:P_(!1,!0)},r={get(i){return T_(this,i,!0)},get size(){return x_(this,!0)},has(i){return D_.call(this,i,!0)},add:Nl("add"),set:Nl("set"),delete:Nl("delete"),clear:Nl("clear"),forEach:P_(!0,!1)},n={get(i){return T_(this,i,!0,!0)},get size(){return x_(this,!0)},has(i){return D_.call(this,i,!0)},add:Nl("add"),set:Nl("set"),delete:Nl("delete"),clear:Nl("clear"),forEach:P_(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=C_(i,!1,!1),r[i]=C_(i,!0,!1),e[i]=C_(i,!1,!0),n[i]=C_(i,!0,!0)}),[t,r,e,n]}const[nJ,iJ,sJ,oJ]=rJ();function PC(t,e){const r=e?t?oJ:sJ:t?iJ:nJ;return(n,s,i)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?n:Reflect.get(Dr(r,s)&&s in n?r:n,s,i)}const aJ={get:PC(!1,!1)},uJ={get:PC(!1,!0)},cJ={get:PC(!0,!1)};const f4=new WeakMap,h4=new WeakMap,p4=new WeakMap,lJ=new WeakMap;function dJ(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function fJ(t){return t.__v_skip||!Object.isExtensible(t)?0:dJ(OG(t))}function Sl(t){return ff(t)?t:CC(t,!1,QG,aJ,f4)}function tl(t){return CC(t,!1,tJ,uJ,h4)}function m4(t){return CC(t,!0,eJ,cJ,p4)}function CC(t,e,r,n,s){if(!Mr(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=s.get(t);if(i)return i;const o=fJ(t);if(o===0)return t;const a=new Proxy(t,o===2?n:r);return s.set(t,a),a}function zh(t){return ff(t)?zh(t.__v_raw):!!(t&&t.__v_isReactive)}function ff(t){return!!(t&&t.__v_isReadonly)}function ea(t){return!!(t&&t.__v_isShallow)}function IC(t){return t?!!t.__v_raw:!1}function hr(t){const e=t&&t.__v_raw;return e?hr(e):t}function hJ(t){return!Dr(t,"__v_skip")&&Object.isExtensible(t)&&G3(t,"__v_skip",!0),t}const Yi=t=>Mr(t)?Sl(t):t,kC=t=>Mr(t)?m4(t):t;function ui(t){return t?t.__v_isRef===!0:!1}function Bu(t){return y4(t,!1)}function Iv(t){return y4(t,!0)}function y4(t,e){return ui(t)?t:new pJ(t,e)}class pJ{constructor(e,r){this.dep=new DC,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=r?e:hr(e),this._value=r?e:Yi(e),this.__v_isShallow=r}get value(){return this.dep.track(),this._value}set value(e){const r=this._rawValue,n=this.__v_isShallow||ea(e)||ff(e);e=n?e:hr(e),df(e,r)&&(this._rawValue=e,this._value=n?e:Yi(e),this.dep.trigger())}}function on(t){return ui(t)?t.value:t}const mJ={get:(t,e,r)=>e==="__v_raw"?t:on(Reflect.get(t,e,r)),set:(t,e,r,n)=>{const s=t[e];return ui(s)&&!ui(r)?(s.value=r,!0):Reflect.set(t,e,r,n)}};function g4(t){return zh(t)?t:new Proxy(t,mJ)}class yJ{constructor(e,r,n){this._object=e,this._key=r,this._defaultValue=n,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return WG(hr(this._object),this._key)}}class gJ{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function vJ(t,e,r){return ui(t)?t:Pt(t)?new gJ(t):Mr(t)&&arguments.length>1?wJ(t,e,r):Bu(t)}function wJ(t,e,r){const n=t[e];return ui(n)?n:new yJ(t,e,r)}class _J{constructor(e,r,n){this.fn=e,this.setter=r,this._value=void 0,this.dep=new DC(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Pv-1,this.effect=this,this.__v_isReadonly=!r,this.isSSR=n}notify(){this.flags|=16,Kr!==this&&this.dep.notify()}get value(){const e=this.dep.track();return o4(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function bJ(t,e,r=!1){let n,s;return Pt(t)?n=t:(n=t.get,s=t.set),new _J(n,s,r)}const I_={},iE=new WeakMap;let hh;function EJ(t,e=!1,r=hh){if(r){let n=iE.get(r);n||iE.set(r,n=[]),n.push(t)}}function AJ(t,e,r=qr){const{immediate:n,deep:s,once:i,scheduler:o,augmentJob:a,call:u}=r,l=v=>s?v:ea(v)||s===!1||s===0?Xc(v,1):Xc(v);let c,d,h,f,p=!1,m=!1;if(ui(t)?(d=()=>t.value,p=ea(t)):zh(t)?(d=()=>l(t),p=!0):dt(t)?(m=!0,p=t.some(v=>zh(v)||ea(v)),d=()=>t.map(v=>{if(ui(v))return v.value;if(zh(v))return l(v);if(Pt(v))return u?u(v,2):v()})):Pt(t)?e?d=u?()=>u(t,2):t:d=()=>{if(h){Af();try{h()}finally{Sf()}}const v=hh;hh=c;try{return u?u(t,3,[f]):t(f)}finally{hh=v}}:d=Nu,e&&s){const v=d,S=s===!0?1/0:s;d=()=>Xc(v(),S)}const E=t4(),A=()=>{c.stop(),E&&_C(E.effects,c)};if(i)if(e){const v=e;e=(...S)=>{v(...S),A()}}else{const v=d;d=()=>{v(),A()}}let _=m?new Array(t.length).fill(I_):I_;const g=v=>{if(!(!(c.flags&1)||!c.dirty&&!v))if(e){const S=c.run();if(s||p||(m?S.some((x,D)=>df(x,_[D])):df(S,_))){h&&h();const x=hh;hh=c;try{const D=[S,_===I_?void 0:m&&_[0]===I_?[]:_,f];u?u(e,3,D):e(...D),_=S}finally{hh=x}}}else c.run()};return a&&a(g),c=new r4(d),c.scheduler=o?()=>o(g,!1):g,f=v=>EJ(v,!1,c),h=c.onStop=()=>{const v=iE.get(c);if(v){if(u)u(v,4);else for(const S of v)S();iE.delete(c)}},e?n?g(!0):_=c.run():o?o(g.bind(null,!0),!0):c.run(),A.pause=c.pause.bind(c),A.resume=c.resume.bind(c),A.stop=A,A}function Xc(t,e=1/0,r){if(e<=0||!Mr(t)||t.__v_skip||(r=r||new Set,r.has(t)))return t;if(r.add(t),e--,ui(t))Xc(t.value,e,r);else if(dt(t))for(let n=0;n<t.length;n++)Xc(t[n],e,r);else if(My(t)||Km(t))t.forEach(n=>{Xc(n,e,r)});else if(W3(t)){for(const n in t)Xc(t[n],e,r);for(const n of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,n)&&Xc(t[n],e,r)}return t}/**
* @vue/runtime-core v3.5.4
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Dw(t,e,r,n){try{return n?t(...n):t()}catch(s){Uy(s,e,r)}}function Va(t,e,r,n){if(Pt(t)){const s=Dw(t,e,r,n);return s&&H3(s)&&s.catch(i=>{Uy(i,e,r)}),s}if(dt(t)){const s=[];for(let i=0;i<t.length;i++)s.push(Va(t[i],e,r,n));return s}}function Uy(t,e,r,n=!0){const s=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||qr;if(e){let a=e.parent;const u=e.proxy,l=`https://vuejs.org/error-reference/#runtime-${r}`;for(;a;){const c=a.ec;if(c){for(let d=0;d<c.length;d++)if(c[d](t,u,l)===!1)return}a=a.parent}if(i){Af(),Dw(i,null,10,[t,u,l]),Sf();return}}SJ(t,r,s,n,o)}function SJ(t,e,r,n=!0,s=!1){if(s)throw t;console.error(t)}let kv=!1,LD=!1;const ms=[];let mu=0;const Hm=[];let xd=null,vm=0;const v4=Promise.resolve();let $C=null;function Ly(t){const e=$C||v4;return t?e.then(this?t.bind(this):t):e}function TJ(t){let e=kv?mu+1:0,r=ms.length;for(;e<r;){const n=e+r>>>1,s=ms[n],i=$v(s);i<t||i===t&&s.flags&2?e=n+1:r=n}return e}function $A(t){if(!(t.flags&1)){const e=$v(t),r=ms[ms.length-1];!r||!(t.flags&2)&&e>=$v(r)?ms.push(t):ms.splice(TJ(e),0,t),t.flags|=1,w4()}}function w4(){!kv&&!LD&&(LD=!0,$C=v4.then(_4))}function KD(t){dt(t)?Hm.push(...t):xd&&t.id===-1?xd.splice(vm+1,0,t):t.flags&1||(Hm.push(t),t.flags|=1),w4()}function A5(t,e,r=kv?mu+1:0){for(;r<ms.length;r++){const n=ms[r];if(n&&n.flags&2){if(t&&n.id!==t.uid)continue;ms.splice(r,1),r--,n.flags&4&&(n.flags&=-2),n(),n.flags&=-2}}}function sE(t){if(Hm.length){const e=[...new Set(Hm)].sort((r,n)=>$v(r)-$v(n));if(Hm.length=0,xd){xd.push(...e);return}for(xd=e,vm=0;vm<xd.length;vm++){const r=xd[vm];r.flags&4&&(r.flags&=-2),r.flags&8||r(),r.flags&=-2}xd=null,vm=0}}const $v=t=>t.id==null?t.flags&2?-1:1/0:t.id;function _4(t){LD=!1,kv=!0;try{for(mu=0;mu<ms.length;mu++){const e=ms[mu];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Dw(e,e.i,e.i?15:14),e.flags&=-2)}}finally{for(;mu<ms.length;mu++){const e=ms[mu];e&&(e.flags&=-2)}mu=0,ms.length=0,sE(),kv=!1,$C=null,(ms.length||Hm.length)&&_4()}}let ys=null,b4=null;function oE(t){const e=ys;return ys=t,b4=t&&t.type.__scopeId||null,e}function E4(t,e=ys,r){if(!e||t._n)return t;const n=(...s)=>{n._d&&B5(-1);const i=oE(e);let o;try{o=t(...s)}finally{oE(i),n._d&&B5(1)}return o};return n._n=!0,n._c=!0,n._d=!0,n}function QRe(t,e){if(ys===null)return t;const r=MA(ys),n=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[i,o,a,u=qr]=e[s];i&&(Pt(i)&&(i={mounted:i,updated:i}),i.deep&&Xc(o),n.push({dir:i,instance:r,value:o,oldValue:void 0,arg:a,modifiers:u}))}return t}function vu(t,e,r,n){const s=t.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let u=a.dir[n];u&&(Af(),Va(u,r,8,[t.el,a,t,e]),Sf())}}const DJ=Symbol("_vte"),A4=t=>t.__isTeleport,Pd=Symbol("_leaveCb"),k_=Symbol("_enterCb");function xJ(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return RA(()=>{t.isMounted=!0}),NA(()=>{t.isUnmounting=!0}),t}const xo=[Function,Array],S4={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:xo,onEnter:xo,onAfterEnter:xo,onEnterCancelled:xo,onBeforeLeave:xo,onLeave:xo,onAfterLeave:xo,onLeaveCancelled:xo,onBeforeAppear:xo,onAppear:xo,onAfterAppear:xo,onAppearCancelled:xo},T4=t=>{const e=t.subTree;return e.component?T4(e.component):e},PJ={name:"BaseTransition",props:S4,setup(t,{slots:e}){const r=FA(),n=xJ();return()=>{const s=e.default&&P4(e.default(),!0);if(!s||!s.length)return;const i=D4(s),o=hr(t),{mode:a}=o;if(n.isLeaving)return h2(i);const u=S5(i);if(!u)return h2(i);let l=VD(u,o,n,r,h=>l=h);u.type!==si&&ay(u,l);const c=r.subTree,d=c&&S5(c);if(d&&d.type!==si&&!Ca(u,d)&&T4(r).type!==si){const h=VD(d,o,n,r);if(ay(d,h),a==="out-in"&&u.type!==si)return n.isLeaving=!0,h.afterLeave=()=>{n.isLeaving=!1,r.job.flags&8||r.update(),delete h.afterLeave},h2(i);a==="in-out"&&u.type!==si&&(h.delayLeave=(f,p,m)=>{const E=x4(n,d);E[String(d.key)]=d,f[Pd]=()=>{p(),f[Pd]=void 0,delete l.delayedLeave},l.delayedLeave=m})}return i}}};function D4(t){let e=t[0];if(t.length>1){for(const r of t)if(r.type!==si){e=r;break}}return e}const CJ=PJ;function x4(t,e){const{leavingVNodes:r}=t;let n=r.get(e.type);return n||(n=Object.create(null),r.set(e.type,n)),n}function VD(t,e,r,n,s){const{appear:i,mode:o,persisted:a=!1,onBeforeEnter:u,onEnter:l,onAfterEnter:c,onEnterCancelled:d,onBeforeLeave:h,onLeave:f,onAfterLeave:p,onLeaveCancelled:m,onBeforeAppear:E,onAppear:A,onAfterAppear:_,onAppearCancelled:g}=e,v=String(t.key),S=x4(r,t),x=(b,T)=>{b&&Va(b,n,9,T)},D=(b,T)=>{const P=T[1];x(b,T),dt(b)?b.every(C=>C.length<=1)&&P():b.length<=1&&P()},w={mode:o,persisted:a,beforeEnter(b){let T=u;if(!r.isMounted)if(i)T=E||u;else return;b[Pd]&&b[Pd](!0);const P=S[v];P&&Ca(t,P)&&P.el[Pd]&&P.el[Pd](),x(T,[b])},enter(b){let T=l,P=c,C=d;if(!r.isMounted)if(i)T=A||l,P=_||c,C=g||d;else return;let k=!1;const K=b[k_]=L=>{k||(k=!0,L?x(C,[b]):x(P,[b]),w.delayedLeave&&w.delayedLeave(),b[k_]=void 0)};T?D(T,[b,K]):K()},leave(b,T){const P=String(t.key);if(b[k_]&&b[k_](!0),r.isUnmounting)return T();x(h,[b]);let C=!1;const k=b[Pd]=K=>{C||(C=!0,T(),K?x(m,[b]):x(p,[b]),b[Pd]=void 0,S[P]===t&&delete S[P])};S[P]=t,f?D(f,[b,k]):k()},clone(b){const T=VD(b,e,r,n,s);return s&&s(T),T}};return w}function h2(t){if(xw(t))return t=fl(t),t.children=null,t}function S5(t){if(!xw(t))return A4(t.type)&&t.children?D4(t.children):t;const{shapeFlag:e,children:r}=t;if(r){if(e&16)return r[0];if(e&32&&Pt(r.default))return r.default()}}function ay(t,e){t.shapeFlag&6&&t.component?(t.transition=e,ay(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function P4(t,e=!1,r){let n=[],s=0;for(let i=0;i<t.length;i++){let o=t[i];const a=r==null?o.key:String(r)+String(o.key!=null?o.key:i);o.type===ao?(o.patchFlag&128&&s++,n=n.concat(P4(o.children,e,a))):(e||o.type!==si)&&n.push(a!=null?fl(o,{key:a}):o)}if(s>1)for(let i=0;i<n.length;i++)n[i].patchFlag=-2;return n}/*! #__NO_SIDE_EFFECTS__ */function Ky(t,e){return Pt(t)?Wn({name:t.name},e,{setup:t}):t}function OC(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function aE(t,e,r,n,s=!1){if(dt(t)){t.forEach((p,m)=>aE(p,e&&(dt(e)?e[m]:e),r,n,s));return}if(Wh(n)&&!s)return;const i=n.shapeFlag&4?MA(n.component):n.el,o=s?null:i,{i:a,r:u}=t,l=e&&e.r,c=a.refs===qr?a.refs={}:a.refs,d=a.setupState,h=hr(d),f=d===qr?()=>!1:p=>Dr(h,p);if(l!=null&&l!==u&&(an(l)?(c[l]=null,f(l)&&(d[l]=null)):ui(l)&&(l.value=null)),Pt(u))Dw(u,a,12,[o,c]);else{const p=an(u),m=ui(u);if(p||m){const E=()=>{if(t.f){const A=p?f(u)?d[u]:c[u]:u.value;s?dt(A)&&_C(A,i):dt(A)?A.includes(i)||A.push(i):p?(c[u]=[i],f(u)&&(d[u]=c[u])):(u.value=[i],t.k&&(c[t.k]=u.value))}else p?(c[u]=o,f(u)&&(d[u]=o)):m&&(u.value=o,t.k&&(c[t.k]=o))};o?(E.id=-1,xi(E,r)):E()}}}let T5=!1;const Qp=()=>{T5||(console.error("Hydration completed but contains mismatches."),T5=!0)},IJ=t=>t.namespaceURI.includes("svg")&&t.tagName!=="foreignObject",kJ=t=>t.namespaceURI.includes("MathML"),$_=t=>{if(t.nodeType===1){if(IJ(t))return"svg";if(kJ(t))return"mathml"}},Om=t=>t.nodeType===8;function $J(t){const{mt:e,p:r,o:{patchProp:n,createText:s,nextSibling:i,parentNode:o,remove:a,insert:u,createComment:l}}=t,c=(g,v)=>{if(!v.hasChildNodes()){r(null,g,v),sE(),v._vnode=g;return}d(v.firstChild,g,null,null,null),sE(),v._vnode=g},d=(g,v,S,x,D,w=!1)=>{w=w||!!v.dynamicChildren;const b=Om(g)&&g.data==="[",T=()=>m(g,v,S,x,D,b),{type:P,ref:C,shapeFlag:k,patchFlag:K}=v;let L=g.nodeType;v.el=g,K===-2&&(w=!1,v.dynamicChildren=null);let q=null;switch(P){case Xh:L!==3?v.children===""?(u(v.el=s(""),o(g),g),q=g):q=T():(g.data!==v.children&&(Qp(),g.data=v.children),q=i(g));break;case si:_(g)?(q=i(g),A(v.el=g.content.firstChild,g,S)):L!==8||b?q=T():q=i(g);break;case J0:if(b&&(g=i(g),L=g.nodeType),L===1||L===3){q=g;const se=!v.children.length;for(let X=0;X<v.staticCount;X++)se&&(v.children+=q.nodeType===1?q.outerHTML:q.data),X===v.staticCount-1&&(v.anchor=q),q=i(q);return b?i(q):q}else T();break;case ao:b?q=p(g,v,S,x,D,w):q=T();break;default:if(k&1)(L!==1||v.type.toLowerCase()!==g.tagName.toLowerCase())&&!_(g)?q=T():q=h(g,v,S,x,D,w);else if(k&6){v.slotScopeIds=D;const se=o(g);if(b?q=E(g):Om(g)&&g.data==="teleport start"?q=E(g,g.data,"teleport end"):q=i(g),e(v,se,null,S,x,$_(se),w),Wh(v)){let X;b?(X=wn(ao),X.anchor=q?q.previousSibling:se.lastChild):X=g.nodeType===3?dj(""):wn("div"),X.el=g,v.component.subTree=X}}else k&64?L!==8?q=T():q=v.type.hydrate(g,v,S,x,D,w,t,f):k&128&&(q=v.type.hydrate(g,v,S,x,$_(o(g)),D,w,t,d))}return C!=null&&aE(C,null,x,v),q},h=(g,v,S,x,D,w)=>{w=w||!!v.dynamicChildren;const{type:b,props:T,patchFlag:P,shapeFlag:C,dirs:k,transition:K}=v,L=b==="input"||b==="option";if(L||P!==-1){k&&vu(v,null,S,"created");let q=!1;if(_(g)){q=Y4(x,K)&&S&&S.vnode.props&&S.vnode.props.appear;const X=g.content.firstChild;q&&K.beforeEnter(X),A(X,g,S),v.el=g=X}if(C&16&&!(T&&(T.innerHTML||T.textContent))){let X=f(g.firstChild,v,g,S,x,D,w);for(;X;){O_(g,1)||Qp();const re=X;X=X.nextSibling,a(re)}}else C&8&&g.textContent!==v.children&&(O_(g,0)||Qp(),g.textContent=v.children);if(T){if(L||!w||P&48){const X=g.tagName.includes("-");for(const re in T)(L&&(re.endsWith("value")||re==="indeterminate")||Tw(re)&&!Vm(re)||re[0]==="."||X)&&n(g,re,null,T[re],void 0,S)}else if(T.onClick)n(g,"onClick",null,T.onClick,void 0,S);else if(P&4&&zh(T.style))for(const X in T.style)T.style[X]}let se;(se=T&&T.onVnodeBeforeMount)&&$s(se,S,v),k&&vu(v,null,S,"beforeMount"),((se=T&&T.onVnodeMounted)||k||q)&&ij(()=>{se&&$s(se,S,v),q&&K.enter(g),k&&vu(v,null,S,"mounted")},x)}return g.nextSibling},f=(g,v,S,x,D,w,b)=>{b=b||!!v.dynamicChildren;const T=v.children,P=T.length;for(let C=0;C<P;C++){const k=b?T[C]:T[C]=uo(T[C]),K=k.type===Xh;g?(K&&!b&&C+1<P&&uo(T[C+1]).type===Xh&&(u(s(g.data.slice(k.children.length)),S,i(g)),g.data=k.children),g=d(g,k,x,D,w,b)):K&&!k.children?u(k.el=s(""),S):(O_(S,1)||Qp(),r(null,k,S,null,x,D,$_(S),w))}return g},p=(g,v,S,x,D,w)=>{const{slotScopeIds:b}=v;b&&(D=D?D.concat(b):b);const T=o(g),P=f(i(g),v,T,S,x,D,w);return P&&Om(P)&&P.data==="]"?i(v.anchor=P):(Qp(),u(v.anchor=l("]"),T,P),P)},m=(g,v,S,x,D,w)=>{if(O_(g.parentElement,1)||Qp(),v.el=null,w){const P=E(g);for(;;){const C=i(g);if(C&&C!==P)a(C);else break}}const b=i(g),T=o(g);return a(g),r(null,v,T,b,S,x,$_(T),D),b},E=(g,v="[",S="]")=>{let x=0;for(;g;)if(g=i(g),g&&Om(g)&&(g.data===v&&x++,g.data===S)){if(x===0)return i(g);x--}return g},A=(g,v,S)=>{const x=v.parentNode;x&&x.replaceChild(g,v);let D=S;for(;D;)D.vnode.el===v&&(D.vnode.el=D.subTree.el=g),D=D.parent},_=g=>g.nodeType===1&&g.tagName.toLowerCase()==="template";return[c,d]}const D5="data-allow-mismatch",OJ={0:"text",1:"children",2:"class",3:"style",4:"attribute"};function O_(t,e){if(e===0||e===1)for(;t&&!t.hasAttribute(D5);)t=t.parentElement;const r=t&&t.getAttribute(D5);if(r==null)return!1;if(r==="")return!0;{const n=r.split(",");return e===0&&n.includes("children")?!0:r.split(",").includes(OJ[e])}}function RJ(t,e){if(Om(t)&&t.data==="["){let r=1,n=t.nextSibling;for(;n;){if(n.nodeType===1)e(n);else if(Om(n))if(n.data==="]"){if(--r===0)break}else n.data==="["&&r++;n=n.nextSibling}}else e(t)}const Wh=t=>!!t.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function x5(t){Pt(t)&&(t={loader:t});const{loader:e,loadingComponent:r,errorComponent:n,delay:s=200,hydrate:i,timeout:o,suspensible:a=!0,onError:u}=t;let l=null,c,d=0;const h=()=>(d++,l=null,f()),f=()=>{let p;return l||(p=l=e().catch(m=>{if(m=m instanceof Error?m:new Error(String(m)),u)return new Promise((E,A)=>{u(m,()=>E(h()),()=>A(m),d+1)});throw m}).then(m=>p!==l&&l?l:(m&&(m.__esModule||m[Symbol.toStringTag]==="Module")&&(m=m.default),c=m,m)))};return Ky({name:"AsyncComponentWrapper",__asyncLoader:f,__asyncHydrate(p,m,E){const A=i?()=>{const _=i(E,g=>RJ(p,g));_&&(m.bum||(m.bum=[])).push(_)}:E;c?A():f().then(()=>!m.isUnmounted&&A())},get __asyncResolved(){return c},setup(){const p=qn;if(OC(p),c)return()=>p2(c,p);const m=g=>{l=null,Uy(g,p,13,!n)};if(a&&p.suspense||Cw)return f().then(g=>()=>p2(g,p)).catch(g=>(m(g),()=>n?wn(n,{error:g}):null));const E=Bu(!1),A=Bu(),_=Bu(!!s);return s&&setTimeout(()=>{_.value=!1},s),o!=null&&setTimeout(()=>{if(!E.value&&!A.value){const g=new Error(`Async component timed out after ${o}ms.`);m(g),A.value=g}},o),f().then(()=>{E.value=!0,p.parent&&xw(p.parent.vnode)&&$A(p.parent.update)}).catch(g=>{m(g),A.value=g}),()=>{if(E.value&&c)return p2(c,p);if(A.value&&n)return wn(n,{error:A.value});if(r&&!_.value)return wn(r)}}})}function p2(t,e){const{ref:r,props:n,children:s,ce:i}=e.vnode,o=wn(t,n,s);return o.ref=r,o.ce=i,delete e.vnode.ce,o}const xw=t=>t.type.__isKeepAlive,NJ={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(t,{slots:e}){const r=FA(),n=r.ctx;if(!n.renderer)return()=>{const _=e.default&&e.default();return _&&_.length===1?_[0]:_};const s=new Map,i=new Set;let o=null;const a=r.suspense,{renderer:{p:u,m:l,um:c,o:{createElement:d}}}=n,h=d("div");n.activate=(_,g,v,S,x)=>{const D=_.component;l(_,g,v,0,a),u(D.vnode,_,g,v,D,a,S,_.slotScopeIds,x),xi(()=>{D.isDeactivated=!1,D.a&&qm(D.a);const w=_.props&&_.props.onVnodeMounted;w&&$s(w,D.parent,_)},a)},n.deactivate=_=>{const g=_.component;cE(g.m),cE(g.a),l(_,h,null,1,a),xi(()=>{g.da&&qm(g.da);const v=_.props&&_.props.onVnodeUnmounted;v&&$s(v,g.parent,_),g.isDeactivated=!0},a)};function f(_){m2(_),c(_,r,a,!0)}function p(_){s.forEach((g,v)=>{const S=YD(g.type);S&&!_(S)&&m(v)})}function m(_){const g=s.get(_);g&&(!o||!Ca(g,o))?f(g):o&&m2(o),s.delete(_),i.delete(_)}Yd(()=>[t.include,t.exclude],([_,g])=>{_&&p(v=>_0(_,v)),g&&p(v=>!_0(g,v))},{flush:"post",deep:!0});let E=null;const A=()=>{E!=null&&(lE(r.subTree.type)?xi(()=>{s.set(E,R_(r.subTree))},r.subTree.suspense):s.set(E,R_(r.subTree)))};return RA(A),$4(A),NA(()=>{s.forEach(_=>{const{subTree:g,suspense:v}=r,S=R_(g);if(_.type===S.type&&_.key===S.key){m2(S);const x=S.component.da;x&&xi(x,v);return}f(_)})}),()=>{if(E=null,!e.default)return o=null;const _=e.default(),g=_[0];if(_.length>1)return o=null,_;if(!Rv(g)||!(g.shapeFlag&4)&&!(g.shapeFlag&128))return o=null,g;let v=R_(g);if(v.type===si)return o=null,v;const S=v.type,x=YD(Wh(v)?v.type.__asyncResolved||{}:S),{include:D,exclude:w,max:b}=t;if(D&&(!x||!_0(D,x))||w&&x&&_0(w,x))return v.shapeFlag&=-257,o=v,g;const T=v.key==null?S:v.key,P=s.get(T);return v.el&&(v=fl(v),g.shapeFlag&128&&(g.ssContent=v)),E=T,P?(v.el=P.el,v.component=P.component,v.transition&&ay(v,v.transition),v.shapeFlag|=512,i.delete(T),i.add(T)):(i.add(T),b&&i.size>parseInt(b,10)&&m(i.values().next().value)),v.shapeFlag|=256,o=v,lE(g.type)?g:v}}},BJ=NJ;function _0(t,e){return dt(t)?t.some(r=>_0(r,e)):an(t)?t.split(",").includes(e):$G(t)?(t.lastIndex=0,t.test(e)):!1}function C4(t,e){k4(t,"a",e)}function I4(t,e){k4(t,"da",e)}function k4(t,e,r=qn){const n=t.__wdc||(t.__wdc=()=>{let s=r;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(OA(e,n,r),r){let s=r.parent;for(;s&&s.parent;)xw(s.parent.vnode)&&FJ(n,e,r,s),s=s.parent}}function FJ(t,e,r,n){const s=OA(e,t,n,!0);O4(()=>{_C(n[e],s)},r)}function m2(t){t.shapeFlag&=-257,t.shapeFlag&=-513}function R_(t){return t.shapeFlag&128?t.ssContent:t}function OA(t,e,r=qn,n=!1){if(r){const s=r[t]||(r[t]=[]),i=e.__weh||(e.__weh=(...o)=>{Af();const a=Pw(r),u=Va(e,r,t,o);return a(),Sf(),u});return n?s.unshift(i):s.push(i),i}}const Tl=t=>(e,r=qn)=>{(!Cw||t==="sp")&&OA(t,(...n)=>e(...n),r)},MJ=Tl("bm"),RA=Tl("m"),jJ=Tl("bu"),$4=Tl("u"),NA=Tl("bum"),O4=Tl("um"),UJ=Tl("sp"),LJ=Tl("rtg"),KJ=Tl("rtc");function R4(t,e=qn){OA("ec",t,e)}const N4="components";function eNe(t,e){return F4(N4,t,!0,e)||t}const B4=Symbol.for("v-ndc");function VJ(t){return an(t)?F4(N4,t,!1)||t:t||B4}function F4(t,e,r=!0,n=!1){const s=ys||qn;if(s){const i=s.type;{const a=YD(i,!1);if(a&&(a===e||a===Ka(e)||a===xA(Ka(e))))return i}const o=P5(s[t]||i[t],e)||P5(s.appContext[t],e);return!o&&n?i:o}}function P5(t,e){return t&&(t[e]||t[Ka(e)]||t[xA(Ka(e))])}function tNe(t,e,r,n){let s;const i=r,o=dt(t);if(o||an(t)){const a=o&&zh(t);let u=!1;a&&(u=!ea(t),t=IA(t)),s=new Array(t.length);for(let l=0,c=t.length;l<c;l++)s[l]=e(u?Yi(t[l]):t[l],l,void 0,i)}else if(typeof t=="number"){s=new Array(t);for(let a=0;a<t;a++)s[a]=e(a+1,a,void 0,i)}else if(Mr(t))if(t[Symbol.iterator])s=Array.from(t,(a,u)=>e(a,u,void 0,i));else{const a=Object.keys(t);s=new Array(a.length);for(let u=0,l=a.length;u<l;u++){const c=a[u];s[u]=e(t[c],c,u,i)}}else s=[];return s}const qD=t=>t?fj(t)?MA(t):qD(t.parent):null,G0=Wn(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>qD(t.parent),$root:t=>qD(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>RC(t),$forceUpdate:t=>t.f||(t.f=()=>{$A(t.update)}),$nextTick:t=>t.n||(t.n=Ly.bind(t.proxy)),$watch:t=>lX.bind(t)}),y2=(t,e)=>t!==qr&&!t.__isScriptSetup&&Dr(t,e),qJ={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:r,setupState:n,data:s,props:i,accessCache:o,type:a,appContext:u}=t;let l;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return n[e];case 2:return s[e];case 4:return r[e];case 3:return i[e]}else{if(y2(n,e))return o[e]=1,n[e];if(s!==qr&&Dr(s,e))return o[e]=2,s[e];if((l=t.propsOptions[0])&&Dr(l,e))return o[e]=3,i[e];if(r!==qr&&Dr(r,e))return o[e]=4,r[e];HD&&(o[e]=0)}}const c=G0[e];let d,h;if(c)return e==="$attrs"&&es(t.attrs,"get",""),c(t);if((d=a.__cssModules)&&(d=d[e]))return d;if(r!==qr&&Dr(r,e))return o[e]=4,r[e];if(h=u.config.globalProperties,Dr(h,e))return h[e]},set({_:t},e,r){const{data:n,setupState:s,ctx:i}=t;return y2(s,e)?(s[e]=r,!0):n!==qr&&Dr(n,e)?(n[e]=r,!0):Dr(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=r,!0)},has({_:{data:t,setupState:e,accessCache:r,ctx:n,appContext:s,propsOptions:i}},o){let a;return!!r[o]||t!==qr&&Dr(t,o)||y2(e,o)||(a=i[0])&&Dr(a,o)||Dr(n,o)||Dr(G0,o)||Dr(s.config.globalProperties,o)},defineProperty(t,e,r){return r.get!=null?t._.accessCache[e]=0:Dr(r,"value")&&this.set(t,e,r.value,null),Reflect.defineProperty(t,e,r)}};function C5(t){return dt(t)?t.reduce((e,r)=>(e[r]=null,e),{}):t}let HD=!0;function HJ(t){const e=RC(t),r=t.proxy,n=t.ctx;HD=!1,e.beforeCreate&&I5(e.beforeCreate,t,"bc");const{data:s,computed:i,methods:o,watch:a,provide:u,inject:l,created:c,beforeMount:d,mounted:h,beforeUpdate:f,updated:p,activated:m,deactivated:E,beforeDestroy:A,beforeUnmount:_,destroyed:g,unmounted:v,render:S,renderTracked:x,renderTriggered:D,errorCaptured:w,serverPrefetch:b,expose:T,inheritAttrs:P,components:C,directives:k,filters:K}=e;if(l&&zJ(l,n,null),o)for(const se in o){const X=o[se];Pt(X)&&(n[se]=X.bind(r))}if(s){const se=s.call(r,r);Mr(se)&&(t.data=Sl(se))}if(HD=!0,i)for(const se in i){const X=i[se],re=Pt(X)?X.bind(r,r):Pt(X.get)?X.get.bind(r,r):Nu,W=!Pt(X)&&Pt(X.set)?X.set.bind(r):Nu,B=Ia({get:re,set:W});Object.defineProperty(n,se,{enumerable:!0,configurable:!0,get:()=>B.value,set:te=>B.value=te})}if(a)for(const se in a)M4(a[se],n,r,se);if(u){const se=Pt(u)?u.call(r):u;Reflect.ownKeys(se).forEach(X=>{Jh(X,se[X])})}c&&I5(c,t,"c");function q(se,X){dt(X)?X.forEach(re=>se(re.bind(r))):X&&se(X.bind(r))}if(q(MJ,d),q(RA,h),q(jJ,f),q($4,p),q(C4,m),q(I4,E),q(R4,w),q(KJ,x),q(LJ,D),q(NA,_),q(O4,v),q(UJ,b),dt(T))if(T.length){const se=t.exposed||(t.exposed={});T.forEach(X=>{Object.defineProperty(se,X,{get:()=>r[X],set:re=>r[X]=re})})}else t.exposed||(t.exposed={});S&&t.render===Nu&&(t.render=S),P!=null&&(t.inheritAttrs=P),C&&(t.components=C),k&&(t.directives=k),b&&OC(t)}function zJ(t,e,r=Nu){dt(t)&&(t=zD(t));for(const n in t){const s=t[n];let i;Mr(s)?"default"in s?i=Ks(s.from||n,s.default,!0):i=Ks(s.from||n):i=Ks(s),ui(i)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[n]=i}}function I5(t,e,r){Va(dt(t)?t.map(n=>n.bind(e.proxy)):t.bind(e.proxy),e,r)}function M4(t,e,r,n){let s=n.includes(".")?ej(r,n):()=>r[n];if(an(t)){const i=e[t];Pt(i)&&Yd(s,i)}else if(Pt(t))Yd(s,t.bind(r));else if(Mr(t))if(dt(t))t.forEach(i=>M4(i,e,r,n));else{const i=Pt(t.handler)?t.handler.bind(r):e[t.handler];Pt(i)&&Yd(s,i,t)}}function RC(t){const e=t.type,{mixins:r,extends:n}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,a=i.get(e);let u;return a?u=a:!s.length&&!r&&!n?u=e:(u={},s.length&&s.forEach(l=>uE(u,l,o,!0)),uE(u,e,o)),Mr(e)&&i.set(e,u),u}function uE(t,e,r,n=!1){const{mixins:s,extends:i}=e;i&&uE(t,i,r,!0),s&&s.forEach(o=>uE(t,o,r,!0));for(const o in e)if(!(n&&o==="expose")){const a=WJ[o]||r&&r[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const WJ={data:k5,props:$5,emits:$5,methods:b0,computed:b0,beforeCreate:as,created:as,beforeMount:as,mounted:as,beforeUpdate:as,updated:as,beforeDestroy:as,beforeUnmount:as,destroyed:as,unmounted:as,activated:as,deactivated:as,errorCaptured:as,serverPrefetch:as,components:b0,directives:b0,watch:JJ,provide:k5,inject:GJ};function k5(t,e){return e?t?function(){return Wn(Pt(t)?t.call(this,this):t,Pt(e)?e.call(this,this):e)}:e:t}function GJ(t,e){return b0(zD(t),zD(e))}function zD(t){if(dt(t)){const e={};for(let r=0;r<t.length;r++)e[t[r]]=t[r];return e}return t}function as(t,e){return t?[...new Set([].concat(t,e))]:e}function b0(t,e){return t?Wn(Object.create(null),t,e):e}function $5(t,e){return t?dt(t)&&dt(e)?[...new Set([...t,...e])]:Wn(Object.create(null),C5(t),C5(e??{})):e}function JJ(t,e){if(!t)return e;if(!e)return t;const r=Wn(Object.create(null),t);for(const n in e)r[n]=as(t[n],e[n]);return r}function j4(){return{app:null,config:{isNativeTag:IG,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let XJ=0;function YJ(t,e){return function(n,s=null){Pt(n)||(n=Wn({},n)),s!=null&&!Mr(s)&&(s=null);const i=j4(),o=new WeakSet,a=[];let u=!1;const l=i.app={_uid:XJ++,_component:n,_props:s,_container:null,_context:i,_instance:null,version:pj,get config(){return i.config},set config(c){},use(c,...d){return o.has(c)||(c&&Pt(c.install)?(o.add(c),c.install(l,...d)):Pt(c)&&(o.add(c),c(l,...d))),l},mixin(c){return i.mixins.includes(c)||i.mixins.push(c),l},component(c,d){return d?(i.components[c]=d,l):i.components[c]},directive(c,d){return d?(i.directives[c]=d,l):i.directives[c]},mount(c,d,h){if(!u){const f=l._ceVNode||wn(n,s);return f.appContext=i,h===!0?h="svg":h===!1&&(h=void 0),d&&e?e(f,c):t(f,c,h),u=!0,l._container=c,c.__vue_app__=l,MA(f.component)}},onUnmount(c){a.push(c)},unmount(){u&&(Va(a,l._instance,16),t(null,l._container),delete l._container.__vue_app__)},provide(c,d){return i.provides[c]=d,l},runWithContext(c){const d=Gh;Gh=l;try{return c()}finally{Gh=d}}};return l}}let Gh=null;function Jh(t,e){if(qn){let r=qn.provides;const n=qn.parent&&qn.parent.provides;n===r&&(r=qn.provides=Object.create(n)),r[t]=e}}function Ks(t,e,r=!1){const n=qn||ys;if(n||Gh){const s=Gh?Gh._context.provides:n?n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(s&&t in s)return s[t];if(arguments.length>1)return r&&Pt(e)?e.call(n&&n.proxy):e}}function U4(){return!!(qn||ys||Gh)}const L4={},K4=()=>Object.create(L4),V4=t=>Object.getPrototypeOf(t)===L4;function ZJ(t,e,r,n=!1){const s={},i=K4();t.propsDefaults=Object.create(null),q4(t,e,s,i);for(const o in t.propsOptions[0])o in s||(s[o]=void 0);r?t.props=n?s:tl(s):t.type.props?t.props=s:t.props=i,t.attrs=i}function QJ(t,e,r,n){const{props:s,attrs:i,vnode:{patchFlag:o}}=t,a=hr(s),[u]=t.propsOptions;let l=!1;if((n||o>0)&&!(o&16)){if(o&8){const c=t.vnode.dynamicProps;for(let d=0;d<c.length;d++){let h=c[d];if(BA(t.emitsOptions,h))continue;const f=e[h];if(u)if(Dr(i,h))f!==i[h]&&(i[h]=f,l=!0);else{const p=Ka(h);s[p]=WD(u,a,p,f,t,!1)}else f!==i[h]&&(i[h]=f,l=!0)}}}else{q4(t,e,s,i)&&(l=!0);let c;for(const d in a)(!e||!Dr(e,d)&&((c=$p(d))===d||!Dr(e,c)))&&(u?r&&(r[d]!==void 0||r[c]!==void 0)&&(s[d]=WD(u,a,d,void 0,t,!0)):delete s[d]);if(i!==a)for(const d in i)(!e||!Dr(e,d))&&(delete i[d],l=!0)}l&&ol(t.attrs,"set","")}function q4(t,e,r,n){const[s,i]=t.propsOptions;let o=!1,a;if(e)for(let u in e){if(Vm(u))continue;const l=e[u];let c;s&&Dr(s,c=Ka(u))?!i||!i.includes(c)?r[c]=l:(a||(a={}))[c]=l:BA(t.emitsOptions,u)||(!(u in n)||l!==n[u])&&(n[u]=l,o=!0)}if(i){const u=hr(r),l=a||qr;for(let c=0;c<i.length;c++){const d=i[c];r[d]=WD(s,u,d,l[d],t,!Dr(l,d))}}return o}function WD(t,e,r,n,s,i){const o=t[r];if(o!=null){const a=Dr(o,"default");if(a&&n===void 0){const u=o.default;if(o.type!==Function&&!o.skipFactory&&Pt(u)){const{propsDefaults:l}=s;if(r in l)n=l[r];else{const c=Pw(s);n=l[r]=u.call(null,e),c()}}else n=u;s.ce&&s.ce._setProp(r,n)}o[0]&&(i&&!a?n=!1:o[1]&&(n===""||n===$p(r))&&(n=!0))}return n}const eX=new WeakMap;function H4(t,e,r=!1){const n=r?eX:e.propsCache,s=n.get(t);if(s)return s;const i=t.props,o={},a=[];let u=!1;if(!Pt(t)){const c=d=>{u=!0;const[h,f]=H4(d,e,!0);Wn(o,h),f&&a.push(...f)};!r&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}if(!i&&!u)return Mr(t)&&n.set(t,Lm),Lm;if(dt(i))for(let c=0;c<i.length;c++){const d=Ka(i[c]);O5(d)&&(o[d]=qr)}else if(i)for(const c in i){const d=Ka(c);if(O5(d)){const h=i[c],f=o[d]=dt(h)||Pt(h)?{type:h}:Wn({},h),p=f.type;let m=!1,E=!0;if(dt(p))for(let A=0;A<p.length;++A){const _=p[A],g=Pt(_)&&_.name;if(g==="Boolean"){m=!0;break}else g==="String"&&(E=!1)}else m=Pt(p)&&p.name==="Boolean";f[0]=m,f[1]=E,(m||Dr(f,"default"))&&a.push(d)}}const l=[o,a];return Mr(t)&&n.set(t,l),l}function O5(t){return t[0]!=="$"&&!Vm(t)}const z4=t=>t[0]==="_"||t==="$stable",NC=t=>dt(t)?t.map(uo):[uo(t)],tX=(t,e,r)=>{if(e._n)return e;const n=E4((...s)=>NC(e(...s)),r);return n._c=!1,n},W4=(t,e,r)=>{const n=t._ctx;for(const s in t){if(z4(s))continue;const i=t[s];if(Pt(i))e[s]=tX(s,i,n);else if(i!=null){const o=NC(i);e[s]=()=>o}}},G4=(t,e)=>{const r=NC(e);t.slots.default=()=>r},J4=(t,e,r)=>{for(const n in e)(r||n!=="_")&&(t[n]=e[n])},rX=(t,e,r)=>{const n=t.slots=K4();if(t.vnode.shapeFlag&32){const s=e._;s?(J4(n,e,r),r&&G3(n,"_",s,!0)):W4(e,n)}else e&&G4(t,e)},nX=(t,e,r)=>{const{vnode:n,slots:s}=t;let i=!0,o=qr;if(n.shapeFlag&32){const a=e._;a?r&&a===1?i=!1:J4(s,e,r):(i=!e.$stable,W4(e,s)),o=e}else e&&(G4(t,e),o={default:1});if(i)for(const a in s)!z4(a)&&o[a]==null&&delete s[a]},xi=ij;function iX(t){return X4(t)}function sX(t){return X4(t,$J)}function X4(t,e){const r=X3();r.__VUE__=!0;const{insert:n,remove:s,patchProp:i,createElement:o,createText:a,createComment:u,setText:l,setElementText:c,parentNode:d,nextSibling:h,setScopeId:f=Nu,insertStaticContent:p}=t,m=(M,V,oe,j=null,I=null,N=null,Q=void 0,ce=null,pe=!!V.dynamicChildren)=>{if(M===V)return;M&&!Ca(M,V)&&(j=ne(M),te(M,I,N,!0),M=null),V.patchFlag===-2&&(pe=!1,V.dynamicChildren=null);const{type:he,ref:Ce,shapeFlag:_e}=V;switch(he){case Xh:E(M,V,oe,j);break;case si:A(M,V,oe,j);break;case J0:M==null&&_(V,oe,j,Q);break;case ao:C(M,V,oe,j,I,N,Q,ce,pe);break;default:_e&1?S(M,V,oe,j,I,N,Q,ce,pe):_e&6?k(M,V,oe,j,I,N,Q,ce,pe):(_e&64||_e&128)&&he.process(M,V,oe,j,I,N,Q,ce,pe,ve)}Ce!=null&&I&&aE(Ce,M&&M.ref,N,V||M,!V)},E=(M,V,oe,j)=>{if(M==null)n(V.el=a(V.children),oe,j);else{const I=V.el=M.el;V.children!==M.children&&l(I,V.children)}},A=(M,V,oe,j)=>{M==null?n(V.el=u(V.children||""),oe,j):V.el=M.el},_=(M,V,oe,j)=>{[M.el,M.anchor]=p(M.children,V,oe,j,M.el,M.anchor)},g=({el:M,anchor:V},oe,j)=>{let I;for(;M&&M!==V;)I=h(M),n(M,oe,j),M=I;n(V,oe,j)},v=({el:M,anchor:V})=>{let oe;for(;M&&M!==V;)oe=h(M),s(M),M=oe;s(V)},S=(M,V,oe,j,I,N,Q,ce,pe)=>{V.type==="svg"?Q="svg":V.type==="math"&&(Q="mathml"),M==null?x(V,oe,j,I,N,Q,ce,pe):b(M,V,I,N,Q,ce,pe)},x=(M,V,oe,j,I,N,Q,ce)=>{let pe,he;const{props:Ce,shapeFlag:_e,transition:G,dirs:J}=M;if(pe=M.el=o(M.type,N,Ce&&Ce.is,Ce),_e&8?c(pe,M.children):_e&16&&w(M.children,pe,null,j,I,g2(M,N),Q,ce),J&&vu(M,null,j,"created"),D(pe,M,M.scopeId,Q,j),Ce){for(const be in Ce)be!=="value"&&!Vm(be)&&i(pe,be,null,Ce[be],N,j);"value"in Ce&&i(pe,"value",null,Ce.value,N),(he=Ce.onVnodeBeforeMount)&&$s(he,j,M)}J&&vu(M,null,j,"beforeMount");const ge=Y4(I,G);ge&&G.beforeEnter(pe),n(pe,V,oe),((he=Ce&&Ce.onVnodeMounted)||ge||J)&&xi(()=>{he&&$s(he,j,M),ge&&G.enter(pe),J&&vu(M,null,j,"mounted")},I)},D=(M,V,oe,j,I)=>{if(oe&&f(M,oe),j)for(let N=0;N<j.length;N++)f(M,j[N]);if(I){let N=I.subTree;if(V===N||lE(N.type)&&(N.ssContent===V||N.ssFallback===V)){const Q=I.vnode;D(M,Q,Q.scopeId,Q.slotScopeIds,I.parent)}}},w=(M,V,oe,j,I,N,Q,ce,pe=0)=>{for(let he=pe;he<M.length;he++){const Ce=M[he]=ce?Cd(M[he]):uo(M[he]);m(null,Ce,V,oe,j,I,N,Q,ce)}},b=(M,V,oe,j,I,N,Q)=>{const ce=V.el=M.el;let{patchFlag:pe,dynamicChildren:he,dirs:Ce}=V;pe|=M.patchFlag&16;const _e=M.props||qr,G=V.props||qr;let J;if(oe&&Uf(oe,!1),(J=G.onVnodeBeforeUpdate)&&$s(J,oe,V,M),Ce&&vu(V,M,oe,"beforeUpdate"),oe&&Uf(oe,!0),(_e.innerHTML&&G.innerHTML==null||_e.textContent&&G.textContent==null)&&c(ce,""),he?T(M.dynamicChildren,he,ce,oe,j,g2(V,I),N):Q||X(M,V,ce,null,oe,j,g2(V,I),N,!1),pe>0){if(pe&16)P(ce,_e,G,oe,I);else if(pe&2&&_e.class!==G.class&&i(ce,"class",null,G.class,I),pe&4&&i(ce,"style",_e.style,G.style,I),pe&8){const ge=V.dynamicProps;for(let be=0;be<ge.length;be++){const ke=ge[be],At=_e[ke],kt=G[ke];(kt!==At||ke==="value")&&i(ce,ke,At,kt,I,oe)}}pe&1&&M.children!==V.children&&c(ce,V.children)}else!Q&&he==null&&P(ce,_e,G,oe,I);((J=G.onVnodeUpdated)||Ce)&&xi(()=>{J&&$s(J,oe,V,M),Ce&&vu(V,M,oe,"updated")},j)},T=(M,V,oe,j,I,N,Q)=>{for(let ce=0;ce<V.length;ce++){const pe=M[ce],he=V[ce],Ce=pe.el&&(pe.type===ao||!Ca(pe,he)||pe.shapeFlag&70)?d(pe.el):oe;m(pe,he,Ce,null,j,I,N,Q,!0)}},P=(M,V,oe,j,I)=>{if(V!==oe){if(V!==qr)for(const N in V)!Vm(N)&&!(N in oe)&&i(M,N,V[N],null,I,j);for(const N in oe){if(Vm(N))continue;const Q=oe[N],ce=V[N];Q!==ce&&N!=="value"&&i(M,N,ce,Q,I,j)}"value"in oe&&i(M,"value",V.value,oe.value,I)}},C=(M,V,oe,j,I,N,Q,ce,pe)=>{const he=V.el=M?M.el:a(""),Ce=V.anchor=M?M.anchor:a("");let{patchFlag:_e,dynamicChildren:G,slotScopeIds:J}=V;J&&(ce=ce?ce.concat(J):J),M==null?(n(he,oe,j),n(Ce,oe,j),w(V.children||[],oe,Ce,I,N,Q,ce,pe)):_e>0&&_e&64&&G&&M.dynamicChildren?(T(M.dynamicChildren,G,oe,I,N,Q,ce),(V.key!=null||I&&V===I.subTree)&&Z4(M,V,!0)):X(M,V,oe,Ce,I,N,Q,ce,pe)},k=(M,V,oe,j,I,N,Q,ce,pe)=>{V.slotScopeIds=ce,M==null?V.shapeFlag&512?I.ctx.activate(V,oe,j,Q,pe):K(V,oe,j,I,N,Q,pe):L(M,V,pe)},K=(M,V,oe,j,I,N,Q)=>{const ce=M.component=xX(M,j,I);if(xw(M)&&(ce.ctx.renderer=ve),PX(ce,!1,Q),ce.asyncDep){if(I&&I.registerDep(ce,q,Q),!M.el){const pe=ce.subTree=wn(si);A(null,pe,V,oe)}}else q(ce,M,V,oe,I,N,Q)},L=(M,V,oe)=>{const j=V.component=M.component;if(yX(M,V,oe))if(j.asyncDep&&!j.asyncResolved){se(j,V,oe);return}else j.next=V,j.update();else V.el=M.el,j.vnode=V},q=(M,V,oe,j,I,N,Q)=>{const ce=()=>{if(M.isMounted){let{next:_e,bu:G,u:J,parent:ge,vnode:be}=M;{const Wt=Q4(M);if(Wt){_e&&(_e.el=be.el,se(M,_e,Q)),Wt.asyncDep.then(()=>{M.isUnmounted||ce()});return}}let ke=_e,At;Uf(M,!1),_e?(_e.el=be.el,se(M,_e,Q)):_e=be,G&&qm(G),(At=_e.props&&_e.props.onVnodeBeforeUpdate)&&$s(At,ge,_e,be),Uf(M,!0);const kt=v2(M),$r=M.subTree;M.subTree=kt,m($r,kt,d($r.el),ne($r),M,I,N),_e.el=kt.el,ke===null&&FC(M,kt.el),J&&xi(J,I),(At=_e.props&&_e.props.onVnodeUpdated)&&xi(()=>$s(At,ge,_e,be),I)}else{let _e;const{el:G,props:J}=V,{bm:ge,m:be,parent:ke,root:At,type:kt}=M,$r=Wh(V);if(Uf(M,!1),ge&&qm(ge),!$r&&(_e=J&&J.onVnodeBeforeMount)&&$s(_e,ke,V),Uf(M,!0),G&&Ue){const Wt=()=>{M.subTree=v2(M),Ue(G,M.subTree,M,I,null)};$r&&kt.__asyncHydrate?kt.__asyncHydrate(G,M,Wt):Wt()}else{At.ce&&At.ce._injectChildStyle(kt);const Wt=M.subTree=v2(M);m(null,Wt,oe,j,M,I,N),V.el=Wt.el}if(be&&xi(be,I),!$r&&(_e=J&&J.onVnodeMounted)){const Wt=V;xi(()=>$s(_e,ke,Wt),I)}(V.shapeFlag&256||ke&&Wh(ke.vnode)&&ke.vnode.shapeFlag&256)&&M.a&&xi(M.a,I),M.isMounted=!0,V=oe=j=null}};M.scope.on();const pe=M.effect=new r4(ce);M.scope.off();const he=M.update=pe.run.bind(pe),Ce=M.job=pe.runIfDirty.bind(pe);Ce.i=M,Ce.id=M.uid,pe.scheduler=()=>$A(Ce),Uf(M,!0),he()},se=(M,V,oe)=>{V.component=M;const j=M.vnode.props;M.vnode=V,M.next=null,QJ(M,V.props,j,oe),nX(M,V.children,oe),Af(),A5(M),Sf()},X=(M,V,oe,j,I,N,Q,ce,pe=!1)=>{const he=M&&M.children,Ce=M?M.shapeFlag:0,_e=V.children,{patchFlag:G,shapeFlag:J}=V;if(G>0){if(G&128){W(he,_e,oe,j,I,N,Q,ce,pe);return}else if(G&256){re(he,_e,oe,j,I,N,Q,ce,pe);return}}J&8?(Ce&16&&ee(he,I,N),_e!==he&&c(oe,_e)):Ce&16?J&16?W(he,_e,oe,j,I,N,Q,ce,pe):ee(he,I,N,!0):(Ce&8&&c(oe,""),J&16&&w(_e,oe,j,I,N,Q,ce,pe))},re=(M,V,oe,j,I,N,Q,ce,pe)=>{M=M||Lm,V=V||Lm;const he=M.length,Ce=V.length,_e=Math.min(he,Ce);let G;for(G=0;G<_e;G++){const J=V[G]=pe?Cd(V[G]):uo(V[G]);m(M[G],J,oe,null,I,N,Q,ce,pe)}he>Ce?ee(M,I,N,!0,!1,_e):w(V,oe,j,I,N,Q,ce,pe,_e)},W=(M,V,oe,j,I,N,Q,ce,pe)=>{let he=0;const Ce=V.length;let _e=M.length-1,G=Ce-1;for(;he<=_e&&he<=G;){const J=M[he],ge=V[he]=pe?Cd(V[he]):uo(V[he]);if(Ca(J,ge))m(J,ge,oe,null,I,N,Q,ce,pe);else break;he++}for(;he<=_e&&he<=G;){const J=M[_e],ge=V[G]=pe?Cd(V[G]):uo(V[G]);if(Ca(J,ge))m(J,ge,oe,null,I,N,Q,ce,pe);else break;_e--,G--}if(he>_e){if(he<=G){const J=G+1,ge=J<Ce?V[J].el:j;for(;he<=G;)m(null,V[he]=pe?Cd(V[he]):uo(V[he]),oe,ge,I,N,Q,ce,pe),he++}}else if(he>G)for(;he<=_e;)te(M[he],I,N,!0),he++;else{const J=he,ge=he,be=new Map;for(he=ge;he<=G;he++){const un=V[he]=pe?Cd(V[he]):uo(V[he]);un.key!=null&&be.set(un.key,he)}let ke,At=0;const kt=G-ge+1;let $r=!1,Wt=0;const cr=new Array(kt);for(he=0;he<kt;he++)cr[he]=0;for(he=J;he<=_e;he++){const un=M[he];if(At>=kt){te(un,I,N,!0);continue}let Ct;if(un.key!=null)Ct=be.get(un.key);else for(ke=ge;ke<=G;ke++)if(cr[ke-ge]===0&&Ca(un,V[ke])){Ct=ke;break}Ct===void 0?te(un,I,N,!0):(cr[Ct-ge]=he+1,Ct>=Wt?Wt=Ct:$r=!0,m(un,V[Ct],oe,null,I,N,Q,ce,pe),At++)}const zs=$r?oX(cr):Lm;for(ke=zs.length-1,he=kt-1;he>=0;he--){const un=ge+he,Ct=V[un],Wr=un+1<Ce?V[un+1].el:j;cr[he]===0?m(null,Ct,oe,Wr,I,N,Q,ce,pe):$r&&(ke<0||he!==zs[ke]?B(Ct,oe,Wr,2):ke--)}}},B=(M,V,oe,j,I=null)=>{const{el:N,type:Q,transition:ce,children:pe,shapeFlag:he}=M;if(he&6){B(M.component.subTree,V,oe,j);return}if(he&128){M.suspense.move(V,oe,j);return}if(he&64){Q.move(M,V,oe,ve);return}if(Q===ao){n(N,V,oe);for(let _e=0;_e<pe.length;_e++)B(pe[_e],V,oe,j);n(M.anchor,V,oe);return}if(Q===J0){g(M,V,oe);return}if(j!==2&&he&1&&ce)if(j===0)ce.beforeEnter(N),n(N,V,oe),xi(()=>ce.enter(N),I);else{const{leave:_e,delayLeave:G,afterLeave:J}=ce,ge=()=>n(N,V,oe),be=()=>{_e(N,()=>{ge(),J&&J()})};G?G(N,ge,be):be()}else n(N,V,oe)},te=(M,V,oe,j=!1,I=!1)=>{const{type:N,props:Q,ref:ce,children:pe,dynamicChildren:he,shapeFlag:Ce,patchFlag:_e,dirs:G,cacheIndex:J}=M;if(_e===-2&&(I=!1),ce!=null&&aE(ce,null,oe,M,!0),J!=null&&(V.renderCache[J]=void 0),Ce&256){V.ctx.deactivate(M);return}const ge=Ce&1&&G,be=!Wh(M);let ke;if(be&&(ke=Q&&Q.onVnodeBeforeUnmount)&&$s(ke,V,M),Ce&6)F(M.component,oe,j);else{if(Ce&128){M.suspense.unmount(oe,j);return}ge&&vu(M,null,V,"beforeUnmount"),Ce&64?M.type.remove(M,V,oe,ve,j):he&&!he.hasOnce&&(N!==ao||_e>0&&_e&64)?ee(he,V,oe,!1,!0):(N===ao&&_e&384||!I&&Ce&16)&&ee(pe,V,oe),j&&z(M)}(be&&(ke=Q&&Q.onVnodeUnmounted)||ge)&&xi(()=>{ke&&$s(ke,V,M),ge&&vu(M,null,V,"unmounted")},oe)},z=M=>{const{type:V,el:oe,anchor:j,transition:I}=M;if(V===ao){$(oe,j);return}if(V===J0){v(M);return}const N=()=>{s(oe),I&&!I.persisted&&I.afterLeave&&I.afterLeave()};if(M.shapeFlag&1&&I&&!I.persisted){const{leave:Q,delayLeave:ce}=I,pe=()=>Q(oe,N);ce?ce(M.el,N,pe):pe()}else N()},$=(M,V)=>{let oe;for(;M!==V;)oe=h(M),s(M),M=oe;s(V)},F=(M,V,oe)=>{const{bum:j,scope:I,job:N,subTree:Q,um:ce,m:pe,a:he}=M;cE(pe),cE(he),j&&qm(j),I.stop(),N&&(N.flags|=8,te(Q,M,V,oe)),ce&&xi(ce,V),xi(()=>{M.isUnmounted=!0},V),V&&V.pendingBranch&&!V.isUnmounted&&M.asyncDep&&!M.asyncResolved&&M.suspenseId===V.pendingId&&(V.deps--,V.deps===0&&V.resolve())},ee=(M,V,oe,j=!1,I=!1,N=0)=>{for(let Q=N;Q<M.length;Q++)te(M[Q],V,oe,j,I)},ne=M=>{if(M.shapeFlag&6)return ne(M.component.subTree);if(M.shapeFlag&128)return M.suspense.next();const V=h(M.anchor||M.el),oe=V&&V[DJ];return oe?h(oe):V};let le=!1;const me=(M,V,oe)=>{M==null?V._vnode&&te(V._vnode,null,null,!0):m(V._vnode||null,M,V,null,null,null,oe),V._vnode=M,le||(le=!0,A5(),sE(),le=!1)},ve={p:m,um:te,m:B,r:z,mt:K,mc:w,pc:X,pbc:T,n:ne,o:t};let Pe,Ue;return e&&([Pe,Ue]=e(ve)),{render:me,hydrate:Pe,createApp:YJ(me,Pe)}}function g2({type:t,props:e},r){return r==="svg"&&t==="foreignObject"||r==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:r}function Uf({effect:t,job:e},r){r?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function Y4(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function Z4(t,e,r=!1){const n=t.children,s=e.children;if(dt(n)&&dt(s))for(let i=0;i<n.length;i++){const o=n[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=Cd(s[i]),a.el=o.el),!r&&a.patchFlag!==-2&&Z4(o,a)),a.type===Xh&&(a.el=o.el)}}function oX(t){const e=t.slice(),r=[0];let n,s,i,o,a;const u=t.length;for(n=0;n<u;n++){const l=t[n];if(l!==0){if(s=r[r.length-1],t[s]<l){e[n]=s,r.push(n);continue}for(i=0,o=r.length-1;i<o;)a=i+o>>1,t[r[a]]<l?i=a+1:o=a;l<t[r[i]]&&(i>0&&(e[n]=r[i-1]),r[i]=n)}}for(i=r.length,o=r[i-1];i-- >0;)r[i]=o,o=e[o];return r}function Q4(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Q4(e)}function cE(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const aX=Symbol.for("v-scx"),uX=()=>Ks(aX);function cX(t,e){return BC(t,null,e)}function Yd(t,e,r){return BC(t,e,r)}function BC(t,e,r=qr){const{immediate:n,deep:s,flush:i,once:o}=r,a=Wn({},r);let u;if(Cw)if(i==="sync"){const h=uX();u=h.__watcherHandles||(h.__watcherHandles=[])}else if(!e||n)a.once=!0;else return{stop:Nu,resume:Nu,pause:Nu};const l=qn;a.call=(h,f,p)=>Va(h,l,f,p);let c=!1;i==="post"?a.scheduler=h=>{xi(h,l&&l.suspense)}:i!=="sync"&&(c=!0,a.scheduler=(h,f)=>{f?h():$A(h)}),a.augmentJob=h=>{e&&(h.flags|=4),c&&(h.flags|=2,l&&(h.id=l.uid,h.i=l))};const d=AJ(t,e,a);return u&&u.push(d),d}function lX(t,e,r){const n=this.proxy,s=an(t)?t.includes(".")?ej(n,t):()=>n[t]:t.bind(n,n);let i;Pt(e)?i=e:(i=e.handler,r=e);const o=Pw(this),a=BC(s,i.bind(n),r);return o(),a}function ej(t,e){const r=e.split(".");return()=>{let n=t;for(let s=0;s<r.length&&n;s++)n=n[r[s]];return n}}const dX=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${Ka(e)}Modifiers`]||t[`${$p(e)}Modifiers`];function fX(t,e,...r){if(t.isUnmounted)return;const n=t.vnode.props||qr;let s=r;const i=e.startsWith("update:"),o=i&&dX(n,e.slice(7));o&&(o.trim&&(s=r.map(c=>an(c)?c.trim():c)),o.number&&(s=r.map(rE)));let a,u=n[a=u2(e)]||n[a=u2(Ka(e))];!u&&i&&(u=n[a=u2($p(e))]),u&&Va(u,t,6,s);const l=n[a+"Once"];if(l){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Va(l,t,6,s)}}function tj(t,e,r=!1){const n=e.emitsCache,s=n.get(t);if(s!==void 0)return s;const i=t.emits;let o={},a=!1;if(!Pt(t)){const u=l=>{const c=tj(l,e,!0);c&&(a=!0,Wn(o,c))};!r&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}return!i&&!a?(Mr(t)&&n.set(t,null),null):(dt(i)?i.forEach(u=>o[u]=null):Wn(o,i),Mr(t)&&n.set(t,o),o)}function BA(t,e){return!t||!Tw(e)?!1:(e=e.slice(2).replace(/Once$/,""),Dr(t,e[0].toLowerCase()+e.slice(1))||Dr(t,$p(e))||Dr(t,e))}function v2(t){const{type:e,vnode:r,proxy:n,withProxy:s,propsOptions:[i],slots:o,attrs:a,emit:u,render:l,renderCache:c,props:d,data:h,setupState:f,ctx:p,inheritAttrs:m}=t,E=oE(t);let A,_;try{if(r.shapeFlag&4){const v=s||n,S=v;A=uo(l.call(S,v,c,d,f,h,p)),_=a}else{const v=e;A=uo(v.length>1?v(d,{attrs:a,slots:o,emit:u}):v(d,null)),_=e.props?a:pX(a)}}catch(v){X0.length=0,Uy(v,t,1),A=wn(si)}let g=A;if(_&&m!==!1){const v=Object.keys(_),{shapeFlag:S}=g;v.length&&S&7&&(i&&v.some(wC)&&(_=mX(_,i)),g=fl(g,_,!1,!0))}return r.dirs&&(g=fl(g,null,!1,!0),g.dirs=g.dirs?g.dirs.concat(r.dirs):r.dirs),r.transition&&ay(g,r.transition),A=g,oE(E),A}function hX(t,e=!0){let r;for(let n=0;n<t.length;n++){const s=t[n];if(Rv(s)){if(s.type!==si||s.children==="v-if"){if(r)return;r=s}}else return}return r}const pX=t=>{let e;for(const r in t)(r==="class"||r==="style"||Tw(r))&&((e||(e={}))[r]=t[r]);return e},mX=(t,e)=>{const r={};for(const n in t)(!wC(n)||!(n.slice(9)in e))&&(r[n]=t[n]);return r};function yX(t,e,r){const{props:n,children:s,component:i}=t,{props:o,children:a,patchFlag:u}=e,l=i.emitsOptions;if(e.dirs||e.transition)return!0;if(r&&u>=0){if(u&1024)return!0;if(u&16)return n?R5(n,o,l):!!o;if(u&8){const c=e.dynamicProps;for(let d=0;d<c.length;d++){const h=c[d];if(o[h]!==n[h]&&!BA(l,h))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:n===o?!1:n?o?R5(n,o,l):!0:!!o;return!1}function R5(t,e,r){const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!0;for(let s=0;s<n.length;s++){const i=n[s];if(e[i]!==t[i]&&!BA(r,i))return!0}return!1}function FC({vnode:t,parent:e},r){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===t&&(n.el=t.el),n===t)(t=e.vnode).el=r,e=e.parent;else break}}const lE=t=>t.__isSuspense;let GD=0;const gX={name:"Suspense",__isSuspense:!0,process(t,e,r,n,s,i,o,a,u,l){if(t==null)vX(e,r,n,s,i,o,a,u,l);else{if(i&&i.deps>0&&!t.suspense.isInFallback){e.suspense=t.suspense,e.suspense.vnode=e,e.el=t.el;return}wX(t,e,r,n,s,o,a,u,l)}},hydrate:_X,normalize:bX},rj=gX;function Ov(t,e){const r=t.props&&t.props[e];Pt(r)&&r()}function vX(t,e,r,n,s,i,o,a,u){const{p:l,o:{createElement:c}}=u,d=c("div"),h=t.suspense=nj(t,s,n,e,d,r,i,o,a,u);l(null,h.pendingBranch=t.ssContent,d,null,n,h,i,o),h.deps>0?(Ov(t,"onPending"),Ov(t,"onFallback"),l(null,t.ssFallback,e,r,n,null,i,o),zm(h,t.ssFallback)):h.resolve(!1,!0)}function wX(t,e,r,n,s,i,o,a,{p:u,um:l,o:{createElement:c}}){const d=e.suspense=t.suspense;d.vnode=e,e.el=t.el;const h=e.ssContent,f=e.ssFallback,{activeBranch:p,pendingBranch:m,isInFallback:E,isHydrating:A}=d;if(m)d.pendingBranch=h,Ca(h,m)?(u(m,h,d.hiddenContainer,null,s,d,i,o,a),d.deps<=0?d.resolve():E&&(A||(u(p,f,r,n,s,null,i,o,a),zm(d,f)))):(d.pendingId=GD++,A?(d.isHydrating=!1,d.activeBranch=m):l(m,s,d),d.deps=0,d.effects.length=0,d.hiddenContainer=c("div"),E?(u(null,h,d.hiddenContainer,null,s,d,i,o,a),d.deps<=0?d.resolve():(u(p,f,r,n,s,null,i,o,a),zm(d,f))):p&&Ca(h,p)?(u(p,h,r,n,s,d,i,o,a),d.resolve(!0)):(u(null,h,d.hiddenContainer,null,s,d,i,o,a),d.deps<=0&&d.resolve()));else if(p&&Ca(h,p))u(p,h,r,n,s,d,i,o,a),zm(d,h);else if(Ov(e,"onPending"),d.pendingBranch=h,h.shapeFlag&512?d.pendingId=h.component.suspenseId:d.pendingId=GD++,u(null,h,d.hiddenContainer,null,s,d,i,o,a),d.deps<=0)d.resolve();else{const{timeout:_,pendingId:g}=d;_>0?setTimeout(()=>{d.pendingId===g&&d.fallback(f)},_):_===0&&d.fallback(f)}}function nj(t,e,r,n,s,i,o,a,u,l,c=!1){const{p:d,m:h,um:f,n:p,o:{parentNode:m,remove:E}}=l;let A;const _=EX(t);_&&e&&e.pendingBranch&&(A=e.pendingId,e.deps++);const g=t.props?J3(t.props.timeout):void 0,v=i,S={vnode:t,parent:e,parentComponent:r,namespace:o,container:n,hiddenContainer:s,deps:0,pendingId:GD++,timeout:typeof g=="number"?g:-1,activeBranch:null,pendingBranch:null,isInFallback:!c,isHydrating:c,isUnmounted:!1,effects:[],resolve(x=!1,D=!1){const{vnode:w,activeBranch:b,pendingBranch:T,pendingId:P,effects:C,parentComponent:k,container:K}=S;let L=!1;S.isHydrating?S.isHydrating=!1:x||(L=b&&T.transition&&T.transition.mode==="out-in",L&&(b.transition.afterLeave=()=>{P===S.pendingId&&(h(T,K,i===v?p(b):i,0),KD(C))}),b&&(m(b.el)===K&&(i=p(b)),f(b,k,S,!0)),L||h(T,K,i,0)),zm(S,T),S.pendingBranch=null,S.isInFallback=!1;let q=S.parent,se=!1;for(;q;){if(q.pendingBranch){q.effects.push(...C),se=!0;break}q=q.parent}!se&&!L&&KD(C),S.effects=[],_&&e&&e.pendingBranch&&A===e.pendingId&&(e.deps--,e.deps===0&&!D&&e.resolve()),Ov(w,"onResolve")},fallback(x){if(!S.pendingBranch)return;const{vnode:D,activeBranch:w,parentComponent:b,container:T,namespace:P}=S;Ov(D,"onFallback");const C=p(w),k=()=>{S.isInFallback&&(d(null,x,T,C,b,null,P,a,u),zm(S,x))},K=x.transition&&x.transition.mode==="out-in";K&&(w.transition.afterLeave=k),S.isInFallback=!0,f(w,b,null,!0),K||k()},move(x,D,w){S.activeBranch&&h(S.activeBranch,x,D,w),S.container=x},next(){return S.activeBranch&&p(S.activeBranch)},registerDep(x,D,w){const b=!!S.pendingBranch;b&&S.deps++;const T=x.vnode.el;x.asyncDep.catch(P=>{Uy(P,x,0)}).then(P=>{if(x.isUnmounted||S.isUnmounted||S.pendingId!==x.suspenseId)return;x.asyncResolved=!0;const{vnode:C}=x;XD(x,P,!1),T&&(C.el=T);const k=!T&&x.subTree.el;D(x,C,m(T||x.subTree.el),T?null:p(x.subTree),S,o,w),k&&E(k),FC(x,C.el),b&&--S.deps===0&&S.resolve()})},unmount(x,D){S.isUnmounted=!0,S.activeBranch&&f(S.activeBranch,r,x,D),S.pendingBranch&&f(S.pendingBranch,r,x,D)}};return S}function _X(t,e,r,n,s,i,o,a,u){const l=e.suspense=nj(e,n,r,t.parentNode,document.createElement("div"),null,s,i,o,a,!0),c=u(t,l.pendingBranch=e.ssContent,r,l,i,o);return l.deps===0&&l.resolve(!1,!0),c}function bX(t){const{shapeFlag:e,children:r}=t,n=e&32;t.ssContent=N5(n?r.default:r),t.ssFallback=n?N5(r.fallback):wn(si)}function N5(t){let e;if(Pt(t)){const r=uy&&t._c;r&&(t._d=!1,bu()),t=t(),r&&(t._d=!0,e=Us,sj())}return dt(t)&&(t=hX(t)),t=uo(t),e&&!t.dynamicChildren&&(t.dynamicChildren=e.filter(r=>r!==t)),t}function ij(t,e){e&&e.pendingBranch?dt(t)?e.effects.push(...t):e.effects.push(t):KD(t)}function zm(t,e){t.activeBranch=e;const{vnode:r,parentComponent:n}=t;let s=e.el;for(;!s&&e.component;)e=e.component.subTree,s=e.el;r.el=s,n&&n.subTree===r&&(n.vnode.el=s,FC(n,s))}function EX(t){const e=t.props&&t.props.suspensible;return e!=null&&e!==!1}const ao=Symbol.for("v-fgt"),Xh=Symbol.for("v-txt"),si=Symbol.for("v-cmt"),J0=Symbol.for("v-stc"),X0=[];let Us=null;function bu(t=!1){X0.push(Us=t?null:[])}function sj(){X0.pop(),Us=X0[X0.length-1]||null}let uy=1;function B5(t){uy+=t,t<0&&Us&&(Us.hasOnce=!0)}function oj(t){return t.dynamicChildren=uy>0?Us||Lm:null,sj(),uy>0&&Us&&Us.push(t),t}function aj(t,e,r,n,s,i){return oj(cj(t,e,r,n,s,i,!0))}function Th(t,e,r,n,s){return oj(wn(t,e,r,n,s,!0))}function Rv(t){return t?t.__v_isVNode===!0:!1}function Ca(t,e){return t.type===e.type&&t.key===e.key}const uj=({key:t})=>t??null,n1=({ref:t,ref_key:e,ref_for:r})=>(typeof t=="number"&&(t=""+t),t!=null?an(t)||ui(t)||Pt(t)?{i:ys,r:t,k:e,f:!!r}:t:null);function cj(t,e=null,r=null,n=0,s=null,i=t===ao?0:1,o=!1,a=!1){const u={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&uj(e),ref:e&&n1(e),scopeId:b4,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:ys};return a?(MC(u,r),i&128&&t.normalize(u)):r&&(u.shapeFlag|=an(r)?8:16),uy>0&&!o&&Us&&(u.patchFlag>0||i&6)&&u.patchFlag!==32&&Us.push(u),u}const wn=AX;function AX(t,e=null,r=null,n=0,s=null,i=!1){if((!t||t===B4)&&(t=si),Rv(t)){const a=fl(t,e,!0);return r&&MC(a,r),uy>0&&!i&&Us&&(a.shapeFlag&6?Us[Us.indexOf(t)]=a:Us.push(a)),a.patchFlag=-2,a}if($X(t)&&(t=t.__vccOpts),e){e=lj(e);let{class:a,style:u}=e;a&&!an(a)&&(e.class=CA(a)),Mr(u)&&(IC(u)&&!dt(u)&&(u=Wn({},u)),e.style=PA(u))}const o=an(t)?1:lE(t)?128:A4(t)?64:Mr(t)?4:Pt(t)?2:0;return cj(t,e,r,n,s,o,i,!0)}function lj(t){return t?IC(t)||V4(t)?Wn({},t):t:null}function fl(t,e,r=!1,n=!1){const{props:s,ref:i,patchFlag:o,children:a,transition:u}=t,l=e?SX(s||{},e):s,c={__v_isVNode:!0,__v_skip:!0,type:t.type,props:l,key:l&&uj(l),ref:e&&e.ref?r&&i?dt(i)?i.concat(n1(e)):[i,n1(e)]:n1(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==ao?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:u,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&fl(t.ssContent),ssFallback:t.ssFallback&&fl(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return u&&n&&ay(c,u.clone(c)),c}function dj(t=" ",e=0){return wn(Xh,null,t,e)}function rNe(t,e){const r=wn(J0,null,t);return r.staticCount=e,r}function nNe(t="",e=!1){return e?(bu(),Th(si,null,t)):wn(si,null,t)}function uo(t){return t==null||typeof t=="boolean"?wn(si):dt(t)?wn(ao,null,t.slice()):typeof t=="object"?Cd(t):wn(Xh,null,String(t))}function Cd(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:fl(t)}function MC(t,e){let r=0;const{shapeFlag:n}=t;if(e==null)e=null;else if(dt(e))r=16;else if(typeof e=="object")if(n&65){const s=e.default;s&&(s._c&&(s._d=!1),MC(t,s()),s._c&&(s._d=!0));return}else{r=32;const s=e._;!s&&!V4(e)?e._ctx=ys:s===3&&ys&&(ys.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Pt(e)?(e={default:e,_ctx:ys},r=32):(e=String(e),n&64?(r=16,e=[dj(e)]):r=8);t.children=e,t.shapeFlag|=r}function SX(...t){const e={};for(let r=0;r<t.length;r++){const n=t[r];for(const s in n)if(s==="class")e.class!==n.class&&(e.class=CA([e.class,n.class]));else if(s==="style")e.style=PA([e.style,n.style]);else if(Tw(s)){const i=e[s],o=n[s];o&&i!==o&&!(dt(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=n[s])}return e}function $s(t,e,r,n=null){Va(t,e,7,[r,n])}const TX=j4();let DX=0;function xX(t,e,r){const n=t.type,s=(e?e.appContext:t.appContext)||TX,i={uid:DX++,vnode:t,type:n,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new e4(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:H4(n,s),emitsOptions:tj(n,s),emit:null,emitted:null,propsDefaults:qr,inheritAttrs:n.inheritAttrs,ctx:qr,data:qr,props:qr,attrs:qr,slots:qr,refs:qr,setupState:qr,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=fX.bind(null,i),t.ce&&t.ce(i),i}let qn=null;const FA=()=>qn||ys;let dE,JD;{const t=X3(),e=(r,n)=>{let s;return(s=t[r])||(s=t[r]=[]),s.push(n),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};dE=e("__VUE_INSTANCE_SETTERS__",r=>qn=r),JD=e("__VUE_SSR_SETTERS__",r=>Cw=r)}const Pw=t=>{const e=qn;return dE(t),t.scope.on(),()=>{t.scope.off(),dE(e)}},F5=()=>{qn&&qn.scope.off(),dE(null)};function fj(t){return t.vnode.shapeFlag&4}let Cw=!1;function PX(t,e=!1,r=!1){e&&JD(e);const{props:n,children:s}=t.vnode,i=fj(t);ZJ(t,n,i,e),rX(t,s,r);const o=i?CX(t,e):void 0;return e&&JD(!1),o}function CX(t,e){const r=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,qJ);const{setup:n}=r;if(n){const s=t.setupContext=n.length>1?kX(t):null,i=Pw(t);Af();const o=Dw(n,t,0,[t.props,s]);if(Sf(),i(),H3(o)){if(Wh(t)||OC(t),o.then(F5,F5),e)return o.then(a=>{XD(t,a,e)}).catch(a=>{Uy(a,t,0)});t.asyncDep=o}else XD(t,o,e)}else hj(t,e)}function XD(t,e,r){Pt(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Mr(e)&&(t.setupState=g4(e)),hj(t,r)}let M5;function hj(t,e,r){const n=t.type;if(!t.render){if(!e&&M5&&!n.render){const s=n.template||RC(t).template;if(s){const{isCustomElement:i,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:u}=n,l=Wn(Wn({isCustomElement:i,delimiters:a},o),u);n.render=M5(s,l)}}t.render=n.render||Nu}{const s=Pw(t);Af();try{HJ(t)}finally{Sf(),s()}}}const IX={get(t,e){return es(t,"get",""),t[e]}};function kX(t){const e=r=>{t.exposed=r||{}};return{attrs:new Proxy(t.attrs,IX),slots:t.slots,emit:t.emit,expose:e}}function MA(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(g4(hJ(t.exposed)),{get(e,r){if(r in e)return e[r];if(r in G0)return G0[r](t)},has(e,r){return r in e||r in G0}})):t.proxy}function YD(t,e=!0){return Pt(t)?t.displayName||t.name:t.name||e&&t.__name}function $X(t){return Pt(t)&&"__vccOpts"in t}const Ia=(t,e)=>bJ(t,e,Cw);function Iu(t,e,r){const n=arguments.length;return n===2?Mr(e)&&!dt(e)?Rv(e)?wn(t,null,[e]):wn(t,e):wn(t,null,e):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&Rv(r)&&(r=[r]),wn(t,e,r))}const pj="3.5.4";/**
* @vue/runtime-dom v3.5.4
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ZD;const j5=typeof window<"u"&&window.trustedTypes;if(j5)try{ZD=j5.createPolicy("vue",{createHTML:t=>t})}catch{}const mj=ZD?t=>ZD.createHTML(t):t=>t,OX="http://www.w3.org/2000/svg",RX="http://www.w3.org/1998/Math/MathML",Bc=typeof document<"u"?document:null,U5=Bc&&Bc.createElement("template"),NX={insert:(t,e,r)=>{e.insertBefore(t,r||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,r,n)=>{const s=e==="svg"?Bc.createElementNS(OX,t):e==="mathml"?Bc.createElementNS(RX,t):r?Bc.createElement(t,{is:r}):Bc.createElement(t);return t==="select"&&n&&n.multiple!=null&&s.setAttribute("multiple",n.multiple),s},createText:t=>Bc.createTextNode(t),createComment:t=>Bc.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Bc.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,r,n,s,i){const o=r?r.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),r),!(s===i||!(s=s.nextSibling)););else{U5.innerHTML=mj(n==="svg"?`<svg>${t}</svg>`:n==="mathml"?`<math>${t}</math>`:t);const a=U5.content;if(n==="svg"||n==="mathml"){const u=a.firstChild;for(;u.firstChild;)a.appendChild(u.firstChild);a.removeChild(u)}e.insertBefore(a,r)}return[o?o.nextSibling:e.firstChild,r?r.previousSibling:e.lastChild]}},Bl="transition",vg="animation",Nv=Symbol("_vtc"),yj={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},BX=Wn({},S4,yj),FX=t=>(t.displayName="Transition",t.props=BX,t),MX=FX((t,{slots:e})=>Iu(CJ,jX(t),e)),Lf=(t,e=[])=>{dt(t)?t.forEach(r=>r(...e)):t&&t(...e)},L5=t=>t?dt(t)?t.some(e=>e.length>1):t.length>1:!1;function jX(t){const e={};for(const C in t)C in yj||(e[C]=t[C]);if(t.css===!1)return e;const{name:r="v",type:n,duration:s,enterFromClass:i=`${r}-enter-from`,enterActiveClass:o=`${r}-enter-active`,enterToClass:a=`${r}-enter-to`,appearFromClass:u=i,appearActiveClass:l=o,appearToClass:c=a,leaveFromClass:d=`${r}-leave-from`,leaveActiveClass:h=`${r}-leave-active`,leaveToClass:f=`${r}-leave-to`}=t,p=UX(s),m=p&&p[0],E=p&&p[1],{onBeforeEnter:A,onEnter:_,onEnterCancelled:g,onLeave:v,onLeaveCancelled:S,onBeforeAppear:x=A,onAppear:D=_,onAppearCancelled:w=g}=e,b=(C,k,K)=>{Kf(C,k?c:a),Kf(C,k?l:o),K&&K()},T=(C,k)=>{C._isLeaving=!1,Kf(C,d),Kf(C,f),Kf(C,h),k&&k()},P=C=>(k,K)=>{const L=C?D:_,q=()=>b(k,C,K);Lf(L,[k,q]),K5(()=>{Kf(k,C?u:i),Fl(k,C?c:a),L5(L)||V5(k,n,m,q)})};return Wn(e,{onBeforeEnter(C){Lf(A,[C]),Fl(C,i),Fl(C,o)},onBeforeAppear(C){Lf(x,[C]),Fl(C,u),Fl(C,l)},onEnter:P(!1),onAppear:P(!0),onLeave(C,k){C._isLeaving=!0;const K=()=>T(C,k);Fl(C,d),Fl(C,h),VX(),K5(()=>{C._isLeaving&&(Kf(C,d),Fl(C,f),L5(v)||V5(C,n,E,K))}),Lf(v,[C,K])},onEnterCancelled(C){b(C,!1),Lf(g,[C])},onAppearCancelled(C){b(C,!0),Lf(w,[C])},onLeaveCancelled(C){T(C),Lf(S,[C])}})}function UX(t){if(t==null)return null;if(Mr(t))return[w2(t.enter),w2(t.leave)];{const e=w2(t);return[e,e]}}function w2(t){return J3(t)}function Fl(t,e){e.split(/\s+/).forEach(r=>r&&t.classList.add(r)),(t[Nv]||(t[Nv]=new Set)).add(e)}function Kf(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.remove(n));const r=t[Nv];r&&(r.delete(e),r.size||(t[Nv]=void 0))}function K5(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let LX=0;function V5(t,e,r,n){const s=t._endId=++LX,i=()=>{s===t._endId&&n()};if(r)return setTimeout(i,r);const{type:o,timeout:a,propCount:u}=KX(t,e);if(!o)return n();const l=o+"end";let c=0;const d=()=>{t.removeEventListener(l,h),i()},h=f=>{f.target===t&&++c>=u&&d()};setTimeout(()=>{c<u&&d()},a+1),t.addEventListener(l,h)}function KX(t,e){const r=window.getComputedStyle(t),n=p=>(r[p]||"").split(", "),s=n(`${Bl}Delay`),i=n(`${Bl}Duration`),o=q5(s,i),a=n(`${vg}Delay`),u=n(`${vg}Duration`),l=q5(a,u);let c=null,d=0,h=0;e===Bl?o>0&&(c=Bl,d=o,h=i.length):e===vg?l>0&&(c=vg,d=l,h=u.length):(d=Math.max(o,l),c=d>0?o>l?Bl:vg:null,h=c?c===Bl?i.length:u.length:0);const f=c===Bl&&/\b(transform|all)(,|$)/.test(n(`${Bl}Property`).toString());return{type:c,timeout:d,propCount:h,hasTransform:f}}function q5(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((r,n)=>H5(r)+H5(t[n])))}function H5(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function VX(){return document.body.offsetHeight}function qX(t,e,r){const n=t[Nv];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?t.removeAttribute("class"):r?t.setAttribute("class",e):t.className=e}const z5=Symbol("_vod"),HX=Symbol("_vsh"),zX=Symbol(""),WX=/(^|;)\s*display\s*:/;function GX(t,e,r){const n=t.style,s=an(r);let i=!1;if(r&&!s){if(e)if(an(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();r[a]==null&&i1(n,a,"")}else for(const o in e)r[o]==null&&i1(n,o,"");for(const o in r)o==="display"&&(i=!0),i1(n,o,r[o])}else if(s){if(e!==r){const o=n[zX];o&&(r+=";"+o),n.cssText=r,i=WX.test(r)}}else e&&t.removeAttribute("style");z5 in t&&(t[z5]=i?n.display:"",t[HX]&&(n.display="none"))}const W5=/\s*!important$/;function i1(t,e,r){if(dt(r))r.forEach(n=>i1(t,e,n));else if(r==null&&(r=""),e.startsWith("--"))t.setProperty(e,r);else{const n=JX(t,e);W5.test(r)?t.setProperty($p(n),r.replace(W5,""),"important"):t[n]=r}}const G5=["Webkit","Moz","ms"],_2={};function JX(t,e){const r=_2[e];if(r)return r;let n=Ka(e);if(n!=="filter"&&n in t)return _2[e]=n;n=xA(n);for(let s=0;s<G5.length;s++){const i=G5[s]+n;if(i in t)return _2[e]=i}return e}const J5="http://www.w3.org/1999/xlink";function X5(t,e,r,n,s,i=KG(e)){n&&e.startsWith("xlink:")?r==null?t.removeAttributeNS(J5,e.slice(6,e.length)):t.setAttributeNS(J5,e,r):r==null||i&&!Y3(r)?t.removeAttribute(e):t.setAttribute(e,i?"":zu(r)?String(r):r)}function XX(t,e,r,n){if(e==="innerHTML"||e==="textContent"){r!=null&&(t[e]=e==="innerHTML"?mj(r):r);return}const s=t.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){const o=s==="OPTION"?t.getAttribute("value")||"":t.value,a=r==null?t.type==="checkbox"?"on":"":String(r);(o!==a||!("_value"in t))&&(t.value=a),r==null&&t.removeAttribute(e),t._value=r;return}let i=!1;if(r===""||r==null){const o=typeof t[e];o==="boolean"?r=Y3(r):r==null&&o==="string"?(r="",i=!0):o==="number"&&(r=0,i=!0)}try{t[e]=r}catch{}i&&t.removeAttribute(e)}function Yc(t,e,r,n){t.addEventListener(e,r,n)}function YX(t,e,r,n){t.removeEventListener(e,r,n)}const Y5=Symbol("_vei");function ZX(t,e,r,n,s=null){const i=t[Y5]||(t[Y5]={}),o=i[e];if(n&&o)o.value=n;else{const[a,u]=QX(e);if(n){const l=i[e]=rY(n,s);Yc(t,a,l,u)}else o&&(YX(t,a,o,u),i[e]=void 0)}}const Z5=/(?:Once|Passive|Capture)$/;function QX(t){let e;if(Z5.test(t)){e={};let n;for(;n=t.match(Z5);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):$p(t.slice(2)),e]}let b2=0;const eY=Promise.resolve(),tY=()=>b2||(eY.then(()=>b2=0),b2=Date.now());function rY(t,e){const r=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=r.attached)return;Va(nY(n,r.value),e,5,[n])};return r.value=t,r.attached=tY(),r}function nY(t,e){if(dt(e)){const r=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{r.call(t),t._stopped=!0},e.map(n=>s=>!s._stopped&&n&&n(s))}else return e}const Q5=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,iY=(t,e,r,n,s,i)=>{const o=s==="svg";e==="class"?qX(t,n,o):e==="style"?GX(t,r,n):Tw(e)?wC(e)||ZX(t,e,r,n,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):sY(t,e,n,o))?(XX(t,e,n),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&X5(t,e,n,o,i,e!=="value")):(e==="true-value"?t._trueValue=n:e==="false-value"&&(t._falseValue=n),X5(t,e,n,o))};function sY(t,e,r,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in t&&Q5(e)&&Pt(r));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=t.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Q5(e)&&an(r)?!1:!!(e in t||t._isVueCE&&(/[A-Z]/.test(e)||!an(r)))}const hf=t=>{const e=t.props["onUpdate:modelValue"]||!1;return dt(e)?r=>qm(e,r):e};function oY(t){t.target.composing=!0}function eR(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const ta=Symbol("_assign"),tR={created(t,{modifiers:{lazy:e,trim:r,number:n}},s){t[ta]=hf(s);const i=n||s.props&&s.props.type==="number";Yc(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;r&&(a=a.trim()),i&&(a=rE(a)),t[ta](a)}),r&&Yc(t,"change",()=>{t.value=t.value.trim()}),e||(Yc(t,"compositionstart",oY),Yc(t,"compositionend",eR),Yc(t,"change",eR))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:r,modifiers:{lazy:n,trim:s,number:i}},o){if(t[ta]=hf(o),t.composing)return;const a=(i||t.type==="number")&&!/^0\d/.test(t.value)?rE(t.value):t.value,u=e??"";a!==u&&(document.activeElement===t&&t.type!=="range"&&(n&&e===r||s&&t.value.trim()===u)||(t.value=u))}},aY={deep:!0,created(t,e,r){t[ta]=hf(r),Yc(t,"change",()=>{const n=t._modelValue,s=cy(t),i=t.checked,o=t[ta];if(dt(n)){const a=EC(n,s),u=a!==-1;if(i&&!u)o(n.concat(s));else if(!i&&u){const l=[...n];l.splice(a,1),o(l)}}else if(My(n)){const a=new Set(n);i?a.add(s):a.delete(s),o(a)}else o(gj(t,i))})},mounted:rR,beforeUpdate(t,e,r){t[ta]=hf(r),rR(t,e,r)}};function rR(t,{value:e,oldValue:r},n){t._modelValue=e;let s;dt(e)?s=EC(e,n.props.value)>-1:My(e)?s=e.has(n.props.value):s=dp(e,gj(t,!0)),t.checked!==s&&(t.checked=s)}const uY={created(t,{value:e},r){t.checked=dp(e,r.props.value),t[ta]=hf(r),Yc(t,"change",()=>{t[ta](cy(t))})},beforeUpdate(t,{value:e,oldValue:r},n){t[ta]=hf(n),e!==r&&(t.checked=dp(e,n.props.value))}},cY={deep:!0,created(t,{value:e,modifiers:{number:r}},n){const s=My(e);Yc(t,"change",()=>{const i=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>r?rE(cy(o)):cy(o));t[ta](t.multiple?s?new Set(i):i:i[0]),t._assigning=!0,Ly(()=>{t._assigning=!1})}),t[ta]=hf(n)},mounted(t,{value:e,modifiers:{number:r}}){nR(t,e)},beforeUpdate(t,e,r){t[ta]=hf(r)},updated(t,{value:e,modifiers:{number:r}}){t._assigning||nR(t,e)}};function nR(t,e,r){const n=t.multiple,s=dt(e);if(!(n&&!s&&!My(e))){for(let i=0,o=t.options.length;i<o;i++){const a=t.options[i],u=cy(a);if(n)if(s){const l=typeof u;l==="string"||l==="number"?a.selected=e.some(c=>String(c)===String(u)):a.selected=EC(e,u)>-1}else a.selected=e.has(u);else if(dp(cy(a),e)){t.selectedIndex!==i&&(t.selectedIndex=i);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function cy(t){return"_value"in t?t._value:t.value}function gj(t,e){const r=e?"_trueValue":"_falseValue";return r in t?t[r]:e}const iNe={created(t,e,r){N_(t,e,r,null,"created")},mounted(t,e,r){N_(t,e,r,null,"mounted")},beforeUpdate(t,e,r,n){N_(t,e,r,n,"beforeUpdate")},updated(t,e,r,n){N_(t,e,r,n,"updated")}};function lY(t,e){switch(t){case"SELECT":return cY;case"TEXTAREA":return tR;default:switch(e){case"checkbox":return aY;case"radio":return uY;default:return tR}}}function N_(t,e,r,n,s){const o=lY(t.tagName,r.props&&r.props.type)[s];o&&o(t,e,r,n)}const dY=["ctrl","shift","alt","meta"],fY={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>dY.some(r=>t[`${r}Key`]&&!e.includes(r))},sNe=(t,e)=>{const r=t._withMods||(t._withMods={}),n=e.join(".");return r[n]||(r[n]=(s,...i)=>{for(let o=0;o<e.length;o++){const a=fY[e[o]];if(a&&a(s,e))return}return t(s,...i)})},vj=Wn({patchProp:iY},NX);let Y0,iR=!1;function hY(){return Y0||(Y0=iX(vj))}function pY(){return Y0=iR?Y0:sX(vj),iR=!0,Y0}const mY=(...t)=>{const e=hY().createApp(...t),{mount:r}=e;return e.mount=n=>{const s=_j(n);if(!s)return;const i=e._component;!Pt(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=r(s,!1,wj(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e},yY=(...t)=>{const e=pY().createApp(...t),{mount:r}=e;return e.mount=n=>{const s=_j(n);if(s)return r(s,!0,wj(s))},e};function wj(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function _j(t){return an(t)?document.querySelector(t):t}const gY=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,vY=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,wY=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function _Y(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){bY(t);return}return e}function bY(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function fE(t,e={}){if(typeof t!="string")return t;const r=t.trim();if(t[0]==='"'&&t.endsWith('"')&&!t.includes("\\"))return r.slice(1,-1);if(r.length<=9){const n=r.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!wY.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(gY.test(t)||vY.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,_Y)}return JSON.parse(t)}catch(n){if(e.strict)throw n;return t}}const EY=/#/g,AY=/&/g,SY=/\//g,TY=/=/g,jC=/\+/g,DY=/%5e/gi,xY=/%60/gi,PY=/%7c/gi,CY=/%20/gi;function IY(t){return encodeURI(""+t).replace(PY,"|")}function QD(t){return IY(typeof t=="string"?t:JSON.stringify(t)).replace(jC,"%2B").replace(CY,"+").replace(EY,"%23").replace(AY,"%26").replace(xY,"`").replace(DY,"^").replace(SY,"%2F")}function E2(t){return QD(t).replace(TY,"%3D")}function hE(t=""){try{return decodeURIComponent(""+t)}catch{return""+t}}function kY(t){return hE(t.replace(jC," "))}function $Y(t){return hE(t.replace(jC," "))}function OY(t=""){const e={};t[0]==="?"&&(t=t.slice(1));for(const r of t.split("&")){const n=r.match(/([^=]+)=?(.*)/)||[];if(n.length<2)continue;const s=kY(n[1]);if(s==="__proto__"||s==="constructor")continue;const i=$Y(n[2]||"");e[s]===void 0?e[s]=i:Array.isArray(e[s])?e[s].push(i):e[s]=[e[s],i]}return e}function RY(t,e){return(typeof e=="number"||typeof e=="boolean")&&(e=String(e)),e?Array.isArray(e)?e.map(r=>`${E2(t)}=${QD(r)}`).join("&"):`${E2(t)}=${QD(e)}`:E2(t)}function NY(t){return Object.keys(t).filter(e=>t[e]!==void 0).map(e=>RY(e,t[e])).filter(Boolean).join("&")}const BY=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,FY=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,MY=/^([/\\]\s*){2,}[^/\\]/,jY=/^[\s\0]*(blob|data|javascript|vbscript):$/i,UY=/\/$|\/\?|\/#/,LY=/^\.?\//;function Op(t,e={}){return typeof e=="boolean"&&(e={acceptRelative:e}),e.strict?BY.test(t):FY.test(t)||(e.acceptRelative?MY.test(t):!1)}function KY(t){return!!t&&jY.test(t)}function ex(t="",e){return e?UY.test(t):t.endsWith("/")}function UC(t="",e){if(!e)return(ex(t)?t.slice(0,-1):t)||"/";if(!ex(t,!0))return t||"/";let r=t,n="";const s=t.indexOf("#");s>=0&&(r=t.slice(0,s),n=t.slice(s));const[i,...o]=r.split("?");return((i.endsWith("/")?i.slice(0,-1):i)||"/")+(o.length>0?`?${o.join("?")}`:"")+n}function tx(t="",e){if(!e)return t.endsWith("/")?t:t+"/";if(ex(t,!0))return t||"/";let r=t,n="";const s=t.indexOf("#");if(s>=0&&(r=t.slice(0,s),n=t.slice(s),!r))return n;const[i,...o]=r.split("?");return i+"/"+(o.length>0?`?${o.join("?")}`:"")+n}function VY(t=""){return t.startsWith("/")}function sR(t=""){return VY(t)?t:"/"+t}function qY(t,e){if(Ej(e)||Op(t))return t;const r=UC(e);return t.startsWith(r)?t:LC(r,t)}function oR(t,e){if(Ej(e))return t;const r=UC(e);if(!t.startsWith(r))return t;const n=t.slice(r.length);return n[0]==="/"?n:"/"+n}function bj(t,e){const r=WY(t),n={...OY(r.search),...e};return r.search=NY(n),GY(r)}function Ej(t){return!t||t==="/"}function HY(t){return t&&t!=="/"}function LC(t,...e){let r=t||"";for(const n of e.filter(s=>HY(s)))if(r){const s=n.replace(LY,"");r=tx(r)+s}else r=n;return r}function Aj(...t){var o,a,u,l;const e=/\/(?!\/)/,r=t.filter(Boolean),n=[];let s=0;for(const c of r)if(!(!c||c==="/")){for(const[d,h]of c.split(e).entries())if(!(!h||h===".")){if(h===".."){if(n.length===1&&Op(n[0]))continue;n.pop(),s--;continue}if(d===1&&((o=n[n.length-1])!=null&&o.endsWith(":/"))){n[n.length-1]+="/"+h;continue}n.push(h),s++}}let i=n.join("/");return s>=0?(a=r[0])!=null&&a.startsWith("/")&&!i.startsWith("/")?i="/"+i:(u=r[0])!=null&&u.startsWith("./")&&!i.startsWith("./")&&(i="./"+i):i="../".repeat(-1*s)+i,(l=r[r.length-1])!=null&&l.endsWith("/")&&!i.endsWith("/")&&(i+="/"),i}function zY(t,e,r={}){return r.trailingSlash||(t=tx(t),e=tx(e)),r.leadingSlash||(t=sR(t),e=sR(e)),r.encoding||(t=hE(t),e=hE(e)),t===e}const Sj=Symbol.for("ufo:protocolRelative");function WY(t="",e){const r=t.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(r){const[,d,h=""]=r;return{protocol:d.toLowerCase(),pathname:h,href:d+h,auth:"",host:"",search:"",hash:""}}if(!Op(t,{acceptRelative:!0}))return aR(t);const[,n="",s,i=""]=t.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[];let[,o="",a=""]=i.match(/([^#/?]*)(.*)?/)||[];n==="file:"&&(a=a.replace(/\/(?=[A-Za-z]:)/,""));const{pathname:u,search:l,hash:c}=aR(a);return{protocol:n.toLowerCase(),auth:s?s.slice(0,Math.max(0,s.length-1)):"",host:o,pathname:u,search:l,hash:c,[Sj]:!n}}function aR(t=""){const[e="",r="",n=""]=(t.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:e,search:r,hash:n}}function GY(t){const e=t.pathname||"",r=t.search?(t.search.startsWith("?")?"":"?")+t.search:"",n=t.hash||"",s=t.auth?t.auth+"@":"",i=t.host||"";return(t.protocol||t[Sj]?(t.protocol||"")+"//":"")+s+i+e+r+n}class JY extends Error{constructor(e,r){super(e,r),this.name="FetchError",r!=null&&r.cause&&!this.cause&&(this.cause=r.cause)}}function XY(t){var u,l,c,d,h;const e=((u=t.error)==null?void 0:u.message)||((l=t.error)==null?void 0:l.toString())||"",r=((c=t.request)==null?void 0:c.method)||((d=t.options)==null?void 0:d.method)||"GET",n=((h=t.request)==null?void 0:h.url)||String(t.request)||"/",s=`[${r}] ${JSON.stringify(n)}`,i=t.response?`${t.response.status} ${t.response.statusText}`:"<no response>",o=`${s}: ${i}${e?` ${e}`:""}`,a=new JY(o,t.error?{cause:t.error}:void 0);for(const f of["request","options","response"])Object.defineProperty(a,f,{get(){return t[f]}});for(const[f,p]of[["data","_data"],["status","status"],["statusCode","status"],["statusText","statusText"],["statusMessage","statusText"]])Object.defineProperty(a,f,{get(){return t.response&&t.response[p]}});return a}const YY=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function uR(t="GET"){return YY.has(t.toUpperCase())}function ZY(t){if(t===void 0)return!1;const e=typeof t;return e==="string"||e==="number"||e==="boolean"||e===null?!0:e!=="object"?!1:Array.isArray(t)?!0:t.buffer?!1:t.constructor&&t.constructor.name==="Object"||typeof t.toJSON=="function"}const QY=new Set(["image/svg","application/xml","application/xhtml","application/html"]),eZ=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function tZ(t=""){if(!t)return"json";const e=t.split(";").shift()||"";return eZ.test(e)?"json":QY.has(e)||e.startsWith("text/")?"text":"blob"}function rZ(t,e,r=globalThis.Headers){const n={...e,...t};if(e!=null&&e.params&&(t!=null&&t.params)&&(n.params={...e==null?void 0:e.params,...t==null?void 0:t.params}),e!=null&&e.query&&(t!=null&&t.query)&&(n.query={...e==null?void 0:e.query,...t==null?void 0:t.query}),e!=null&&e.headers&&(t!=null&&t.headers)){n.headers=new r((e==null?void 0:e.headers)||{});for(const[s,i]of new r((t==null?void 0:t.headers)||{}))n.headers.set(s,i)}return n}const nZ=new Set([408,409,425,429,500,502,503,504]),iZ=new Set([101,204,205,304]);function Tj(t={}){const{fetch:e=globalThis.fetch,Headers:r=globalThis.Headers,AbortController:n=globalThis.AbortController}=t;async function s(a){const u=a.error&&a.error.name==="AbortError"&&!a.options.timeout||!1;if(a.options.retry!==!1&&!u){let c;typeof a.options.retry=="number"?c=a.options.retry:c=uR(a.options.method)?0:1;const d=a.response&&a.response.status||500;if(c>0&&(Array.isArray(a.options.retryStatusCodes)?a.options.retryStatusCodes.includes(d):nZ.has(d))){const h=a.options.retryDelay||0;return h>0&&await new Promise(f=>setTimeout(f,h)),i(a.request,{...a.options,retry:c-1})}}const l=XY(a);throw Error.captureStackTrace&&Error.captureStackTrace(l,i),l}const i=async function(u,l={}){var f;const c={request:u,options:rZ(l,t.defaults,r),response:void 0,error:void 0};c.options.method=(f=c.options.method)==null?void 0:f.toUpperCase(),c.options.onRequest&&await c.options.onRequest(c),typeof c.request=="string"&&(c.options.baseURL&&(c.request=qY(c.request,c.options.baseURL)),(c.options.query||c.options.params)&&(c.request=bj(c.request,{...c.options.params,...c.options.query}))),c.options.body&&uR(c.options.method)&&(ZY(c.options.body)?(c.options.body=typeof c.options.body=="string"?c.options.body:JSON.stringify(c.options.body),c.options.headers=new r(c.options.headers||{}),c.options.headers.has("content-type")||c.options.headers.set("content-type","application/json"),c.options.headers.has("accept")||c.options.headers.set("accept","application/json")):("pipeTo"in c.options.body&&typeof c.options.body.pipeTo=="function"||typeof c.options.body.pipe=="function")&&("duplex"in c.options||(c.options.duplex="half")));let d;if(!c.options.signal&&c.options.timeout){const p=new n;d=setTimeout(()=>p.abort(),c.options.timeout),c.options.signal=p.signal}try{c.response=await e(c.request,c.options)}catch(p){return c.error=p,c.options.onRequestError&&await c.options.onRequestError(c),await s(c)}finally{d&&clearTimeout(d)}if(c.response.body&&!iZ.has(c.response.status)&&c.options.method!=="HEAD"){const p=(c.options.parseResponse?"json":c.options.responseType)||tZ(c.response.headers.get("content-type")||"");switch(p){case"json":{const m=await c.response.text(),E=c.options.parseResponse||fE;c.response._data=E(m);break}case"stream":{c.response._data=c.response.body;break}default:c.response._data=await c.response[p]()}}return c.options.onResponse&&await c.options.onResponse(c),!c.options.ignoreResponseError&&c.response.status>=400&&c.response.status<600?(c.options.onResponseError&&await c.options.onResponseError(c),await s(c)):c.response},o=async function(u,l){return(await i(u,l))._data};return o.raw=i,o.native=(...a)=>e(...a),o.create=(a={})=>Tj({...t,defaults:{...t.defaults,...a}}),o}const KC=function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}(),sZ=KC.fetch||(()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!"))),oZ=KC.Headers,aZ=KC.AbortController,uZ=Tj({fetch:sZ,Headers:oZ,AbortController:aZ}),cZ=uZ,lZ=()=>{var t;return((t=window==null?void 0:window.__NUXT__)==null?void 0:t.config)||{}},pE=lZ().app,dZ=()=>pE.baseURL,fZ=()=>pE.buildAssetsDir,VC=(...t)=>Aj(Dj(),fZ(),...t),Dj=(...t)=>{const e=pE.cdnURL||pE.baseURL;return t.length?Aj(e,...t):e};globalThis.__buildAssetsURL=VC,globalThis.__publicAssetsURL=Dj;globalThis.$fetch||(globalThis.$fetch=cZ.create({baseURL:dZ()}));function rx(t,e={},r){for(const n in t){const s=t[n],i=r?`${r}:${n}`:n;typeof s=="object"&&s!==null?rx(s,e,i):typeof s=="function"&&(e[i]=s)}return e}const hZ={run:t=>t()},pZ=()=>hZ,xj=typeof console.createTask<"u"?console.createTask:pZ;function mZ(t,e){const r=e.shift(),n=xj(r);return t.reduce((s,i)=>s.then(()=>n.run(()=>i(...e))),Promise.resolve())}function yZ(t,e){const r=e.shift(),n=xj(r);return Promise.all(t.map(s=>n.run(()=>s(...e))))}function A2(t,e){for(const r of[...t])r(e)}class gZ{constructor(){this._hooks={},this._before=void 0,this._after=void 0,this._deprecatedMessages=void 0,this._deprecatedHooks={},this.hook=this.hook.bind(this),this.callHook=this.callHook.bind(this),this.callHookWith=this.callHookWith.bind(this)}hook(e,r,n={}){if(!e||typeof r!="function")return()=>{};const s=e;let i;for(;this._deprecatedHooks[e];)i=this._deprecatedHooks[e],e=i.to;if(i&&!n.allowDeprecated){let o=i.message;o||(o=`${s} hook has been deprecated`+(i.to?`, please use ${i.to}`:"")),this._deprecatedMessages||(this._deprecatedMessages=new Set),this._deprecatedMessages.has(o)||(console.warn(o),this._deprecatedMessages.add(o))}if(!r.name)try{Object.defineProperty(r,"name",{get:()=>"_"+e.replace(/\W+/g,"_")+"_hook_cb",configurable:!0})}catch{}return this._hooks[e]=this._hooks[e]||[],this._hooks[e].push(r),()=>{r&&(this.removeHook(e,r),r=void 0)}}hookOnce(e,r){let n,s=(...i)=>(typeof n=="function"&&n(),n=void 0,s=void 0,r(...i));return n=this.hook(e,s),n}removeHook(e,r){if(this._hooks[e]){const n=this._hooks[e].indexOf(r);n!==-1&&this._hooks[e].splice(n,1),this._hooks[e].length===0&&delete this._hooks[e]}}deprecateHook(e,r){this._deprecatedHooks[e]=typeof r=="string"?{to:r}:r;const n=this._hooks[e]||[];delete this._hooks[e];for(const s of n)this.hook(e,s)}deprecateHooks(e){Object.assign(this._deprecatedHooks,e);for(const r in e)this.deprecateHook(r,e[r])}addHooks(e){const r=rx(e),n=Object.keys(r).map(s=>this.hook(s,r[s]));return()=>{for(const s of n.splice(0,n.length))s()}}removeHooks(e){const r=rx(e);for(const n in r)this.removeHook(n,r[n])}removeAllHooks(){for(const e in this._hooks)delete this._hooks[e]}callHook(e,...r){return r.unshift(e),this.callHookWith(mZ,e,...r)}callHookParallel(e,...r){return r.unshift(e),this.callHookWith(yZ,e,...r)}callHookWith(e,r,...n){const s=this._before||this._after?{name:r,args:n,context:{}}:void 0;this._before&&A2(this._before,s);const i=e(r in this._hooks?[...this._hooks[r]]:[],n);return i instanceof Promise?i.finally(()=>{this._after&&s&&A2(this._after,s)}):(this._after&&s&&A2(this._after,s),i)}beforeEach(e){return this._before=this._before||[],this._before.push(e),()=>{if(this._before!==void 0){const r=this._before.indexOf(e);r!==-1&&this._before.splice(r,1)}}}afterEach(e){return this._after=this._after||[],this._after.push(e),()=>{if(this._after!==void 0){const r=this._after.indexOf(e);r!==-1&&this._after.splice(r,1)}}}}function Pj(){return new gZ}function vZ(t={}){let e,r=!1;const n=o=>{if(e&&e!==o)throw new Error("Context conflict")};let s;if(t.asyncContext){const o=t.AsyncLocalStorage||globalThis.AsyncLocalStorage;o?s=new o:console.warn("[unctx] `AsyncLocalStorage` is not provided.")}const i=()=>{if(s&&e===void 0){const o=s.getStore();if(o!==void 0)return o}return e};return{use:()=>{const o=i();if(o===void 0)throw new Error("Context is not available");return o},tryUse:()=>i(),set:(o,a)=>{a||n(o),e=o,r=!0},unset:()=>{e=void 0,r=!1},call:(o,a)=>{n(o),e=o;try{return s?s.run(o,a):a()}finally{r||(e=void 0)}},async callAsync(o,a){e=o;const u=()=>{e=o},l=()=>e===o?u:void 0;nx.add(l);try{const c=s?s.run(o,a):a();return r||(e=void 0),await c}finally{nx.delete(l)}}}}function wZ(t={}){const e={};return{get(r,n={}){return e[r]||(e[r]=vZ({...t,...n})),e[r],e[r]}}}const mE=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof global<"u"?global:typeof window<"u"?window:{},cR="__unctx__",_Z=mE[cR]||(mE[cR]=wZ()),bZ=(t,e={})=>_Z.get(t,e),lR="__unctx_async_handlers__",nx=mE[lR]||(mE[lR]=new Set);function Wm(t){const e=[];for(const s of nx){const i=s();i&&e.push(i)}const r=()=>{for(const s of e)s()};let n=t();return n&&typeof n=="object"&&"catch"in n&&(n=n.catch(s=>{throw r(),s})),[n,r]}const ix=!1,EZ=!1,oNe={componentName:"NuxtLink",prefetch:!0,prefetchOn:{visibility:!0}},AZ=null,SZ="#__nuxt",Cj="nuxt-app",dR=36e5;function Ij(t=Cj){return bZ(t,{asyncContext:!1})}const TZ="__nuxt_plugin";function DZ(t){var s;let e=0;const r={_id:t.id||Cj||"nuxt-app",_scope:HG(),provide:void 0,globalName:"nuxt",versions:{get nuxt(){return"3.13.1"},get vue(){return r.vueApp.version}},payload:tl({...((s=t.ssrContext)==null?void 0:s.payload)||{},data:tl({}),state:Sl({}),once:new Set,_errors:tl({})}),static:{data:{}},runWithContext(i){return r._scope.active&&!t4()?r._scope.run(()=>fR(r,i)):fR(r,i)},isHydrating:!0,deferHydration(){if(!r.isHydrating)return()=>{};e++;let i=!1;return()=>{if(!i&&(i=!0,e--,e===0))return r.isHydrating=!1,r.callHook("app:suspense:resolve")}},_asyncDataPromises:{},_asyncData:tl({}),_payloadRevivers:{},...t};{const i=window.__NUXT__;if(i)for(const o in i)switch(o){case"data":case"state":case"_errors":Object.assign(r.payload[o],i[o]);break;default:r.payload[o]=i[o]}}r.hooks=Pj(),r.hook=r.hooks.hook,r.callHook=r.hooks.callHook,r.provide=(i,o)=>{const a="$"+i;B_(r,a,o),B_(r.vueApp.config.globalProperties,a,o)},B_(r.vueApp,"$nuxt",r),B_(r.vueApp.config.globalProperties,"$nuxt",r);{window.addEventListener("nuxt.preloadError",o=>{r.callHook("app:chunkError",{error:o.payload})}),window.useNuxtApp=window.useNuxtApp||Rn;const i=r.hook("app:error",(...o)=>{console.error("[nuxt] error caught during app initialization",...o)});r.hook("app:mounted",i)}const n=r.payload.config;return r.provide("config",n),r}function xZ(t,e){e.hooks&&t.hooks.addHooks(e.hooks)}async function PZ(t,e){if(typeof e=="function"){const{provide:r}=await t.runWithContext(()=>e(t))||{};if(r&&typeof r=="object")for(const n in r)t.provide(n,r[n])}}async function CZ(t,e){const r=[],n=[],s=[],i=[];let o=0;async function a(u){var c;const l=((c=u.dependsOn)==null?void 0:c.filter(d=>e.some(h=>h._name===d)&&!r.includes(d)))??[];if(l.length>0)n.push([new Set(l),u]);else{const d=PZ(t,u).then(async()=>{u._name&&(r.push(u._name),await Promise.all(n.map(async([h,f])=>{h.has(u._name)&&(h.delete(u._name),h.size===0&&(o++,await a(f)))})))});u.parallel?s.push(d.catch(h=>i.push(h))):await d}}for(const u of e)xZ(t,u);for(const u of e)await a(u);if(await Promise.all(s),o)for(let u=0;u<o;u++)await Promise.all(s);if(i.length)throw i[0]}function Dl(t){if(typeof t=="function")return t;const e=t._name||t.name;return delete t.name,Object.assign(t.setup||(()=>{}),t,{[TZ]:!0,_name:e})}function fR(t,e,r){const n=()=>e();return Ij(t._id).set(t),t.vueApp.runWithContext(n)}function IZ(t){var r;let e;return U4()&&(e=(r=FA())==null?void 0:r.appContext.app.$nuxt),e=e||Ij(t).tryUse(),e||null}function Rn(t){const e=IZ(t);if(!e)throw new Error("[nuxt] instance unavailable");return e}function jA(t){return Rn().$config}function B_(t,e,r){Object.defineProperty(t,e,{get:()=>r})}function kZ(t,e){return{ctx:{table:t},matchAll:r=>$j(r,t)}}function kj(t){const e={};for(const r in t)e[r]=r==="dynamic"?new Map(Object.entries(t[r]).map(([n,s])=>[n,kj(s)])):new Map(Object.entries(t[r]));return e}function $Z(t){return kZ(kj(t))}function $j(t,e,r){t.endsWith("/")&&(t=t.slice(0,-1)||"/");const n=[];for(const[i,o]of hR(e.wildcard))(t===i||t.startsWith(i+"/"))&&n.push(o);for(const[i,o]of hR(e.dynamic))if(t.startsWith(i+"/")){const a="/"+t.slice(i.length).split("/").splice(2).join("/");n.push(...$j(a,o))}const s=e.static.get(t);return s&&n.push(s),n.filter(Boolean)}function hR(t){return[...t.entries()].sort((e,r)=>e[0].length-r[0].length)}function S2(t){if(t===null||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e!==null&&e!==Object.prototype&&Object.getPrototypeOf(e)!==null||Symbol.iterator in t?!1:Symbol.toStringTag in t?Object.prototype.toString.call(t)==="[object Module]":!0}function sx(t,e,r=".",n){if(!S2(e))return sx(t,{},r,n);const s=Object.assign({},e);for(const i in t){if(i==="__proto__"||i==="constructor")continue;const o=t[i];o!=null&&(n&&n(s,i,o,r)||(Array.isArray(o)&&Array.isArray(s[i])?s[i]=[...o,...s[i]]:S2(o)&&S2(s[i])?s[i]=sx(o,s[i],(r?`${r}.`:"")+i.toString(),n):s[i]=o))}return s}function OZ(t){return(...e)=>e.reduce((r,n)=>sx(r,n,"",t),{})}const Oj=OZ();function RZ(t,e){try{return e in t}catch{return!1}}var NZ=Object.defineProperty,BZ=(t,e,r)=>e in t?NZ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ph=(t,e,r)=>(BZ(t,typeof e!="symbol"?e+"":e,r),r);class ox extends Error{constructor(e,r={}){super(e,r),ph(this,"statusCode",500),ph(this,"fatal",!1),ph(this,"unhandled",!1),ph(this,"statusMessage"),ph(this,"data"),ph(this,"cause"),r.cause&&!this.cause&&(this.cause=r.cause)}toJSON(){const e={message:this.message,statusCode:ux(this.statusCode,500)};return this.statusMessage&&(e.statusMessage=Rj(this.statusMessage)),this.data!==void 0&&(e.data=this.data),e}}ph(ox,"__h3_error__",!0);function ax(t){if(typeof t=="string")return new ox(t);if(FZ(t))return t;const e=new ox(t.message??t.statusMessage??"",{cause:t.cause||t});if(RZ(t,"stack"))try{Object.defineProperty(e,"stack",{get(){return t.stack}})}catch{try{e.stack=t.stack}catch{}}if(t.data&&(e.data=t.data),t.statusCode?e.statusCode=ux(t.statusCode,e.statusCode):t.status&&(e.statusCode=ux(t.status,e.statusCode)),t.statusMessage?e.statusMessage=t.statusMessage:t.statusText&&(e.statusMessage=t.statusText),e.statusMessage){const r=e.statusMessage;Rj(e.statusMessage)!==r&&console.warn("[h3] Please prefer using `message` for longer error messages instead of `statusMessage`. In the future, `statusMessage` will be sanitized by default.")}return t.fatal!==void 0&&(e.fatal=t.fatal),t.unhandled!==void 0&&(e.unhandled=t.unhandled),e}function FZ(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.__h3_error__)===!0}const MZ=/[^\u0009\u0020-\u007E]/g;function Rj(t=""){return t.replace(MZ,"")}function ux(t,e=200){return!t||(typeof t=="string"&&(t=Number.parseInt(t,10)),t<100||t>999)?e:t}const jZ=Symbol("layout-meta"),UA=Symbol("route"),qa=()=>{var t;return(t=Rn())==null?void 0:t.$router},Nj=()=>U4()?Ks(UA,Rn()._route):Rn()._route;const UZ=()=>{try{if(Rn()._processingMiddleware)return!0}catch{return!1}return!1},aNe=(t,e)=>{t||(t="/");const r=typeof t=="string"?t:"path"in t?LZ(t):qa().resolve(t).href;if(e!=null&&e.open){const{target:u="_blank",windowFeatures:l={}}=e.open,c=Object.entries(l).filter(([d,h])=>h!==void 0).map(([d,h])=>`${d.toLowerCase()}=${h}`).join(", ");return open(r,u,c),Promise.resolve()}const n=Op(r,{acceptRelative:!0}),s=(e==null?void 0:e.external)||n;if(s){if(!(e!=null&&e.external))throw new Error("Navigating to an external URL is not allowed by default. Use `navigateTo(url, { external: true })`.");const{protocol:u}=new URL(r,window.location.href);if(u&&KY(u))throw new Error(`Cannot navigate to a URL with '${u}' protocol.`)}const i=UZ();if(!s&&i)return t;const o=qa(),a=Rn();return s?(a._scope.stop(),e!=null&&e.replace?location.replace(r):location.href=r,i?a.isHydrating?new Promise(()=>{}):!1:Promise.resolve()):e!=null&&e.replace?o.replace(t):o.push(t)};function LZ(t){return bj(t.path||"",t.query||{})+(t.hash||"")}const Bj="__nuxt_error",LA=()=>vJ(Rn().payload,"error"),Rm=t=>{const e=KA(t);try{const r=Rn(),n=LA();r.hooks.callHook("app:error",e),n.value=n.value||e}catch{throw e}return e},KZ=async(t={})=>{const e=Rn(),r=LA();e.callHook("app:error:cleared",t),t.redirect&&await qa().replace(t.redirect),r.value=AZ},VZ=t=>!!t&&typeof t=="object"&&Bj in t,KA=t=>{const e=ax(t);return Object.defineProperty(e,Bj,{value:!0,configurable:!1,writable:!1}),e},qZ=-1,HZ=-2,zZ=-3,WZ=-4,GZ=-5,JZ=-6;function XZ(t,e){return YZ(JSON.parse(t),e)}function YZ(t,e){if(typeof t=="number")return s(t,!0);if(!Array.isArray(t)||t.length===0)throw new Error("Invalid input");const r=t,n=Array(r.length);function s(i,o=!1){if(i===qZ)return;if(i===zZ)return NaN;if(i===WZ)return 1/0;if(i===GZ)return-1/0;if(i===JZ)return-0;if(o)throw new Error("Invalid input");if(i in n)return n[i];const a=r[i];if(!a||typeof a!="object")n[i]=a;else if(Array.isArray(a))if(typeof a[0]=="string"){const u=a[0],l=e==null?void 0:e[u];if(l)return n[i]=l(s(a[1]));switch(u){case"Date":n[i]=new Date(a[1]);break;case"Set":const c=new Set;n[i]=c;for(let f=1;f<a.length;f+=1)c.add(s(a[f]));break;case"Map":const d=new Map;n[i]=d;for(let f=1;f<a.length;f+=2)d.set(s(a[f]),s(a[f+1]));break;case"RegExp":n[i]=new RegExp(a[1],a[2]);break;case"Object":n[i]=Object(a[1]);break;case"BigInt":n[i]=BigInt(a[1]);break;case"null":const h=Object.create(null);n[i]=h;for(let f=1;f<a.length;f+=2)h[a[f]]=s(a[f+1]);break;default:throw new Error(`Unknown type ${u}`)}}else{const u=new Array(a.length);n[i]=u;for(let l=0;l<a.length;l+=1){const c=a[l];c!==HZ&&(u[l]=s(c))}}else{const u={};n[i]=u;for(const l in a){const c=a[l];u[l]=s(c)}}return n[i]}return s(0)}const ZZ=new Set(["title","titleTemplate","script","style","noscript"]),s1=new Set(["base","meta","link","style","script","noscript"]),QZ=new Set(["title","titleTemplate","templateParams","base","htmlAttrs","bodyAttrs","meta","link","style","script","noscript"]),eQ=new Set(["base","title","titleTemplate","bodyAttrs","htmlAttrs","templateParams"]),Fj=new Set(["tagPosition","tagPriority","tagDuplicateStrategy","children","innerHTML","textContent","processTemplateParams"]),tQ=typeof window<"u";function yE(t){let e=9;for(let r=0;r<t.length;)e=Math.imul(e^t.charCodeAt(r++),9**9);return((e^e>>>9)+65536).toString(16).substring(1,8).toLowerCase()}function cx(t){if(t._h)return t._h;if(t._d)return yE(t._d);let e=`${t.tag}:${t.textContent||t.innerHTML||""}:`;for(const r in t.props)e+=`${r}:${String(t.props[r])},`;return yE(e)}function rQ(t,e){return t instanceof Promise?t.then(e):e(t)}function lx(t,e,r,n){const s=n||jj(typeof e=="object"&&typeof e!="function"&&!(e instanceof Promise)?{...e}:{[t==="script"||t==="noscript"||t==="style"?"innerHTML":"textContent"]:e},t==="templateParams"||t==="titleTemplate");if(s instanceof Promise)return s.then(o=>lx(t,e,r,o));const i={tag:t,props:s};for(const o of Fj){const a=i.props[o]!==void 0?i.props[o]:r[o];a!==void 0&&((!(o==="innerHTML"||o==="textContent"||o==="children")||ZZ.has(i.tag))&&(i[o==="children"?"innerHTML":o]=a),delete i.props[o])}return i.props.body&&(i.tagPosition="bodyClose",delete i.props.body),i.tag==="script"&&typeof i.innerHTML=="object"&&(i.innerHTML=JSON.stringify(i.innerHTML),i.props.type=i.props.type||"application/json"),Array.isArray(i.props.content)?i.props.content.map(o=>({...i,props:{...i.props,content:o}})):i}function nQ(t,e){var n;const r=t==="class"?" ":";";return e&&typeof e=="object"&&!Array.isArray(e)&&(e=Object.entries(e).filter(([,s])=>s).map(([s,i])=>t==="style"?`${s}:${i}`:s)),(n=String(Array.isArray(e)?e.join(r):e))==null?void 0:n.split(r).filter(s=>!!s.trim()).join(r)}function Mj(t,e,r,n){for(let s=n;s<r.length;s+=1){const i=r[s];if(i==="class"||i==="style"){t[i]=nQ(i,t[i]);continue}if(t[i]instanceof Promise)return t[i].then(o=>(t[i]=o,Mj(t,e,r,s)));if(!e&&!Fj.has(i)){const o=String(t[i]),a=i.startsWith("data-");o==="true"||o===""?t[i]=a?"true":!0:t[i]||(a&&o==="false"?t[i]="false":delete t[i])}}}function jj(t,e=!1){const r=Mj(t,e,Object.keys(t),0);return r instanceof Promise?r.then(()=>t):t}const iQ=10;function Uj(t,e,r){for(let n=r;n<e.length;n+=1){const s=e[n];if(s instanceof Promise)return s.then(i=>(e[n]=i,Uj(t,e,n)));Array.isArray(s)?t.push(...s):t.push(s)}}function sQ(t){const e=[],r=t.resolvedInput;for(const s in r){if(!Object.prototype.hasOwnProperty.call(r,s))continue;const i=r[s];if(!(i===void 0||!QZ.has(s))){if(Array.isArray(i)){for(const o of i)e.push(lx(s,o,t));continue}e.push(lx(s,i,t))}}if(e.length===0)return[];const n=[];return rQ(Uj(n,e,0),()=>n.map((s,i)=>(s._e=t._i,t.mode&&(s._m=t.mode),s._p=(t._i<<iQ)+i,s)))}const pR=new Set(["onload","onerror","onabort","onprogress","onloadstart"]),mR={base:-10,title:10},yR={critical:-80,high:-10,low:20};function gE(t){const e=t.tagPriority;if(typeof e=="number")return e;let r=100;return t.tag==="meta"?t.props["http-equiv"]==="content-security-policy"?r=-30:t.props.charset?r=-20:t.props.name==="viewport"&&(r=-15):t.tag==="link"&&t.props.rel==="preconnect"?r=20:t.tag in mR&&(r=mR[t.tag]),e&&e in yR?r+yR[e]:r}const oQ=[{prefix:"before:",offset:-1},{prefix:"after:",offset:1}],aQ=["name","property","http-equiv"];function Lj(t){const{props:e,tag:r}=t;if(eQ.has(r))return r;if(r==="link"&&e.rel==="canonical")return"canonical";if(e.charset)return"charset";if(e.id)return`${r}:id:${e.id}`;for(const n of aQ)if(e[n]!==void 0)return`${r}:${n}:${e[n]}`;return!1}const Id="%separator";function uQ(t,e){var n;let r;if(e==="s"||e==="pageTitle")r=t.pageTitle;else if(e.includes(".")){const s=e.indexOf(".");r=(n=t[e.substring(0,s)])==null?void 0:n[e.substring(s+1)]}else r=t[e];return r!==void 0?(r||"").replace(/"/g,'\\"'):void 0}const cQ=new RegExp(`${Id}(?:\\s*${Id})*`,"g");function F_(t,e,r){if(typeof t!="string"||!t.includes("%"))return t;let n=t;try{n=decodeURI(t)}catch{}const s=n.match(/%\w+(?:\.\w+)?/g);if(!s)return t;const i=t.includes(Id);return t=t.replace(/%\w+(?:\.\w+)?/g,o=>{if(o===Id||!s.includes(o))return o;const a=uQ(e,o.slice(1));return a!==void 0?a:o}).trim(),i&&(t.endsWith(Id)&&(t=t.slice(0,-Id.length)),t.startsWith(Id)&&(t=t.slice(Id.length)),t=t.replace(cQ,r).trim()),t}function gR(t,e){return t==null?e||null:typeof t=="function"?t(e):t}async function Kj(t,e={}){const r=e.document||t.resolvedOptions.document;if(!r||!t.dirty)return;const n={shouldRender:!0,tags:[]};if(await t.hooks.callHook("dom:beforeRender",n),!!n.shouldRender)return t._domUpdatePromise||(t._domUpdatePromise=new Promise(async s=>{var d;const i=(await t.resolveTags()).map(h=>({tag:h,id:s1.has(h.tag)?cx(h):h.tag,shouldRender:!0}));let o=t._dom;if(!o){o={elMap:{htmlAttrs:r.documentElement,bodyAttrs:r.body}};const h=new Set;for(const f of["body","head"]){const p=(d=r[f])==null?void 0:d.children;for(const m of p){const E=m.tagName.toLowerCase();if(!s1.has(E))continue;const A={tag:E,props:await jj(m.getAttributeNames().reduce((S,x)=>({...S,[x]:m.getAttribute(x)}),{})),innerHTML:m.innerHTML},_=Lj(A);let g=_,v=1;for(;g&&h.has(g);)g=`${_}:${v++}`;g&&(A._d=g,h.add(g)),o.elMap[m.getAttribute("data-hid")||cx(A)]=m}}}o.pendingSideEffects={...o.sideEffects},o.sideEffects={};function a(h,f,p){const m=`${h}:${f}`;o.sideEffects[m]=p,delete o.pendingSideEffects[m]}function u({id:h,$el:f,tag:p}){const m=p.tag.endsWith("Attrs");if(o.elMap[h]=f,m||(p.textContent&&p.textContent!==f.textContent&&(f.textContent=p.textContent),p.innerHTML&&p.innerHTML!==f.innerHTML&&(f.innerHTML=p.innerHTML),a(h,"el",()=>{var E;(E=o.elMap[h])==null||E.remove(),delete o.elMap[h]})),p._eventHandlers)for(const E in p._eventHandlers)Object.prototype.hasOwnProperty.call(p._eventHandlers,E)&&f.getAttribute(`data-${E}`)!==""&&((p.tag==="bodyAttrs"?r.defaultView:f).addEventListener(E.substring(2),p._eventHandlers[E].bind(f)),f.setAttribute(`data-${E}`,""));for(const E in p.props){if(!Object.prototype.hasOwnProperty.call(p.props,E))continue;const A=p.props[E],_=`attr:${E}`;if(E==="class"){if(!A)continue;for(const g of A.split(" "))m&&a(h,`${_}:${g}`,()=>f.classList.remove(g)),!f.classList.contains(g)&&f.classList.add(g)}else if(E==="style"){if(!A)continue;for(const g of A.split(";")){const v=g.indexOf(":"),S=g.substring(0,v).trim(),x=g.substring(v+1).trim();a(h,`${_}:${S}`,()=>{f.style.removeProperty(S)}),f.style.setProperty(S,x)}}else f.getAttribute(E)!==A&&f.setAttribute(E,A===!0?"":String(A)),m&&a(h,_,()=>f.removeAttribute(E))}}const l=[],c={bodyClose:void 0,bodyOpen:void 0,head:void 0};for(const h of i){const{tag:f,shouldRender:p,id:m}=h;if(p){if(f.tag==="title"){r.title=f.textContent;continue}h.$el=h.$el||o.elMap[m],h.$el?u(h):s1.has(f.tag)&&l.push(h)}}for(const h of l){const f=h.tag.tagPosition||"head";h.$el=r.createElement(h.tag.tag),u(h),c[f]=c[f]||r.createDocumentFragment(),c[f].appendChild(h.$el)}for(const h of i)await t.hooks.callHook("dom:renderTag",h,r,a);c.head&&r.head.appendChild(c.head),c.bodyOpen&&r.body.insertBefore(c.bodyOpen,r.body.firstChild),c.bodyClose&&r.body.appendChild(c.bodyClose);for(const h in o.pendingSideEffects)o.pendingSideEffects[h]();t._dom=o,await t.hooks.callHook("dom:rendered",{renders:i}),s()}).finally(()=>{t._domUpdatePromise=void 0,t.dirty=!1})),t._domUpdatePromise}function lQ(t,e={}){const r=e.delayFn||(n=>setTimeout(n,10));return t._domDebouncedUpdatePromise=t._domDebouncedUpdatePromise||new Promise(n=>r(()=>Kj(t,e).then(()=>{delete t._domDebouncedUpdatePromise,n()})))}function dQ(t){return e=>{var n,s;const r=((s=(n=e.resolvedOptions.document)==null?void 0:n.head.querySelector('script[id="unhead:payload"]'))==null?void 0:s.innerHTML)||!1;return r&&e.push(JSON.parse(r)),{mode:"client",hooks:{"entries:updated":i=>{lQ(i,t)}}}}}const fQ=new Set(["templateParams","htmlAttrs","bodyAttrs"]),hQ={hooks:{"tag:normalise":({tag:t})=>{t.props.hid&&(t.key=t.props.hid,delete t.props.hid),t.props.vmid&&(t.key=t.props.vmid,delete t.props.vmid),t.props.key&&(t.key=t.props.key,delete t.props.key);const e=Lj(t);e&&!e.startsWith("meta:og:")&&!e.startsWith("meta:twitter:")&&delete t.key;const r=e||(t.key?`${t.tag}:${t.key}`:!1);r&&(t._d=r)},"tags:resolve":t=>{const e=Object.create(null);for(const n of t.tags){const s=(n.key?`${n.tag}:${n.key}`:n._d)||cx(n),i=e[s];if(i){let a=n==null?void 0:n.tagDuplicateStrategy;if(!a&&fQ.has(n.tag)&&(a="merge"),a==="merge"){const u=i.props;u.style&&n.props.style&&(u.style[u.style.length-1]!==";"&&(u.style+=";"),n.props.style=`${u.style} ${n.props.style}`),u.class&&n.props.class?n.props.class=`${u.class} ${n.props.class}`:u.class&&(n.props.class=u.class),e[s].props={...u,...n.props};continue}else if(n._e===i._e){i._duped=i._duped||[],n._d=`${i._d}:${i._duped.length+1}`,i._duped.push(n);continue}else if(gE(n)>gE(i))continue}if(!(n.innerHTML||n.textContent||Object.keys(n.props).length!==0)&&s1.has(n.tag)){delete e[s];continue}e[s]=n}const r=[];for(const n in e){const s=e[n],i=s._duped;r.push(s),i&&(delete s._duped,r.push(...i))}t.tags=r,t.tags=t.tags.filter(n=>!(n.tag==="meta"&&(n.props.name||n.props.property)&&!n.props.content))}}},pQ=new Set(["script","link","bodyAttrs"]),mQ=t=>({hooks:{"tags:resolve":e=>{for(const r of e.tags){if(!pQ.has(r.tag))continue;const n=r.props;for(const s in n){if(s[0]!=="o"||s[1]!=="n"||!Object.prototype.hasOwnProperty.call(n,s))continue;const i=n[s];typeof i=="function"&&(t.ssr&&pR.has(s)?n[s]=`this.dataset.${s}fired = true`:delete n[s],r._eventHandlers=r._eventHandlers||{},r._eventHandlers[s]=i)}t.ssr&&r._eventHandlers&&(r.props.src||r.props.href)&&(r.key=r.key||yE(r.props.src||r.props.href))}},"dom:renderTag":({$el:e,tag:r})=>{var s,i;const n=e==null?void 0:e.dataset;if(n)for(const o in n){if(!o.endsWith("fired"))continue;const a=o.slice(0,-5);pR.has(a)&&((i=(s=r._eventHandlers)==null?void 0:s[a])==null||i.call(e,new Event(a.substring(2))))}}}}),yQ=new Set(["link","style","script","noscript"]),gQ={hooks:{"tag:normalise":({tag:t})=>{t.key&&yQ.has(t.tag)&&(t.props["data-hid"]=t._h=yE(t.key))}}},vQ={mode:"server",hooks:{"tags:beforeResolve":t=>{const e={};let r=!1;for(const n of t.tags)n._m!=="server"||n.tag!=="titleTemplate"&&n.tag!=="templateParams"&&n.tag!=="title"||(e[n.tag]=n.tag==="title"||n.tag==="titleTemplate"?n.textContent:n.props,r=!0);r&&t.tags.push({tag:"script",innerHTML:JSON.stringify(e),props:{id:"unhead:payload",type:"application/json"}})}}},wQ={hooks:{"tags:resolve":t=>{var e;for(const r of t.tags)if(typeof r.tagPriority=="string")for(const{prefix:n,offset:s}of oQ){if(!r.tagPriority.startsWith(n))continue;const i=r.tagPriority.substring(n.length),o=(e=t.tags.find(a=>a._d===i))==null?void 0:e._p;if(o!==void 0){r._p=o+s;break}}t.tags.sort((r,n)=>{const s=gE(r),i=gE(n);return s<i?-1:s>i?1:r._p-n._p})}}},_Q={meta:"content",link:"href",htmlAttrs:"lang"},bQ=["innerHTML","textContent"],EQ=t=>({hooks:{"tags:resolve":e=>{var o;const{tags:r}=e;let n;for(let a=0;a<r.length;a+=1)r[a].tag==="templateParams"&&(n=e.tags.splice(a,1)[0].props,a-=1);const s=n||{},i=s.separator||"|";delete s.separator,s.pageTitle=F_(s.pageTitle||((o=r.find(a=>a.tag==="title"))==null?void 0:o.textContent)||"",s,i);for(const a of r){if(a.processTemplateParams===!1)continue;const u=_Q[a.tag];if(u&&typeof a.props[u]=="string")a.props[u]=F_(a.props[u],s,i);else if(a.processTemplateParams||a.tag==="titleTemplate"||a.tag==="title")for(const l of bQ)typeof a[l]=="string"&&(a[l]=F_(a[l],s,i))}t._templateParams=s,t._separator=i},"tags:afterResolve":({tags:e})=>{let r;for(let n=0;n<e.length;n+=1){const s=e[n];s.tag==="title"&&s.processTemplateParams!==!1&&(r=s)}r!=null&&r.textContent&&(r.textContent=F_(r.textContent,t._templateParams,t._separator))}}}),AQ={hooks:{"tags:resolve":t=>{const{tags:e}=t;let r,n;for(let s=0;s<e.length;s+=1){const i=e[s];i.tag==="title"?r=i:i.tag==="titleTemplate"&&(n=i)}if(n&&r){const s=gR(n.textContent,r.textContent);s!==null?r.textContent=s||r.textContent:t.tags.splice(t.tags.indexOf(r),1)}else if(n){const s=gR(n.textContent);s!==null&&(n.textContent=s,n.tag="title",n=void 0)}n&&t.tags.splice(t.tags.indexOf(n),1)}}},SQ={hooks:{"tags:afterResolve":t=>{for(const e of t.tags)typeof e.innerHTML=="string"&&(e.innerHTML&&(e.props.type==="application/ld+json"||e.props.type==="application/json")?e.innerHTML=e.innerHTML.replace(/</g,"\\u003C"):e.innerHTML=e.innerHTML.replace(new RegExp(`</${e.tag}`,"g"),`<\\/${e.tag}`))}}};let Vj;function TQ(t={}){const e=DQ(t);return e.use(dQ()),Vj=e}function vR(t,e){return!t||t==="server"&&e||t==="client"&&!e}function DQ(t={}){const e=Pj();e.addHooks(t.hooks||{}),t.document=t.document||(tQ?document:void 0);const r=!t.document,n=()=>{a.dirty=!0,e.callHook("entries:updated",a)};let s=0,i=[];const o=[],a={plugins:o,dirty:!1,resolvedOptions:t,hooks:e,headEntries(){return i},use(u){const l=typeof u=="function"?u(a):u;(!l.key||!o.some(c=>c.key===l.key))&&(o.push(l),vR(l.mode,r)&&e.addHooks(l.hooks||{}))},push(u,l){l==null||delete l.head;const c={_i:s++,input:u,...l};return vR(c.mode,r)&&(i.push(c),n()),{dispose(){i=i.filter(d=>d._i!==c._i),n()},patch(d){for(const h of i)h._i===c._i&&(h.input=c.input=d);n()}}},async resolveTags(){const u={tags:[],entries:[...i]};await e.callHook("entries:resolve",u);for(const l of u.entries){const c=l.resolvedInput||l.input;if(l.resolvedInput=await(l.transform?l.transform(c):c),l.resolvedInput)for(const d of await sQ(l)){const h={tag:d,entry:l,resolvedOptions:a.resolvedOptions};await e.callHook("tag:normalise",h),u.tags.push(h.tag)}}return await e.callHook("tags:beforeResolve",u),await e.callHook("tags:resolve",u),await e.callHook("tags:afterResolve",u),u.tags},ssr:r};return[hQ,vQ,mQ,gQ,wQ,EQ,AQ,SQ,...(t==null?void 0:t.plugins)||[]].forEach(u=>a.use(u)),a.hooks.callHook("init",a),a}function xQ(){return Vj}const PQ=pj[0]==="3";function CQ(t){return typeof t=="function"?t():on(t)}function vE(t){if(t instanceof Promise||t instanceof Date||t instanceof RegExp)return t;const e=CQ(t);if(!t||!e)return e;if(Array.isArray(e))return e.map(r=>vE(r));if(typeof e=="object"){const r={};for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(n==="titleTemplate"||n[0]==="o"&&n[1]==="n"){r[n]=on(e[n]);continue}r[n]=vE(e[n])}return r}return e}const IQ={hooks:{"entries:resolve":t=>{for(const e of t.entries)e.resolvedInput=vE(e.input)}}},qj="usehead";function kQ(t){return{install(r){PQ&&(r.config.globalProperties.$unhead=t,r.config.globalProperties.$head=t,r.provide(qj,t))}}.install}function $Q(t={}){t.domDelayFn=t.domDelayFn||(r=>Ly(()=>setTimeout(()=>r(),0)));const e=TQ(t);return e.use(IQ),e.install=kQ(e),e}const dx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},fx="__unhead_injection_handler__";function OQ(t){dx[fx]=t}function RQ(){if(fx in dx)return dx[fx]();const t=Ks(qj);return t||xQ()}function NQ(t,e={}){const r=e.head||RQ();if(r)return r.ssr?r.push(t,e):BQ(r,t,e)}function BQ(t,e,r={}){const n=Bu(!1),s=Bu({});cX(()=>{s.value=n.value?{}:vE(e)});const i=t.push(s.value,r);return Yd(s,a=>{i.patch(a)}),FA()&&(NA(()=>{i.dispose()}),I4(()=>{n.value=!0}),C4(()=>{n.value=!1})),i}let o1,a1;function FQ(){return o1=$fetch(VC(`builds/meta/${jA().app.buildId}.json`),{responseType:"json"}),o1.then(t=>{a1=$Z(t.matcher)}).catch(t=>{console.error("[nuxt] Error fetching app manifest.",t)}),o1}function VA(){return o1||FQ()}async function qC(t){if(await VA(),!a1)return console.error("[nuxt] Error creating app manifest matcher.",a1),{};try{return Oj({},...a1.matchAll(t).reverse())}catch(e){return console.error("[nuxt] Error matching route rules.",e),{}}}async function wR(t,e={}){const r=await jQ(t,e),n=Rn(),s=n._payloadCache=n._payloadCache||{};return r in s||(s[r]=zj(t).then(i=>i?Hj(r).then(o=>o||(delete s[r],null)):(s[r]=null,null))),s[r]}const MQ="_payload.json";async function jQ(t,e={}){const r=new URL(t,"http://localhost");if(r.host!=="localhost"||Op(r.pathname,{acceptRelative:!0}))throw new Error("Payload URL must not include hostname: "+t);const n=jA(),s=e.hash||(e.fresh?Date.now():n.app.buildId),i=n.app.cdnURL,o=i&&await zj(t)?i:n.app.baseURL;return LC(o,r.pathname,MQ+(s?`?${s}`:""))}async function Hj(t){const e=fetch(t).then(r=>r.text().then(Wj));try{return await e}catch(r){console.warn("[nuxt] Cannot load payload ",t,r)}return null}async function zj(t=Nj().path){if(t=UC(t),(await VA()).prerendered.includes(t))return!0;const r=await qC(t);return!!r.prerender&&!r.redirect}let Vf=null;async function UQ(){var n;if(Vf)return Vf;const t=document.getElementById("__NUXT_DATA__");if(!t)return{};const e=await Wj(t.textContent||""),r=t.dataset.src?await Hj(t.dataset.src):void 0;return Vf={...e,...r,...window.__NUXT__},(n=Vf.config)!=null&&n.public&&(Vf.config.public=Sl(Vf.config.public)),Vf}async function Wj(t){return await XZ(t,Rn()._payloadRevivers)}function LQ(t,e){Rn()._payloadRevivers[t]=e}const _R={NuxtError:t=>KA(t),EmptyShallowRef:t=>Iv(t==="_"?void 0:t==="0n"?BigInt(0):fE(t)),EmptyRef:t=>Bu(t==="_"?void 0:t==="0n"?BigInt(0):fE(t)),ShallowRef:t=>Iv(t),ShallowReactive:t=>tl(t),Ref:t=>Bu(t),Reactive:t=>Sl(t)},KQ=Dl({name:"nuxt:revive-payload:client",order:-30,async setup(t){let e,r;for(const n in _R)LQ(n,_R[n]);Object.assign(t.payload,([e,r]=Wm(()=>t.runWithContext(UQ)),e=await e,r(),e)),window.__NUXT__=t.payload}}),VQ=[],qQ=Dl({name:"nuxt:head",enforce:"pre",setup(t){const e=$Q({plugins:VQ});OQ(()=>Rn().vueApp._context.provides.usehead),t.vueApp.use(e);{let r=!0;const n=async()=>{r=!1,await Kj(e)};e.hooks.hook("dom:beforeRender",s=>{s.shouldRender=!r}),t.hooks.hook("page:start",()=>{r=!0}),t.hooks.hook("page:finish",()=>{t.isHydrating||n()}),t.hooks.hook("app:error",n),t.hooks.hook("app:suspense:resolve",n)}}});/*!
  * vue-router v4.4.4
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const wm=typeof document<"u";function Gj(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function HQ(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&Gj(t.default)}const Cr=Object.assign;function T2(t,e){const r={};for(const n in e){const s=e[n];r[n]=Ha(s)?s.map(t):t(s)}return r}const Z0=()=>{},Ha=Array.isArray,Jj=/#/g,zQ=/&/g,WQ=/\//g,GQ=/=/g,JQ=/\?/g,Xj=/\+/g,XQ=/%5B/g,YQ=/%5D/g,Yj=/%5E/g,ZQ=/%60/g,Zj=/%7B/g,QQ=/%7C/g,Qj=/%7D/g,eee=/%20/g;function HC(t){return encodeURI(""+t).replace(QQ,"|").replace(XQ,"[").replace(YQ,"]")}function tee(t){return HC(t).replace(Zj,"{").replace(Qj,"}").replace(Yj,"^")}function hx(t){return HC(t).replace(Xj,"%2B").replace(eee,"+").replace(Jj,"%23").replace(zQ,"%26").replace(ZQ,"`").replace(Zj,"{").replace(Qj,"}").replace(Yj,"^")}function ree(t){return hx(t).replace(GQ,"%3D")}function nee(t){return HC(t).replace(Jj,"%23").replace(JQ,"%3F")}function iee(t){return t==null?"":nee(t).replace(WQ,"%2F")}function Bv(t){try{return decodeURIComponent(""+t)}catch{}return""+t}const see=/\/$/,oee=t=>t.replace(see,"");function D2(t,e,r="/"){let n,s={},i="",o="";const a=e.indexOf("#");let u=e.indexOf("?");return a<u&&a>=0&&(u=-1),u>-1&&(n=e.slice(0,u),i=e.slice(u+1,a>-1?a:e.length),s=t(i)),a>-1&&(n=n||e.slice(0,a),o=e.slice(a,e.length)),n=lee(n??e,r),{fullPath:n+(i&&"?")+i+o,path:n,query:s,hash:Bv(o)}}function aee(t,e){const r=e.query?t(e.query):"";return e.path+(r&&"?")+r+(e.hash||"")}function bR(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function uee(t,e,r){const n=e.matched.length-1,s=r.matched.length-1;return n>-1&&n===s&&ly(e.matched[n],r.matched[s])&&eU(e.params,r.params)&&t(e.query)===t(r.query)&&e.hash===r.hash}function ly(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function eU(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(!cee(t[r],e[r]))return!1;return!0}function cee(t,e){return Ha(t)?ER(t,e):Ha(e)?ER(e,t):t===e}function ER(t,e){return Ha(e)?t.length===e.length&&t.every((r,n)=>r===e[n]):t.length===1&&t[0]===e}function lee(t,e){if(t.startsWith("/"))return t;if(!t)return e;const r=e.split("/"),n=t.split("/"),s=n[n.length-1];(s===".."||s===".")&&n.push("");let i=r.length-1,o,a;for(o=0;o<n.length;o++)if(a=n[o],a!==".")if(a==="..")i>1&&i--;else break;return r.slice(0,i).join("/")+"/"+n.slice(o).join("/")}const Ta={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Fv;(function(t){t.pop="pop",t.push="push"})(Fv||(Fv={}));var Q0;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Q0||(Q0={}));function dee(t){if(!t)if(wm){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),oee(t)}const fee=/^[^#]+#/;function hee(t,e){return t.replace(fee,"#")+e}function pee(t,e){const r=document.documentElement.getBoundingClientRect(),n=t.getBoundingClientRect();return{behavior:e.behavior,left:n.left-r.left-(e.left||0),top:n.top-r.top-(e.top||0)}}const qA=()=>({left:window.scrollX,top:window.scrollY});function mee(t){let e;if("el"in t){const r=t.el,n=typeof r=="string"&&r.startsWith("#"),s=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!s)return;e=pee(s,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function AR(t,e){return(history.state?history.state.position-e:-1)+t}const px=new Map;function yee(t,e){px.set(t,e)}function gee(t){const e=px.get(t);return px.delete(t),e}let vee=()=>location.protocol+"//"+location.host;function tU(t,e){const{pathname:r,search:n,hash:s}=e,i=t.indexOf("#");if(i>-1){let a=s.includes(t.slice(i))?t.slice(i).length:1,u=s.slice(a);return u[0]!=="/"&&(u="/"+u),bR(u,"")}return bR(r,t)+n+s}function wee(t,e,r,n){let s=[],i=[],o=null;const a=({state:h})=>{const f=tU(t,location),p=r.value,m=e.value;let E=0;if(h){if(r.value=f,e.value=h,o&&o===p){o=null;return}E=m?h.position-m.position:0}else n(f);s.forEach(A=>{A(r.value,p,{delta:E,type:Fv.pop,direction:E?E>0?Q0.forward:Q0.back:Q0.unknown})})};function u(){o=r.value}function l(h){s.push(h);const f=()=>{const p=s.indexOf(h);p>-1&&s.splice(p,1)};return i.push(f),f}function c(){const{history:h}=window;h.state&&h.replaceState(Cr({},h.state,{scroll:qA()}),"")}function d(){for(const h of i)h();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",c)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",c,{passive:!0}),{pauseListeners:u,listen:l,destroy:d}}function SR(t,e,r,n=!1,s=!1){return{back:t,current:e,forward:r,replaced:n,position:window.history.length,scroll:s?qA():null}}function _ee(t){const{history:e,location:r}=window,n={value:tU(t,r)},s={value:e.state};s.value||i(n.value,{back:null,current:n.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(u,l,c){const d=t.indexOf("#"),h=d>-1?(r.host&&document.querySelector("base")?t:t.slice(d))+u:vee()+t+u;try{e[c?"replaceState":"pushState"](l,"",h),s.value=l}catch(f){console.error(f),r[c?"replace":"assign"](h)}}function o(u,l){const c=Cr({},e.state,SR(s.value.back,u,s.value.forward,!0),l,{position:s.value.position});i(u,c,!0),n.value=u}function a(u,l){const c=Cr({},s.value,e.state,{forward:u,scroll:qA()});i(c.current,c,!0);const d=Cr({},SR(n.value,u,null),{position:c.position+1},l);i(u,d,!1),n.value=u}return{location:n,state:s,push:a,replace:o}}function rU(t){t=dee(t);const e=_ee(t),r=wee(t,e.state,e.location,e.replace);function n(i,o=!0){o||r.pauseListeners(),history.go(i)}const s=Cr({location:"",base:t,go:n,createHref:hee.bind(null,t)},e,r);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function bee(t){return t=location.host?t||location.pathname+location.search:"",t.includes("#")||(t+="#"),rU(t)}function Eee(t){return typeof t=="string"||t&&typeof t=="object"}function nU(t){return typeof t=="string"||typeof t=="symbol"}const iU=Symbol("");var TR;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(TR||(TR={}));function dy(t,e){return Cr(new Error,{type:t,[iU]:!0},e)}function hc(t,e){return t instanceof Error&&iU in t&&(e==null||!!(t.type&e))}const DR="[^/]+?",Aee={sensitive:!1,strict:!1,start:!0,end:!0},See=/[.+*?^${}()[\]/\\]/g;function Tee(t,e){const r=Cr({},Aee,e),n=[];let s=r.start?"^":"";const i=[];for(const l of t){const c=l.length?[]:[90];r.strict&&!l.length&&(s+="/");for(let d=0;d<l.length;d++){const h=l[d];let f=40+(r.sensitive?.25:0);if(h.type===0)d||(s+="/"),s+=h.value.replace(See,"\\$&"),f+=40;else if(h.type===1){const{value:p,repeatable:m,optional:E,regexp:A}=h;i.push({name:p,repeatable:m,optional:E});const _=A||DR;if(_!==DR){f+=10;try{new RegExp(`(${_})`)}catch(v){throw new Error(`Invalid custom RegExp for param "${p}" (${_}): `+v.message)}}let g=m?`((?:${_})(?:/(?:${_}))*)`:`(${_})`;d||(g=E&&l.length<2?`(?:/${g})`:"/"+g),E&&(g+="?"),s+=g,f+=20,E&&(f+=-8),m&&(f+=-20),_===".*"&&(f+=-50)}c.push(f)}n.push(c)}if(r.strict&&r.end){const l=n.length-1;n[l][n[l].length-1]+=.7000000000000001}r.strict||(s+="/?"),r.end?s+="$":r.strict&&(s+="(?:/|$)");const o=new RegExp(s,r.sensitive?"":"i");function a(l){const c=l.match(o),d={};if(!c)return null;for(let h=1;h<c.length;h++){const f=c[h]||"",p=i[h-1];d[p.name]=f&&p.repeatable?f.split("/"):f}return d}function u(l){let c="",d=!1;for(const h of t){(!d||!c.endsWith("/"))&&(c+="/"),d=!1;for(const f of h)if(f.type===0)c+=f.value;else if(f.type===1){const{value:p,repeatable:m,optional:E}=f,A=p in l?l[p]:"";if(Ha(A)&&!m)throw new Error(`Provided param "${p}" is an array but it is not repeatable (* or + modifiers)`);const _=Ha(A)?A.join("/"):A;if(!_)if(E)h.length<2&&(c.endsWith("/")?c=c.slice(0,-1):d=!0);else throw new Error(`Missing required param "${p}"`);c+=_}}return c||"/"}return{re:o,score:n,keys:i,parse:a,stringify:u}}function Dee(t,e){let r=0;for(;r<t.length&&r<e.length;){const n=e[r]-t[r];if(n)return n;r++}return t.length<e.length?t.length===1&&t[0]===80?-1:1:t.length>e.length?e.length===1&&e[0]===80?1:-1:0}function sU(t,e){let r=0;const n=t.score,s=e.score;for(;r<n.length&&r<s.length;){const i=Dee(n[r],s[r]);if(i)return i;r++}if(Math.abs(s.length-n.length)===1){if(xR(n))return 1;if(xR(s))return-1}return s.length-n.length}function xR(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const xee={type:0,value:""},Pee=/[a-zA-Z0-9_]/;function Cee(t){if(!t)return[[]];if(t==="/")return[[xee]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(f){throw new Error(`ERR (${r})/"${l}": ${f}`)}let r=0,n=r;const s=[];let i;function o(){i&&s.push(i),i=[]}let a=0,u,l="",c="";function d(){l&&(r===0?i.push({type:0,value:l}):r===1||r===2||r===3?(i.length>1&&(u==="*"||u==="+")&&e(`A repeatable param (${l}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:l,regexp:c,repeatable:u==="*"||u==="+",optional:u==="*"||u==="?"})):e("Invalid state to consume buffer"),l="")}function h(){l+=u}for(;a<t.length;){if(u=t[a++],u==="\\"&&r!==2){n=r,r=4;continue}switch(r){case 0:u==="/"?(l&&d(),o()):u===":"?(d(),r=1):h();break;case 4:h(),r=n;break;case 1:u==="("?r=2:Pee.test(u)?h():(d(),r=0,u!=="*"&&u!=="?"&&u!=="+"&&a--);break;case 2:u===")"?c[c.length-1]=="\\"?c=c.slice(0,-1)+u:r=3:c+=u;break;case 3:d(),r=0,u!=="*"&&u!=="?"&&u!=="+"&&a--,c="";break;default:e("Unknown state");break}}return r===2&&e(`Unfinished custom RegExp for param "${l}"`),d(),o(),s}function Iee(t,e,r){const n=Tee(Cee(t.path),r),s=Cr(n,{record:t,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function kee(t,e){const r=[],n=new Map;e=IR({strict:!1,end:!0,sensitive:!1},e);function s(d){return n.get(d)}function i(d,h,f){const p=!f,m=$ee(d);m.aliasOf=f&&f.record;const E=IR(e,d),A=[m];if("alias"in d){const v=typeof d.alias=="string"?[d.alias]:d.alias;for(const S of v)A.push(Cr({},m,{components:f?f.record.components:m.components,path:S,aliasOf:f?f.record:m}))}let _,g;for(const v of A){const{path:S}=v;if(h&&S[0]!=="/"){const x=h.record.path,D=x[x.length-1]==="/"?"":"/";v.path=h.record.path+(S&&D+S)}if(_=Iee(v,h,E),f?f.alias.push(_):(g=g||_,g!==_&&g.alias.push(_),p&&d.name&&!CR(_)&&o(d.name)),oU(_)&&u(_),m.children){const x=m.children;for(let D=0;D<x.length;D++)i(x[D],_,f&&f.children[D])}f=f||_}return g?()=>{o(g)}:Z0}function o(d){if(nU(d)){const h=n.get(d);h&&(n.delete(d),r.splice(r.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=r.indexOf(d);h>-1&&(r.splice(h,1),d.record.name&&n.delete(d.record.name),d.children.forEach(o),d.alias.forEach(o))}}function a(){return r}function u(d){const h=Nee(d,r);r.splice(h,0,d),d.record.name&&!CR(d)&&n.set(d.record.name,d)}function l(d,h){let f,p={},m,E;if("name"in d&&d.name){if(f=n.get(d.name),!f)throw dy(1,{location:d});E=f.record.name,p=Cr(PR(h.params,f.keys.filter(g=>!g.optional).concat(f.parent?f.parent.keys.filter(g=>g.optional):[]).map(g=>g.name)),d.params&&PR(d.params,f.keys.map(g=>g.name))),m=f.stringify(p)}else if(d.path!=null)m=d.path,f=r.find(g=>g.re.test(m)),f&&(p=f.parse(m),E=f.record.name);else{if(f=h.name?n.get(h.name):r.find(g=>g.re.test(h.path)),!f)throw dy(1,{location:d,currentLocation:h});E=f.record.name,p=Cr({},h.params,d.params),m=f.stringify(p)}const A=[];let _=f;for(;_;)A.unshift(_.record),_=_.parent;return{name:E,path:m,params:p,matched:A,meta:Ree(A)}}t.forEach(d=>i(d));function c(){r.length=0,n.clear()}return{addRoute:i,resolve:l,removeRoute:o,clearRoutes:c,getRoutes:a,getRecordMatcher:s}}function PR(t,e){const r={};for(const n of e)n in t&&(r[n]=t[n]);return r}function $ee(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:Oee(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},mods:{},components:"components"in t?t.components||null:t.component&&{default:t.component}}}function Oee(t){const e={},r=t.props||!1;if("component"in t)e.default=r;else for(const n in t.components)e[n]=typeof r=="object"?r[n]:r;return e}function CR(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function Ree(t){return t.reduce((e,r)=>Cr(e,r.meta),{})}function IR(t,e){const r={};for(const n in t)r[n]=n in e?e[n]:t[n];return r}function Nee(t,e){let r=0,n=e.length;for(;r!==n;){const i=r+n>>1;sU(t,e[i])<0?n=i:r=i+1}const s=Bee(t);return s&&(n=e.lastIndexOf(s,n-1)),n}function Bee(t){let e=t;for(;e=e.parent;)if(oU(e)&&sU(t,e)===0)return e}function oU({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function Fee(t){const e={};if(t===""||t==="?")return e;const n=(t[0]==="?"?t.slice(1):t).split("&");for(let s=0;s<n.length;++s){const i=n[s].replace(Xj," "),o=i.indexOf("="),a=Bv(o<0?i:i.slice(0,o)),u=o<0?null:Bv(i.slice(o+1));if(a in e){let l=e[a];Ha(l)||(l=e[a]=[l]),l.push(u)}else e[a]=u}return e}function kR(t){let e="";for(let r in t){const n=t[r];if(r=ree(r),n==null){n!==void 0&&(e+=(e.length?"&":"")+r);continue}(Ha(n)?n.map(i=>i&&hx(i)):[n&&hx(n)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+r,i!=null&&(e+="="+i))})}return e}function Mee(t){const e={};for(const r in t){const n=t[r];n!==void 0&&(e[r]=Ha(n)?n.map(s=>s==null?null:""+s):n==null?n:""+n)}return e}const jee=Symbol(""),$R=Symbol(""),HA=Symbol(""),aU=Symbol(""),mx=Symbol("");function wg(){let t=[];function e(n){return t.push(n),()=>{const s=t.indexOf(n);s>-1&&t.splice(s,1)}}function r(){t=[]}return{add:e,list:()=>t.slice(),reset:r}}function kd(t,e,r,n,s,i=o=>o()){const o=n&&(n.enterCallbacks[s]=n.enterCallbacks[s]||[]);return()=>new Promise((a,u)=>{const l=h=>{h===!1?u(dy(4,{from:r,to:e})):h instanceof Error?u(h):Eee(h)?u(dy(2,{from:e,to:h})):(o&&n.enterCallbacks[s]===o&&typeof h=="function"&&o.push(h),a())},c=i(()=>t.call(n&&n.instances[s],e,r,l));let d=Promise.resolve(c);t.length<3&&(d=d.then(l)),d.catch(h=>u(h))})}function x2(t,e,r,n,s=i=>i()){const i=[];for(const o of t)for(const a in o.components){let u=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(Gj(u)){const c=(u.__vccOpts||u)[e];c&&i.push(kd(c,r,n,o,a,s))}else{let l=u();i.push(()=>l.then(c=>{if(!c)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const d=HQ(c)?c.default:c;o.mods[a]=c,o.components[a]=d;const f=(d.__vccOpts||d)[e];return f&&kd(f,r,n,o,a,s)()}))}}return i}function OR(t){const e=Ks(HA),r=Ks(aU),n=Ia(()=>{const u=on(t.to);return e.resolve(u)}),s=Ia(()=>{const{matched:u}=n.value,{length:l}=u,c=u[l-1],d=r.matched;if(!c||!d.length)return-1;const h=d.findIndex(ly.bind(null,c));if(h>-1)return h;const f=RR(u[l-2]);return l>1&&RR(c)===f&&d[d.length-1].path!==f?d.findIndex(ly.bind(null,u[l-2])):h}),i=Ia(()=>s.value>-1&&Vee(r.params,n.value.params)),o=Ia(()=>s.value>-1&&s.value===r.matched.length-1&&eU(r.params,n.value.params));function a(u={}){return Kee(u)?e[on(t.replace)?"replace":"push"](on(t.to)).catch(Z0):Promise.resolve()}return{route:n,href:Ia(()=>n.value.href),isActive:i,isExactActive:o,navigate:a}}const Uee=Ky({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:OR,setup(t,{slots:e}){const r=Sl(OR(t)),{options:n}=Ks(HA),s=Ia(()=>({[NR(t.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[NR(t.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const i=e.default&&e.default(r);return t.custom?i:Iu("a",{"aria-current":r.isExactActive?t.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:s.value},i)}}}),Lee=Uee;function Kee(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function Vee(t,e){for(const r in e){const n=e[r],s=t[r];if(typeof n=="string"){if(n!==s)return!1}else if(!Ha(s)||s.length!==n.length||n.some((i,o)=>i!==s[o]))return!1}return!0}function RR(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const NR=(t,e,r)=>t??e??r,qee=Ky({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:r}){const n=Ks(mx),s=Ia(()=>t.route||n.value),i=Ks($R,0),o=Ia(()=>{let l=on(i);const{matched:c}=s.value;let d;for(;(d=c[l])&&!d.components;)l++;return l}),a=Ia(()=>s.value.matched[o.value]);Jh($R,Ia(()=>o.value+1)),Jh(jee,a),Jh(mx,s);const u=Bu();return Yd(()=>[u.value,a.value,t.name],([l,c,d],[h,f,p])=>{c&&(c.instances[d]=l,f&&f!==c&&l&&l===h&&(c.leaveGuards.size||(c.leaveGuards=f.leaveGuards),c.updateGuards.size||(c.updateGuards=f.updateGuards))),l&&c&&(!f||!ly(c,f)||!h)&&(c.enterCallbacks[d]||[]).forEach(m=>m(l))},{flush:"post"}),()=>{const l=s.value,c=t.name,d=a.value,h=d&&d.components[c];if(!h)return BR(r.default,{Component:h,route:l});const f=d.props[c],p=f?f===!0?l.params:typeof f=="function"?f(l):f:null,E=Iu(h,Cr({},p,e,{onVnodeUnmounted:A=>{A.component.isUnmounted&&(d.instances[c]=null)},ref:u}));return BR(r.default,{Component:E,route:l})||E}}});function BR(t,e){if(!t)return null;const r=t(e);return r.length===1?r[0]:r}const uU=qee;function Hee(t){const e=kee(t.routes,t),r=t.parseQuery||Fee,n=t.stringifyQuery||kR,s=t.history,i=wg(),o=wg(),a=wg(),u=Iv(Ta);let l=Ta;wm&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const c=T2.bind(null,ne=>""+ne),d=T2.bind(null,iee),h=T2.bind(null,Bv);function f(ne,le){let me,ve;return nU(ne)?(me=e.getRecordMatcher(ne),ve=le):ve=ne,e.addRoute(ve,me)}function p(ne){const le=e.getRecordMatcher(ne);le&&e.removeRoute(le)}function m(){return e.getRoutes().map(ne=>ne.record)}function E(ne){return!!e.getRecordMatcher(ne)}function A(ne,le){if(le=Cr({},le||u.value),typeof ne=="string"){const V=D2(r,ne,le.path),oe=e.resolve({path:V.path},le),j=s.createHref(V.fullPath);return Cr(V,oe,{params:h(oe.params),hash:Bv(V.hash),redirectedFrom:void 0,href:j})}let me;if(ne.path!=null)me=Cr({},ne,{path:D2(r,ne.path,le.path).path});else{const V=Cr({},ne.params);for(const oe in V)V[oe]==null&&delete V[oe];me=Cr({},ne,{params:d(V)}),le.params=d(le.params)}const ve=e.resolve(me,le),Pe=ne.hash||"";ve.params=c(h(ve.params));const Ue=aee(n,Cr({},ne,{hash:tee(Pe),path:ve.path})),M=s.createHref(Ue);return Cr({fullPath:Ue,hash:Pe,query:n===kR?Mee(ne.query):ne.query||{}},ve,{redirectedFrom:void 0,href:M})}function _(ne){return typeof ne=="string"?D2(r,ne,u.value.path):Cr({},ne)}function g(ne,le){if(l!==ne)return dy(8,{from:le,to:ne})}function v(ne){return D(ne)}function S(ne){return v(Cr(_(ne),{replace:!0}))}function x(ne){const le=ne.matched[ne.matched.length-1];if(le&&le.redirect){const{redirect:me}=le;let ve=typeof me=="function"?me(ne):me;return typeof ve=="string"&&(ve=ve.includes("?")||ve.includes("#")?ve=_(ve):{path:ve},ve.params={}),Cr({query:ne.query,hash:ne.hash,params:ve.path!=null?{}:ne.params},ve)}}function D(ne,le){const me=l=A(ne),ve=u.value,Pe=ne.state,Ue=ne.force,M=ne.replace===!0,V=x(me);if(V)return D(Cr(_(V),{state:typeof V=="object"?Cr({},Pe,V.state):Pe,force:Ue,replace:M}),le||me);const oe=me;oe.redirectedFrom=le;let j;return!Ue&&uee(n,ve,me)&&(j=dy(16,{to:oe,from:ve}),B(ve,ve,!0,!1)),(j?Promise.resolve(j):T(oe,ve)).catch(I=>hc(I)?hc(I,2)?I:W(I):X(I,oe,ve)).then(I=>{if(I){if(hc(I,2))return D(Cr({replace:M},_(I.to),{state:typeof I.to=="object"?Cr({},Pe,I.to.state):Pe,force:Ue}),le||oe)}else I=C(oe,ve,!0,M,Pe);return P(oe,ve,I),I})}function w(ne,le){const me=g(ne,le);return me?Promise.reject(me):Promise.resolve()}function b(ne){const le=$.values().next().value;return le&&typeof le.runWithContext=="function"?le.runWithContext(ne):ne()}function T(ne,le){let me;const[ve,Pe,Ue]=zee(ne,le);me=x2(ve.reverse(),"beforeRouteLeave",ne,le);for(const V of ve)V.leaveGuards.forEach(oe=>{me.push(kd(oe,ne,le))});const M=w.bind(null,ne,le);return me.push(M),ee(me).then(()=>{me=[];for(const V of i.list())me.push(kd(V,ne,le));return me.push(M),ee(me)}).then(()=>{me=x2(Pe,"beforeRouteUpdate",ne,le);for(const V of Pe)V.updateGuards.forEach(oe=>{me.push(kd(oe,ne,le))});return me.push(M),ee(me)}).then(()=>{me=[];for(const V of Ue)if(V.beforeEnter)if(Ha(V.beforeEnter))for(const oe of V.beforeEnter)me.push(kd(oe,ne,le));else me.push(kd(V.beforeEnter,ne,le));return me.push(M),ee(me)}).then(()=>(ne.matched.forEach(V=>V.enterCallbacks={}),me=x2(Ue,"beforeRouteEnter",ne,le,b),me.push(M),ee(me))).then(()=>{me=[];for(const V of o.list())me.push(kd(V,ne,le));return me.push(M),ee(me)}).catch(V=>hc(V,8)?V:Promise.reject(V))}function P(ne,le,me){a.list().forEach(ve=>b(()=>ve(ne,le,me)))}function C(ne,le,me,ve,Pe){const Ue=g(ne,le);if(Ue)return Ue;const M=le===Ta,V=wm?history.state:{};me&&(ve||M?s.replace(ne.fullPath,Cr({scroll:M&&V&&V.scroll},Pe)):s.push(ne.fullPath,Pe)),u.value=ne,B(ne,le,me,M),W()}let k;function K(){k||(k=s.listen((ne,le,me)=>{if(!F.listening)return;const ve=A(ne),Pe=x(ve);if(Pe){D(Cr(Pe,{replace:!0}),ve).catch(Z0);return}l=ve;const Ue=u.value;wm&&yee(AR(Ue.fullPath,me.delta),qA()),T(ve,Ue).catch(M=>hc(M,12)?M:hc(M,2)?(D(M.to,ve).then(V=>{hc(V,20)&&!me.delta&&me.type===Fv.pop&&s.go(-1,!1)}).catch(Z0),Promise.reject()):(me.delta&&s.go(-me.delta,!1),X(M,ve,Ue))).then(M=>{M=M||C(ve,Ue,!1),M&&(me.delta&&!hc(M,8)?s.go(-me.delta,!1):me.type===Fv.pop&&hc(M,20)&&s.go(-1,!1)),P(ve,Ue,M)}).catch(Z0)}))}let L=wg(),q=wg(),se;function X(ne,le,me){W(ne);const ve=q.list();return ve.length?ve.forEach(Pe=>Pe(ne,le,me)):console.error(ne),Promise.reject(ne)}function re(){return se&&u.value!==Ta?Promise.resolve():new Promise((ne,le)=>{L.add([ne,le])})}function W(ne){return se||(se=!ne,K(),L.list().forEach(([le,me])=>ne?me(ne):le()),L.reset()),ne}function B(ne,le,me,ve){const{scrollBehavior:Pe}=t;if(!wm||!Pe)return Promise.resolve();const Ue=!me&&gee(AR(ne.fullPath,0))||(ve||!me)&&history.state&&history.state.scroll||null;return Ly().then(()=>Pe(ne,le,Ue)).then(M=>M&&mee(M)).catch(M=>X(M,ne,le))}const te=ne=>s.go(ne);let z;const $=new Set,F={currentRoute:u,listening:!0,addRoute:f,removeRoute:p,clearRoutes:e.clearRoutes,hasRoute:E,getRoutes:m,resolve:A,options:t,push:v,replace:S,go:te,back:()=>te(-1),forward:()=>te(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:q.add,isReady:re,install(ne){const le=this;ne.component("RouterLink",Lee),ne.component("RouterView",uU),ne.config.globalProperties.$router=le,Object.defineProperty(ne.config.globalProperties,"$route",{enumerable:!0,get:()=>on(u)}),wm&&!z&&u.value===Ta&&(z=!0,v(s.location).catch(Pe=>{}));const me={};for(const Pe in Ta)Object.defineProperty(me,Pe,{get:()=>u.value[Pe],enumerable:!0});ne.provide(HA,le),ne.provide(aU,tl(me)),ne.provide(mx,u);const ve=ne.unmount;$.add(ne),ne.unmount=function(){$.delete(ne),$.size<1&&(l=Ta,k&&k(),k=null,u.value=Ta,z=!1,se=!1),ve()}}};function ee(ne){return ne.reduce((le,me)=>le.then(()=>b(me)),Promise.resolve())}return F}function zee(t,e){const r=[],n=[],s=[],i=Math.max(e.matched.length,t.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(t.matched.find(l=>ly(l,a))?n.push(a):r.push(a));const u=t.matched[o];u&&(e.matched.find(l=>ly(l,u))||s.push(u))}return[r,n,s]}function Wee(){return Ks(HA)}const Gee=(t,e)=>e.path.replace(/(:\w+)\([^)]+\)/g,"$1").replace(/(:\w+)[?+*]/g,"$1").replace(/:\w+/g,r=>{var n;return((n=t.params[r.slice(1)])==null?void 0:n.toString())||""}),yx=(t,e)=>{const r=t.route.matched.find(s=>{var i;return((i=s.components)==null?void 0:i.default)===t.Component.type}),n=e??(r==null?void 0:r.meta.key)??(r&&Gee(t.route,r));return typeof n=="function"?n(t.route):n},Jee=(t,e)=>({default:()=>t?Iu(BJ,t===!0?{}:t,e):e});function zC(t){return Array.isArray(t)?t:[t]}const Xee="modulepreload",Yee=function(t,e){return new URL(t,e).href},FR={},Zee=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){const i=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(r.map(u=>{if(u=Yee(u,n),u in FR)return;FR[u]=!0;const l=u.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(!!n)for(let f=i.length-1;f>=0;f--){const p=i[f];if(p.href===u&&(!l||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${u}"]${c}`))return;const h=document.createElement("link");if(h.rel=l?"stylesheet":Xee,l||(h.as="script"),h.crossOrigin="",h.href=u,a&&h.setAttribute("nonce",a),document.head.appendChild(h),l)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${u}`)))})}))}return s.then(i=>{for(const o of i||[]){if(o.status!=="rejected")continue;const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o.reason,window.dispatchEvent(a),!a.defaultPrevented)throw o.reason}return e()})},Nm=(...t)=>Zee(...t).catch(e=>{const r=new Event("nuxt.preloadError");throw r.payload=e,window.dispatchEvent(r),e}),P2=[{name:"credentials",path:"/credentials",component:()=>Nm(()=>import("./poMTNPwX.js"),__vite__mapDeps([0,1,2]),import.meta.url).then(t=>t.default||t)},{name:"dashboard",path:"/dashboard",component:()=>Nm(()=>import("./CDAHeyLu.js"),__vite__mapDeps([3,1,2,4,5,6,7]),import.meta.url).then(t=>t.default||t)},{name:"donate",path:"/donate",component:()=>Nm(()=>import("./fa5uTXjd.js"),__vite__mapDeps([8,1,2,5,6]),import.meta.url).then(t=>t.default||t)},{name:"login",path:"/login",component:()=>Nm(()=>import("./BDw1-wBm.js"),__vite__mapDeps([9,1,2]),import.meta.url).then(t=>t.default||t)}],Qee=(t,e,r)=>(e=e===!0?{}:e,{default:()=>{var n;return e?Iu(t,e,r):(n=r.default)==null?void 0:n.call(r)}});function MR(t){const e=(t==null?void 0:t.meta.key)??t.path.replace(/(:\w+)\([^)]+\)/g,"$1").replace(/(:\w+)[?+*]/g,"$1").replace(/:\w+/g,r=>{var n;return((n=t.params[r.slice(1)])==null?void 0:n.toString())||""});return typeof e=="function"?e(t):e}function ete(t,e){return t===e||e===Ta?!1:MR(t)!==MR(e)?!0:!t.matched.every((n,s)=>{var i,o;return n.components&&n.components.default===((o=(i=e.matched[s])==null?void 0:i.components)==null?void 0:o.default)})}const tte={scrollBehavior(t,e,r){var l;const n=Rn(),s=((l=qa().options)==null?void 0:l.scrollBehaviorType)??"auto";let i=r||void 0;const o=typeof t.meta.scrollToTop=="function"?t.meta.scrollToTop(t,e):t.meta.scrollToTop;if(!i&&e&&t&&o!==!1&&ete(t,e)&&(i={left:0,top:0}),t.path===e.path)return e.hash&&!t.hash?{left:0,top:0}:t.hash?{el:t.hash,top:jR(t.hash),behavior:s}:!1;const a=c=>!!(c.meta.pageTransition??ix),u=a(e)&&a(t)?"page:transition:finish":"page:finish";return new Promise(c=>{n.hooks.hookOnce(u,async()=>{await new Promise(d=>setTimeout(d,0)),t.hash&&(i={el:t.hash,top:jR(t.hash),behavior:s}),c(i)})})}};function jR(t){try{const e=document.querySelector(t);if(e)return(Number.parseFloat(getComputedStyle(e).scrollMarginTop)||0)+(Number.parseFloat(getComputedStyle(document.documentElement).scrollPaddingTop)||0)}catch{}return 0}const rte={hashMode:!1,scrollBehaviorType:"auto"},Po={...rte,...tte},nte=async t=>{var u;let e,r;if(!((u=t.meta)!=null&&u.validate))return;const n=Rn(),s=qa(),i=([e,r]=Wm(()=>Promise.resolve(t.meta.validate(t))),e=await e,r(),e);if(i===!0)return;const o=KA({statusCode:i&&i.statusCode||404,statusMessage:i&&i.statusMessage||`Page Not Found: ${t.fullPath}`,data:{path:t.fullPath}}),a=s.beforeResolve(l=>{if(a(),l===t){const c=s.afterEach(async()=>{c(),await n.runWithContext(()=>Rm(o)),window==null||window.history.pushState({},"",t.fullPath)});return!1}})},ite=async t=>{let e,r;const n=([e,r]=Wm(()=>qC(t.path)),e=await e,r(),e);if(n.redirect)return Op(n.redirect,{acceptRelative:!0})?(window.location.href=n.redirect,!1):n.redirect},ste=[nte,ite],ev={};function ote(t,e,r){const{pathname:n,search:s,hash:i}=e,o=t.indexOf("#");if(o>-1){const l=i.includes(t.slice(o))?t.slice(o).length:1;let c=i.slice(l);return c[0]!=="/"&&(c="/"+c),oR(c,"")}const a=oR(n,t),u=!r||zY(a,r,{trailingSlash:!0})?a:r;return u+(u.includes("?")?"":s)+i}const ate=Dl({name:"nuxt:router",enforce:"pre",async setup(t){var E;let e,r,n=jA().app.baseURL;Po.hashMode&&!n.includes("#")&&(n+="#");const s=((E=Po.history)==null?void 0:E.call(Po,n))??(Po.hashMode?bee(n):rU(n)),i=Po.routes?([e,r]=Wm(()=>Po.routes(P2)),e=await e,r(),e??P2):P2;let o;const a=Hee({...Po,scrollBehavior:(A,_,g)=>{if(_===Ta){o=g;return}if(Po.scrollBehavior){if(a.options.scrollBehavior=Po.scrollBehavior,"scrollRestoration"in window.history){const v=a.beforeEach(()=>{v(),window.history.scrollRestoration="manual"})}return Po.scrollBehavior(A,Ta,o||g)}},history:s,routes:i});"scrollRestoration"in window.history&&(window.history.scrollRestoration="auto"),t.vueApp.use(a);const u=Iv(a.currentRoute.value);a.afterEach((A,_)=>{u.value=_}),Object.defineProperty(t.vueApp.config.globalProperties,"previousRoute",{get:()=>u.value});const l=ote(n,window.location,t.payload.path),c=Iv(a.currentRoute.value),d=()=>{c.value=a.currentRoute.value};t.hook("page:finish",d),a.afterEach((A,_)=>{var g,v,S,x;((v=(g=A.matched[0])==null?void 0:g.components)==null?void 0:v.default)===((x=(S=_.matched[0])==null?void 0:S.components)==null?void 0:x.default)&&d()});const h={};for(const A in c.value)Object.defineProperty(h,A,{get:()=>c.value[A]});t._route=tl(h),t._middleware=t._middleware||{global:[],named:{}};const f=LA();a.afterEach(async(A,_,g)=>{delete t._processingMiddleware,!t.isHydrating&&f.value&&await t.runWithContext(KZ),g&&await t.callHook("page:loading:end"),A.matched.length===0&&await t.runWithContext(()=>Rm(ax({statusCode:404,fatal:!1,statusMessage:`Page not found: ${A.fullPath}`,data:{path:A.fullPath}})))});try{[e,r]=Wm(()=>a.isReady()),await e,r()}catch(A){[e,r]=Wm(()=>t.runWithContext(()=>Rm(A))),await e,r()}const p=l!==a.currentRoute.value.fullPath?a.resolve(l):a.currentRoute.value;d();const m=t.payload.state._layout;return a.beforeEach(async(A,_)=>{var g;await t.callHook("page:loading:start"),A.meta=Sl(A.meta),t.isHydrating&&m&&!ff(A.meta.layout)&&(A.meta.layout=m),t._processingMiddleware=!0;{const v=new Set([...ste,...t._middleware.global]);for(const S of A.matched){const x=S.meta.middleware;if(x)for(const D of zC(x))v.add(D)}{const S=await t.runWithContext(()=>qC(A.path));if(S.appMiddleware)for(const x in S.appMiddleware)S.appMiddleware[x]?v.add(x):v.delete(x)}for(const S of v){const x=typeof S=="string"?t._middleware.named[S]||await((g=ev[S])==null?void 0:g.call(ev).then(w=>w.default||w)):S;if(!x)throw new Error(`Unknown route middleware: '${S}'.`);const D=await t.runWithContext(()=>x(A,_));if(!t.payload.serverRendered&&t.isHydrating&&(D===!1||D instanceof Error)){const w=D||ax({statusCode:404,statusMessage:`Page Not Found: ${l}`});return await t.runWithContext(()=>Rm(w)),!1}if(D!==!0&&(D||D===!1))return D}}}),a.onError(async()=>{delete t._processingMiddleware,await t.callHook("page:loading:end")}),t.hooks.hookOnce("app:created",async()=>{try{"name"in p&&(p.name=void 0),await a.replace({...p,force:!0}),a.options.scrollBehavior=Po.scrollBehavior}catch(A){await t.runWithContext(()=>Rm(A))}}),{provide:{router:a}}}}),UR=globalThis.requestIdleCallback||(t=>{const e=Date.now(),r={didTimeout:!1,timeRemaining:()=>Math.max(0,50-(Date.now()-e))};return setTimeout(()=>{t(r)},1)}),uNe=globalThis.cancelIdleCallback||(t=>{clearTimeout(t)}),WC=t=>{const e=Rn();e.isHydrating?e.hooks.hookOnce("app:suspense:resolve",()=>{UR(()=>t())}):UR(()=>t())},ute=Dl({name:"nuxt:payload",setup(t){qa().beforeResolve(async(e,r)=>{if(e.path===r.path)return;const n=await wR(e.path);n&&Object.assign(t.static.data,n.data)}),WC(()=>{var e;t.hooks.hook("link:prefetch",async r=>{const{hostname:n}=new URL(r,window.location.href);n===window.location.hostname&&await wR(r)}),((e=navigator.connection)==null?void 0:e.effectiveType)!=="slow-2g"&&setTimeout(VA,1e3)})}}),cte=Dl(()=>{const t=qa();WC(()=>{t.beforeResolve(async()=>{await new Promise(e=>{setTimeout(e,100),requestAnimationFrame(()=>{setTimeout(e,0)})})})})}),lte=Dl(t=>{let e;async function r(){const n=await VA();e&&clearTimeout(e),e=setTimeout(r,dR);try{const s=await $fetch(VC("builds/latest.json")+`?${Date.now()}`);s.id!==n.id&&t.hooks.callHook("app:manifest:update",s)}catch{}}WC(()=>{e=setTimeout(r,dR)})});function dte(t={}){const e=t.path||window.location.pathname;let r={};try{r=fE(sessionStorage.getItem("nuxt:reload")||"{}")}catch{}if(t.force||(r==null?void 0:r.path)!==e||(r==null?void 0:r.expires)<Date.now()){try{sessionStorage.setItem("nuxt:reload",JSON.stringify({path:e,expires:Date.now()+(t.ttl??1e4)}))}catch{}if(t.persistState)try{sessionStorage.setItem("nuxt:reload:state",JSON.stringify({state:Rn().payload.state}))}catch{}window.location.pathname!==e?window.location.href=e:window.location.reload()}}const fte=Dl({name:"nuxt:chunk-reload",setup(t){const e=qa(),r=jA(),n=new Set;e.beforeEach(()=>{n.clear()}),t.hook("app:chunkError",({error:i})=>{n.add(i)});function s(i){const a="href"in i&&i.href[0]==="#"?r.app.baseURL+i.href:LC(r.app.baseURL,i.fullPath);dte({path:a,persistState:!0})}t.hook("app:manifest:update",()=>{e.beforeResolve(s)}),e.onError((i,o)=>{n.has(i)&&s(o)})}}),hte=Dl({name:"nuxt:global-components"}),M_={},pte=Dl({name:"nuxt:prefetch",setup(t){const e=qa();t.hooks.hook("app:mounted",()=>{e.beforeEach(async r=>{var s;const n=(s=r==null?void 0:r.meta)==null?void 0:s.layout;n&&typeof M_[n]=="function"&&await M_[n]()})}),t.hooks.hook("link:prefetch",r=>{if(Op(r))return;const n=e.resolve(r);if(!n)return;const s=n.meta.layout;let i=zC(n.meta.middleware);i=i.filter(o=>typeof o=="string");for(const o of i)typeof ev[o]=="function"&&ev[o]();s&&typeof M_[s]=="function"&&M_[s]()})}}),mte=[KQ,qQ,ate,ute,cte,lte,fte,hte,pte],yte=Ky({props:{vnode:{type:Object,required:!0},route:{type:Object,required:!0},vnodeRef:Object,renderKey:String,trackRootNodes:Boolean},setup(t){const e=t.renderKey,r=t.route,n={};for(const s in t.route)Object.defineProperty(n,s,{get:()=>e===t.renderKey?t.route[s]:r[s]});return Jh(UA,tl(n)),()=>Iu(t.vnode,{ref:t.vnodeRef})}}),gte=Ky({name:"NuxtPage",inheritAttrs:!1,props:{name:{type:String},transition:{type:[Boolean,Object],default:void 0},keepalive:{type:[Boolean,Object],default:void 0},route:{type:Object},pageKey:{type:[Function,String],default:null}},setup(t,{attrs:e,slots:r,expose:n}){const s=Rn(),i=Bu(),o=Ks(UA,null);let a;n({pageRef:i});const u=Ks(jZ,null);let l;const c=s.deferHydration();if(s.isHydrating){const d=s.hooks.hookOnce("app:error",c);qa().beforeEach(d)}return t.pageKey&&Yd(()=>t.pageKey,(d,h)=>{d!==h&&s.callHook("page:loading:start")}),()=>Iu(uU,{name:t.name,route:t.route,...e},{default:d=>{const h=wte(o,d.route,d.Component),f=o&&o.matched.length===d.route.matched.length;if(!d.Component){if(l&&!f)return l;c();return}if(l&&u&&!u.isCurrent(d.route))return l;if(h&&o&&(!u||u!=null&&u.isCurrent(o)))return f?l:null;const p=yx(d,t.pageKey);!s.isHydrating&&!_te(o,d.route,d.Component)&&a===p&&s.callHook("page:loading:end"),a=p;const m=!!(t.transition??d.route.meta.pageTransition??ix),E=m&&vte([t.transition,d.route.meta.pageTransition,ix,{onAfterLeave:()=>{s.callHook("page:transition:finish",d.Component)}}].filter(Boolean)),A=t.keepalive??d.route.meta.keepalive??EZ;return l=Qee(MX,m&&E,Jee(A,Iu(rj,{suspensible:!0,onPending:()=>s.callHook("page:start",d.Component),onResolve:()=>{Ly(()=>s.callHook("page:finish",d.Component).then(()=>s.callHook("page:loading:end")).finally(c))}},{default:()=>{const _=Iu(yte,{key:p||void 0,vnode:r.default?Iu(ao,void 0,r.default(d)):d.Component,route:d.route,renderKey:p||void 0,trackRootNodes:m,vnodeRef:i});return A&&(_.type.name=d.Component.type.name||d.Component.type.__name||"RouteProvider"),_}}))).default(),l}})}});function vte(t){const e=t.map(r=>({...r,onAfterLeave:r.onAfterLeave?zC(r.onAfterLeave):void 0}));return Oj(...e)}function wte(t,e,r){if(!t)return!1;const n=e.matched.findIndex(s=>{var i;return((i=s.components)==null?void 0:i.default)===(r==null?void 0:r.type)});return!n||n===-1?!1:e.matched.slice(0,n).some((s,i)=>{var o,a,u;return((o=s.components)==null?void 0:o.default)!==((u=(a=t.matched[i])==null?void 0:a.components)==null?void 0:u.default)})||r&&yx({route:e,Component:r})!==yx({route:t,Component:r})}function _te(t,e,r){return t?e.matched.findIndex(s=>{var i;return((i=s.components)==null?void 0:i.default)===(r==null?void 0:r.type)})<e.matched.length-1:!1}const bte=window.setInterval;var Jr="0123456789abcdefghjkmnpqrstvwxyz",Xe=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,10,11,12,13,14,15,16,17,255,18,19,255,20,21,255,22,23,24,25,26,255,27,28,29,30,31,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255]);function C2(t){const e=new Array(26).fill("");if(t.length!==16)throw new Error("Invalid length");return e[0]=Jr[(t[0]&224)>>5],e[1]=Jr[t[0]&31],e[2]=Jr[(t[1]&248)>>3],e[3]=Jr[(t[1]&7)<<2|(t[2]&192)>>6],e[4]=Jr[(t[2]&62)>>1],e[5]=Jr[(t[2]&1)<<4|(t[3]&240)>>4],e[6]=Jr[(t[3]&15)<<1|(t[4]&128)>>7],e[7]=Jr[(t[4]&124)>>2],e[8]=Jr[(t[4]&3)<<3|(t[5]&224)>>5],e[9]=Jr[t[5]&31],e[10]=Jr[(t[6]&248)>>3],e[11]=Jr[(t[6]&7)<<2|(t[7]&192)>>6],e[12]=Jr[(t[7]&62)>>1],e[13]=Jr[(t[7]&1)<<4|(t[8]&240)>>4],e[14]=Jr[(t[8]&15)<<1|(t[9]&128)>>7],e[15]=Jr[(t[9]&124)>>2],e[16]=Jr[(t[9]&3)<<3|(t[10]&224)>>5],e[17]=Jr[t[10]&31],e[18]=Jr[(t[11]&248)>>3],e[19]=Jr[(t[11]&7)<<2|(t[12]&192)>>6],e[20]=Jr[(t[12]&62)>>1],e[21]=Jr[(t[12]&1)<<4|(t[13]&240)>>4],e[22]=Jr[(t[13]&15)<<1|(t[14]&128)>>7],e[23]=Jr[(t[14]&124)>>2],e[24]=Jr[(t[14]&3)<<3|(t[15]&224)>>5],e[25]=Jr[t[15]&31],e.join("")}function LR(t){if(t.length!==26)throw new Error("Invalid length");const r=new TextEncoder().encode(t);if(Xe[r[0]]===255||Xe[r[1]]===255||Xe[r[2]]===255||Xe[r[3]]===255||Xe[r[4]]===255||Xe[r[5]]===255||Xe[r[6]]===255||Xe[r[7]]===255||Xe[r[8]]===255||Xe[r[9]]===255||Xe[r[10]]===255||Xe[r[11]]===255||Xe[r[12]]===255||Xe[r[13]]===255||Xe[r[14]]===255||Xe[r[15]]===255||Xe[r[16]]===255||Xe[r[17]]===255||Xe[r[18]]===255||Xe[r[19]]===255||Xe[r[20]]===255||Xe[r[21]]===255||Xe[r[22]]===255||Xe[r[23]]===255||Xe[r[24]]===255||Xe[r[25]]===255)throw new Error("Invalid base32 character");const n=new Uint8Array(16);return n[0]=Xe[r[0]]<<5|Xe[r[1]],n[1]=Xe[r[2]]<<3|Xe[r[3]]>>2,n[2]=(Xe[r[3]]&3)<<6|Xe[r[4]]<<1|Xe[r[5]]>>4,n[3]=(Xe[r[5]]&15)<<4|Xe[r[6]]>>1,n[4]=(Xe[r[6]]&1)<<7|Xe[r[7]]<<2|Xe[r[8]]>>3,n[5]=(Xe[r[8]]&7)<<5|Xe[r[9]],n[6]=Xe[r[10]]<<3|Xe[r[11]]>>2,n[7]=(Xe[r[11]]&3)<<6|Xe[r[12]]<<1|Xe[r[13]]>>4,n[8]=(Xe[r[13]]&15)<<4|Xe[r[14]]>>1,n[9]=(Xe[r[14]]&1)<<7|Xe[r[15]]<<2|Xe[r[16]]>>3,n[10]=(Xe[r[16]]&7)<<5|Xe[r[17]],n[11]=Xe[r[18]]<<3|Xe[r[19]]>>2,n[12]=(Xe[r[19]]&3)<<6|Xe[r[20]]<<1|Xe[r[21]]>>4,n[13]=(Xe[r[21]]&15)<<4|Xe[r[22]]>>1,n[14]=(Xe[r[22]]&1)<<7|Xe[r[23]]<<2|Xe[r[24]]>>3,n[15]=(Xe[r[24]]&7)<<5|Xe[r[25]],n}function Ete(t){let e;const r=new Uint8Array(16);return r[0]=(e=parseInt(t.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=e&255,r[4]=(e=parseInt(t.slice(9,13),16))>>>8,r[5]=e&255,r[6]=(e=parseInt(t.slice(14,18),16))>>>8,r[7]=e&255,r[8]=(e=parseInt(t.slice(19,23),16))>>>8,r[9]=e&255,r[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=e&255,r}var Dh=Math.pow,KR="0123456789abcdef",wE=class{constructor(t){if(this.bytes=t,t.length!==16)throw new TypeError("not 128-bit length")}static fromFieldsV7(t,e,r,n){if(!Number.isInteger(t)||!Number.isInteger(e)||!Number.isInteger(r)||!Number.isInteger(n)||t<0||e<0||r<0||n<0||t>0xffffffffffff||e>4095||r>1073741823||n>4294967295)throw new RangeError("invalid field value");const s=new Uint8Array(16);return s[0]=t/Dh(2,40),s[1]=t/Dh(2,32),s[2]=t/Dh(2,24),s[3]=t/Dh(2,16),s[4]=t/Dh(2,8),s[5]=t,s[6]=112|e>>>8,s[7]=e,s[8]=128|r>>>24,s[9]=r>>>16,s[10]=r>>>8,s[11]=r,s[12]=n>>>24,s[13]=n>>>16,s[14]=n>>>8,s[15]=n,new wE(s)}toString(){let t="";for(let e=0;e<this.bytes.length;e++)t+=KR.charAt(this.bytes[e]>>>4),t+=KR.charAt(this.bytes[e]&15),(e===3||e===5||e===7||e===9)&&(t+="-");return t}clone(){return new wE(this.bytes.slice(0))}equals(t){return this.compareTo(t)===0}compareTo(t){for(let e=0;e<16;e++){const r=this.bytes[e]-t.bytes[e];if(r!==0)return Math.sign(r)}return 0}},Ate=class{constructor(){this.timestamp=0,this.counter=0,this.random=new Ste}generate(){const t=this.generateOrAbort();return t!==void 0?t:(this.timestamp=0,this.generateOrAbort())}generateOrAbort(){const r=Date.now();if(r>this.timestamp)this.timestamp=r,this.resetCounter();else if(r+1e4>this.timestamp)this.counter++,this.counter>4398046511103&&(this.timestamp++,this.resetCounter());else return;return wE.fromFieldsV7(this.timestamp,Math.trunc(this.counter/Dh(2,30)),this.counter&Dh(2,30)-1,this.random.nextUint32())}resetCounter(){this.counter=this.random.nextUint32()*1024+(this.random.nextUint32()&1023)}},cU=t=>{if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(let e=0;e<t.length;e++)t[e]=Math.trunc(Math.random()*65536)*65536+Math.trunc(Math.random()*65536);return t};typeof crypto<"u"&&crypto.getRandomValues&&(cU=t=>crypto.getRandomValues(t));var Ste=class{constructor(){this.buffer=new Uint32Array(8),this.cursor=99}nextUint32(){return this.cursor>=this.buffer.length&&(cU(this.buffer),this.cursor=0),this.buffer[this.cursor++]}},VR,Tte=()=>(VR||(VR=new Ate)).generate();function Dte(t){if(t.length>63)return!1;let e,r,n;for(r=0,n=t.length;r<n;r+=1)if(e=t.charCodeAt(r),!(e>96&&e<123))return!1;return!0}var E0=class{constructor(t,e=""){if(this.prefix=t,this.suffix=e,!Dte(t))throw new Error("Invalid prefix. Must be at most 63 ascii letters [a-z]");if(this.prefix=t,e)this.suffix=e;else{const r=Tte();this.suffix=C2(r.bytes)}if(this.suffix.length!==26)throw new Error(`Invalid length. Suffix should have 26 characters, got ${e.length}`);if(this.suffix[0]>"7")throw new Error("Invalid suffix. First character must be in the range [0-7]");LR(this.suffix)}getType(){return this.prefix}getSuffix(){return this.suffix}asType(t){const e=this;if(e.prefix!==t)throw new Error(`Cannot convert TypeID of type ${e.prefix} to type ${t}`);return e}toUUIDBytes(){return LR(this.suffix)}toUUID(){return new wE(this.toUUIDBytes()).toString()}toString(){return this.prefix===""?this.suffix:`${this.prefix}_${this.suffix}`}static fromString(t){const e=t.split("_");if(e.length===1)return new E0("",e[0]);if(e.length===2){if(e[0]==="")throw new Error(`Invalid TypeID. Prefix cannot be empty when there's a separator: ${t}`);return new E0(e[0],e[1])}throw new Error(`Invalid TypeID string: ${t}`)}static fromUUIDBytes(t,e){const r=C2(e);return new E0(t,r)}static fromUUID(t,e){const r=C2(Ete(e));return new E0(t,r)}};function GC(t="",e=""){return new E0(t,e)}/*! Bundled license information:

uuidv7/dist/index.js:
  (**
   * uuidv7: An experimental implementation of the proposed UUID Version 7
   *
   * @license Apache-2.0
   * @copyright 2021-2023 LiosK
   * @packageDocumentation
   *)
*/function qR(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function xte(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function lU(t,...e){if(!xte(t))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function Pte(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");qR(t.outputLen),qR(t.blockLen)}function _E(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Cte(t,e){lU(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const I2=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function dU(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}const k2=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Ya=(t,e)=>t<<32-e|t>>>e,Ite=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Ite)throw new Error("Non little-endian hardware is not supported");function fU(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function JC(t){if(typeof t=="string"&&(t=fU(t)),!dU(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function hU(...t){let e=0;for(let n=0;n<t.length;n++){const s=t[n];if(!dU(s))throw new Error("Uint8Array expected");e+=s.length}const r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){const i=t[n];r.set(i,s),s+=i.length}return r}let pU=class{clone(){return this._cloneInto()}};function mU(t){const e=n=>t().update(JC(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function XC(t=32){if(I2&&typeof I2.getRandomValues=="function")return I2.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function kte(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),u=n?4:0,l=n?0:4;t.setUint32(e+u,o,n),t.setUint32(e+l,a,n)}let yU=class extends pU{constructor(e,r,n,s){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=k2(this.buffer)}update(e){_E(this);const{view:r,buffer:n,blockLen:s}=this;e=JC(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const u=k2(e);for(;s<=i-o;o+=s)this.process(u,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){_E(this),Cte(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)r[d]=0;kte(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=k2(e),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=u/4,c=this.get();if(l>c.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,c[d],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%r&&e.buffer.set(n),e}};const $te=(t,e,r)=>t&e^~t&r,Ote=(t,e,r)=>t&e^t&r^e&r,Rte=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ml=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),jl=new Uint32Array(64);let Nte=class extends yU{constructor(){super(64,32,8,!1),this.A=Ml[0]|0,this.B=Ml[1]|0,this.C=Ml[2]|0,this.D=Ml[3]|0,this.E=Ml[4]|0,this.F=Ml[5]|0,this.G=Ml[6]|0,this.H=Ml[7]|0}get(){const{A:e,B:r,C:n,D:s,E:i,F:o,G:a,H:u}=this;return[e,r,n,s,i,o,a,u]}set(e,r,n,s,i,o,a,u){this.A=e|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=u|0}process(e,r){for(let d=0;d<16;d++,r+=4)jl[d]=e.getUint32(r,!1);for(let d=16;d<64;d++){const h=jl[d-15],f=jl[d-2],p=Ya(h,7)^Ya(h,18)^h>>>3,m=Ya(f,17)^Ya(f,19)^f>>>10;jl[d]=m+jl[d-7]+p+jl[d-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:u,G:l,H:c}=this;for(let d=0;d<64;d++){const h=Ya(a,6)^Ya(a,11)^Ya(a,25),f=c+h+$te(a,u,l)+Rte[d]+jl[d]|0,m=(Ya(n,2)^Ya(n,13)^Ya(n,22))+Ote(n,s,i)|0;c=l,l=u,u=a,a=o+f|0,o=i,i=s,s=n,n=f+m|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,u=u+this.F|0,l=l+this.G|0,c=c+this.H|0,this.set(n,s,i,o,a,u,l,c)}roundClean(){jl.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const pf=mU(()=>new Nte);var Ar=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function nc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Bte(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),r}function Fte(t){if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")}function Mte(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,u=t.charAt(0),l=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var m=0,E=0,A=0,_=p.length;A!==_&&p[A]===0;)A++,m++;for(var g=(_-A)*c+1>>>0,v=new Uint8Array(g);A!==_;){for(var S=p[A],x=0,D=g-1;(S!==0||x<E)&&D!==-1;D--,x++)S+=256*v[D]>>>0,v[D]=S%a>>>0,S=S/a>>>0;if(S!==0)throw new Error("Non-zero carry");E=x,A++}for(var w=g-E;w!==g&&v[w]===0;)w++;for(var b=u.repeat(m);w<g;++w)b+=t.charAt(v[w]);return b}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var m=0;if(p[m]!==" "){for(var E=0,A=0;p[m]===u;)E++,m++;for(var _=(p.length-m)*l+1>>>0,g=new Uint8Array(_);p[m];){var v=r[p.charCodeAt(m)];if(v===255)return;for(var S=0,x=_-1;(v!==0||S<A)&&x!==-1;x--,S++)v+=a*g[x]>>>0,g[x]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");A=S,m++}if(p[m]!==" "){for(var D=_-A;D!==_&&g[D]===0;)D++;for(var w=new Uint8Array(E+(_-D)),b=E;D!==_;)w[b++]=g[D++];return w}}}function f(p){var m=h(p);if(m)return m;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var jte=Mte,Ute=jte;let Lte=class{constructor(e,r,n){Se(this,"name");Se(this,"prefix");Se(this,"baseEncode");this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Kte=class{constructor(e,r,n){Se(this,"name");Se(this,"prefix");Se(this,"baseDecode");Se(this,"prefixCodePoint");if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return gU(this,e)}},Vte=class{constructor(e){Se(this,"decoders");this.decoders=e}or(e){return gU(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n!=null)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function gU(t,e){return new Vte({...t.decoders??{[t.prefix]:t},...e.decoders??{[e.prefix]:e}})}let qte=class{constructor(e,r,n,s){Se(this,"name");Se(this,"prefix");Se(this,"baseEncode");Se(this,"baseDecode");Se(this,"encoder");Se(this,"decoder");this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new Lte(e,r,n),this.decoder=new Kte(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};function vU({name:t,prefix:e,encode:r,decode:n}){return new qte(t,e,r,n)}function wU({name:t,prefix:e,alphabet:r}){const{encode:n,decode:s}=Ute(r,t);return vU({prefix:e,name:t,encode:n,decode:i=>Fte(s(i))})}function Hte(t,e,r,n){const s={};for(let c=0;c<e.length;++c)s[e[c]]=c;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,u=0,l=0;for(let c=0;c<i;++c){const d=s[t[c]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);u=u<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&u>>a)}if(a>=r||255&u<<8-a)throw new SyntaxError("Unexpected end of data");return o}function zte(t,e,r){const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let u=0;u<t.length;++u)for(a=a<<8|t[u],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o!==0&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i}function yo({name:t,prefix:e,bitsPerChar:r,alphabet:n}){return vU({prefix:e,name:t,encode(s){return zte(s,n,r)},decode(s){return Hte(s,n,r,t)}})}yo({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});yo({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});yo({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});yo({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});yo({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});yo({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});yo({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});yo({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});const HR=yo({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),j_=wU({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});wU({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});yo({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});yo({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const pc=yo({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});yo({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function Wte(t){return t.byteOffset!==0||t.byteLength!==t.buffer.byteLength}function Gte(t){return typeof t!="object"||t===null?!1:typeof t[Symbol.asyncIterator]=="function"}function zR(t){const r=Object.prototype.toString.call(t).match(/\s([a-zA-Z0-9]+)/),[n,s]=r;return s}var _g=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},WR=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(o){return new Promise(function(a,u){o=t[i](o),s(a,u,o.done,o.value)})}}function s(i,o,a,u){Promise.resolve(u).then(function(l){i({value:l,done:a})},o)}};const U_=new TextEncoder,qf=new TextDecoder;let Aa=class Es{constructor(e,r){this.data=e,this.format=r}static arrayBuffer(e){return new Es(e,"ArrayBuffer")}static asyncIterable(e){if(!Gte(e))throw new TypeError("Input must be of type AsyncIterable.");return new Es(e,"AsyncIterable")}static base32Z(e){return new Es(e,"Base32Z")}static base58Btc(e){return new Es(e,"Base58Btc")}static base64Url(e){return new Es(e,"Base64Url")}static bufferSource(e){return new Es(e,"BufferSource")}static hex(e){if(typeof e!="string")throw new TypeError("Hex input must be a string.");if(e.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new Es(e,"Hex")}static multibase(e){return new Es(e,"Multibase")}static object(e){return new Es(e,"Object")}static string(e){return new Es(e,"String")}static uint8Array(e){return new Es(e,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return j_.baseDecode(this.data).buffer;case"Base64Url":return pc.baseDecode(this.data).buffer;case"BufferSource":{if(zR(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return Wte(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return _g(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return HR.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return j_.baseEncode(e)}case"Multibase":return this.data.substring(1);case"Uint8Array":return j_.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return pc.baseEncode(e)}case"BufferSource":{const e=this.toUint8Array();return pc.baseEncode(e)}case"Object":{const e=JSON.stringify(this.data),r=U_.encode(e);return pc.baseEncode(r)}case"String":{const e=U_.encode(this.data);return pc.baseEncode(e)}case"Uint8Array":return pc.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){return _g(this,void 0,void 0,function*(){var e,r,n,s;switch(this.format){case"AsyncIterable":{const u=[];try{for(var i=!0,o=WR(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const c=s;u.push(c)}}catch(c){r={error:c}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return new Blob(u)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){const e=Array.from({length:256},(r,n)=>n.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{const r=this.toUint8Array();return Es.uint8Array(r).toHex()}case"Base64Url":{const r=this.toUint8Array();return Es.uint8Array(r).toHex()}case"Uint8Array":{let r="";for(let n=0;n<this.data.length;n++)r+=e[this.data[n]];return r}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{const e=pc.baseDecode(this.data),r=qf.decode(e);return JSON.parse(r)}case"String":return JSON.parse(this.data);case"Uint8Array":{const e=qf.decode(this.data);return JSON.parse(e)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return _g(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toStringAsync();return JSON.parse(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return qf.decode(this.data);case"Base64Url":{const e=pc.baseDecode(this.data);return qf.decode(e)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return qf.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){return _g(this,void 0,void 0,function*(){var e,r,n,s;switch(this.format){case"AsyncIterable":{let u="";try{for(var i=!0,o=WR(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const l=s;typeof l=="string"?u+=l:u+=qf.decode(l,{stream:!0})}}catch(l){r={error:l}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return u+=qf.decode(void 0,{stream:!1}),u}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return HR.baseDecode(this.data);case"Base58Btc":return j_.baseDecode(this.data);case"Base64Url":return pc.baseDecode(this.data);case"BufferSource":{const e=zR(this.data);if(e==="Uint8Array")return this.data;if(e==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{const e=new Uint8Array(this.data.length/2);for(let r=0;r<this.data.length;r+=2){const n=parseInt(this.data.substring(r,r+2),16);if(isNaN(n))throw new TypeError("Input is not a valid hexadecimal string.");e[r/2]=n}return e}case"Object":{const e=JSON.stringify(this.data);return U_.encode(e)}case"String":return U_.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return _g(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toArrayBufferAsync();return new Uint8Array(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}};var Jte=_U,GR=128,Xte=127,Yte=~Xte,Zte=Math.pow(2,31);function _U(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Zte;)e[r++]=t&255|GR,t/=128;for(;t&Yte;)e[r++]=t&255|GR,t>>>=7;return e[r]=t|0,_U.bytes=r-n+1,e}var Qte=gx,ere=128,JR=127;function gx(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw gx.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&JR)<<s:(o&JR)*Math.pow(2,s),s+=7}while(o>=ere);return gx.bytes=i-n,r}var tre=Math.pow(2,7),rre=Math.pow(2,14),nre=Math.pow(2,21),ire=Math.pow(2,28),sre=Math.pow(2,35),ore=Math.pow(2,42),are=Math.pow(2,49),ure=Math.pow(2,56),cre=Math.pow(2,63),lre=function(t){return t<tre?1:t<rre?2:t<nre?3:t<ire?4:t<sre?5:t<ore?6:t<are?7:t<ure?8:t<cre?9:10},dre={encode:Jte,decode:Qte,encodingLength:lre},bE=dre;function XR(t,e=0){return[bE.decode(t,e),bE.decode.bytes]}function fre(t,e,r=0){return bE.encode(t,e,r),e}function hre(t){return bE.encodingLength(t)}let Tf=class hd{static addPrefix(e){var r;let{code:n,data:s,name:i}=e;if(!(i?!n:n))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(n=hd.codeToName.has(n)?n:hd.nameToCode.get(i),n===void 0)throw new Error(`Unsupported multicodec: ${(r=e.name)!==null&&r!==void 0?r:e.code}`);const o=hre(n),a=new Uint8Array(o+s.byteLength);return a.set(s,o),fre(n,a),a}static getCodeFromData(e){const{prefixedData:r}=e,[n,s]=XR(r);return n}static getCodeFromName(e){const{name:r}=e,n=hd.nameToCode.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static getNameFromCode(e){const{code:r}=e,n=hd.codeToName.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static registerCodec(e){hd.codeToName.set(e.code,e.name),hd.nameToCode.set(e.name,e.code)}static removePrefix(e){const{prefixedData:r}=e,[n,s]=XR(r),i=hd.codeToName.get(n);if(i===void 0)throw new Error(`Unsupported multicodec: ${n}`);return{code:n,data:r.slice(s),name:i}}};Tf.codeToName=new Map;Tf.nameToCode=new Map;Tf.registerCodec({code:237,name:"ed25519-pub"});Tf.registerCodec({code:4864,name:"ed25519-priv"});Tf.registerCodec({code:236,name:"x25519-pub"});Tf.registerCodec({code:4866,name:"x25519-priv"});Tf.registerCodec({code:231,name:"secp256k1-pub"});Tf.registerCodec({code:4865,name:"secp256k1-priv"});var Df={},zA={},bU={};bU.supports=function(...e){const r=e.reduce((n,s)=>Object.assign(n,s),{});return Object.assign(r,{snapshots:r.snapshots||!1,permanence:r.permanence||!1,seek:r.seek||!1,clear:r.clear||!1,getMany:r.getMany||!1,keyIterator:r.keyIterator||!1,valueIterator:r.valueIterator||!1,iteratorNextv:r.iteratorNextv||!1,iteratorAll:r.iteratorAll||!1,status:r.status||!1,createIfMissing:r.createIfMissing||!1,errorIfExists:r.errorIfExists||!1,deferredOpen:r.deferredOpen||!1,promises:r.promises||!1,streams:r.streams||!1,encodings:Object.assign({},r.encodings),events:Object.assign({},r.events),additionalMethods:Object.assign({},r.additionalMethods)})};var EU={},ic=class extends Error{constructor(e,r){super(e||""),typeof r=="object"&&r!==null&&(r.code&&(this.code=String(r.code)),r.expected&&(this.expected=!0),r.transient&&(this.transient=!0),r.cause&&(this.cause=r.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}},Rp={},ha={},WA={};WA.byteLength=yre;WA.toByteArray=vre;WA.fromByteArray=bre;var Du=[],jo=[],pre=typeof Uint8Array<"u"?Uint8Array:Array,$2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var em=0,mre=$2.length;em<mre;++em)Du[em]=$2[em],jo[$2.charCodeAt(em)]=em;jo[45]=62;jo[95]=63;function AU(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function yre(t){var e=AU(t),r=e[0],n=e[1];return(r+n)*3/4-n}function gre(t,e,r){return(e+r)*3/4-r}function vre(t){var e,r=AU(t),n=r[0],s=r[1],i=new pre(gre(t,n,s)),o=0,a=s>0?n-4:n,u;for(u=0;u<a;u+=4)e=jo[t.charCodeAt(u)]<<18|jo[t.charCodeAt(u+1)]<<12|jo[t.charCodeAt(u+2)]<<6|jo[t.charCodeAt(u+3)],i[o++]=e>>16&255,i[o++]=e>>8&255,i[o++]=e&255;return s===2&&(e=jo[t.charCodeAt(u)]<<2|jo[t.charCodeAt(u+1)]>>4,i[o++]=e&255),s===1&&(e=jo[t.charCodeAt(u)]<<10|jo[t.charCodeAt(u+1)]<<4|jo[t.charCodeAt(u+2)]>>2,i[o++]=e>>8&255,i[o++]=e&255),i}function wre(t){return Du[t>>18&63]+Du[t>>12&63]+Du[t>>6&63]+Du[t&63]}function _re(t,e,r){for(var n,s=[],i=e;i<r;i+=3)n=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(t[i+2]&255),s.push(wre(n));return s.join("")}function bre(t){for(var e,r=t.length,n=r%3,s=[],i=16383,o=0,a=r-n;o<a;o+=i)s.push(_re(t,o,o+i>a?a:o+i));return n===1?(e=t[r-1],s.push(Du[e>>2]+Du[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],s.push(Du[e>>10]+Du[e>>4&63]+Du[e<<2&63]+"=")),s.join("")}var YC={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */YC.read=function(t,e,r,n,s){var i,o,a=s*8-n-1,u=(1<<a)-1,l=u>>1,c=-7,d=r?s-1:0,h=r?-1:1,f=t[e+d];for(d+=h,i=f&(1<<-c)-1,f>>=-c,c+=a;c>0;i=i*256+t[e+d],d+=h,c-=8);for(o=i&(1<<-c)-1,i>>=-c,c+=n;c>0;o=o*256+t[e+d],d+=h,c-=8);if(i===0)i=1-l;else{if(i===u)return o?NaN:(f?-1:1)*(1/0);o=o+Math.pow(2,n),i=i-l}return(f?-1:1)*o*Math.pow(2,i-n)};YC.write=function(t,e,r,n,s,i){var o,a,u,l=i*8-s-1,c=(1<<l)-1,d=c>>1,h=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:i-1,p=n?1:-1,m=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),o+d>=1?e+=h/u:e+=h*Math.pow(2,1-d),e*u>=2&&(o++,u/=2),o+d>=c?(a=0,o=c):o+d>=1?(a=(e*u-1)*Math.pow(2,s),o=o+d):(a=e*Math.pow(2,d-1)*Math.pow(2,s),o=0));s>=8;t[r+f]=a&255,f+=p,a/=256,s-=8);for(o=o<<s|a,l+=s;l>0;t[r+f]=o&255,f+=p,o/=256,l-=8);t[r+f-p]|=m*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){var e=WA,r=YC,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=_,t.INSPECT_MAX_BYTES=50;var s=2147483647;t.kMaxLength=s,a.TYPED_ARRAY_SUPPORT=i(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{var j=new Uint8Array(1),I={foo:function(){return 42}};return Object.setPrototypeOf(I,Uint8Array.prototype),Object.setPrototypeOf(j,I),j.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function o(j){if(j>s)throw new RangeError('The value "'+j+'" is invalid for option "size"');var I=new Uint8Array(j);return Object.setPrototypeOf(I,a.prototype),I}function a(j,I,N){if(typeof j=="number"){if(typeof I=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(j)}return u(j,I,N)}a.poolSize=8192;function u(j,I,N){if(typeof j=="string")return h(j,I);if(ArrayBuffer.isView(j))return p(j);if(j==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof j);if(M(j,ArrayBuffer)||j&&M(j.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(M(j,SharedArrayBuffer)||j&&M(j.buffer,SharedArrayBuffer)))return m(j,I,N);if(typeof j=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var Q=j.valueOf&&j.valueOf();if(Q!=null&&Q!==j)return a.from(Q,I,N);var ce=E(j);if(ce)return ce;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof j[Symbol.toPrimitive]=="function")return a.from(j[Symbol.toPrimitive]("string"),I,N);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof j)}a.from=function(j,I,N){return u(j,I,N)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function l(j){if(typeof j!="number")throw new TypeError('"size" argument must be of type number');if(j<0)throw new RangeError('The value "'+j+'" is invalid for option "size"')}function c(j,I,N){return l(j),j<=0?o(j):I!==void 0?typeof N=="string"?o(j).fill(I,N):o(j).fill(I):o(j)}a.alloc=function(j,I,N){return c(j,I,N)};function d(j){return l(j),o(j<0?0:A(j)|0)}a.allocUnsafe=function(j){return d(j)},a.allocUnsafeSlow=function(j){return d(j)};function h(j,I){if((typeof I!="string"||I==="")&&(I="utf8"),!a.isEncoding(I))throw new TypeError("Unknown encoding: "+I);var N=g(j,I)|0,Q=o(N),ce=Q.write(j,I);return ce!==N&&(Q=Q.slice(0,ce)),Q}function f(j){for(var I=j.length<0?0:A(j.length)|0,N=o(I),Q=0;Q<I;Q+=1)N[Q]=j[Q]&255;return N}function p(j){if(M(j,Uint8Array)){var I=new Uint8Array(j);return m(I.buffer,I.byteOffset,I.byteLength)}return f(j)}function m(j,I,N){if(I<0||j.byteLength<I)throw new RangeError('"offset" is outside of buffer bounds');if(j.byteLength<I+(N||0))throw new RangeError('"length" is outside of buffer bounds');var Q;return I===void 0&&N===void 0?Q=new Uint8Array(j):N===void 0?Q=new Uint8Array(j,I):Q=new Uint8Array(j,I,N),Object.setPrototypeOf(Q,a.prototype),Q}function E(j){if(a.isBuffer(j)){var I=A(j.length)|0,N=o(I);return N.length===0||j.copy(N,0,0,I),N}if(j.length!==void 0)return typeof j.length!="number"||V(j.length)?o(0):f(j);if(j.type==="Buffer"&&Array.isArray(j.data))return f(j.data)}function A(j){if(j>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return j|0}function _(j){return+j!=j&&(j=0),a.alloc(+j)}a.isBuffer=function(I){return I!=null&&I._isBuffer===!0&&I!==a.prototype},a.compare=function(I,N){if(M(I,Uint8Array)&&(I=a.from(I,I.offset,I.byteLength)),M(N,Uint8Array)&&(N=a.from(N,N.offset,N.byteLength)),!a.isBuffer(I)||!a.isBuffer(N))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(I===N)return 0;for(var Q=I.length,ce=N.length,pe=0,he=Math.min(Q,ce);pe<he;++pe)if(I[pe]!==N[pe]){Q=I[pe],ce=N[pe];break}return Q<ce?-1:ce<Q?1:0},a.isEncoding=function(I){switch(String(I).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(I,N){if(!Array.isArray(I))throw new TypeError('"list" argument must be an Array of Buffers');if(I.length===0)return a.alloc(0);var Q;if(N===void 0)for(N=0,Q=0;Q<I.length;++Q)N+=I[Q].length;var ce=a.allocUnsafe(N),pe=0;for(Q=0;Q<I.length;++Q){var he=I[Q];if(M(he,Uint8Array))pe+he.length>ce.length?a.from(he).copy(ce,pe):Uint8Array.prototype.set.call(ce,he,pe);else if(a.isBuffer(he))he.copy(ce,pe);else throw new TypeError('"list" argument must be an Array of Buffers');pe+=he.length}return ce};function g(j,I){if(a.isBuffer(j))return j.length;if(ArrayBuffer.isView(j)||M(j,ArrayBuffer))return j.byteLength;if(typeof j!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof j);var N=j.length,Q=arguments.length>2&&arguments[2]===!0;if(!Q&&N===0)return 0;for(var ce=!1;;)switch(I){case"ascii":case"latin1":case"binary":return N;case"utf8":case"utf-8":return le(j).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N*2;case"hex":return N>>>1;case"base64":return Pe(j).length;default:if(ce)return Q?-1:le(j).length;I=(""+I).toLowerCase(),ce=!0}}a.byteLength=g;function v(j,I,N){var Q=!1;if((I===void 0||I<0)&&(I=0),I>this.length||((N===void 0||N>this.length)&&(N=this.length),N<=0)||(N>>>=0,I>>>=0,N<=I))return"";for(j||(j="utf8");;)switch(j){case"hex":return re(this,I,N);case"utf8":case"utf-8":return K(this,I,N);case"ascii":return se(this,I,N);case"latin1":case"binary":return X(this,I,N);case"base64":return k(this,I,N);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W(this,I,N);default:if(Q)throw new TypeError("Unknown encoding: "+j);j=(j+"").toLowerCase(),Q=!0}}a.prototype._isBuffer=!0;function S(j,I,N){var Q=j[I];j[I]=j[N],j[N]=Q}a.prototype.swap16=function(){var I=this.length;if(I%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var N=0;N<I;N+=2)S(this,N,N+1);return this},a.prototype.swap32=function(){var I=this.length;if(I%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var N=0;N<I;N+=4)S(this,N,N+3),S(this,N+1,N+2);return this},a.prototype.swap64=function(){var I=this.length;if(I%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var N=0;N<I;N+=8)S(this,N,N+7),S(this,N+1,N+6),S(this,N+2,N+5),S(this,N+3,N+4);return this},a.prototype.toString=function(){var I=this.length;return I===0?"":arguments.length===0?K(this,0,I):v.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(I){if(!a.isBuffer(I))throw new TypeError("Argument must be a Buffer");return this===I?!0:a.compare(this,I)===0},a.prototype.inspect=function(){var I="",N=t.INSPECT_MAX_BYTES;return I=this.toString("hex",0,N).replace(/(.{2})/g,"$1 ").trim(),this.length>N&&(I+=" ... "),"<Buffer "+I+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(I,N,Q,ce,pe){if(M(I,Uint8Array)&&(I=a.from(I,I.offset,I.byteLength)),!a.isBuffer(I))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof I);if(N===void 0&&(N=0),Q===void 0&&(Q=I?I.length:0),ce===void 0&&(ce=0),pe===void 0&&(pe=this.length),N<0||Q>I.length||ce<0||pe>this.length)throw new RangeError("out of range index");if(ce>=pe&&N>=Q)return 0;if(ce>=pe)return-1;if(N>=Q)return 1;if(N>>>=0,Q>>>=0,ce>>>=0,pe>>>=0,this===I)return 0;for(var he=pe-ce,Ce=Q-N,_e=Math.min(he,Ce),G=this.slice(ce,pe),J=I.slice(N,Q),ge=0;ge<_e;++ge)if(G[ge]!==J[ge]){he=G[ge],Ce=J[ge];break}return he<Ce?-1:Ce<he?1:0};function x(j,I,N,Q,ce){if(j.length===0)return-1;if(typeof N=="string"?(Q=N,N=0):N>2147483647?N=2147483647:N<-2147483648&&(N=-2147483648),N=+N,V(N)&&(N=ce?0:j.length-1),N<0&&(N=j.length+N),N>=j.length){if(ce)return-1;N=j.length-1}else if(N<0)if(ce)N=0;else return-1;if(typeof I=="string"&&(I=a.from(I,Q)),a.isBuffer(I))return I.length===0?-1:D(j,I,N,Q,ce);if(typeof I=="number")return I=I&255,typeof Uint8Array.prototype.indexOf=="function"?ce?Uint8Array.prototype.indexOf.call(j,I,N):Uint8Array.prototype.lastIndexOf.call(j,I,N):D(j,[I],N,Q,ce);throw new TypeError("val must be string, number or Buffer")}function D(j,I,N,Q,ce){var pe=1,he=j.length,Ce=I.length;if(Q!==void 0&&(Q=String(Q).toLowerCase(),Q==="ucs2"||Q==="ucs-2"||Q==="utf16le"||Q==="utf-16le")){if(j.length<2||I.length<2)return-1;pe=2,he/=2,Ce/=2,N/=2}function _e(ke,At){return pe===1?ke[At]:ke.readUInt16BE(At*pe)}var G;if(ce){var J=-1;for(G=N;G<he;G++)if(_e(j,G)===_e(I,J===-1?0:G-J)){if(J===-1&&(J=G),G-J+1===Ce)return J*pe}else J!==-1&&(G-=G-J),J=-1}else for(N+Ce>he&&(N=he-Ce),G=N;G>=0;G--){for(var ge=!0,be=0;be<Ce;be++)if(_e(j,G+be)!==_e(I,be)){ge=!1;break}if(ge)return G}return-1}a.prototype.includes=function(I,N,Q){return this.indexOf(I,N,Q)!==-1},a.prototype.indexOf=function(I,N,Q){return x(this,I,N,Q,!0)},a.prototype.lastIndexOf=function(I,N,Q){return x(this,I,N,Q,!1)};function w(j,I,N,Q){N=Number(N)||0;var ce=j.length-N;Q?(Q=Number(Q),Q>ce&&(Q=ce)):Q=ce;var pe=I.length;Q>pe/2&&(Q=pe/2);for(var he=0;he<Q;++he){var Ce=parseInt(I.substr(he*2,2),16);if(V(Ce))return he;j[N+he]=Ce}return he}function b(j,I,N,Q){return Ue(le(I,j.length-N),j,N,Q)}function T(j,I,N,Q){return Ue(me(I),j,N,Q)}function P(j,I,N,Q){return Ue(Pe(I),j,N,Q)}function C(j,I,N,Q){return Ue(ve(I,j.length-N),j,N,Q)}a.prototype.write=function(I,N,Q,ce){if(N===void 0)ce="utf8",Q=this.length,N=0;else if(Q===void 0&&typeof N=="string")ce=N,Q=this.length,N=0;else if(isFinite(N))N=N>>>0,isFinite(Q)?(Q=Q>>>0,ce===void 0&&(ce="utf8")):(ce=Q,Q=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var pe=this.length-N;if((Q===void 0||Q>pe)&&(Q=pe),I.length>0&&(Q<0||N<0)||N>this.length)throw new RangeError("Attempt to write outside buffer bounds");ce||(ce="utf8");for(var he=!1;;)switch(ce){case"hex":return w(this,I,N,Q);case"utf8":case"utf-8":return b(this,I,N,Q);case"ascii":case"latin1":case"binary":return T(this,I,N,Q);case"base64":return P(this,I,N,Q);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,I,N,Q);default:if(he)throw new TypeError("Unknown encoding: "+ce);ce=(""+ce).toLowerCase(),he=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function k(j,I,N){return I===0&&N===j.length?e.fromByteArray(j):e.fromByteArray(j.slice(I,N))}function K(j,I,N){N=Math.min(j.length,N);for(var Q=[],ce=I;ce<N;){var pe=j[ce],he=null,Ce=pe>239?4:pe>223?3:pe>191?2:1;if(ce+Ce<=N){var _e,G,J,ge;switch(Ce){case 1:pe<128&&(he=pe);break;case 2:_e=j[ce+1],(_e&192)===128&&(ge=(pe&31)<<6|_e&63,ge>127&&(he=ge));break;case 3:_e=j[ce+1],G=j[ce+2],(_e&192)===128&&(G&192)===128&&(ge=(pe&15)<<12|(_e&63)<<6|G&63,ge>2047&&(ge<55296||ge>57343)&&(he=ge));break;case 4:_e=j[ce+1],G=j[ce+2],J=j[ce+3],(_e&192)===128&&(G&192)===128&&(J&192)===128&&(ge=(pe&15)<<18|(_e&63)<<12|(G&63)<<6|J&63,ge>65535&&ge<1114112&&(he=ge))}}he===null?(he=65533,Ce=1):he>65535&&(he-=65536,Q.push(he>>>10&1023|55296),he=56320|he&1023),Q.push(he),ce+=Ce}return q(Q)}var L=4096;function q(j){var I=j.length;if(I<=L)return String.fromCharCode.apply(String,j);for(var N="",Q=0;Q<I;)N+=String.fromCharCode.apply(String,j.slice(Q,Q+=L));return N}function se(j,I,N){var Q="";N=Math.min(j.length,N);for(var ce=I;ce<N;++ce)Q+=String.fromCharCode(j[ce]&127);return Q}function X(j,I,N){var Q="";N=Math.min(j.length,N);for(var ce=I;ce<N;++ce)Q+=String.fromCharCode(j[ce]);return Q}function re(j,I,N){var Q=j.length;(!I||I<0)&&(I=0),(!N||N<0||N>Q)&&(N=Q);for(var ce="",pe=I;pe<N;++pe)ce+=oe[j[pe]];return ce}function W(j,I,N){for(var Q=j.slice(I,N),ce="",pe=0;pe<Q.length-1;pe+=2)ce+=String.fromCharCode(Q[pe]+Q[pe+1]*256);return ce}a.prototype.slice=function(I,N){var Q=this.length;I=~~I,N=N===void 0?Q:~~N,I<0?(I+=Q,I<0&&(I=0)):I>Q&&(I=Q),N<0?(N+=Q,N<0&&(N=0)):N>Q&&(N=Q),N<I&&(N=I);var ce=this.subarray(I,N);return Object.setPrototypeOf(ce,a.prototype),ce};function B(j,I,N){if(j%1!==0||j<0)throw new RangeError("offset is not uint");if(j+I>N)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(I,N,Q){I=I>>>0,N=N>>>0,Q||B(I,N,this.length);for(var ce=this[I],pe=1,he=0;++he<N&&(pe*=256);)ce+=this[I+he]*pe;return ce},a.prototype.readUintBE=a.prototype.readUIntBE=function(I,N,Q){I=I>>>0,N=N>>>0,Q||B(I,N,this.length);for(var ce=this[I+--N],pe=1;N>0&&(pe*=256);)ce+=this[I+--N]*pe;return ce},a.prototype.readUint8=a.prototype.readUInt8=function(I,N){return I=I>>>0,N||B(I,1,this.length),this[I]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(I,N){return I=I>>>0,N||B(I,2,this.length),this[I]|this[I+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(I,N){return I=I>>>0,N||B(I,2,this.length),this[I]<<8|this[I+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(I,N){return I=I>>>0,N||B(I,4,this.length),(this[I]|this[I+1]<<8|this[I+2]<<16)+this[I+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(I,N){return I=I>>>0,N||B(I,4,this.length),this[I]*16777216+(this[I+1]<<16|this[I+2]<<8|this[I+3])},a.prototype.readIntLE=function(I,N,Q){I=I>>>0,N=N>>>0,Q||B(I,N,this.length);for(var ce=this[I],pe=1,he=0;++he<N&&(pe*=256);)ce+=this[I+he]*pe;return pe*=128,ce>=pe&&(ce-=Math.pow(2,8*N)),ce},a.prototype.readIntBE=function(I,N,Q){I=I>>>0,N=N>>>0,Q||B(I,N,this.length);for(var ce=N,pe=1,he=this[I+--ce];ce>0&&(pe*=256);)he+=this[I+--ce]*pe;return pe*=128,he>=pe&&(he-=Math.pow(2,8*N)),he},a.prototype.readInt8=function(I,N){return I=I>>>0,N||B(I,1,this.length),this[I]&128?(255-this[I]+1)*-1:this[I]},a.prototype.readInt16LE=function(I,N){I=I>>>0,N||B(I,2,this.length);var Q=this[I]|this[I+1]<<8;return Q&32768?Q|4294901760:Q},a.prototype.readInt16BE=function(I,N){I=I>>>0,N||B(I,2,this.length);var Q=this[I+1]|this[I]<<8;return Q&32768?Q|4294901760:Q},a.prototype.readInt32LE=function(I,N){return I=I>>>0,N||B(I,4,this.length),this[I]|this[I+1]<<8|this[I+2]<<16|this[I+3]<<24},a.prototype.readInt32BE=function(I,N){return I=I>>>0,N||B(I,4,this.length),this[I]<<24|this[I+1]<<16|this[I+2]<<8|this[I+3]},a.prototype.readFloatLE=function(I,N){return I=I>>>0,N||B(I,4,this.length),r.read(this,I,!0,23,4)},a.prototype.readFloatBE=function(I,N){return I=I>>>0,N||B(I,4,this.length),r.read(this,I,!1,23,4)},a.prototype.readDoubleLE=function(I,N){return I=I>>>0,N||B(I,8,this.length),r.read(this,I,!0,52,8)},a.prototype.readDoubleBE=function(I,N){return I=I>>>0,N||B(I,8,this.length),r.read(this,I,!1,52,8)};function te(j,I,N,Q,ce,pe){if(!a.isBuffer(j))throw new TypeError('"buffer" argument must be a Buffer instance');if(I>ce||I<pe)throw new RangeError('"value" argument is out of bounds');if(N+Q>j.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(I,N,Q,ce){if(I=+I,N=N>>>0,Q=Q>>>0,!ce){var pe=Math.pow(2,8*Q)-1;te(this,I,N,Q,pe,0)}var he=1,Ce=0;for(this[N]=I&255;++Ce<Q&&(he*=256);)this[N+Ce]=I/he&255;return N+Q},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(I,N,Q,ce){if(I=+I,N=N>>>0,Q=Q>>>0,!ce){var pe=Math.pow(2,8*Q)-1;te(this,I,N,Q,pe,0)}var he=Q-1,Ce=1;for(this[N+he]=I&255;--he>=0&&(Ce*=256);)this[N+he]=I/Ce&255;return N+Q},a.prototype.writeUint8=a.prototype.writeUInt8=function(I,N,Q){return I=+I,N=N>>>0,Q||te(this,I,N,1,255,0),this[N]=I&255,N+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(I,N,Q){return I=+I,N=N>>>0,Q||te(this,I,N,2,65535,0),this[N]=I&255,this[N+1]=I>>>8,N+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(I,N,Q){return I=+I,N=N>>>0,Q||te(this,I,N,2,65535,0),this[N]=I>>>8,this[N+1]=I&255,N+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(I,N,Q){return I=+I,N=N>>>0,Q||te(this,I,N,4,4294967295,0),this[N+3]=I>>>24,this[N+2]=I>>>16,this[N+1]=I>>>8,this[N]=I&255,N+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(I,N,Q){return I=+I,N=N>>>0,Q||te(this,I,N,4,4294967295,0),this[N]=I>>>24,this[N+1]=I>>>16,this[N+2]=I>>>8,this[N+3]=I&255,N+4},a.prototype.writeIntLE=function(I,N,Q,ce){if(I=+I,N=N>>>0,!ce){var pe=Math.pow(2,8*Q-1);te(this,I,N,Q,pe-1,-pe)}var he=0,Ce=1,_e=0;for(this[N]=I&255;++he<Q&&(Ce*=256);)I<0&&_e===0&&this[N+he-1]!==0&&(_e=1),this[N+he]=(I/Ce>>0)-_e&255;return N+Q},a.prototype.writeIntBE=function(I,N,Q,ce){if(I=+I,N=N>>>0,!ce){var pe=Math.pow(2,8*Q-1);te(this,I,N,Q,pe-1,-pe)}var he=Q-1,Ce=1,_e=0;for(this[N+he]=I&255;--he>=0&&(Ce*=256);)I<0&&_e===0&&this[N+he+1]!==0&&(_e=1),this[N+he]=(I/Ce>>0)-_e&255;return N+Q},a.prototype.writeInt8=function(I,N,Q){return I=+I,N=N>>>0,Q||te(this,I,N,1,127,-128),I<0&&(I=255+I+1),this[N]=I&255,N+1},a.prototype.writeInt16LE=function(I,N,Q){return I=+I,N=N>>>0,Q||te(this,I,N,2,32767,-32768),this[N]=I&255,this[N+1]=I>>>8,N+2},a.prototype.writeInt16BE=function(I,N,Q){return I=+I,N=N>>>0,Q||te(this,I,N,2,32767,-32768),this[N]=I>>>8,this[N+1]=I&255,N+2},a.prototype.writeInt32LE=function(I,N,Q){return I=+I,N=N>>>0,Q||te(this,I,N,4,2147483647,-2147483648),this[N]=I&255,this[N+1]=I>>>8,this[N+2]=I>>>16,this[N+3]=I>>>24,N+4},a.prototype.writeInt32BE=function(I,N,Q){return I=+I,N=N>>>0,Q||te(this,I,N,4,2147483647,-2147483648),I<0&&(I=4294967295+I+1),this[N]=I>>>24,this[N+1]=I>>>16,this[N+2]=I>>>8,this[N+3]=I&255,N+4};function z(j,I,N,Q,ce,pe){if(N+Q>j.length)throw new RangeError("Index out of range");if(N<0)throw new RangeError("Index out of range")}function $(j,I,N,Q,ce){return I=+I,N=N>>>0,ce||z(j,I,N,4),r.write(j,I,N,Q,23,4),N+4}a.prototype.writeFloatLE=function(I,N,Q){return $(this,I,N,!0,Q)},a.prototype.writeFloatBE=function(I,N,Q){return $(this,I,N,!1,Q)};function F(j,I,N,Q,ce){return I=+I,N=N>>>0,ce||z(j,I,N,8),r.write(j,I,N,Q,52,8),N+8}a.prototype.writeDoubleLE=function(I,N,Q){return F(this,I,N,!0,Q)},a.prototype.writeDoubleBE=function(I,N,Q){return F(this,I,N,!1,Q)},a.prototype.copy=function(I,N,Q,ce){if(!a.isBuffer(I))throw new TypeError("argument should be a Buffer");if(Q||(Q=0),!ce&&ce!==0&&(ce=this.length),N>=I.length&&(N=I.length),N||(N=0),ce>0&&ce<Q&&(ce=Q),ce===Q||I.length===0||this.length===0)return 0;if(N<0)throw new RangeError("targetStart out of bounds");if(Q<0||Q>=this.length)throw new RangeError("Index out of range");if(ce<0)throw new RangeError("sourceEnd out of bounds");ce>this.length&&(ce=this.length),I.length-N<ce-Q&&(ce=I.length-N+Q);var pe=ce-Q;return this===I&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(N,Q,ce):Uint8Array.prototype.set.call(I,this.subarray(Q,ce),N),pe},a.prototype.fill=function(I,N,Q,ce){if(typeof I=="string"){if(typeof N=="string"?(ce=N,N=0,Q=this.length):typeof Q=="string"&&(ce=Q,Q=this.length),ce!==void 0&&typeof ce!="string")throw new TypeError("encoding must be a string");if(typeof ce=="string"&&!a.isEncoding(ce))throw new TypeError("Unknown encoding: "+ce);if(I.length===1){var pe=I.charCodeAt(0);(ce==="utf8"&&pe<128||ce==="latin1")&&(I=pe)}}else typeof I=="number"?I=I&255:typeof I=="boolean"&&(I=Number(I));if(N<0||this.length<N||this.length<Q)throw new RangeError("Out of range index");if(Q<=N)return this;N=N>>>0,Q=Q===void 0?this.length:Q>>>0,I||(I=0);var he;if(typeof I=="number")for(he=N;he<Q;++he)this[he]=I;else{var Ce=a.isBuffer(I)?I:a.from(I,ce),_e=Ce.length;if(_e===0)throw new TypeError('The value "'+I+'" is invalid for argument "value"');for(he=0;he<Q-N;++he)this[he+N]=Ce[he%_e]}return this};var ee=/[^+/0-9A-Za-z-_]/g;function ne(j){if(j=j.split("=")[0],j=j.trim().replace(ee,""),j.length<2)return"";for(;j.length%4!==0;)j=j+"=";return j}function le(j,I){I=I||1/0;for(var N,Q=j.length,ce=null,pe=[],he=0;he<Q;++he){if(N=j.charCodeAt(he),N>55295&&N<57344){if(!ce){if(N>56319){(I-=3)>-1&&pe.push(239,191,189);continue}else if(he+1===Q){(I-=3)>-1&&pe.push(239,191,189);continue}ce=N;continue}if(N<56320){(I-=3)>-1&&pe.push(239,191,189),ce=N;continue}N=(ce-55296<<10|N-56320)+65536}else ce&&(I-=3)>-1&&pe.push(239,191,189);if(ce=null,N<128){if((I-=1)<0)break;pe.push(N)}else if(N<2048){if((I-=2)<0)break;pe.push(N>>6|192,N&63|128)}else if(N<65536){if((I-=3)<0)break;pe.push(N>>12|224,N>>6&63|128,N&63|128)}else if(N<1114112){if((I-=4)<0)break;pe.push(N>>18|240,N>>12&63|128,N>>6&63|128,N&63|128)}else throw new Error("Invalid code point")}return pe}function me(j){for(var I=[],N=0;N<j.length;++N)I.push(j.charCodeAt(N)&255);return I}function ve(j,I){for(var N,Q,ce,pe=[],he=0;he<j.length&&!((I-=2)<0);++he)N=j.charCodeAt(he),Q=N>>8,ce=N%256,pe.push(ce),pe.push(Q);return pe}function Pe(j){return e.toByteArray(ne(j))}function Ue(j,I,N,Q){for(var ce=0;ce<Q&&!(ce+N>=I.length||ce>=j.length);++ce)I[ce+N]=j[ce];return ce}function M(j,I){return j instanceof I||j!=null&&j.constructor!=null&&j.constructor.name!=null&&j.constructor.name===I.name}function V(j){return j!==j}var oe=function(){for(var j="0123456789abcdef",I=new Array(256),N=0;N<16;++N)for(var Q=N*16,ce=0;ce<16;++ce)I[Q+ce]=j[N]+j[ce];return I}()})(ha);let O2=null;var SU=function(){return O2===null&&(O2={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),O2},Iw={},ZC={};const R2=ic,Ere=new Set(["buffer","view","utf8"]);let Are=class{constructor(e){if(this.encode=e.encode||this.encode,this.decode=e.decode||this.decode,this.name=e.name||this.name,this.format=e.format||this.format,typeof this.encode!="function")throw new TypeError("The 'encode' property must be a function");if(typeof this.decode!="function")throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),typeof this.name!="string"||this.name==="")throw new TypeError("The 'name' property must be a string");if(typeof this.format!="string"||!Ere.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");e.createViewTranscoder&&(this.createViewTranscoder=e.createViewTranscoder),e.createBufferTranscoder&&(this.createBufferTranscoder=e.createBufferTranscoder),e.createUTF8Transcoder&&(this.createUTF8Transcoder=e.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new R2(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new R2(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new R2(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}};ZC.Encoding=Are;const{Buffer:QC}=ha||{},{Encoding:eI}=ZC,Sre=SU;let tI=class extends eI{constructor(e){super({...e,format:"buffer"})}createViewTranscoder(){return new rI({encode:this.encode,decode:e=>this.decode(QC.from(e.buffer,e.byteOffset,e.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}},rI=class extends eI{constructor(e){super({...e,format:"view"})}createBufferTranscoder(){return new tI({encode:e=>{const r=this.encode(e);return QC.from(r.buffer,r.byteOffset,r.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}},Tre=class extends eI{constructor(e){super({...e,format:"utf8"})}createBufferTranscoder(){return new tI({encode:e=>QC.from(this.encode(e),"utf8"),decode:e=>this.decode(e.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){const{textEncoder:e,textDecoder:r}=Sre();return new rI({encode:n=>e.encode(this.encode(n)),decode:n=>this.decode(r.decode(n)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}};Iw.BufferFormat=tI;Iw.ViewFormat=rI;Iw.UTF8Format=Tre;const{Buffer:Qi}=ha||{Buffer:{isBuffer:()=>!1}},{textEncoder:TU,textDecoder:YR}=SU(),{BufferFormat:kw,ViewFormat:nI,UTF8Format:DU}=Iw,EE=t=>t;Rp.utf8=new DU({encode:function(t){return Qi.isBuffer(t)?t.toString("utf8"):ArrayBuffer.isView(t)?YR.decode(t):String(t)},decode:EE,name:"utf8",createViewTranscoder(){return new nI({encode:function(t){return ArrayBuffer.isView(t)?t:TU.encode(t)},decode:function(t){return YR.decode(t)},name:`${this.name}+view`})},createBufferTranscoder(){return new kw({encode:function(t){return Qi.isBuffer(t)?t:ArrayBuffer.isView(t)?Qi.from(t.buffer,t.byteOffset,t.byteLength):Qi.from(String(t),"utf8")},decode:function(t){return t.toString("utf8")},name:`${this.name}+buffer`})}});Rp.json=new DU({encode:JSON.stringify,decode:JSON.parse,name:"json"});Rp.buffer=new kw({encode:function(t){return Qi.isBuffer(t)?t:ArrayBuffer.isView(t)?Qi.from(t.buffer,t.byteOffset,t.byteLength):Qi.from(String(t),"utf8")},decode:EE,name:"buffer",createViewTranscoder(){return new nI({encode:function(t){return ArrayBuffer.isView(t)?t:Qi.from(String(t),"utf8")},decode:function(t){return Qi.from(t.buffer,t.byteOffset,t.byteLength)},name:`${this.name}+view`})}});Rp.view=new nI({encode:function(t){return ArrayBuffer.isView(t)?t:TU.encode(t)},decode:EE,name:"view",createBufferTranscoder(){return new kw({encode:function(t){return Qi.isBuffer(t)?t:ArrayBuffer.isView(t)?Qi.from(t.buffer,t.byteOffset,t.byteLength):Qi.from(String(t),"utf8")},decode:EE,name:`${this.name}+buffer`})}});Rp.hex=new kw({encode:function(t){return Qi.isBuffer(t)?t:Qi.from(String(t),"hex")},decode:function(t){return t.toString("hex")},name:"hex"});Rp.base64=new kw({encode:function(t){return Qi.isBuffer(t)?t:Qi.from(String(t),"base64")},decode:function(t){return t.toString("base64")},name:"base64"});const ZR=ic,AE=Rp,{Encoding:Dre}=ZC,{BufferFormat:xre,ViewFormat:Pre,UTF8Format:Cre}=Iw,bg=Symbol("formats"),L_=Symbol("encodings"),Ire=new Set(["buffer","view","utf8"]);let kre=class{constructor(e){if(Array.isArray(e)){if(!e.every(r=>Ire.has(r)))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}else throw new TypeError("The first argument 'formats' must be an array");this[L_]=new Map,this[bg]=new Set(e);for(const r in AE)try{this.encoding(r)}catch(n){if(n.code!=="LEVEL_ENCODING_NOT_SUPPORTED")throw n}}encodings(){return Array.from(new Set(this[L_].values()))}encoding(e){let r=this[L_].get(e);if(r===void 0){if(typeof e=="string"&&e!==""){if(r=Nre[e],!r)throw new ZR(`Encoding '${e}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if(typeof e!="object"||e===null)throw new TypeError("First argument 'encoding' must be a string or object");r=$re(e)}const{name:n,format:s}=r;if(!this[bg].has(s))if(this[bg].has("view"))r=r.createViewTranscoder();else if(this[bg].has("buffer"))r=r.createBufferTranscoder();else if(this[bg].has("utf8"))r=r.createUTF8Transcoder();else throw new ZR(`Encoding '${n}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});for(const i of[e,n,r.name,r.commonName])this[L_].set(i,r)}return r}};EU.Transcoder=kre;function $re(t){if(t instanceof Dre)return t;const e="type"in t&&typeof t.type=="string"?t.type:void 0,r=t.name||e||`anonymous-${Bre++}`;switch(Ore(t)){case"view":return new Pre({...t,name:r});case"utf8":return new Cre({...t,name:r});case"buffer":return new xre({...t,name:r});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}function Ore(t){return"format"in t&&t.format!==void 0?t.format:"buffer"in t&&typeof t.buffer=="boolean"?t.buffer?"buffer":"utf8":"code"in t&&Number.isInteger(t.code)?"view":"buffer"}const Rre={binary:AE.buffer,"utf-8":AE.utf8},Nre={...AE,...Rre};let Bre=0;var iI={exports:{}},Gm=typeof Reflect=="object"?Reflect:null,QR=Gm&&typeof Gm.apply=="function"?Gm.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},u1;Gm&&typeof Gm.ownKeys=="function"?u1=Gm.ownKeys:Object.getOwnPropertySymbols?u1=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:u1=function(e){return Object.getOwnPropertyNames(e)};function Fre(t){console&&console.warn&&console.warn(t)}var xU=Number.isNaN||function(e){return e!==e};function jr(){jr.init.call(this)}iI.exports=jr;iI.exports.once=Lre;jr.EventEmitter=jr;jr.prototype._events=void 0;jr.prototype._eventsCount=0;jr.prototype._maxListeners=void 0;var eN=10;function GA(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(jr,"defaultMaxListeners",{enumerable:!0,get:function(){return eN},set:function(t){if(typeof t!="number"||t<0||xU(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");eN=t}});jr.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};jr.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||xU(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function PU(t){return t._maxListeners===void 0?jr.defaultMaxListeners:t._maxListeners}jr.prototype.getMaxListeners=function(){return PU(this)};jr.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var s=e==="error",i=this._events;if(i!==void 0)s=s&&i.error===void 0;else if(!s)return!1;if(s){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var u=i[e];if(u===void 0)return!1;if(typeof u=="function")QR(u,this,r);else for(var l=u.length,c=OU(u,l),n=0;n<l;++n)QR(c[n],this,r);return!0};function CU(t,e,r,n){var s,i,o;if(GA(r),i=t._events,i===void 0?(i=t._events=Object.create(null),t._eventsCount=0):(i.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),i=t._events),o=i[e]),o===void 0)o=i[e]=r,++t._eventsCount;else if(typeof o=="function"?o=i[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),s=PU(t),s>0&&o.length>s&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,Fre(a)}return t}jr.prototype.addListener=function(e,r){return CU(this,e,r,!1)};jr.prototype.on=jr.prototype.addListener;jr.prototype.prependListener=function(e,r){return CU(this,e,r,!0)};function Mre(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function IU(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},s=Mre.bind(n);return s.listener=r,n.wrapFn=s,s}jr.prototype.once=function(e,r){return GA(r),this.on(e,IU(this,e,r)),this};jr.prototype.prependOnceListener=function(e,r){return GA(r),this.prependListener(e,IU(this,e,r)),this};jr.prototype.removeListener=function(e,r){var n,s,i,o,a;if(GA(r),s=this._events,s===void 0)return this;if(n=s[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,i=o;break}if(i<0)return this;i===0?n.shift():jre(n,i),n.length===1&&(s[e]=n[0]),s.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this};jr.prototype.off=jr.prototype.removeListener;jr.prototype.removeAllListeners=function(e){var r,n,s;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var i=Object.keys(n),o;for(s=0;s<i.length;++s)o=i[s],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(s=r.length-1;s>=0;s--)this.removeListener(e,r[s]);return this};function kU(t,e,r){var n=t._events;if(n===void 0)return[];var s=n[e];return s===void 0?[]:typeof s=="function"?r?[s.listener||s]:[s]:r?Ure(s):OU(s,s.length)}jr.prototype.listeners=function(e){return kU(this,e,!0)};jr.prototype.rawListeners=function(e){return kU(this,e,!1)};jr.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):$U.call(t,e)};jr.prototype.listenerCount=$U;function $U(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}jr.prototype.eventNames=function(){return this._eventsCount>0?u1(this._events):[]};function OU(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function jre(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Ure(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Lre(t,e){return new Promise(function(r,n){function s(o){t.removeListener(e,i),n(o)}function i(){typeof t.removeListener=="function"&&t.removeListener("error",s),r([].slice.call(arguments))}RU(t,e,i,{once:!0}),e!=="error"&&Kre(t,s,{once:!0})})}function Kre(t,e,r){typeof t.on=="function"&&RU(t,"error",e,r)}function RU(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function s(i){n.once&&t.removeEventListener(e,s),r(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var JA=iI.exports,Vy={},Vre=typeof queueMicrotask=="function"?queueMicrotask:t=>Promise.resolve().then(t),tN=Vre;Vy.fromCallback=function(t,e){if(t===void 0){var r=new Promise(function(n,s){t=function(i,o){i?s(i):n(o)}});t[e!==void 0?e:"promise"]=r}else if(typeof t!="function")throw new TypeError("Callback must be a function");return t};Vy.fromPromise=function(t,e){if(e===void 0)return t;t.then(function(r){tN(()=>e(null,r))}).catch(function(r){tN(()=>e(r))})};var sc={},$w={};$w.getCallback=function(t,e){return typeof t=="function"?t:e};$w.getOptions=function(t,e){return typeof t=="object"&&t!==null?t:e!==void 0?e:{}};const{fromCallback:N2}=Vy,no=ic,{getOptions:B2,getCallback:rN}=$w,Hf=Symbol("promise"),tm=Symbol("callback"),Za=Symbol("working"),Nh=Symbol("handleOne"),Kc=Symbol("handleMany"),F2=Symbol("autoClose"),mf=Symbol("finishWork"),Fu=Symbol("returnMany"),Ul=Symbol("closing"),Eg=Symbol("handleClose"),K_=Symbol("closed"),Ag=Symbol("closeCallbacks"),Zd=Symbol("keyEncoding"),fp=Symbol("valueEncoding"),M2=Symbol("abortOnClose"),V_=Symbol("legacy"),j2=Symbol("keys"),U2=Symbol("values"),Ll=Symbol("limit"),Go=Symbol("count"),q_=Object.freeze({}),qre=()=>{};let nN=!1;class sI{constructor(e,r,n){if(typeof e!="object"||e===null){const s=e===null?"null":typeof e;throw new TypeError(`The first argument must be an abstract-level database, received ${s}`)}if(typeof r!="object"||r===null)throw new TypeError("The second argument must be an options object");this[K_]=!1,this[Ag]=[],this[Za]=!1,this[Ul]=!1,this[F2]=!1,this[tm]=null,this[Nh]=this[Nh].bind(this),this[Kc]=this[Kc].bind(this),this[Eg]=this[Eg].bind(this),this[Zd]=r[Zd],this[fp]=r[fp],this[V_]=n,this[Ll]=Number.isInteger(r.limit)&&r.limit>=0?r.limit:1/0,this[Go]=0,this[M2]=!!r.abortOnClose,this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get count(){return this[Go]}get limit(){return this[Ll]}next(e){let r;if(e===void 0)r=new Promise((n,s)=>{e=(i,o,a)=>{i?s(i):this[V_]?o===void 0&&a===void 0?n():n([o,a]):n(o)}});else if(typeof e!="function")throw new TypeError("Callback must be a function");return this[Ul]?this.nextTick(e,new no("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[Za]?this.nextTick(e,new no("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[Za]=!0,this[tm]=e,this[Go]>=this[Ll]?this.nextTick(this[Nh],null):this._next(this[Nh])),r}_next(e){this.nextTick(e)}nextv(e,r,n){return n=rN(r,n),n=N2(n,Hf),r=B2(r,q_),Number.isInteger(e)?(this[Ul]?this.nextTick(n,new no("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[Za]?this.nextTick(n,new no("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(e<1&&(e=1),this[Ll]<1/0&&(e=Math.min(e,this[Ll]-this[Go])),this[Za]=!0,this[tm]=n,e<=0?this.nextTick(this[Kc],null,[]):this._nextv(e,r,this[Kc])),n[Hf]):(this.nextTick(n,new TypeError("The first argument 'size' must be an integer")),n[Hf])}_nextv(e,r,n){const s=[],i=(o,a,u)=>{if(o)return n(o);if(this[V_]?a===void 0&&u===void 0:a===void 0)return n(null,s);s.push(this[V_]?[a,u]:a),s.length===e?n(null,s):this._next(i)};this._next(i)}all(e,r){return r=rN(e,r),r=N2(r,Hf),e=B2(e,q_),this[Ul]?this.nextTick(r,new no("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[Za]?this.nextTick(r,new no("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[Za]=!0,this[tm]=r,this[F2]=!0,this[Go]>=this[Ll]?this.nextTick(this[Kc],null,[]):this._all(e,this[Kc])),r[Hf]}_all(e,r){let n=this[Go];const s=[],i=()=>{const a=this[Ll]<1/0?Math.min(1e3,this[Ll]-n):1e3;a<=0?this.nextTick(r,null,s):this._nextv(a,q_,o)},o=(a,u)=>{a?r(a):u.length===0?r(null,s):(s.push.apply(s,u),n+=u.length,i())};i()}[mf](){const e=this[tm];return this[M2]&&e===null?qre:(this[Za]=!1,this[tm]=null,this[Ul]&&this._close(this[Eg]),e)}[Fu](e,r,n){this[F2]?this.close(e.bind(null,r,n)):e(r,n)}seek(e,r){if(r=B2(r,q_),!this[Ul]){if(this[Za])throw new no("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{const n=this.db.keyEncoding(r.keyEncoding||this[Zd]),s=n.format;r.keyEncoding!==s&&(r={...r,keyEncoding:s});const i=this.db.prefixKey(n.encode(e),s);this._seek(i,r)}}}_seek(e,r){throw new no("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(e){return e=N2(e,Hf),this[K_]?this.nextTick(e):this[Ul]?this[Ag].push(e):(this[Ul]=!0,this[Ag].push(e),this[Za]?this[M2]&&this[mf]()(new no("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this._close(this[Eg])),e[Hf]}_close(e){this.nextTick(e)}[Eg](){this[K_]=!0,this.db.detachResource(this);const e=this[Ag];this[Ag]=[];for(const r of e)r()}async*[Symbol.asyncIterator](){try{let e;for(;(e=await this.next())!==void 0;)yield e}finally{this[K_]||await this.close()}}}let XA=class extends sI{constructor(e,r){super(e,r,!0),this[j2]=r.keys!==!1,this[U2]=r.values!==!1}[Nh](e,r,n){const s=this[mf]();if(e)return s(e);try{r=this[j2]&&r!==void 0?this[Zd].decode(r):void 0,n=this[U2]&&n!==void 0?this[fp].decode(n):void 0}catch(i){return s(new fy("entry",i))}r===void 0&&n===void 0||this[Go]++,s(null,r,n)}[Kc](e,r){const n=this[mf]();if(e)return this[Fu](n,e);try{for(const s of r){const i=s[0],o=s[1];s[0]=this[j2]&&i!==void 0?this[Zd].decode(i):void 0,s[1]=this[U2]&&o!==void 0?this[fp].decode(o):void 0}}catch(s){return this[Fu](n,new fy("entries",s))}this[Go]+=r.length,this[Fu](n,null,r)}end(e){return!nN&&typeof console<"u"&&(nN=!0,console.warn(new no("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(e)}},Hre=class extends sI{constructor(e,r){super(e,r,!1)}[Nh](e,r){const n=this[mf]();if(e)return n(e);try{r=r!==void 0?this[Zd].decode(r):void 0}catch(s){return n(new fy("key",s))}r!==void 0&&this[Go]++,n(null,r)}[Kc](e,r){const n=this[mf]();if(e)return this[Fu](n,e);try{for(let s=0;s<r.length;s++){const i=r[s];r[s]=i!==void 0?this[Zd].decode(i):void 0}}catch(s){return this[Fu](n,new fy("keys",s))}this[Go]+=r.length,this[Fu](n,null,r)}},zre=class extends sI{constructor(e,r){super(e,r,!1)}[Nh](e,r){const n=this[mf]();if(e)return n(e);try{r=r!==void 0?this[fp].decode(r):void 0}catch(s){return n(new fy("value",s))}r!==void 0&&this[Go]++,n(null,r)}[Kc](e,r){const n=this[mf]();if(e)return this[Fu](n,e);try{for(let s=0;s<r.length;s++){const i=r[s];r[s]=i!==void 0?this[fp].decode(i):void 0}}catch(s){return this[Fu](n,new fy("values",s))}this[Go]+=r.length,this[Fu](n,null,r)}};class fy extends no{constructor(e,r){super(`Iterator could not decode ${e}`,{code:"LEVEL_DECODE_ERROR",cause:r})}}for(const t of["_ended property","_nexting property","_end method"])Object.defineProperty(XA.prototype,t.split(" ")[0],{get(){throw new no(`The ${t} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new no(`The ${t} has been removed`,{code:"LEVEL_LEGACY"})}});XA.keyEncoding=Zd;XA.valueEncoding=fp;sc.AbstractIterator=XA;sc.AbstractKeyIterator=Hre;sc.AbstractValueIterator=zre;var oI={};const{AbstractKeyIterator:Wre,AbstractValueIterator:Gre}=sc,xh=Symbol("iterator"),Sg=Symbol("callback"),hy=Symbol("handleOne"),Yh=Symbol("handleMany");let vx=class extends Wre{constructor(e,r){super(e,r),this[xh]=e.iterator({...r,keys:!0,values:!1}),this[hy]=this[hy].bind(this),this[Yh]=this[Yh].bind(this)}},NU=class extends Gre{constructor(e,r){super(e,r),this[xh]=e.iterator({...r,keys:!1,values:!0}),this[hy]=this[hy].bind(this),this[Yh]=this[Yh].bind(this)}};for(const t of[vx,NU]){const e=t===vx,r=e?n=>n[0]:n=>n[1];t.prototype._next=function(n){this[Sg]=n,this[xh].next(this[hy])},t.prototype[hy]=function(n,s,i){const o=this[Sg];n?o(n):o(null,e?s:i)},t.prototype._nextv=function(n,s,i){this[Sg]=i,this[xh].nextv(n,s,this[Yh])},t.prototype._all=function(n,s){this[Sg]=s,this[xh].all(n,this[Yh])},t.prototype[Yh]=function(n,s){const i=this[Sg];n?i(n):i(null,s.map(r))},t.prototype._seek=function(n,s){this[xh].seek(n,s)},t.prototype._close=function(n){this[xh].close(n)}}oI.DefaultKeyIterator=vx;oI.DefaultValueIterator=NU;var YA={};const{AbstractIterator:Jre,AbstractKeyIterator:Xre,AbstractValueIterator:Yre}=sc,L2=ic,ks=Symbol("nut"),ZA=Symbol("undefer"),QA=Symbol("factory");let BU=class extends Jre{constructor(e,r){super(e,r),this[ks]=null,this[QA]=()=>e.iterator(r),this.db.defer(()=>this[ZA]())}},FU=class extends Xre{constructor(e,r){super(e,r),this[ks]=null,this[QA]=()=>e.keys(r),this.db.defer(()=>this[ZA]())}},MU=class extends Yre{constructor(e,r){super(e,r),this[ks]=null,this[QA]=()=>e.values(r),this.db.defer(()=>this[ZA]())}};for(const t of[BU,FU,MU])t.prototype[ZA]=function(){this.db.status==="open"&&(this[ks]=this[QA]())},t.prototype._next=function(e){this[ks]!==null?this[ks].next(e):this.db.status==="opening"?this.db.defer(()=>this._next(e)):this.nextTick(e,new L2("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},t.prototype._nextv=function(e,r,n){this[ks]!==null?this[ks].nextv(e,r,n):this.db.status==="opening"?this.db.defer(()=>this._nextv(e,r,n)):this.nextTick(n,new L2("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},t.prototype._all=function(e,r){this[ks]!==null?this[ks].all(r):this.db.status==="opening"?this.db.defer(()=>this._all(e,r)):this.nextTick(r,new L2("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},t.prototype._seek=function(e,r){this[ks]!==null?this[ks]._seek(e,r):this.db.status==="opening"&&this.db.defer(()=>this._seek(e,r))},t.prototype._close=function(e){this[ks]!==null?this[ks].close(e):this.db.status==="opening"?this.db.defer(()=>this._close(e)):this.nextTick(e)};YA.DeferredIterator=BU;YA.DeferredKeyIterator=FU;YA.DeferredValueIterator=MU;var jU={},aI={};const{fromCallback:iN}=Vy,H_=ic,{getCallback:Zre,getOptions:Qre}=$w,z_=Symbol("promise"),Co=Symbol("status"),rm=Symbol("operations"),Tg=Symbol("finishClose"),nm=Symbol("closeCallbacks");let ene=class{constructor(e){if(typeof e!="object"||e===null){const r=e===null?"null":typeof e;throw new TypeError(`The first argument must be an abstract-level database, received ${r}`)}this[rm]=[],this[nm]=[],this[Co]="open",this[Tg]=this[Tg].bind(this),this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get length(){return this[rm].length}put(e,r,n){if(this[Co]!=="open")throw new H_("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const s=this.db._checkKey(e)||this.db._checkValue(r);if(s)throw s;const i=n&&n.sublevel!=null?n.sublevel:this.db,o=n,a=i.keyEncoding(n&&n.keyEncoding),u=i.valueEncoding(n&&n.valueEncoding),l=a.format;n={...n,keyEncoding:l,valueEncoding:u.format},i!==this.db&&(n.sublevel=null);const c=i.prefixKey(a.encode(e),l),d=u.encode(r);return this._put(c,d,n),this[rm].push({...o,type:"put",key:e,value:r}),this}_put(e,r,n){}del(e,r){if(this[Co]!=="open")throw new H_("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const n=this.db._checkKey(e);if(n)throw n;const s=r&&r.sublevel!=null?r.sublevel:this.db,i=r,o=s.keyEncoding(r&&r.keyEncoding),a=o.format;return r={...r,keyEncoding:a},s!==this.db&&(r.sublevel=null),this._del(s.prefixKey(o.encode(e),a),r),this[rm].push({...i,type:"del",key:e}),this}_del(e,r){}clear(){if(this[Co]!=="open")throw new H_("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[rm]=[],this}_clear(){}write(e,r){return r=Zre(e,r),r=iN(r,z_),e=Qre(e),this[Co]!=="open"?this.nextTick(r,new H_("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):this.length===0?this.close(r):(this[Co]="writing",this._write(e,n=>{this[Co]="closing",this[nm].push(()=>r(n)),n||this.db.emit("batch",this[rm]),this._close(this[Tg])})),r[z_]}_write(e,r){}close(e){return e=iN(e,z_),this[Co]==="closing"?this[nm].push(e):this[Co]==="closed"?this.nextTick(e):(this[nm].push(e),this[Co]!=="writing"&&(this[Co]="closing",this._close(this[Tg]))),e[z_]}_close(e){this.nextTick(e)}[Tg](){this[Co]="closed",this.db.detachResource(this);const e=this[nm];this[nm]=[];for(const r of e)r()}};aI.AbstractChainedBatch=ene;const{AbstractChainedBatch:tne}=aI,rne=ic,im=Symbol("encoded");let nne=class extends tne{constructor(e){super(e),this[im]=[]}_put(e,r,n){this[im].push({...n,type:"put",key:e,value:r})}_del(e,r){this[im].push({...r,type:"del",key:e})}_clear(){this[im]=[]}_write(e,r){this.db.status==="opening"?this.db.defer(()=>this._write(e,r)):this.db.status==="open"?this[im].length===0?this.nextTick(r):this.db._batch(this[im],e,r):this.nextTick(r,new rne("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}};jU.DefaultChainedBatch=nne;const sN=ic,ine=Object.prototype.hasOwnProperty,sne=new Set(["lt","lte","gt","gte"]);var one=function(t,e){const r={};for(const n in t)if(ine.call(t,n)&&!(n==="keyEncoding"||n==="valueEncoding")){if(n==="start"||n==="end")throw new sN(`The legacy range option '${n}' has been removed`,{code:"LEVEL_LEGACY"});if(n==="encoding")throw new sN("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});sne.has(n)?r[n]=e.encode(t[n]):r[n]=t[n]}return r.reverse=!!r.reverse,r.limit=Number.isInteger(r.limit)&&r.limit>=0?r.limit:-1,r};/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let oN;var UU=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:Ar):t=>(oN||(oN=Promise.resolve())).then(t).catch(e=>setTimeout(()=>{throw e},0)),K2,aN;function ane(){if(aN)return K2;aN=1;const t=UU;return K2=function(e,...r){r.length===0?t(e):t(()=>e(...r))},K2}var Dg={},uN;function une(){if(uN)return Dg;uN=1;const{AbstractIterator:t,AbstractKeyIterator:e,AbstractValueIterator:r}=sc,n=Symbol("unfix"),s=Symbol("iterator"),i=Symbol("handleOne"),o=Symbol("handleMany"),a=Symbol("callback");class u extends t{constructor(h,f,p,m){super(h,f),this[s]=p,this[n]=m,this[i]=this[i].bind(this),this[o]=this[o].bind(this),this[a]=null}[i](h,f,p){const m=this[a];if(h)return m(h);f!==void 0&&(f=this[n](f)),m(h,f,p)}[o](h,f){const p=this[a];if(h)return p(h);for(const m of f){const E=m[0];E!==void 0&&(m[0]=this[n](E))}p(h,f)}}class l extends e{constructor(h,f,p,m){super(h,f),this[s]=p,this[n]=m,this[i]=this[i].bind(this),this[o]=this[o].bind(this),this[a]=null}[i](h,f){const p=this[a];if(h)return p(h);f!==void 0&&(f=this[n](f)),p(h,f)}[o](h,f){const p=this[a];if(h)return p(h);for(let m=0;m<f.length;m++){const E=f[m];E!==void 0&&(f[m]=this[n](E))}p(h,f)}}class c extends r{constructor(h,f,p){super(h,f),this[s]=p}}for(const d of[u,l])d.prototype._next=function(h){this[a]=h,this[s].next(this[i])},d.prototype._nextv=function(h,f,p){this[a]=p,this[s].nextv(h,f,this[o])},d.prototype._all=function(h,f){this[a]=f,this[s].all(h,this[o])};for(const d of[c])d.prototype._next=function(h){this[s].next(h)},d.prototype._nextv=function(h,f,p){this[s].nextv(h,f,p)},d.prototype._all=function(h,f){this[s].all(h,f)};for(const d of[u,l,c])d.prototype._seek=function(h,f){this[s].seek(h,f)},d.prototype._close=function(h){this[s].close(h)};return Dg.AbstractSublevelIterator=u,Dg.AbstractSublevelKeyIterator=l,Dg.AbstractSublevelValueIterator=c,Dg}var V2,cN;function cne(){if(cN)return V2;cN=1;const t=ic,{Buffer:e}=ha||{},{AbstractSublevelIterator:r,AbstractSublevelKeyIterator:n,AbstractSublevelValueIterator:s}=une(),i=Symbol("prefix"),o=Symbol("upperBound"),a=Symbol("prefixRange"),u=Symbol("parent"),l=Symbol("unfix"),c=new TextEncoder,d={separator:"!"};V2=function({AbstractLevel:A}){class _ extends A{static defaults(v){if(typeof v=="string")throw new t("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(v&&v.open)throw new t("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return v==null?d:v.separator?v:{...v,separator:"!"}}constructor(v,S,x){const{separator:D,manifest:w,...b}=_.defaults(x);S=E(S,D);const T=D.charCodeAt(0)+1,P=v[u]||v;if(!c.encode(S).every(K=>K>T&&K<127))throw new t(`Prefix must use bytes > ${T} < 127`,{code:"LEVEL_INVALID_PREFIX"});super(h(P,w),b);const C=(v.prefix||"")+D+S+D,k=C.slice(0,-1)+String.fromCharCode(T);this[u]=P,this[i]=new p(C),this[o]=new p(k),this[l]=new m,this.nextTick=P.nextTick}prefixKey(v,S){if(S==="utf8")return this[i].utf8+v;if(v.byteLength===0)return this[i][S];if(S==="view"){const x=this[i].view,D=new Uint8Array(x.byteLength+v.byteLength);return D.set(x,0),D.set(v,x.byteLength),D}else{const x=this[i].buffer;return e.concat([x,v],x.byteLength+v.byteLength)}}[a](v,S){v.gte!==void 0?v.gte=this.prefixKey(v.gte,S):v.gt!==void 0?v.gt=this.prefixKey(v.gt,S):v.gte=this[i][S],v.lte!==void 0?v.lte=this.prefixKey(v.lte,S):v.lt!==void 0?v.lt=this.prefixKey(v.lt,S):v.lte=this[o][S]}get prefix(){return this[i].utf8}get db(){return this[u]}_open(v,S){this[u].open({passive:!0},S)}_put(v,S,x,D){this[u].put(v,S,x,D)}_get(v,S,x){this[u].get(v,S,x)}_getMany(v,S,x){this[u].getMany(v,S,x)}_del(v,S,x){this[u].del(v,S,x)}_batch(v,S,x){this[u].batch(v,S,x)}_clear(v,S){this[a](v,v.keyEncoding),this[u].clear(v,S)}_iterator(v){this[a](v,v.keyEncoding);const S=this[u].iterator(v),x=this[l].get(this[i].utf8.length,v.keyEncoding);return new r(this,v,S,x)}_keys(v){this[a](v,v.keyEncoding);const S=this[u].keys(v),x=this[l].get(this[i].utf8.length,v.keyEncoding);return new n(this,v,S,x)}_values(v){this[a](v,v.keyEncoding);const S=this[u].values(v);return new s(this,v,S)}}return{AbstractSublevel:_}};const h=function(A,_){return{...A.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},..._,encodings:{utf8:f(A,"utf8"),buffer:f(A,"buffer"),view:f(A,"view")}}},f=function(A,_){return A.supports.encodings[_]?A.keyEncoding(_).name===_:!1};class p{constructor(_){this.utf8=_,this.view=c.encode(_),this.buffer=e?e.from(this.view.buffer,0,this.view.byteLength):{}}}class m{constructor(){this.cache=new Map}get(_,g){let v=this.cache.get(g);return v===void 0&&(g==="view"?v=(function(S,x){return x.subarray(S)}).bind(null,_):v=(function(S,x){return x.slice(S)}).bind(null,_),this.cache.set(g,v)),v}}const E=function(A,_){let g=0,v=A.length;for(;g<v&&A[g]===_;)g++;for(;v>g&&A[v-1]===_;)v--;return A.slice(g,v)};return V2}const{supports:lne}=bU,{Transcoder:dne}=EU,{EventEmitter:fne}=JA,{fromCallback:Kl}=Vy,_a=ic,{AbstractIterator:zf}=sc,{DefaultKeyIterator:hne,DefaultValueIterator:pne}=oI,{DeferredIterator:mne,DeferredKeyIterator:yne,DeferredValueIterator:gne}=YA,{DefaultChainedBatch:lN}=jU,{getCallback:Wf,getOptions:Vl}=$w,W_=one,Vt=Symbol("promise"),mc=Symbol("landed"),Gf=Symbol("resources"),q2=Symbol("closeResources"),xg=Symbol("operations"),Pg=Symbol("undefer"),G_=Symbol("deferOpen"),dN=Symbol("options"),nr=Symbol("status"),Jf=Symbol("defaultOptions"),sm=Symbol("transcoder"),J_=Symbol("keyEncoding"),H2=Symbol("valueEncoding"),vne=()=>{};let uI=class extends fne{constructor(e,r){if(super(),typeof e!="object"||e===null)throw new TypeError("The first argument 'manifest' must be an object");r=Vl(r);const{keyEncoding:n,valueEncoding:s,passive:i,...o}=r;this[Gf]=new Set,this[xg]=[],this[G_]=!0,this[dN]=o,this[nr]="opening",this.supports=lne(e,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:e.snapshots!==!1,permanence:e.permanence!==!1,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:e.encodings||{},events:Object.assign({},e.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[sm]=new dne(wne(this)),this[J_]=this[sm].encoding(n||"utf8"),this[H2]=this[sm].encoding(s||"utf8");for(const a of this[sm].encodings())this.supports.encodings[a.commonName]||(this.supports.encodings[a.commonName]=!0);this[Jf]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[J_].commonName,valueEncoding:this[H2].commonName}),key:Object.freeze({keyEncoding:this[J_].commonName})},this.nextTick(()=>{this[G_]&&this.open({passive:!1},vne)})}get status(){return this[nr]}keyEncoding(e){return this[sm].encoding(e??this[J_])}valueEncoding(e){return this[sm].encoding(e??this[H2])}open(e,r){r=Wf(e,r),r=Kl(r,Vt),e={...this[dN],...Vl(e)},e.createIfMissing=e.createIfMissing!==!1,e.errorIfExists=!!e.errorIfExists;const n=s=>{this[nr]==="closing"||this[nr]==="opening"?this.once(mc,s?()=>n(s):n):this[nr]!=="open"?r(new _a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:s})):r()};return e.passive?this[nr]==="opening"?this.once(mc,n):this.nextTick(n):this[nr]==="closed"||this[G_]?(this[G_]=!1,this[nr]="opening",this.emit("opening"),this._open(e,s=>{if(s){this[nr]="closed",this[q2](()=>{this.emit(mc),n(s)}),this[Pg]();return}this[nr]="open",this[Pg](),this.emit(mc),this[nr]==="open"&&this.emit("open"),this[nr]==="open"&&this.emit("ready"),n()})):this[nr]==="open"?this.nextTick(n):this.once(mc,()=>this.open(e,r)),r[Vt]}_open(e,r){this.nextTick(r)}close(e){e=Kl(e,Vt);const r=n=>{this[nr]==="opening"||this[nr]==="closing"?this.once(mc,n?r(n):r):this[nr]!=="closed"?e(new _a("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:n})):e()};if(this[nr]==="open"){this[nr]="closing",this.emit("closing");const n=s=>{this[nr]="open",this[Pg](),this.emit(mc),r(s)};this[q2](()=>{this._close(s=>{if(s)return n(s);this[nr]="closed",this[Pg](),this.emit(mc),this[nr]==="closed"&&this.emit("closed"),r()})})}else this[nr]==="closed"?this.nextTick(r):this.once(mc,()=>this.close(e));return e[Vt]}[q2](e){if(this[Gf].size===0)return this.nextTick(e);let r=this[Gf].size,n=!0;const s=()=>{--r===0&&(n?this.nextTick(e):e())};for(const i of this[Gf])i.close(s);n=!1,this[Gf].clear()}_close(e){this.nextTick(e)}get(e,r,n){if(n=Wf(r,n),n=Kl(n,Vt),r=Vl(r,this[Jf].entry),this[nr]==="opening")return this.defer(()=>this.get(e,r,n)),n[Vt];if(om(this,n))return n[Vt];const s=this._checkKey(e);if(s)return this.nextTick(n,s),n[Vt];const i=this.keyEncoding(r.keyEncoding),o=this.valueEncoding(r.valueEncoding),a=i.format,u=o.format;return(r.keyEncoding!==a||r.valueEncoding!==u)&&(r=Object.assign({},r,{keyEncoding:a,valueEncoding:u})),this._get(this.prefixKey(i.encode(e),a),r,(l,c)=>{if(l)return(l.code==="LEVEL_NOT_FOUND"||l.notFound||/NotFound/i.test(l))&&(l.code||(l.code="LEVEL_NOT_FOUND"),l.notFound||(l.notFound=!0),l.status||(l.status=404)),n(l);try{c=o.decode(c)}catch(d){return n(new _a("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:d}))}n(null,c)}),n[Vt]}_get(e,r,n){this.nextTick(n,new Error("NotFound"))}getMany(e,r,n){if(n=Wf(r,n),n=Kl(n,Vt),r=Vl(r,this[Jf].entry),this[nr]==="opening")return this.defer(()=>this.getMany(e,r,n)),n[Vt];if(om(this,n))return n[Vt];if(!Array.isArray(e))return this.nextTick(n,new TypeError("The first argument 'keys' must be an array")),n[Vt];if(e.length===0)return this.nextTick(n,null,[]),n[Vt];const s=this.keyEncoding(r.keyEncoding),i=this.valueEncoding(r.valueEncoding),o=s.format,a=i.format;(r.keyEncoding!==o||r.valueEncoding!==a)&&(r=Object.assign({},r,{keyEncoding:o,valueEncoding:a}));const u=new Array(e.length);for(let l=0;l<e.length;l++){const c=e[l],d=this._checkKey(c);if(d)return this.nextTick(n,d),n[Vt];u[l]=this.prefixKey(s.encode(c),o)}return this._getMany(u,r,(l,c)=>{if(l)return n(l);try{for(let d=0;d<c.length;d++)c[d]!==void 0&&(c[d]=i.decode(c[d]))}catch(d){return n(new _a(`Could not decode one or more of ${c.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:d}))}n(null,c)}),n[Vt]}_getMany(e,r,n){this.nextTick(n,null,new Array(e.length).fill(void 0))}put(e,r,n,s){if(s=Wf(n,s),s=Kl(s,Vt),n=Vl(n,this[Jf].entry),this[nr]==="opening")return this.defer(()=>this.put(e,r,n,s)),s[Vt];if(om(this,s))return s[Vt];const i=this._checkKey(e)||this._checkValue(r);if(i)return this.nextTick(s,i),s[Vt];const o=this.keyEncoding(n.keyEncoding),a=this.valueEncoding(n.valueEncoding),u=o.format,l=a.format;(n.keyEncoding!==u||n.valueEncoding!==l)&&(n=Object.assign({},n,{keyEncoding:u,valueEncoding:l}));const c=this.prefixKey(o.encode(e),u),d=a.encode(r);return this._put(c,d,n,h=>{if(h)return s(h);this.emit("put",e,r),s()}),s[Vt]}_put(e,r,n,s){this.nextTick(s)}del(e,r,n){if(n=Wf(r,n),n=Kl(n,Vt),r=Vl(r,this[Jf].key),this[nr]==="opening")return this.defer(()=>this.del(e,r,n)),n[Vt];if(om(this,n))return n[Vt];const s=this._checkKey(e);if(s)return this.nextTick(n,s),n[Vt];const i=this.keyEncoding(r.keyEncoding),o=i.format;return r.keyEncoding!==o&&(r=Object.assign({},r,{keyEncoding:o})),this._del(this.prefixKey(i.encode(e),o),r,a=>{if(a)return n(a);this.emit("del",e),n()}),n[Vt]}_del(e,r,n){this.nextTick(n)}batch(e,r,n){if(!arguments.length){if(this[nr]==="opening")return new lN(this);if(this[nr]!=="open")throw new _a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(typeof e=="function"?n=e:n=Wf(r,n),n=Kl(n,Vt),r=Vl(r,this[Jf].empty),this[nr]==="opening")return this.defer(()=>this.batch(e,r,n)),n[Vt];if(om(this,n))return n[Vt];if(!Array.isArray(e))return this.nextTick(n,new TypeError("The first argument 'operations' must be an array")),n[Vt];if(e.length===0)return this.nextTick(n),n[Vt];const s=new Array(e.length),{keyEncoding:i,valueEncoding:o,...a}=r;for(let u=0;u<e.length;u++){if(typeof e[u]!="object"||e[u]===null)return this.nextTick(n,new TypeError("A batch operation must be an object")),n[Vt];const l=Object.assign({},e[u]);if(l.type!=="put"&&l.type!=="del")return this.nextTick(n,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),n[Vt];const c=this._checkKey(l.key);if(c)return this.nextTick(n,c),n[Vt];const d=l.sublevel!=null?l.sublevel:this,h=d.keyEncoding(l.keyEncoding||i),f=h.format;if(l.key=d.prefixKey(h.encode(l.key),f),l.keyEncoding=f,l.type==="put"){const p=this._checkValue(l.value);if(p)return this.nextTick(n,p),n[Vt];const m=d.valueEncoding(l.valueEncoding||o);l.value=m.encode(l.value),l.valueEncoding=m.format}d!==this&&(l.sublevel=null),s[u]=l}return this._batch(s,a,u=>{if(u)return n(u);this.emit("batch",e),n()}),n[Vt]}_batch(e,r,n){this.nextTick(n)}sublevel(e,r){return this._sublevel(e,wx.defaults(r))}_sublevel(e,r){return new wx(this,e,r)}prefixKey(e,r){return e}clear(e,r){if(r=Wf(e,r),r=Kl(r,Vt),e=Vl(e,this[Jf].empty),this[nr]==="opening")return this.defer(()=>this.clear(e,r)),r[Vt];if(om(this,r))return r[Vt];const n=e,s=this.keyEncoding(e.keyEncoding);return e=W_(e,s),e.keyEncoding=s.format,e.limit===0?this.nextTick(r):this._clear(e,i=>{if(i)return r(i);this.emit("clear",n),r()}),r[Vt]}_clear(e,r){this.nextTick(r)}iterator(e){const r=this.keyEncoding(e&&e.keyEncoding),n=this.valueEncoding(e&&e.valueEncoding);if(e=W_(e,r),e.keys=e.keys!==!1,e.values=e.values!==!1,e[zf.keyEncoding]=r,e[zf.valueEncoding]=n,e.keyEncoding=r.format,e.valueEncoding=n.format,this[nr]==="opening")return new mne(this,e);if(this[nr]!=="open")throw new _a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(e)}_iterator(e){return new zf(this,e)}keys(e){const r=this.keyEncoding(e&&e.keyEncoding),n=this.valueEncoding(e&&e.valueEncoding);if(e=W_(e,r),e[zf.keyEncoding]=r,e[zf.valueEncoding]=n,e.keyEncoding=r.format,e.valueEncoding=n.format,this[nr]==="opening")return new yne(this,e);if(this[nr]!=="open")throw new _a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(e)}_keys(e){return new hne(this,e)}values(e){const r=this.keyEncoding(e&&e.keyEncoding),n=this.valueEncoding(e&&e.valueEncoding);if(e=W_(e,r),e[zf.keyEncoding]=r,e[zf.valueEncoding]=n,e.keyEncoding=r.format,e.valueEncoding=n.format,this[nr]==="opening")return new gne(this,e);if(this[nr]!=="open")throw new _a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(e)}_values(e){return new pne(this,e)}defer(e){if(typeof e!="function")throw new TypeError("The first argument must be a function");this[xg].push(e)}[Pg](){if(this[xg].length===0)return;const e=this[xg];this[xg]=[];for(const r of e)r()}attachResource(e){if(typeof e!="object"||e===null||typeof e.close!="function")throw new TypeError("The first argument must be a resource object");this[Gf].add(e)}detachResource(e){this[Gf].delete(e)}_chainedBatch(){return new lN(this)}_checkKey(e){if(e==null)return new _a("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(e){if(e==null)return new _a("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}};uI.prototype.nextTick=ane();const{AbstractSublevel:wx}=cne()({AbstractLevel:uI});zA.AbstractLevel=uI;zA.AbstractSublevel=wx;const om=function(t,e){return t[nr]!=="open"?(t.nextTick(e,new _a("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0):!1},wne=function(t){return Object.keys(t.supports.encodings).filter(e=>!!t.supports.encodings[e])};Df.AbstractLevel=zA.AbstractLevel;Df.AbstractSublevel=zA.AbstractSublevel;Df.AbstractIterator=sc.AbstractIterator;Df.AbstractKeyIterator=sc.AbstractKeyIterator;Df.AbstractValueIterator=sc.AbstractValueIterator;Df.AbstractChainedBatch=aI.AbstractChainedBatch;/*! run-parallel-limit. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var _ne=Ene;const bne=UU;function Ene(t,e,r){if(typeof e!="number")throw new Error("second argument must be a Number");let n,s,i,o,a,u=!0,l;Array.isArray(t)?(n=[],i=s=t.length):(o=Object.keys(t),n={},i=s=o.length);function c(h){function f(){r&&r(h,n),r=null}u?bne(f):f()}function d(h,f,p){if(n[h]=p,f&&(a=!0),--i===0||f)c(f);else if(!a&&l<s){let m;o?(m=o[l],l+=1,t[m](function(E,A){d(m,E,A)})):(m=l,l+=1,t[m](function(E,A){d(m,E,A)}))}}l=e,i?o?o.some(function(h,f){return t[h](function(p,m){d(h,p,m)}),f===e-1}):t.some(function(h,f){return h(function(p,m){d(f,p,m)}),f===e-1}):c(null),u=!1}var LU={},KU=function(e){const r=e.gte!==void 0?e.gte:e.gt!==void 0?e.gt:void 0,n=e.lte!==void 0?e.lte:e.lt!==void 0?e.lt:void 0,s=e.gte===void 0,i=e.lte===void 0;return r!==void 0&&n!==void 0?IDBKeyRange.bound(r,n,s,i):r!==void 0?IDBKeyRange.lowerBound(r,s):n!==void 0?IDBKeyRange.upperBound(n,i):null};const Ane=new TextEncoder;var VU=function(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):Ane.encode(t)};const{AbstractIterator:Sne}=Df,fN=KU,X_=VU,Qa=Symbol("cache"),yc=Symbol("finished"),Ys=Symbol("options"),gc=Symbol("currentOptions"),Xf=Symbol("position"),z2=Symbol("location"),am=Symbol("first"),hN={};let Tne=class extends Sne{constructor(e,r,n){super(e,n),this[Qa]=[],this[yc]=this.limit===0,this[Ys]=n,this[gc]={...n},this[Xf]=void 0,this[z2]=r,this[am]=!0}_nextv(e,r,n){if(this[am]=!1,this[yc])return this.nextTick(n,null,[]);if(this[Qa].length>0)return e=Math.min(e,this[Qa].length),this.nextTick(n,null,this[Qa].splice(0,e));this[Xf]!==void 0&&(this[Ys].reverse?(this[gc].lt=this[Xf],this[gc].lte=void 0):(this[gc].gt=this[Xf],this[gc].gte=void 0));let s;try{s=fN(this[gc])}catch{return this[yc]=!0,this.nextTick(n,null,[])}const i=this.db.db.transaction([this[z2]],"readonly"),o=i.objectStore(this[z2]),a=[];if(this[Ys].reverse){const u=!this[Ys].values&&o.openKeyCursor?"openKeyCursor":"openCursor";o[u](s,"prev").onsuccess=l=>{const c=l.target.result;if(c){const{key:d,value:h}=c;this[Xf]=d,a.push([this[Ys].keys&&d!==void 0?X_(d):void 0,this[Ys].values&&h!==void 0?X_(h):void 0]),a.length<e?c.continue():pN(i)}else this[yc]=!0}}else{let u,l;const c=()=>{if(u===void 0||l===void 0)return;const d=Math.max(u.length,l.length);d===0||e===1/0?this[yc]=!0:this[Xf]=u[d-1],a.length=d;for(let h=0;h<d;h++){const f=u[h],p=l[h];a[h]=[this[Ys].keys&&f!==void 0?X_(f):void 0,this[Ys].values&&p!==void 0?X_(p):void 0]}pN(i)};this[Ys].keys||e<1/0?o.getAllKeys(s,e<1/0?e:void 0).onsuccess=d=>{u=d.target.result,c()}:(u=[],this.nextTick(c)),this[Ys].values?o.getAll(s,e<1/0?e:void 0).onsuccess=d=>{l=d.target.result,c()}:(l=[],this.nextTick(c))}i.onabort=()=>{n(i.error||new Error("aborted by user")),n=null},i.oncomplete=()=>{n(null,a),n=null}}_next(e){if(this[Qa].length>0){const[r,n]=this[Qa].shift();this.nextTick(e,null,r,n)}else if(this[yc])this.nextTick(e);else{let r=Math.min(100,this.limit-this.count);this[am]&&(this[am]=!1,r=1),this._nextv(r,hN,(n,s)=>{if(n)return e(n);this[Qa]=s,this._next(e)})}}_all(e,r){this[am]=!1;const n=this[Qa].splice(0,this[Qa].length),s=this.limit-this.count-n.length;if(s<=0)return this.nextTick(r,null,n);this._nextv(s,hN,(i,o)=>{if(i)return r(i);n.length>0&&(o=n.concat(o)),r(null,o)})}_seek(e,r){this[am]=!0,this[Qa]=[],this[yc]=!1,this[Xf]=void 0,this[gc]={...this[Ys]};let n;try{n=fN(this[Ys])}catch{this[yc]=!0;return}n!==null&&!n.includes(e)?this[yc]=!0:this[Ys].reverse?this[gc].lte=e:this[gc].gte=e}};LU.Iterator=Tne;function pN(t){typeof t.commit=="function"&&t.commit()}var Dne=function(e,r,n,s,i){if(s.limit===0)return e.nextTick(i);const o=e.db.transaction([r],"readwrite"),a=o.objectStore(r);let u=0;o.oncomplete=function(){i()},o.onabort=function(){i(o.error||new Error("aborted by user"))};const l=a.openKeyCursor?"openKeyCursor":"openCursor",c=s.reverse?"prev":"next";a[l](n,c).onsuccess=function(d){const h=d.target.result;h&&(a.delete(h.key).onsuccess=function(){(s.limit<=0||++u<s.limit)&&h.continue()})}};const{AbstractLevel:xne}=Df,mN=ic,Pne=_ne,{fromCallback:Cne}=Vy,{Iterator:Ine}=LU,yN=VU,kne=Dne,$ne=KU,qU="level-js-",Cg=Symbol("idb"),W2=Symbol("namePrefix"),vc=Symbol("location"),G2=Symbol("version"),Yf=Symbol("store"),Ig=Symbol("onComplete"),gN=Symbol("promise");class One extends xne{constructor(e,r,n){if(typeof r=="function"||typeof n=="function")throw new mN("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});const{prefix:s,version:i,...o}=r||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},o),typeof e!="string")throw new Error("constructor requires a location string argument");this[vc]=e,this[W2]=s??qU,this[G2]=parseInt(i||1,10),this[Cg]=null}get location(){return this[vc]}get namePrefix(){return this[W2]}get version(){return this[G2]}get db(){return this[Cg]}get type(){return"browser-level"}_open(e,r){const n=indexedDB.open(this[W2]+this[vc],this[G2]);n.onerror=function(){r(n.error||new Error("unknown error"))},n.onsuccess=()=>{this[Cg]=n.result,r()},n.onupgradeneeded=s=>{const i=s.target.result;i.objectStoreNames.contains(this[vc])||i.createObjectStore(this[vc])}}[Yf](e){return this[Cg].transaction([this[vc]],e).objectStore(this[vc])}[Ig](e,r){const n=e.transaction;n.onabort=function(){r(n.error||new Error("aborted by user"))},n.oncomplete=function(){r(null,e.result)}}_get(e,r,n){const s=this[Yf]("readonly");let i;try{i=s.get(e)}catch(o){return this.nextTick(n,o)}this[Ig](i,function(o,a){if(o)return n(o);if(a===void 0)return n(new mN("Entry not found",{code:"LEVEL_NOT_FOUND"}));n(null,yN(a))})}_getMany(e,r,n){const s=this[Yf]("readonly"),i=e.map(o=>a=>{let u;try{u=s.get(o)}catch(l){return a(l)}u.onsuccess=()=>{const l=u.result;a(null,l===void 0?l:yN(l))},u.onerror=l=>{l.stopPropagation(),a(u.error)}});Pne(i,16,n)}_del(e,r,n){const s=this[Yf]("readwrite");let i;try{i=s.delete(e)}catch(o){return this.nextTick(n,o)}this[Ig](i,n)}_put(e,r,n,s){const i=this[Yf]("readwrite");let o;try{o=i.put(r,e)}catch(a){return this.nextTick(s,a)}this[Ig](o,s)}_iterator(e){return new Ine(this,this[vc],e)}_batch(e,r,n){const s=this[Yf]("readwrite"),i=s.transaction;let o=0,a;i.onabort=function(){n(a||i.error||new Error("aborted by user"))},i.oncomplete=function(){n()};function u(){const l=e[o++],c=l.key;let d;try{d=l.type==="del"?s.delete(c):s.put(l.value,c)}catch(h){a=h,i.abort();return}o<e.length?d.onsuccess=u:typeof i.commit=="function"&&i.commit()}u()}_clear(e,r){let n,s;try{n=$ne(e)}catch{return this.nextTick(r)}if(e.limit>=0)return kne(this,this[vc],n,e,r);try{const i=this[Yf]("readwrite");s=n?i.delete(n):i.clear()}catch(i){return this.nextTick(r,i)}this[Ig](s,r)}_close(e){this[Cg].close(),this.nextTick(e)}}One.destroy=function(t,e,r){typeof e=="function"&&(r=e,e=qU),r=Cne(r,gN);const n=indexedDB.deleteDatabase(e+t);return n.onsuccess=function(){r()},n.onerror=function(s){r(s)},r[gN]};var Rne={exports:{}},J2={exports:{}},Gn={ArrayIsArray(t){return Array.isArray(t)},ArrayPrototypeIncludes(t,e){return t.includes(e)},ArrayPrototypeIndexOf(t,e){return t.indexOf(e)},ArrayPrototypeJoin(t,e){return t.join(e)},ArrayPrototypeMap(t,e){return t.map(e)},ArrayPrototypePop(t,e){return t.pop(e)},ArrayPrototypePush(t,e){return t.push(e)},ArrayPrototypeSlice(t,e,r){return t.slice(e,r)},Error,FunctionPrototypeCall(t,e,...r){return t.call(e,...r)},FunctionPrototypeSymbolHasInstance(t,e){return Function.prototype[Symbol.hasInstance].call(t,e)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(t,e){return Object.defineProperties(t,e)},ObjectDefineProperty(t,e,r){return Object.defineProperty(t,e,r)},ObjectGetOwnPropertyDescriptor(t,e){return Object.getOwnPropertyDescriptor(t,e)},ObjectKeys(t){return Object.keys(t)},ObjectSetPrototypeOf(t,e){return Object.setPrototypeOf(t,e)},Promise,PromisePrototypeCatch(t,e){return t.catch(e)},PromisePrototypeThen(t,e,r){return t.then(e,r)},PromiseReject(t){return Promise.reject(t)},ReflectApply:Reflect.apply,RegExpPrototypeTest(t,e){return t.test(e)},SafeSet:Set,String,StringPrototypeSlice(t,e,r){return t.slice(e,r)},StringPrototypeToLowerCase(t){return t.toLowerCase()},StringPrototypeToUpperCase(t){return t.toUpperCase()},StringPrototypeTrim(t){return t.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet(t,e,r){return t.set(e,r)},Uint8Array},HU={exports:{}};(function(t){const e=ha,r=Object.getPrototypeOf(async function(){}).constructor,n=globalThis.Blob||e.Blob,s=typeof n<"u"?function(a){return a instanceof n}:function(a){return!1};class i extends Error{constructor(a){if(!Array.isArray(a))throw new TypeError(`Expected input to be an Array, got ${typeof a}`);let u="";for(let l=0;l<a.length;l++)u+=`    ${a[l].stack}
`;super(u),this.name="AggregateError",this.errors=a}}t.exports={AggregateError:i,kEmptyObject:Object.freeze({}),once(o){let a=!1;return function(...u){a||(a=!0,o.apply(this,u))}},createDeferredPromise:function(){let o,a;return{promise:new Promise((l,c)=>{o=l,a=c}),resolve:o,reject:a}},promisify(o){return new Promise((a,u)=>{o((l,...c)=>l?u(l):a(...c))})},debuglog(){return function(){}},format(o,...a){return o.replace(/%([sdifj])/g,function(...[u,l]){const c=a.shift();return l==="f"?c.toFixed(6):l==="j"?JSON.stringify(c):l==="s"&&typeof c=="object"?`${c.constructor!==Object?c.constructor.name:""} {}`.trim():c.toString()})},inspect(o){switch(typeof o){case"string":if(o.includes("'"))if(o.includes('"')){if(!o.includes("`")&&!o.includes("${"))return`\`${o}\``}else return`"${o}"`;return`'${o}'`;case"number":return isNaN(o)?"NaN":Object.is(o,-0)?String(o):o;case"bigint":return`${String(o)}n`;case"boolean":case"undefined":return String(o);case"object":return"{}"}},types:{isAsyncFunction(o){return o instanceof r},isArrayBufferView(o){return ArrayBuffer.isView(o)}},isBlob:s},t.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")})(HU);var xl=HU.exports,cI={},c1={exports:{}},Nne=c1.exports,vN;function lI(){return vN||(vN=1,Object.defineProperty(Nne,"__esModule",{value:!0}),c1.exports=Object.freeze(Object.create(null,{__unenv__:{get:()=>!0}}))),c1.exports}const{format:Bne,inspect:SE,AggregateError:Fne}=xl,Mne=globalThis.AggregateError||Fne,jne=Symbol("kIsNodeError"),Une=["string","function","number","object","Function","Object","boolean","bigint","symbol"],Lne=/^([A-Z][a-z0-9]*)+$/,Kne="__node_internal_",eS={};function Zh(t,e){if(!t)throw new eS.ERR_INTERNAL_ASSERTION(e)}function wN(t){let e="",r=t.length;const n=t[0]==="-"?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function Vne(t,e,r){if(typeof e=="function")return Zh(e.length<=r.length,`Code: ${t}; The provided arguments length (${r.length}) does not match the required ones (${e.length}).`),e(...r);const n=(e.match(/%[dfijoOs]/g)||[]).length;return Zh(n===r.length,`Code: ${t}; The provided arguments length (${r.length}) does not match the required ones (${n}).`),r.length===0?e:Bne(e,...r)}function ji(t,e,r){r||(r=Error);class n extends r{constructor(...i){super(Vne(t,e,i))}toString(){return`${this.name} [${t}]: ${this.message}`}}Object.defineProperties(n.prototype,{name:{value:r.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${t}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),n.prototype.code=t,n.prototype[jne]=!0,eS[t]=n}function _N(t){const e=Kne+t.name;return Object.defineProperty(t,"name",{value:e}),t}function qne(t,e){if(t&&e&&t!==e){if(Array.isArray(e.errors))return e.errors.push(t),e;const r=new Mne([e,t],e.message);return r.code=e.code,r}return t||e}let Hne=class extends Error{constructor(e="The operation was aborted",r=void 0){if(r!==void 0&&typeof r!="object")throw new eS.ERR_INVALID_ARG_TYPE("options","Object",r);super(e,r),this.code="ABORT_ERR",this.name="AbortError"}};ji("ERR_ASSERTION","%s",Error);ji("ERR_INVALID_ARG_TYPE",(t,e,r)=>{Zh(typeof t=="string","'name' must be a string"),Array.isArray(e)||(e=[e]);let n="The ";t.endsWith(" argument")?n+=`${t} `:n+=`"${t}" ${t.includes(".")?"property":"argument"} `,n+="must be ";const s=[],i=[],o=[];for(const u of e)Zh(typeof u=="string","All expected entries have to be of type string"),Une.includes(u)?s.push(u.toLowerCase()):Lne.test(u)?i.push(u):(Zh(u!=="object",'The value "object" should be written as "Object"'),o.push(u));if(i.length>0){const u=s.indexOf("object");u!==-1&&(s.splice(s,u,1),i.push("Object"))}if(s.length>0){switch(s.length){case 1:n+=`of type ${s[0]}`;break;case 2:n+=`one of type ${s[0]} or ${s[1]}`;break;default:{const u=s.pop();n+=`one of type ${s.join(", ")}, or ${u}`}}(i.length>0||o.length>0)&&(n+=" or ")}if(i.length>0){switch(i.length){case 1:n+=`an instance of ${i[0]}`;break;case 2:n+=`an instance of ${i[0]} or ${i[1]}`;break;default:{const u=i.pop();n+=`an instance of ${i.join(", ")}, or ${u}`}}o.length>0&&(n+=" or ")}switch(o.length){case 0:break;case 1:o[0].toLowerCase()!==o[0]&&(n+="an "),n+=`${o[0]}`;break;case 2:n+=`one of ${o[0]} or ${o[1]}`;break;default:{const u=o.pop();n+=`one of ${o.join(", ")}, or ${u}`}}if(r==null)n+=`. Received ${r}`;else if(typeof r=="function"&&r.name)n+=`. Received function ${r.name}`;else if(typeof r=="object"){var a;if((a=r.constructor)!==null&&a!==void 0&&a.name)n+=`. Received an instance of ${r.constructor.name}`;else{const u=SE(r,{depth:-1});n+=`. Received ${u}`}}else{let u=SE(r,{colors:!1});u.length>25&&(u=`${u.slice(0,25)}...`),n+=`. Received type ${typeof r} (${u})`}return n},TypeError);ji("ERR_INVALID_ARG_VALUE",(t,e,r="is invalid")=>{let n=SE(e);return n.length>128&&(n=n.slice(0,128)+"..."),`The ${t.includes(".")?"property":"argument"} '${t}' ${r}. Received ${n}`},TypeError);ji("ERR_INVALID_RETURN_VALUE",(t,e,r)=>{var n;const s=r!=null&&(n=r.constructor)!==null&&n!==void 0&&n.name?`instance of ${r.constructor.name}`:`type ${typeof r}`;return`Expected ${t} to be returned from the "${e}" function but got ${s}.`},TypeError);ji("ERR_MISSING_ARGS",(...t)=>{Zh(t.length>0,"At least one arg needs to be specified");let e;const r=t.length;switch(t=(Array.isArray(t)?t:[t]).map(n=>`"${n}"`).join(" or "),r){case 1:e+=`The ${t[0]} argument`;break;case 2:e+=`The ${t[0]} and ${t[1]} arguments`;break;default:{const n=t.pop();e+=`The ${t.join(", ")}, and ${n} arguments`}break}return`${e} must be specified`},TypeError);ji("ERR_OUT_OF_RANGE",(t,e,r)=>{Zh(e,'Missing "range" argument');let n;return Number.isInteger(r)&&Math.abs(r)>2**32?n=wN(String(r)):typeof r=="bigint"?(n=String(r),(r>2n**32n||r<-(2n**32n))&&(n=wN(n)),n+="n"):n=SE(r),`The value of "${t}" is out of range. It must be ${e}. Received ${n}`},RangeError);ji("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error);ji("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error);ji("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error);ji("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error);ji("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error);ji("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);ji("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error);ji("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error);ji("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error);ji("ERR_STREAM_WRITE_AFTER_END","write after end",Error);ji("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError);var Hs={AbortError:Hne,aggregateTwoErrors:_N(qne),hideStackFrames:_N,codes:eS};const{ArrayIsArray:dI,ArrayPrototypeIncludes:zU,ArrayPrototypeJoin:WU,ArrayPrototypeMap:zne,NumberIsInteger:fI,NumberIsNaN:Wne,NumberMAX_SAFE_INTEGER:Gne,NumberMIN_SAFE_INTEGER:Jne,NumberParseInt:Xne,ObjectPrototypeHasOwnProperty:Yne,RegExpPrototypeExec:GU,String:Zne,StringPrototypeToUpperCase:Qne,StringPrototypeTrim:eie}=Gn,{hideStackFrames:pa,codes:{ERR_SOCKET_BAD_PORT:tie,ERR_INVALID_ARG_TYPE:ws,ERR_INVALID_ARG_VALUE:qy,ERR_OUT_OF_RANGE:hp,ERR_UNKNOWN_SIGNAL:bN}}=Hs,{normalizeEncoding:rie}=xl,{isAsyncFunction:nie,isArrayBufferView:iie}=xl.types,EN={};function sie(t){return t===(t|0)}function oie(t){return t===t>>>0}const aie=/^[0-7]+$/,uie="must be a 32-bit unsigned integer or an octal string";function cie(t,e,r){if(typeof t>"u"&&(t=r),typeof t=="string"){if(GU(aie,t)===null)throw new qy(e,t,uie);t=Xne(t,8)}return JU(t,e),t}const lie=pa((t,e,r=Jne,n=Gne)=>{if(typeof t!="number")throw new ws(e,"number",t);if(!fI(t))throw new hp(e,"an integer",t);if(t<r||t>n)throw new hp(e,`>= ${r} && <= ${n}`,t)}),die=pa((t,e,r=-2147483648,n=2147483647)=>{if(typeof t!="number")throw new ws(e,"number",t);if(!fI(t))throw new hp(e,"an integer",t);if(t<r||t>n)throw new hp(e,`>= ${r} && <= ${n}`,t)}),JU=pa((t,e,r=!1)=>{if(typeof t!="number")throw new ws(e,"number",t);if(!fI(t))throw new hp(e,"an integer",t);const n=r?1:0,s=4294967295;if(t<n||t>s)throw new hp(e,`>= ${n} && <= ${s}`,t)});function hI(t,e){if(typeof t!="string")throw new ws(e,"string",t)}function fie(t,e,r=void 0,n){if(typeof t!="number")throw new ws(e,"number",t);if(r!=null&&t<r||n!=null&&t>n||(r!=null||n!=null)&&Wne(t))throw new hp(e,`${r!=null?`>= ${r}`:""}${r!=null&&n!=null?" && ":""}${n!=null?`<= ${n}`:""}`,t)}const hie=pa((t,e,r)=>{if(!zU(r,t)){const s="must be one of: "+WU(zne(r,i=>typeof i=="string"?`'${i}'`:Zne(i)),", ");throw new qy(e,t,s)}});function XU(t,e){if(typeof t!="boolean")throw new ws(e,"boolean",t)}function X2(t,e,r){return t==null||!Yne(t,e)?r:t[e]}const pie=pa((t,e,r=null)=>{const n=X2(r,"allowArray",!1),s=X2(r,"allowFunction",!1);if(!X2(r,"nullable",!1)&&t===null||!n&&dI(t)||typeof t!="object"&&(!s||typeof t!="function"))throw new ws(e,"Object",t)}),mie=pa((t,e)=>{if(t!=null&&typeof t!="object"&&typeof t!="function")throw new ws(e,"a dictionary",t)}),pI=pa((t,e,r=0)=>{if(!dI(t))throw new ws(e,"Array",t);if(t.length<r){const n=`must be longer than ${r}`;throw new qy(e,t,n)}});function yie(t,e){pI(t,e);for(let r=0;r<t.length;r++)hI(t[r],`${e}[${r}]`)}function gie(t,e){pI(t,e);for(let r=0;r<t.length;r++)XU(t[r],`${e}[${r}]`)}function vie(t,e="signal"){if(hI(t,e),EN[t]===void 0)throw EN[Qne(t)]!==void 0?new bN(t+" (signals must use all capital letters)"):new bN(t)}const wie=pa((t,e="buffer")=>{if(!iie(t))throw new ws(e,["Buffer","TypedArray","DataView"],t)});function _ie(t,e){const r=rie(e),n=t.length;if(r==="hex"&&n%2!==0)throw new qy("encoding",e,`is invalid for data of length ${n}`)}function bie(t,e="Port",r=!0){if(typeof t!="number"&&typeof t!="string"||typeof t=="string"&&eie(t).length===0||+t!==+t>>>0||t>65535||t===0&&!r)throw new tie(e,t,r);return t|0}const Eie=pa((t,e)=>{if(t!==void 0&&(t===null||typeof t!="object"||!("aborted"in t)))throw new ws(e,"AbortSignal",t)}),Aie=pa((t,e)=>{if(typeof t!="function")throw new ws(e,"Function",t)}),Sie=pa((t,e)=>{if(typeof t!="function"||nie(t))throw new ws(e,"Function",t)}),Tie=pa((t,e)=>{if(t!==void 0)throw new ws(e,"undefined",t)});function Die(t,e,r){if(!zU(r,t))throw new ws(e,`('${WU(r,"|")}')`,t)}const xie=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function AN(t,e){if(typeof t>"u"||!GU(xie,t))throw new qy(e,t,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function Pie(t){if(typeof t=="string")return AN(t,"hints"),t;if(dI(t)){const e=t.length;let r="";if(e===0)return r;for(let n=0;n<e;n++){const s=t[n];AN(s,"hints"),r+=s,n!==e-1&&(r+=", ")}return r}throw new qy("hints",t,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}var tS={isInt32:sie,isUint32:oie,parseFileMode:cie,validateArray:pI,validateStringArray:yie,validateBooleanArray:gie,validateBoolean:XU,validateBuffer:wie,validateDictionary:mie,validateEncoding:_ie,validateFunction:Aie,validateInt32:die,validateInteger:lie,validateNumber:fie,validateObject:pie,validateOneOf:hie,validatePlainFunction:Sie,validatePort:bie,validateSignalName:vie,validateString:hI,validateUint32:JU,validateUndefined:Tie,validateUnion:Die,validateAbortSignal:Eie,validateLinkHeaderValue:Pie},mI={exports:{}},YU={exports:{}},xn=YU.exports={},wu,_u;function _x(){throw new Error("setTimeout has not been defined")}function bx(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?wu=setTimeout:wu=_x}catch{wu=_x}try{typeof clearTimeout=="function"?_u=clearTimeout:_u=bx}catch{_u=bx}})();function ZU(t){if(wu===setTimeout)return setTimeout(t,0);if((wu===_x||!wu)&&setTimeout)return wu=setTimeout,setTimeout(t,0);try{return wu(t,0)}catch{try{return wu.call(null,t,0)}catch{return wu.call(this,t,0)}}}function Cie(t){if(_u===clearTimeout)return clearTimeout(t);if((_u===bx||!_u)&&clearTimeout)return _u=clearTimeout,clearTimeout(t);try{return _u(t)}catch{try{return _u.call(null,t)}catch{return _u.call(this,t)}}}var rl=[],Jm=!1,Bh,l1=-1;function Iie(){!Jm||!Bh||(Jm=!1,Bh.length?rl=Bh.concat(rl):l1=-1,rl.length&&QU())}function QU(){if(!Jm){var t=ZU(Iie);Jm=!0;for(var e=rl.length;e;){for(Bh=rl,rl=[];++l1<e;)Bh&&Bh[l1].run();l1=-1,e=rl.length}Bh=null,Jm=!1,Cie(t)}}xn.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];rl.push(new e9(t,e)),rl.length===1&&!Jm&&ZU(QU)};function e9(t,e){this.fun=t,this.array=e}e9.prototype.run=function(){this.fun.apply(null,this.array)};xn.title="browser";xn.browser=!0;xn.env={};xn.argv=[];xn.version="";xn.versions={};function Pl(){}xn.on=Pl;xn.addListener=Pl;xn.once=Pl;xn.off=Pl;xn.removeListener=Pl;xn.removeAllListeners=Pl;xn.emit=Pl;xn.prependListener=Pl;xn.prependOnceListener=Pl;xn.listeners=function(t){return[]};xn.binding=function(t){throw new Error("process.binding is not supported")};xn.cwd=function(){return"/"};xn.chdir=function(t){throw new Error("process.chdir is not supported")};xn.umask=function(){return 0};var Np=YU.exports;const{Symbol:rS,SymbolAsyncIterator:SN,SymbolIterator:TN,SymbolFor:t9}=Gn,r9=rS("kDestroyed"),n9=rS("kIsErrored"),Ex=rS("kIsReadable"),i9=rS("kIsDisturbed"),kie=t9("nodejs.webstream.isClosedPromise"),$ie=t9("nodejs.webstream.controllerErrorFunction");function nS(t,e=!1){var r;return!!(t&&typeof t.pipe=="function"&&typeof t.on=="function"&&(!e||typeof t.pause=="function"&&typeof t.resume=="function")&&(!t._writableState||((r=t._readableState)===null||r===void 0?void 0:r.readable)!==!1)&&(!t._writableState||t._readableState))}function iS(t){var e;return!!(t&&typeof t.write=="function"&&typeof t.on=="function"&&(!t._readableState||((e=t._writableState)===null||e===void 0?void 0:e.writable)!==!1))}function Oie(t){return!!(t&&typeof t.pipe=="function"&&t._readableState&&typeof t.on=="function"&&typeof t.write=="function")}function oc(t){return t&&(t._readableState||t._writableState||typeof t.write=="function"&&typeof t.on=="function"||typeof t.pipe=="function"&&typeof t.on=="function")}function s9(t){return!!(t&&!oc(t)&&typeof t.pipeThrough=="function"&&typeof t.getReader=="function"&&typeof t.cancel=="function")}function o9(t){return!!(t&&!oc(t)&&typeof t.getWriter=="function"&&typeof t.abort=="function")}function a9(t){return!!(t&&!oc(t)&&typeof t.readable=="object"&&typeof t.writable=="object")}function Rie(t){return s9(t)||o9(t)||a9(t)}function Nie(t,e){return t==null?!1:e===!0?typeof t[SN]=="function":e===!1?typeof t[TN]=="function":typeof t[SN]=="function"||typeof t[TN]=="function"}function sS(t){if(!oc(t))return null;const e=t._writableState,r=t._readableState,n=e||r;return!!(t.destroyed||t[r9]||n!=null&&n.destroyed)}function u9(t){if(!iS(t))return null;if(t.writableEnded===!0)return!0;const e=t._writableState;return e!=null&&e.errored?!1:typeof(e==null?void 0:e.ended)!="boolean"?null:e.ended}function Bie(t,e){if(!iS(t))return null;if(t.writableFinished===!0)return!0;const r=t._writableState;return r!=null&&r.errored?!1:typeof(r==null?void 0:r.finished)!="boolean"?null:!!(r.finished||e===!1&&r.ended===!0&&r.length===0)}function Fie(t){if(!nS(t))return null;if(t.readableEnded===!0)return!0;const e=t._readableState;return!e||e.errored?!1:typeof(e==null?void 0:e.ended)!="boolean"?null:e.ended}function c9(t,e){if(!nS(t))return null;const r=t._readableState;return r!=null&&r.errored?!1:typeof(r==null?void 0:r.endEmitted)!="boolean"?null:!!(r.endEmitted||e===!1&&r.ended===!0&&r.length===0)}function l9(t){return t&&t[Ex]!=null?t[Ex]:typeof(t==null?void 0:t.readable)!="boolean"?null:sS(t)?!1:nS(t)&&t.readable&&!c9(t)}function d9(t){return typeof(t==null?void 0:t.writable)!="boolean"?null:sS(t)?!1:iS(t)&&t.writable&&!u9(t)}function Mie(t,e){return oc(t)?sS(t)?!0:!((e==null?void 0:e.readable)!==!1&&l9(t)||(e==null?void 0:e.writable)!==!1&&d9(t)):null}function jie(t){var e,r;return oc(t)?t.writableErrored?t.writableErrored:(e=(r=t._writableState)===null||r===void 0?void 0:r.errored)!==null&&e!==void 0?e:null:null}function Uie(t){var e,r;return oc(t)?t.readableErrored?t.readableErrored:(e=(r=t._readableState)===null||r===void 0?void 0:r.errored)!==null&&e!==void 0?e:null:null}function Lie(t){if(!oc(t))return null;if(typeof t.closed=="boolean")return t.closed;const e=t._writableState,r=t._readableState;return typeof(e==null?void 0:e.closed)=="boolean"||typeof(r==null?void 0:r.closed)=="boolean"?(e==null?void 0:e.closed)||(r==null?void 0:r.closed):typeof t._closed=="boolean"&&f9(t)?t._closed:null}function f9(t){return typeof t._closed=="boolean"&&typeof t._defaultKeepAlive=="boolean"&&typeof t._removedConnection=="boolean"&&typeof t._removedContLen=="boolean"}function h9(t){return typeof t._sent100=="boolean"&&f9(t)}function Kie(t){var e;return typeof t._consuming=="boolean"&&typeof t._dumped=="boolean"&&((e=t.req)===null||e===void 0?void 0:e.upgradeOrConnect)===void 0}function Vie(t){if(!oc(t))return null;const e=t._writableState,r=t._readableState,n=e||r;return!n&&h9(t)||!!(n&&n.autoDestroy&&n.emitClose&&n.closed===!1)}function qie(t){var e;return!!(t&&((e=t[i9])!==null&&e!==void 0?e:t.readableDidRead||t.readableAborted))}function Hie(t){var e,r,n,s,i,o,a,u,l,c;return!!(t&&((e=(r=(n=(s=(i=(o=t[n9])!==null&&o!==void 0?o:t.readableErrored)!==null&&i!==void 0?i:t.writableErrored)!==null&&s!==void 0?s:(a=t._readableState)===null||a===void 0?void 0:a.errorEmitted)!==null&&n!==void 0?n:(u=t._writableState)===null||u===void 0?void 0:u.errorEmitted)!==null&&r!==void 0?r:(l=t._readableState)===null||l===void 0?void 0:l.errored)!==null&&e!==void 0?e:!((c=t._writableState)===null||c===void 0)&&c.errored))}var Cl={kDestroyed:r9,isDisturbed:qie,kIsDisturbed:i9,isErrored:Hie,kIsErrored:n9,isReadable:l9,kIsReadable:Ex,kIsClosedPromise:kie,kControllerErrorFunction:$ie,isClosed:Lie,isDestroyed:sS,isDuplexNodeStream:Oie,isFinished:Mie,isIterable:Nie,isReadableNodeStream:nS,isReadableStream:s9,isReadableEnded:Fie,isReadableFinished:c9,isReadableErrored:Uie,isNodeStream:oc,isWebStream:Rie,isWritable:d9,isWritableNodeStream:iS,isWritableStream:o9,isWritableEnded:u9,isWritableFinished:Bie,isWritableErrored:jie,isServerRequest:Kie,isServerResponse:h9,willEmitClose:Vie,isTransformStream:a9};const $d=Np,{AbortError:p9,codes:zie}=Hs,{ERR_INVALID_ARG_TYPE:Wie,ERR_STREAM_PREMATURE_CLOSE:DN}=zie,{kEmptyObject:Ax,once:Sx}=xl,{validateAbortSignal:Gie,validateFunction:Jie,validateObject:Xie,validateBoolean:Yie}=tS,{Promise:Zie,PromisePrototypeThen:Qie}=Gn,{isClosed:ese,isReadable:xN,isReadableNodeStream:Y2,isReadableStream:tse,isReadableFinished:PN,isReadableErrored:CN,isWritable:IN,isWritableNodeStream:kN,isWritableStream:rse,isWritableFinished:$N,isWritableErrored:ON,isNodeStream:nse,willEmitClose:ise,kIsClosedPromise:sse}=Cl;function ose(t){return t.setHeader&&typeof t.abort=="function"}const Tx=()=>{};function m9(t,e,r){var n,s;if(arguments.length===2?(r=e,e=Ax):e==null?e=Ax:Xie(e,"options"),Jie(r,"callback"),Gie(e.signal,"options.signal"),r=Sx(r),tse(t)||rse(t))return ase(t,e,r);if(!nse(t))throw new Wie("stream",["ReadableStream","WritableStream","Stream"],t);const i=(n=e.readable)!==null&&n!==void 0?n:Y2(t),o=(s=e.writable)!==null&&s!==void 0?s:kN(t),a=t._writableState,u=t._readableState,l=()=>{t.writable||h()};let c=ise(t)&&Y2(t)===i&&kN(t)===o,d=$N(t,!1);const h=()=>{d=!0,t.destroyed&&(c=!1),!(c&&(!t.readable||i))&&(!i||f)&&r.call(t)};let f=PN(t,!1);const p=()=>{f=!0,t.destroyed&&(c=!1),!(c&&(!t.writable||o))&&(!o||d)&&r.call(t)},m=S=>{r.call(t,S)};let E=ese(t);const A=()=>{E=!0;const S=ON(t)||CN(t);if(S&&typeof S!="boolean")return r.call(t,S);if(i&&!f&&Y2(t,!0)&&!PN(t,!1))return r.call(t,new DN);if(o&&!d&&!$N(t,!1))return r.call(t,new DN);r.call(t)},_=()=>{E=!0;const S=ON(t)||CN(t);if(S&&typeof S!="boolean")return r.call(t,S);r.call(t)},g=()=>{t.req.on("finish",h)};ose(t)?(t.on("complete",h),c||t.on("abort",A),t.req?g():t.on("request",g)):o&&!a&&(t.on("end",l),t.on("close",l)),!c&&typeof t.aborted=="boolean"&&t.on("aborted",A),t.on("end",p),t.on("finish",h),e.error!==!1&&t.on("error",m),t.on("close",A),E?$d.nextTick(A):a!=null&&a.errorEmitted||u!=null&&u.errorEmitted?c||$d.nextTick(_):(!i&&(!c||xN(t))&&(d||IN(t)===!1)||!o&&(!c||IN(t))&&(f||xN(t)===!1)||u&&t.req&&t.aborted)&&$d.nextTick(_);const v=()=>{r=Tx,t.removeListener("aborted",A),t.removeListener("complete",h),t.removeListener("abort",A),t.removeListener("request",g),t.req&&t.req.removeListener("finish",h),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",h),t.removeListener("end",p),t.removeListener("error",m),t.removeListener("close",A)};if(e.signal&&!E){const S=()=>{const x=r;v(),x.call(t,new p9(void 0,{cause:e.signal.reason}))};if(e.signal.aborted)$d.nextTick(S);else{const x=r;r=Sx((...D)=>{e.signal.removeEventListener("abort",S),x.apply(t,D)}),e.signal.addEventListener("abort",S)}}return v}function ase(t,e,r){let n=!1,s=Tx;if(e.signal)if(s=()=>{n=!0,r.call(t,new p9(void 0,{cause:e.signal.reason}))},e.signal.aborted)$d.nextTick(s);else{const o=r;r=Sx((...a)=>{e.signal.removeEventListener("abort",s),o.apply(t,a)}),e.signal.addEventListener("abort",s)}const i=(...o)=>{n||$d.nextTick(()=>r.apply(t,o))};return Qie(t[sse].promise,i,i),Tx}function use(t,e){var r;let n=!1;return e===null&&(e=Ax),(r=e)!==null&&r!==void 0&&r.cleanup&&(Yie(e.cleanup,"cleanup"),n=e.cleanup),new Zie((s,i)=>{const o=m9(t,e,a=>{n&&o(),a?i(a):s()})})}mI.exports=m9;mI.exports.finished=use;var xf=mI.exports;const Mu=Np,{aggregateTwoErrors:cse,codes:{ERR_MULTIPLE_CALLBACK:lse},AbortError:dse}=Hs,{Symbol:y9}=Gn,{kDestroyed:fse,isDestroyed:hse,isFinished:pse,isServerRequest:mse}=Cl,g9=y9("kDestroy"),Dx=y9("kConstruct");function v9(t,e,r){t&&(t.stack,e&&!e.errored&&(e.errored=t),r&&!r.errored&&(r.errored=t))}function yse(t,e){const r=this._readableState,n=this._writableState,s=n||r;return n!=null&&n.destroyed||r!=null&&r.destroyed?(typeof e=="function"&&e(),this):(v9(t,n,r),n&&(n.destroyed=!0),r&&(r.destroyed=!0),s.constructed?RN(this,t,e):this.once(g9,function(i){RN(this,cse(i,t),e)}),this)}function RN(t,e,r){let n=!1;function s(i){if(n)return;n=!0;const o=t._readableState,a=t._writableState;v9(i,a,o),a&&(a.closed=!0),o&&(o.closed=!0),typeof r=="function"&&r(i),i?Mu.nextTick(gse,t,i):Mu.nextTick(w9,t)}try{t._destroy(e||null,s)}catch(i){s(i)}}function gse(t,e){xx(t,e),w9(t)}function w9(t){const e=t._readableState,r=t._writableState;r&&(r.closeEmitted=!0),e&&(e.closeEmitted=!0),(r!=null&&r.emitClose||e!=null&&e.emitClose)&&t.emit("close")}function xx(t,e){const r=t._readableState,n=t._writableState;n!=null&&n.errorEmitted||r!=null&&r.errorEmitted||(n&&(n.errorEmitted=!0),r&&(r.errorEmitted=!0),t.emit("error",e))}function vse(){const t=this._readableState,e=this._writableState;t&&(t.constructed=!0,t.closed=!1,t.closeEmitted=!1,t.destroyed=!1,t.errored=null,t.errorEmitted=!1,t.reading=!1,t.ended=t.readable===!1,t.endEmitted=t.readable===!1),e&&(e.constructed=!0,e.destroyed=!1,e.closed=!1,e.closeEmitted=!1,e.errored=null,e.errorEmitted=!1,e.finalCalled=!1,e.prefinished=!1,e.ended=e.writable===!1,e.ending=e.writable===!1,e.finished=e.writable===!1)}function Px(t,e,r){const n=t._readableState,s=t._writableState;if(s!=null&&s.destroyed||n!=null&&n.destroyed)return this;n!=null&&n.autoDestroy||s!=null&&s.autoDestroy?t.destroy(e):e&&(e.stack,s&&!s.errored&&(s.errored=e),n&&!n.errored&&(n.errored=e),r?Mu.nextTick(xx,t,e):xx(t,e))}function wse(t,e){if(typeof t._construct!="function")return;const r=t._readableState,n=t._writableState;r&&(r.constructed=!1),n&&(n.constructed=!1),t.once(Dx,e),!(t.listenerCount(Dx)>1)&&Mu.nextTick(_se,t)}function _se(t){let e=!1;function r(n){if(e){Px(t,n??new lse);return}e=!0;const s=t._readableState,i=t._writableState,o=i||s;s&&(s.constructed=!0),i&&(i.constructed=!0),o.destroyed?t.emit(g9,n):n?Px(t,n,!0):Mu.nextTick(bse,t)}try{t._construct(n=>{Mu.nextTick(r,n)})}catch(n){Mu.nextTick(r,n)}}function bse(t){t.emit(Dx)}function NN(t){return(t==null?void 0:t.setHeader)&&typeof t.abort=="function"}function _9(t){t.emit("close")}function Ese(t,e){t.emit("error",e),Mu.nextTick(_9,t)}function Ase(t,e){!t||hse(t)||(!e&&!pse(t)&&(e=new dse),mse(t)?(t.socket=null,t.destroy(e)):NN(t)?t.abort():NN(t.req)?t.req.abort():typeof t.destroy=="function"?t.destroy(e):typeof t.close=="function"?t.close():e?Mu.nextTick(Ese,t,e):Mu.nextTick(_9,t),t.destroyed||(t[fse]=!0))}var Hy={construct:wse,destroyer:Ase,destroy:yse,undestroy:vse,errorOrDestroy:Px};const{ArrayIsArray:Sse,ObjectSetPrototypeOf:b9}=Gn,{EventEmitter:oS}=JA;function aS(t){oS.call(this,t)}b9(aS.prototype,oS.prototype);b9(aS,oS);aS.prototype.pipe=function(t,e){const r=this;function n(c){t.writable&&t.write(c)===!1&&r.pause&&r.pause()}r.on("data",n);function s(){r.readable&&r.resume&&r.resume()}t.on("drain",s),!t._isStdio&&(!e||e.end!==!1)&&(r.on("end",o),r.on("close",a));let i=!1;function o(){i||(i=!0,t.end())}function a(){i||(i=!0,typeof t.destroy=="function"&&t.destroy())}function u(c){l(),oS.listenerCount(this,"error")===0&&this.emit("error",c)}Cx(r,"error",u),Cx(t,"error",u);function l(){r.removeListener("data",n),t.removeListener("drain",s),r.removeListener("end",o),r.removeListener("close",a),r.removeListener("error",u),t.removeListener("error",u),r.removeListener("end",l),r.removeListener("close",l),t.removeListener("close",l)}return r.on("end",l),r.on("close",l),t.on("close",l),t.emit("pipe",r),t};function Cx(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):Sse(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}var yI={Stream:aS,prependListener:Cx},E9={exports:{}};(function(t){const{AbortError:e,codes:r}=Hs,{isNodeStream:n,isWebStream:s,kControllerErrorFunction:i}=Cl,o=xf,{ERR_INVALID_ARG_TYPE:a}=r,u=(l,c)=>{if(typeof l!="object"||!("aborted"in l))throw new a(c,"AbortSignal",l)};t.exports.addAbortSignal=function(c,d){if(u(c,"signal"),!n(d)&&!s(d))throw new a("stream",["ReadableStream","WritableStream","Stream"],d);return t.exports.addAbortSignalNoValidate(c,d)},t.exports.addAbortSignalNoValidate=function(l,c){if(typeof l!="object"||!("aborted"in l))return c;const d=n(c)?()=>{c.destroy(new e(void 0,{cause:l.reason}))}:()=>{c[i](new e(void 0,{cause:l.reason}))};return l.aborted?d():(l.addEventListener("abort",d),o(c,()=>l.removeEventListener("abort",d))),c}})(E9);var uS=E9.exports;const{StringPrototypeSlice:BN,SymbolIterator:Tse,TypedArrayPrototypeSet:Y_,Uint8Array:Dse}=Gn,{Buffer:Z2}=ha,{inspect:xse}=xl;var Pse=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){const r={data:e,next:null};this.length>0?this.tail.next=r:this.head=r,this.tail=r,++this.length}unshift(e){const r={data:e,next:this.head};this.length===0&&(this.tail=r),this.head=r,++this.length}shift(){if(this.length===0)return;const e=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(this.length===0)return"";let r=this.head,n=""+r.data;for(;(r=r.next)!==null;)n+=e+r.data;return n}concat(e){if(this.length===0)return Z2.alloc(0);const r=Z2.allocUnsafe(e>>>0);let n=this.head,s=0;for(;n;)Y_(r,n.data,s),s+=n.data.length,n=n.next;return r}consume(e,r){const n=this.head.data;if(e<n.length){const s=n.slice(0,e);return this.head.data=n.slice(e),s}return e===n.length?this.shift():r?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[Tse](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let r="",n=this.head,s=0;do{const i=n.data;if(e>i.length)r+=i,e-=i.length;else{e===i.length?(r+=i,++s,n.next?this.head=n.next:this.head=this.tail=null):(r+=BN(i,0,e),this.head=n,n.data=BN(i,e));break}++s}while((n=n.next)!==null);return this.length-=s,r}_getBuffer(e){const r=Z2.allocUnsafe(e),n=e;let s=this.head,i=0;do{const o=s.data;if(e>o.length)Y_(r,o,n-e),e-=o.length;else{e===o.length?(Y_(r,o,n-e),++i,s.next?this.head=s.next:this.head=this.tail=null):(Y_(r,new Dse(o.buffer,o.byteOffset,e),n-e),this.head=s,s.data=o.slice(e));break}++i}while((s=s.next)!==null);return this.length-=i,r}[Symbol.for("nodejs.util.inspect.custom")](e,r){return xse(this,{...r,depth:0,customInspect:!1})}};const{MathFloor:Cse,NumberIsInteger:Ise}=Gn,{ERR_INVALID_ARG_VALUE:kse}=Hs.codes;function $se(t,e,r){return t.highWaterMark!=null?t.highWaterMark:e?t[r]:null}function A9(t){return t?16:16*1024}function Ose(t,e,r,n){const s=$se(e,n,r);if(s!=null){if(!Ise(s)||s<0){const i=n?`options.${r}`:"options.highWaterMark";throw new kse(i,s)}return Cse(s)}return A9(t.objectMode)}var gI={getHighWaterMark:Ose,getDefaultHighWaterMark:A9},S9={},Ix={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(t,e){var r=ha,n=r.Buffer;function s(o,a){for(var u in o)a[u]=o[u]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=r:(s(r,e),e.Buffer=i);function i(o,a,u){return n(o,a,u)}i.prototype=Object.create(n.prototype),s(n,i),i.from=function(o,a,u){if(typeof o=="number")throw new TypeError("Argument must not be a number");return n(o,a,u)},i.alloc=function(o,a,u){if(typeof o!="number")throw new TypeError("Argument must be a number");var l=n(o);return a!==void 0?typeof u=="string"?l.fill(a,u):l.fill(a):l.fill(0),l},i.allocUnsafe=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return n(o)},i.allocUnsafeSlow=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(o)}})(Ix,Ix.exports);var Rse=Ix.exports,vI=Rse.Buffer,FN=vI.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function Nse(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function Bse(t){var e=Nse(t);if(typeof e!="string"&&(vI.isEncoding===FN||!FN(t)))throw new Error("Unknown encoding: "+t);return e||t}S9.StringDecoder=Ow;function Ow(t){this.encoding=Bse(t);var e;switch(this.encoding){case"utf16le":this.text=Kse,this.end=Vse,e=4;break;case"utf8":this.fillLast=jse,e=4;break;case"base64":this.text=qse,this.end=Hse,e=3;break;default:this.write=zse,this.end=Wse;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=vI.allocUnsafe(e)}Ow.prototype.write=function(t){if(t.length===0)return"";var e,r;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""};Ow.prototype.end=Lse;Ow.prototype.text=Use;Ow.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function Q2(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function Fse(t,e,r){var n=e.length-1;if(n<r)return 0;var s=Q2(e[n]);return s>=0?(s>0&&(t.lastNeed=s-1),s):--n<r||s===-2?0:(s=Q2(e[n]),s>=0?(s>0&&(t.lastNeed=s-2),s):--n<r||s===-2?0:(s=Q2(e[n]),s>=0?(s>0&&(s===2?s=0:t.lastNeed=s-3),s):0))}function Mse(t,e,r){if((e[0]&192)!==128)return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return t.lastNeed=2,"�"}}function jse(t){var e=this.lastTotal-this.lastNeed,r=Mse(this,t);if(r!==void 0)return r;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function Use(t,e){var r=Fse(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var n=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)}function Lse(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e}function Kse(t,e){if((t.length-e)%2===0){var r=t.toString("utf16le",e);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function Vse(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function qse(t,e){var r=(t.length-e)%3;return r===0?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function Hse(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function zse(t){return t.toString(this.encoding)}function Wse(t){return t&&t.length?this.write(t):""}const MN=Np,{PromisePrototypeThen:Gse,SymbolAsyncIterator:jN,SymbolIterator:UN}=Gn,{Buffer:Jse}=ha,{ERR_INVALID_ARG_TYPE:Xse,ERR_STREAM_NULL_VALUES:Yse}=Hs.codes;function Zse(t,e,r){let n;if(typeof e=="string"||e instanceof Jse)return new t({objectMode:!0,...r,read(){this.push(e),this.push(null)}});let s;if(e&&e[jN])s=!0,n=e[jN]();else if(e&&e[UN])s=!1,n=e[UN]();else throw new Xse("iterable",["Iterable"],e);const i=new t({objectMode:!0,highWaterMark:1,...r});let o=!1;i._read=function(){o||(o=!0,u())},i._destroy=function(l,c){Gse(a(l),()=>MN.nextTick(c,l),d=>MN.nextTick(c,d||l))};async function a(l){const c=l!=null,d=typeof n.throw=="function";if(c&&d){const{value:h,done:f}=await n.throw(l);if(await h,f)return}if(typeof n.return=="function"){const{value:h}=await n.return();await h}}async function u(){for(;;){try{const{value:l,done:c}=s?await n.next():n.next();if(c)i.push(null);else{const d=l&&typeof l.then=="function"?await l:l;if(d===null)throw o=!1,new Yse;if(i.push(d))continue;o=!1}}catch(l){i.destroy(l)}break}}return i}var T9=Zse,eT,LN;function cS(){if(LN)return eT;LN=1;const t=Np,{ArrayPrototypeIndexOf:e,NumberIsInteger:r,NumberIsNaN:n,NumberParseInt:s,ObjectDefineProperties:i,ObjectKeys:o,ObjectSetPrototypeOf:a,Promise:u,SafeSet:l,SymbolAsyncIterator:c,Symbol:d}=Gn;eT=W,W.ReadableState=re;const{EventEmitter:h}=JA,{Stream:f,prependListener:p}=yI,{Buffer:m}=ha,{addAbortSignal:E}=uS,A=xf;let _=xl.debuglog("stream",G=>{_=G});const g=Pse,v=Hy,{getHighWaterMark:S,getDefaultHighWaterMark:x}=gI,{aggregateTwoErrors:D,codes:{ERR_INVALID_ARG_TYPE:w,ERR_METHOD_NOT_IMPLEMENTED:b,ERR_OUT_OF_RANGE:T,ERR_STREAM_PUSH_AFTER_EOF:P,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:C}}=Hs,{validateObject:k}=tS,K=d("kPaused"),{StringDecoder:L}=S9,q=T9;a(W.prototype,f.prototype),a(W,f);const se=()=>{},{errorOrDestroy:X}=v;function re(G,J,ge){typeof ge!="boolean"&&(ge=J instanceof hl()),this.objectMode=!!(G&&G.objectMode),ge&&(this.objectMode=this.objectMode||!!(G&&G.readableObjectMode)),this.highWaterMark=G?S(this,G,"readableHighWaterMark",ge):x(!1),this.buffer=new g,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[K]=null,this.errorEmitted=!1,this.emitClose=!G||G.emitClose!==!1,this.autoDestroy=!G||G.autoDestroy!==!1,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=G&&G.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,G&&G.encoding&&(this.decoder=new L(G.encoding),this.encoding=G.encoding)}function W(G){if(!(this instanceof W))return new W(G);const J=this instanceof hl();this._readableState=new re(G,this,J),G&&(typeof G.read=="function"&&(this._read=G.read),typeof G.destroy=="function"&&(this._destroy=G.destroy),typeof G.construct=="function"&&(this._construct=G.construct),G.signal&&!J&&E(G.signal,this)),f.call(this,G),v.construct(this,()=>{this._readableState.needReadable&&me(this,this._readableState)})}W.prototype.destroy=v.destroy,W.prototype._undestroy=v.undestroy,W.prototype._destroy=function(G,J){J(G)},W.prototype[h.captureRejectionSymbol]=function(G){this.destroy(G)},W.prototype.push=function(G,J){return B(this,G,J,!1)},W.prototype.unshift=function(G,J){return B(this,G,J,!0)};function B(G,J,ge,be){_("readableAddChunk",J);const ke=G._readableState;let At;if(ke.objectMode||(typeof J=="string"?(ge=ge||ke.defaultEncoding,ke.encoding!==ge&&(be&&ke.encoding?J=m.from(J,ge).toString(ke.encoding):(J=m.from(J,ge),ge=""))):J instanceof m?ge="":f._isUint8Array(J)?(J=f._uint8ArrayToBuffer(J),ge=""):J!=null&&(At=new w("chunk",["string","Buffer","Uint8Array"],J))),At)X(G,At);else if(J===null)ke.reading=!1,ee(G,ke);else if(ke.objectMode||J&&J.length>0)if(be)if(ke.endEmitted)X(G,new C);else{if(ke.destroyed||ke.errored)return!1;te(G,ke,J,!0)}else if(ke.ended)X(G,new P);else{if(ke.destroyed||ke.errored)return!1;ke.reading=!1,ke.decoder&&!ge?(J=ke.decoder.write(J),ke.objectMode||J.length!==0?te(G,ke,J,!1):me(G,ke)):te(G,ke,J,!1)}else be||(ke.reading=!1,me(G,ke));return!ke.ended&&(ke.length<ke.highWaterMark||ke.length===0)}function te(G,J,ge,be){J.flowing&&J.length===0&&!J.sync&&G.listenerCount("data")>0?(J.multiAwaitDrain?J.awaitDrainWriters.clear():J.awaitDrainWriters=null,J.dataEmitted=!0,G.emit("data",ge)):(J.length+=J.objectMode?1:ge.length,be?J.buffer.unshift(ge):J.buffer.push(ge),J.needReadable&&ne(G)),me(G,J)}W.prototype.isPaused=function(){const G=this._readableState;return G[K]===!0||G.flowing===!1},W.prototype.setEncoding=function(G){const J=new L(G);this._readableState.decoder=J,this._readableState.encoding=this._readableState.decoder.encoding;const ge=this._readableState.buffer;let be="";for(const ke of ge)be+=J.write(ke);return ge.clear(),be!==""&&ge.push(be),this._readableState.length=be.length,this};const z=1073741824;function $(G){if(G>z)throw new T("size","<= 1GiB",G);return G--,G|=G>>>1,G|=G>>>2,G|=G>>>4,G|=G>>>8,G|=G>>>16,G++,G}function F(G,J){return G<=0||J.length===0&&J.ended?0:J.objectMode?1:n(G)?J.flowing&&J.length?J.buffer.first().length:J.length:G<=J.length?G:J.ended?J.length:0}W.prototype.read=function(G){_("read",G),G===void 0?G=NaN:r(G)||(G=s(G,10));const J=this._readableState,ge=G;if(G>J.highWaterMark&&(J.highWaterMark=$(G)),G!==0&&(J.emittedReadable=!1),G===0&&J.needReadable&&((J.highWaterMark!==0?J.length>=J.highWaterMark:J.length>0)||J.ended))return _("read: emitReadable",J.length,J.ended),J.length===0&&J.ended?ce(this):ne(this),null;if(G=F(G,J),G===0&&J.ended)return J.length===0&&ce(this),null;let be=J.needReadable;if(_("need readable",be),(J.length===0||J.length-G<J.highWaterMark)&&(be=!0,_("length less than watermark",be)),J.ended||J.reading||J.destroyed||J.errored||!J.constructed)be=!1,_("reading, ended or constructing",be);else if(be){_("do read"),J.reading=!0,J.sync=!0,J.length===0&&(J.needReadable=!0);try{this._read(J.highWaterMark)}catch(At){X(this,At)}J.sync=!1,J.reading||(G=F(ge,J))}let ke;return G>0?ke=Q(G,J):ke=null,ke===null?(J.needReadable=J.length<=J.highWaterMark,G=0):(J.length-=G,J.multiAwaitDrain?J.awaitDrainWriters.clear():J.awaitDrainWriters=null),J.length===0&&(J.ended||(J.needReadable=!0),ge!==G&&J.ended&&ce(this)),ke!==null&&!J.errorEmitted&&!J.closeEmitted&&(J.dataEmitted=!0,this.emit("data",ke)),ke};function ee(G,J){if(_("onEofChunk"),!J.ended){if(J.decoder){const ge=J.decoder.end();ge&&ge.length&&(J.buffer.push(ge),J.length+=J.objectMode?1:ge.length)}J.ended=!0,J.sync?ne(G):(J.needReadable=!1,J.emittedReadable=!0,le(G))}}function ne(G){const J=G._readableState;_("emitReadable",J.needReadable,J.emittedReadable),J.needReadable=!1,J.emittedReadable||(_("emitReadable",J.flowing),J.emittedReadable=!0,t.nextTick(le,G))}function le(G){const J=G._readableState;_("emitReadable_",J.destroyed,J.length,J.ended),!J.destroyed&&!J.errored&&(J.length||J.ended)&&(G.emit("readable"),J.emittedReadable=!1),J.needReadable=!J.flowing&&!J.ended&&J.length<=J.highWaterMark,j(G)}function me(G,J){!J.readingMore&&J.constructed&&(J.readingMore=!0,t.nextTick(ve,G,J))}function ve(G,J){for(;!J.reading&&!J.ended&&(J.length<J.highWaterMark||J.flowing&&J.length===0);){const ge=J.length;if(_("maybeReadMore read 0"),G.read(0),ge===J.length)break}J.readingMore=!1}W.prototype._read=function(G){throw new b("_read()")},W.prototype.pipe=function(G,J){const ge=this,be=this._readableState;be.pipes.length===1&&(be.multiAwaitDrain||(be.multiAwaitDrain=!0,be.awaitDrainWriters=new l(be.awaitDrainWriters?[be.awaitDrainWriters]:[]))),be.pipes.push(G),_("pipe count=%d opts=%j",be.pipes.length,J);const At=(!J||J.end!==!1)&&G!==t.stdout&&G!==t.stderr?$r:Ui;be.endEmitted?t.nextTick(At):ge.once("end",At),G.on("unpipe",kt);function kt(rs,ci){_("onunpipe"),rs===ge&&ci&&ci.hasUnpiped===!1&&(ci.hasUnpiped=!0,zs())}function $r(){_("onend"),G.end()}let Wt,cr=!1;function zs(){_("cleanup"),G.removeListener("close",_s),G.removeListener("finish",Ws),Wt&&G.removeListener("drain",Wt),G.removeListener("error",Wr),G.removeListener("unpipe",kt),ge.removeListener("end",$r),ge.removeListener("end",Ui),ge.removeListener("data",Ct),cr=!0,Wt&&be.awaitDrainWriters&&(!G._writableState||G._writableState.needDrain)&&Wt()}function un(){cr||(be.pipes.length===1&&be.pipes[0]===G?(_("false write response, pause",0),be.awaitDrainWriters=G,be.multiAwaitDrain=!1):be.pipes.length>1&&be.pipes.includes(G)&&(_("false write response, pause",be.awaitDrainWriters.size),be.awaitDrainWriters.add(G)),ge.pause()),Wt||(Wt=Pe(ge,G),G.on("drain",Wt))}ge.on("data",Ct);function Ct(rs){_("ondata");const ci=G.write(rs);_("dest.write",ci),ci===!1&&un()}function Wr(rs){if(_("onerror",rs),Ui(),G.removeListener("error",Wr),G.listenerCount("error")===0){const ci=G._writableState||G._readableState;ci&&!ci.errorEmitted?X(G,rs):G.emit("error",rs)}}p(G,"error",Wr);function _s(){G.removeListener("finish",Ws),Ui()}G.once("close",_s);function Ws(){_("onfinish"),G.removeListener("close",_s),Ui()}G.once("finish",Ws);function Ui(){_("unpipe"),ge.unpipe(G)}return G.emit("pipe",ge),G.writableNeedDrain===!0?be.flowing&&un():be.flowing||(_("pipe resume"),ge.resume()),G};function Pe(G,J){return function(){const be=G._readableState;be.awaitDrainWriters===J?(_("pipeOnDrain",1),be.awaitDrainWriters=null):be.multiAwaitDrain&&(_("pipeOnDrain",be.awaitDrainWriters.size),be.awaitDrainWriters.delete(J)),(!be.awaitDrainWriters||be.awaitDrainWriters.size===0)&&G.listenerCount("data")&&G.resume()}}W.prototype.unpipe=function(G){const J=this._readableState,ge={hasUnpiped:!1};if(J.pipes.length===0)return this;if(!G){const ke=J.pipes;J.pipes=[],this.pause();for(let At=0;At<ke.length;At++)ke[At].emit("unpipe",this,{hasUnpiped:!1});return this}const be=e(J.pipes,G);return be===-1?this:(J.pipes.splice(be,1),J.pipes.length===0&&this.pause(),G.emit("unpipe",this,ge),this)},W.prototype.on=function(G,J){const ge=f.prototype.on.call(this,G,J),be=this._readableState;return G==="data"?(be.readableListening=this.listenerCount("readable")>0,be.flowing!==!1&&this.resume()):G==="readable"&&!be.endEmitted&&!be.readableListening&&(be.readableListening=be.needReadable=!0,be.flowing=!1,be.emittedReadable=!1,_("on readable",be.length,be.reading),be.length?ne(this):be.reading||t.nextTick(M,this)),ge},W.prototype.addListener=W.prototype.on,W.prototype.removeListener=function(G,J){const ge=f.prototype.removeListener.call(this,G,J);return G==="readable"&&t.nextTick(Ue,this),ge},W.prototype.off=W.prototype.removeListener,W.prototype.removeAllListeners=function(G){const J=f.prototype.removeAllListeners.apply(this,arguments);return(G==="readable"||G===void 0)&&t.nextTick(Ue,this),J};function Ue(G){const J=G._readableState;J.readableListening=G.listenerCount("readable")>0,J.resumeScheduled&&J[K]===!1?J.flowing=!0:G.listenerCount("data")>0?G.resume():J.readableListening||(J.flowing=null)}function M(G){_("readable nexttick read 0"),G.read(0)}W.prototype.resume=function(){const G=this._readableState;return G.flowing||(_("resume"),G.flowing=!G.readableListening,V(this,G)),G[K]=!1,this};function V(G,J){J.resumeScheduled||(J.resumeScheduled=!0,t.nextTick(oe,G,J))}function oe(G,J){_("resume",J.reading),J.reading||G.read(0),J.resumeScheduled=!1,G.emit("resume"),j(G),J.flowing&&!J.reading&&G.read(0)}W.prototype.pause=function(){return _("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(_("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[K]=!0,this};function j(G){const J=G._readableState;for(_("flow",J.flowing);J.flowing&&G.read()!==null;);}W.prototype.wrap=function(G){let J=!1;G.on("data",be=>{!this.push(be)&&G.pause&&(J=!0,G.pause())}),G.on("end",()=>{this.push(null)}),G.on("error",be=>{X(this,be)}),G.on("close",()=>{this.destroy()}),G.on("destroy",()=>{this.destroy()}),this._read=()=>{J&&G.resume&&(J=!1,G.resume())};const ge=o(G);for(let be=1;be<ge.length;be++){const ke=ge[be];this[ke]===void 0&&typeof G[ke]=="function"&&(this[ke]=G[ke].bind(G))}return this},W.prototype[c]=function(){return I(this)},W.prototype.iterator=function(G){return G!==void 0&&k(G,"options"),I(this,G)};function I(G,J){typeof G.read!="function"&&(G=W.wrap(G,{objectMode:!0}));const ge=N(G,J);return ge.stream=G,ge}async function*N(G,J){let ge=se;function be(kt){this===G?(ge(),ge=se):ge=kt}G.on("readable",be);let ke;const At=A(G,{writable:!1},kt=>{ke=kt?D(ke,kt):null,ge(),ge=se});try{for(;;){const kt=G.destroyed?null:G.read();if(kt!==null)yield kt;else{if(ke)throw ke;if(ke===null)return;await new u(be)}}}catch(kt){throw ke=D(ke,kt),ke}finally{(ke||(J==null?void 0:J.destroyOnReturn)!==!1)&&(ke===void 0||G._readableState.autoDestroy)?v.destroyer(G,null):(G.off("readable",be),At())}}i(W.prototype,{readable:{__proto__:null,get(){const G=this._readableState;return!!G&&G.readable!==!1&&!G.destroyed&&!G.errorEmitted&&!G.endEmitted},set(G){this._readableState&&(this._readableState.readable=!!G)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(G){this._readableState&&(this._readableState.flowing=G)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(G){this._readableState&&(this._readableState.destroyed=G)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),i(re.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[K]!==!1},set(G){this[K]=!!G}}}),W._fromList=Q;function Q(G,J){if(J.length===0)return null;let ge;return J.objectMode?ge=J.buffer.shift():!G||G>=J.length?(J.decoder?ge=J.buffer.join(""):J.buffer.length===1?ge=J.buffer.first():ge=J.buffer.concat(J.length),J.buffer.clear()):ge=J.buffer.consume(G,J.decoder),ge}function ce(G){const J=G._readableState;_("endReadable",J.endEmitted),J.endEmitted||(J.ended=!0,t.nextTick(pe,J,G))}function pe(G,J){if(_("endReadableNT",G.endEmitted,G.length),!G.errored&&!G.closeEmitted&&!G.endEmitted&&G.length===0){if(G.endEmitted=!0,J.emit("end"),J.writable&&J.allowHalfOpen===!1)t.nextTick(he,J);else if(G.autoDestroy){const ge=J._writableState;(!ge||ge.autoDestroy&&(ge.finished||ge.writable===!1))&&J.destroy()}}}function he(G){G.writable&&!G.writableEnded&&!G.destroyed&&G.end()}W.from=function(G,J){return q(W,G,J)};let Ce;function _e(){return Ce===void 0&&(Ce={}),Ce}return W.fromWeb=function(G,J){return _e().newStreamReadableFromReadableStream(G,J)},W.toWeb=function(G,J){return _e().newReadableStreamFromStreamReadable(G,J)},W.wrap=function(G,J){var ge,be;return new W({objectMode:(ge=(be=G.readableObjectMode)!==null&&be!==void 0?be:G.objectMode)!==null&&ge!==void 0?ge:!0,...J,destroy(ke,At){v.destroyer(G,ke),At(ke)}}).wrap(G)},eT}var tT,KN;function D9(){if(KN)return tT;KN=1;const t=Np,{ArrayPrototypeSlice:e,Error:r,FunctionPrototypeSymbolHasInstance:n,ObjectDefineProperty:s,ObjectDefineProperties:i,ObjectSetPrototypeOf:o,StringPrototypeToLowerCase:a,Symbol:u,SymbolHasInstance:l}=Gn;tT=L,L.WritableState=k;const{EventEmitter:c}=JA,d=yI.Stream,{Buffer:h}=ha,f=Hy,{addAbortSignal:p}=uS,{getHighWaterMark:m,getDefaultHighWaterMark:E}=gI,{ERR_INVALID_ARG_TYPE:A,ERR_METHOD_NOT_IMPLEMENTED:_,ERR_MULTIPLE_CALLBACK:g,ERR_STREAM_CANNOT_PIPE:v,ERR_STREAM_DESTROYED:S,ERR_STREAM_ALREADY_FINISHED:x,ERR_STREAM_NULL_VALUES:D,ERR_STREAM_WRITE_AFTER_END:w,ERR_UNKNOWN_ENCODING:b}=Hs.codes,{errorOrDestroy:T}=f;o(L.prototype,d.prototype),o(L,d);function P(){}const C=u("kOnFinished");function k(M,V,oe){typeof oe!="boolean"&&(oe=V instanceof hl()),this.objectMode=!!(M&&M.objectMode),oe&&(this.objectMode=this.objectMode||!!(M&&M.writableObjectMode)),this.highWaterMark=M?m(this,M,"writableHighWaterMark",oe):E(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const j=!!(M&&M.decodeStrings===!1);this.decodeStrings=!j,this.defaultEncoding=M&&M.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=W.bind(void 0,V),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,K(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!M||M.emitClose!==!1,this.autoDestroy=!M||M.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[C]=[]}function K(M){M.buffered=[],M.bufferedIndex=0,M.allBuffers=!0,M.allNoop=!0}k.prototype.getBuffer=function(){return e(this.buffered,this.bufferedIndex)},s(k.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function L(M){const V=this instanceof hl();if(!V&&!n(L,this))return new L(M);this._writableState=new k(M,this,V),M&&(typeof M.write=="function"&&(this._write=M.write),typeof M.writev=="function"&&(this._writev=M.writev),typeof M.destroy=="function"&&(this._destroy=M.destroy),typeof M.final=="function"&&(this._final=M.final),typeof M.construct=="function"&&(this._construct=M.construct),M.signal&&p(M.signal,this)),d.call(this,M),f.construct(this,()=>{const oe=this._writableState;oe.writing||$(this,oe),le(this,oe)})}s(L,l,{__proto__:null,value:function(M){return n(this,M)?!0:this!==L?!1:M&&M._writableState instanceof k}}),L.prototype.pipe=function(){T(this,new v)};function q(M,V,oe,j){const I=M._writableState;if(typeof oe=="function")j=oe,oe=I.defaultEncoding;else{if(!oe)oe=I.defaultEncoding;else if(oe!=="buffer"&&!h.isEncoding(oe))throw new b(oe);typeof j!="function"&&(j=P)}if(V===null)throw new D;if(!I.objectMode)if(typeof V=="string")I.decodeStrings!==!1&&(V=h.from(V,oe),oe="buffer");else if(V instanceof h)oe="buffer";else if(d._isUint8Array(V))V=d._uint8ArrayToBuffer(V),oe="buffer";else throw new A("chunk",["string","Buffer","Uint8Array"],V);let N;return I.ending?N=new w:I.destroyed&&(N=new S("write")),N?(t.nextTick(j,N),T(M,N,!0),N):(I.pendingcb++,se(M,I,V,oe,j))}L.prototype.write=function(M,V,oe){return q(this,M,V,oe)===!0},L.prototype.cork=function(){this._writableState.corked++},L.prototype.uncork=function(){const M=this._writableState;M.corked&&(M.corked--,M.writing||$(this,M))},L.prototype.setDefaultEncoding=function(V){if(typeof V=="string"&&(V=a(V)),!h.isEncoding(V))throw new b(V);return this._writableState.defaultEncoding=V,this};function se(M,V,oe,j,I){const N=V.objectMode?1:oe.length;V.length+=N;const Q=V.length<V.highWaterMark;return Q||(V.needDrain=!0),V.writing||V.corked||V.errored||!V.constructed?(V.buffered.push({chunk:oe,encoding:j,callback:I}),V.allBuffers&&j!=="buffer"&&(V.allBuffers=!1),V.allNoop&&I!==P&&(V.allNoop=!1)):(V.writelen=N,V.writecb=I,V.writing=!0,V.sync=!0,M._write(oe,j,V.onwrite),V.sync=!1),Q&&!V.errored&&!V.destroyed}function X(M,V,oe,j,I,N,Q){V.writelen=j,V.writecb=Q,V.writing=!0,V.sync=!0,V.destroyed?V.onwrite(new S("write")):oe?M._writev(I,V.onwrite):M._write(I,N,V.onwrite),V.sync=!1}function re(M,V,oe,j){--V.pendingcb,j(oe),z(V),T(M,oe)}function W(M,V){const oe=M._writableState,j=oe.sync,I=oe.writecb;if(typeof I!="function"){T(M,new g);return}oe.writing=!1,oe.writecb=null,oe.length-=oe.writelen,oe.writelen=0,V?(V.stack,oe.errored||(oe.errored=V),M._readableState&&!M._readableState.errored&&(M._readableState.errored=V),j?t.nextTick(re,M,oe,V,I):re(M,oe,V,I)):(oe.buffered.length>oe.bufferedIndex&&$(M,oe),j?oe.afterWriteTickInfo!==null&&oe.afterWriteTickInfo.cb===I?oe.afterWriteTickInfo.count++:(oe.afterWriteTickInfo={count:1,cb:I,stream:M,state:oe},t.nextTick(B,oe.afterWriteTickInfo)):te(M,oe,1,I))}function B({stream:M,state:V,count:oe,cb:j}){return V.afterWriteTickInfo=null,te(M,V,oe,j)}function te(M,V,oe,j){for(!V.ending&&!M.destroyed&&V.length===0&&V.needDrain&&(V.needDrain=!1,M.emit("drain"));oe-- >0;)V.pendingcb--,j();V.destroyed&&z(V),le(M,V)}function z(M){if(M.writing)return;for(let I=M.bufferedIndex;I<M.buffered.length;++I){var V;const{chunk:N,callback:Q}=M.buffered[I],ce=M.objectMode?1:N.length;M.length-=ce,Q((V=M.errored)!==null&&V!==void 0?V:new S("write"))}const oe=M[C].splice(0);for(let I=0;I<oe.length;I++){var j;oe[I]((j=M.errored)!==null&&j!==void 0?j:new S("end"))}K(M)}function $(M,V){if(V.corked||V.bufferProcessing||V.destroyed||!V.constructed)return;const{buffered:oe,bufferedIndex:j,objectMode:I}=V,N=oe.length-j;if(!N)return;let Q=j;if(V.bufferProcessing=!0,N>1&&M._writev){V.pendingcb-=N-1;const ce=V.allNoop?P:he=>{for(let Ce=Q;Ce<oe.length;++Ce)oe[Ce].callback(he)},pe=V.allNoop&&Q===0?oe:e(oe,Q);pe.allBuffers=V.allBuffers,X(M,V,!0,V.length,pe,"",ce),K(V)}else{do{const{chunk:ce,encoding:pe,callback:he}=oe[Q];oe[Q++]=null;const Ce=I?1:ce.length;X(M,V,!1,Ce,ce,pe,he)}while(Q<oe.length&&!V.writing);Q===oe.length?K(V):Q>256?(oe.splice(0,Q),V.bufferedIndex=0):V.bufferedIndex=Q}V.bufferProcessing=!1}L.prototype._write=function(M,V,oe){if(this._writev)this._writev([{chunk:M,encoding:V}],oe);else throw new _("_write()")},L.prototype._writev=null,L.prototype.end=function(M,V,oe){const j=this._writableState;typeof M=="function"?(oe=M,M=null,V=null):typeof V=="function"&&(oe=V,V=null);let I;if(M!=null){const N=q(this,M,V);N instanceof r&&(I=N)}return j.corked&&(j.corked=1,this.uncork()),I||(!j.errored&&!j.ending?(j.ending=!0,le(this,j,!0),j.ended=!0):j.finished?I=new x("end"):j.destroyed&&(I=new S("end"))),typeof oe=="function"&&(I||j.finished?t.nextTick(oe,I):j[C].push(oe)),this};function F(M){return M.ending&&!M.destroyed&&M.constructed&&M.length===0&&!M.errored&&M.buffered.length===0&&!M.finished&&!M.writing&&!M.errorEmitted&&!M.closeEmitted}function ee(M,V){let oe=!1;function j(I){if(oe){T(M,I??g());return}if(oe=!0,V.pendingcb--,I){const N=V[C].splice(0);for(let Q=0;Q<N.length;Q++)N[Q](I);T(M,I,V.sync)}else F(V)&&(V.prefinished=!0,M.emit("prefinish"),V.pendingcb++,t.nextTick(me,M,V))}V.sync=!0,V.pendingcb++;try{M._final(j)}catch(I){j(I)}V.sync=!1}function ne(M,V){!V.prefinished&&!V.finalCalled&&(typeof M._final=="function"&&!V.destroyed?(V.finalCalled=!0,ee(M,V)):(V.prefinished=!0,M.emit("prefinish")))}function le(M,V,oe){F(V)&&(ne(M,V),V.pendingcb===0&&(oe?(V.pendingcb++,t.nextTick((j,I)=>{F(I)?me(j,I):I.pendingcb--},M,V)):F(V)&&(V.pendingcb++,me(M,V))))}function me(M,V){V.pendingcb--,V.finished=!0;const oe=V[C].splice(0);for(let j=0;j<oe.length;j++)oe[j]();if(M.emit("finish"),V.autoDestroy){const j=M._readableState;(!j||j.autoDestroy&&(j.endEmitted||j.readable===!1))&&M.destroy()}}i(L.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(M){this._writableState&&(this._writableState.destroyed=M)}},writable:{__proto__:null,get(){const M=this._writableState;return!!M&&M.writable!==!1&&!M.destroyed&&!M.errored&&!M.ending&&!M.ended},set(M){this._writableState&&(this._writableState.writable=!!M)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const M=this._writableState;return M?!M.destroyed&&!M.ending&&M.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const ve=f.destroy;L.prototype.destroy=function(M,V){const oe=this._writableState;return!oe.destroyed&&(oe.bufferedIndex<oe.buffered.length||oe[C].length)&&t.nextTick(z,oe),ve.call(this,M,V),this},L.prototype._undestroy=f.undestroy,L.prototype._destroy=function(M,V){V(M)},L.prototype[c.captureRejectionSymbol]=function(M){this.destroy(M)};let Pe;function Ue(){return Pe===void 0&&(Pe={}),Pe}return L.fromWeb=function(M,V){return Ue().newStreamWritableFromWritableStream(M,V)},L.toWeb=function(M){return Ue().newWritableStreamFromStreamWritable(M)},tT}var rT,VN;function Qse(){if(VN)return rT;VN=1;const t=Np,e=ha,{isReadable:r,isWritable:n,isIterable:s,isNodeStream:i,isReadableNodeStream:o,isWritableNodeStream:a,isDuplexNodeStream:u}=Cl,l=xf,{AbortError:c,codes:{ERR_INVALID_ARG_TYPE:d,ERR_INVALID_RETURN_VALUE:h}}=Hs,{destroyer:f}=Hy,p=hl(),m=cS(),{createDeferredPromise:E}=xl,A=T9,_=globalThis.Blob||e.Blob,g=typeof _<"u"?function(T){return T instanceof _}:function(T){return!1},v=globalThis.AbortController||lI().AbortController,{FunctionPrototypeCall:S}=Gn;class x extends p{constructor(T){super(T),(T==null?void 0:T.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(T==null?void 0:T.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}rT=function b(T,P){if(u(T))return T;if(o(T))return w({readable:T});if(a(T))return w({writable:T});if(i(T))return w({writable:!1,readable:!1});if(typeof T=="function"){const{value:k,write:K,final:L,destroy:q}=D(T);if(s(k))return A(x,k,{objectMode:!0,write:K,final:L,destroy:q});const se=k==null?void 0:k.then;if(typeof se=="function"){let X;const re=S(se,k,W=>{if(W!=null)throw new h("nully","body",W)},W=>{f(X,W)});return X=new x({objectMode:!0,readable:!1,write:K,final(W){L(async()=>{try{await re,t.nextTick(W,null)}catch(B){t.nextTick(W,B)}})},destroy:q})}throw new h("Iterable, AsyncIterable or AsyncFunction",P,k)}if(g(T))return b(T.arrayBuffer());if(s(T))return A(x,T,{objectMode:!0,writable:!1});if(typeof(T==null?void 0:T.writable)=="object"||typeof(T==null?void 0:T.readable)=="object"){const k=T!=null&&T.readable?o(T==null?void 0:T.readable)?T==null?void 0:T.readable:b(T.readable):void 0,K=T!=null&&T.writable?a(T==null?void 0:T.writable)?T==null?void 0:T.writable:b(T.writable):void 0;return w({readable:k,writable:K})}const C=T==null?void 0:T.then;if(typeof C=="function"){let k;return S(C,T,K=>{K!=null&&k.push(K),k.push(null)},K=>{f(k,K)}),k=new x({objectMode:!0,writable:!1,read(){}})}throw new d(P,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],T)};function D(b){let{promise:T,resolve:P}=E();const C=new v,k=C.signal;return{value:b(async function*(){for(;;){const L=T;T=null;const{chunk:q,done:se,cb:X}=await L;if(t.nextTick(X),se)return;if(k.aborted)throw new c(void 0,{cause:k.reason});({promise:T,resolve:P}=E()),yield q}}(),{signal:k}),write(L,q,se){const X=P;P=null,X({chunk:L,done:!1,cb:se})},final(L){const q=P;P=null,q({done:!0,cb:L})},destroy(L,q){C.abort(),q(L)}}}function w(b){const T=b.readable&&typeof b.readable.read!="function"?m.wrap(b.readable):b.readable,P=b.writable;let C=!!r(T),k=!!n(P),K,L,q,se,X;function re(W){const B=se;se=null,B?B(W):W&&X.destroy(W)}return X=new x({readableObjectMode:!!(T!=null&&T.readableObjectMode),writableObjectMode:!!(P!=null&&P.writableObjectMode),readable:C,writable:k}),k&&(l(P,W=>{k=!1,W&&f(T,W),re(W)}),X._write=function(W,B,te){P.write(W,B)?te():K=te},X._final=function(W){P.end(),L=W},P.on("drain",function(){if(K){const W=K;K=null,W()}}),P.on("finish",function(){if(L){const W=L;L=null,W()}})),C&&(l(T,W=>{C=!1,W&&f(T,W),re(W)}),T.on("readable",function(){if(q){const W=q;q=null,W()}}),T.on("end",function(){X.push(null)}),X._read=function(){for(;;){const W=T.read();if(W===null){q=X._read;return}if(!X.push(W))return}}),X._destroy=function(W,B){!W&&se!==null&&(W=new c),q=null,K=null,L=null,se===null?B(W):(se=B,f(P,W),f(T,W))},X}return rT}var nT,qN;function hl(){if(qN)return nT;qN=1;const{ObjectDefineProperties:t,ObjectGetOwnPropertyDescriptor:e,ObjectKeys:r,ObjectSetPrototypeOf:n}=Gn;nT=o;const s=cS(),i=D9();n(o.prototype,s.prototype),n(o,s);{const c=r(i.prototype);for(let d=0;d<c.length;d++){const h=c[d];o.prototype[h]||(o.prototype[h]=i.prototype[h])}}function o(c){if(!(this instanceof o))return new o(c);s.call(this,c),i.call(this,c),c?(this.allowHalfOpen=c.allowHalfOpen!==!1,c.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),c.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}t(o.prototype,{writable:{__proto__:null,...e(i.prototype,"writable")},writableHighWaterMark:{__proto__:null,...e(i.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...e(i.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...e(i.prototype,"writableBuffer")},writableLength:{__proto__:null,...e(i.prototype,"writableLength")},writableFinished:{__proto__:null,...e(i.prototype,"writableFinished")},writableCorked:{__proto__:null,...e(i.prototype,"writableCorked")},writableEnded:{__proto__:null,...e(i.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...e(i.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(c){this._readableState&&this._writableState&&(this._readableState.destroyed=c,this._writableState.destroyed=c)}}});let a;function u(){return a===void 0&&(a={}),a}o.fromWeb=function(c,d){return u().newStreamDuplexFromReadableWritablePair(c,d)},o.toWeb=function(c){return u().newReadableWritablePairFromDuplex(c)};let l;return o.from=function(c){return l||(l=Qse()),l(c,"body")},nT}const{ObjectSetPrototypeOf:x9,Symbol:eoe}=Gn;var P9=pl;const{ERR_METHOD_NOT_IMPLEMENTED:toe}=Hs.codes,wI=hl(),{getHighWaterMark:roe}=gI;x9(pl.prototype,wI.prototype);x9(pl,wI);const tv=eoe("kCallback");function pl(t){if(!(this instanceof pl))return new pl(t);const e=t?roe(this,t,"readableHighWaterMark",!0):null;e===0&&(t={...t,highWaterMark:null,readableHighWaterMark:e,writableHighWaterMark:t.writableHighWaterMark||0}),wI.call(this,t),this._readableState.sync=!1,this[tv]=null,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",noe)}function kx(t){typeof this._flush=="function"&&!this.destroyed?this._flush((e,r)=>{if(e){t?t(e):this.destroy(e);return}r!=null&&this.push(r),this.push(null),t&&t()}):(this.push(null),t&&t())}function noe(){this._final!==kx&&kx.call(this)}pl.prototype._final=kx;pl.prototype._transform=function(t,e,r){throw new toe("_transform()")};pl.prototype._write=function(t,e,r){const n=this._readableState,s=this._writableState,i=n.length;this._transform(t,e,(o,a)=>{if(o){r(o);return}a!=null&&this.push(a),s.ended||i===n.length||n.length<n.highWaterMark?r():this[tv]=r})};pl.prototype._read=function(){if(this[tv]){const t=this[tv];this[tv]=null,t()}};const{ObjectSetPrototypeOf:C9}=Gn;var I9=py;const _I=P9;C9(py.prototype,_I.prototype);C9(py,_I);function py(t){if(!(this instanceof py))return new py(t);_I.call(this,t)}py.prototype._transform=function(t,e,r){r(null,t)};const A0=Np,{ArrayIsArray:ioe,Promise:soe,SymbolAsyncIterator:ooe}=Gn,TE=xf,{once:aoe}=xl,uoe=Hy,HN=hl(),{aggregateTwoErrors:coe,codes:{ERR_INVALID_ARG_TYPE:$x,ERR_INVALID_RETURN_VALUE:iT,ERR_MISSING_ARGS:loe,ERR_STREAM_DESTROYED:doe,ERR_STREAM_PREMATURE_CLOSE:foe},AbortError:hoe}=Hs,{validateFunction:poe,validateAbortSignal:moe}=tS,{isIterable:mh,isReadable:sT,isReadableNodeStream:d1,isNodeStream:zN,isTransformStream:_m,isWebStream:yoe,isReadableStream:oT,isReadableEnded:goe}=Cl,voe=globalThis.AbortController||lI().AbortController;let aT,uT;function WN(t,e,r){let n=!1;t.on("close",()=>{n=!0});const s=TE(t,{readable:e,writable:r},i=>{n=!i});return{destroy:i=>{n||(n=!0,uoe.destroyer(t,i||new doe("pipe")))},cleanup:s}}function woe(t){return poe(t[t.length-1],"streams[stream.length - 1]"),t.pop()}function cT(t){if(mh(t))return t;if(d1(t))return _oe(t);throw new $x("val",["Readable","Iterable","AsyncIterable"],t)}async function*_oe(t){uT||(uT=cS()),yield*uT.prototype[ooe].call(t)}async function Z_(t,e,r,{end:n}){let s,i=null;const o=l=>{if(l&&(s=l),i){const c=i;i=null,c()}},a=()=>new soe((l,c)=>{s?c(s):i=()=>{s?c(s):l()}});e.on("drain",o);const u=TE(e,{readable:!1},o);try{e.writableNeedDrain&&await a();for await(const l of t)e.write(l)||await a();n&&e.end(),await a(),r()}catch(l){r(s!==l?coe(s,l):l)}finally{u(),e.off("drain",o)}}async function lT(t,e,r,{end:n}){_m(e)&&(e=e.writable);const s=e.getWriter();try{for await(const i of t)await s.ready,s.write(i).catch(()=>{});await s.ready,n&&await s.close(),r()}catch(i){try{await s.abort(i),r(i)}catch(o){r(o)}}}function boe(...t){return k9(t,aoe(woe(t)))}function k9(t,e,r){if(t.length===1&&ioe(t[0])&&(t=t[0]),t.length<2)throw new loe("streams");const n=new voe,s=n.signal,i=r==null?void 0:r.signal,o=[];moe(i,"options.signal");function a(){f(new hoe)}i==null||i.addEventListener("abort",a);let u,l;const c=[];let d=0;function h(A){f(A,--d===0)}function f(A,_){if(A&&(!u||u.code==="ERR_STREAM_PREMATURE_CLOSE")&&(u=A),!(!u&&!_)){for(;c.length;)c.shift()(u);i==null||i.removeEventListener("abort",a),n.abort(),_&&(u||o.forEach(g=>g()),A0.nextTick(e,u,l))}}let p;for(let A=0;A<t.length;A++){const _=t[A],g=A<t.length-1,v=A>0,S=g||(r==null?void 0:r.end)!==!1,x=A===t.length-1;if(zN(_)){let D=function(w){w&&w.name!=="AbortError"&&w.code!=="ERR_STREAM_PREMATURE_CLOSE"&&h(w)};if(S){const{destroy:w,cleanup:b}=WN(_,g,v);c.push(w),sT(_)&&x&&o.push(b)}_.on("error",D),sT(_)&&x&&o.push(()=>{_.removeListener("error",D)})}if(A===0)if(typeof _=="function"){if(p=_({signal:s}),!mh(p))throw new iT("Iterable, AsyncIterable or Stream","source",p)}else mh(_)||d1(_)||_m(_)?p=_:p=HN.from(_);else if(typeof _=="function"){if(_m(p)){var m;p=cT((m=p)===null||m===void 0?void 0:m.readable)}else p=cT(p);if(p=_(p,{signal:s}),g){if(!mh(p,!0))throw new iT("AsyncIterable",`transform[${A-1}]`,p)}else{var E;aT||(aT=I9);const D=new aT({objectMode:!0}),w=(E=p)===null||E===void 0?void 0:E.then;if(typeof w=="function")d++,w.call(p,P=>{l=P,P!=null&&D.write(P),S&&D.end(),A0.nextTick(h)},P=>{D.destroy(P),A0.nextTick(h,P)});else if(mh(p,!0))d++,Z_(p,D,h,{end:S});else if(oT(p)||_m(p)){const P=p.readable||p;d++,Z_(P,D,h,{end:S})}else throw new iT("AsyncIterable or Promise","destination",p);p=D;const{destroy:b,cleanup:T}=WN(p,!1,!0);c.push(b),x&&o.push(T)}}else if(zN(_)){if(d1(p)){d+=2;const D=Eoe(p,_,h,{end:S});sT(_)&&x&&o.push(D)}else if(_m(p)||oT(p)){const D=p.readable||p;d++,Z_(D,_,h,{end:S})}else if(mh(p))d++,Z_(p,_,h,{end:S});else throw new $x("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],p);p=_}else if(yoe(_)){if(d1(p))d++,lT(cT(p),_,h,{end:S});else if(oT(p)||mh(p))d++,lT(p,_,h,{end:S});else if(_m(p))d++,lT(p.readable,_,h,{end:S});else throw new $x("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],p);p=_}else p=HN.from(_)}return(s!=null&&s.aborted||i!=null&&i.aborted)&&A0.nextTick(a),p}function Eoe(t,e,r,{end:n}){let s=!1;if(e.on("close",()=>{s||r(new foe)}),t.pipe(e,{end:!1}),n){let i=function(){s=!0,e.end()};goe(t)?A0.nextTick(i):t.once("end",i)}else r();return TE(t,{readable:!0,writable:!1},i=>{const o=t._readableState;i&&i.code==="ERR_STREAM_PREMATURE_CLOSE"&&o&&o.ended&&!o.errored&&!o.errorEmitted?t.once("end",r).once("error",r):r(i)}),TE(e,{readable:!1,writable:!0},r)}var bI={pipelineImpl:k9,pipeline:boe};const{pipeline:Aoe}=bI,Q_=hl(),{destroyer:Soe}=Hy,{isNodeStream:eb,isReadable:GN,isWritable:JN,isWebStream:dT,isTransformStream:Zf,isWritableStream:XN,isReadableStream:YN}=Cl,{AbortError:Toe,codes:{ERR_INVALID_ARG_VALUE:ZN,ERR_MISSING_ARGS:Doe}}=Hs,xoe=xf;var $9=function(...e){if(e.length===0)throw new Doe("streams");if(e.length===1)return Q_.from(e[0]);const r=[...e];if(typeof e[0]=="function"&&(e[0]=Q_.from(e[0])),typeof e[e.length-1]=="function"){const f=e.length-1;e[f]=Q_.from(e[f])}for(let f=0;f<e.length;++f)if(!(!eb(e[f])&&!dT(e[f]))){if(f<e.length-1&&!(GN(e[f])||YN(e[f])||Zf(e[f])))throw new ZN(`streams[${f}]`,r[f],"must be readable");if(f>0&&!(JN(e[f])||XN(e[f])||Zf(e[f])))throw new ZN(`streams[${f}]`,r[f],"must be writable")}let n,s,i,o,a;function u(f){const p=o;o=null,p?p(f):f?a.destroy(f):!h&&!d&&a.destroy()}const l=e[0],c=Aoe(e,u),d=!!(JN(l)||XN(l)||Zf(l)),h=!!(GN(c)||YN(c)||Zf(c));if(a=new Q_({writableObjectMode:!!(l!=null&&l.writableObjectMode),readableObjectMode:!!(c!=null&&c.writableObjectMode),writable:d,readable:h}),d){if(eb(l))a._write=function(p,m,E){l.write(p,m)?E():n=E},a._final=function(p){l.end(),s=p},l.on("drain",function(){if(n){const p=n;n=null,p()}});else if(dT(l)){const m=(Zf(l)?l.writable:l).getWriter();a._write=async function(E,A,_){try{await m.ready,m.write(E).catch(()=>{}),_()}catch(g){_(g)}},a._final=async function(E){try{await m.ready,m.close().catch(()=>{}),s=E}catch(A){E(A)}}}const f=Zf(c)?c.readable:c;xoe(f,()=>{if(s){const p=s;s=null,p()}})}if(h){if(eb(c))c.on("readable",function(){if(i){const f=i;i=null,f()}}),c.on("end",function(){a.push(null)}),a._read=function(){for(;;){const f=c.read();if(f===null){i=a._read;return}if(!a.push(f))return}};else if(dT(c)){const p=(Zf(c)?c.readable:c).getReader();a._read=async function(){for(;;)try{const{value:m,done:E}=await p.read();if(!a.push(m))return;if(E){a.push(null);return}}catch{return}}}}return a._destroy=function(f,p){!f&&o!==null&&(f=new Toe),i=null,n=null,s=null,o===null?p(f):(o=p,eb(c)&&Soe(c,f))},a};const O9=globalThis.AbortController||lI().AbortController,{codes:{ERR_INVALID_ARG_VALUE:Poe,ERR_INVALID_ARG_TYPE:Rw,ERR_MISSING_ARGS:Coe,ERR_OUT_OF_RANGE:Ioe},AbortError:Wu}=Hs,{validateAbortSignal:Bp,validateInteger:koe,validateObject:Fp}=tS,$oe=Gn.Symbol("kWeak"),{finished:Ooe}=xf,Roe=$9,{addAbortSignalNoValidate:Noe}=uS,{isWritable:Boe,isNodeStream:Foe}=Cl,{ArrayPrototypePush:Moe,MathFloor:joe,Number:Uoe,NumberIsNaN:Loe,Promise:QN,PromiseReject:eB,PromisePrototypeThen:Koe,Symbol:R9}=Gn,DE=R9("kEmpty"),tB=R9("kEof");function Voe(t,e){if(e!=null&&Fp(e,"options"),(e==null?void 0:e.signal)!=null&&Bp(e.signal,"options.signal"),Foe(t)&&!Boe(t))throw new Poe("stream",t,"must be writable");const r=Roe(this,t);return e!=null&&e.signal&&Noe(e.signal,r),r}function lS(t,e){if(typeof t!="function")throw new Rw("fn",["Function","AsyncFunction"],t);e!=null&&Fp(e,"options"),(e==null?void 0:e.signal)!=null&&Bp(e.signal,"options.signal");let r=1;return(e==null?void 0:e.concurrency)!=null&&(r=joe(e.concurrency)),koe(r,"concurrency",1),(async function*(){var s,i;const o=new O9,a=this,u=[],l=o.signal,c={signal:l},d=()=>o.abort();e!=null&&(s=e.signal)!==null&&s!==void 0&&s.aborted&&d(),e==null||(i=e.signal)===null||i===void 0||i.addEventListener("abort",d);let h,f,p=!1;function m(){p=!0}async function E(){try{for await(let g of a){var A;if(p)return;if(l.aborted)throw new Wu;try{g=t(g,c)}catch(v){g=eB(v)}g!==DE&&(typeof((A=g)===null||A===void 0?void 0:A.catch)=="function"&&g.catch(m),u.push(g),h&&(h(),h=null),!p&&u.length&&u.length>=r&&await new QN(v=>{f=v}))}u.push(tB)}catch(g){const v=eB(g);Koe(v,void 0,m),u.push(v)}finally{var _;p=!0,h&&(h(),h=null),e==null||(_=e.signal)===null||_===void 0||_.removeEventListener("abort",d)}}E();try{for(;;){for(;u.length>0;){const A=await u[0];if(A===tB)return;if(l.aborted)throw new Wu;A!==DE&&(yield A),u.shift(),f&&(f(),f=null)}await new QN(A=>{h=A})}}finally{o.abort(),p=!0,f&&(f(),f=null)}}).call(this)}function qoe(t=void 0){return t!=null&&Fp(t,"options"),(t==null?void 0:t.signal)!=null&&Bp(t.signal,"options.signal"),(async function*(){let r=0;for await(const s of this){var n;if(t!=null&&(n=t.signal)!==null&&n!==void 0&&n.aborted)throw new Wu({cause:t.signal.reason});yield[r++,s]}}).call(this)}async function N9(t,e=void 0){for await(const r of EI.call(this,t,e))return!0;return!1}async function Hoe(t,e=void 0){if(typeof t!="function")throw new Rw("fn",["Function","AsyncFunction"],t);return!await N9.call(this,async(...r)=>!await t(...r),e)}async function zoe(t,e){for await(const r of EI.call(this,t,e))return r}async function Woe(t,e){if(typeof t!="function")throw new Rw("fn",["Function","AsyncFunction"],t);async function r(n,s){return await t(n,s),DE}for await(const n of lS.call(this,r,e));}function EI(t,e){if(typeof t!="function")throw new Rw("fn",["Function","AsyncFunction"],t);async function r(n,s){return await t(n,s)?n:DE}return lS.call(this,r,e)}class Goe extends Coe{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function Joe(t,e,r){var n;if(typeof t!="function")throw new Rw("reducer",["Function","AsyncFunction"],t);r!=null&&Fp(r,"options"),(r==null?void 0:r.signal)!=null&&Bp(r.signal,"options.signal");let s=arguments.length>1;if(r!=null&&(n=r.signal)!==null&&n!==void 0&&n.aborted){const l=new Wu(void 0,{cause:r.signal.reason});throw this.once("error",()=>{}),await Ooe(this.destroy(l)),l}const i=new O9,o=i.signal;if(r!=null&&r.signal){const l={once:!0,[$oe]:this};r.signal.addEventListener("abort",()=>i.abort(),l)}let a=!1;try{for await(const l of this){var u;if(a=!0,r!=null&&(u=r.signal)!==null&&u!==void 0&&u.aborted)throw new Wu;s?e=await t(e,l,{signal:o}):(e=l,s=!0)}if(!a&&!s)throw new Goe}finally{i.abort()}return e}async function Xoe(t){t!=null&&Fp(t,"options"),(t==null?void 0:t.signal)!=null&&Bp(t.signal,"options.signal");const e=[];for await(const n of this){var r;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted)throw new Wu(void 0,{cause:t.signal.reason});Moe(e,n)}return e}function Yoe(t,e){const r=lS.call(this,t,e);return(async function*(){for await(const s of r)yield*s}).call(this)}function B9(t){if(t=Uoe(t),Loe(t))return 0;if(t<0)throw new Ioe("number",">= 0",t);return t}function Zoe(t,e=void 0){return e!=null&&Fp(e,"options"),(e==null?void 0:e.signal)!=null&&Bp(e.signal,"options.signal"),t=B9(t),(async function*(){var n;if(e!=null&&(n=e.signal)!==null&&n!==void 0&&n.aborted)throw new Wu;for await(const i of this){var s;if(e!=null&&(s=e.signal)!==null&&s!==void 0&&s.aborted)throw new Wu;t--<=0&&(yield i)}}).call(this)}function Qoe(t,e=void 0){return e!=null&&Fp(e,"options"),(e==null?void 0:e.signal)!=null&&Bp(e.signal,"options.signal"),t=B9(t),(async function*(){var n;if(e!=null&&(n=e.signal)!==null&&n!==void 0&&n.aborted)throw new Wu;for await(const i of this){var s;if(e!=null&&(s=e.signal)!==null&&s!==void 0&&s.aborted)throw new Wu;if(t-- >0)yield i;else return}}).call(this)}cI.streamReturningOperators={asIndexedPairs:qoe,drop:Zoe,filter:EI,flatMap:Yoe,map:lS,take:Qoe,compose:Voe};cI.promiseReturningOperators={every:Hoe,forEach:Woe,reduce:Joe,toArray:Xoe,some:N9,find:zoe};var fT,rB;function F9(){if(rB)return fT;rB=1;const{ArrayPrototypePop:t,Promise:e}=Gn,{isIterable:r,isNodeStream:n,isWebStream:s}=Cl,{pipelineImpl:i}=bI,{finished:o}=xf;M9();function a(...u){return new e((l,c)=>{let d,h;const f=u[u.length-1];if(f&&typeof f=="object"&&!n(f)&&!r(f)&&!s(f)){const p=t(u);d=p.signal,h=p.end}i(u,(p,m)=>{p?c(p):l(m)},{signal:d,end:h})})}return fT={finished:o,pipeline:a},fT}var nB;function M9(){if(nB)return J2.exports;nB=1;const{Buffer:t}=ha,{ObjectDefineProperty:e,ObjectKeys:r,ReflectApply:n}=Gn,{promisify:{custom:s}}=xl,{streamReturningOperators:i,promiseReturningOperators:o}=cI,{codes:{ERR_ILLEGAL_CONSTRUCTOR:a}}=Hs,u=$9,{pipeline:l}=bI,{destroyer:c}=Hy,d=xf,h=F9(),f=Cl,p=J2.exports=yI.Stream;p.isDisturbed=f.isDisturbed,p.isErrored=f.isErrored,p.isReadable=f.isReadable,p.Readable=cS();for(const E of r(i)){let _=function(...g){if(new.target)throw a();return p.Readable.from(n(A,this,g))};const A=i[E];e(_,"name",{__proto__:null,value:A.name}),e(_,"length",{__proto__:null,value:A.length}),e(p.Readable.prototype,E,{__proto__:null,value:_,enumerable:!1,configurable:!0,writable:!0})}for(const E of r(o)){let _=function(...g){if(new.target)throw a();return n(A,this,g)};const A=o[E];e(_,"name",{__proto__:null,value:A.name}),e(_,"length",{__proto__:null,value:A.length}),e(p.Readable.prototype,E,{__proto__:null,value:_,enumerable:!1,configurable:!0,writable:!0})}p.Writable=D9(),p.Duplex=hl(),p.Transform=P9,p.PassThrough=I9,p.pipeline=l;const{addAbortSignal:m}=uS;return p.addAbortSignal=m,p.finished=d,p.destroy=c,p.compose=u,e(p,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return h}}),e(l,s,{__proto__:null,enumerable:!0,get(){return h.pipeline}}),e(d,s,{__proto__:null,enumerable:!0,get(){return h.finished}}),p.Stream=p,p._isUint8Array=function(A){return A instanceof Uint8Array},p._uint8ArrayToBuffer=function(A){return t.from(A.buffer,A.byteOffset,A.byteLength)},J2.exports}(function(t){const e=M9(),r=F9(),n=e.Readable.destroy;t.exports=e.Readable,t.exports._uint8ArrayToBuffer=e._uint8ArrayToBuffer,t.exports._isUint8Array=e._isUint8Array,t.exports.isDisturbed=e.isDisturbed,t.exports.isErrored=e.isErrored,t.exports.isReadable=e.isReadable,t.exports.Readable=e.Readable,t.exports.Writable=e.Writable,t.exports.Duplex=e.Duplex,t.exports.Transform=e.Transform,t.exports.PassThrough=e.PassThrough,t.exports.addAbortSignal=e.addAbortSignal,t.exports.finished=e.finished,t.exports.destroy=e.destroy,t.exports.destroy=n,t.exports.pipeline=e.pipeline,t.exports.compose=e.compose,Object.defineProperty(e,"promises",{configurable:!0,enumerable:!0,get(){return r}}),t.exports.Stream=e.Stream,t.exports.default=t.exports})(Rne);function eae(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,u=t.charAt(0),l=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var m=0,E=0,A=0,_=p.length;A!==_&&p[A]===0;)A++,m++;for(var g=(_-A)*c+1>>>0,v=new Uint8Array(g);A!==_;){for(var S=p[A],x=0,D=g-1;(S!==0||x<E)&&D!==-1;D--,x++)S+=256*v[D]>>>0,v[D]=S%a>>>0,S=S/a>>>0;if(S!==0)throw new Error("Non-zero carry");E=x,A++}for(var w=g-E;w!==g&&v[w]===0;)w++;for(var b=u.repeat(m);w<g;++w)b+=t.charAt(v[w]);return b}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var m=0;if(p[m]!==" "){for(var E=0,A=0;p[m]===u;)E++,m++;for(var _=(p.length-m)*l+1>>>0,g=new Uint8Array(_);p[m];){var v=r[p.charCodeAt(m)];if(v===255)return;for(var S=0,x=_-1;(v!==0||S<A)&&x!==-1;x--,S++)v+=a*g[x]>>>0,g[x]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");A=S,m++}if(p[m]!==" "){for(var D=_-A;D!==_&&g[D]===0;)D++;for(var w=new Uint8Array(E+(_-D)),b=E;D!==_;)w[b++]=g[D++];return w}}}function f(p){var m=h(p);if(m)return m;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var tae=eae,rae=tae;const nae=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};let iae=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},sae=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return j9(this,e)}},oae=class{constructor(e){this.decoders=e}or(e){return j9(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const j9=(t,e)=>new oae({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let aae=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new iae(e,r,n),this.decoder=new sae(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const U9=({name:t,prefix:e,encode:r,decode:n})=>new aae(t,e,r,n),L9=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:s}=rae(r,e);return U9({prefix:t,name:e,encode:n,decode:i=>nae(s(i))})},uae=(t,e,r,n)=>{const s={};for(let c=0;c<e.length;++c)s[e[c]]=c;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,u=0,l=0;for(let c=0;c<i;++c){const d=s[t[c]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);u=u<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&u>>a)}if(a>=r||255&u<<8-a)throw new SyntaxError("Unexpected end of data");return o},cae=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let u=0;u<t.length;++u)for(a=a<<8|t[u],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},go=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>U9({prefix:e,name:t,encode(s){return cae(s,n,r)},decode(s){return uae(s,n,r,t)}});go({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});go({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});go({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});go({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});go({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});go({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});go({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});go({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});const iB=go({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),tb=L9({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});L9({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});go({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});go({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const wc=go({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});go({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function lae(t){return t.byteOffset!==0||t.byteLength!==t.buffer.byteLength}function dae(t){return typeof t!="object"||t===null?!1:typeof t[Symbol.asyncIterator]=="function"}function sB(t){const r=Object.prototype.toString.call(t).match(/\s([a-zA-Z0-9]+)/),[n,s]=r;return s}var kg=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},oB=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(o){return new Promise(function(a,u){o=t[i](o),s(a,u,o.done,o.value)})}}function s(i,o,a,u){Promise.resolve(u).then(function(l){i({value:l,done:a})},o)}};const rb=new TextEncoder,Qf=new TextDecoder;let mr=class As{constructor(e,r){this.data=e,this.format=r}static arrayBuffer(e){return new As(e,"ArrayBuffer")}static asyncIterable(e){if(!dae(e))throw new TypeError("Input must be of type AsyncIterable.");return new As(e,"AsyncIterable")}static base32Z(e){return new As(e,"Base32Z")}static base58Btc(e){return new As(e,"Base58Btc")}static base64Url(e){return new As(e,"Base64Url")}static bufferSource(e){return new As(e,"BufferSource")}static hex(e){if(typeof e!="string")throw new TypeError("Hex input must be a string.");if(e.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new As(e,"Hex")}static multibase(e){return new As(e,"Multibase")}static object(e){return new As(e,"Object")}static string(e){return new As(e,"String")}static uint8Array(e){return new As(e,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return tb.baseDecode(this.data).buffer;case"Base64Url":return wc.baseDecode(this.data).buffer;case"BufferSource":{if(sB(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return lae(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return kg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return iB.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return tb.baseEncode(e)}case"Multibase":return this.data.substring(1);case"Uint8Array":return tb.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return wc.baseEncode(e)}case"BufferSource":{const e=this.toUint8Array();return wc.baseEncode(e)}case"Object":{const e=JSON.stringify(this.data),r=rb.encode(e);return wc.baseEncode(r)}case"String":{const e=rb.encode(this.data);return wc.baseEncode(e)}case"Uint8Array":return wc.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){var e,r,n,s;return kg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const u=[];try{for(var i=!0,o=oB(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const c=s;u.push(c)}}catch(c){r={error:c}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return new Blob(u)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){const e=Array.from({length:256},(r,n)=>n.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{const r=this.toUint8Array();return As.uint8Array(r).toHex()}case"Base64Url":{const r=this.toUint8Array();return As.uint8Array(r).toHex()}case"Uint8Array":{let r="";for(let n=0;n<this.data.length;n++)r+=e[this.data[n]];return r}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{const e=wc.baseDecode(this.data),r=Qf.decode(e);return JSON.parse(r)}case"String":return JSON.parse(this.data);case"Uint8Array":{const e=Qf.decode(this.data);return JSON.parse(e)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return kg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toStringAsync();return JSON.parse(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return Qf.decode(this.data);case"Base64Url":{const e=wc.baseDecode(this.data);return Qf.decode(e)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return Qf.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){var e,r,n,s;return kg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let u="";try{for(var i=!0,o=oB(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const l=s;typeof l=="string"?u+=l:u+=Qf.decode(l,{stream:!0})}}catch(l){r={error:l}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return u+=Qf.decode(void 0,{stream:!1}),u}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return iB.baseDecode(this.data);case"Base58Btc":return tb.baseDecode(this.data);case"Base64Url":return wc.baseDecode(this.data);case"BufferSource":{const e=sB(this.data);if(e==="Uint8Array")return this.data;if(e==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{const e=new Uint8Array(this.data.length/2);for(let r=0;r<this.data.length;r+=2){const n=parseInt(this.data.substring(r,r+2),16);if(isNaN(n))throw new TypeError("Input is not a valid hexadecimal string.");e[r/2]=n}return e}case"Object":{const e=JSON.stringify(this.data);return rb.encode(e)}case"String":return rb.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return kg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toArrayBufferAsync();return new Uint8Array(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}};var fae=K9,aB=128,hae=127,pae=~hae,mae=Math.pow(2,31);function K9(t,e,r){e=e||[],r=r||0;for(var n=r;t>=mae;)e[r++]=t&255|aB,t/=128;for(;t&pae;)e[r++]=t&255|aB,t>>>=7;return e[r]=t|0,K9.bytes=r-n+1,e}var yae=Ox,gae=128,uB=127;function Ox(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw Ox.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&uB)<<s:(o&uB)*Math.pow(2,s),s+=7}while(o>=gae);return Ox.bytes=i-n,r}var vae=Math.pow(2,7),wae=Math.pow(2,14),_ae=Math.pow(2,21),bae=Math.pow(2,28),Eae=Math.pow(2,35),Aae=Math.pow(2,42),Sae=Math.pow(2,49),Tae=Math.pow(2,56),Dae=Math.pow(2,63),xae=function(t){return t<vae?1:t<wae?2:t<_ae?3:t<bae?4:t<Eae?5:t<Aae?6:t<Sae?7:t<Tae?8:t<Dae?9:10},Pae={encode:fae,decode:yae,encodingLength:xae},xE=Pae;const cB=(t,e=0)=>[xE.decode(t,e),xE.decode.bytes],Cae=(t,e,r=0)=>(xE.encode(t,e,r),e),Iae=t=>xE.encodingLength(t);let Pf=class pd{static addPrefix(e){var r;let{code:n,data:s,name:i}=e;if(!(i?!n:n))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(n=pd.codeToName.has(n)?n:pd.nameToCode.get(i),n===void 0)throw new Error(`Unsupported multicodec: ${(r=e.name)!==null&&r!==void 0?r:e.code}`);const o=Iae(n),a=new Uint8Array(o+s.byteLength);return a.set(s,o),Cae(n,a),a}static getCodeFromData(e){const{prefixedData:r}=e,[n,s]=cB(r);return n}static getCodeFromName(e){const{name:r}=e,n=pd.nameToCode.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static getNameFromCode(e){const{code:r}=e,n=pd.codeToName.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static registerCodec(e){pd.codeToName.set(e.code,e.name),pd.nameToCode.set(e.name,e.code)}static removePrefix(e){const{prefixedData:r}=e,[n,s]=cB(r),i=pd.codeToName.get(n);if(i===void 0)throw new Error(`Unsupported multicodec: ${n}`);return{code:n,data:r.slice(s),name:i}}};Pf.codeToName=new Map;Pf.nameToCode=new Map;Pf.registerCodec({code:237,name:"ed25519-pub"});Pf.registerCodec({code:4864,name:"ed25519-priv"});Pf.registerCodec({code:236,name:"x25519-pub"});Pf.registerCodec({code:4866,name:"x25519-priv"});Pf.registerCodec({code:231,name:"secp256k1-pub"});Pf.registerCodec({code:4865,name:"secp256k1-priv"});function V9(t){Object.keys(t).forEach(e=>{t[e]===void 0?delete t[e]:typeof t[e]=="object"&&V9(t[e])})}var eh=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let kae=class{constructor(){this.store=new Map}clear(){return eh(this,void 0,void 0,function*(){this.store.clear()})}close(){return eh(this,void 0,void 0,function*(){})}delete(e){return eh(this,void 0,void 0,function*(){return this.store.delete(e)})}get(e){return eh(this,void 0,void 0,function*(){return this.store.get(e)})}has(e){return eh(this,void 0,void 0,function*(){return this.store.has(e)})}list(){return eh(this,void 0,void 0,function*(){return Array.from(this.store.values())})}set(e,r){return eh(this,void 0,void 0,function*(){this.store.set(e,r)})}};function $ae(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function q9(t,...e){if(!$ae(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function lB(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Oae(t,e){q9(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const hT=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const pT=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),eu=(t,e)=>t<<32-e|t>>>e;new Uint8Array(new Uint32Array([287454020]).buffer)[0];function Rae(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function H9(t){return typeof t=="string"&&(t=Rae(t)),q9(t),t}let Nae=class{clone(){return this._cloneInto()}};function Bae(t){const e=n=>t().update(H9(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Fae(t=32){if(hT&&typeof hT.getRandomValues=="function")return hT.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function Mae(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),u=n?4:0,l=n?0:4;t.setUint32(e+u,o,n),t.setUint32(e+l,a,n)}const jae=(t,e,r)=>t&e^~t&r,Uae=(t,e,r)=>t&e^t&r^e&r;let Lae=class extends Nae{constructor(e,r,n,s){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=pT(this.buffer)}update(e){lB(this);const{view:r,buffer:n,blockLen:s}=this;e=H9(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const u=pT(e);for(;s<=i-o;o+=s)this.process(u,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){lB(this),Oae(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)r[d]=0;Mae(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=pT(e),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=u/4,c=this.get();if(l>c.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,c[d],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%r&&e.buffer.set(n),e}};const Kae=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ql=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Hl=new Uint32Array(64);let Vae=class extends Lae{constructor(){super(64,32,8,!1),this.A=ql[0]|0,this.B=ql[1]|0,this.C=ql[2]|0,this.D=ql[3]|0,this.E=ql[4]|0,this.F=ql[5]|0,this.G=ql[6]|0,this.H=ql[7]|0}get(){const{A:e,B:r,C:n,D:s,E:i,F:o,G:a,H:u}=this;return[e,r,n,s,i,o,a,u]}set(e,r,n,s,i,o,a,u){this.A=e|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=u|0}process(e,r){for(let d=0;d<16;d++,r+=4)Hl[d]=e.getUint32(r,!1);for(let d=16;d<64;d++){const h=Hl[d-15],f=Hl[d-2],p=eu(h,7)^eu(h,18)^h>>>3,m=eu(f,17)^eu(f,19)^f>>>10;Hl[d]=m+Hl[d-7]+p+Hl[d-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:u,G:l,H:c}=this;for(let d=0;d<64;d++){const h=eu(a,6)^eu(a,11)^eu(a,25),f=c+h+jae(a,u,l)+Kae[d]+Hl[d]|0,m=(eu(n,2)^eu(n,13)^eu(n,22))+Uae(n,s,i)|0;c=l,l=u,u=a,a=o+f|0,o=i,i=s,s=n,n=f+m|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,u=u+this.F|0,l=l+this.G|0,c=c+this.H|0,this.set(n,s,i,o,a,u,l,c)}roundClean(){Hl.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const Mv=Bae(()=>new Vae);var qae=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let z9=class{static digest(e){return qae(this,arguments,void 0,function*({data:r}){return Mv(r)})}},AI=class{};var Hae=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let zae=class extends AI{digest(e){return Hae(this,arguments,void 0,function*({algorithm:r,data:n}){switch(r){case"SHA-256":return yield z9.digest({data:n})}})}};/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const W9=BigInt(0),dS=BigInt(1),Wae=BigInt(2);function Gu(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}const Gae=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function pp(t){if(!Gu(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=Gae[t[r]];return e}function G9(t){const e=t.toString(16);return e.length&1?`0${e}`:e}function SI(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}const _c={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function dB(t){if(t>=_c._0&&t<=_c._9)return t-_c._0;if(t>=_c._A&&t<=_c._F)return t-(_c._A-10);if(t>=_c._a&&t<=_c._f)return t-(_c._a-10)}function my(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let s=0,i=0;s<r;s++,i+=2){const o=dB(t.charCodeAt(i)),a=dB(t.charCodeAt(i+1));if(o===void 0||a===void 0){const u=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+u+'" at index '+i)}n[s]=o*16+a}return n}function Qh(t){return SI(pp(t))}function Qd(t){if(!Gu(t))throw new Error("Uint8Array expected");return SI(pp(Uint8Array.from(t).reverse()))}function Yr(t,e){return my(t.toString(16).padStart(e*2,"0"))}function yy(t,e){return Yr(t,e).reverse()}function Jae(t){return my(G9(t))}function Tn(t,e,r){let n;if(typeof e=="string")try{n=my(e)}catch(i){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${i}`)}else if(Gu(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);const s=n.length;if(typeof r=="number"&&s!==r)throw new Error(`${t} expected ${r} bytes, got ${s}`);return n}function mp(...t){let e=0;for(let s=0;s<t.length;s++){const i=t[s];if(!Gu(i))throw new Error("Uint8Array expected");e+=i.length}let r=new Uint8Array(e),n=0;for(let s=0;s<t.length;s++){const i=t[s];r.set(i,n),n+=i.length}return r}function Xae(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}function Yae(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Zae(t){let e;for(e=0;t>W9;t>>=dS,e+=1);return e}function Qae(t,e){return t>>BigInt(e)&dS}const eue=(t,e,r)=>t|(r?dS:W9)<<BigInt(e),TI=t=>(Wae<<BigInt(t-1))-dS,mT=t=>new Uint8Array(t),fB=t=>Uint8Array.from(t);function J9(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=mT(t),s=mT(t),i=0;const o=()=>{n.fill(1),s.fill(0),i=0},a=(...d)=>r(s,n,...d),u=(d=mT())=>{s=a(fB([0]),d),n=a(),d.length!==0&&(s=a(fB([1]),d),n=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let d=0;const h=[];for(;d<e;){n=a();const f=n.slice();h.push(f),d+=n.length}return mp(...h)};return(d,h)=>{o(),u(d);let f;for(;!(f=h(l()));)u();return o(),f}}const tue={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Gu(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Mp(t,e,r={}){const n=(s,i,o)=>{const a=tue[i];if(typeof a!="function")throw new Error(`Invalid validator "${i}", expected function`);const u=t[s];if(!(o&&u===void 0)&&!a(u,t))throw new Error(`Invalid param ${String(s)}=${u} (${typeof u}), expected ${i}`)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(r))n(s,i,!0);return t}const rue=Object.freeze(Object.defineProperty({__proto__:null,bitGet:Qae,bitLen:Zae,bitMask:TI,bitSet:eue,bytesToHex:pp,bytesToNumberBE:Qh,bytesToNumberLE:Qd,concatBytes:mp,createHmacDrbg:J9,ensureBytes:Tn,equalBytes:Xae,hexToBytes:my,hexToNumber:SI,isBytes:Gu,numberToBytesBE:Yr,numberToBytesLE:yy,numberToHexUnpadded:G9,numberToVarBytesBE:Jae,utf8ToBytes:Yae,validateObject:Mp},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ai=BigInt(0),hn=BigInt(1),Ph=BigInt(2),nue=BigInt(3),Rx=BigInt(4),hB=BigInt(5),pB=BigInt(8);BigInt(9);BigInt(16);function Xr(t,e){const r=t%e;return r>=ai?r:e+r}function X9(t,e,r){if(r<=ai||e<ai)throw new Error("Expected power/modulo > 0");if(r===hn)return ai;let n=hn;for(;e>ai;)e&hn&&(n=n*t%r),t=t*t%r,e>>=hn;return n}function dn(t,e,r){let n=t;for(;e-- >ai;)n*=n,n%=r;return n}function Nx(t,e){if(t===ai||e<=ai)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=Xr(t,e),n=e,s=ai,i=hn;for(;r!==ai;){const a=n/r,u=n%r,l=s-i*a;n=r,r=u,s=i,i=l}if(n!==hn)throw new Error("invert: does not exist");return Xr(s,e)}function iue(t){const e=(t-hn)/Ph;let r,n,s;for(r=t-hn,n=0;r%Ph===ai;r/=Ph,n++);for(s=Ph;s<t&&X9(s,e,t)!==t-hn;s++);if(n===1){const o=(t+hn)/Rx;return function(u,l){const c=u.pow(l,o);if(!u.eql(u.sqr(c),l))throw new Error("Cannot find square root");return c}}const i=(r+hn)/Ph;return function(a,u){if(a.pow(u,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let l=n,c=a.pow(a.mul(a.ONE,s),r),d=a.pow(u,i),h=a.pow(u,r);for(;!a.eql(h,a.ONE);){if(a.eql(h,a.ZERO))return a.ZERO;let f=1;for(let m=a.sqr(h);f<l&&!a.eql(m,a.ONE);f++)m=a.sqr(m);const p=a.pow(c,hn<<BigInt(l-f-1));c=a.sqr(p),d=a.mul(d,p),h=a.mul(h,c),l=f}return d}}function sue(t){if(t%Rx===nue){const e=(t+hn)/Rx;return function(n,s){const i=n.pow(s,e);if(!n.eql(n.sqr(i),s))throw new Error("Cannot find square root");return i}}if(t%pB===hB){const e=(t-hB)/pB;return function(n,s){const i=n.mul(s,Ph),o=n.pow(i,e),a=n.mul(s,o),u=n.mul(n.mul(a,Ph),o),l=n.mul(a,n.sub(u,n.ONE));if(!n.eql(n.sqr(l),s))throw new Error("Cannot find square root");return l}}return iue(t)}const oue=(t,e)=>(Xr(t,e)&hn)===hn,aue=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function uue(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=aue.reduce((n,s)=>(n[s]="function",n),e);return Mp(t,r)}function cue(t,e,r){if(r<ai)throw new Error("Expected power > 0");if(r===ai)return t.ONE;if(r===hn)return e;let n=t.ONE,s=e;for(;r>ai;)r&hn&&(n=t.mul(n,s)),s=t.sqr(s),r>>=hn;return n}function lue(t,e){const r=new Array(e.length),n=e.reduce((i,o,a)=>t.is0(o)?i:(r[a]=i,t.mul(i,o)),t.ONE),s=t.inv(n);return e.reduceRight((i,o,a)=>t.is0(o)?i:(r[a]=t.mul(i,r[a]),t.mul(i,o)),s),r}function Y9(t,e){const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function DI(t,e,r=!1,n={}){if(t<=ai)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:s,nByteLength:i}=Y9(t,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=sue(t),a=Object.freeze({ORDER:t,BITS:s,BYTES:i,MASK:TI(s),ZERO:ai,ONE:hn,create:u=>Xr(u,t),isValid:u=>{if(typeof u!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof u}`);return ai<=u&&u<t},is0:u=>u===ai,isOdd:u=>(u&hn)===hn,neg:u=>Xr(-u,t),eql:(u,l)=>u===l,sqr:u=>Xr(u*u,t),add:(u,l)=>Xr(u+l,t),sub:(u,l)=>Xr(u-l,t),mul:(u,l)=>Xr(u*l,t),pow:(u,l)=>cue(a,u,l),div:(u,l)=>Xr(u*Nx(l,t),t),sqrN:u=>u*u,addN:(u,l)=>u+l,subN:(u,l)=>u-l,mulN:(u,l)=>u*l,inv:u=>Nx(u,t),sqrt:n.sqrt||(u=>o(a,u)),invertBatch:u=>lue(a,u),cmov:(u,l,c)=>c?l:u,toBytes:u=>r?yy(u,i):Yr(u,i),fromBytes:u=>{if(u.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${u.length}`);return r?Qd(u):Qh(u)}});return Object.freeze(a)}function due(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");const r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r}function Z9(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function Q9(t){const e=Z9(t);return e+Math.ceil(e/2)}function fue(t,e,r=!1){const n=t.length,s=Z9(e),i=Q9(e);if(n<16||n<i||n>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${n}`);const o=r?Qh(t):Qd(t),a=Xr(o,e-hn)+hn;return r?yy(a,s):Yr(a,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const hue=BigInt(0),yT=BigInt(1);function eL(t,e){const r=(s,i)=>{const o=i.negate();return s?o:i},n=s=>{const i=Math.ceil(e/s)+1,o=2**(s-1);return{windows:i,windowSize:o}};return{constTimeNegate:r,unsafeLadder(s,i){let o=t.ZERO,a=s;for(;i>hue;)i&yT&&(o=o.add(a)),a=a.double(),i>>=yT;return o},precomputeWindow(s,i){const{windows:o,windowSize:a}=n(i),u=[];let l=s,c=l;for(let d=0;d<o;d++){c=l,u.push(c);for(let h=1;h<a;h++)c=c.add(l),u.push(c);l=c.double()}return u},wNAF(s,i,o){const{windows:a,windowSize:u}=n(s);let l=t.ZERO,c=t.BASE;const d=BigInt(2**s-1),h=2**s,f=BigInt(s);for(let p=0;p<a;p++){const m=p*u;let E=Number(o&d);o>>=f,E>u&&(E-=h,o+=yT);const A=m,_=m+Math.abs(E)-1,g=p%2!==0,v=E<0;E===0?c=c.add(r(g,i[A])):l=l.add(r(v,i[_]))}return{p:l,f:c}},wNAFCached(s,i,o,a){const u=s._WINDOW_SIZE||1;let l=i.get(s);return l||(l=this.precomputeWindow(s,u),u!==1&&i.set(s,a(l))),this.wNAF(u,l,o)}}}function xI(t){return uue(t.Fp),Mp(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Y9(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function pue(t){const e=xI(t);Mp(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:s}=e;if(r){if(!n.eql(s,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:mue,hexToBytes:yue}=rue,Fh={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){const{Err:e}=Fh;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");const r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:mue(n),l:t.subarray(r+2)}},toSig(t){const{Err:e}=Fh,r=typeof t=="string"?yue(t):t;if(!Gu(r))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");const{d:s,l:i}=Fh._parseInt(r.subarray(2)),{d:o,l:a}=Fh._parseInt(i);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:o}},hexFromSig(t){const e=l=>Number.parseInt(l[0],16)&8?"00"+l:l,r=l=>{const c=l.toString(16);return c.length&1?`0${c}`:c},n=e(r(t.s)),s=e(r(t.r)),i=n.length/2,o=s.length/2,a=r(i),u=r(o);return`30${r(o+i+4)}02${u}${s}02${a}${n}`}},Zc=BigInt(0),Ho=BigInt(1);BigInt(2);const mB=BigInt(3);BigInt(4);function gue(t){const e=pue(t),{Fp:r}=e,n=e.toBytes||((p,m,E)=>{const A=m.toAffine();return mp(Uint8Array.from([4]),r.toBytes(A.x),r.toBytes(A.y))}),s=e.fromBytes||(p=>{const m=p.subarray(1),E=r.fromBytes(m.subarray(0,r.BYTES)),A=r.fromBytes(m.subarray(r.BYTES,2*r.BYTES));return{x:E,y:A}});function i(p){const{a:m,b:E}=e,A=r.sqr(p),_=r.mul(A,p);return r.add(r.add(_,r.mul(p,m)),E)}if(!r.eql(r.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function o(p){return typeof p=="bigint"&&Zc<p&&p<e.n}function a(p){if(!o(p))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function u(p){const{allowedPrivateKeyLengths:m,nByteLength:E,wrapPrivateKey:A,n:_}=e;if(m&&typeof p!="bigint"){if(Gu(p)&&(p=pp(p)),typeof p!="string"||!m.includes(p.length))throw new Error("Invalid key");p=p.padStart(E*2,"0")}let g;try{g=typeof p=="bigint"?p:Qh(Tn("private key",p,E))}catch{throw new Error(`private key must be ${E} bytes, hex or bigint, not ${typeof p}`)}return A&&(g=Xr(g,_)),a(g),g}const l=new Map;function c(p){if(!(p instanceof d))throw new Error("ProjectivePoint expected")}class d{constructor(m,E,A){if(this.px=m,this.py=E,this.pz=A,m==null||!r.isValid(m))throw new Error("x required");if(E==null||!r.isValid(E))throw new Error("y required");if(A==null||!r.isValid(A))throw new Error("z required")}static fromAffine(m){const{x:E,y:A}=m||{};if(!m||!r.isValid(E)||!r.isValid(A))throw new Error("invalid affine point");if(m instanceof d)throw new Error("projective point not allowed");const _=g=>r.eql(g,r.ZERO);return _(E)&&_(A)?d.ZERO:new d(E,A,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(m){const E=r.invertBatch(m.map(A=>A.pz));return m.map((A,_)=>A.toAffine(E[_])).map(d.fromAffine)}static fromHex(m){const E=d.fromAffine(s(Tn("pointHex",m)));return E.assertValidity(),E}static fromPrivateKey(m){return d.BASE.multiply(u(m))}_setWindowSize(m){this._WINDOW_SIZE=m,l.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:m,y:E}=this.toAffine();if(!r.isValid(m)||!r.isValid(E))throw new Error("bad point: x or y not FE");const A=r.sqr(E),_=i(m);if(!r.eql(A,_))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:m}=this.toAffine();if(r.isOdd)return!r.isOdd(m);throw new Error("Field doesn't support isOdd")}equals(m){c(m);const{px:E,py:A,pz:_}=this,{px:g,py:v,pz:S}=m,x=r.eql(r.mul(E,S),r.mul(g,_)),D=r.eql(r.mul(A,S),r.mul(v,_));return x&&D}negate(){return new d(this.px,r.neg(this.py),this.pz)}double(){const{a:m,b:E}=e,A=r.mul(E,mB),{px:_,py:g,pz:v}=this;let S=r.ZERO,x=r.ZERO,D=r.ZERO,w=r.mul(_,_),b=r.mul(g,g),T=r.mul(v,v),P=r.mul(_,g);return P=r.add(P,P),D=r.mul(_,v),D=r.add(D,D),S=r.mul(m,D),x=r.mul(A,T),x=r.add(S,x),S=r.sub(b,x),x=r.add(b,x),x=r.mul(S,x),S=r.mul(P,S),D=r.mul(A,D),T=r.mul(m,T),P=r.sub(w,T),P=r.mul(m,P),P=r.add(P,D),D=r.add(w,w),w=r.add(D,w),w=r.add(w,T),w=r.mul(w,P),x=r.add(x,w),T=r.mul(g,v),T=r.add(T,T),w=r.mul(T,P),S=r.sub(S,w),D=r.mul(T,b),D=r.add(D,D),D=r.add(D,D),new d(S,x,D)}add(m){c(m);const{px:E,py:A,pz:_}=this,{px:g,py:v,pz:S}=m;let x=r.ZERO,D=r.ZERO,w=r.ZERO;const b=e.a,T=r.mul(e.b,mB);let P=r.mul(E,g),C=r.mul(A,v),k=r.mul(_,S),K=r.add(E,A),L=r.add(g,v);K=r.mul(K,L),L=r.add(P,C),K=r.sub(K,L),L=r.add(E,_);let q=r.add(g,S);return L=r.mul(L,q),q=r.add(P,k),L=r.sub(L,q),q=r.add(A,_),x=r.add(v,S),q=r.mul(q,x),x=r.add(C,k),q=r.sub(q,x),w=r.mul(b,L),x=r.mul(T,k),w=r.add(x,w),x=r.sub(C,w),w=r.add(C,w),D=r.mul(x,w),C=r.add(P,P),C=r.add(C,P),k=r.mul(b,k),L=r.mul(T,L),C=r.add(C,k),k=r.sub(P,k),k=r.mul(b,k),L=r.add(L,k),P=r.mul(C,L),D=r.add(D,P),P=r.mul(q,L),x=r.mul(K,x),x=r.sub(x,P),P=r.mul(K,C),w=r.mul(q,w),w=r.add(w,P),new d(x,D,w)}subtract(m){return this.add(m.negate())}is0(){return this.equals(d.ZERO)}wNAF(m){return f.wNAFCached(this,l,m,E=>{const A=r.invertBatch(E.map(_=>_.pz));return E.map((_,g)=>_.toAffine(A[g])).map(d.fromAffine)})}multiplyUnsafe(m){const E=d.ZERO;if(m===Zc)return E;if(a(m),m===Ho)return this;const{endo:A}=e;if(!A)return f.unsafeLadder(this,m);let{k1neg:_,k1:g,k2neg:v,k2:S}=A.splitScalar(m),x=E,D=E,w=this;for(;g>Zc||S>Zc;)g&Ho&&(x=x.add(w)),S&Ho&&(D=D.add(w)),w=w.double(),g>>=Ho,S>>=Ho;return _&&(x=x.negate()),v&&(D=D.negate()),D=new d(r.mul(D.px,A.beta),D.py,D.pz),x.add(D)}multiply(m){a(m);let E=m,A,_;const{endo:g}=e;if(g){const{k1neg:v,k1:S,k2neg:x,k2:D}=g.splitScalar(E);let{p:w,f:b}=this.wNAF(S),{p:T,f:P}=this.wNAF(D);w=f.constTimeNegate(v,w),T=f.constTimeNegate(x,T),T=new d(r.mul(T.px,g.beta),T.py,T.pz),A=w.add(T),_=b.add(P)}else{const{p:v,f:S}=this.wNAF(E);A=v,_=S}return d.normalizeZ([A,_])[0]}multiplyAndAddUnsafe(m,E,A){const _=d.BASE,g=(S,x)=>x===Zc||x===Ho||!S.equals(_)?S.multiplyUnsafe(x):S.multiply(x),v=g(this,E).add(g(m,A));return v.is0()?void 0:v}toAffine(m){const{px:E,py:A,pz:_}=this,g=this.is0();m==null&&(m=g?r.ONE:r.inv(_));const v=r.mul(E,m),S=r.mul(A,m),x=r.mul(_,m);if(g)return{x:r.ZERO,y:r.ZERO};if(!r.eql(x,r.ONE))throw new Error("invZ was invalid");return{x:v,y:S}}isTorsionFree(){const{h:m,isTorsionFree:E}=e;if(m===Ho)return!0;if(E)return E(d,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:m,clearCofactor:E}=e;return m===Ho?this:E?E(d,this):this.multiplyUnsafe(e.h)}toRawBytes(m=!0){return this.assertValidity(),n(d,this,m)}toHex(m=!0){return pp(this.toRawBytes(m))}}d.BASE=new d(e.Gx,e.Gy,r.ONE),d.ZERO=new d(r.ZERO,r.ONE,r.ZERO);const h=e.nBitLength,f=eL(d,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:d,normPrivateKeyToScalar:u,weierstrassEquation:i,isWithinCurveOrder:o}}function vue(t){const e=xI(t);return Mp(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function wue(t){const e=vue(t),{Fp:r,n}=e,s=r.BYTES+1,i=2*r.BYTES+1;function o(L){return Zc<L&&L<r.ORDER}function a(L){return Xr(L,n)}function u(L){return Nx(L,n)}const{ProjectivePoint:l,normPrivateKeyToScalar:c,weierstrassEquation:d,isWithinCurveOrder:h}=gue({...e,toBytes(L,q,se){const X=q.toAffine(),re=r.toBytes(X.x),W=mp;return se?W(Uint8Array.from([q.hasEvenY()?2:3]),re):W(Uint8Array.from([4]),re,r.toBytes(X.y))},fromBytes(L){const q=L.length,se=L[0],X=L.subarray(1);if(q===s&&(se===2||se===3)){const re=Qh(X);if(!o(re))throw new Error("Point is not on curve");const W=d(re);let B=r.sqrt(W);const te=(B&Ho)===Ho;return(se&1)===1!==te&&(B=r.neg(B)),{x:re,y:B}}else if(q===i&&se===4){const re=r.fromBytes(X.subarray(0,r.BYTES)),W=r.fromBytes(X.subarray(r.BYTES,2*r.BYTES));return{x:re,y:W}}else throw new Error(`Point of length ${q} was invalid. Expected ${s} compressed bytes or ${i} uncompressed bytes`)}}),f=L=>pp(Yr(L,e.nByteLength));function p(L){const q=n>>Ho;return L>q}function m(L){return p(L)?a(-L):L}const E=(L,q,se)=>Qh(L.slice(q,se));class A{constructor(q,se,X){this.r=q,this.s=se,this.recovery=X,this.assertValidity()}static fromCompact(q){const se=e.nByteLength;return q=Tn("compactSignature",q,se*2),new A(E(q,0,se),E(q,se,2*se))}static fromDER(q){const{r:se,s:X}=Fh.toSig(Tn("DER",q));return new A(se,X)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(q){return new A(this.r,this.s,q)}recoverPublicKey(q){const{r:se,s:X,recovery:re}=this,W=D(Tn("msgHash",q));if(re==null||![0,1,2,3].includes(re))throw new Error("recovery id invalid");const B=re===2||re===3?se+e.n:se;if(B>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const te=re&1?"03":"02",z=l.fromHex(te+f(B)),$=u(B),F=a(-W*$),ee=a(X*$),ne=l.BASE.multiplyAndAddUnsafe(z,F,ee);if(!ne)throw new Error("point at infinify");return ne.assertValidity(),ne}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new A(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return my(this.toDERHex())}toDERHex(){return Fh.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return my(this.toCompactHex())}toCompactHex(){return f(this.r)+f(this.s)}}const _={isValidPrivateKey(L){try{return c(L),!0}catch{return!1}},normPrivateKeyToScalar:c,randomPrivateKey:()=>{const L=Q9(e.n);return fue(e.randomBytes(L),e.n)},precompute(L=8,q=l.BASE){return q._setWindowSize(L),q.multiply(BigInt(3)),q}};function g(L,q=!0){return l.fromPrivateKey(L).toRawBytes(q)}function v(L){const q=Gu(L),se=typeof L=="string",X=(q||se)&&L.length;return q?X===s||X===i:se?X===2*s||X===2*i:L instanceof l}function S(L,q,se=!0){if(v(L))throw new Error("first arg must be private key");if(!v(q))throw new Error("second arg must be public key");return l.fromHex(q).multiply(c(L)).toRawBytes(se)}const x=e.bits2int||function(L){const q=Qh(L),se=L.length*8-e.nBitLength;return se>0?q>>BigInt(se):q},D=e.bits2int_modN||function(L){return a(x(L))},w=TI(e.nBitLength);function b(L){if(typeof L!="bigint")throw new Error("bigint expected");if(!(Zc<=L&&L<w))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Yr(L,e.nByteLength)}function T(L,q,se=P){if(["recovered","canonical"].some(me=>me in se))throw new Error("sign() legacy options not supported");const{hash:X,randomBytes:re}=e;let{lowS:W,prehash:B,extraEntropy:te}=se;W==null&&(W=!0),L=Tn("msgHash",L),B&&(L=Tn("prehashed msgHash",X(L)));const z=D(L),$=c(q),F=[b($),b(z)];if(te!=null){const me=te===!0?re(r.BYTES):te;F.push(Tn("extraEntropy",me))}const ee=mp(...F),ne=z;function le(me){const ve=x(me);if(!h(ve))return;const Pe=u(ve),Ue=l.BASE.multiply(ve).toAffine(),M=a(Ue.x);if(M===Zc)return;const V=a(Pe*a(ne+M*$));if(V===Zc)return;let oe=(Ue.x===M?0:2)|Number(Ue.y&Ho),j=V;return W&&p(V)&&(j=m(V),oe^=1),new A(M,j,oe)}return{seed:ee,k2sig:le}}const P={lowS:e.lowS,prehash:!1},C={lowS:e.lowS,prehash:!1};function k(L,q,se=P){const{seed:X,k2sig:re}=T(L,q,se),W=e;return J9(W.hash.outputLen,W.nByteLength,W.hmac)(X,re)}l.BASE._setWindowSize(8);function K(L,q,se,X=C){var Ue;const re=L;if(q=Tn("msgHash",q),se=Tn("publicKey",se),"strict"in X)throw new Error("options.strict was renamed to lowS");const{lowS:W,prehash:B}=X;let te,z;try{if(typeof re=="string"||Gu(re))try{te=A.fromDER(re)}catch(M){if(!(M instanceof Fh.Err))throw M;te=A.fromCompact(re)}else if(typeof re=="object"&&typeof re.r=="bigint"&&typeof re.s=="bigint"){const{r:M,s:V}=re;te=new A(M,V)}else throw new Error("PARSE");z=l.fromHex(se)}catch(M){if(M.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(W&&te.hasHighS())return!1;B&&(q=e.hash(q));const{r:$,s:F}=te,ee=D(q),ne=u(F),le=a(ee*ne),me=a($*ne),ve=(Ue=l.BASE.multiplyAndAddUnsafe(z,le,me))==null?void 0:Ue.toAffine();return ve?a(ve.x)===$:!1}return{CURVE:e,getPublicKey:g,getSharedSecret:S,sign:k,verify:K,ProjectivePoint:l,Signature:A,utils:_}}class tL extends pU{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,Pte(e);const n=JC(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return _E(this),this.iHash.update(e),this}digestInto(e){_E(this),lU(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const rL=(t,e,r)=>new tL(t,e).update(r).digest();rL.create=(t,e)=>new tL(t,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function _ue(t){return{hash:t,hmac:(e,...r)=>rL(t,e,hU(...r)),randomBytes:XC}}function nL(t,e){const r=n=>wue({...t,..._ue(n)});return Object.freeze({...r(e),create:r})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const iL=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),yB=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),bue=BigInt(1),Bx=BigInt(2),gB=(t,e)=>(t+e/Bx)/e;function Eue(t){const e=iL,r=BigInt(3),n=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),u=BigInt(88),l=t*t*t%e,c=l*l*t%e,d=dn(c,r,e)*c%e,h=dn(d,r,e)*c%e,f=dn(h,Bx,e)*l%e,p=dn(f,s,e)*f%e,m=dn(p,i,e)*p%e,E=dn(m,a,e)*m%e,A=dn(E,u,e)*E%e,_=dn(A,a,e)*m%e,g=dn(_,r,e)*c%e,v=dn(g,o,e)*p%e,S=dn(v,n,e)*l%e,x=dn(S,Bx,e);if(!Fx.eql(Fx.sqr(x),t))throw new Error("Cannot find square root");return x}const Fx=DI(iL,void 0,void 0,{sqrt:Eue}),et=nL({a:BigInt(0),b:BigInt(7),Fp:Fx,n:yB,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=yB,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-bue*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=r,o=BigInt("0x100000000000000000000000000000000"),a=gB(i*t,e),u=gB(-n*t,e);let l=Xr(t-a*r-u*s,e),c=Xr(-a*n-u*i,e);const d=l>o,h=c>o;if(d&&(l=e-l),h&&(c=e-c),l>o||c>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:d,k1:l,k2neg:h,k2:c}}}},pf);BigInt(0);et.ProjectivePoint;function Aue(t){const e=n=>{if(n!==null&&typeof n=="object"&&!Array.isArray(n)){const s=Object.keys(n).sort(),i={};for(const o of s)i[o]=e(n[o]);return i}return n},r=e(t);return JSON.stringify(r)}var Sue=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};const vB="urn:jwk:";function Ln(t){return Sue(this,arguments,void 0,function*({jwk:e}){const r=e.kty;let n;if(r==="EC")n={crv:e.crv,kty:e.kty,x:e.x,y:e.y};else if(r==="oct")n={k:e.k,kty:e.kty};else if(r==="OKP")n={crv:e.crv,kty:e.kty,x:e.x};else if(r==="RSA")n={e:e.e,kty:e.kty,n:e.n};else throw new Error(`Unsupported key type: ${r}`);V9(n);const s=Aue(n),i=mr.string(s).toUint8Array(),o=yield z9.digest({data:i});return mr.uint8Array(o).toBase64Url()})}function ep(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="EC"||typeof t.d!="string"||typeof t.x!="string")}function PI(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t)||"d"in t||t.kty!=="EC"||typeof t.x!="string")}function rv(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="OKP"||typeof t.d!="string"||typeof t.x!="string")}function sL(t){return!(!t||typeof t!="object"||"d"in t||!("kty"in t&&"crv"in t&&"x"in t)||t.kty!=="OKP"||typeof t.x!="string")}function Tue(t){if(!t||typeof t!="object")return!1;switch(t.kty){case"EC":case"OKP":case"RSA":return"d"in t;case"oct":return"k"in t;default:return!1}}var di=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},Due=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let $g=class ou{static adjustSignatureToLowS(e){return di(this,arguments,void 0,function*({signature:r}){const n=et.Signature.fromCompact(r);return n.hasHighS()?n.normalizeS().toCompactRawBytes():r})}static bytesToPrivateKey(e){return di(this,arguments,void 0,function*({privateKeyBytes:r}){const n=yield ou.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"secp256k1",d:mr.uint8Array(r).toBase64Url(),x:mr.uint8Array(n.x).toBase64Url(),y:mr.uint8Array(n.y).toBase64Url()};return s.kid=yield Ln({jwk:s}),s})}static bytesToPublicKey(e){return di(this,arguments,void 0,function*({publicKeyBytes:r}){const n=yield ou.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"secp256k1",x:mr.uint8Array(n.x).toBase64Url(),y:mr.uint8Array(n.y).toBase64Url()};return s.kid=yield Ln({jwk:s}),s})}static compressPublicKey(e){return di(this,arguments,void 0,function*({publicKeyBytes:r}){return et.ProjectivePoint.fromHex(r).toRawBytes(!0)})}static computePublicKey(e){return di(this,arguments,void 0,function*({key:r}){const n=yield ou.privateKeyToBytes({privateKey:r}),s=yield ou.getCurvePoint({keyBytes:n}),i={kty:"EC",crv:"secp256k1",x:mr.uint8Array(s.x).toBase64Url(),y:mr.uint8Array(s.y).toBase64Url()};return i.kid=yield Ln({jwk:i}),i})}static convertDerToCompactSignature(e){return di(this,arguments,void 0,function*({derSignature:r}){return et.Signature.fromDER(r).toCompactRawBytes()})}static decompressPublicKey(e){return di(this,arguments,void 0,function*({publicKeyBytes:r}){return et.ProjectivePoint.fromHex(r).toRawBytes(!1)})}static generateKey(){return di(this,void 0,void 0,function*(){const e=et.utils.randomPrivateKey(),r=yield ou.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Ln({jwk:r}),r})}static getPublicKey(e){return di(this,arguments,void 0,function*({key:r}){var n;if(!(ep(r)&&r.crv==="secp256k1"))throw new Error("Secp256k1: The provided key is not a secp256k1 private JWK.");let s=Due(r,["d"]);return(n=s.kid)!==null&&n!==void 0||(s.kid=yield Ln({jwk:s})),s})}static privateKeyToBytes(e){return di(this,arguments,void 0,function*({privateKey:r}){if(!ep(r))throw new Error("Secp256k1: The provided key is not a valid EC private key.");return mr.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return di(this,arguments,void 0,function*({publicKey:r}){if(!(PI(r)&&r.y))throw new Error("Secp256k1: The provided key is not a valid EC public key.");const n=new Uint8Array([4]),s=mr.base64Url(r.x).toUint8Array(),i=mr.base64Url(r.y).toUint8Array();return new Uint8Array([...n,...s,...i])})}static sharedSecret(e){return di(this,arguments,void 0,function*({privateKeyA:r,publicKeyB:n}){if("x"in r&&"x"in n&&r.x===n.x)throw new Error("Secp256k1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const s=yield ou.privateKeyToBytes({privateKey:r}),i=yield ou.publicKeyToBytes({publicKey:n});return et.getSharedSecret(s,i,!0).slice(1)})}static sign(e){return di(this,arguments,void 0,function*({data:r,key:n}){const s=yield ou.privateKeyToBytes({privateKey:n}),i=Mv(r);return et.sign(i,s).toCompactRawBytes()})}static validatePrivateKey(e){return di(this,arguments,void 0,function*({privateKeyBytes:r}){return et.utils.isValidPrivateKey(r)})}static validatePublicKey(e){return di(this,arguments,void 0,function*({publicKeyBytes:r}){try{et.ProjectivePoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return di(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=yield ou.publicKeyToBytes({publicKey:r}),o=Mv(s);return et.verify(n,o,i,{lowS:!1})})}static getCurvePoint(e){return di(this,arguments,void 0,function*({keyBytes:r}){r.byteLength===32&&(r=et.getPublicKey(r));const n=et.ProjectivePoint.fromHex(r),s=Yr(n.x,32),i=Yr(n.y,32);return{x:s,y:i}})}};/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const oL=DI(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),xue=oL.create(BigInt("-3")),Pue=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Cue=nL({a:xue,b:Pue,Fp:oL,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},pf),tt=Cue;var fi=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},Iue=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let Og=class au{static adjustSignatureToLowS(e){return fi(this,arguments,void 0,function*({signature:r}){const n=tt.Signature.fromCompact(r);return n.hasHighS()?n.normalizeS().toCompactRawBytes():r})}static bytesToPrivateKey(e){return fi(this,arguments,void 0,function*({privateKeyBytes:r}){const n=yield au.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"P-256",d:mr.uint8Array(r).toBase64Url(),x:mr.uint8Array(n.x).toBase64Url(),y:mr.uint8Array(n.y).toBase64Url()};return s.kid=yield Ln({jwk:s}),s})}static bytesToPublicKey(e){return fi(this,arguments,void 0,function*({publicKeyBytes:r}){const n=yield au.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"P-256",x:mr.uint8Array(n.x).toBase64Url(),y:mr.uint8Array(n.y).toBase64Url()};return s.kid=yield Ln({jwk:s}),s})}static compressPublicKey(e){return fi(this,arguments,void 0,function*({publicKeyBytes:r}){return tt.ProjectivePoint.fromHex(r).toRawBytes(!0)})}static computePublicKey(e){return fi(this,arguments,void 0,function*({key:r}){const n=yield au.privateKeyToBytes({privateKey:r}),s=yield au.getCurvePoint({keyBytes:n}),i={kty:"EC",crv:"P-256",x:mr.uint8Array(s.x).toBase64Url(),y:mr.uint8Array(s.y).toBase64Url()};return i.kid=yield Ln({jwk:i}),i})}static convertDerToCompactSignature(e){return fi(this,arguments,void 0,function*({derSignature:r}){return tt.Signature.fromDER(r).toCompactRawBytes()})}static decompressPublicKey(e){return fi(this,arguments,void 0,function*({publicKeyBytes:r}){return tt.ProjectivePoint.fromHex(r).toRawBytes(!1)})}static generateKey(){return fi(this,void 0,void 0,function*(){const e=tt.utils.randomPrivateKey(),r=yield au.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Ln({jwk:r}),r})}static getPublicKey(e){return fi(this,arguments,void 0,function*({key:r}){var n;if(!(ep(r)&&r.crv==="P-256"))throw new Error("Secp256r1: The provided key is not a 'P-256' private JWK.");let s=Iue(r,["d"]);return(n=s.kid)!==null&&n!==void 0||(s.kid=yield Ln({jwk:s})),s})}static privateKeyToBytes(e){return fi(this,arguments,void 0,function*({privateKey:r}){if(!ep(r))throw new Error("Secp256r1: The provided key is not a valid EC private key.");return mr.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return fi(this,arguments,void 0,function*({publicKey:r}){if(!(PI(r)&&r.y))throw new Error("Secp256r1: The provided key is not a valid EC public key.");const n=new Uint8Array([4]),s=mr.base64Url(r.x).toUint8Array(),i=mr.base64Url(r.y).toUint8Array();return new Uint8Array([...n,...s,...i])})}static sharedSecret(e){return fi(this,arguments,void 0,function*({privateKeyA:r,publicKeyB:n}){if("x"in r&&"x"in n&&r.x===n.x)throw new Error("Secp256r1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const s=yield au.privateKeyToBytes({privateKey:r}),i=yield au.publicKeyToBytes({publicKey:n});return tt.getSharedSecret(s,i,!0).slice(1)})}static sign(e){return fi(this,arguments,void 0,function*({data:r,key:n}){const s=yield au.privateKeyToBytes({privateKey:n}),i=Mv(r);return tt.sign(i,s).toCompactRawBytes()})}static validatePrivateKey(e){return fi(this,arguments,void 0,function*({privateKeyBytes:r}){return tt.utils.isValidPrivateKey(r)})}static validatePublicKey(e){return fi(this,arguments,void 0,function*({publicKeyBytes:r}){try{tt.ProjectivePoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return fi(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=yield au.publicKeyToBytes({publicKey:r}),o=Mv(s);return tt.verify(n,o,i,{lowS:!1})})}static getCurvePoint(e){return fi(this,arguments,void 0,function*({keyBytes:r}){r.byteLength===32&&(r=tt.getPublicKey(r));const n=tt.ProjectivePoint.fromHex(r),s=Yr(n.x,32),i=Yr(n.y,32);return{x:s,y:i}})}};var Rg=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let wB=class extends AI{computePublicKey(e){return Rg(this,arguments,void 0,function*({key:r}){if(!ep(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":{const n=yield $g.computePublicKey({key:r});return n.alg="ES256K",n}case"P-256":{const n=yield Og.computePublicKey({key:r});return n.alg="ES256",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}generateKey(e){return Rg(this,arguments,void 0,function*({algorithm:r}){switch(r){case"ES256K":case"secp256k1":{const n=yield $g.generateKey();return n.alg="ES256K",n}case"ES256":case"secp256r1":{const n=yield Og.generateKey();return n.alg="ES256",n}}})}getPublicKey(e){return Rg(this,arguments,void 0,function*({key:r}){if(!ep(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":{const n=yield $g.getPublicKey({key:r});return n.alg="ES256K",n}case"P-256":{const n=yield Og.getPublicKey({key:r});return n.alg="ES256",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}sign(e){return Rg(this,arguments,void 0,function*({key:r,data:n}){if(!ep(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":return yield $g.sign({key:r,data:n});case"P-256":return yield Og.sign({key:r,data:n});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}verify(e){return Rg(this,arguments,void 0,function*({key:r,signature:n,data:s}){if(!PI(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) public key.");switch(r.crv){case"secp256k1":return yield $g.verify({key:r,signature:n,data:s});case"P-256":return yield Og.verify({key:r,signature:n,data:s});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}};const nb=BigInt(2**32-1),Mx=BigInt(32);function aL(t,e=!1){return e?{h:Number(t&nb),l:Number(t>>Mx&nb)}:{h:Number(t>>Mx&nb)|0,l:Number(t&nb)|0}}function kue(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=aL(t[s],e);[r[s],n[s]]=[i,o]}return[r,n]}const $ue=(t,e)=>BigInt(t>>>0)<<Mx|BigInt(e>>>0),Oue=(t,e,r)=>t>>>r,Rue=(t,e,r)=>t<<32-r|e>>>r,Nue=(t,e,r)=>t>>>r|e<<32-r,Bue=(t,e,r)=>t<<32-r|e>>>r,Fue=(t,e,r)=>t<<64-r|e>>>r-32,Mue=(t,e,r)=>t>>>r-32|e<<64-r,jue=(t,e)=>e,Uue=(t,e)=>t,Lue=(t,e,r)=>t<<r|e>>>32-r,Kue=(t,e,r)=>e<<r|t>>>32-r,Vue=(t,e,r)=>e<<r-32|t>>>64-r,que=(t,e,r)=>t<<r-32|e>>>64-r;function Hue(t,e,r,n){const s=(e>>>0)+(n>>>0);return{h:t+r+(s/2**32|0)|0,l:s|0}}const zue=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),Wue=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,Gue=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),Jue=(t,e,r,n,s)=>e+r+n+s+(t/2**32|0)|0,Xue=(t,e,r,n,s)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(s>>>0),Yue=(t,e,r,n,s,i)=>e+r+n+s+i+(t/2**32|0)|0,qt={fromBig:aL,split:kue,toBig:$ue,shrSH:Oue,shrSL:Rue,rotrSH:Nue,rotrSL:Bue,rotrBH:Fue,rotrBL:Mue,rotr32H:jue,rotr32L:Uue,rotlSH:Lue,rotlSL:Kue,rotlBH:Vue,rotlBL:que,add:Hue,add3L:zue,add3H:Wue,add4L:Gue,add4H:Jue,add5H:Yue,add5L:Xue},[Zue,Que]=qt.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),zl=new Uint32Array(80),Wl=new Uint32Array(80);class ece extends yU{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:r,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:u,Eh:l,El:c,Fh:d,Fl:h,Gh:f,Gl:p,Hh:m,Hl:E}=this;return[e,r,n,s,i,o,a,u,l,c,d,h,f,p,m,E]}set(e,r,n,s,i,o,a,u,l,c,d,h,f,p,m,E){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=u|0,this.Eh=l|0,this.El=c|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=p|0,this.Hh=m|0,this.Hl=E|0}process(e,r){for(let g=0;g<16;g++,r+=4)zl[g]=e.getUint32(r),Wl[g]=e.getUint32(r+=4);for(let g=16;g<80;g++){const v=zl[g-15]|0,S=Wl[g-15]|0,x=qt.rotrSH(v,S,1)^qt.rotrSH(v,S,8)^qt.shrSH(v,S,7),D=qt.rotrSL(v,S,1)^qt.rotrSL(v,S,8)^qt.shrSL(v,S,7),w=zl[g-2]|0,b=Wl[g-2]|0,T=qt.rotrSH(w,b,19)^qt.rotrBH(w,b,61)^qt.shrSH(w,b,6),P=qt.rotrSL(w,b,19)^qt.rotrBL(w,b,61)^qt.shrSL(w,b,6),C=qt.add4L(D,P,Wl[g-7],Wl[g-16]),k=qt.add4H(C,x,T,zl[g-7],zl[g-16]);zl[g]=k|0,Wl[g]=C|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:u,Dh:l,Dl:c,Eh:d,El:h,Fh:f,Fl:p,Gh:m,Gl:E,Hh:A,Hl:_}=this;for(let g=0;g<80;g++){const v=qt.rotrSH(d,h,14)^qt.rotrSH(d,h,18)^qt.rotrBH(d,h,41),S=qt.rotrSL(d,h,14)^qt.rotrSL(d,h,18)^qt.rotrBL(d,h,41),x=d&f^~d&m,D=h&p^~h&E,w=qt.add5L(_,S,D,Que[g],Wl[g]),b=qt.add5H(w,A,v,x,Zue[g],zl[g]),T=w|0,P=qt.rotrSH(n,s,28)^qt.rotrBH(n,s,34)^qt.rotrBH(n,s,39),C=qt.rotrSL(n,s,28)^qt.rotrBL(n,s,34)^qt.rotrBL(n,s,39),k=n&i^n&a^i&a,K=s&o^s&u^o&u;A=m|0,_=E|0,m=f|0,E=p|0,f=d|0,p=h|0,{h:d,l:h}=qt.add(l|0,c|0,b|0,T|0),l=a|0,c=u|0,a=i|0,u=o|0,i=n|0,o=s|0;const L=qt.add3L(T,C,K);n=qt.add3H(L,b,P,k),s=L|0}({h:n,l:s}=qt.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=qt.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:u}=qt.add(this.Ch|0,this.Cl|0,a|0,u|0),{h:l,l:c}=qt.add(this.Dh|0,this.Dl|0,l|0,c|0),{h:d,l:h}=qt.add(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:p}=qt.add(this.Fh|0,this.Fl|0,f|0,p|0),{h:m,l:E}=qt.add(this.Gh|0,this.Gl|0,m|0,E|0),{h:A,l:_}=qt.add(this.Hh|0,this.Hl|0,A|0,_|0),this.set(n,s,i,o,a,u,l,c,d,h,f,p,m,E,A,_)}roundClean(){zl.fill(0),Wl.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const uL=mU(()=>new ece);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ya=BigInt(0),Zs=BigInt(1),ib=BigInt(2),tce=BigInt(8),rce={zip215:!0};function nce(t){const e=xI(t);return Mp(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function CI(t){const e=nce(t),{Fp:r,n,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:u}=e,l=ib<<BigInt(a*8)-Zs,c=r.create,d=e.uvRatio||((X,re)=>{try{return{isValid:!0,value:r.sqrt(X*r.inv(re))}}catch{return{isValid:!1,value:ya}}}),h=e.adjustScalarBytes||(X=>X),f=e.domain||((X,re,W)=>{if(re.length||W)throw new Error("Contexts/pre-hash are not supported");return X}),p=X=>typeof X=="bigint"&&ya<X,m=(X,re)=>p(X)&&p(re)&&X<re,E=X=>X===ya||m(X,l);function A(X,re){if(m(X,re))return X;throw new Error(`Expected valid scalar < ${re}, got ${typeof X} ${X}`)}function _(X){return X===ya?X:A(X,n)}const g=new Map;function v(X){if(!(X instanceof S))throw new Error("ExtendedPoint expected")}class S{constructor(re,W,B,te){if(this.ex=re,this.ey=W,this.ez=B,this.et=te,!E(re))throw new Error("x required");if(!E(W))throw new Error("y required");if(!E(B))throw new Error("z required");if(!E(te))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(re){if(re instanceof S)throw new Error("extended point not allowed");const{x:W,y:B}=re||{};if(!E(W)||!E(B))throw new Error("invalid affine point");return new S(W,B,Zs,c(W*B))}static normalizeZ(re){const W=r.invertBatch(re.map(B=>B.ez));return re.map((B,te)=>B.toAffine(W[te])).map(S.fromAffine)}_setWindowSize(re){this._WINDOW_SIZE=re,g.delete(this)}assertValidity(){const{a:re,d:W}=e;if(this.is0())throw new Error("bad point: ZERO");const{ex:B,ey:te,ez:z,et:$}=this,F=c(B*B),ee=c(te*te),ne=c(z*z),le=c(ne*ne),me=c(F*re),ve=c(ne*c(me+ee)),Pe=c(le+c(W*c(F*ee)));if(ve!==Pe)throw new Error("bad point: equation left != right (1)");const Ue=c(B*te),M=c(z*$);if(Ue!==M)throw new Error("bad point: equation left != right (2)")}equals(re){v(re);const{ex:W,ey:B,ez:te}=this,{ex:z,ey:$,ez:F}=re,ee=c(W*F),ne=c(z*te),le=c(B*F),me=c($*te);return ee===ne&&le===me}is0(){return this.equals(S.ZERO)}negate(){return new S(c(-this.ex),this.ey,this.ez,c(-this.et))}double(){const{a:re}=e,{ex:W,ey:B,ez:te}=this,z=c(W*W),$=c(B*B),F=c(ib*c(te*te)),ee=c(re*z),ne=W+B,le=c(c(ne*ne)-z-$),me=ee+$,ve=me-F,Pe=ee-$,Ue=c(le*ve),M=c(me*Pe),V=c(le*Pe),oe=c(ve*me);return new S(Ue,M,oe,V)}add(re){v(re);const{a:W,d:B}=e,{ex:te,ey:z,ez:$,et:F}=this,{ex:ee,ey:ne,ez:le,et:me}=re;if(W===BigInt(-1)){const he=c((z-te)*(ne+ee)),Ce=c((z+te)*(ne-ee)),_e=c(Ce-he);if(_e===ya)return this.double();const G=c($*ib*me),J=c(F*ib*le),ge=J+G,be=Ce+he,ke=J-G,At=c(ge*_e),kt=c(be*ke),$r=c(ge*ke),Wt=c(_e*be);return new S(At,kt,Wt,$r)}const ve=c(te*ee),Pe=c(z*ne),Ue=c(F*B*me),M=c($*le),V=c((te+z)*(ee+ne)-ve-Pe),oe=M-Ue,j=M+Ue,I=c(Pe-W*ve),N=c(V*oe),Q=c(j*I),ce=c(V*I),pe=c(oe*j);return new S(N,Q,pe,ce)}subtract(re){return this.add(re.negate())}wNAF(re){return w.wNAFCached(this,g,re,S.normalizeZ)}multiply(re){const{p:W,f:B}=this.wNAF(A(re,n));return S.normalizeZ([W,B])[0]}multiplyUnsafe(re){let W=_(re);return W===ya?D:this.equals(D)||W===Zs?this:this.equals(x)?this.wNAF(W).p:w.unsafeLadder(this,W)}isSmallOrder(){return this.multiplyUnsafe(u).is0()}isTorsionFree(){return w.unsafeLadder(this,n).is0()}toAffine(re){const{ex:W,ey:B,ez:te}=this,z=this.is0();re==null&&(re=z?tce:r.inv(te));const $=c(W*re),F=c(B*re),ee=c(te*re);if(z)return{x:ya,y:Zs};if(ee!==Zs)throw new Error("invZ was invalid");return{x:$,y:F}}clearCofactor(){const{h:re}=e;return re===Zs?this:this.multiplyUnsafe(re)}static fromHex(re,W=!1){const{d:B,a:te}=e,z=r.BYTES;re=Tn("pointHex",re,z);const $=re.slice(),F=re[z-1];$[z-1]=F&-129;const ee=Qd($);ee===ya||(W?A(ee,l):A(ee,r.ORDER));const ne=c(ee*ee),le=c(ne-Zs),me=c(B*ne-te);let{isValid:ve,value:Pe}=d(le,me);if(!ve)throw new Error("Point.fromHex: invalid y coordinate");const Ue=(Pe&Zs)===Zs,M=(F&128)!==0;if(!W&&Pe===ya&&M)throw new Error("Point.fromHex: x=0 and x_0=1");return M!==Ue&&(Pe=c(-Pe)),S.fromAffine({x:Pe,y:ee})}static fromPrivateKey(re){return P(re).point}toRawBytes(){const{x:re,y:W}=this.toAffine(),B=yy(W,r.BYTES);return B[B.length-1]|=re&Zs?128:0,B}toHex(){return pp(this.toRawBytes())}}S.BASE=new S(e.Gx,e.Gy,Zs,c(e.Gx*e.Gy)),S.ZERO=new S(ya,Zs,Zs,ya);const{BASE:x,ZERO:D}=S,w=eL(S,a*8);function b(X){return Xr(X,n)}function T(X){return b(Qd(X))}function P(X){const re=a;X=Tn("private key",X,re);const W=Tn("hashed private key",i(X),2*re),B=h(W.slice(0,re)),te=W.slice(re,2*re),z=T(B),$=x.multiply(z),F=$.toRawBytes();return{head:B,prefix:te,scalar:z,point:$,pointBytes:F}}function C(X){return P(X).pointBytes}function k(X=new Uint8Array,...re){const W=mp(...re);return T(i(f(W,Tn("context",X),!!s)))}function K(X,re,W={}){X=Tn("message",X),s&&(X=s(X));const{prefix:B,scalar:te,pointBytes:z}=P(re),$=k(W.context,B,X),F=x.multiply($).toRawBytes(),ee=k(W.context,F,z,X),ne=b($+ee*te);_(ne);const le=mp(F,yy(ne,r.BYTES));return Tn("result",le,a*2)}const L=rce;function q(X,re,W,B=L){const{context:te,zip215:z}=B,$=r.BYTES;X=Tn("signature",X,2*$),re=Tn("message",re),s&&(re=s(re));const F=Qd(X.slice($,2*$));let ee,ne,le;try{ee=S.fromHex(W,z),ne=S.fromHex(X.slice(0,$),z),le=x.multiplyUnsafe(F)}catch{return!1}if(!z&&ee.isSmallOrder())return!1;const me=k(te,ne.toRawBytes(),ee.toRawBytes(),re);return ne.add(ee.multiplyUnsafe(me)).subtract(le).clearCofactor().equals(S.ZERO)}return x._setWindowSize(8),{CURVE:e,getPublicKey:C,sign:K,verify:q,ExtendedPoint:S,utils:{getExtendedPublicKey:P,randomPrivateKey:()=>o(r.BYTES),precompute(X=8,re=S.BASE){return re._setWindowSize(X),re.multiply(BigInt(3)),re}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ng=BigInt(0),gT=BigInt(1);function ice(t){return Mp(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...t})}function sce(t){const e=ice(t),{P:r}=e,n=g=>Xr(g,r),s=e.montgomeryBits,i=Math.ceil(s/8),o=e.nByteLength,a=e.adjustScalarBytes||(g=>g),u=e.powPminus2||(g=>X9(g,r-BigInt(2),r));function l(g,v,S){const x=n(g*(v-S));return v=n(v-x),S=n(S+x),[v,S]}function c(g){if(typeof g=="bigint"&&Ng<=g&&g<r)return g;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}const d=(e.a-BigInt(2))/BigInt(4);function h(g,v){const S=c(g),x=c(v),D=S;let w=gT,b=Ng,T=S,P=gT,C=Ng,k;for(let L=BigInt(s-1);L>=Ng;L--){const q=x>>L&gT;C^=q,k=l(C,w,T),w=k[0],T=k[1],k=l(C,b,P),b=k[0],P=k[1],C=q;const se=w+b,X=n(se*se),re=w-b,W=n(re*re),B=X-W,te=T+P,z=T-P,$=n(z*se),F=n(te*re),ee=$+F,ne=$-F;T=n(ee*ee),P=n(D*n(ne*ne)),w=n(X*W),b=n(B*(X+n(d*B)))}k=l(C,w,T),w=k[0],T=k[1],k=l(C,b,P),b=k[0],P=k[1];const K=u(b);return n(w*K)}function f(g){return yy(n(g),i)}function p(g){const v=Tn("u coordinate",g,i);return o===32&&(v[31]&=127),Qd(v)}function m(g){const v=Tn("scalar",g),S=v.length;if(S!==i&&S!==o)throw new Error(`Expected ${i} or ${o} bytes, got ${S}`);return Qd(a(v))}function E(g,v){const S=p(v),x=m(g),D=h(S,x);if(D===Ng)throw new Error("Invalid private or public key received");return f(D)}const A=f(e.Gu);function _(g){return E(g,A)}return{scalarMult:E,scalarMultBase:_,getSharedSecret:(g,v)=>E(g,v),getPublicKey:g=>_(g),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:A}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const jv=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),_B=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const oce=BigInt(1),jx=BigInt(2),ace=BigInt(5),bB=BigInt(10),uce=BigInt(20),cce=BigInt(40),EB=BigInt(80);function cL(t){const e=jv,n=t*t%e*t%e,s=dn(n,jx,e)*n%e,i=dn(s,oce,e)*t%e,o=dn(i,ace,e)*i%e,a=dn(o,bB,e)*o%e,u=dn(a,uce,e)*a%e,l=dn(u,cce,e)*u%e,c=dn(l,EB,e)*l%e,d=dn(c,EB,e)*l%e,h=dn(d,bB,e)*o%e;return{pow_p_5_8:dn(h,jx,e)*t%e,b2:n}}function lL(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function lce(t,e){const r=jv,n=Xr(e*e*e,r),s=Xr(n*n*e,r),i=cL(t*s).pow_p_5_8;let o=Xr(t*n*i,r);const a=Xr(e*o*o,r),u=o,l=Xr(o*_B,r),c=a===t,d=a===Xr(-t,r),h=a===Xr(-t*_B,r);return c&&(o=u),(d||h)&&(o=l),oue(o,r)&&(o=Xr(-o,r)),{isValid:c||d,value:o}}const ra=DI(jv,void 0,!0),Uv={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:ra,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:uL,randomBytes:XC,adjustScalarBytes:lL,uvRatio:lce},wr=CI(Uv);function dL(t,e,r){if(e.length>255)throw new Error("Context is too big");return hU(fU("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,e.length]),e,t)}({...Uv});({...Uv});const Oi=sce({P:jv,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{const e=jv,{pow_p_5_8:r,b2:n}=cL(t);return Xr(dn(r,BigInt(3),e)*n,e)},adjustScalarBytes:lL,randomBytes:XC});function Nw(t){const{y:e}=wr.ExtendedPoint.fromHex(t),r=BigInt(1);return ra.toBytes(ra.create((r+e)*ra.inv(r-e)))}function Bw(t){const e=Uv.hash(t.subarray(0,32));return Uv.adjustScalarBytes(e).subarray(0,32)}const dce=(ra.ORDER+BigInt(3))/BigInt(8);ra.pow(jx,dce);ra.sqrt(ra.neg(ra.ONE));(ra.ORDER-BigInt(5))/BigInt(8);BigInt(486662);due(ra,ra.neg(BigInt(486664)));BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235");BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578");BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838");BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var Io=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},fce=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let Bg=class md{static bytesToPrivateKey(e){return Io(this,arguments,void 0,function*({privateKeyBytes:r}){const n=wr.getPublicKey(r),s={crv:"Ed25519",d:mr.uint8Array(r).toBase64Url(),kty:"OKP",x:mr.uint8Array(n).toBase64Url()};return s.kid=yield Ln({jwk:s}),s})}static bytesToPublicKey(e){return Io(this,arguments,void 0,function*({publicKeyBytes:r}){const n={kty:"OKP",crv:"Ed25519",x:mr.uint8Array(r).toBase64Url()};return n.kid=yield Ln({jwk:n}),n})}static computePublicKey(e){return Io(this,arguments,void 0,function*({key:r}){const n=yield md.privateKeyToBytes({privateKey:r}),s=wr.getPublicKey(n),i={kty:"OKP",crv:"Ed25519",x:mr.uint8Array(s).toBase64Url()};return i.kid=yield Ln({jwk:i}),i})}static convertPrivateKeyToX25519(e){return Io(this,arguments,void 0,function*({privateKey:r}){const n=yield md.privateKeyToBytes({privateKey:r}),s=Bw(n),i=Oi.getPublicKey(s),o={kty:"OKP",crv:"X25519",d:mr.uint8Array(s).toBase64Url(),x:mr.uint8Array(i).toBase64Url()};return o.kid=yield Ln({jwk:o}),o})}static convertPublicKeyToX25519(e){return Io(this,arguments,void 0,function*({publicKey:r}){const n=yield md.publicKeyToBytes({publicKey:r});if(!(yield md.validatePublicKey({publicKeyBytes:n})))throw new Error("Ed25519: Invalid public key.");const i=Nw(n),o={kty:"OKP",crv:"X25519",x:mr.uint8Array(i).toBase64Url()};return o.kid=yield Ln({jwk:o}),o})}static generateKey(){return Io(this,void 0,void 0,function*(){const e=wr.utils.randomPrivateKey(),r=yield md.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Ln({jwk:r}),r})}static getPublicKey(e){return Io(this,arguments,void 0,function*({key:r}){var n;if(!(rv(r)&&r.crv==="Ed25519"))throw new Error("Ed25519: The provided key is not an Ed25519 private JWK.");let s=fce(r,["d"]);return(n=s.kid)!==null&&n!==void 0||(s.kid=yield Ln({jwk:s})),s})}static privateKeyToBytes(e){return Io(this,arguments,void 0,function*({privateKey:r}){if(!rv(r))throw new Error("Ed25519: The provided key is not a valid OKP private key.");return mr.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return Io(this,arguments,void 0,function*({publicKey:r}){if(!sL(r))throw new Error("Ed25519: The provided key is not a valid OKP public key.");return mr.base64Url(r.x).toUint8Array()})}static sign(e){return Io(this,arguments,void 0,function*({key:r,data:n}){const s=yield md.privateKeyToBytes({privateKey:r});return wr.sign(n,s)})}static validatePublicKey(e){return Io(this,arguments,void 0,function*({publicKeyBytes:r}){try{wr.ExtendedPoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return Io(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=yield md.publicKeyToBytes({publicKey:r});return wr.verify(n,s,i)})}};var Fg=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let hce=class extends AI{computePublicKey(e){return Fg(this,arguments,void 0,function*({key:r}){if(!rv(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":{const n=yield Bg.computePublicKey({key:r});return n.alg="EdDSA",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}generateKey(e){return Fg(this,arguments,void 0,function*({algorithm:r}){switch(r){case"Ed25519":{const n=yield Bg.generateKey();return n.alg="EdDSA",n}}})}getPublicKey(e){return Fg(this,arguments,void 0,function*({key:r}){if(!rv(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":{const n=yield Bg.getPublicKey({key:r});return n.alg="EdDSA",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}sign(e){return Fg(this,arguments,void 0,function*({key:r,data:n}){if(!rv(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":return yield Bg.sign({key:r,data:n});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}verify(e){return Fg(this,arguments,void 0,function*({key:r,signature:n,data:s}){if(!sL(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) public key.");switch(r.crv){case"Ed25519":return yield Bg.verify({key:r,signature:n,data:s});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}};var bc=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};const vT={Ed25519:{implementation:hce,names:["Ed25519"]},secp256k1:{implementation:wB,names:["ES256K","secp256k1"]},secp256r1:{implementation:wB,names:["ES256","secp256r1"]},"SHA-256":{implementation:zae,names:["SHA-256"]}};let pce=class{constructor(e){var r;this._algorithmInstances=new Map,this._keyStore=(r=e==null?void 0:e.keyStore)!==null&&r!==void 0?r:new kae}digest(e){return bc(this,arguments,void 0,function*({algorithm:r,data:n}){return yield this.getAlgorithm({algorithm:r}).digest({algorithm:r,data:n})})}exportKey(e){return bc(this,arguments,void 0,function*({keyUri:r}){return yield this.getPrivateKey({keyUri:r})})}generateKey(e){return bc(this,arguments,void 0,function*({algorithm:r}){const s=yield this.getAlgorithm({algorithm:r}).generateKey({algorithm:r});if((s==null?void 0:s.kid)===void 0)throw new Error("Generated key is missing a required property: kid");const i=`${vB}${s.kid}`;return yield this._keyStore.set(i,s),i})}getKeyUri(e){return bc(this,arguments,void 0,function*({key:r}){const n=yield Ln({jwk:r});return`${vB}${n}`})}getPublicKey(e){return bc(this,arguments,void 0,function*({keyUri:r}){const n=yield this.getPrivateKey({keyUri:r}),s=this.getAlgorithmName({key:n});return yield this.getAlgorithm({algorithm:s}).getPublicKey({key:n})})}importKey(e){return bc(this,arguments,void 0,function*({key:r}){var n;if(!Tue(r))throw new TypeError("Invalid key provided. Must be a private key in JWK format.");const s=structuredClone(r);(n=s.kid)!==null&&n!==void 0||(s.kid=yield Ln({jwk:s}));const i=yield this.getKeyUri({key:s});return yield this._keyStore.set(i,s),i})}sign(e){return bc(this,arguments,void 0,function*({keyUri:r,data:n}){const s=yield this.getPrivateKey({keyUri:r}),i=this.getAlgorithmName({key:s});return this.getAlgorithm({algorithm:i}).sign({data:n,key:s})})}verify(e){return bc(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=this.getAlgorithmName({key:r});return this.getAlgorithm({algorithm:i}).verify({key:r,signature:n,data:s})})}getAlgorithm({algorithm:e}){var r;const n=(r=vT[e])===null||r===void 0?void 0:r.implementation;if(!n)throw new Error(`Algorithm not supported: ${e}`);return this._algorithmInstances.has(n)||this._algorithmInstances.set(n,new n),this._algorithmInstances.get(n)}getAlgorithmName({key:e}){const r=e.alg,n=e.crv;for(const s in vT){const i=vT[s];if(r&&i.names.includes(r))return s;if(n&&i.names.includes(n))return s}throw new Error(`Unable to determine algorithm based on provided input: alg=${r}, crv=${n}`)}getPrivateKey(e){return bc(this,arguments,void 0,function*({keyUri:r}){const n=yield this._keyStore.get(r);if(!n)throw new Error(`Key not found: ${r}`);return n})}};function mce(t){return Fae(t)}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const fL=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4));function hL(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}const yce=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!yce)throw new Error("Non little-endian hardware is not supported");function II(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Ux(t){if(typeof t=="string")t=II(t);else if(hL(t))t=t.slice();else throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function gce(t,e){if(!hL(t))throw new Error("Uint8Array expected");if(t.length!==e)throw new Error(`Uint8Array length ${e} expected`)}function vce(t){return t!=null&&typeof t=="object"&&(t instanceof Uint8Array||t.constructor.name==="Uint8Array")}function wce(t,...e){if(!vce(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function AB(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function _ce(t,e){wce(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const hi=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class bce{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=Ux(e),gce(e,32);const r=hi(e,0),n=hi(e,2),s=hi(e,4),i=hi(e,6),o=hi(e,8),a=hi(e,10),u=hi(e,12),l=hi(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|u<<5)&8065,this.r[8]=(u>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let c=0;c<8;c++)this.pad[c]=hi(e,16+2*c)}process(e,r,n=!1){const s=n?0:2048,{h:i,r:o}=this,a=o[0],u=o[1],l=o[2],c=o[3],d=o[4],h=o[5],f=o[6],p=o[7],m=o[8],E=o[9],A=hi(e,r+0),_=hi(e,r+2),g=hi(e,r+4),v=hi(e,r+6),S=hi(e,r+8),x=hi(e,r+10),D=hi(e,r+12),w=hi(e,r+14);let b=i[0]+(A&8191),T=i[1]+((A>>>13|_<<3)&8191),P=i[2]+((_>>>10|g<<6)&8191),C=i[3]+((g>>>7|v<<9)&8191),k=i[4]+((v>>>4|S<<12)&8191),K=i[5]+(S>>>1&8191),L=i[6]+((S>>>14|x<<2)&8191),q=i[7]+((x>>>11|D<<5)&8191),se=i[8]+((D>>>8|w<<8)&8191),X=i[9]+(w>>>5|s),re=0,W=re+b*a+T*(5*E)+P*(5*m)+C*(5*p)+k*(5*f);re=W>>>13,W&=8191,W+=K*(5*h)+L*(5*d)+q*(5*c)+se*(5*l)+X*(5*u),re+=W>>>13,W&=8191;let B=re+b*u+T*a+P*(5*E)+C*(5*m)+k*(5*p);re=B>>>13,B&=8191,B+=K*(5*f)+L*(5*h)+q*(5*d)+se*(5*c)+X*(5*l),re+=B>>>13,B&=8191;let te=re+b*l+T*u+P*a+C*(5*E)+k*(5*m);re=te>>>13,te&=8191,te+=K*(5*p)+L*(5*f)+q*(5*h)+se*(5*d)+X*(5*c),re+=te>>>13,te&=8191;let z=re+b*c+T*l+P*u+C*a+k*(5*E);re=z>>>13,z&=8191,z+=K*(5*m)+L*(5*p)+q*(5*f)+se*(5*h)+X*(5*d),re+=z>>>13,z&=8191;let $=re+b*d+T*c+P*l+C*u+k*a;re=$>>>13,$&=8191,$+=K*(5*E)+L*(5*m)+q*(5*p)+se*(5*f)+X*(5*h),re+=$>>>13,$&=8191;let F=re+b*h+T*d+P*c+C*l+k*u;re=F>>>13,F&=8191,F+=K*a+L*(5*E)+q*(5*m)+se*(5*p)+X*(5*f),re+=F>>>13,F&=8191;let ee=re+b*f+T*h+P*d+C*c+k*l;re=ee>>>13,ee&=8191,ee+=K*u+L*a+q*(5*E)+se*(5*m)+X*(5*p),re+=ee>>>13,ee&=8191;let ne=re+b*p+T*f+P*h+C*d+k*c;re=ne>>>13,ne&=8191,ne+=K*l+L*u+q*a+se*(5*E)+X*(5*m),re+=ne>>>13,ne&=8191;let le=re+b*m+T*p+P*f+C*h+k*d;re=le>>>13,le&=8191,le+=K*c+L*l+q*u+se*a+X*(5*E),re+=le>>>13,le&=8191;let me=re+b*E+T*m+P*p+C*f+k*h;re=me>>>13,me&=8191,me+=K*d+L*c+q*l+se*u+X*a,re+=me>>>13,me&=8191,re=(re<<2)+re|0,re=re+W|0,W=re&8191,re=re>>>13,B+=re,i[0]=W,i[1]=B,i[2]=te,i[3]=z,i[4]=$,i[5]=F,i[6]=ee,i[7]=ne,i[8]=le,i[9]=me}finalize(){const{h:e,pad:r}=this,n=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,n[0]=e[0]+5,s=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+s,s=n[a]>>>13,n[a]&=8191;n[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)n[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+r[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+r[a]|0)+(o>>>16)|0,e[a]=o&65535}update(e){AB(this);const{buffer:r,blockLen:n}=this;e=Ux(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);if(o===n){for(;n<=s-i;i+=n)this.process(e,i);continue}r.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(e){AB(this),_ce(e,this),this.finished=!0;const{buffer:r,h:n}=this;let{pos:s}=this;if(s){for(r[s++]=1;s<16;s++)r[s]=0;this.process(r,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=n[o]>>>0,e[i++]=n[o]>>>8;return e}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}}function Ece(t){const e=(n,s)=>t(s).update(Ux(n)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}Ece(t=>new bce(t));const Ace=II("expand 16-byte k"),Sce=II("expand 32-byte k");fL(Ace);fL(Sce);var Lv;(function(t){t.authentication="authentication",t.assertionMethod="assertionMethod",t.keyAgreement="keyAgreement",t.capabilityInvocation="capabilityInvocation",t.capabilityDelegation="capabilityDelegation"})(Lv||(Lv={}));const Ri={"@context":"https://w3id.org/did-resolution/v1",didResolutionMetadata:{},didDocument:null,didDocumentMetadata:{}};let _r=class pL{constructor({method:e,id:r,path:n,query:s,fragment:i,params:o}){this.uri=`did:${e}:${r}`,this.method=e,this.id=r,this.path=n,this.query=s,this.fragment=i,this.params=o}static parse(e){if(!e)return null;const r=pL.DID_URI_PATTERN.exec(e);if(!r||!r.groups)return null;const{method:n,id:s,path:i,query:o,fragment:a}=r.groups,u={uri:`did:${n}:${s}`,method:n,id:s};if(i&&(u.path=i),o&&(u.query=o.slice(1)),a&&(u.fragment=a.slice(1)),o){const l={},c=o.slice(1).split("&");for(const d of c){const[h,f]=d.split("=");l[h]=f}u.params=l}return u}};_r.METHOD_PATTERN="([a-z0-9]+)";_r.PCT_ENCODED_PATTERN="(?:%[0-9a-fA-F]{2})";_r.ID_CHAR_PATTERN=`(?:[a-zA-Z0-9._-]|${_r.PCT_ENCODED_PATTERN})`;_r.METHOD_ID_PATTERN=`((?:${_r.ID_CHAR_PATTERN}*:)*(${_r.ID_CHAR_PATTERN}+))`;_r.PATH_PATTERN="(/[^#?]*)?";_r.QUERY_PATTERN="([?][^#]*)?";_r.FRAGMENT_PATTERN="(#.*)?";_r.DID_URI_PATTERN=new RegExp(`^did:(?<method>${_r.METHOD_PATTERN}):(?<id>${_r.METHOD_ID_PATTERN})(?<path>${_r.PATH_PATTERN})(?<query>${_r.QUERY_PATTERN})(?<fragment>${_r.FRAGMENT_PATTERN})$`);let ht=class mL extends Error{constructor(e,r){super(`${e}: ${r}`),this.code=e,this.name="DidError",Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,mL)}};var st;(function(t){t.InvalidDid="invalidDid",t.MethodNotSupported="methodNotSupported",t.InternalError="internalError",t.InvalidDidDocument="invalidDidDocument",t.InvalidDidDocumentLength="invalidDidDocumentLength",t.InvalidDidUrl="invalidDidUrl",t.InvalidPreviousDidProof="invalidPreviousDidProof",t.InvalidPublicKey="invalidPublicKey",t.InvalidPublicKeyLength="invalidPublicKeyLength",t.InvalidPublicKeyType="invalidPublicKeyType",t.InvalidSignature="invalidSignature",t.NotFound="notFound",t.RepresentationNotSupported="representationNotSupported",t.UnsupportedPublicKeyType="unsupportedPublicKeyType"})(st||(st={}));function Tce(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,u=t.charAt(0),l=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var m=0,E=0,A=0,_=p.length;A!==_&&p[A]===0;)A++,m++;for(var g=(_-A)*c+1>>>0,v=new Uint8Array(g);A!==_;){for(var S=p[A],x=0,D=g-1;(S!==0||x<E)&&D!==-1;D--,x++)S+=256*v[D]>>>0,v[D]=S%a>>>0,S=S/a>>>0;if(S!==0)throw new Error("Non-zero carry");E=x,A++}for(var w=g-E;w!==g&&v[w]===0;)w++;for(var b=u.repeat(m);w<g;++w)b+=t.charAt(v[w]);return b}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var m=0;if(p[m]!==" "){for(var E=0,A=0;p[m]===u;)E++,m++;for(var _=(p.length-m)*l+1>>>0,g=new Uint8Array(_);p[m];){var v=r[p.charCodeAt(m)];if(v===255)return;for(var S=0,x=_-1;(v!==0||S<A)&&x!==-1;x--,S++)v+=a*g[x]>>>0,g[x]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");A=S,m++}if(p[m]!==" "){for(var D=_-A;D!==_&&g[D]===0;)D++;for(var w=new Uint8Array(E+(_-D)),b=E;D!==_;)w[b++]=g[D++];return w}}}function f(p){var m=h(p);if(m)return m;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var Dce=Tce,xce=Dce;const Pce=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};let Cce=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Ice=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return yL(this,e)}},kce=class{constructor(e){this.decoders=e}or(e){return yL(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const yL=(t,e)=>new kce({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let $ce=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new Cce(e,r,n),this.decoder=new Ice(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const gL=({name:t,prefix:e,encode:r,decode:n})=>new $ce(t,e,r,n),vL=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:s}=xce(r,e);return gL({prefix:t,name:e,encode:n,decode:i=>Pce(s(i))})},Oce=(t,e,r,n)=>{const s={};for(let c=0;c<e.length;++c)s[e[c]]=c;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,u=0,l=0;for(let c=0;c<i;++c){const d=s[t[c]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);u=u<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&u>>a)}if(a>=r||255&u<<8-a)throw new SyntaxError("Unexpected end of data");return o},Rce=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let u=0;u<t.length;++u)for(a=a<<8|t[u],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},vo=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>gL({prefix:e,name:t,encode(s){return Rce(s,n,r)},decode(s){return Oce(s,n,r,t)}});vo({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});vo({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});vo({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});vo({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});vo({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});vo({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});vo({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});vo({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});const SB=vo({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),sb=vL({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});vL({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});vo({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});vo({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const Ec=vo({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});vo({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function Nce(t){return t.byteOffset!==0||t.byteLength!==t.buffer.byteLength}function Bce(t){return typeof t!="object"||t===null?!1:typeof t[Symbol.asyncIterator]=="function"}function Lx(t){const r=Object.prototype.toString.call(t).match(/\s([a-zA-Z0-9]+)/),[n,s]=r;return s}var Mg=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},TB=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(o){return new Promise(function(a,u){o=t[i](o),s(a,u,o.done,o.value)})}}function s(i,o,a,u){Promise.resolve(u).then(function(l){i({value:l,done:a})},o)}};const ob=new TextEncoder,th=new TextDecoder;let vt=class Ss{constructor(e,r){this.data=e,this.format=r}static arrayBuffer(e){return new Ss(e,"ArrayBuffer")}static asyncIterable(e){if(!Bce(e))throw new TypeError("Input must be of type AsyncIterable.");return new Ss(e,"AsyncIterable")}static base32Z(e){return new Ss(e,"Base32Z")}static base58Btc(e){return new Ss(e,"Base58Btc")}static base64Url(e){return new Ss(e,"Base64Url")}static bufferSource(e){return new Ss(e,"BufferSource")}static hex(e){if(typeof e!="string")throw new TypeError("Hex input must be a string.");if(e.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new Ss(e,"Hex")}static multibase(e){return new Ss(e,"Multibase")}static object(e){return new Ss(e,"Object")}static string(e){return new Ss(e,"String")}static uint8Array(e){return new Ss(e,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return sb.baseDecode(this.data).buffer;case"Base64Url":return Ec.baseDecode(this.data).buffer;case"BufferSource":{if(Lx(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return Nce(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return Mg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return SB.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return sb.baseEncode(e)}case"Multibase":return this.data.substring(1);case"Uint8Array":return sb.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return Ec.baseEncode(e)}case"BufferSource":{const e=this.toUint8Array();return Ec.baseEncode(e)}case"Object":{const e=JSON.stringify(this.data),r=ob.encode(e);return Ec.baseEncode(r)}case"String":{const e=ob.encode(this.data);return Ec.baseEncode(e)}case"Uint8Array":return Ec.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){var e,r,n,s;return Mg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const u=[];try{for(var i=!0,o=TB(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const c=s;u.push(c)}}catch(c){r={error:c}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return new Blob(u)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){const e=Array.from({length:256},(r,n)=>n.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{const r=this.toUint8Array();return Ss.uint8Array(r).toHex()}case"Base64Url":{const r=this.toUint8Array();return Ss.uint8Array(r).toHex()}case"Uint8Array":{let r="";for(let n=0;n<this.data.length;n++)r+=e[this.data[n]];return r}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{const e=Ec.baseDecode(this.data),r=th.decode(e);return JSON.parse(r)}case"String":return JSON.parse(this.data);case"Uint8Array":{const e=th.decode(this.data);return JSON.parse(e)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return Mg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toStringAsync();return JSON.parse(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return th.decode(this.data);case"Base64Url":{const e=Ec.baseDecode(this.data);return th.decode(e)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return th.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){var e,r,n,s;return Mg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let u="";try{for(var i=!0,o=TB(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const l=s;typeof l=="string"?u+=l:u+=th.decode(l,{stream:!0})}}catch(l){r={error:l}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return u+=th.decode(void 0,{stream:!1}),u}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return SB.baseDecode(this.data);case"Base58Btc":return sb.baseDecode(this.data);case"Base64Url":return Ec.baseDecode(this.data);case"BufferSource":{const e=Lx(this.data);if(e==="Uint8Array")return this.data;if(e==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{const e=new Uint8Array(this.data.length/2);for(let r=0;r<this.data.length;r+=2){const n=parseInt(this.data.substring(r,r+2),16);if(isNaN(n))throw new TypeError("Input is not a valid hexadecimal string.");e[r/2]=n}return e}case"Object":{const e=JSON.stringify(this.data);return ob.encode(e)}case"String":return ob.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return Mg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toArrayBufferAsync();return new Uint8Array(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}};var Fce=wL,DB=128,Mce=127,jce=~Mce,Uce=Math.pow(2,31);function wL(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Uce;)e[r++]=t&255|DB,t/=128;for(;t&jce;)e[r++]=t&255|DB,t>>>=7;return e[r]=t|0,wL.bytes=r-n+1,e}var Lce=Kx,Kce=128,xB=127;function Kx(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw Kx.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&xB)<<s:(o&xB)*Math.pow(2,s),s+=7}while(o>=Kce);return Kx.bytes=i-n,r}var Vce=Math.pow(2,7),qce=Math.pow(2,14),Hce=Math.pow(2,21),zce=Math.pow(2,28),Wce=Math.pow(2,35),Gce=Math.pow(2,42),Jce=Math.pow(2,49),Xce=Math.pow(2,56),Yce=Math.pow(2,63),Zce=function(t){return t<Vce?1:t<qce?2:t<Hce?3:t<zce?4:t<Wce?5:t<Gce?6:t<Jce?7:t<Xce?8:t<Yce?9:10},Qce={encode:Fce,decode:Lce,encodingLength:Zce},PE=Qce;const PB=(t,e=0)=>[PE.decode(t,e),PE.decode.bytes],ele=(t,e,r=0)=>(PE.encode(t,e,r),e),tle=t=>PE.encodingLength(t);let aa=class yd{static addPrefix(e){var r;let{code:n,data:s,name:i}=e;if(!(i?!n:n))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(n=yd.codeToName.has(n)?n:yd.nameToCode.get(i),n===void 0)throw new Error(`Unsupported multicodec: ${(r=e.name)!==null&&r!==void 0?r:e.code}`);const o=tle(n),a=new Uint8Array(o+s.byteLength);return a.set(s,o),ele(n,a),a}static getCodeFromData(e){const{prefixedData:r}=e,[n,s]=PB(r);return n}static getCodeFromName(e){const{name:r}=e,n=yd.nameToCode.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static getNameFromCode(e){const{code:r}=e,n=yd.codeToName.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static registerCodec(e){yd.codeToName.set(e.code,e.name),yd.nameToCode.set(e.name,e.code)}static removePrefix(e){const{prefixedData:r}=e,[n,s]=PB(r),i=yd.codeToName.get(n);if(i===void 0)throw new Error(`Unsupported multicodec: ${n}`);return{code:n,data:r.slice(s),name:i}}};aa.codeToName=new Map;aa.nameToCode=new Map;aa.registerCodec({code:237,name:"ed25519-pub"});aa.registerCodec({code:4864,name:"ed25519-priv"});aa.registerCodec({code:236,name:"x25519-pub"});aa.registerCodec({code:4866,name:"x25519-priv"});aa.registerCodec({code:231,name:"secp256k1-pub"});aa.registerCodec({code:4865,name:"secp256k1-priv"});function _L(t){Object.keys(t).forEach(e=>{t[e]===void 0?delete t[e]:typeof t[e]=="object"&&_L(t[e])})}var rh=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let rle=class{constructor(){this.store=new Map}clear(){return rh(this,void 0,void 0,function*(){this.store.clear()})}close(){return rh(this,void 0,void 0,function*(){})}delete(e){return rh(this,void 0,void 0,function*(){return this.store.delete(e)})}get(e){return rh(this,void 0,void 0,function*(){return this.store.get(e)})}has(e){return rh(this,void 0,void 0,function*(){return this.store.has(e)})}list(){return rh(this,void 0,void 0,function*(){return Array.from(this.store.values())})}set(e,r){return rh(this,void 0,void 0,function*(){this.store.set(e,r)})}};var nle=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let bL=class{static digest({data:e}){return nle(this,void 0,void 0,function*(){return pf(e)})}},kI=class{};var ile=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let sle=class extends kI{digest({algorithm:e,data:r}){return ile(this,void 0,void 0,function*(){switch(e){case"SHA-256":return yield bL.digest({data:r})}})}};function ole(t){const e=n=>{if(n!==null&&typeof n=="object"&&!Array.isArray(n)){const s=Object.keys(n).sort(),i={};for(const o of s)i[o]=e(n[o]);return i}return n},r=e(t);return JSON.stringify(r)}var ale=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};const CB="urn:jwk:";function Rr({jwk:t}){return ale(this,void 0,void 0,function*(){const e=t.kty;let r;if(e==="EC")r={crv:t.crv,kty:t.kty,x:t.x,y:t.y};else if(e==="oct")r={k:t.k,kty:t.kty};else if(e==="OKP")r={crv:t.crv,kty:t.kty,x:t.x};else if(e==="RSA")r={e:t.e,kty:t.kty,n:t.n};else throw new Error(`Unsupported key type: ${e}`);_L(r);const n=ole(r),s=vt.string(n).toUint8Array(),i=yield bL.digest({data:s});return vt.uint8Array(i).toBase64Url()})}function tp(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="EC"||typeof t.d!="string"||typeof t.x!="string")}function $I(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t)||"d"in t||t.kty!=="EC"||typeof t.x!="string")}function rp(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="OKP"||typeof t.d!="string"||typeof t.x!="string")}function OI(t){return!(!t||typeof t!="object"||"d"in t||!("kty"in t&&"crv"in t&&"x"in t)||t.kty!=="OKP"||typeof t.x!="string")}function ule(t){if(!t||typeof t!="object")return!1;switch(t.kty){case"EC":case"OKP":case"RSA":return"d"in t;case"oct":return"k"in t;default:return!1}}var pi=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},cle=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let lo=class uu{static adjustSignatureToLowS({signature:e}){return pi(this,void 0,void 0,function*(){const r=et.Signature.fromCompact(e);return r.hasHighS()?r.normalizeS().toCompactRawBytes():e})}static bytesToPrivateKey({privateKeyBytes:e}){return pi(this,void 0,void 0,function*(){const r=yield uu.getCurvePoint({keyBytes:e}),n={kty:"EC",crv:"secp256k1",d:vt.uint8Array(e).toBase64Url(),x:vt.uint8Array(r.x).toBase64Url(),y:vt.uint8Array(r.y).toBase64Url()};return n.kid=yield Rr({jwk:n}),n})}static bytesToPublicKey({publicKeyBytes:e}){return pi(this,void 0,void 0,function*(){const r=yield uu.getCurvePoint({keyBytes:e}),n={kty:"EC",crv:"secp256k1",x:vt.uint8Array(r.x).toBase64Url(),y:vt.uint8Array(r.y).toBase64Url()};return n.kid=yield Rr({jwk:n}),n})}static compressPublicKey({publicKeyBytes:e}){return pi(this,void 0,void 0,function*(){return et.ProjectivePoint.fromHex(e).toRawBytes(!0)})}static computePublicKey({key:e}){return pi(this,void 0,void 0,function*(){const r=yield uu.privateKeyToBytes({privateKey:e}),n=yield uu.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"secp256k1",x:vt.uint8Array(n.x).toBase64Url(),y:vt.uint8Array(n.y).toBase64Url()};return s.kid=yield Rr({jwk:s}),s})}static convertDerToCompactSignature({derSignature:e}){return pi(this,void 0,void 0,function*(){return et.Signature.fromDER(e).toCompactRawBytes()})}static decompressPublicKey({publicKeyBytes:e}){return pi(this,void 0,void 0,function*(){return et.ProjectivePoint.fromHex(e).toRawBytes(!1)})}static generateKey(){return pi(this,void 0,void 0,function*(){const e=et.utils.randomPrivateKey(),r=yield uu.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Rr({jwk:r}),r})}static getPublicKey({key:e}){var r;return pi(this,void 0,void 0,function*(){if(!(tp(e)&&e.crv==="secp256k1"))throw new Error("Secp256k1: The provided key is not a secp256k1 private JWK.");let n=cle(e,["d"]);return(r=n.kid)!==null&&r!==void 0||(n.kid=yield Rr({jwk:n})),n})}static privateKeyToBytes({privateKey:e}){return pi(this,void 0,void 0,function*(){if(!tp(e))throw new Error("Secp256k1: The provided key is not a valid EC private key.");return vt.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return pi(this,void 0,void 0,function*(){if(!($I(e)&&e.y))throw new Error("Secp256k1: The provided key is not a valid EC public key.");const r=new Uint8Array([4]),n=vt.base64Url(e.x).toUint8Array(),s=vt.base64Url(e.y).toUint8Array();return new Uint8Array([...r,...n,...s])})}static sharedSecret({privateKeyA:e,publicKeyB:r}){return pi(this,void 0,void 0,function*(){if("x"in e&&"x"in r&&e.x===r.x)throw new Error("Secp256k1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const n=yield uu.privateKeyToBytes({privateKey:e}),s=yield uu.publicKeyToBytes({publicKey:r});return et.getSharedSecret(n,s,!0).slice(1)})}static sign({data:e,key:r}){return pi(this,void 0,void 0,function*(){const n=yield uu.privateKeyToBytes({privateKey:r}),s=pf(e);return et.sign(s,n).toCompactRawBytes()})}static validatePrivateKey({privateKeyBytes:e}){return pi(this,void 0,void 0,function*(){return et.utils.isValidPrivateKey(e)})}static validatePublicKey({publicKeyBytes:e}){return pi(this,void 0,void 0,function*(){try{et.ProjectivePoint.fromHex(e).assertValidity()}catch{return!1}return!0})}static verify({key:e,signature:r,data:n}){return pi(this,void 0,void 0,function*(){const s=yield uu.publicKeyToBytes({publicKey:e}),i=pf(n);return et.verify(r,i,s,{lowS:!1})})}static getCurvePoint({keyBytes:e}){return pi(this,void 0,void 0,function*(){e.byteLength===32&&(e=et.getPublicKey(e));const r=et.ProjectivePoint.fromHex(e),n=Yr(r.x,32),s=Yr(r.y,32);return{x:n,y:s}})}};var mi=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},lle=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let Xo=class cu{static adjustSignatureToLowS({signature:e}){return mi(this,void 0,void 0,function*(){const r=tt.Signature.fromCompact(e);return r.hasHighS()?r.normalizeS().toCompactRawBytes():e})}static bytesToPrivateKey({privateKeyBytes:e}){return mi(this,void 0,void 0,function*(){const r=yield cu.getCurvePoint({keyBytes:e}),n={kty:"EC",crv:"P-256",d:vt.uint8Array(e).toBase64Url(),x:vt.uint8Array(r.x).toBase64Url(),y:vt.uint8Array(r.y).toBase64Url()};return n.kid=yield Rr({jwk:n}),n})}static bytesToPublicKey({publicKeyBytes:e}){return mi(this,void 0,void 0,function*(){const r=yield cu.getCurvePoint({keyBytes:e}),n={kty:"EC",crv:"P-256",x:vt.uint8Array(r.x).toBase64Url(),y:vt.uint8Array(r.y).toBase64Url()};return n.kid=yield Rr({jwk:n}),n})}static compressPublicKey({publicKeyBytes:e}){return mi(this,void 0,void 0,function*(){return tt.ProjectivePoint.fromHex(e).toRawBytes(!0)})}static computePublicKey({key:e}){return mi(this,void 0,void 0,function*(){const r=yield cu.privateKeyToBytes({privateKey:e}),n=yield cu.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"P-256",x:vt.uint8Array(n.x).toBase64Url(),y:vt.uint8Array(n.y).toBase64Url()};return s.kid=yield Rr({jwk:s}),s})}static convertDerToCompactSignature({derSignature:e}){return mi(this,void 0,void 0,function*(){return tt.Signature.fromDER(e).toCompactRawBytes()})}static decompressPublicKey({publicKeyBytes:e}){return mi(this,void 0,void 0,function*(){return tt.ProjectivePoint.fromHex(e).toRawBytes(!1)})}static generateKey(){return mi(this,void 0,void 0,function*(){const e=tt.utils.randomPrivateKey(),r=yield cu.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Rr({jwk:r}),r})}static getPublicKey({key:e}){var r;return mi(this,void 0,void 0,function*(){if(!(tp(e)&&e.crv==="P-256"))throw new Error("Secp256r1: The provided key is not a 'P-256' private JWK.");let n=lle(e,["d"]);return(r=n.kid)!==null&&r!==void 0||(n.kid=yield Rr({jwk:n})),n})}static privateKeyToBytes({privateKey:e}){return mi(this,void 0,void 0,function*(){if(!tp(e))throw new Error("Secp256r1: The provided key is not a valid EC private key.");return vt.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return mi(this,void 0,void 0,function*(){if(!($I(e)&&e.y))throw new Error("Secp256r1: The provided key is not a valid EC public key.");const r=new Uint8Array([4]),n=vt.base64Url(e.x).toUint8Array(),s=vt.base64Url(e.y).toUint8Array();return new Uint8Array([...r,...n,...s])})}static sharedSecret({privateKeyA:e,publicKeyB:r}){return mi(this,void 0,void 0,function*(){if("x"in e&&"x"in r&&e.x===r.x)throw new Error("Secp256r1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const n=yield cu.privateKeyToBytes({privateKey:e}),s=yield cu.publicKeyToBytes({publicKey:r});return tt.getSharedSecret(n,s,!0).slice(1)})}static sign({data:e,key:r}){return mi(this,void 0,void 0,function*(){const n=yield cu.privateKeyToBytes({privateKey:r}),s=pf(e);return tt.sign(s,n).toCompactRawBytes()})}static validatePrivateKey({privateKeyBytes:e}){return mi(this,void 0,void 0,function*(){return tt.utils.isValidPrivateKey(e)})}static validatePublicKey({publicKeyBytes:e}){return mi(this,void 0,void 0,function*(){try{tt.ProjectivePoint.fromHex(e).assertValidity()}catch{return!1}return!0})}static verify({key:e,signature:r,data:n}){return mi(this,void 0,void 0,function*(){const s=yield cu.publicKeyToBytes({publicKey:e}),i=pf(n);return tt.verify(r,i,s,{lowS:!1})})}static getCurvePoint({keyBytes:e}){return mi(this,void 0,void 0,function*(){e.byteLength===32&&(e=tt.getPublicKey(e));const r=tt.ProjectivePoint.fromHex(e),n=Yr(r.x,32),s=Yr(r.y,32);return{x:n,y:s}})}};var jg=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let IB=class extends kI{computePublicKey({key:e}){return jg(this,void 0,void 0,function*(){if(!tp(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(e.crv){case"secp256k1":{const r=yield lo.computePublicKey({key:e});return r.alg="ES256K",r}case"P-256":{const r=yield Xo.computePublicKey({key:e});return r.alg="ES256",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}generateKey({algorithm:e}){return jg(this,void 0,void 0,function*(){switch(e){case"ES256K":case"secp256k1":{const r=yield lo.generateKey();return r.alg="ES256K",r}case"ES256":case"secp256r1":{const r=yield Xo.generateKey();return r.alg="ES256",r}}})}getPublicKey({key:e}){return jg(this,void 0,void 0,function*(){if(!tp(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(e.crv){case"secp256k1":{const r=yield lo.getPublicKey({key:e});return r.alg="ES256K",r}case"P-256":{const r=yield Xo.getPublicKey({key:e});return r.alg="ES256",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}sign({key:e,data:r}){return jg(this,void 0,void 0,function*(){if(!tp(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(e.crv){case"secp256k1":return yield lo.sign({key:e,data:r});case"P-256":return yield Xo.sign({key:e,data:r});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}verify({key:e,signature:r,data:n}){return jg(this,void 0,void 0,function*(){if(!$I(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) public key.");switch(e.crv){case"secp256k1":return yield lo.verify({key:e,signature:r,data:n});case"P-256":return yield Xo.verify({key:e,signature:r,data:n});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}};var ko=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},dle=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let Bs=class gd{static bytesToPrivateKey({privateKeyBytes:e}){return ko(this,void 0,void 0,function*(){const r=wr.getPublicKey(e),n={crv:"Ed25519",d:vt.uint8Array(e).toBase64Url(),kty:"OKP",x:vt.uint8Array(r).toBase64Url()};return n.kid=yield Rr({jwk:n}),n})}static bytesToPublicKey({publicKeyBytes:e}){return ko(this,void 0,void 0,function*(){const r={kty:"OKP",crv:"Ed25519",x:vt.uint8Array(e).toBase64Url()};return r.kid=yield Rr({jwk:r}),r})}static computePublicKey({key:e}){return ko(this,void 0,void 0,function*(){const r=yield gd.privateKeyToBytes({privateKey:e}),n=wr.getPublicKey(r),s={kty:"OKP",crv:"Ed25519",x:vt.uint8Array(n).toBase64Url()};return s.kid=yield Rr({jwk:s}),s})}static convertPrivateKeyToX25519({privateKey:e}){return ko(this,void 0,void 0,function*(){const r=yield gd.privateKeyToBytes({privateKey:e}),n=Bw(r),s=Oi.getPublicKey(n),i={kty:"OKP",crv:"X25519",d:vt.uint8Array(n).toBase64Url(),x:vt.uint8Array(s).toBase64Url()};return i.kid=yield Rr({jwk:i}),i})}static convertPublicKeyToX25519({publicKey:e}){return ko(this,void 0,void 0,function*(){const r=yield gd.publicKeyToBytes({publicKey:e});if(!(yield gd.validatePublicKey({publicKeyBytes:r})))throw new Error("Ed25519: Invalid public key.");const s=Nw(r),i={kty:"OKP",crv:"X25519",x:vt.uint8Array(s).toBase64Url()};return i.kid=yield Rr({jwk:i}),i})}static generateKey(){return ko(this,void 0,void 0,function*(){const e=wr.utils.randomPrivateKey(),r=yield gd.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Rr({jwk:r}),r})}static getPublicKey({key:e}){var r;return ko(this,void 0,void 0,function*(){if(!(rp(e)&&e.crv==="Ed25519"))throw new Error("Ed25519: The provided key is not an Ed25519 private JWK.");let n=dle(e,["d"]);return(r=n.kid)!==null&&r!==void 0||(n.kid=yield Rr({jwk:n})),n})}static privateKeyToBytes({privateKey:e}){return ko(this,void 0,void 0,function*(){if(!rp(e))throw new Error("Ed25519: The provided key is not a valid OKP private key.");return vt.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return ko(this,void 0,void 0,function*(){if(!OI(e))throw new Error("Ed25519: The provided key is not a valid OKP public key.");return vt.base64Url(e.x).toUint8Array()})}static sign({key:e,data:r}){return ko(this,void 0,void 0,function*(){const n=yield gd.privateKeyToBytes({privateKey:e});return wr.sign(r,n)})}static validatePublicKey({publicKeyBytes:e}){return ko(this,void 0,void 0,function*(){try{wr.ExtendedPoint.fromHex(e).assertValidity()}catch{return!1}return!0})}static verify({key:e,signature:r,data:n}){return ko(this,void 0,void 0,function*(){const s=yield gd.publicKeyToBytes({publicKey:e});return wr.verify(r,n,s)})}};var Ug=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let fle=class extends kI{computePublicKey({key:e}){return Ug(this,void 0,void 0,function*(){if(!rp(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(e.crv){case"Ed25519":{const r=yield Bs.computePublicKey({key:e});return r.alg="EdDSA",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}generateKey({algorithm:e}){return Ug(this,void 0,void 0,function*(){switch(e){case"Ed25519":{const r=yield Bs.generateKey();return r.alg="EdDSA",r}}})}getPublicKey({key:e}){return Ug(this,void 0,void 0,function*(){if(!rp(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(e.crv){case"Ed25519":{const r=yield Bs.getPublicKey({key:e});return r.alg="EdDSA",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}sign({key:e,data:r}){return Ug(this,void 0,void 0,function*(){if(!rp(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(e.crv){case"Ed25519":return yield Bs.sign({key:e,data:r});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}verify({key:e,signature:r,data:n}){return Ug(this,void 0,void 0,function*(){if(!OI(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) public key.");switch(e.crv){case"Ed25519":return yield Bs.verify({key:e,signature:r,data:n});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}};var Ac=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};const wT={Ed25519:{implementation:fle,names:["Ed25519"]},secp256k1:{implementation:IB,names:["ES256K","secp256k1"]},secp256r1:{implementation:IB,names:["ES256","secp256r1"]},"SHA-256":{implementation:sle,names:["SHA-256"]}};let ml=class{constructor(e){var r;this._algorithmInstances=new Map,this._keyStore=(r=e==null?void 0:e.keyStore)!==null&&r!==void 0?r:new rle}digest({algorithm:e,data:r}){return Ac(this,void 0,void 0,function*(){return yield this.getAlgorithm({algorithm:e}).digest({algorithm:e,data:r})})}exportKey({keyUri:e}){return Ac(this,void 0,void 0,function*(){return yield this.getPrivateKey({keyUri:e})})}generateKey({algorithm:e}){return Ac(this,void 0,void 0,function*(){const n=yield this.getAlgorithm({algorithm:e}).generateKey({algorithm:e});if((n==null?void 0:n.kid)===void 0)throw new Error("Generated key is missing a required property: kid");const s=`${CB}${n.kid}`;return yield this._keyStore.set(s,n),s})}getKeyUri({key:e}){return Ac(this,void 0,void 0,function*(){const r=yield Rr({jwk:e});return`${CB}${r}`})}getPublicKey({keyUri:e}){return Ac(this,void 0,void 0,function*(){const r=yield this.getPrivateKey({keyUri:e}),n=this.getAlgorithmName({key:r});return yield this.getAlgorithm({algorithm:n}).getPublicKey({key:r})})}importKey({key:e}){var r;return Ac(this,void 0,void 0,function*(){if(!ule(e))throw new TypeError("Invalid key provided. Must be a private key in JWK format.");const n=structuredClone(e);(r=n.kid)!==null&&r!==void 0||(n.kid=yield Rr({jwk:n}));const s=yield this.getKeyUri({key:n});return yield this._keyStore.set(s,n),s})}sign({keyUri:e,data:r}){return Ac(this,void 0,void 0,function*(){const n=yield this.getPrivateKey({keyUri:e}),s=this.getAlgorithmName({key:n});return this.getAlgorithm({algorithm:s}).sign({data:r,key:n})})}verify({key:e,signature:r,data:n}){return Ac(this,void 0,void 0,function*(){const s=this.getAlgorithmName({key:e});return this.getAlgorithm({algorithm:s}).verify({key:e,signature:r,data:n})})}getAlgorithm({algorithm:e}){var r;const n=(r=wT[e])===null||r===void 0?void 0:r.implementation;if(!n)throw new Error(`Algorithm not supported: ${e}`);return this._algorithmInstances.has(n)||this._algorithmInstances.set(n,new n),this._algorithmInstances.get(n)}getAlgorithmName({key:e}){const r=e.alg,n=e.crv;for(const s in wT){const i=wT[s];if(r&&i.names.includes(r))return s;if(n&&i.names.includes(n))return s}throw new Error(`Unable to determine algorithm based on provided input: alg=${r}, crv=${n}`)}getPrivateKey({keyUri:e}){return Ac(this,void 0,void 0,function*(){const r=yield this._keyStore.get(e);if(!r)throw new Error(`Key not found: ${e}`);return r})}};function hle(t){const e={Ed25519:"EdDSA","P-256":"ES256","P-384":"ES384","P-521":"ES512",secp256k1:"ES256K"};if(t.alg&&Object.values(e).includes(t.alg))return t.alg;if(t.crv&&Object.keys(e).includes(t.crv))return e[t.crv];throw new Error(`Unable to determine algorithm based on provided input: alg=${t.alg}, crv=${t.crv}. Supported 'alg' values: ${Object.values(e).join(", ")}. Supported 'crv' values: ${Object.keys(e).join(", ")}.`)}var Gl=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},ple=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let EL=class S0{static bytesToPrivateKey({privateKeyBytes:e}){return Gl(this,void 0,void 0,function*(){const r=Oi.getPublicKey(e),n={kty:"OKP",crv:"X25519",d:vt.uint8Array(e).toBase64Url(),x:vt.uint8Array(r).toBase64Url()};return n.kid=yield Rr({jwk:n}),n})}static bytesToPublicKey({publicKeyBytes:e}){return Gl(this,void 0,void 0,function*(){const r={kty:"OKP",crv:"X25519",x:vt.uint8Array(e).toBase64Url()};return r.kid=yield Rr({jwk:r}),r})}static computePublicKey({key:e}){return Gl(this,void 0,void 0,function*(){const r=yield S0.privateKeyToBytes({privateKey:e}),n=Oi.getPublicKey(r),s={kty:"OKP",crv:"X25519",x:vt.uint8Array(n).toBase64Url()};return s.kid=yield Rr({jwk:s}),s})}static generateKey(){return Gl(this,void 0,void 0,function*(){const e=Oi.utils.randomPrivateKey(),r=yield S0.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Rr({jwk:r}),r})}static getPublicKey({key:e}){var r;return Gl(this,void 0,void 0,function*(){if(!(rp(e)&&e.crv==="X25519"))throw new Error("X25519: The provided key is not an X25519 private JWK.");let n=ple(e,["d"]);return(r=n.kid)!==null&&r!==void 0||(n.kid=yield Rr({jwk:n})),n})}static privateKeyToBytes({privateKey:e}){return Gl(this,void 0,void 0,function*(){if(!rp(e))throw new Error("X25519: The provided key is not a valid OKP private key.");return vt.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return Gl(this,void 0,void 0,function*(){if(!OI(e))throw new Error("X25519: The provided key is not a valid OKP public key.");return vt.base64Url(e.x).toUint8Array()})}static sharedSecret({privateKeyA:e,publicKeyB:r}){return Gl(this,void 0,void 0,function*(){if("x"in e&&"x"in r&&e.x===r.x)throw new Error("X25519: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const n=yield S0.privateKeyToBytes({privateKey:e}),s=yield S0.publicKeyToBytes({publicKey:r});return Oi.getSharedSecret(n,s)})}};function Oa(t){if(typeof t=="string"&&t.length!==0)return t.split("#").pop()}function AL({didDocument:t}){var e,r;if(!t)throw new TypeError("Required parameter missing: 'didDocument'");const n=[];return n.push(...(r=(e=t.verificationMethod)===null||e===void 0?void 0:e.filter(Vx))!==null&&r!==void 0?r:[]),Object.keys(Lv).forEach(s=>{var i,o;n.push(...(o=(i=t[s])===null||i===void 0?void 0:i.filter(Vx))!==null&&o!==void 0?o:[])}),n}function mle({didDocument:t}){const r=AL({didDocument:t}).map(n=>n.type);return[...new Set(r)]}function yle({didDocument:t,methodId:e}){const r=[];return Object.keys(Lv).forEach(n=>{if(Array.isArray(t[n])){const s=t[n],i=Oa(e);s.some(a=>{const u=Oa(a)===i,l=Vx(a)&&Oa(a.id)===i;return u||l})&&r.push(n)}}),r}function Vx(t){return!(!t||typeof t!="object"||t===null||!("id"in t&&"type"in t&&"controller"in t)||typeof t.id!="string"||typeof t.type!="string"||typeof t.controller!="string")}function SL({keyBytes:t,multicodecCode:e,multicodecName:r}){const n=aa.addPrefix({code:e,data:t,name:r}),s=vt.uint8Array(n).toBase58Btc();return vt.base58Btc(s).toMultibase()}function kB({multibaseKeyId:t}){try{const e=vt.multibase(t).toBase58Btc(),r=vt.base58Btc(e).toUint8Array(),{code:n,data:s,name:i}=aa.removePrefix({prefixedData:r});return{keyBytes:s,multicodecCode:n,multicodecName:i}}catch{throw new ht(st.InvalidDid,`Invalid multibase identifier: ${t}`)}}var Lg=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let yf=class TL{constructor({uri:e,document:r,metadata:n,keyManager:s}){this.uri=e,this.document=r,this.metadata=n,this.keyManager=s}export(){return Lg(this,void 0,void 0,function*(){if(!(Array.isArray(this.document.verificationMethod)&&this.document.verificationMethod.length>0))throw new Error(`DID document for '${this.uri}' is missing verification methods`);let e={uri:this.uri,document:this.document,metadata:this.metadata};if("exportKey"in this.keyManager&&typeof this.keyManager.exportKey=="function"){const r=[];for(let n of this.document.verificationMethod){if(!n.publicKeyJwk)throw new Error(`Verification method '${n.id}' does not contain a public key in JWK format`);const s=yield this.keyManager.getKeyUri({key:n.publicKeyJwk}),i=yield this.keyManager.exportKey({keyUri:s});r.push(Object.assign({},i))}e.privateKeys=r}return e})}getSigner(e){return Lg(this,void 0,void 0,function*(){var r;const n=(r=this.document.verificationMethod)===null||r===void 0?void 0:r.find(u=>{var l,c;return Oa(u.id)===((l=Oa(e==null?void 0:e.methodId))!==null&&l!==void 0?l:Oa((c=this.document.assertionMethod)===null||c===void 0?void 0:c[0]))});if(!(n&&n.publicKeyJwk))throw new ht(st.InternalError,"A verification method intended for signing could not be determined from the DID Document");const s=yield this.keyManager.getKeyUri({key:n.publicKeyJwk}),i=yield this.keyManager.getPublicKey({keyUri:s}),o=this.keyManager;return{algorithm:hle(i),keyId:n.id,sign(u){return Lg(this,arguments,void 0,function*({data:l}){return yield o.sign({data:l,keyUri:s})})},verify(u){return Lg(this,arguments,void 0,function*({data:l,signature:c}){return yield o.verify({data:l,key:i,signature:c})})}}})}static import(e){return Lg(this,arguments,void 0,function*({portableDid:r,keyManager:n=new ml}){var s;const i=AL({didDocument:r.document});if(i.length===0)throw new ht(st.InvalidDidDocument,"At least one verification method is required but 0 were given");for(let a of(s=r.privateKeys)!==null&&s!==void 0?s:[])yield n.importKey({key:a});for(let a of i){if(!a.publicKeyJwk)throw new Error(`Verification method '${a.id}' does not contain a public key in JWK format`);const u=yield n.getKeyUri({key:a.publicKeyJwk});yield n.getPublicKey({keyUri:u})}return new TL({uri:r.uri,document:r.document,metadata:r.metadata,keyManager:n})})}};/* Common package for dealing with hex/string/uint8 conversions (and sha1 hashing)
*
* @author   Jimmy Wärting <jimmy@warting.se> (https://jimmy.warting.se/opensource)
* @license  MIT
*/const $B="0123456789abcdef",DL=[];for(let t=0;t<256;t++)DL[t]=$B[t>>4&15]+$B[t&15];const gle=t=>{const e=t.length;let r="",n=0;for(;n<e;)r+=DL[t[n++]];return r},vle=(t,e=0)=>{const r=t.length||0;if(!e){let o=r;for(;o--;)e+=t[o].length}const n=new Uint8Array(e);let s=e,i=r;for(;i--;)s-=t[i].length,n.set(t[i],s);return n};var OB="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",wle=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var ab=0;ab<OB.length;ab++)wle[OB.charCodeAt(ab)]=ab;const _le=new TextDecoder,xL=(t,e)=>_le.decode(t),ble=new TextEncoder,yl=t=>ble.encode(t),RB=typeof window<"u"?window:self,NB=RB.crypto||RB.msCrypto||{};NB.subtle||NB.webkitSubtle;function Fw(t){const e=t<0?1:0;return t=Math.abs(Number(t||1)),Math.floor(Math.log10(t))+1+e}function PL(t){return ArrayBuffer.isView(t)?"arraybufferview":Array.isArray(t)?"array":t instanceof Number?"number":t instanceof Boolean?"boolean":t instanceof Set?"set":t instanceof Map?"map":t instanceof String?"string":t instanceof ArrayBuffer?"arraybuffer":typeof t}function yr(t,e,r){const n=[];let s=null;return yr._encode(n,t),s=vle(n),yr.bytes=s.length,ArrayBuffer.isView(e)?(e.set(s,r),e):s}yr.bytes=-1;yr._floatConversionDetected=!1;yr._encode=function(t,e){if(e!=null)switch(PL(e)){case"object":yr.dict(t,e);break;case"map":yr.dictMap(t,e);break;case"array":yr.list(t,e);break;case"set":yr.listSet(t,e);break;case"string":yr.string(t,e);break;case"number":yr.number(t,e);break;case"boolean":yr.number(t,e);break;case"arraybufferview":yr.buffer(t,new Uint8Array(e.buffer,e.byteOffset,e.byteLength));break;case"arraybuffer":yr.buffer(t,new Uint8Array(e));break}};const fS=new Uint8Array([101]),CL=new Uint8Array([100]),IL=new Uint8Array([108]);yr.buffer=function(t,e){t.push(yl(e.length+":"),e)};yr.string=function(t,e){t.push(yl(yl(e).byteLength+":"+e))};yr.number=function(t,e){if(Number.isInteger(e))return t.push(yl("i"+BigInt(e)+"e"));const r=2147483648,n=e/r<<0,s=e%r<<0,i=n*r+s;t.push(yl("i"+i+"e")),i!==e&&!yr._floatConversionDetected&&(yr._floatConversionDetected=!0,console.warn('WARNING: Possible data corruption detected with value "'+e+'":','Bencoding only defines support for integers, value was converted to "'+i+'"'),console.trace())};yr.dict=function(t,e){t.push(CL);let r=0,n;const s=Object.keys(e).sort(),i=s.length;for(;r<i;r++)n=s[r],e[n]!=null&&(yr.string(t,n),yr._encode(t,e[n]));t.push(fS)};yr.dictMap=function(t,e){t.push(CL);const r=Array.from(e.keys()).sort();for(const n of r)e.get(n)!=null&&(ArrayBuffer.isView(n)?yr._encode(t,n):yr.string(t,String(n)),yr._encode(t,e.get(n)));t.push(fS)};yr.list=function(t,e){let r=0;const n=e.length;for(t.push(IL);r<n;r++)e[r]!=null&&yr._encode(t,e[r]);t.push(fS)};yr.listSet=function(t,e){t.push(IL);for(const r of e)r!=null&&yr._encode(t,r);t.push(fS)};const Ele=105,Ale=58,Sle=100,Tle=108,RI=101;function kL(t,e,r){let n=0,s=1;for(let i=e;i<r;i++){const o=t[i];if(o<58&&o>=48){n=n*10+(o-48);continue}if(!(i===e&&o===43)){if(i===e&&o===45){s=-1;continue}if(o===46)break;throw new Error("not a number: buffer["+i+"] = "+o)}}return n*s}function St(t,e,r,n){return t==null||t.length===0?null:(typeof e!="number"&&n==null&&(n=e,e=void 0),typeof r!="number"&&n==null&&(n=r,r=void 0),St.position=0,St.encoding=n||null,St.data=ArrayBuffer.isView(t)?new Uint8Array(t.slice(e,r)):yl(t),St.bytes=St.data.length,St.next())}St.bytes=0;St.position=0;St.data=null;St.encoding=null;St.next=function(){switch(St.data[St.position]){case Sle:return St.dictionary();case Tle:return St.list();case Ele:return St.integer();default:return St.buffer()}};St.find=function(t){let e=St.position;const r=St.data.length,n=St.data;for(;e<r;){if(n[e]===t)return e;e++}throw new Error('Invalid data: Missing delimiter "'+String.fromCharCode(t)+'" [0x'+t.toString(16)+"]")};St.dictionary=function(){St.position++;const t={};for(;St.data[St.position]!==RI;){const e=St.buffer();let r=xL(e);r.includes("�")&&(r=gle(e)),t[r]=St.next()}return St.position++,t};St.list=function(){St.position++;const t=[];for(;St.data[St.position]!==RI;)t.push(St.next());return St.position++,t};St.integer=function(){const t=St.find(RI),e=kL(St.data,St.position+1,t);return St.position+=t+1-St.position,e};St.buffer=function(){let t=St.find(Ale);const e=kL(St.data,St.position,t),r=++t+e;return St.position=r,St.encoding?xL(St.data.slice(t,r)):St.data.slice(t,r)};function Dle(t){let e=2;for(const r of t)e+=Mw(r);return e}function xle(t){let e=2;for(const[r,n]of t){const s=yl(r).byteLength;e+=Fw(s)+1+s,e+=Mw(n)}return e}function Ple(t){let e=2;const r=Object.keys(t);for(let n=0;n<r.length;n++){const s=yl(r[n]).byteLength;e+=Fw(s)+1+s,e+=Mw(t[r[n]])}return e}function Cle(t){const e=yl(t).byteLength;return Fw(e)+1+e}function Ile(t){const e=t.byteLength-t.byteOffset;return Fw(e)+1+e}function Mw(t){if(t==null)return 0;const r=PL(t);switch(r){case"arraybufferview":return Ile(t);case"string":return Cle(t);case"array":case"set":return Dle(t);case"number":return 1+Fw(Math.floor(t))+1;case"bigint":return 1+t.toString().length+1;case"object":return Ple(t);case"map":return xle(t);default:throw new TypeError(`Unsupported value of type "${r}"`)}}const kle=Mw,gy={encode:yr,decode:St,byteLength:Mw,encodingLength:kle},$le=/^(\d{1,3}\.){3,3}\d{1,3}$/,BB=4,Ole=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i,ub=16,ju={name:"v4",size:BB,isFormat:t=>$le.test(t),encode(t,e,r){r=~~r,e=e||new Uint8Array(r+BB);const n=t.length;let s=0;for(let i=0;i<n;){const o=t.charCodeAt(i++);o===46?(e[r++]=s,s=0):s=s*10+(o-48)}return e[r]=s,e},decode(t,e){return e=~~e,`${t[e++]}.${t[e++]}.${t[e++]}.${t[e]}`}},ef={name:"v6",size:ub,isFormat:t=>t.length>0&&Ole.test(t),encode(t,e,r){r=~~r;let n=r+ub,s=-1,i=0,o=0,a=!0,u=!1;e=e||new Uint8Array(r+ub);for(let l=0;l<t.length;l++){let c=t.charCodeAt(l);c===58?(a?s!==-1?(r<n&&(e[r]=0),r<n-1&&(e[r+1]=0),r+=2):r<n&&(s=r):(u===!0?(r<n&&(e[r]=o),r++):(r<n&&(e[r]=i>>8),r<n-1&&(e[r+1]=i&255),r+=2),i=0,o=0),a=!0,u=!1):c===46?(r<n&&(e[r]=o),r++,o=0,i=0,a=!1,u=!0):(a=!1,c>=97?c-=87:c>=65?c-=55:(c-=48,o=o*10+c),i=(i<<4)+c)}if(a===!1)u===!0?(r<n&&(e[r]=o),r++):(r<n&&(e[r]=i>>8),r<n-1&&(e[r+1]=i&255),r+=2);else if(s===0)r<n&&(e[r]=0),r<n-1&&(e[r+1]=0),r+=2;else if(s!==-1){r+=2;for(let l=Math.min(r-1,n-1);l>=s+2;l--)e[l]=e[l-2];e[s]=0,e[s+1]=0,s=r}if(s!==r&&s!==-1)for(r>n-2&&(r=n-2);n>s;)e[--n]=r<n&&r>s?e[--r]:0;else for(;r<n;)e[r++]=0;return e},decode(t,e){e=~~e;let r="";for(let n=0;n<ub;n+=2)n!==0&&(r+=":"),r+=(t[e+n]<<8|t[e+n+1]).toString(16);return r.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}};function $L(t){if(ju.isFormat(t))return ju.size;if(ef.isFormat(t))return ef.size;throw Error(`Invalid ip address: ${t}`)}function Rle(t){return $L(t)===ju.size?1:2}function Nle(t,e,r){r=~~r;const n=$L(t);return typeof e=="function"&&(e=e(r+n)),n===ju.size?ju.encode(t,e,r):ef.encode(t,e,r)}function Ble(t,e,r){if(e=~~e,r=r||t.length-e,r===ju.size)return ju.decode(t,e,r);if(r===ef.size)return ef.decode(t,e,r);throw Error(`Invalid buffer size needs to be ${ju.size} for v4 or ${ef.size} for v6.`)}function hS(t){switch(t){case 1:return"A";case 10:return"NULL";case 28:return"AAAA";case 18:return"AFSDB";case 42:return"APL";case 257:return"CAA";case 60:return"CDNSKEY";case 59:return"CDS";case 37:return"CERT";case 5:return"CNAME";case 49:return"DHCID";case 32769:return"DLV";case 39:return"DNAME";case 48:return"DNSKEY";case 43:return"DS";case 55:return"HIP";case 13:return"HINFO";case 45:return"IPSECKEY";case 25:return"KEY";case 36:return"KX";case 29:return"LOC";case 15:return"MX";case 35:return"NAPTR";case 2:return"NS";case 47:return"NSEC";case 50:return"NSEC3";case 51:return"NSEC3PARAM";case 12:return"PTR";case 46:return"RRSIG";case 17:return"RP";case 24:return"SIG";case 6:return"SOA";case 99:return"SPF";case 33:return"SRV";case 44:return"SSHFP";case 32768:return"TA";case 249:return"TKEY";case 52:return"TLSA";case 250:return"TSIG";case 16:return"TXT";case 252:return"AXFR";case 251:return"IXFR";case 41:return"OPT";case 255:return"ANY"}return"UNKNOWN_"+t}function Kv(t){switch(t.toUpperCase()){case"A":return 1;case"NULL":return 10;case"AAAA":return 28;case"AFSDB":return 18;case"APL":return 42;case"CAA":return 257;case"CDNSKEY":return 60;case"CDS":return 59;case"CERT":return 37;case"CNAME":return 5;case"DHCID":return 49;case"DLV":return 32769;case"DNAME":return 39;case"DNSKEY":return 48;case"DS":return 43;case"HIP":return 55;case"HINFO":return 13;case"IPSECKEY":return 45;case"KEY":return 25;case"KX":return 36;case"LOC":return 29;case"MX":return 15;case"NAPTR":return 35;case"NS":return 2;case"NSEC":return 47;case"NSEC3":return 50;case"NSEC3PARAM":return 51;case"PTR":return 12;case"RRSIG":return 46;case"RP":return 17;case"SIG":return 24;case"SOA":return 6;case"SPF":return 99;case"SRV":return 33;case"SSHFP":return 44;case"TA":return 32768;case"TKEY":return 249;case"TLSA":return 52;case"TSIG":return 250;case"TXT":return 16;case"AXFR":return 252;case"IXFR":return 251;case"OPT":return 41;case"ANY":return 255;case"*":return 255}return t.toUpperCase().startsWith("UNKNOWN_")?parseInt(t.slice(8)):0}function Fle(t){switch(t){case 0:return"NOERROR";case 1:return"FORMERR";case 2:return"SERVFAIL";case 3:return"NXDOMAIN";case 4:return"NOTIMP";case 5:return"REFUSED";case 6:return"YXDOMAIN";case 7:return"YXRRSET";case 8:return"NXRRSET";case 9:return"NOTAUTH";case 10:return"NOTZONE";case 11:return"RCODE_11";case 12:return"RCODE_12";case 13:return"RCODE_13";case 14:return"RCODE_14";case 15:return"RCODE_15"}return"RCODE_"+t}function Mle(t){switch(t){case 0:return"QUERY";case 1:return"IQUERY";case 2:return"STATUS";case 3:return"OPCODE_3";case 4:return"NOTIFY";case 5:return"UPDATE";case 6:return"OPCODE_6";case 7:return"OPCODE_7";case 8:return"OPCODE_8";case 9:return"OPCODE_9";case 10:return"OPCODE_10";case 11:return"OPCODE_11";case 12:return"OPCODE_12";case 13:return"OPCODE_13";case 14:return"OPCODE_14";case 15:return"OPCODE_15"}return"OPCODE_"+t}function OL(t){switch(t){case 1:return"IN";case 2:return"CS";case 3:return"CH";case 4:return"HS";case 255:return"ANY"}return"UNKNOWN_"+t}function RL(t){switch(t.toUpperCase()){case"IN":return 1;case"CS":return 2;case"CH":return 3;case"HS":return 4;case"ANY":return 255}return 0}function jle(t){switch(t){case 1:return"LLQ";case 2:return"UL";case 3:return"NSID";case 5:return"DAU";case 6:return"DHU";case 7:return"N3U";case 8:return"CLIENT_SUBNET";case 9:return"EXPIRE";case 10:return"COOKIE";case 11:return"TCP_KEEPALIVE";case 12:return"PADDING";case 13:return"CHAIN";case 14:return"KEY_TAG";case 26946:return"DEVICEID"}return t<0?null:`OPTION_${t}`}function FB(t){if(typeof t=="number")return t;if(!t)return-1;switch(t.toUpperCase()){case"OPTION_0":return 0;case"LLQ":return 1;case"UL":return 2;case"NSID":return 3;case"OPTION_4":return 4;case"DAU":return 5;case"DHU":return 6;case"N3U":return 7;case"CLIENT_SUBNET":return 8;case"EXPIRE":return 9;case"COOKIE":return 10;case"TCP_KEEPALIVE":return 11;case"PADDING":return 12;case"CHAIN":return 13;case"KEY_TAG":return 14;case"DEVICEID":return 26946;case"OPTION_65535":return 65535}const e=t.match(/_(\d+)$/);return e?parseInt(e[1],10):-1}const NI=55296,Vv=56320;function NL(t){let e=0;const r=t.length;for(let n=0;n<r;n+=1){const s=t.charCodeAt(n);if(s<=127)e+=1;else if(s<=2047)e+=2;else if((s&63488)!==NI)e+=3;else{const i=n+1;i===r||s>=Vv||(t.charCodeAt(i)&64512)!==Vv?e+=3:(n=i,e+=4)}}return e}function qv(t,e,r){const n=t.length;r==null&&(r=0),e===void 0&&(e=new Uint8Array(NL(t)+r));let s=r;for(let i=0;i<n;i+=1){let o=t.charCodeAt(i);if(o<=127)e[s++]=o;else if(o<=2047)e[s++]=192|(o&1984)>>6,e[s++]=128|o&63;else if((o&63488)!==NI)e[s++]=224|(o&61440)>>12,e[s++]=128|(o&4032)>>6,e[s++]=128|o&63;else{const a=i+1;if(a===n||o>=Vv)e[s++]=239,e[s++]=191,e[s++]=189;else{const u=t.charCodeAt(a);(u&64512)!==Vv?(e[s++]=239,e[s++]=191,e[s++]=189):(i=a,o=65536|(o&1023)<<10|u&1023,e[s++]=240|(o&1835008)>>18,e[s++]=128|(o&258048)>>12,e[s++]=128|(o&4032)>>6,e[s++]=128|o&63)}}}return qv.bytes=s-r,e}qv.bytes=0;function jw(t,e,r){let n="";e==null&&(e=0),r==null&&(r=t.length);for(let s=e;s<r;){const i=t[s++];let o;if(i<=128)o=i;else if(i>191&&i<224)o=(i&31)<<6|t[s++]&63;else if(i>239&&i<365){o=((i&7)<<18|(t[s++]&63)<<12|(t[s++]&63)<<6|t[s++]&63)-65536;const a=NI|o>>10&1023;n+=String.fromCharCode(a),o=Vv|o&1023}else o=(i&15)<<12|(t[s++]&63)<<6|t[s++]&63;n+=String.fromCharCode(o)}return jw.bytes=r-e,n}jw.bytes=0;const yp=t=>t instanceof Uint8Array;function Cf(t){return typeof t=="string"?NL(t):t.byteLength}function BI(t){return t instanceof Uint8Array?t:Array.isArray(t)?new Uint8Array(t):qv(t)}function FI(t,e,r){if(typeof e!="string")throw new Error("unknown input type");return qv(e,t,r),qv.bytes}const T0={},BL=new Array(255);for(let t=0;t<=15;t+=1){const e=t.toString(16),r=e.toUpperCase();for(let n=0;n<=15;n+=1){const s=n.toString(16),i=s.toUpperCase(),o=t<<4|n,a=`${e}${s}`;BL[o]=a,T0[a]=o,T0[`${r}${s}`]=o,T0[`${e}${i}`]=o,T0[`${r}${i}`]=o}}function Ule(t,e,r){let n="";for(let s=e;s<r;){const i=t[s++];n+=BL[i]}return n}function MB(t){return t.length>>>1}function Lle(t,e,r,n){let s=0;for(;r<n;){const i=e.substr(s,2),o=T0[i];if(o===void 0)return;t[r++]=o,s+=2}return t}const Kle=Math.pow(2,24),Vle=Math.pow(2,16),qle=Math.pow(2,8),Qc=(t,e)=>t[e]*Kle+t[e+1]*Vle+t[e+2]*qle+t[e+3],Xt=(t,e)=>t[e]<<8|t[e+1],el=(t,e,r)=>(e=+e,t[r+3]=e,e=e>>>8,t[r+2]=e,e=e>>>8,t[r+1]=e,e=e>>>8,t[r]=e,r+4),wt=(t,e,r)=>(t[r]=e>>8,t[r+1]=e&255,r+2);function na(t,e,r,n,s){return r<0&&(n-=r,r=0),n<0&&(n=0),s<0?new Uint8Array(0):r>=e.length||n>=s?0:Hle(t,e,r,n,s)}function Hle(t,e,r,n,s){s-n>e.length-r&&(s=n+e.length-r);let i=s-n;const o=t.length-n;return i>o&&(i=o),(n!==0||s<t.length)&&(t=new Uint8Array(t.buffer,t.byteOffset+n,i)),e.set(t,r),i}const zle=0,jB=32768,qx=32768,Wle=~qx,FL=32768,Gle=~FL;function zr({bytes:t=0,encode:e,decode:r,encodingLength:n}){return e.bytes=t,r.bytes=t,{encode:e,decode:r,encodingLength:n||(()=>t)}}const Ze=zr({encode(t,e,r){e||(e=new Uint8Array(Ze.encodingLength(t))),r||(r=0);const n=r,s=t.replace(/^\.|\.$/gm,"");if(s.length){const i=s.split(".");for(let o=0;o<i.length;o++){const a=FI(e,i[o],r+1);e[r]=a,r+=a+1}}return e[r++]=0,Ze.encode.bytes=r-n,e},decode(t,e){e||(e=0);const r=[];let n=e,s=0,i=0,o=!1;for(;;){if(e>=t.length)throw new Error("Cannot decode name (buffer overflow)");const a=t[e++];if(i+=o?0:1,a===0)break;if(a&192)if((a&192)===192){if(e+1>t.length)throw new Error("Cannot decode name (buffer overflow)");const u=Xt(t,e-1)-49152;if(u>=n)throw new Error("Cannot decode name (bad pointer)");e=u,n=u,i+=o?0:1,o=!0}else throw new Error("Cannot decode name (bad label)");else{if(e+a>t.length)throw new Error("Cannot decode name (buffer overflow)");if(s+=a+1,s>254)throw new Error("Cannot decode name (name too long)");r.push(jw(t,e,e+a)),e+=a,i+=o?0:a}}return Ze.decode.bytes=i,r.length===0?".":r.join(".")},encodingLength(t){return t==="."||t===".."?1:Cf(t.replace(/^\.|\.$/gm,""))+2}}),Un=zr({encode(t,e,r){e||(e=new Uint8Array(Un.encodingLength(t))),r||(r=0);const n=FI(e,t,r+1);return e[r]=n,Un.encode.bytes=n+1,e},decode(t,e){e||(e=0);const r=t[e],n=jw(t,e+1,e+1+r);return Un.decode.bytes=r+1,n},encodingLength(t){return Cf(t)+1}}),bm=zr({bytes:12,encode(t,e,r){e||(e=new Uint8Array(bm.encodingLength(t))),r||(r=0);const n=(t.flags||0)&32767,s=t.type==="response"?jB:zle;return wt(e,t.id||0,r),wt(e,n|s,r+2),wt(e,t.questions.length,r+4),wt(e,t.answers.length,r+6),wt(e,t.authorities.length,r+8),wt(e,t.additionals.length,r+10),e},decode(t,e){if(e||(e=0),t.length<12)throw new Error("Header must be 12 bytes");const r=Xt(t,e+2);return{id:Xt(t,e),type:r&jB?"response":"query",flags:r&32767,flag_qr:(r>>15&1)===1,opcode:Mle(r>>11&15),flag_aa:(r>>10&1)===1,flag_tc:(r>>9&1)===1,flag_rd:(r>>8&1)===1,flag_ra:(r>>7&1)===1,flag_z:(r>>6&1)===1,flag_ad:(r>>5&1)===1,flag_cd:(r>>4&1)===1,rcode:Fle(r&15),questions:new Array(Xt(t,e+4)),answers:new Array(Xt(t,e+6)),authorities:new Array(Xt(t,e+8)),additionals:new Array(Xt(t,e+10))}},encodingLength(){return 12}}),f1=zr({encode(t,e,r){e||(e=new Uint8Array(f1.encodingLength(t))),r||(r=0);const n=t.length;return wt(e,n,r),na(t,e,r+2,0,n),f1.encode.bytes=n+2,e},decode(t,e){e||(e=0);const r=Xt(t,e),n=t.slice(e+2,e+2+r);return f1.decode.bytes=r+2,n},encodingLength(t){return t.length+2}}),h1=zr({encode(t,e,r){return e||(e=new Uint8Array(h1.encodingLength(t))),r||(r=0),Ze.encode(t,e,r+2),wt(e,Ze.encode.bytes,r),h1.encode.bytes=Ze.encode.bytes+2,e},decode(t,e){e||(e=0);const r=Xt(t,e),n=Ze.decode(t,e+2);return h1.decode.bytes=r+2,n},encodingLength(t){return Ze.encodingLength(t)+2}}),p1=zr({encode(t,e,r){e||(e=new Uint8Array(p1.encodingLength(t))),r||(r=0);const n=r;return r+=2,Ze.encode(t.mname,e,r),r+=Ze.encode.bytes,Ze.encode(t.rname,e,r),r+=Ze.encode.bytes,el(e,t.serial||0,r),r+=4,el(e,t.refresh||0,r),r+=4,el(e,t.retry||0,r),r+=4,el(e,t.expire||0,r),r+=4,el(e,t.minimum||0,r),r+=4,wt(e,r-n-2,n),p1.encode.bytes=r-n,e},decode(t,e){e||(e=0);const r=e,n={};return e+=2,n.mname=Ze.decode(t,e),e+=Ze.decode.bytes,n.rname=Ze.decode(t,e),e+=Ze.decode.bytes,n.serial=Qc(t,e),e+=4,n.refresh=Qc(t,e),e+=4,n.retry=Qc(t,e),e+=4,n.expire=Qc(t,e),e+=4,n.minimum=Qc(t,e),e+=4,p1.decode.bytes=e-r,n},encodingLength(t){return 22+Ze.encodingLength(t.mname)+Ze.encodingLength(t.rname)}}),m1=zr({encode(t,e,r){Array.isArray(t)||(t=[t]);for(let s=0;s<t.length;s++)if(typeof t[s]=="string"&&(t[s]=BI(t[s])),!yp(t[s]))throw new Error("Must be a Buffer");e||(e=new Uint8Array(m1.encodingLength(t))),r||(r=0);const n=r;return r+=2,t.forEach(function(s){e[r++]=s.length,na(s,e,r,0,s.length),r+=s.length}),wt(e,r-n-2,n),m1.encode.bytes=r-n,e},decode(t,e){e||(e=0);const r=e;let n=Xt(t,e);e+=2;const s=[];for(;n>0;){const i=t[e++];if(--n,n<i)throw new Error("Buffer overflow");s.push(t.slice(e,e+i)),e+=i,n-=i}return m1.decode.bytes=e-r,s},encodingLength(t){Array.isArray(t)||(t=[t]);let e=2;return t.forEach(function(r){typeof r=="string"?e+=Cf(r)+1:e+=r.length+1}),e}}),y1=zr({encode(t,e,r){e||(e=new Uint8Array(y1.encodingLength(t))),r||(r=0),typeof t=="string"&&(t=BI(t)),t||(t=new Uint8Array(0));const n=r;r+=2;const s=t.length;return na(t,e,r,0,s),r+=s,wt(e,r-n-2,n),y1.encode.bytes=r-n,e},decode(t,e){e||(e=0);const r=e,n=Xt(t,e);e+=2;const s=t.slice(e,e+n);return e+=n,y1.decode.bytes=e-r,s},encodingLength(t){return t?(yp(t)?t.length:Cf(t))+2:2}}),g1=zr({encode(t,e,r){e||(e=new Uint8Array(g1.encodingLength(t))),r||(r=0);const n=r;return r+=2,Un.encode(t.cpu,e,r),r+=Un.encode.bytes,Un.encode(t.os,e,r),r+=Un.encode.bytes,wt(e,r-n-2,n),g1.encode.bytes=r-n,e},decode(t,e){e||(e=0);const r=e,n={};return e+=2,n.cpu=Un.decode(t,e),e+=Un.decode.bytes,n.os=Un.decode(t,e),e+=Un.decode.bytes,g1.decode.bytes=e-r,n},encodingLength(t){return Un.encodingLength(t.cpu)+Un.encodingLength(t.os)+2}}),Xm=zr({encode(t,e,r){return e||(e=new Uint8Array(Xm.encodingLength(t))),r||(r=0),Ze.encode(t,e,r+2),wt(e,Ze.encode.bytes,r),Xm.encode.bytes=Ze.encode.bytes+2,e},decode(t,e){e||(e=0);const r=Ze.decode(t,e+2);return Xm.decode.bytes=Ze.decode.bytes+2,r},encodingLength(t){return Ze.encodingLength(t)+2}}),v1=zr({encode(t,e,r){e||(e=new Uint8Array(v1.encodingLength(t))),r||(r=0),wt(e,t.priority||0,r+2),wt(e,t.weight||0,r+4),wt(e,t.port||0,r+6),Ze.encode(t.target,e,r+8);const n=Ze.encode.bytes+6;return wt(e,n,r),v1.encode.bytes=n+2,e},decode(t,e){e||(e=0);const r=Xt(t,e),n={};return n.priority=Xt(t,e+2),n.weight=Xt(t,e+4),n.port=Xt(t,e+6),n.target=Ze.decode(t,e+8),v1.decode.bytes=r+2,n},encodingLength(t){return 8+Ze.encodingLength(t.target)}}),Od=zr({encode(t,e,r){const n=Od.encodingLength(t);return e||(e=new Uint8Array(Od.encodingLength(t))),r||(r=0),t.issuerCritical&&(t.flags=Od.ISSUER_CRITICAL),wt(e,n-2,r),r+=2,e[r]=t.flags||0,r+=1,Un.encode(t.tag,e,r),r+=Un.encode.bytes,FI(e,t.value,r),r+=Cf(t.value),Od.encode.bytes=n,e},decode(t,e){e||(e=0);const r=Xt(t,e);e+=2;const n=e,s={};return s.flags=t[e],e+=1,s.tag=Un.decode(t,e),e+=Un.decode.bytes,s.value=jw(t,e,n+r),s.issuerCritical=!!(s.flags&Od.ISSUER_CRITICAL),Od.decode.bytes=r+2,s},encodingLength(t){return Un.encodingLength(t.tag)+Un.encodingLength(t.value)+2}});Od.ISSUER_CRITICAL=128;const w1=zr({encode(t,e,r){e||(e=new Uint8Array(w1.encodingLength(t))),r||(r=0);const n=r;return r+=2,wt(e,t.preference||0,r),r+=2,Ze.encode(t.exchange,e,r),r+=Ze.encode.bytes,wt(e,r-n-2,n),w1.encode.bytes=r-n,e},decode(t,e){e||(e=0);const r=e,n={};return e+=2,n.preference=Xt(t,e),e+=2,n.exchange=Ze.decode(t,e),e+=Ze.decode.bytes,w1.decode.bytes=e-r,n},encodingLength(t){return 4+Ze.encodingLength(t.exchange)}}),ML=zr({encode(t,e,r){return e||(e=new Uint8Array(ML.encodingLength(t))),r||(r=0),wt(e,4,r),r+=2,ju.encode(t,e,r),e},decode(t,e){return e||(e=0),e+=2,ju.decode(t,e)},bytes:6}),_1=zr({encode(t,e,r){return e||(e=new Uint8Array(_1.encodingLength(t))),r||(r=0),wt(e,16,r),r+=2,ef.encode(t,e,r),_1.encode.bytes=18,e},decode(t,e){e||(e=0),e+=2;const r=ef.decode(t,e);return _1.decode.bytes=18,r},bytes:18}),Jle=t=>new Uint8Array(t),Vc=zr({encode(t,e,r){e||(e=new Uint8Array(Vc.encodingLength(t))),r||(r=0);const n=r,s=FB(t.code);if(wt(e,s,r),r+=2,t.data)wt(e,t.data.length,r),r+=2,na(t.data,e,r),r+=t.data.length;else switch(s){case 8:{const i=t.sourcePrefixLength||0,o=t.family||Rle(t.ip),a=Nle(t.ip,Jle),u=Math.ceil(i/8);wt(e,u+4,r),r+=2,wt(e,o,r),r+=2,e[r++]=i,e[r++]=t.scopePrefixLength||0,na(a,e,r,0,u),r+=u}break;case 11:t.timeout?(wt(e,2,r),r+=2,wt(e,t.timeout,r),r+=2):(wt(e,0,r),r+=2);break;case 12:{const i=t.length||0;wt(e,i,r),r+=2,e.fill(0,r,r+i),r+=i}break;case 14:{const i=t.tags.length*2;wt(e,i,r),r+=2;for(const o of t.tags)wt(e,o,r),r+=2}break;default:throw new Error(`Unknown roption code: ${t.code}`)}return Vc.encode.bytes=r-n,e},decode(t,e){e||(e=0);const r={};r.code=Xt(t,e),r.type=jle(r.code),e+=2;const n=Xt(t,e);switch(e+=2,r.data=t.slice(e,e+n),r.code){case 8:r.family=Xt(t,e),e+=2,r.sourcePrefixLength=t[e++],r.scopePrefixLength=t[e++];{const s=new Uint8Array(r.family===1?4:16);na(t,s,0,e,e+n-4),r.ip=Ble(s)}break;case 11:n>0&&(r.timeout=Xt(t,e),e+=2);break;case 14:r.tags=[];for(let s=0;s<n;s+=2)r.tags.push(Xt(t,e)),e+=2}return Vc.decode.bytes=n+4,r},encodingLength(t){if(t.data)return t.data.length+4;switch(FB(t.code)){case 8:{const r=t.sourcePrefixLength||0;return Math.ceil(r/8)+8}case 11:return typeof t.timeout=="number"?6:4;case 12:return t.length+4;case 14:return 4+t.tags.length*2}throw new Error(`Unknown roption code: ${t.code}`)}}),Wd=zr({encode(t,e,r){e||(e=new Uint8Array(Wd.encodingLength(t))),r||(r=0);const n=r,s=Fm(t,Vc);return wt(e,s,r),r=k0(t,Vc,e,r+2),Wd.encode.bytes=r-n,e},decode(t,e){e||(e=0);const r=e,n=[];let s=Xt(t,e);e+=2;let i=0;for(;s>0;)n[i++]=Vc.decode(t,e),e+=Vc.decode.bytes,s-=Vc.decode.bytes;return Wd.decode.bytes=e-r,n},encodingLength(t){return 2+Fm(t||[],Vc)}}),Eu=zr({encode(t,e,r){e||(e=new Uint8Array(Eu.encodingLength(t))),r||(r=0);const n=r,s=t.key;if(!yp(s))throw new Error("Key must be a Buffer");return r+=2,wt(e,t.flags,r),r+=2,e[r]=Eu.PROTOCOL_DNSSEC,r+=1,e[r]=t.algorithm,r+=1,na(s,e,r,0,s.length),r+=s.length,Eu.encode.bytes=r-n,wt(e,Eu.encode.bytes-2,n),e},decode(t,e){e||(e=0);const r=e,n={},s=Xt(t,e);if(e+=2,n.flags=Xt(t,e),e+=2,t[e]!==Eu.PROTOCOL_DNSSEC)throw new Error("Protocol must be 3");return e+=1,n.algorithm=t[e],e+=1,n.key=t.slice(e,r+s+2),e+=n.key.length,Eu.decode.bytes=e-r,n},encodingLength(t){return 6+Cf(t.key)}});Eu.PROTOCOL_DNSSEC=3;Eu.ZONE_KEY=128;Eu.SECURE_ENTRYPOINT=32768;const D0=zr({encode(t,e,r){e||(e=new Uint8Array(D0.encodingLength(t))),r||(r=0);const n=r,s=t.signature;if(!yp(s))throw new Error("Signature must be a Buffer");return r+=2,wt(e,Kv(t.typeCovered),r),r+=2,e[r]=t.algorithm,r+=1,e[r]=t.labels,r+=1,el(e,t.originalTTL,r),r+=4,el(e,t.expiration,r),r+=4,el(e,t.inception,r),r+=4,wt(e,t.keyTag,r),r+=2,Ze.encode(t.signersName,e,r),r+=Ze.encode.bytes,na(s,e,r,0,s.length),r+=s.length,D0.encode.bytes=r-n,wt(e,D0.encode.bytes-2,n),e},decode(t,e){e||(e=0);const r=e,n={},s=Xt(t,e);return e+=2,n.typeCovered=hS(Xt(t,e)),e+=2,n.algorithm=t[e],e+=1,n.labels=t[e],e+=1,n.originalTTL=Qc(t,e),e+=4,n.expiration=Qc(t,e),e+=4,n.inception=Qc(t,e),e+=4,n.keyTag=Xt(t,e),e+=2,n.signersName=Ze.decode(t,e),e+=Ze.decode.bytes,n.signature=t.slice(e,r+s+2),e+=n.signature.length,D0.decode.bytes=e-r,n},encodingLength(t){return 20+Ze.encodingLength(t.signersName)+Cf(t.signature)}}),x0=zr({encode(t,e,r){e||(e=new Uint8Array(x0.encodingLength(t))),r||(r=0);const n=r;return r+=2,Ze.encode(t.mbox||".",e,r),r+=Ze.encode.bytes,Ze.encode(t.txt||".",e,r),r+=Ze.encode.bytes,x0.encode.bytes=r-n,wt(e,x0.encode.bytes-2,n),e},decode(t,e){e||(e=0);const r=e,n={};return e+=2,n.mbox=Ze.decode(t,e)||".",e+=Ze.decode.bytes,n.txt=Ze.decode(t,e)||".",e+=Ze.decode.bytes,x0.decode.bytes=e-r,n},encodingLength(t){return 2+Ze.encodingLength(t.mbox||".")+Ze.encodingLength(t.txt||".")}}),fo=zr({encode(t,e,r){e||(e=new Uint8Array(fo.encodingLength(t))),r||(r=0);const n=r,s=[];for(let i=0;i<t.length;i++){const o=Kv(t[i]);s[o>>8]===void 0&&(s[o>>8]=[]),s[o>>8][o>>3&31]|=1<<7-(o&7)}for(let i=0;i<s.length;i++)if(s[i]!==void 0){const o=BI(s[i]);e[r]=i,r+=1,e[r]=o.length,r+=1,na(o,e,r,0,o.length),r+=o.length}return fo.encode.bytes=r-n,e},decode(t,e,r){e||(e=0);const n=e,s=[];for(;e-n<r;){const i=t[e];e+=1;const o=t[e];e+=1;for(let a=0;a<o;a++){const u=t[e+a];for(let l=0;l<8;l++)if(u&1<<7-l){const c=hS(i<<8|a<<3|l);s.push(c)}}e+=o}return fo.decode.bytes=e-n,s},encodingLength(t){const e=[];for(let n=0;n<t.length;n++){const s=Kv(t[n]);e[s>>8]=Math.max(e[s>>8]||0,s&255)}let r=0;for(let n=0;n<e.length;n++)e[n]!==void 0&&(r+=2+Math.ceil((e[n]+1)/8));return r}}),P0=zr({encode(t,e,r){e||(e=new Uint8Array(P0.encodingLength(t))),r||(r=0);const n=r;return r+=2,Ze.encode(t.nextDomain,e,r),r+=Ze.encode.bytes,fo.encode(t.rrtypes,e,r),r+=fo.encode.bytes,P0.encode.bytes=r-n,wt(e,P0.encode.bytes-2,n),e},decode(t,e){e||(e=0);const r=e,n={},s=Xt(t,e);return e+=2,n.nextDomain=Ze.decode(t,e),e+=Ze.decode.bytes,n.rrtypes=fo.decode(t,e,s-(e-r)),e+=fo.decode.bytes,P0.decode.bytes=e-r,n},encodingLength(t){return 2+Ze.encodingLength(t.nextDomain)+fo.encodingLength(t.rrtypes)}}),C0=zr({encode(t,e,r){e||(e=new Uint8Array(C0.encodingLength(t))),r||(r=0);const n=r,s=t.salt;if(!yp(s))throw new Error("salt must be a Buffer");const i=t.nextDomain;if(!yp(i))throw new Error("nextDomain must be a Buffer");return r+=2,e[r]=t.algorithm,r+=1,e[r]=t.flags,r+=1,wt(e,t.iterations,r),r+=2,e[r]=s.length,r+=1,na(s,e,r,0,s.length),r+=s.length,e[r]=i.length,r+=1,na(i,e,r,0,i.length),r+=i.length,fo.encode(t.rrtypes,e,r),r+=fo.encode.bytes,C0.encode.bytes=r-n,wt(e,C0.encode.bytes-2,n),e},decode(t,e){e||(e=0);const r=e,n={},s=Xt(t,e);e+=2,n.algorithm=t[e],e+=1,n.flags=t[e],e+=1,n.iterations=Xt(t,e),e+=2;const i=t[e];e+=1,n.salt=t.slice(e,e+i),e+=i;const o=t[e];return e+=1,n.nextDomain=t.slice(e,e+o),e+=o,n.rrtypes=fo.decode(t,e,s-(e-r)),e+=fo.decode.bytes,C0.decode.bytes=e-r,n},encodingLength(t){return 8+t.salt.length+t.nextDomain.length+fo.encodingLength(t.rrtypes)}}),I0=zr({encode(t,e,r){e||(e=new Uint8Array(I0.encodingLength(t))),r||(r=0);const n=r,s=t.digest;if(!yp(s))throw new Error("Digest must be a Buffer");return r+=2,wt(e,t.keyTag,r),r+=2,e[r]=t.algorithm,r+=1,e[r]=t.digestType,r+=1,na(s,e,r,0,s.length),r+=s.length,I0.encode.bytes=r-n,wt(e,I0.encode.bytes-2,n),e},decode(t,e){e||(e=0);const r=e,n={},s=Xt(t,e);return e+=2,n.keyTag=Xt(t,e),e+=2,n.algorithm=t[e],e+=1,n.digestType=t[e],e+=1,n.digest=t.slice(e,r+s+2),e+=n.digest.length,I0.decode.bytes=e-r,n},encodingLength(t){return 6+Cf(t.digest)}}),Bm=zr({encode(t,e,r){e||(e=new Uint8Array(Bm.encodingLength(t))),r||(r=0);const n=r;r+=2,e[r]=t.algorithm,r+=1,e[r]=t.hash,r+=1;const s=MB(t.fingerprint),i=Hx(t.hash);if(s!==i)throw new Error(`Invalid length of fingerprint "${t.fingerprint}" for hashType=${t.hash}: ${s} != ${i}`);return Lle(e,t.fingerprint,r,r+=s),Bm.encode.bytes=r-n,wt(e,Bm.encode.bytes-2,n),e},decode(t,e){e||(e=0);const r=e,n={};e+=2,n.algorithm=t[e],e+=1,n.hash=t[e],e+=1;const s=Hx(n.hash);return n.fingerprint=Ule(t,e,e+s),e+=s,Bm.decode.bytes=e-r,n},encodingLength(t){return 4+MB(t.fingerprint)}});function Hx(t){if(t===1)return 20;if(t===2)return 32;throw new Error(`Invalid hashType=${t}, supported=1,2`)}Bm.getFingerprintLengthForHashType=Hx;function _T(t){switch(t.toUpperCase()){case"A":return ML;case"PTR":return Xm;case"CNAME":return Xm;case"DNAME":return Xm;case"TXT":return m1;case"NULL":return y1;case"AAAA":return _1;case"SRV":return v1;case"HINFO":return g1;case"CAA":return Od;case"NS":return h1;case"SOA":return p1;case"MX":return w1;case"OPT":return Wd;case"DNSKEY":return Eu;case"RRSIG":return D0;case"RP":return x0;case"NSEC":return P0;case"NSEC3":return C0;case"SSHFP":return Bm;case"DS":return I0}return f1}const Uo=zr({encode(t,e,r){e||(e=new Uint8Array(Uo.encodingLength(t))),r||(r=0);const n=r;if(Ze.encode(t.name,e,r),r+=Ze.encode.bytes,wt(e,Kv(t.type),r),t.type.toUpperCase()==="OPT"){if(t.name!==".")throw new Error("OPT name must be root.");wt(e,t.udpPayloadSize||4096,r+2),e[r+4]=t.extendedRcode||0,e[r+5]=t.ednsVersion||0,wt(e,t.flags||0,r+6),r+=8,Wd.encode(t.options||[],e,r),r+=Wd.encode.bytes}else{let s=RL(t.class===void 0?"IN":t.class);t.flush&&(s|=qx),wt(e,s,r+2),el(e,t.ttl||0,r+4),r+=8;const i=_T(t.type);i.encode(t.data,e,r),r+=i.encode.bytes}return Uo.encode.bytes=r-n,e},decode(t,e){e||(e=0);const r={},n=e;if(r.name=Ze.decode(t,e),e+=Ze.decode.bytes,r.type=hS(Xt(t,e)),r.type==="OPT")r.udpPayloadSize=Xt(t,e+2),r.extendedRcode=t[e+4],r.ednsVersion=t[e+5],r.flags=Xt(t,e+6),r.flag_do=(r.flags>>15&1)===1,r.options=Wd.decode(t,e+8),e+=8+Wd.decode.bytes;else{const s=Xt(t,e+2);r.ttl=Qc(t,e+4),r.class=OL(s&Wle),r.flush=!!(s&qx);const i=_T(r.type);r.data=i.decode(t,e+8),e+=8+i.decode.bytes}return Uo.decode.bytes=e-n,r},encodingLength(t){const e=t.data!==null&&t.data!==void 0?t.data:t.options;return Ze.encodingLength(t.name)+8+_T(t.type).encodingLength(e)}}),Ym=zr({encode(t,e,r){e||(e=new Uint8Array(Ym.encodingLength(t))),r||(r=0);const n=r;return Ze.encode(t.name,e,r),r+=Ze.encode.bytes,wt(e,Kv(t.type),r),r+=2,wt(e,RL(t.class===void 0?"IN":t.class),r),r+=2,Ym.encode.bytes=r-n,t},decode(t,e){e||(e=0);const r=e,n={};return n.name=Ze.decode(t,e),e+=Ze.decode.bytes,n.type=hS(Xt(t,e)),e+=2,n.class=OL(Xt(t,e)),e+=2,!!(n.class&FL)&&(n.class&=Gle),Ym.decode.bytes=e-r,n},encodingLength(t){return Ze.encodingLength(t.name)+4}}),MI=1024,gp={encode:function(t,e,r){const n=!e;n&&(e=new Uint8Array(Xle(t))),r||(r=0);const s=r;return t.questions||(t.questions=[]),t.answers||(t.answers=[]),t.authorities||(t.authorities=[]),t.additionals||(t.additionals=[]),bm.encode(t,e,r),r+=bm.encode.bytes,r=k0(t.questions,Ym,e,r),r=k0(t.answers,Uo,e,r),r=k0(t.authorities,Uo,e,r),r=k0(t.additionals,Uo,e,r),gp.encode.bytes=r-s,n&&Hv.bytes!==e.length?e.slice(0,Hv.bytes):e},decode:function(t,e){e||(e=0);const r=e,n=bm.decode(t,e);return e+=bm.decode.bytes,e=cb(n.questions,Ym,t,e),e=cb(n.answers,Uo,t,e),e=cb(n.authorities,Uo,t,e),e=cb(n.additionals,Uo,t,e),gp.decode.bytes=e-r,n},encodingLength:function(t){return bm.encodingLength(t)+Fm(t.questions||[],Ym)+Fm(t.answers||[],Uo)+Fm(t.authorities||[],Uo)+Fm(t.additionals||[],Uo)}};gp.encode.bytes=0;gp.decode.bytes=0;const Hv=gp.encode,jI=gp.decode,Xle=gp.encodingLength;function Fm(t,e){let r=0;for(let n=0;n<t.length;n++)r+=e.encodingLength(t[n]);return r}function k0(t,e,r,n){for(let s=0;s<t.length;s++)e.encode(t[s],r,n),n+=e.encode.bytes;return n}function cb(t,e,r,n){for(let s=0;s<t.length;s++)t[s]=e.decode(r,n),n+=e.decode.bytes;return n}var UB=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let Uw=class{static getSigningMethod(e){return UB(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement getSigningMethod()")})}static resolve(e,r){return UB(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement resolve()")})}};var ri=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},LB=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};const KB="https://diddht.tbddev.org",Yle=0,Jl=7200,b1=";",is=",";var zx;(function(t){t[t.Discoverable=0]="Discoverable",t[t.Organization=1]="Organization",t[t.Government=2]="Government",t[t.Corporation=3]="Corporation",t[t.LocalBusiness=4]="LocalBusiness",t[t.SoftwarePackage=5]="SoftwarePackage",t[t.WebApp=6]="WebApp",t[t.FinancialInstitution=7]="FinancialInstitution"})(zx||(zx={}));var fs;(function(t){t[t.Ed25519=0]="Ed25519",t[t.secp256k1=1]="secp256k1",t[t.secp256r1=2]="secp256r1",t[t.X25519=3]="X25519"})(fs||(fs={}));var Wx;(function(t){t.authentication="auth",t.assertionMethod="asm",t.capabilityDelegation="del",t.capabilityInvocation="inv",t.keyAgreement="agm"})(Wx||(Wx={}));const jL={Ed25519:fs.Ed25519,ES256K:fs.secp256k1,ES256:fs.secp256r1,"P-256":fs.secp256r1,secp256k1:fs.secp256k1,secp256r1:fs.secp256r1,X25519:fs.X25519},VB={[fs.Ed25519]:"EdDSA",[fs.secp256k1]:"ES256K",[fs.secp256r1]:"ES256",[fs.X25519]:"ECDH-ES+A256KW"};let CE=class Gx extends Uw{static create(){return ri(this,arguments,void 0,function*({keyManager:e=new ml,options:r={}}={}){var n,s,i,o,a,u,l,c,d,h,f;if(!((n=r.verificationMethods)===null||n===void 0)&&n.some(S=>!(S.algorithm in jL)))throw new Error("One or more verification method algorithms are not supported");const p=(s=r.verificationMethods)===null||s===void 0?void 0:s.filter(S=>"id"in S).map(S=>S.id);if(p&&p.length!==new Set(p).size)throw new Error("One or more verification method IDs are not unique");if(!((i=r.services)===null||i===void 0)&&i.some(S=>!S.id||!S.type||!S.serviceEndpoint))throw new Error("One or more services are missing required properties");const m=yield e.generateKey({algorithm:"Ed25519"}),E=yield e.getPublicKey({keyUri:m}),A=yield Wi.identityKeyToIdentifier({identityKey:E}),_=Object.assign(Object.assign({id:A},r.alsoKnownAs&&{alsoKnownAs:r.alsoKnownAs}),r.controllers&&{controller:r.controllers}),g=[...(o=r.verificationMethods)!==null&&o!==void 0?o:[]];g!=null&&g.some(S=>{var x;return((x=S.id)===null||x===void 0?void 0:x.split("#").pop())==="0"})||g.unshift({algorithm:"Ed25519",id:"0",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]});for(const S of g){const x=S.id&&S.id.split("#").pop()==="0"?m:yield e.generateKey({algorithm:S.algorithm}),D=yield e.getPublicKey({keyUri:x});let w=(u=(a=S.id)!==null&&a!==void 0?a:D.kid)!==null&&u!==void 0?u:yield Rr({jwk:D});w=`${A}#${Oa(w)}`,(l=_.verificationMethod)!==null&&l!==void 0||(_.verificationMethod=[]),_.verificationMethod.push({id:w,type:"JsonWebKey",controller:(c=S.controller)!==null&&c!==void 0?c:A,publicKeyJwk:D});for(const b of(d=S.purposes)!==null&&d!==void 0?d:[])_[b]||(_[b]=[]),_[b].push(w)}(h=r.services)===null||h===void 0||h.forEach(S=>{var x;(x=_.service)!==null&&x!==void 0||(_.service=[]),S.id=`${A}#${S.id.split("#").pop()}`,_.service.push(S)});const v=new yf({uri:A,document:_,metadata:Object.assign({published:!1},r.types&&{types:r.types}),keyManager:e});if(!((f=r.publish)!==null&&f!==void 0)||f){const S=yield Gx.publish({did:v,gatewayUri:r.gatewayUri});v.metadata=S.didDocumentMetadata}return v})}static import(e){return ri(this,arguments,void 0,function*({portableDid:r,keyManager:n=new ml}){var s;const i=_r.parse(r.uri);if((i==null?void 0:i.method)!==Gx.methodName)throw new ht(st.MethodNotSupported,"Method not supported");const o=yield yf.import({portableDid:r,keyManager:n});if(!(!((s=o.document.verificationMethod)===null||s===void 0)&&s.some(a=>{var u;return((u=a.id)===null||u===void 0?void 0:u.split("#").pop())==="0"})))throw new ht(st.InvalidDidDocument,"DID document must contain an Identity Key");return o})}static getSigningMethod(e){return ri(this,arguments,void 0,function*({didDocument:r,methodId:n="#0"}){var s;const i=_r.parse(r.id);if(i&&i.method!==this.methodName)throw new ht(st.MethodNotSupported,`Method not supported: ${i.method}`);const o=(s=r.verificationMethod)===null||s===void 0?void 0:s.find(a=>{var u,l;return Oa(a.id)===((u=Oa(n))!==null&&u!==void 0?u:Oa((l=r.assertionMethod)===null||l===void 0?void 0:l[0]))});if(!(o&&o.publicKeyJwk))throw new ht(st.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static publish(e){return ri(this,arguments,void 0,function*({did:r,gatewayUri:n=KB}){return yield qB.put({did:r,gatewayUri:n})})}static resolve(e){return ri(this,arguments,void 0,function*(r,n={}){var s;const i=(s=n==null?void 0:n.gatewayUri)!==null&&s!==void 0?s:KB;try{yield Wi.identifierToIdentityKey({didUri:r});const{didDocument:o,didDocumentMetadata:a}=yield qB.get({didUri:r,gatewayUri:i});return Object.assign(Object.assign({},Ri),{didDocument:o,didDocumentMetadata:a})}catch(o){if(!(o instanceof ht))throw new Error(o);return Object.assign(Object.assign({},Ri),{didResolutionMetadata:Object.assign({error:o.code},o.message&&{errorMessage:o.message})})}})}};CE.methodName="dht";let qB=class yh{static get(e){return ri(this,arguments,void 0,function*({didUri:r,gatewayUri:n}){const s=Wi.identifierToIdentityKeyBytes({didUri:r}),i=yield yh.pkarrGet({gatewayUri:n,publicKeyBytes:s}),o=yield Wi.parseBep44GetMessage({bep44Message:i}),a=yield yh.fromDnsPacket({didUri:r,dnsPacket:o});return a.didDocumentMetadata.versionId=i.seq.toString(),a})}static put(e){return ri(this,arguments,void 0,function*({did:r,gatewayUri:n}){const s=yield yh.toDnsPacket({didDocument:r.document,didMetadata:r.metadata,authoritativeGatewayUris:[n]}),i=yield Wi.createBep44PutMessage({dnsPacket:s,publicKeyBytes:Wi.identifierToIdentityKeyBytes({didUri:r.uri}),signer:yield r.getSigner({methodId:"0"})}),o=yield yh.pkarrPut({gatewayUri:n,bep44Message:i});return{didDocument:r.document,didDocumentMetadata:Object.assign(Object.assign({},r.metadata),{published:o,versionId:i.seq.toString()}),didRegistrationMetadata:{}}})}static pkarrGet(e){return ri(this,arguments,void 0,function*({gatewayUri:r,publicKeyBytes:n}){const s=vt.uint8Array(n).toBase32Z(),i=new URL(s,r).href;let o;try{if(o=yield fetch(i,{method:"GET"}),!o.ok)throw new ht(st.NotFound,`Pkarr record not found for: ${s}`)}catch(l){throw l instanceof ht?l:new ht(st.InternalError,`Failed to fetch Pkarr record: ${l.message}`)}const a=yield o.arrayBuffer();if(!a)throw new ht(st.NotFound,`Pkarr record not found for: ${s}`);if(a.byteLength<72)throw new ht(st.InvalidDidDocumentLength,`Pkarr response must be at least 72 bytes but got: ${a.byteLength}`);if(a.byteLength>1072)throw new ht(st.InvalidDidDocumentLength,`Pkarr response exceeds 1000 byte limit: ${a.byteLength}`);return{k:n,seq:Number(new DataView(a).getBigUint64(64)),sig:new Uint8Array(a,0,64),v:new Uint8Array(a,72)}})}static pkarrPut(e){return ri(this,arguments,void 0,function*({gatewayUri:r,bep44Message:n}){const s=vt.uint8Array(n.k).toBase32Z(),i=new URL(s,r).href,o=new Uint8Array(n.v.length+72);o.set(n.sig,0),new DataView(o.buffer).setBigUint64(n.sig.length,BigInt(n.seq)),o.set(n.v,n.sig.length+8);let a;try{a=yield fetch(i,{method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:o})}catch(u){throw new ht(st.InternalError,`Failed to put Pkarr record for identifier ${s}: ${u.message}`)}return a.ok})}static fromDnsPacket(e){return ri(this,arguments,void 0,function*({didUri:r,dnsPacket:n}){var s,i,o;const a={id:r},u={published:!0},l=new Map;for(const c of(s=n==null?void 0:n.answers)!==null&&s!==void 0?s:[]){if(c.type!=="TXT")continue;const d=c.name.split(".")[0].substring(1);switch(!0){case d.startsWith("aka"):{const h=Wi.parseTxtDataToString(c.data);a.alsoKnownAs=h.split(is);break}case d.startsWith("cnt"):{const h=Wi.parseTxtDataToString(c.data);a.controller=h.includes(is)?h.split(is):h;break}case d.startsWith("k"):{const{id:h,t:f,k:p,c:m,a:E}=Wi.parseTxtDataToObject(c.data),A=vt.base64Url(p).toUint8Array(),_=fs[Number(f)];let g=yield Wi.keyConverter(_).bytesToPublicKey({publicKeyBytes:A});g.alg=E||VB[Number(f)];const v=d==="k0"?"0":h!==void 0?h:yield Rr({jwk:g});(i=a.verificationMethod)!==null&&i!==void 0||(a.verificationMethod=[]);const S=`${r}#${v}`;a.verificationMethod.push({id:S,type:"JsonWebKey",controller:m??r,publicKeyJwk:g}),l.set(d,S);break}case d.startsWith("s"):{const h=Wi.parseTxtDataToObject(c.data),{id:f,t:p,se:m}=h,E=LB(h,["id","t","se"]),A=m.includes(is)?m.split(is):[m],_=Object.fromEntries(Object.entries(E).map(([g,v])=>[g,v.includes(is)?v.split(is):v]));(o=a.service)!==null&&o!==void 0||(a.service=[]),a.service.push(Object.assign(Object.assign({},_),{id:`${r}#${f}`,type:p,serviceEndpoint:A}));break}case d.startsWith("typ"):{const{id:h}=Wi.parseTxtDataToObject(c.data);u.types=h.split(is).map(f=>Number(f));break}case d.startsWith("did"):{const h=_=>_.split(is).map(g=>l.get(g)).filter(g=>typeof g=="string"),{auth:f,asm:p,del:m,inv:E,agm:A}=Wi.parseTxtDataToObject(c.data);f&&(a.authentication=h(f)),p&&(a.assertionMethod=h(p)),m&&(a.capabilityDelegation=h(m)),E&&(a.capabilityInvocation=h(E)),A&&(a.keyAgreement=h(A));break}}}return{didDocument:a,didDocumentMetadata:u,didResolutionMetadata:{}}})}static toDnsPacket(e){return ri(this,arguments,void 0,function*({didDocument:r,didMetadata:n,authoritativeGatewayUris:s,previousDidProof:i}){var o,a,u,l,c;const d=[],h=[],f=new Map,p=[],m=[];if(i!==void 0){const{signature:_,previousDid:g}=i;yield Wi.validatePreviousDidProof({newDid:r.id,previousDidProof:i}),d.push({type:"TXT",name:"_prv._did.",ttl:Jl,data:`id=${g};s=${_}`})}if(r.alsoKnownAs&&d.push({type:"TXT",name:"_aka._did.",ttl:Jl,data:r.alsoKnownAs.join(is)}),r.controller){const _=Array.isArray(r.controller)?r.controller.join(is):r.controller;d.push({type:"TXT",name:"_cnt._did.",ttl:Jl,data:_})}for(const[_,g]of(a=(o=r.verificationMethod)===null||o===void 0?void 0:o.entries())!==null&&a!==void 0?a:[]){const v=`k${_}`;m.push(v);let S=g.id.split("#").pop();f.set(S,v);const x=g.publicKeyJwk;if(!(x!=null&&x.crv&&x.crv in jL))throw new ht(st.InvalidPublicKeyType,`Verification method '${g.id}' contains an unsupported key type: ${(u=x==null?void 0:x.crv)!==null&&u!==void 0?u:"undefined"}`);const D=fs[x.crv],w=yield Wi.keyConverter(x.crv).publicKeyToBytes({publicKey:x}),b=vt.uint8Array(w).toBase64Url(),T=[`t=${D}`,`k=${b}`];S!=="0"&&(yield Rr({jwk:x}))!==S&&T.unshift(`id=${S}`),x.alg!==VB[D]&&T.push(`a=${x.alg}`),g.controller!==r.id&&T.push(`c=${g.controller}`),d.push({type:"TXT",name:`_${v}._did.`,ttl:Jl,data:T.join(b1)})}(l=r.service)===null||l===void 0||l.forEach((_,g)=>{const v=`s${g}`;p.push(v);let{id:S,type:x,serviceEndpoint:D}=_,w=LB(_,["id","type","serviceEndpoint"]);S=Oa(S),D=Array.isArray(D)?D.join(","):D;const T=Object.entries(Object.assign({id:S,t:x,se:D},w)).map(([C,k])=>`${C}=${k}`).join(b1),P=Wi.chunkDataIfNeeded(T);d.push({type:"TXT",name:`_${v}._did.`,ttl:Jl,data:P})});const E=[`v=${Yle}`];if(m.length&&E.push(`vm=${m.join(is)}`),Object.keys(Lv).forEach(_=>{var g;const v=(g=r[_])===null||g===void 0?void 0:g.map(S=>f.get(S.split("#").pop()));if(v){const S=Wx[_];E.push(`${S}=${v.join(is)}`)}}),p.length&&E.push(`svc=${p.join(is)}`),!((c=n.types)===null||c===void 0)&&c.length){const g=n.types.map(v=>typeof v=="string"?zx[v]:v);d.push({type:"TXT",name:"_typ._did.",ttl:Jl,data:`id=${g.join(is)}`})}d.push({type:"TXT",name:"_did."+yh.getUniqueDidSuffix(r.id)+".",ttl:Jl,data:E.join(b1)});for(const _ of s||[])h.push({type:"NS",name:"_did."+yh.getUniqueDidSuffix(r.id)+".",ttl:Jl,data:_+"."});return{id:0,type:"response",flags:MI,answers:[...d,...h]}})}static getUniqueDidSuffix(e){return e.split(":")[2]}},Wi=class E1{static createBep44PutMessage(e){return ri(this,arguments,void 0,function*({dnsPacket:r,publicKeyBytes:n,signer:s}){const i=Math.ceil(Date.now()/1e3),o=Hv(r),a=gy.encode({seq:i,v:o}).subarray(1,-1);if(a.length>1e3)throw new ht(st.InvalidDidDocumentLength,`DNS packet exceeds the 1000 byte maximum size: ${a.length} bytes`);const u=yield s.sign({data:a});return{k:n,seq:i,sig:u,v:o}})}static identifierToIdentityKey(e){return ri(this,arguments,void 0,function*({didUri:r}){let n=E1.identifierToIdentityKeyBytes({didUri:r});return yield Bs.bytesToPublicKey({publicKeyBytes:n})})}static identifierToIdentityKeyBytes({didUri:e}){const r=_r.parse(e);if(!r)throw new ht(st.InvalidDid,`Invalid DID URI: ${e}`);if(r.method!==CE.methodName)throw new ht(st.MethodNotSupported,`Method not supported: ${r.method}`);let n;try{n=vt.base32Z(r.id).toUint8Array()}catch{throw new ht(st.InvalidPublicKey,"Failed to decode method-specific identifier")}if(n.length!==32)throw new ht(st.InvalidPublicKeyLength,`Invalid public key length: ${n.length}`);return n}static identityKeyToIdentifier(e){return ri(this,arguments,void 0,function*({identityKey:r}){const n=yield Bs.publicKeyToBytes({publicKey:r}),s=vt.uint8Array(n).toBase32Z();return`did:${CE.methodName}:${s}`})}static keyConverter(e){const n={Ed25519:Bs,"P-256":{publicKeyToBytes:s=>ri(this,[s],void 0,function*({publicKey:i}){const o=yield Xo.publicKeyToBytes({publicKey:i});return yield Xo.compressPublicKey({publicKeyBytes:o})}),bytesToPublicKey:Xo.bytesToPublicKey,privateKeyToBytes:Xo.privateKeyToBytes,bytesToPrivateKey:Xo.bytesToPrivateKey},secp256k1:{publicKeyToBytes:s=>ri(this,[s],void 0,function*({publicKey:i}){const o=yield lo.publicKeyToBytes({publicKey:i});return yield lo.compressPublicKey({publicKeyBytes:o})}),bytesToPublicKey:lo.bytesToPublicKey,privateKeyToBytes:lo.privateKeyToBytes,bytesToPrivateKey:lo.bytesToPrivateKey},X25519:EL}[e];if(!n)throw new ht(st.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static parseBep44GetMessage(e){return ri(this,arguments,void 0,function*({bep44Message:r}){const n=yield Bs.bytesToPublicKey({publicKeyBytes:r.k}),s=gy.encode({seq:r.seq,v:r.v}).subarray(1,-1);if(!(yield Bs.verify({key:n,signature:r.sig,data:s})))throw new ht(st.InvalidSignature,"Invalid signature for DHT BEP44 message");return jI(r.v)})}static parseTxtDataToObject(e){return this.parseTxtDataToString(e).split(b1).reduce((r,n)=>{const[s,i]=n.split("=");return r[s]=i,r},{})}static parseTxtDataToString(e){if(typeof e=="string")return e;if(e instanceof Uint8Array)return vt.uint8Array(e).toString();if(Array.isArray(e))return e.map(r=>this.parseTxtDataToString(r)).join("");throw new ht(st.InternalError,"Pkarr returned DNS TXT record with invalid data type")}static validatePreviousDidProof(e){return ri(this,arguments,void 0,function*({newDid:r,previousDidProof:n}){const s=yield E1.identifierToIdentityKey({didUri:n.previousDid}),i=E1.identifierToIdentityKeyBytes({didUri:r}),o=vt.base64Url(n.signature).toUint8Array();if(!(yield Bs.verify({key:s,data:i,signature:o})))throw new ht(st.InvalidPreviousDidProof,"The previous DID proof is invalid.")})}static chunkDataIfNeeded(e){if(e.length<=255)return e;const r=[];for(let n=0;n<e.length;n+=255)r.push(e.slice(n,n+255));return r}};const An={DeltaExceedsMaximumSize:"DeltaExceedsMaximumSize",DidDocumentPublicKeyIdDuplicated:"DidDocumentPublicKeyIdDuplicated",DidDocumentPublicKeyMissingOrIncorrectType:"DidDocumentPublicKeyMissingOrIncorrectType",DidDocumentServiceIdDuplicated:"DidDocumentServiceIdDuplicated",DidSuffixIncorrectLength:"DidSuffixIncorrectLength",EncodedStringIncorrectEncoding:"EncodedStringIncorrectEncoding",IdNotUsingBase64UrlCharacterSet:"IdNotUsingBase64UrlCharacterSet",IdTooLong:"IdTooLong",JwkEs256kMissingOrInvalidCrv:"JwkEs256kMissingOrInvalidCrv",JwkEs256kMissingOrInvalidKty:"JwkEs256kMissingOrInvalidKty",JwkEs256kHasIncorrectLengthOfX:"JwkEs256kHasIncorrectLengthOfX",JwkEs256kHasIncorrectLengthOfY:"JwkEs256kHasIncorrectLengthOfY",JwkEs256kHasIncorrectLengthOfD:"JwkEs256kHasIncorrectLengthOfD",MultihashStringNotAMultihash:"MultihashStringNotAMultihash",MultihashUnsupportedHashAlgorithm:"MultihashUnsupportedHashAlgorithm",PublicKeyJwkEs256kHasUnexpectedProperty:"PublicKeyJwkEs256kHasUnexpectedProperty",PublicKeyPurposeDuplicated:"PublicKeyPurposeDuplicated",ServiceEndpointCannotBeAnArray:"ServiceEndpointCannotBeAnArray",ServiceEndpointStringNotValidUri:"ServiceEndpointStringNotValidUri",ServiceTypeTooLong:"ServiceTypeTooLong"};class Sn extends Error{constructor(e,r){super(`${e}: ${r}`),this.code=e,Object.setPrototypeOf(this,new.target.prototype)}}const Zle=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};let Qle=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},ede=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return UL(this,e)}},tde=class{constructor(e){this.decoders=e}or(e){return UL(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const UL=(t,e)=>new tde({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let rde=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new Qle(e,r,n),this.decoder=new ede(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const nde=({name:t,prefix:e,encode:r,decode:n})=>new rde(t,e,r,n),ide=(t,e,r,n)=>{const s={};for(let c=0;c<e.length;++c)s[e[c]]=c;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,u=0,l=0;for(let c=0;c<i;++c){const d=s[t[c]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);u=u<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&u>>a)}if(a>=r||255&u<<8-a)throw new SyntaxError("Unexpected end of data");return o},sde=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let u=0;u<t.length;++u)for(a=a<<8|t[u],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},pS=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>nde({prefix:e,name:t,encode(s){return sde(s,n,r)},decode(s){return ide(s,n,r,t)}});pS({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});pS({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const HB=pS({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});pS({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});let vy=class A1{static encode(e){return HB.baseEncode(e)}static decodeAsBytes(e,r){if(!A1.isBase64UrlString(e))throw new Sn(An.EncodedStringIncorrectEncoding,`Given ${r} must be base64url string.`);return HB.baseDecode(e)}static decodeAsString(e,r){const n=A1.decodeAsBytes(e,r);return A1.bytesToString(n)}static isBase64UrlString(e){return/^[A-Za-z0-9_-]+$/.test(e)}static stringToBytes(e){return new TextEncoder().encode(e)}static bytesToString(e){return new TextDecoder().decode(e)}};var Jx={exports:{}};/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */(function(t,e){(function(r,n){n(e)})(Ar,function(r){function n(){for(var de=arguments.length,ue=Array(de),fe=0;fe<de;fe++)ue[fe]=arguments[fe];if(ue.length>1){ue[0]=ue[0].slice(0,-1);for(var Ae=ue.length-1,Ee=1;Ee<Ae;++Ee)ue[Ee]=ue[Ee].slice(1,-1);return ue[Ae]=ue[Ae].slice(1),ue.join("")}else return ue[0]}function s(de){return"(?:"+de+")"}function i(de){return de===void 0?"undefined":de===null?"null":Object.prototype.toString.call(de).split(" ").pop().split("]").shift().toLowerCase()}function o(de){return de.toUpperCase()}function a(de){return de!=null?de instanceof Array?de:typeof de.length!="number"||de.split||de.setInterval||de.call?[de]:Array.prototype.slice.call(de):[]}function u(de,ue){var fe=de;if(ue)for(var Ae in ue)fe[Ae]=ue[Ae];return fe}function l(de){var ue="[A-Za-z]",fe="[0-9]",Ae=n(fe,"[A-Fa-f]"),Ee=s(s("%[EFef]"+Ae+"%"+Ae+Ae+"%"+Ae+Ae)+"|"+s("%[89A-Fa-f]"+Ae+"%"+Ae+Ae)+"|"+s("%"+Ae+Ae)),We="[\\:\\/\\?\\#\\[\\]\\@]",it="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",Yt=n(We,it),Sr=de?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",Tr=de?"[\\uE000-\\uF8FF]":"[]",Gt=n(ue,fe,"[\\-\\.\\_\\~]",Sr);s(ue+n(ue,fe,"[\\+\\-\\.]")+"*"),s(s(Ee+"|"+n(Gt,it,"[\\:]"))+"*");var Pr=s(s("25[0-5]")+"|"+s("2[0-4]"+fe)+"|"+s("1"+fe+fe)+"|"+s("0?[1-9]"+fe)+"|0?0?"+fe),Zr=s(Pr+"\\."+Pr+"\\."+Pr+"\\."+Pr),Dt=s(Ae+"{1,4}"),Ur=s(s(Dt+"\\:"+Dt)+"|"+Zr),cn=s(s(Dt+"\\:")+"{6}"+Ur),Gr=s("\\:\\:"+s(Dt+"\\:")+"{5}"+Ur),Gs=s(s(Dt)+"?\\:\\:"+s(Dt+"\\:")+"{4}"+Ur),Js=s(s(s(Dt+"\\:")+"{0,1}"+Dt)+"?\\:\\:"+s(Dt+"\\:")+"{3}"+Ur),bs=s(s(s(Dt+"\\:")+"{0,2}"+Dt)+"?\\:\\:"+s(Dt+"\\:")+"{2}"+Ur),So=s(s(s(Dt+"\\:")+"{0,3}"+Dt)+"?\\:\\:"+Dt+"\\:"+Ur),ns=s(s(s(Dt+"\\:")+"{0,4}"+Dt)+"?\\:\\:"+Ur),Li=s(s(s(Dt+"\\:")+"{0,5}"+Dt)+"?\\:\\:"+Dt),To=s(s(s(Dt+"\\:")+"{0,6}"+Dt)+"?\\:\\:"),Xa=s([cn,Gr,Gs,Js,bs,So,ns,Li,To].join("|")),Do=s(s(Gt+"|"+Ee)+"+");s("[vV]"+Ae+"+\\."+n(Gt,it,"[\\:]")+"+"),s(s(Ee+"|"+n(Gt,it))+"*");var kl=s(Ee+"|"+n(Gt,it,"[\\:\\@]"));return s(s(Ee+"|"+n(Gt,it,"[\\@]"))+"+"),s(s(kl+"|"+n("[\\/\\?]",Tr))+"*"),{NOT_SCHEME:new RegExp(n("[^]",ue,fe,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(n("[^\\%\\:]",Gt,it),"g"),NOT_HOST:new RegExp(n("[^\\%\\[\\]\\:]",Gt,it),"g"),NOT_PATH:new RegExp(n("[^\\%\\/\\:\\@]",Gt,it),"g"),NOT_PATH_NOSCHEME:new RegExp(n("[^\\%\\/\\@]",Gt,it),"g"),NOT_QUERY:new RegExp(n("[^\\%]",Gt,it,"[\\:\\@\\/\\?]",Tr),"g"),NOT_FRAGMENT:new RegExp(n("[^\\%]",Gt,it,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(n("[^]",Gt,it),"g"),UNRESERVED:new RegExp(Gt,"g"),OTHER_CHARS:new RegExp(n("[^\\%]",Gt,Yt),"g"),PCT_ENCODED:new RegExp(Ee,"g"),IPV4ADDRESS:new RegExp("^("+Zr+")$"),IPV6ADDRESS:new RegExp("^\\[?("+Xa+")"+s(s("\\%25|\\%(?!"+Ae+"{2})")+"("+Do+")")+"?\\]?$")}}var c=l(!1),d=l(!0),h=function(){function de(ue,fe){var Ae=[],Ee=!0,We=!1,it=void 0;try{for(var Yt=ue[Symbol.iterator](),Sr;!(Ee=(Sr=Yt.next()).done)&&(Ae.push(Sr.value),!(fe&&Ae.length===fe));Ee=!0);}catch(Tr){We=!0,it=Tr}finally{try{!Ee&&Yt.return&&Yt.return()}finally{if(We)throw it}}return Ae}return function(ue,fe){if(Array.isArray(ue))return ue;if(Symbol.iterator in Object(ue))return de(ue,fe);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f=function(de){if(Array.isArray(de)){for(var ue=0,fe=Array(de.length);ue<de.length;ue++)fe[ue]=de[ue];return fe}else return Array.from(de)},p=2147483647,m=36,E=1,A=26,_=38,g=700,v=72,S=128,x="-",D=/^xn--/,w=/[^\0-\x7E]/,b=/[\x2E\u3002\uFF0E\uFF61]/g,T={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},P=m-E,C=Math.floor,k=String.fromCharCode;function K(de){throw new RangeError(T[de])}function L(de,ue){for(var fe=[],Ae=de.length;Ae--;)fe[Ae]=ue(de[Ae]);return fe}function q(de,ue){var fe=de.split("@"),Ae="";fe.length>1&&(Ae=fe[0]+"@",de=fe[1]),de=de.replace(b,".");var Ee=de.split("."),We=L(Ee,ue).join(".");return Ae+We}function se(de){for(var ue=[],fe=0,Ae=de.length;fe<Ae;){var Ee=de.charCodeAt(fe++);if(Ee>=55296&&Ee<=56319&&fe<Ae){var We=de.charCodeAt(fe++);(We&64512)==56320?ue.push(((Ee&1023)<<10)+(We&1023)+65536):(ue.push(Ee),fe--)}else ue.push(Ee)}return ue}var X=function(ue){return String.fromCodePoint.apply(String,f(ue))},re=function(ue){return ue-48<10?ue-22:ue-65<26?ue-65:ue-97<26?ue-97:m},W=function(ue,fe){return ue+22+75*(ue<26)-((fe!=0)<<5)},B=function(ue,fe,Ae){var Ee=0;for(ue=Ae?C(ue/g):ue>>1,ue+=C(ue/fe);ue>P*A>>1;Ee+=m)ue=C(ue/P);return C(Ee+(P+1)*ue/(ue+_))},te=function(ue){var fe=[],Ae=ue.length,Ee=0,We=S,it=v,Yt=ue.lastIndexOf(x);Yt<0&&(Yt=0);for(var Sr=0;Sr<Yt;++Sr)ue.charCodeAt(Sr)>=128&&K("not-basic"),fe.push(ue.charCodeAt(Sr));for(var Tr=Yt>0?Yt+1:0;Tr<Ae;){for(var Gt=Ee,Pr=1,Zr=m;;Zr+=m){Tr>=Ae&&K("invalid-input");var Dt=re(ue.charCodeAt(Tr++));(Dt>=m||Dt>C((p-Ee)/Pr))&&K("overflow"),Ee+=Dt*Pr;var Ur=Zr<=it?E:Zr>=it+A?A:Zr-it;if(Dt<Ur)break;var cn=m-Ur;Pr>C(p/cn)&&K("overflow"),Pr*=cn}var Gr=fe.length+1;it=B(Ee-Gt,Gr,Gt==0),C(Ee/Gr)>p-We&&K("overflow"),We+=C(Ee/Gr),Ee%=Gr,fe.splice(Ee++,0,We)}return String.fromCodePoint.apply(String,fe)},z=function(ue){var fe=[];ue=se(ue);var Ae=ue.length,Ee=S,We=0,it=v,Yt=!0,Sr=!1,Tr=void 0;try{for(var Gt=ue[Symbol.iterator](),Pr;!(Yt=(Pr=Gt.next()).done);Yt=!0){var Zr=Pr.value;Zr<128&&fe.push(k(Zr))}}catch($l){Sr=!0,Tr=$l}finally{try{!Yt&&Gt.return&&Gt.return()}finally{if(Sr)throw Tr}}var Dt=fe.length,Ur=Dt;for(Dt&&fe.push(x);Ur<Ae;){var cn=p,Gr=!0,Gs=!1,Js=void 0;try{for(var bs=ue[Symbol.iterator](),So;!(Gr=(So=bs.next()).done);Gr=!0){var ns=So.value;ns>=Ee&&ns<cn&&(cn=ns)}}catch($l){Gs=!0,Js=$l}finally{try{!Gr&&bs.return&&bs.return()}finally{if(Gs)throw Js}}var Li=Ur+1;cn-Ee>C((p-We)/Li)&&K("overflow"),We+=(cn-Ee)*Li,Ee=cn;var To=!0,Xa=!1,Do=void 0;try{for(var kl=ue[Symbol.iterator](),zp;!(To=(zp=kl.next()).done);To=!0){var Wp=zp.value;if(Wp<Ee&&++We>p&&K("overflow"),Wp==Ee){for(var Bf=We,Ff=m;;Ff+=m){var Gp=Ff<=it?E:Ff>=it+A?A:Ff-it;if(Bf<Gp)break;var p_=Bf-Gp,ug=m-Gp;fe.push(k(W(Gp+p_%ug,0))),Bf=C(p_/ug)}fe.push(k(W(Bf,0))),it=B(We,Li,Ur==Dt),We=0,++Ur}}}catch($l){Xa=!0,Do=$l}finally{try{!To&&kl.return&&kl.return()}finally{if(Xa)throw Do}}++We,++Ee}return fe.join("")},$=function(ue){return q(ue,function(fe){return D.test(fe)?te(fe.slice(4).toLowerCase()):fe})},F=function(ue){return q(ue,function(fe){return w.test(fe)?"xn--"+z(fe):fe})},ee={version:"2.1.0",ucs2:{decode:se,encode:X},decode:te,encode:z,toASCII:F,toUnicode:$},ne={};function le(de){var ue=de.charCodeAt(0),fe=void 0;return ue<16?fe="%0"+ue.toString(16).toUpperCase():ue<128?fe="%"+ue.toString(16).toUpperCase():ue<2048?fe="%"+(ue>>6|192).toString(16).toUpperCase()+"%"+(ue&63|128).toString(16).toUpperCase():fe="%"+(ue>>12|224).toString(16).toUpperCase()+"%"+(ue>>6&63|128).toString(16).toUpperCase()+"%"+(ue&63|128).toString(16).toUpperCase(),fe}function me(de){for(var ue="",fe=0,Ae=de.length;fe<Ae;){var Ee=parseInt(de.substr(fe+1,2),16);if(Ee<128)ue+=String.fromCharCode(Ee),fe+=3;else if(Ee>=194&&Ee<224){if(Ae-fe>=6){var We=parseInt(de.substr(fe+4,2),16);ue+=String.fromCharCode((Ee&31)<<6|We&63)}else ue+=de.substr(fe,6);fe+=6}else if(Ee>=224){if(Ae-fe>=9){var it=parseInt(de.substr(fe+4,2),16),Yt=parseInt(de.substr(fe+7,2),16);ue+=String.fromCharCode((Ee&15)<<12|(it&63)<<6|Yt&63)}else ue+=de.substr(fe,9);fe+=9}else ue+=de.substr(fe,3),fe+=3}return ue}function ve(de,ue){function fe(Ae){var Ee=me(Ae);return Ee.match(ue.UNRESERVED)?Ee:Ae}return de.scheme&&(de.scheme=String(de.scheme).replace(ue.PCT_ENCODED,fe).toLowerCase().replace(ue.NOT_SCHEME,"")),de.userinfo!==void 0&&(de.userinfo=String(de.userinfo).replace(ue.PCT_ENCODED,fe).replace(ue.NOT_USERINFO,le).replace(ue.PCT_ENCODED,o)),de.host!==void 0&&(de.host=String(de.host).replace(ue.PCT_ENCODED,fe).toLowerCase().replace(ue.NOT_HOST,le).replace(ue.PCT_ENCODED,o)),de.path!==void 0&&(de.path=String(de.path).replace(ue.PCT_ENCODED,fe).replace(de.scheme?ue.NOT_PATH:ue.NOT_PATH_NOSCHEME,le).replace(ue.PCT_ENCODED,o)),de.query!==void 0&&(de.query=String(de.query).replace(ue.PCT_ENCODED,fe).replace(ue.NOT_QUERY,le).replace(ue.PCT_ENCODED,o)),de.fragment!==void 0&&(de.fragment=String(de.fragment).replace(ue.PCT_ENCODED,fe).replace(ue.NOT_FRAGMENT,le).replace(ue.PCT_ENCODED,o)),de}function Pe(de){return de.replace(/^0*(.*)/,"$1")||"0"}function Ue(de,ue){var fe=de.match(ue.IPV4ADDRESS)||[],Ae=h(fe,2),Ee=Ae[1];return Ee?Ee.split(".").map(Pe).join("."):de}function M(de,ue){var fe=de.match(ue.IPV6ADDRESS)||[],Ae=h(fe,3),Ee=Ae[1],We=Ae[2];if(Ee){for(var it=Ee.toLowerCase().split("::").reverse(),Yt=h(it,2),Sr=Yt[0],Tr=Yt[1],Gt=Tr?Tr.split(":").map(Pe):[],Pr=Sr.split(":").map(Pe),Zr=ue.IPV4ADDRESS.test(Pr[Pr.length-1]),Dt=Zr?7:8,Ur=Pr.length-Dt,cn=Array(Dt),Gr=0;Gr<Dt;++Gr)cn[Gr]=Gt[Gr]||Pr[Ur+Gr]||"";Zr&&(cn[Dt-1]=Ue(cn[Dt-1],ue));var Gs=cn.reduce(function(Li,To,Xa){if(!To||To==="0"){var Do=Li[Li.length-1];Do&&Do.index+Do.length===Xa?Do.length++:Li.push({index:Xa,length:1})}return Li},[]),Js=Gs.sort(function(Li,To){return To.length-Li.length})[0],bs=void 0;if(Js&&Js.length>1){var So=cn.slice(0,Js.index),ns=cn.slice(Js.index+Js.length);bs=So.join(":")+"::"+ns.join(":")}else bs=cn.join(":");return We&&(bs+="%"+We),bs}else return de}var V=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,oe="".match(/(){0}/)[1]===void 0;function j(de){var ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},fe={},Ae=ue.iri!==!1?d:c;ue.reference==="suffix"&&(de=(ue.scheme?ue.scheme+":":"")+"//"+de);var Ee=de.match(V);if(Ee){oe?(fe.scheme=Ee[1],fe.userinfo=Ee[3],fe.host=Ee[4],fe.port=parseInt(Ee[5],10),fe.path=Ee[6]||"",fe.query=Ee[7],fe.fragment=Ee[8],isNaN(fe.port)&&(fe.port=Ee[5])):(fe.scheme=Ee[1]||void 0,fe.userinfo=de.indexOf("@")!==-1?Ee[3]:void 0,fe.host=de.indexOf("//")!==-1?Ee[4]:void 0,fe.port=parseInt(Ee[5],10),fe.path=Ee[6]||"",fe.query=de.indexOf("?")!==-1?Ee[7]:void 0,fe.fragment=de.indexOf("#")!==-1?Ee[8]:void 0,isNaN(fe.port)&&(fe.port=de.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?Ee[4]:void 0)),fe.host&&(fe.host=M(Ue(fe.host,Ae),Ae)),fe.scheme===void 0&&fe.userinfo===void 0&&fe.host===void 0&&fe.port===void 0&&!fe.path&&fe.query===void 0?fe.reference="same-document":fe.scheme===void 0?fe.reference="relative":fe.fragment===void 0?fe.reference="absolute":fe.reference="uri",ue.reference&&ue.reference!=="suffix"&&ue.reference!==fe.reference&&(fe.error=fe.error||"URI is not a "+ue.reference+" reference.");var We=ne[(ue.scheme||fe.scheme||"").toLowerCase()];if(!ue.unicodeSupport&&(!We||!We.unicodeSupport)){if(fe.host&&(ue.domainHost||We&&We.domainHost))try{fe.host=ee.toASCII(fe.host.replace(Ae.PCT_ENCODED,me).toLowerCase())}catch(it){fe.error=fe.error||"Host's domain name can not be converted to ASCII via punycode: "+it}ve(fe,c)}else ve(fe,Ae);We&&We.parse&&We.parse(fe,ue)}else fe.error=fe.error||"URI can not be parsed.";return fe}function I(de,ue){var fe=ue.iri!==!1?d:c,Ae=[];return de.userinfo!==void 0&&(Ae.push(de.userinfo),Ae.push("@")),de.host!==void 0&&Ae.push(M(Ue(String(de.host),fe),fe).replace(fe.IPV6ADDRESS,function(Ee,We,it){return"["+We+(it?"%25"+it:"")+"]"})),(typeof de.port=="number"||typeof de.port=="string")&&(Ae.push(":"),Ae.push(String(de.port))),Ae.length?Ae.join(""):void 0}var N=/^\.\.?\//,Q=/^\/\.(\/|$)/,ce=/^\/\.\.(\/|$)/,pe=/^\/?(?:.|\n)*?(?=\/|$)/;function he(de){for(var ue=[];de.length;)if(de.match(N))de=de.replace(N,"");else if(de.match(Q))de=de.replace(Q,"/");else if(de.match(ce))de=de.replace(ce,"/"),ue.pop();else if(de==="."||de==="..")de="";else{var fe=de.match(pe);if(fe){var Ae=fe[0];de=de.slice(Ae.length),ue.push(Ae)}else throw new Error("Unexpected dot segment condition")}return ue.join("")}function Ce(de){var ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},fe=ue.iri?d:c,Ae=[],Ee=ne[(ue.scheme||de.scheme||"").toLowerCase()];if(Ee&&Ee.serialize&&Ee.serialize(de,ue),de.host&&!fe.IPV6ADDRESS.test(de.host)){if(ue.domainHost||Ee&&Ee.domainHost)try{de.host=ue.iri?ee.toUnicode(de.host):ee.toASCII(de.host.replace(fe.PCT_ENCODED,me).toLowerCase())}catch(Yt){de.error=de.error||"Host's domain name can not be converted to "+(ue.iri?"Unicode":"ASCII")+" via punycode: "+Yt}}ve(de,fe),ue.reference!=="suffix"&&de.scheme&&(Ae.push(de.scheme),Ae.push(":"));var We=I(de,ue);if(We!==void 0&&(ue.reference!=="suffix"&&Ae.push("//"),Ae.push(We),de.path&&de.path.charAt(0)!=="/"&&Ae.push("/")),de.path!==void 0){var it=de.path;!ue.absolutePath&&(!Ee||!Ee.absolutePath)&&(it=he(it)),We===void 0&&(it=it.replace(/^\/\//,"/%2F")),Ae.push(it)}return de.query!==void 0&&(Ae.push("?"),Ae.push(de.query)),de.fragment!==void 0&&(Ae.push("#"),Ae.push(de.fragment)),Ae.join("")}function _e(de,ue){var fe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Ae=arguments[3],Ee={};return Ae||(de=j(Ce(de,fe),fe),ue=j(Ce(ue,fe),fe)),fe=fe||{},!fe.tolerant&&ue.scheme?(Ee.scheme=ue.scheme,Ee.userinfo=ue.userinfo,Ee.host=ue.host,Ee.port=ue.port,Ee.path=he(ue.path||""),Ee.query=ue.query):(ue.userinfo!==void 0||ue.host!==void 0||ue.port!==void 0?(Ee.userinfo=ue.userinfo,Ee.host=ue.host,Ee.port=ue.port,Ee.path=he(ue.path||""),Ee.query=ue.query):(ue.path?(ue.path.charAt(0)==="/"?Ee.path=he(ue.path):((de.userinfo!==void 0||de.host!==void 0||de.port!==void 0)&&!de.path?Ee.path="/"+ue.path:de.path?Ee.path=de.path.slice(0,de.path.lastIndexOf("/")+1)+ue.path:Ee.path=ue.path,Ee.path=he(Ee.path)),Ee.query=ue.query):(Ee.path=de.path,ue.query!==void 0?Ee.query=ue.query:Ee.query=de.query),Ee.userinfo=de.userinfo,Ee.host=de.host,Ee.port=de.port),Ee.scheme=de.scheme),Ee.fragment=ue.fragment,Ee}function G(de,ue,fe){var Ae=u({scheme:"null"},fe);return Ce(_e(j(de,Ae),j(ue,Ae),Ae,!0),Ae)}function J(de,ue){return typeof de=="string"?de=Ce(j(de,ue),ue):i(de)==="object"&&(de=j(Ce(de,ue),ue)),de}function ge(de,ue,fe){return typeof de=="string"?de=Ce(j(de,fe),fe):i(de)==="object"&&(de=Ce(de,fe)),typeof ue=="string"?ue=Ce(j(ue,fe),fe):i(ue)==="object"&&(ue=Ce(ue,fe)),de===ue}function be(de,ue){return de&&de.toString().replace(!ue||!ue.iri?c.ESCAPE:d.ESCAPE,le)}function ke(de,ue){return de&&de.toString().replace(!ue||!ue.iri?c.PCT_ENCODED:d.PCT_ENCODED,me)}var At={scheme:"http",domainHost:!0,parse:function(ue,fe){return ue.host||(ue.error=ue.error||"HTTP URIs must have a host."),ue},serialize:function(ue,fe){var Ae=String(ue.scheme).toLowerCase()==="https";return(ue.port===(Ae?443:80)||ue.port==="")&&(ue.port=void 0),ue.path||(ue.path="/"),ue}},kt={scheme:"https",domainHost:At.domainHost,parse:At.parse,serialize:At.serialize};function $r(de){return typeof de.secure=="boolean"?de.secure:String(de.scheme).toLowerCase()==="wss"}var Wt={scheme:"ws",domainHost:!0,parse:function(ue,fe){var Ae=ue;return Ae.secure=$r(Ae),Ae.resourceName=(Ae.path||"/")+(Ae.query?"?"+Ae.query:""),Ae.path=void 0,Ae.query=void 0,Ae},serialize:function(ue,fe){if((ue.port===($r(ue)?443:80)||ue.port==="")&&(ue.port=void 0),typeof ue.secure=="boolean"&&(ue.scheme=ue.secure?"wss":"ws",ue.secure=void 0),ue.resourceName){var Ae=ue.resourceName.split("?"),Ee=h(Ae,2),We=Ee[0],it=Ee[1];ue.path=We&&We!=="/"?We:void 0,ue.query=it,ue.resourceName=void 0}return ue.fragment=void 0,ue}},cr={scheme:"wss",domainHost:Wt.domainHost,parse:Wt.parse,serialize:Wt.serialize},zs={},un="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",Ct="[0-9A-Fa-f]",Wr=s(s("%[EFef]"+Ct+"%"+Ct+Ct+"%"+Ct+Ct)+"|"+s("%[89A-Fa-f]"+Ct+"%"+Ct+Ct)+"|"+s("%"+Ct+Ct)),_s="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",Ws="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",Ui=n(Ws,'[\\"\\\\]'),rs="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",ci=new RegExp(un,"g"),O=new RegExp(Wr,"g"),Y=new RegExp(n("[^]",_s,"[\\.]",'[\\"]',Ui),"g"),H=new RegExp(n("[^]",un,rs),"g"),Z=H;function ae(de){var ue=me(de);return ue.match(ci)?ue:de}var Te={scheme:"mailto",parse:function(ue,fe){var Ae=ue,Ee=Ae.to=Ae.path?Ae.path.split(","):[];if(Ae.path=void 0,Ae.query){for(var We=!1,it={},Yt=Ae.query.split("&"),Sr=0,Tr=Yt.length;Sr<Tr;++Sr){var Gt=Yt[Sr].split("=");switch(Gt[0]){case"to":for(var Pr=Gt[1].split(","),Zr=0,Dt=Pr.length;Zr<Dt;++Zr)Ee.push(Pr[Zr]);break;case"subject":Ae.subject=ke(Gt[1],fe);break;case"body":Ae.body=ke(Gt[1],fe);break;default:We=!0,it[ke(Gt[0],fe)]=ke(Gt[1],fe);break}}We&&(Ae.headers=it)}Ae.query=void 0;for(var Ur=0,cn=Ee.length;Ur<cn;++Ur){var Gr=Ee[Ur].split("@");if(Gr[0]=ke(Gr[0]),fe.unicodeSupport)Gr[1]=ke(Gr[1],fe).toLowerCase();else try{Gr[1]=ee.toASCII(ke(Gr[1],fe).toLowerCase())}catch(Gs){Ae.error=Ae.error||"Email address's domain name can not be converted to ASCII via punycode: "+Gs}Ee[Ur]=Gr.join("@")}return Ae},serialize:function(ue,fe){var Ae=ue,Ee=a(ue.to);if(Ee){for(var We=0,it=Ee.length;We<it;++We){var Yt=String(Ee[We]),Sr=Yt.lastIndexOf("@"),Tr=Yt.slice(0,Sr).replace(O,ae).replace(O,o).replace(Y,le),Gt=Yt.slice(Sr+1);try{Gt=fe.iri?ee.toUnicode(Gt):ee.toASCII(ke(Gt,fe).toLowerCase())}catch(Ur){Ae.error=Ae.error||"Email address's domain name can not be converted to "+(fe.iri?"Unicode":"ASCII")+" via punycode: "+Ur}Ee[We]=Tr+"@"+Gt}Ae.path=Ee.join(",")}var Pr=ue.headers=ue.headers||{};ue.subject&&(Pr.subject=ue.subject),ue.body&&(Pr.body=ue.body);var Zr=[];for(var Dt in Pr)Pr[Dt]!==zs[Dt]&&Zr.push(Dt.replace(O,ae).replace(O,o).replace(H,le)+"="+Pr[Dt].replace(O,ae).replace(O,o).replace(Z,le));return Zr.length&&(Ae.query=Zr.join("&")),Ae}},xe=/^([^\:]+)\:(.*)/,$e={scheme:"urn",parse:function(ue,fe){var Ae=ue.path&&ue.path.match(xe),Ee=ue;if(Ae){var We=fe.scheme||Ee.scheme||"urn",it=Ae[1].toLowerCase(),Yt=Ae[2],Sr=We+":"+(fe.nid||it),Tr=ne[Sr];Ee.nid=it,Ee.nss=Yt,Ee.path=void 0,Tr&&(Ee=Tr.parse(Ee,fe))}else Ee.error=Ee.error||"URN can not be parsed.";return Ee},serialize:function(ue,fe){var Ae=fe.scheme||ue.scheme||"urn",Ee=ue.nid,We=Ae+":"+(fe.nid||Ee),it=ne[We];it&&(ue=it.serialize(ue,fe));var Yt=ue,Sr=ue.nss;return Yt.path=(Ee||fe.nid)+":"+Sr,Yt}},qe=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Nt={scheme:"urn:uuid",parse:function(ue,fe){var Ae=ue;return Ae.uuid=Ae.nss,Ae.nss=void 0,!fe.tolerant&&(!Ae.uuid||!Ae.uuid.match(qe))&&(Ae.error=Ae.error||"UUID is not valid."),Ae},serialize:function(ue,fe){var Ae=ue;return Ae.nss=(ue.uuid||"").toLowerCase(),Ae}};ne[At.scheme]=At,ne[kt.scheme]=kt,ne[Wt.scheme]=Wt,ne[cr.scheme]=cr,ne[Te.scheme]=Te,ne[$e.scheme]=$e,ne[Nt.scheme]=Nt,r.SCHEMES=ne,r.pctEncChar=le,r.pctDecChars=me,r.parse=j,r.removeDotSegments=he,r.serialize=Ce,r.resolveComponents=_e,r.resolve=G,r.normalize=J,r.equal=ge,r.escapeComponent=be,r.unescapeComponent=ke,Object.defineProperty(r,"__esModule",{value:!0})})})(Jx,Jx.exports);var LL=Jx.exports,Xx;(function(t){t.Public="public",t.Private="private"})(Xx||(Xx={}));const yu=Xx;class Qs{static validateEs256kOperationKey(e,r){const n=new Set(["kty","crv","x","y"]);r===yu.Private&&n.add("d");for(const s in e)if(!n.has(s))throw new Sn(An.PublicKeyJwkEs256kHasUnexpectedProperty,`SECP256K1 JWK key has unexpected property '${s}'.`);if(e.crv!=="secp256k1")throw new Sn(An.JwkEs256kMissingOrInvalidCrv,`SECP256K1 JWK 'crv' property must be 'secp256k1' but got '${e.crv}.'`);if(e.kty!=="EC")throw new Sn(An.JwkEs256kMissingOrInvalidKty,`SECP256K1 JWK 'kty' property must be 'EC' but got '${e.kty}.'`);if(e.x.length!==43)throw new Sn(An.JwkEs256kHasIncorrectLengthOfX,"SECP256K1 JWK 'x' property must be 43 bytes.");if(e.y.length!==43)throw new Sn(An.JwkEs256kHasIncorrectLengthOfY,"SECP256K1 JWK 'y' property must be 43 bytes.");if(r===yu.Private&&(e.d===void 0||e.d.length!==43))throw new Sn(An.JwkEs256kHasIncorrectLengthOfD,"SECP256K1 JWK 'd' property must be 43 bytes.")}static validateId(e){if(e.length>50)throw new Sn(An.IdTooLong,`Key ID length ${e.length} exceed max allowed length of 50.`);if(!vy.isBase64UrlString(e))throw new Sn(An.IdNotUsingBase64UrlCharacterSet,`Key ID '${e}' is not a Base64URL string.`)}static validatePublicKeyPurposes(e){if(e===void 0)return;const r=new Set;for(const n of e){if(r.has(n))throw new Sn(An.PublicKeyPurposeDuplicated,`Public key purpose '${n}' already specified.`);r.add(n)}}}class co{}co.hashAlgorithmInMultihashCode=18;co.maxCanonicalizedDeltaSizeInBytes=1e3;var ode=function t(e){if(typeof e=="number"&&isNaN(e))throw new Error("NaN is not allowed");if(typeof e=="number"&&!isFinite(e))throw new Error("Infinity is not allowed");return e===null||typeof e!="object"?JSON.stringify(e):e.toJSON instanceof Function?t(e.toJSON()):Array.isArray(e)?`[${e.reduce((s,i,o)=>`${s}${o===0?"":","}${t(i===void 0||typeof i=="symbol"?null:i)}`,"")}]`:`{${Object.keys(e).sort().reduce((n,s)=>{if(e[s]===void 0||typeof e[s]=="symbol")return n;const i=n.length===0?"":",";return`${n}${i}${t(s)}:${t(e[s])}`},"")}}`};const KL=nc(ode);class gf{static canonicalizeAsBytes(e){const r=gf.removeAllUndefinedProperties(e),n=KL(r);return vy.stringToBytes(n)}static removeAllUndefinedProperties(e){for(const r in e)typeof e[r]=="object"?gf.removeAllUndefinedProperties(e[r]):e[r]===void 0&&delete e[r];return e}}var ade=VL,zB=128,ude=127,cde=~ude,lde=Math.pow(2,31);function VL(t,e,r){e=e||[],r=r||0;for(var n=r;t>=lde;)e[r++]=t&255|zB,t/=128;for(;t&cde;)e[r++]=t&255|zB,t>>>=7;return e[r]=t|0,VL.bytes=r-n+1,e}var dde=Yx,fde=128,WB=127;function Yx(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw Yx.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&WB)<<s:(o&WB)*Math.pow(2,s),s+=7}while(o>=fde);return Yx.bytes=i-n,r}var hde=Math.pow(2,7),pde=Math.pow(2,14),mde=Math.pow(2,21),yde=Math.pow(2,28),gde=Math.pow(2,35),vde=Math.pow(2,42),wde=Math.pow(2,49),_de=Math.pow(2,56),bde=Math.pow(2,63),Ede=function(t){return t<hde?1:t<pde?2:t<mde?3:t<yde?4:t<gde?5:t<vde?6:t<wde?7:t<_de?8:t<bde?9:10},Ade={encode:ade,decode:dde,encodingLength:Ede},IE=Ade;const GB=(t,e=0)=>[IE.decode(t,e),IE.decode.bytes],JB=(t,e,r=0)=>(IE.encode(t,e,r),e),XB=t=>IE.encodingLength(t),YB=(t,e)=>{const r=e.byteLength,n=XB(t),s=n+XB(r),i=new Uint8Array(s+r);return JB(t,i,0),JB(r,i,n),i.set(e,s),new qL(t,r,e,i)},Sde=t=>{const e=Zle(t),[r,n]=GB(e),[s,i]=GB(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new qL(r,s,o,e)};class qL{constructor(e,r,n,s){this.code=e,this.size=r,this.digest=n,this.bytes=s}}const Tde=({name:t,code:e,encode:r})=>new Dde(t,e,r);class Dde{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?YB(this.code,r):r.then(n=>YB(this.code,n))}else throw Error("Unknown type, must be binary type")}}const xde=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),ZB=Tde({name:"sha2-256",code:18,encode:xde("SHA-256")});var Kg=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};class Zn{static hash(e,r){return Kg(this,void 0,void 0,function*(){let n;switch(r){case 18:n=(yield ZB.digest(e)).bytes;break;default:throw new Sn(An.MultihashUnsupportedHashAlgorithm,`Hash algorithm defined in multihash code ${r} is not supported.`)}return n})}static hashAsNonMultihashBytes(e,r){return Kg(this,void 0,void 0,function*(){let n;switch(r){case 18:n=yield ZB.encode(e);break;default:throw new Sn(An.MultihashUnsupportedHashAlgorithm,`Hash algorithm defined in multihash code ${r} is not supported.`)}return n})}static canonicalizeThenHashThenEncode(e,r){return Kg(this,void 0,void 0,function*(){const n=gf.canonicalizeAsBytes(e);return yield Zn.hashThenEncode(n,r)})}static canonicalizeThenDoubleHashThenEncode(e,r){return Kg(this,void 0,void 0,function*(){const n=gf.canonicalizeAsBytes(e),s=yield Zn.hashAsNonMultihashBytes(n,r);return yield Zn.hashThenEncode(s,r)})}static hashThenEncode(e,r){return Kg(this,void 0,void 0,function*(){const n=yield Zn.hash(e,r);return vy.encode(n)})}static validateEncodedHashComputedUsingSupportedHashAlgorithm(e,r){let n;const s=vy.decodeAsBytes(e,r);try{n=Sde(s)}catch{throw new Sn(An.MultihashStringNotAMultihash,`Given ${r} string '${e}' is not a multihash after decoding.`)}const i=co.hashAlgorithmInMultihashCode;if(i!==n.code)throw new Sn(An.MultihashUnsupportedHashAlgorithm,`Given ${r} uses unsupported multihash algorithm with code ${n.code}, should use ${i} or change IonSdkConfig to desired hashing algorithm.`)}}var Zx;(function(t){t.Create="create",t.Update="update",t.Deactivate="deactivate",t.Recover="recover"})(Zx||(Zx={}));const lb=Zx;var Qx;(function(t){t.Replace="replace",t.AddPublicKeys="add-public-keys",t.RemovePublicKeys="remove-public-keys",t.AddServices="add-services",t.RemoveServices="remove-services"})(Qx||(Qx={}));const um=Qx;var db=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};class Ji{static createCreateRequest(e){return db(this,void 0,void 0,function*(){const r=e.recoveryKey,n=e.updateKey,s=e.document.publicKeys,i=e.document.services;Qs.validateEs256kOperationKey(r,yu.Public),Qs.validateEs256kOperationKey(n,yu.Public),Ji.validateDidDocumentKeys(s),Ji.validateServices(i);const o=co.hashAlgorithmInMultihashCode,a=[{action:um.Replace,document:e.document}],u={updateCommitment:yield Zn.canonicalizeThenDoubleHashThenEncode(n,o),patches:a};Ji.validateDeltaSize(u);const c={deltaHash:yield Zn.canonicalizeThenHashThenEncode(u,o),recoveryCommitment:yield Zn.canonicalizeThenDoubleHashThenEncode(r,o)};return{type:lb.Create,suffixData:c,delta:u}})}static createDeactivateRequest(e){return db(this,void 0,void 0,function*(){Ji.validateDidSuffix(e.didSuffix),Qs.validateEs256kOperationKey(e.recoveryPublicKey,yu.Public);const r=co.hashAlgorithmInMultihashCode,n=yield Zn.canonicalizeThenHashThenEncode(e.recoveryPublicKey,r),s={didSuffix:e.didSuffix,recoveryKey:e.recoveryPublicKey},i=yield e.signer.sign({alg:"ES256K"},s);return{type:lb.Deactivate,didSuffix:e.didSuffix,revealValue:n,signedData:i}})}static createRecoverRequest(e){return db(this,void 0,void 0,function*(){Ji.validateDidSuffix(e.didSuffix),Qs.validateEs256kOperationKey(e.recoveryPublicKey,yu.Public),Qs.validateEs256kOperationKey(e.nextRecoveryPublicKey,yu.Public),Qs.validateEs256kOperationKey(e.nextUpdatePublicKey,yu.Public),Ji.validateDidDocumentKeys(e.document.publicKeys),Ji.validateServices(e.document.services);const r=co.hashAlgorithmInMultihashCode,n=yield Zn.canonicalizeThenHashThenEncode(e.recoveryPublicKey,r),s=[{action:um.Replace,document:e.document}],i=yield Zn.canonicalizeThenDoubleHashThenEncode(e.nextUpdatePublicKey,r),o={patches:s,updateCommitment:i},a=yield Zn.canonicalizeThenHashThenEncode(o,r),l={recoveryCommitment:yield Zn.canonicalizeThenDoubleHashThenEncode(e.nextRecoveryPublicKey,r),recoveryKey:e.recoveryPublicKey,deltaHash:a},c=yield e.signer.sign({alg:"ES256K"},l);return{type:lb.Recover,didSuffix:e.didSuffix,revealValue:n,delta:o,signedData:c}})}static createUpdateRequest(e){return db(this,void 0,void 0,function*(){if(Ji.validateDidSuffix(e.didSuffix),Qs.validateEs256kOperationKey(e.updatePublicKey,yu.Public),Qs.validateEs256kOperationKey(e.nextUpdatePublicKey,yu.Public),Ji.validateServices(e.servicesToAdd),Ji.validateDidDocumentKeys(e.publicKeysToAdd),e.idsOfServicesToRemove!==void 0)for(const p of e.idsOfServicesToRemove)Qs.validateId(p);if(e.idsOfPublicKeysToRemove!==void 0)for(const p of e.idsOfPublicKeysToRemove)Qs.validateId(p);const r=[],n=e.servicesToAdd;if(n!==void 0&&n.length>0){const p={action:um.AddServices,services:n};r.push(p)}const s=e.idsOfServicesToRemove;if(s!==void 0&&s.length>0){const p={action:um.RemoveServices,ids:s};r.push(p)}const i=e.publicKeysToAdd;if(i!==void 0&&i.length>0){const p={action:um.AddPublicKeys,publicKeys:i};r.push(p)}const o=e.idsOfPublicKeysToRemove;if(o!==void 0&&o.length>0){const p={action:um.RemovePublicKeys,ids:o};r.push(p)}const a=co.hashAlgorithmInMultihashCode,u=yield Zn.canonicalizeThenHashThenEncode(e.updatePublicKey,a),l=yield Zn.canonicalizeThenDoubleHashThenEncode(e.nextUpdatePublicKey,a),c={patches:r,updateCommitment:l},d=yield Zn.canonicalizeThenHashThenEncode(c,a),h={updateKey:e.updatePublicKey,deltaHash:d},f=yield e.signer.sign({alg:"ES256K"},h);return{type:lb.Update,didSuffix:e.didSuffix,revealValue:u,delta:c,signedData:f}})}static validateDidSuffix(e){Zn.validateEncodedHashComputedUsingSupportedHashAlgorithm(e,"didSuffix")}static validateDidDocumentKeys(e){if(e===void 0)return;const r=new Set;for(const n of e){if(Array.isArray(n.publicKeyJwk))throw new Sn(An.DidDocumentPublicKeyMissingOrIncorrectType,"DID Document key 'publicKeyJwk' property is not a non-array object.");if(Qs.validateId(n.id),r.has(n.id))throw new Sn(An.DidDocumentPublicKeyIdDuplicated,`DID Document key with ID '${n.id}' already exists.`);r.add(n.id),Qs.validatePublicKeyPurposes(n.purposes)}}static validateServices(e){if(e!==void 0&&e.length!==0){const r=new Set;for(const n of e){if(Ji.validateService(n),r.has(n.id))throw new Sn(An.DidDocumentServiceIdDuplicated,"Service id has to be unique");r.add(n.id)}}}static validateService(e){Qs.validateId(e.id);const r=30;if(e.type.length>r){const n=`Service endpoint type length ${e.type.length} exceeds max allowed length of ${r}.`;throw new Sn(An.ServiceTypeTooLong,n)}if(Array.isArray(e.serviceEndpoint)){const n="Service endpoint value cannot be an array.";throw new Sn(An.ServiceEndpointCannotBeAnArray,n)}if(typeof e.serviceEndpoint=="string"&&LL.parse(e.serviceEndpoint).error!==void 0)throw new Sn(An.ServiceEndpointStringNotValidUri,`Service endpoint string '${e.serviceEndpoint}' is not a URI.`)}static validateDeltaSize(e){const r=gf.canonicalizeAsBytes(e);if(r.length>co.maxCanonicalizedDeltaSizeInBytes){const n=`Delta of ${r.length} bytes exceeded limit of ${co.maxCanonicalizedDeltaSizeInBytes} bytes.`;throw new Sn(An.DeltaExceedsMaximumSize,n)}}}var QB=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};class Lw{static createLongFormDid(e){return QB(this,void 0,void 0,function*(){const r=yield Ji.createCreateRequest(e),n=yield Lw.computeDidUniqueSuffix(r.suffixData);let s;co.network===void 0||co.network==="mainnet"?s=`did:ion:${n}`:s=`did:ion:${co.network}:${n}`;const i={suffixData:r.suffixData,delta:r.delta},o=gf.canonicalizeAsBytes(i),a=vy.encode(o);return`${s}:${a}`})}static computeDidUniqueSuffix(e){return QB(this,void 0,void 0,function*(){const r=gf.canonicalizeAsBytes(e),n=yield Zn.hash(r,co.hashAlgorithmInMultihashCode);return vy.encode(n)})}}var eF;(function(t){t.Mainnet="mainnet",t.Testnet="test"})(eF||(eF={}));var tF;(function(t){t.Authentication="authentication",t.AssertionMethod="assertionMethod",t.CapabilityInvocation="capabilityInvocation",t.CapabilityDelegation="capabilityDelegation",t.KeyAgreement="keyAgreement"})(tF||(tF={}));var Nd=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},Au;(function(t){t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.secp256r1="secp256r1",t.X25519="X25519"})(Au||(Au={}));const Pde={Ed25519:Au.Ed25519,ES256K:Au.secp256k1,ES256:Au.secp256r1,"P-256":Au.secp256r1,secp256k1:Au.secp256k1,secp256r1:Au.secp256r1},rF="https://ion.tbd.engineering";let Cde=class $0 extends Uw{static create(){return Nd(this,arguments,void 0,function*({keyManager:e=new ml,options:r={}}={}){var n,s,i,o,a,u,l;if(!((n=r.verificationMethods)===null||n===void 0)&&n.some(S=>!(S.algorithm in Pde)))throw new Error("One or more verification method algorithms are not supported");const c=(s=r.verificationMethods)===null||s===void 0?void 0:s.filter(S=>"id"in S).map(S=>S.id);if(c&&c.length!==new Set(c).size)throw new Error("One or more verification method IDs are not unique");if(!((i=r.services)===null||i===void 0)&&i.some(S=>!S.id||!S.type||!S.serviceEndpoint))throw new Error("One or more services are missing required properties");const d={algorithm:"Ed25519",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]},h=[];for(const S of(o=r.verificationMethods)!==null&&o!==void 0?o:[d]){const x=yield e.generateKey({algorithm:S.algorithm}),D=yield e.getPublicKey({keyUri:x});h.push({id:S.id,publicKeyJwk:D,purposes:(a=S.purposes)!==null&&a!==void 0?a:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]})}const f=yield e.generateKey({algorithm:Au.secp256k1}),p=yield e.getPublicKey({keyUri:f}),m=yield e.generateKey({algorithm:Au.secp256k1}),E=yield e.getPublicKey({keyUri:m}),A=yield Vg.computeLongFormDidUri({recoveryKey:p,updateKey:E,services:(u=r.services)!==null&&u!==void 0?u:[],verificationMethods:h}),{didDocument:_,didResolutionMetadata:g}=yield $0.resolve(A,{gatewayUri:r.gatewayUri});if(_===null)throw new Error(`Unable to resolve DID during creation: ${g==null?void 0:g.error}`);const v=new yf({uri:A,document:_,metadata:{published:!1,canonicalId:A.split(":",3).join(":"),recoveryKey:p,updateKey:E},keyManager:e});if(!((l=r.publish)!==null&&l!==void 0)||l){const S=yield $0.publish({did:v,gatewayUri:r.gatewayUri});v.metadata=S.didDocumentMetadata}return v})}static getSigningMethod(e){return Nd(this,arguments,void 0,function*({didDocument:r,methodId:n}){var s;const i=_r.parse(r.id);if(i&&i.method!==this.methodName)throw new ht(st.MethodNotSupported,`Method not supported: ${i.method}`);const o=(s=r.verificationMethod)===null||s===void 0?void 0:s.find(a=>{var u;return a.id===(n??((u=r.assertionMethod)===null||u===void 0?void 0:u[0]))});if(!(o&&o.publicKeyJwk))throw new ht(st.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static import(e){return Nd(this,arguments,void 0,function*({portableDid:r,keyManager:n=new ml}){const s=_r.parse(r.uri);if((s==null?void 0:s.method)!==$0.methodName)throw new ht(st.MethodNotSupported,"Method not supported");return yield yf.import({portableDid:r,keyManager:n})})}static publish(e){return Nd(this,arguments,void 0,function*({did:r,gatewayUri:n=rF}){var s,i,o;const a=(i=(s=r.document.verificationMethod)===null||s===void 0?void 0:s.map(c=>({id:c.id,publicKeyJwk:c.publicKeyJwk,purposes:yle({didDocument:r.document,methodId:c.id})})))!==null&&i!==void 0?i:[],u=yield Vg.createIonDocument({services:(o=r.document.service)!==null&&o!==void 0?o:[],verificationMethods:a}),l=yield Vg.constructCreateRequest({ionDocument:u,recoveryKey:r.metadata.recoveryKey,updateKey:r.metadata.updateKey});try{const c=Vg.appendPathToUrl({baseUrl:n,path:"/operations"}),d=yield fetch(c,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});return{didDocument:r.document,didDocumentMetadata:Object.assign(Object.assign({},r.metadata),{published:d.ok}),didRegistrationMetadata:{}}}catch{return{didDocument:null,didDocumentMetadata:{published:!1},didRegistrationMetadata:{error:st.InternalError,errorMessage:`Failed to publish DID document for: ${r.uri}`}}}})}static resolve(e){return Nd(this,arguments,void 0,function*(r,n={}){var s,i;const o=_r.parse(r);if(!o)return Object.assign(Object.assign({},Ri),{didResolutionMetadata:{error:"invalidDid"}});if(o.method!==$0.methodName)return Object.assign(Object.assign({},Ri),{didResolutionMetadata:{error:"methodNotSupported"}});const a=(s=n==null?void 0:n.gatewayUri)!==null&&s!==void 0?s:rF;try{const u=Vg.appendPathToUrl({baseUrl:a,path:`/identifiers/${r}`}),l=yield fetch(u);if(!l.ok)throw new ht(st.NotFound,`Unable to find DID document for: ${r}`);const{didDocument:c,didDocumentMetadata:d}=yield l.json();return Object.assign(Object.assign(Object.assign({},Ri),c&&{didDocument:c}),{didDocumentMetadata:Object.assign({published:(i=d==null?void 0:d.method)===null||i===void 0?void 0:i.published},d)})}catch(u){if(!(u instanceof ht))throw new Error(u);return Object.assign(Object.assign({},Ri),{didResolutionMetadata:Object.assign({error:u.code},u.message&&{errorMessage:u.message})})}})}};Cde.methodName="ion";let Vg=class gh{static appendPathToUrl({baseUrl:e,path:r}){const n=new URL(e);return n.pathname=n.pathname.endsWith("/")?n.pathname:n.pathname+"/",n.pathname+=r.startsWith("/")?r.substring(1):r,n.toString()}static computeLongFormDidUri(e){return Nd(this,arguments,void 0,function*({recoveryKey:r,updateKey:n,services:s,verificationMethods:i}){const o=yield gh.createIonDocument({services:s,verificationMethods:i}),a=gh.normalizeJwk(r),u=gh.normalizeJwk(n);return yield Lw.createLongFormDid({document:o,recoveryKey:a,updateKey:u})})}static constructCreateRequest(e){return Nd(this,arguments,void 0,function*({ionDocument:r,recoveryKey:n,updateKey:s}){return yield Ji.createCreateRequest({document:r,recoveryKey:gh.normalizeJwk(n),updateKey:gh.normalizeJwk(s)})})}static createIonDocument(e){return Nd(this,arguments,void 0,function*({services:r,verificationMethods:n}){var s,i;const o=[];for(const l of n){let c=(i=(s=l.id)!==null&&s!==void 0?s:l.publicKeyJwk.kid)!==null&&i!==void 0?i:yield Rr({jwk:l.publicKeyJwk});c=`${c.split("#").pop()}`;const d={id:c,publicKeyJwk:gh.normalizeJwk(l.publicKeyJwk),purposes:l.purposes,type:"JsonWebKey2020"};o.push(d)}const a=r.map(l=>Object.assign(Object.assign({},l),{id:`${l.id.split("#").pop()}`}));return{publicKeys:o,services:a}})}static normalizeJwk(e){const r=e.kty;let n;if(r==="EC")n={crv:e.crv,kty:e.kty,x:e.x,y:e.y};else if(r==="oct")n={k:e.k,kty:e.kty};else if(r==="OKP")n={crv:e.crv,kty:e.kty,x:e.x};else if(r==="RSA")n={e:e.e,kty:e.kty,n:e.n};else throw new Error(`Unsupported key type: ${r}`);return n}};var fb=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let HL=class O0 extends Uw{static create(){return fb(this,arguments,void 0,function*({keyManager:e=new ml,options:r={}}={}){var n,s,i,o;if(r.algorithm&&r.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(r.verificationMethods&&r.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");const a=(o=(n=r.algorithm)!==null&&n!==void 0?n:(i=(s=r.verificationMethods)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.algorithm)!==null&&o!==void 0?o:"Ed25519",u=yield e.generateKey({algorithm:a}),l=yield e.getPublicKey({keyUri:u}),c=vt.object(l).toBase64Url(),d=`did:${O0.methodName}:${c}`,f=(yield O0.resolve(d)).didDocument;return new yf({uri:d,document:f,metadata:{},keyManager:e})})}static getSigningMethod(e){return fb(this,arguments,void 0,function*({didDocument:r}){var n;const s=_r.parse(r.id);if(s&&s.method!==this.methodName)throw new ht(st.MethodNotSupported,`Method not supported: ${s.method}`);const[i]=(n=r.verificationMethod)!==null&&n!==void 0?n:[];if(!(i&&i.publicKeyJwk))throw new ht(st.InternalError,"A verification method intended for signing could not be determined from the DID Document");return i})}static import(e){return fb(this,arguments,void 0,function*({portableDid:r,keyManager:n=new ml}){const s=_r.parse(r.uri);if((s==null?void 0:s.method)!==O0.methodName)throw new ht(st.MethodNotSupported,"Method not supported");const i=yield yf.import({portableDid:r,keyManager:n});if(i.document.verificationMethod.length!==1)throw new ht(st.InvalidDidDocument,"DID document must contain exactly one verification method");return i})}static resolve(e,r){return fb(this,void 0,void 0,function*(){const n=_r.parse(e);let s;try{s=vt.base64Url(n.id).toObject()}catch{}if(!n||!s)return Object.assign(Object.assign({},Ri),{didResolutionMetadata:{error:"invalidDid"}});if(n.method!==O0.methodName)return Object.assign(Object.assign({},Ri),{didResolutionMetadata:{error:"methodNotSupported"}});const i={"@context":["https://www.w3.org/ns/did/v1"],id:n.uri},o=`${i.id}#0`;switch(i.verificationMethod=[{id:o,type:"JsonWebKey",controller:i.id,publicKeyJwk:s}],i.authentication=[o],i.assertionMethod=[o],i.capabilityInvocation=[o],i.capabilityDelegation=[o],i.keyAgreement=[o],s.use){case"sig":{delete i.keyAgreement;break}case"enc":{delete i.authentication,delete i.assertionMethod,delete i.capabilityInvocation,delete i.capabilityDelegation;break}}return Object.assign(Object.assign({},Ri),{didDocument:i})})}};HL.methodName="jwk";var Da=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},Fc;(function(t){t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.secp256r1="secp256r1",t.X25519="X25519"})(Fc||(Fc={}));const bT={Ed25519VerificationKey2020:"https://w3id.org/security/suites/ed25519-2020/v1",JsonWebKey2020:"https://w3id.org/security/suites/jws-2020/v1",X25519KeyAgreementKey2020:"https://w3id.org/security/suites/x25519-2020/v1"},Ide={Ed25519:Fc.Ed25519,ES256K:Fc.secp256k1,ES256:Fc.secp256r1,"P-256":Fc.secp256r1,secp256k1:Fc.secp256k1,secp256r1:Fc.secp256r1,X25519:Fc.X25519};let kde=class Rc extends Uw{static create(){return Da(this,arguments,void 0,function*({keyManager:e=new ml,options:r={}}={}){var n,s,i,o;if(r.algorithm&&r.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(r.verificationMethods&&r.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");const a=(o=(n=r.algorithm)!==null&&n!==void 0?n:(i=(s=r.verificationMethods)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.algorithm)!==null&&o!==void 0?o:"Ed25519",u=yield e.generateKey({algorithm:a}),l=yield e.getPublicKey({keyUri:u}),c=yield Lo.publicKeyToMultibaseId({publicKey:l}),d=`did:${Rc.methodName}:${c}`,f=(yield Rc.resolve(d,r)).didDocument;return new yf({uri:d,document:f,metadata:{},keyManager:e})})}static getSigningMethod(e){return Da(this,arguments,void 0,function*({didDocument:r}){var n;const s=_r.parse(r.id);if(s&&s.method!==this.methodName)throw new ht(st.MethodNotSupported,`Method not supported: ${s.method}`);const[i]=r.assertionMethod||[],o=(n=r.verificationMethod)===null||n===void 0?void 0:n.find(a=>a.id===i);if(!(o&&o.publicKeyJwk))throw new ht(st.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static import(e){return Da(this,arguments,void 0,function*({portableDid:r,keyManager:n=new ml}){const s=_r.parse(r.uri);if((s==null?void 0:s.method)!==Rc.methodName)throw new ht(st.MethodNotSupported,"Method not supported");const i=yield yf.import({portableDid:r,keyManager:n});if(i.document.verificationMethod.length!==1)throw new ht(st.InvalidDidDocument,"DID document must contain exactly one verification method");return i})}static resolve(e,r){return Da(this,void 0,void 0,function*(){try{const n=yield Rc.createDocument({didUri:e,options:r});return Object.assign(Object.assign({},Ri),{didDocument:n})}catch(n){if(!(n instanceof ht))throw new Error(n);return Object.assign(Object.assign({},Ri),{didResolutionMetadata:Object.assign({error:n.code},n.message&&{errorMessage:n.message})})}})}static createDocument(e){return Da(this,arguments,void 0,function*({didUri:r,options:n={}}){const{defaultContext:s="https://www.w3.org/ns/did/v1",enableEncryptionKeyDerivation:i=!1,enableExperimentalPublicKeyTypes:o=!1,publicKeyFormat:a="JsonWebKey2020"}=n,u={id:""},l=_r.parse(r);if(!l)throw new ht(st.InvalidDid,`Invalid DID URI: ${r}`);const c=l.id;if(l.method!==Rc.methodName)throw new ht(st.MethodNotSupported,`Method not supported: ${l.method}`);if(!Rc.validateIdentifier(l))throw new ht(st.InvalidDid,`Invalid DID URI: ${r}`);const d=yield Rc.createSignatureMethod({didUri:r,multibaseValue:c,options:{enableExperimentalPublicKeyTypes:o,publicKeyFormat:a}});if(u.id=l.uri,u.verificationMethod=[d],u.authentication=[d.id],u.assertionMethod=[d.id],u.capabilityInvocation=[d.id],u.capabilityDelegation=[d.id],i===!0){const p=a==="Ed25519VerificationKey2020"?"X25519KeyAgreementKey2020":"JsonWebKey2020",m=yield this.createEncryptionMethod({didUri:r,multibaseValue:c,options:{enableExperimentalPublicKeyTypes:o,publicKeyFormat:p}});u.verificationMethod.push(m),u.keyAgreement=[m.id]}const h=[s];return mle({didDocument:u}).forEach(p=>{const m=bT[p];h.push(m)}),u["@context"]=h,u})}static createEncryptionMethod(e){return Da(this,arguments,void 0,function*({didUri:r,multibaseValue:n,options:s}){const{enableExperimentalPublicKeyTypes:i,publicKeyFormat:o}=s,a={id:"",type:"",controller:""},{keyBytes:u,multicodecCode:l}=yield Rc.deriveEncryptionKey({multibaseValue:n}),c=u.byteLength,d=Lo.MULTICODEC_PUBLIC_KEY_LENGTH[l];if(c!==d)throw new ht(st.InvalidPublicKeyLength,`Expected ${c} bytes. Actual: ${d}`);const h=SL({keyBytes:u,multicodecCode:l});a.id=`${r}#${h}`;try{new URL(a.id)}catch{throw new ht(st.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(o in bT))throw new ht(st.UnsupportedPublicKeyType,`Unsupported format: ${o}`);if(i===!1&&!["Multikey","JsonWebKey2020","X25519KeyAgreementKey2020"].includes(o))throw new ht(st.InvalidPublicKeyType,`Specified '${o}' without setting enableExperimentalPublicKeyTypes to true.`);if(a.type=o,a.controller=r,o==="X25519KeyAgreementKey2020"&&(a.publicKeyMultibase=h),o==="JsonWebKey2020"){const{crv:p}=yield Lo.multicodecToJwk({code:l});a.publicKeyJwk=yield Lo.keyConverter(p).bytesToPublicKey({publicKeyBytes:u})}return a})}static createSignatureMethod(e){return Da(this,arguments,void 0,function*({didUri:r,multibaseValue:n,options:s}){const{enableExperimentalPublicKeyTypes:i,publicKeyFormat:o}=s,a={id:"",type:"",controller:""},{keyBytes:u,multicodecCode:l,multicodecName:c}=kB({multibaseKeyId:n}),d=u.byteLength,h=Lo.MULTICODEC_PUBLIC_KEY_LENGTH[l];if(d!==h)throw new ht(st.InvalidPublicKeyLength,`Expected ${d} bytes. Actual: ${h}`);let f=!1;switch(c){case"secp256k1-pub":f=yield lo.validatePublicKey({publicKeyBytes:u});break;case"ed25519-pub":f=yield Bs.validatePublicKey({publicKeyBytes:u});break;case"x25519-pub":f=!0;break}if(!f)throw new ht(st.InvalidPublicKey,"Invalid public key detected.");a.id=`${r}#${n}`;try{new URL(a.id)}catch{throw new ht(st.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(o in bT))throw new ht(st.UnsupportedPublicKeyType,`Unsupported format: ${o}`);if(i===!1&&!["Multikey","JsonWebKey2020","Ed25519VerificationKey2020"].includes(o))throw new ht(st.InvalidPublicKeyType,`Specified '${o}' without setting enableExperimentalPublicKeyTypes to true.`);if(a.type=o,a.controller=r,o==="Ed25519VerificationKey2020"&&(a.publicKeyMultibase=n),o==="JsonWebKey2020"){const{crv:m}=yield Lo.multicodecToJwk({code:l});a.publicKeyJwk=yield Lo.keyConverter(m).bytesToPublicKey({publicKeyBytes:u})}return a})}static deriveEncryptionKey(e){return Da(this,arguments,void 0,function*({multibaseValue:r}){let n={keyBytes:new Uint8Array,multicodecCode:0};const{keyBytes:s,multicodecCode:i}=kB({multibaseKeyId:r});if(i===237){const o=yield Lo.keyConverter("Ed25519").bytesToPublicKey({publicKeyBytes:s}),a=yield Bs.convertPublicKeyToX25519({publicKey:o});n={keyBytes:yield Lo.keyConverter("Ed25519").publicKeyToBytes({publicKey:a}),multicodecCode:236}}return n})}static validateIdentifier(e){const{method:r,id:n}=e,[s]=e.uri.split(":",1);return s==="did"&&r==="key"&&Number("1")>0&&Lx(n)==="String"&&n.startsWith("z")}};kde.methodName="key";let Lo=class Em{static jwkToMulticodec(e){return Da(this,arguments,void 0,function*({jwk:r}){const n=[];r.crv&&(n.push(r.crv),r.d?n.push("private"):n.push("public"));const s=n.join(":"),i=Em.JWK_TO_MULTICODEC[s];if(i===void 0)throw new Error(`Unsupported JWK to Multicodec conversion: '${s}'`);return{code:aa.getCodeFromName({name:i}),name:i}})}static keyCompressor(e){const n={"P-256":Xo.compressPublicKey,secp256k1:lo.compressPublicKey}[e];if(!n)throw new ht(st.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static keyConverter(e){const n={Ed25519:Bs,"P-256":Xo,secp256k1:lo,X25519:EL}[e];if(!n)throw new ht(st.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static multicodecToJwk(e){return Da(this,arguments,void 0,function*({code:r,name:n}){if(!(n?!r:r))throw new Error("Either 'name' or 'code' must be defined, but not both.");n=n===void 0?aa.getNameFromCode({code:r}):n;const s=n,i=Em.MULTICODEC_TO_JWK[s];if(i===void 0)throw new Error("Unsupported Multicodec to JWK conversion");return Object.assign({},i)})}static publicKeyToMultibaseId(e){return Da(this,arguments,void 0,function*({publicKey:r}){var n;if(!(r!=null&&r.crv&&r.crv in Ide))throw new ht(st.InvalidPublicKeyType,`Public key contains an unsupported key type: ${(n=r==null?void 0:r.crv)!==null&&n!==void 0?n:"undefined"}`);let s=yield Em.keyConverter(r.crv).publicKeyToBytes({publicKey:r});/^(secp256k1|P-256|P-384|P-521)$/.test(r.crv)&&(s=yield Em.keyCompressor(r.crv)({publicKeyBytes:s}));const{name:i}=yield Em.jwkToMulticodec({jwk:r});return SL({keyBytes:s,multicodecName:i})})}};Lo.JWK_TO_MULTICODEC={"Ed25519:public":"ed25519-pub","Ed25519:private":"ed25519-priv","secp256k1:public":"secp256k1-pub","secp256k1:private":"secp256k1-priv","X25519:public":"x25519-pub","X25519:private":"x25519-priv"};Lo.MULTICODEC_PUBLIC_KEY_LENGTH={231:33,236:32,237:32};Lo.MULTICODEC_TO_JWK={"ed25519-pub":{crv:"Ed25519",kty:"OKP",x:""},"ed25519-priv":{crv:"Ed25519",kty:"OKP",x:"",d:""},"secp256k1-pub":{crv:"secp256k1",kty:"EC",x:"",y:""},"secp256k1-priv":{crv:"secp256k1",kty:"EC",x:"",y:"",d:""},"x25519-pub":{crv:"X25519",kty:"OKP",x:""},"x25519-priv":{crv:"X25519",kty:"OKP",x:"",d:""}};var $de=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let zL=class WL extends Uw{static resolve(e,r){return $de(this,void 0,void 0,function*(){const n=_r.parse(e);if(!n)return Object.assign(Object.assign({},Ri),{didResolutionMetadata:{error:"invalidDid"}});if(n.method!==WL.methodName)return Object.assign(Object.assign({},Ri),{didResolutionMetadata:{error:"methodNotSupported"}});let s=`https://${n.id.replace(/:/g,"/")}`;s=decodeURIComponent(s);const i=n.id.includes(":")?`${s}/did.json`:`${s}/.well-known/did.json`;try{const o=yield fetch(i);if(!o.ok)throw new Error("HTTP error status code returned");const a=yield o.json();return Object.assign(Object.assign({},Ri),{didDocument:a})}catch{return Object.assign(Object.assign({},Ri),{didResolutionMetadata:{error:"notFound"}})}})}};zL.methodName="web";var wy=1e3,_y=wy*60,by=_y*60,vp=by*24,Ode=vp*7,Rde=vp*365.25,Nde=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return Bde(t);if(r==="number"&&isFinite(t))return e.long?Mde(t):Fde(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function Bde(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*Rde;case"weeks":case"week":case"w":return r*Ode;case"days":case"day":case"d":return r*vp;case"hours":case"hour":case"hrs":case"hr":case"h":return r*by;case"minutes":case"minute":case"mins":case"min":case"m":return r*_y;case"seconds":case"second":case"secs":case"sec":case"s":return r*wy;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Fde(t){var e=Math.abs(t);return e>=vp?Math.round(t/vp)+"d":e>=by?Math.round(t/by)+"h":e>=_y?Math.round(t/_y)+"m":e>=wy?Math.round(t/wy)+"s":t+"ms"}function Mde(t){var e=Math.abs(t);return e>=vp?hb(t,e,vp,"day"):e>=by?hb(t,e,by,"hour"):e>=_y?hb(t,e,_y,"minute"):e>=wy?hb(t,e,wy,"second"):t+" ms"}function hb(t,e,r,n){var s=e>=r*1.5;return Math.round(t/r)+" "+n+(s?"s":"")}const jde=nc(Nde),Ude={get:function(t){return null},set:function(t,e){return null},delete:function(t){return null},clear:function(){return null},close:function(){return null}};var nF=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let Lde=class{constructor({cache:e,didResolvers:r}){this.didResolvers=new Map,this.cache=e||Ude;for(const n of r)this.didResolvers.set(n.methodName,n)}resolve(e,r){return nF(this,void 0,void 0,function*(){const n=_r.parse(e);if(!n)return Object.assign(Object.assign({},Ri),{didResolutionMetadata:{error:st.InvalidDid,errorMessage:`Invalid DID URI: ${e}`}});const s=this.didResolvers.get(n.method);if(!s)return Object.assign(Object.assign({},Ri),{didResolutionMetadata:{error:st.MethodNotSupported,errorMessage:`Method not supported: ${n.method}`}});const i=yield this.cache.get(n.uri);if(i)return i;{const o=yield s.resolve(n.uri,r);return o.didResolutionMetadata.error||(yield this.cache.set(n.uri,o)),o}})}dereference(e,r){return nF(this,void 0,void 0,function*(){const n=_r.parse(e);if(!n)return{dereferencingMetadata:{error:st.InvalidDidUrl},contentStream:null,contentMetadata:{}};const{didDocument:s,didResolutionMetadata:i,didDocumentMetadata:o}=yield this.resolve(n.uri);if(!s)return{dereferencingMetadata:{error:i.error},contentStream:null,contentMetadata:{}};if(!n.fragment||n.query)return{dereferencingMetadata:{contentType:"application/did+json"},contentStream:s,contentMetadata:o};const{service:a=[],verificationMethod:u=[]}=s,l=new Set([e,n.fragment,`#${n.fragment}`]);let c;for(let d of u)if(l.has(d.id)){c=d;break}for(let d of a)if(l.has(d.id)){c=d;break}return c?{dereferencingMetadata:{contentType:"application/did+json"},contentStream:c,contentMetadata:i}:{dereferencingMetadata:{error:st.NotFound},contentStream:null,contentMetadata:{}}})}};const GL=new Lde({didResolvers:[CE,HL,zL]});async function Kde(t){const{didResolutionMetadata:e,didDocument:r}=await GL.resolve(t);if(e.error)throw new Error(`Failed to resolve DID: ${t}. Error: ${e.error}`);return r}function Vde(t){return!!t&&"id"in t&&"type"in t&&"controller"in t}const qde=new pce;class np{static digest(e){const r=KL(e),n=Aa.string(r).toUint8Array();return pf(n)}static async sign(e){const{did:r,payload:n,detached:s}=e,i=await r.getSigner();let o=i.keyId;o.startsWith("#")&&(o=`${r.uri}${o}`);const a={alg:i.algorithm,kid:o},u=Aa.object(a).toBase64Url(),l=Aa.uint8Array(n).toBase64Url(),c=`${u}.${l}`,d=Aa.string(c).toUint8Array(),h=await i.sign({data:d}),f=Aa.uint8Array(h).toBase64Url();return s?`${u}..${f}`:`${u}.${l}.${f}`}static async verify(e){const{signature:r,detachedPayload:n}=e;if(!r)throw new Error("Signature verification failed: Expected signature property to exist");const s=r.split(".");if(s.length!==3)throw new Error("Signature verification failed: Expected valid JWS with detached content");let[i,o,a]=s;if(n){if(o.length!==0)throw new Error("Signature verification failed: Expected valid JWS with detached content");o=Aa.uint8Array(n).toBase64Url()}const u=Aa.base64Url(i).toObject();if(!u.alg||!u.kid)throw new Error("Signature verification failed: Expected JWS header to contain alg and kid");const c=(await GL.dereference(u.kid)).contentStream;if(!Vde(c))throw new Error("Signature verification failed: Expected kid in JWS header to dereference to a DID Document Verification Method");const d=c.publicKeyJwk;if(!d)throw new Error("Signature verification failed: Expected kid in JWS header to dereference to a DID Document Verification Method with publicKeyJwk");const h=`${i}.${o}`,f=Aa.string(h).toUint8Array(),p=Aa.base64Url(a).toUint8Array();if(!await qde.verify({key:d,data:f,signature:p}))throw new Error("Signature verification failed: Integrity mismatch");const[E]=u.kid.split("#");return E}}var Kw={},mS=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,s,i;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(s=n;s--!==0;)if(!t(e[s],r[s]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(i=Object.keys(e),n=i.length,n!==Object.keys(r).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(r,i[s]))return!1;for(s=n;s--!==0;){var o=i[s];if(!t(e[o],r[o]))return!1}return!0}return e!==e&&r!==r};Object.defineProperty(Kw,"__esModule",{value:!0});const JL=mS;JL.code='require("ajv/dist/runtime/equal").default';var iF=Kw.default=JL;const Hde=Am;function Am(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){for(const u in t)if(!(u==="reason"||u==="success"))return Am.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:u},message:"must NOT have additional properties"}],!1;{if(t.reason!==void 0){const u=o;if(typeof t.reason!="string")return Am.errors=[{instancePath:e+"/reason",schemaPath:"#/properties/reason/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=u===o}else var a=!0;if(a)if(t.success!==void 0){const u=o;if(typeof t.success!="boolean")return Am.errors=[{instancePath:e+"/success",schemaPath:"#/properties/success/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var a=u===o}else var a=!0}}else return Am.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Am.errors=i,o===0}const zde=eP;function eP(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;return t&&typeof t=="object"&&!Array.isArray(t)?(eP.errors=i,o===0):(eP.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1)}const Wde=ft,Gde={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://tbdex.dev/offering.schema.json",type:"object",properties:{additionalProperties:!1,description:{type:"string",description:"Brief description of what is being offered."},payin:{type:"object",additionalProperties:!1,properties:{currencyCode:{type:"string",description:"ISO 3166 currency code string"},min:{$ref:"definitions.json#/definitions/decimalString",description:"Minimum amount of currency that can be requested"},max:{$ref:"definitions.json#/definitions/decimalString",description:"Maximum amount of currency that can be requested"},methods:{type:"array",items:{type:"object",additionalProperties:!1,properties:{kind:{type:"string",description:"The type of payment method. e.g. BITCOIN_ADDRESS, DEBIT_CARD, etc."},name:{type:"string",description:"Payment Method name. Expected to be rendered on screen."},description:{type:"string",description:'Blurb containing helpful information about the payment method. Expected to be rendered on screen. e.g. "segwit addresses only"'},group:{type:"string",description:"Value that can be used to group specific payment methods together (e.g. Mobile Money vs. Direct Bank Deposit)."},requiredPaymentDetails:{$ref:"http://json-schema.org/draft-07/schema",description:"A JSON Schema containing the fields that need to be collected in order to use this payment method"},min:{$ref:"definitions.json#/definitions/decimalString",description:"Minimum amount required to use this payment method."},max:{$ref:"definitions.json#/definitions/decimalString",description:"Maximum amount allowed when using this payment method."},fee:{$ref:"definitions.json#/definitions/decimalString",description:"Fee charged to use this payment method. Absence of this field implies that there is no _additional_ fee associated to the respective payment method."}},required:["kind"]}}},required:["currencyCode","methods"]},payout:{type:"object",additionalProperties:!1,properties:{currencyCode:{type:"string",description:"ISO 3166 currency code string"},min:{$ref:"definitions.json#/definitions/decimalString",description:"Minimum amount of currency that can be requested"},max:{$ref:"definitions.json#/definitions/decimalString",description:"Maximum amount of currency that can be requested"},methods:{type:"array",items:{type:"object",additionalProperties:!1,properties:{kind:{type:"string",description:"The type of payment method. e.g. BITCOIN_ADDRESS, DEBIT_CARD, etc."},name:{type:"string",description:"Payment Method name. Expected to be rendered on screen."},description:{type:"string",description:'Blurb containing helpful information about the payment method. Expected to be rendered on screen. e.g. "segwit addresses only"'},group:{type:"string",description:"Value that can be used to group specific payment methods together (e.g. Mobile Money vs. Direct Bank Deposit)."},requiredPaymentDetails:{$ref:"http://json-schema.org/draft-07/schema",description:"A JSON Schema containing the fields that need to be collected in order to use this payment method"},min:{$ref:"definitions.json#/definitions/decimalString",description:"Minimum amount required to use this payment method."},max:{$ref:"definitions.json#/definitions/decimalString",description:"Maximum amount allowed when using this payment method."},fee:{$ref:"definitions.json#/definitions/decimalString",description:"Fee charged to use this payment method. absence of this field implies that there is no _additional_ fee associated to the respective payment method"},estimatedSettlementTime:{type:"number",description:"Estimated time in seconds for the payout to be settled. e.g. 3600 for 1 hour. 0 for instant settlement.",minimum:0}},required:["kind","estimatedSettlementTime"]}}},required:["currencyCode","methods"]},payoutUnitsPerPayinUnit:{type:"string",description:"Number of payout currency units for one payin currency unit (i.e 290000 USD for 1 BTC)"},requiredClaims:{type:"object",description:"PresentationDefinition that describes the credential(s) the PFI requires in order to provide a quote."}},required:["description","payin","payout","payoutUnitsPerPayinUnit"]},Os=new RegExp("^([0-9]+(?:[.][0-9]+)?)$","u"),Jde={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0},sF={enum:["array","boolean","integer","null","number","object","string"]};function Ko(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;return typeof t=="number"&&!(t%1)&&!isNaN(t)&&isFinite(t)?typeof t=="number"&&isFinite(t)&&(t<0||isNaN(t))?(Ko.errors=[{instancePath:e,schemaPath:"#/definitions/nonNegativeInteger/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1):(Ko.errors=i,o===0):(Ko.errors=[{instancePath:e,schemaPath:"#/definitions/nonNegativeInteger/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1)}const ET={validate:Me};function us(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(o===0)if(Array.isArray(t)){if(t.length<1)return us.errors=[{instancePath:e,schemaPath:"#/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{var a=!0;const u=t.length;for(let l=0;l<u;l++){const c=o;ET.validate(t[l],{instancePath:e+"/"+l,parentData:t,parentDataProperty:l,rootData:s})||(i=i===null?ET.validate.errors:i.concat(ET.validate.errors),o=i.length);var a=c===o;if(!a)break}}}else return us.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;return us.errors=i,o===0}function Me(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(!(t&&typeof t=="object"&&!Array.isArray(t))&&typeof t!="boolean")return Me.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:Jde.type},message:"must be object,boolean"}],!1;if(o===0&&t&&typeof t=="object"&&!Array.isArray(t)){if(t.$id!==void 0){const g=o;if(o===g&&o===g&&typeof t.$id!="string")return Me.errors=[{instancePath:e+"/$id",schemaPath:"#/properties/%24id/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=g===o}else var a=!0;if(a){if(t.$schema!==void 0){const g=o;if(o===g&&o===g&&typeof t.$schema!="string")return Me.errors=[{instancePath:e+"/$schema",schemaPath:"#/properties/%24schema/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=g===o}else var a=!0;if(a){if(t.$ref!==void 0){const g=o;if(o===g&&o===g&&typeof t.$ref!="string")return Me.errors=[{instancePath:e+"/$ref",schemaPath:"#/properties/%24ref/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=g===o}else var a=!0;if(a){if(t.$comment!==void 0){const g=o;if(typeof t.$comment!="string")return Me.errors=[{instancePath:e+"/$comment",schemaPath:"#/properties/%24comment/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=g===o}else var a=!0;if(a){if(t.title!==void 0){const g=o;if(typeof t.title!="string")return Me.errors=[{instancePath:e+"/title",schemaPath:"#/properties/title/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=g===o}else var a=!0;if(a){if(t.description!==void 0){const g=o;if(typeof t.description!="string")return Me.errors=[{instancePath:e+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=g===o}else var a=!0;if(a){if(t.readOnly!==void 0){const g=o;if(typeof t.readOnly!="boolean")return Me.errors=[{instancePath:e+"/readOnly",schemaPath:"#/properties/readOnly/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var a=g===o}else var a=!0;if(a){if(t.examples!==void 0){const g=o;if(o===g&&!Array.isArray(t.examples))return Me.errors=[{instancePath:e+"/examples",schemaPath:"#/properties/examples/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var a=g===o}else var a=!0;if(a){if(t.multipleOf!==void 0){let g=t.multipleOf;const v=o;if(o===v)if(typeof g=="number"&&isFinite(g)){if(g<=0||isNaN(g))return Me.errors=[{instancePath:e+"/multipleOf",schemaPath:"#/properties/multipleOf/exclusiveMinimum",keyword:"exclusiveMinimum",params:{comparison:">",limit:0},message:"must be > 0"}],!1}else return Me.errors=[{instancePath:e+"/multipleOf",schemaPath:"#/properties/multipleOf/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var a=v===o}else var a=!0;if(a){if(t.maximum!==void 0){let g=t.maximum;const v=o;if(!(typeof g=="number"&&isFinite(g)))return Me.errors=[{instancePath:e+"/maximum",schemaPath:"#/properties/maximum/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var a=v===o}else var a=!0;if(a){if(t.exclusiveMaximum!==void 0){let g=t.exclusiveMaximum;const v=o;if(!(typeof g=="number"&&isFinite(g)))return Me.errors=[{instancePath:e+"/exclusiveMaximum",schemaPath:"#/properties/exclusiveMaximum/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var a=v===o}else var a=!0;if(a){if(t.minimum!==void 0){let g=t.minimum;const v=o;if(!(typeof g=="number"&&isFinite(g)))return Me.errors=[{instancePath:e+"/minimum",schemaPath:"#/properties/minimum/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var a=v===o}else var a=!0;if(a){if(t.exclusiveMinimum!==void 0){let g=t.exclusiveMinimum;const v=o;if(!(typeof g=="number"&&isFinite(g)))return Me.errors=[{instancePath:e+"/exclusiveMinimum",schemaPath:"#/properties/exclusiveMinimum/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var a=v===o}else var a=!0;if(a){if(t.maxLength!==void 0){let g=t.maxLength;const v=o,S=o;if(!(typeof g=="number"&&!(g%1)&&!isNaN(g)&&isFinite(g)))return Me.errors=[{instancePath:e+"/maxLength",schemaPath:"#/definitions/nonNegativeInteger/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;if(o===S&&typeof g=="number"&&isFinite(g)&&(g<0||isNaN(g)))return Me.errors=[{instancePath:e+"/maxLength",schemaPath:"#/definitions/nonNegativeInteger/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1;var a=v===o}else var a=!0;if(a){if(t.minLength!==void 0){const g=o;Ko(t.minLength,{instancePath:e+"/minLength",parentData:t,parentDataProperty:"minLength",rootData:s})||(i=i===null?Ko.errors:i.concat(Ko.errors),o=i.length);var a=g===o}else var a=!0;if(a){if(t.pattern!==void 0){const g=o;if(o===g&&o===g&&typeof t.pattern!="string")return Me.errors=[{instancePath:e+"/pattern",schemaPath:"#/properties/pattern/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=g===o}else var a=!0;if(a){if(t.additionalItems!==void 0){const g=o;Me(t.additionalItems,{instancePath:e+"/additionalItems",parentData:t,parentDataProperty:"additionalItems",rootData:s})||(i=i===null?Me.errors:i.concat(Me.errors),o=i.length);var a=g===o}else var a=!0;if(a){if(t.items!==void 0){let g=t.items;const v=o,S=o;let x=!1;const D=o;Me(g,{instancePath:e+"/items",parentData:t,parentDataProperty:"items",rootData:s})||(i=i===null?Me.errors:i.concat(Me.errors),o=i.length);var u=D===o;if(x=x||u,!x){const b=o;us(g,{instancePath:e+"/items",parentData:t,parentDataProperty:"items",rootData:s})||(i=i===null?us.errors:i.concat(us.errors),o=i.length);var u=b===o;x=x||u}if(x)o=S,i!==null&&(S?i.length=S:i=null);else{const b={instancePath:e+"/items",schemaPath:"#/properties/items/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return i===null?i=[b]:i.push(b),o++,Me.errors=i,!1}var a=v===o}else var a=!0;if(a){if(t.maxItems!==void 0){let g=t.maxItems;const v=o,S=o;if(!(typeof g=="number"&&!(g%1)&&!isNaN(g)&&isFinite(g)))return Me.errors=[{instancePath:e+"/maxItems",schemaPath:"#/definitions/nonNegativeInteger/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;if(o===S&&typeof g=="number"&&isFinite(g)&&(g<0||isNaN(g)))return Me.errors=[{instancePath:e+"/maxItems",schemaPath:"#/definitions/nonNegativeInteger/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1;var a=v===o}else var a=!0;if(a){if(t.minItems!==void 0){const g=o;Ko(t.minItems,{instancePath:e+"/minItems",parentData:t,parentDataProperty:"minItems",rootData:s})||(i=i===null?Ko.errors:i.concat(Ko.errors),o=i.length);var a=g===o}else var a=!0;if(a){if(t.uniqueItems!==void 0){const g=o;if(typeof t.uniqueItems!="boolean")return Me.errors=[{instancePath:e+"/uniqueItems",schemaPath:"#/properties/uniqueItems/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var a=g===o}else var a=!0;if(a){if(t.contains!==void 0){const g=o;Me(t.contains,{instancePath:e+"/contains",parentData:t,parentDataProperty:"contains",rootData:s})||(i=i===null?Me.errors:i.concat(Me.errors),o=i.length);var a=g===o}else var a=!0;if(a){if(t.maxProperties!==void 0){let g=t.maxProperties;const v=o,S=o;if(!(typeof g=="number"&&!(g%1)&&!isNaN(g)&&isFinite(g)))return Me.errors=[{instancePath:e+"/maxProperties",schemaPath:"#/definitions/nonNegativeInteger/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;if(o===S&&typeof g=="number"&&isFinite(g)&&(g<0||isNaN(g)))return Me.errors=[{instancePath:e+"/maxProperties",schemaPath:"#/definitions/nonNegativeInteger/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1;var a=v===o}else var a=!0;if(a){if(t.minProperties!==void 0){const g=o;Ko(t.minProperties,{instancePath:e+"/minProperties",parentData:t,parentDataProperty:"minProperties",rootData:s})||(i=i===null?Ko.errors:i.concat(Ko.errors),o=i.length);var a=g===o}else var a=!0;if(a){if(t.required!==void 0){let g=t.required;const v=o;if(o===o)if(Array.isArray(g)){var l=!0;const D=g.length;for(let w=0;w<D;w++){const b=o;if(typeof g[w]!="string")return Me.errors=[{instancePath:e+"/required/"+w,schemaPath:"#/definitions/stringArray/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var l=b===o;if(!l)break}if(l){let w=g.length,b;if(w>1){const T={};for(;w--;){let P=g[w];if(typeof P=="string"){if(typeof T[P]=="number")return b=T[P],Me.errors=[{instancePath:e+"/required",schemaPath:"#/definitions/stringArray/uniqueItems",keyword:"uniqueItems",params:{i:w,j:b},message:"must NOT have duplicate items (items ## "+b+" and "+w+" are identical)"}],!1;T[P]=w}}}}}else return Me.errors=[{instancePath:e+"/required",schemaPath:"#/definitions/stringArray/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var a=v===o}else var a=!0;if(a){if(t.additionalProperties!==void 0){const g=o;Me(t.additionalProperties,{instancePath:e+"/additionalProperties",parentData:t,parentDataProperty:"additionalProperties",rootData:s})||(i=i===null?Me.errors:i.concat(Me.errors),o=i.length);var a=g===o}else var a=!0;if(a){if(t.definitions!==void 0){let g=t.definitions;const v=o;if(o===v)if(g&&typeof g=="object"&&!Array.isArray(g))for(const x in g){const D=o;Me(g[x],{instancePath:e+"/definitions/"+x.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:g,parentDataProperty:x,rootData:s})||(i=i===null?Me.errors:i.concat(Me.errors),o=i.length);var c=D===o;if(!c)break}else return Me.errors=[{instancePath:e+"/definitions",schemaPath:"#/properties/definitions/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=v===o}else var a=!0;if(a){if(t.properties!==void 0){let g=t.properties;const v=o;if(o===v)if(g&&typeof g=="object"&&!Array.isArray(g))for(const x in g){const D=o;Me(g[x],{instancePath:e+"/properties/"+x.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:g,parentDataProperty:x,rootData:s})||(i=i===null?Me.errors:i.concat(Me.errors),o=i.length);var d=D===o;if(!d)break}else return Me.errors=[{instancePath:e+"/properties",schemaPath:"#/properties/properties/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=v===o}else var a=!0;if(a){if(t.patternProperties!==void 0){let g=t.patternProperties;const v=o;if(o===v)if(g&&typeof g=="object"&&!Array.isArray(g)){for(const x in g){var h=o===o;if(!h){const w={instancePath:e+"/patternProperties",schemaPath:"#/properties/patternProperties/propertyNames",keyword:"propertyNames",params:{propertyName:x},message:"property name must be valid"};return i===null?i=[w]:i.push(w),o++,Me.errors=i,!1}}if(h)for(const x in g){const D=o;Me(g[x],{instancePath:e+"/patternProperties/"+x.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:g,parentDataProperty:x,rootData:s})||(i=i===null?Me.errors:i.concat(Me.errors),o=i.length);var f=D===o;if(!f)break}}else return Me.errors=[{instancePath:e+"/patternProperties",schemaPath:"#/properties/patternProperties/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=v===o}else var a=!0;if(a){if(t.dependencies!==void 0){let g=t.dependencies;const v=o;if(o===v)if(g&&typeof g=="object"&&!Array.isArray(g))for(const x in g){let D=g[x];const w=o,b=o;let T=!1;const P=o;Me(D,{instancePath:e+"/dependencies/"+x.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:g,parentDataProperty:x,rootData:s})||(i=i===null?Me.errors:i.concat(Me.errors),o=i.length);var p=P===o;if(T=T||p,!T){const C=o;if(o===o)if(Array.isArray(D)){var m=!0;const L=D.length;for(let q=0;q<L;q++){const se=o;if(typeof D[q]!="string"){const re={instancePath:e+"/dependencies/"+x.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+q,schemaPath:"#/definitions/stringArray/items/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[re]:i.push(re),o++}var m=se===o;if(!m)break}if(m){let q=D.length,se;if(q>1){const X={};for(;q--;){let re=D[q];if(typeof re=="string"){if(typeof X[re]=="number"){se=X[re];const W={instancePath:e+"/dependencies/"+x.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/stringArray/uniqueItems",keyword:"uniqueItems",params:{i:q,j:se},message:"must NOT have duplicate items (items ## "+se+" and "+q+" are identical)"};i===null?i=[W]:i.push(W),o++;break}X[re]=q}}}}}else{const L={instancePath:e+"/dependencies/"+x.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/stringArray/type",keyword:"type",params:{type:"array"},message:"must be array"};i===null?i=[L]:i.push(L),o++}var p=C===o;T=T||p}if(T)o=b,i!==null&&(b?i.length=b:i=null);else{const C={instancePath:e+"/dependencies/"+x.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/dependencies/additionalProperties/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return i===null?i=[C]:i.push(C),o++,Me.errors=i,!1}var E=w===o;if(!E)break}else return Me.errors=[{instancePath:e+"/dependencies",schemaPath:"#/properties/dependencies/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=v===o}else var a=!0;if(a){if(t.propertyNames!==void 0){const g=o;Me(t.propertyNames,{instancePath:e+"/propertyNames",parentData:t,parentDataProperty:"propertyNames",rootData:s})||(i=i===null?Me.errors:i.concat(Me.errors),o=i.length);var a=g===o}else var a=!0;if(a){if(t.enum!==void 0){let g=t.enum;const v=o;if(o===v)if(Array.isArray(g)){if(g.length<1)return Me.errors=[{instancePath:e+"/enum",schemaPath:"#/properties/enum/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{let x=g.length,D;if(x>1){for(;x--;)for(D=x;D--;)if(iF(g[x],g[D]))return Me.errors=[{instancePath:e+"/enum",schemaPath:"#/properties/enum/uniqueItems",keyword:"uniqueItems",params:{i:x,j:D},message:"must NOT have duplicate items (items ## "+D+" and "+x+" are identical)"}],!1}}}else return Me.errors=[{instancePath:e+"/enum",schemaPath:"#/properties/enum/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var a=v===o}else var a=!0;if(a){if(t.type!==void 0){let g=t.type;const v=o,S=o;let x=!1;const D=o;if(!(g==="array"||g==="boolean"||g==="integer"||g==="null"||g==="number"||g==="object"||g==="string")){const b={instancePath:e+"/type",schemaPath:"#/definitions/simpleTypes/enum",keyword:"enum",params:{allowedValues:sF.enum},message:"must be equal to one of the allowed values"};i===null?i=[b]:i.push(b),o++}var A=D===o;if(x=x||A,!x){const b=o;if(o===b)if(Array.isArray(g))if(g.length<1){const P={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf/1/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"};i===null?i=[P]:i.push(P),o++}else{var _=!0;const P=g.length;for(let C=0;C<P;C++){let k=g[C];const K=o;if(!(k==="array"||k==="boolean"||k==="integer"||k==="null"||k==="number"||k==="object"||k==="string")){const q={instancePath:e+"/type/"+C,schemaPath:"#/definitions/simpleTypes/enum",keyword:"enum",params:{allowedValues:sF.enum},message:"must be equal to one of the allowed values"};i===null?i=[q]:i.push(q),o++}var _=K===o;if(!_)break}if(_){let C=g.length,k;if(C>1){e:for(;C--;)for(k=C;k--;)if(iF(g[C],g[k])){const K={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf/1/uniqueItems",keyword:"uniqueItems",params:{i:C,j:k},message:"must NOT have duplicate items (items ## "+k+" and "+C+" are identical)"};i===null?i=[K]:i.push(K),o++;break e}}}}else{const P={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf/1/type",keyword:"type",params:{type:"array"},message:"must be array"};i===null?i=[P]:i.push(P),o++}var A=b===o;x=x||A}if(x)o=S,i!==null&&(S?i.length=S:i=null);else{const b={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return i===null?i=[b]:i.push(b),o++,Me.errors=i,!1}var a=v===o}else var a=!0;if(a){if(t.format!==void 0){const g=o;if(typeof t.format!="string")return Me.errors=[{instancePath:e+"/format",schemaPath:"#/properties/format/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=g===o}else var a=!0;if(a){if(t.contentMediaType!==void 0){const g=o;if(typeof t.contentMediaType!="string")return Me.errors=[{instancePath:e+"/contentMediaType",schemaPath:"#/properties/contentMediaType/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=g===o}else var a=!0;if(a){if(t.contentEncoding!==void 0){const g=o;if(typeof t.contentEncoding!="string")return Me.errors=[{instancePath:e+"/contentEncoding",schemaPath:"#/properties/contentEncoding/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=g===o}else var a=!0;if(a){if(t.if!==void 0){const g=o;Me(t.if,{instancePath:e+"/if",parentData:t,parentDataProperty:"if",rootData:s})||(i=i===null?Me.errors:i.concat(Me.errors),o=i.length);var a=g===o}else var a=!0;if(a){if(t.then!==void 0){const g=o;Me(t.then,{instancePath:e+"/then",parentData:t,parentDataProperty:"then",rootData:s})||(i=i===null?Me.errors:i.concat(Me.errors),o=i.length);var a=g===o}else var a=!0;if(a){if(t.else!==void 0){const g=o;Me(t.else,{instancePath:e+"/else",parentData:t,parentDataProperty:"else",rootData:s})||(i=i===null?Me.errors:i.concat(Me.errors),o=i.length);var a=g===o}else var a=!0;if(a){if(t.allOf!==void 0){const g=o;us(t.allOf,{instancePath:e+"/allOf",parentData:t,parentDataProperty:"allOf",rootData:s})||(i=i===null?us.errors:i.concat(us.errors),o=i.length);var a=g===o}else var a=!0;if(a){if(t.anyOf!==void 0){const g=o;us(t.anyOf,{instancePath:e+"/anyOf",parentData:t,parentDataProperty:"anyOf",rootData:s})||(i=i===null?us.errors:i.concat(us.errors),o=i.length);var a=g===o}else var a=!0;if(a){if(t.oneOf!==void 0){const g=o;us(t.oneOf,{instancePath:e+"/oneOf",parentData:t,parentDataProperty:"oneOf",rootData:s})||(i=i===null?us.errors:i.concat(us.errors),o=i.length);var a=g===o}else var a=!0;if(a)if(t.not!==void 0){const g=o;Me(t.not,{instancePath:e+"/not",parentData:t,parentDataProperty:"not",rootData:s})||(i=i===null?Me.errors:i.concat(Me.errors),o=i.length);var a=g===o}else var a=!0}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}return Me.errors=i,o===0}const Xde=Object.prototype.hasOwnProperty;function ft(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(o===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let p;if(t.description===void 0&&(p="description")||t.payin===void 0&&(p="payin")||t.payout===void 0&&(p="payout")||t.payoutUnitsPerPayinUnit===void 0&&(p="payoutUnitsPerPayinUnit"))return ft.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:p},message:"must have required property '"+p+"'"}],!1;if(t.additionalProperties!==void 0){var a=!1;return ft.errors=[{instancePath:e+"/additionalProperties",schemaPath:"#/properties/additionalProperties/false schema",keyword:"false schema",params:{},message:"boolean schema is false"}],!1}else var a=!0;if(a){if(t.description!==void 0){const m=o;if(typeof t.description!="string")return ft.errors=[{instancePath:e+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=m===o}else var a=!0;if(a){if(t.payin!==void 0){let m=t.payin;const E=o;if(o===E)if(m&&typeof m=="object"&&!Array.isArray(m)){let _;if(m.currencyCode===void 0&&(_="currencyCode")||m.methods===void 0&&(_="methods"))return ft.errors=[{instancePath:e+"/payin",schemaPath:"#/properties/payin/required",keyword:"required",params:{missingProperty:_},message:"must have required property '"+_+"'"}],!1;{const g=o;for(const v in m)if(!(v==="currencyCode"||v==="min"||v==="max"||v==="methods"))return ft.errors=[{instancePath:e+"/payin",schemaPath:"#/properties/payin/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:v},message:"must NOT have additional properties"}],!1;if(g===o){if(m.currencyCode!==void 0){const v=o;if(typeof m.currencyCode!="string")return ft.errors=[{instancePath:e+"/payin/currencyCode",schemaPath:"#/properties/payin/properties/currencyCode/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=v===o}else var u=!0;if(u){if(m.min!==void 0){let v=m.min;const S=o;if(o===o)if(typeof v=="string"){if(!Os.test(v))return ft.errors=[{instancePath:e+"/payin/min",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return ft.errors=[{instancePath:e+"/payin/min",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=S===o}else var u=!0;if(u){if(m.max!==void 0){let v=m.max;const S=o;if(o===o)if(typeof v=="string"){if(!Os.test(v))return ft.errors=[{instancePath:e+"/payin/max",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return ft.errors=[{instancePath:e+"/payin/max",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=S===o}else var u=!0;if(u)if(m.methods!==void 0){let v=m.methods;const S=o;if(o===S)if(Array.isArray(v)){var l=!0;const D=v.length;for(let w=0;w<D;w++){let b=v[w];const T=o;if(o===T)if(b&&typeof b=="object"&&!Array.isArray(b)){let C;if(b.kind===void 0&&(C="kind"))return ft.errors=[{instancePath:e+"/payin/methods/"+w,schemaPath:"#/properties/payin/properties/methods/items/required",keyword:"required",params:{missingProperty:C},message:"must have required property '"+C+"'"}],!1;{const k=o;for(const K in b)if(!(K==="kind"||K==="name"||K==="description"||K==="group"||K==="requiredPaymentDetails"||K==="min"||K==="max"||K==="fee"))return ft.errors=[{instancePath:e+"/payin/methods/"+w,schemaPath:"#/properties/payin/properties/methods/items/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:K},message:"must NOT have additional properties"}],!1;if(k===o){if(b.kind!==void 0){const K=o;if(typeof b.kind!="string")return ft.errors=[{instancePath:e+"/payin/methods/"+w+"/kind",schemaPath:"#/properties/payin/properties/methods/items/properties/kind/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=K===o}else var c=!0;if(c){if(b.name!==void 0){const K=o;if(typeof b.name!="string")return ft.errors=[{instancePath:e+"/payin/methods/"+w+"/name",schemaPath:"#/properties/payin/properties/methods/items/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=K===o}else var c=!0;if(c){if(b.description!==void 0){const K=o;if(typeof b.description!="string")return ft.errors=[{instancePath:e+"/payin/methods/"+w+"/description",schemaPath:"#/properties/payin/properties/methods/items/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=K===o}else var c=!0;if(c){if(b.group!==void 0){const K=o;if(typeof b.group!="string")return ft.errors=[{instancePath:e+"/payin/methods/"+w+"/group",schemaPath:"#/properties/payin/properties/methods/items/properties/group/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=K===o}else var c=!0;if(c){if(b.requiredPaymentDetails!==void 0){const K=o;Me(b.requiredPaymentDetails,{instancePath:e+"/payin/methods/"+w+"/requiredPaymentDetails",parentData:b,parentDataProperty:"requiredPaymentDetails",rootData:s})||(i=i===null?Me.errors:i.concat(Me.errors),o=i.length);var c=K===o}else var c=!0;if(c){if(b.min!==void 0){let K=b.min;const L=o;if(o===o)if(typeof K=="string"){if(!Os.test(K))return ft.errors=[{instancePath:e+"/payin/methods/"+w+"/min",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return ft.errors=[{instancePath:e+"/payin/methods/"+w+"/min",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=L===o}else var c=!0;if(c){if(b.max!==void 0){let K=b.max;const L=o;if(o===o)if(typeof K=="string"){if(!Os.test(K))return ft.errors=[{instancePath:e+"/payin/methods/"+w+"/max",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return ft.errors=[{instancePath:e+"/payin/methods/"+w+"/max",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=L===o}else var c=!0;if(c)if(b.fee!==void 0){let K=b.fee;const L=o;if(o===o)if(typeof K=="string"){if(!Os.test(K))return ft.errors=[{instancePath:e+"/payin/methods/"+w+"/fee",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return ft.errors=[{instancePath:e+"/payin/methods/"+w+"/fee",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=L===o}else var c=!0}}}}}}}}}else return ft.errors=[{instancePath:e+"/payin/methods/"+w,schemaPath:"#/properties/payin/properties/methods/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var l=T===o;if(!l)break}}else return ft.errors=[{instancePath:e+"/payin/methods",schemaPath:"#/properties/payin/properties/methods/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var u=S===o}else var u=!0}}}}}else return ft.errors=[{instancePath:e+"/payin",schemaPath:"#/properties/payin/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=E===o}else var a=!0;if(a){if(t.payout!==void 0){let m=t.payout;const E=o;if(o===E)if(m&&typeof m=="object"&&!Array.isArray(m)){let _;if(m.currencyCode===void 0&&(_="currencyCode")||m.methods===void 0&&(_="methods"))return ft.errors=[{instancePath:e+"/payout",schemaPath:"#/properties/payout/required",keyword:"required",params:{missingProperty:_},message:"must have required property '"+_+"'"}],!1;{const g=o;for(const v in m)if(!(v==="currencyCode"||v==="min"||v==="max"||v==="methods"))return ft.errors=[{instancePath:e+"/payout",schemaPath:"#/properties/payout/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:v},message:"must NOT have additional properties"}],!1;if(g===o){if(m.currencyCode!==void 0){const v=o;if(typeof m.currencyCode!="string")return ft.errors=[{instancePath:e+"/payout/currencyCode",schemaPath:"#/properties/payout/properties/currencyCode/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var d=v===o}else var d=!0;if(d){if(m.min!==void 0){let v=m.min;const S=o;if(o===o)if(typeof v=="string"){if(!Os.test(v))return ft.errors=[{instancePath:e+"/payout/min",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return ft.errors=[{instancePath:e+"/payout/min",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var d=S===o}else var d=!0;if(d){if(m.max!==void 0){let v=m.max;const S=o;if(o===o)if(typeof v=="string"){if(!Os.test(v))return ft.errors=[{instancePath:e+"/payout/max",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return ft.errors=[{instancePath:e+"/payout/max",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var d=S===o}else var d=!0;if(d)if(m.methods!==void 0){let v=m.methods;const S=o;if(o===S)if(Array.isArray(v)){var h=!0;const D=v.length;for(let w=0;w<D;w++){let b=v[w];const T=o;if(o===T)if(b&&typeof b=="object"&&!Array.isArray(b)){let C;if(b.kind===void 0&&(C="kind")||b.estimatedSettlementTime===void 0&&(C="estimatedSettlementTime"))return ft.errors=[{instancePath:e+"/payout/methods/"+w,schemaPath:"#/properties/payout/properties/methods/items/required",keyword:"required",params:{missingProperty:C},message:"must have required property '"+C+"'"}],!1;{const k=o;for(const K in b)if(!Xde.call(Gde.properties.payout.properties.methods.items.properties,K))return ft.errors=[{instancePath:e+"/payout/methods/"+w,schemaPath:"#/properties/payout/properties/methods/items/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:K},message:"must NOT have additional properties"}],!1;if(k===o){if(b.kind!==void 0){const K=o;if(typeof b.kind!="string")return ft.errors=[{instancePath:e+"/payout/methods/"+w+"/kind",schemaPath:"#/properties/payout/properties/methods/items/properties/kind/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var f=K===o}else var f=!0;if(f){if(b.name!==void 0){const K=o;if(typeof b.name!="string")return ft.errors=[{instancePath:e+"/payout/methods/"+w+"/name",schemaPath:"#/properties/payout/properties/methods/items/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var f=K===o}else var f=!0;if(f){if(b.description!==void 0){const K=o;if(typeof b.description!="string")return ft.errors=[{instancePath:e+"/payout/methods/"+w+"/description",schemaPath:"#/properties/payout/properties/methods/items/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var f=K===o}else var f=!0;if(f){if(b.group!==void 0){const K=o;if(typeof b.group!="string")return ft.errors=[{instancePath:e+"/payout/methods/"+w+"/group",schemaPath:"#/properties/payout/properties/methods/items/properties/group/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var f=K===o}else var f=!0;if(f){if(b.requiredPaymentDetails!==void 0){const K=o;Me(b.requiredPaymentDetails,{instancePath:e+"/payout/methods/"+w+"/requiredPaymentDetails",parentData:b,parentDataProperty:"requiredPaymentDetails",rootData:s})||(i=i===null?Me.errors:i.concat(Me.errors),o=i.length);var f=K===o}else var f=!0;if(f){if(b.min!==void 0){let K=b.min;const L=o;if(o===o)if(typeof K=="string"){if(!Os.test(K))return ft.errors=[{instancePath:e+"/payout/methods/"+w+"/min",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return ft.errors=[{instancePath:e+"/payout/methods/"+w+"/min",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var f=L===o}else var f=!0;if(f){if(b.max!==void 0){let K=b.max;const L=o;if(o===o)if(typeof K=="string"){if(!Os.test(K))return ft.errors=[{instancePath:e+"/payout/methods/"+w+"/max",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return ft.errors=[{instancePath:e+"/payout/methods/"+w+"/max",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var f=L===o}else var f=!0;if(f){if(b.fee!==void 0){let K=b.fee;const L=o;if(o===o)if(typeof K=="string"){if(!Os.test(K))return ft.errors=[{instancePath:e+"/payout/methods/"+w+"/fee",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return ft.errors=[{instancePath:e+"/payout/methods/"+w+"/fee",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var f=L===o}else var f=!0;if(f)if(b.estimatedSettlementTime!==void 0){let K=b.estimatedSettlementTime;const L=o;if(o===L)if(typeof K=="number"&&isFinite(K)){if(K<0||isNaN(K))return ft.errors=[{instancePath:e+"/payout/methods/"+w+"/estimatedSettlementTime",schemaPath:"#/properties/payout/properties/methods/items/properties/estimatedSettlementTime/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1}else return ft.errors=[{instancePath:e+"/payout/methods/"+w+"/estimatedSettlementTime",schemaPath:"#/properties/payout/properties/methods/items/properties/estimatedSettlementTime/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var f=L===o}else var f=!0}}}}}}}}}}else return ft.errors=[{instancePath:e+"/payout/methods/"+w,schemaPath:"#/properties/payout/properties/methods/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var h=T===o;if(!h)break}}else return ft.errors=[{instancePath:e+"/payout/methods",schemaPath:"#/properties/payout/properties/methods/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var d=S===o}else var d=!0}}}}}else return ft.errors=[{instancePath:e+"/payout",schemaPath:"#/properties/payout/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=E===o}else var a=!0;if(a){if(t.payoutUnitsPerPayinUnit!==void 0){const m=o;if(typeof t.payoutUnitsPerPayinUnit!="string")return ft.errors=[{instancePath:e+"/payoutUnitsPerPayinUnit",schemaPath:"#/properties/payoutUnitsPerPayinUnit/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=m===o}else var a=!0;if(a)if(t.requiredClaims!==void 0){let m=t.requiredClaims;const E=o;if(!(m&&typeof m=="object"&&!Array.isArray(m)))return ft.errors=[{instancePath:e+"/requiredClaims",schemaPath:"#/properties/requiredClaims/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=E===o}else var a=!0}}}}}else return ft.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return ft.errors=i,o===0}const Yde=vd;function vd(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){let u;if(t.currencyCode===void 0&&(u="currencyCode")||t.available===void 0&&(u="available"))return vd.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:u},message:"must have required property '"+u+"'"}],!1;if(t.additionalProperties!==void 0){var a=!1;return vd.errors=[{instancePath:e+"/additionalProperties",schemaPath:"#/properties/additionalProperties/false schema",keyword:"false schema",params:{},message:"boolean schema is false"}],!1}else var a=!0;if(a){if(t.currencyCode!==void 0){const l=o;if(typeof t.currencyCode!="string")return vd.errors=[{instancePath:e+"/currencyCode",schemaPath:"#/properties/currencyCode/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=l===o}else var a=!0;if(a)if(t.available!==void 0){let l=t.available;const c=o;if(typeof l=="string"){if(!Os.test(l))return vd.errors=[{instancePath:e+"/available",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return vd.errors=[{instancePath:e+"/available",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=c===o}else var a=!0}}else return vd.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return vd.errors=i,o===0}const Zde=wd,Qde={type:"object",additionalProperties:!1,properties:{from:{$ref:"definitions.json#/definitions/did",description:"The sender's DID"},to:{$ref:"definitions.json#/definitions/did",description:"The recipient's DID"},kind:{type:"string",enum:["rfq","quote","order","orderstatus","close"],description:"The message kind (e.g. rfq, quote)"},id:{type:"string",description:"The message ID"},exchangeId:{type:"string",description:"ID for a 'thread' of messages between Alice <-> PFI. Set by the first message in a thread"},externalId:{type:"string",description:"Arbitrary ID for the caller to associate with the message."},createdAt:{type:"string",description:"ISO8601 formatted string representing the timestamp"},protocol:{type:"string",description:"Version of the protocol in use (x.x format)"}},required:["from","to","kind","id","exchangeId","createdAt","protocol"]},tP=new RegExp("^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$","u");function Yn(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){let u;if(t.from===void 0&&(u="from")||t.to===void 0&&(u="to")||t.kind===void 0&&(u="kind")||t.id===void 0&&(u="id")||t.exchangeId===void 0&&(u="exchangeId")||t.createdAt===void 0&&(u="createdAt")||t.protocol===void 0&&(u="protocol"))return Yn.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:u},message:"must have required property '"+u+"'"}],!1;for(const l in t)if(!(l==="from"||l==="to"||l==="kind"||l==="id"||l==="exchangeId"||l==="externalId"||l==="createdAt"||l==="protocol"))return Yn.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:l},message:"must NOT have additional properties"}],!1;{if(t.from!==void 0){let l=t.from;const c=o;if(typeof l=="string"){if(!tP.test(l))return Yn.errors=[{instancePath:e+"/from",schemaPath:"definitions.json#/definitions/did/pattern",keyword:"pattern",params:{pattern:"^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"},message:'must match pattern "^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"'}],!1}else return Yn.errors=[{instancePath:e+"/from",schemaPath:"definitions.json#/definitions/did/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=c===o}else var a=!0;if(a){if(t.to!==void 0){let l=t.to;const c=o;if(typeof l=="string"){if(!tP.test(l))return Yn.errors=[{instancePath:e+"/to",schemaPath:"definitions.json#/definitions/did/pattern",keyword:"pattern",params:{pattern:"^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"},message:'must match pattern "^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"'}],!1}else return Yn.errors=[{instancePath:e+"/to",schemaPath:"definitions.json#/definitions/did/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=c===o}else var a=!0;if(a){if(t.kind!==void 0){let l=t.kind;const c=o;if(typeof l!="string")return Yn.errors=[{instancePath:e+"/kind",schemaPath:"#/properties/kind/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(l==="rfq"||l==="quote"||l==="order"||l==="orderstatus"||l==="close"))return Yn.errors=[{instancePath:e+"/kind",schemaPath:"#/properties/kind/enum",keyword:"enum",params:{allowedValues:Qde.properties.kind.enum},message:"must be equal to one of the allowed values"}],!1;var a=c===o}else var a=!0;if(a){if(t.id!==void 0){const l=o;if(typeof t.id!="string")return Yn.errors=[{instancePath:e+"/id",schemaPath:"#/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=l===o}else var a=!0;if(a){if(t.exchangeId!==void 0){const l=o;if(typeof t.exchangeId!="string")return Yn.errors=[{instancePath:e+"/exchangeId",schemaPath:"#/properties/exchangeId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=l===o}else var a=!0;if(a){if(t.externalId!==void 0){const l=o;if(typeof t.externalId!="string")return Yn.errors=[{instancePath:e+"/externalId",schemaPath:"#/properties/externalId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=l===o}else var a=!0;if(a){if(t.createdAt!==void 0){const l=o;if(typeof t.createdAt!="string")return Yn.errors=[{instancePath:e+"/createdAt",schemaPath:"#/properties/createdAt/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=l===o}else var a=!0;if(a)if(t.protocol!==void 0){const l=o;if(typeof t.protocol!="string")return Yn.errors=[{instancePath:e+"/protocol",schemaPath:"#/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=l===o}else var a=!0}}}}}}}}else return Yn.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Yn.errors=i,o===0}function wd(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(o===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let u;if(t.metadata===void 0&&(u="metadata")||t.data===void 0&&(u="data")||t.signature===void 0&&(u="signature"))return wd.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:u},message:"must have required property '"+u+"'"}],!1;{const l=o;for(const c in t)if(!(c==="metadata"||c==="data"||c==="signature"||c==="privateData"))return wd.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:c},message:"must NOT have additional properties"}],!1;if(l===o){if(t.metadata!==void 0){const c=o;Yn(t.metadata,{instancePath:e+"/metadata",parentData:t,parentDataProperty:"metadata",rootData:s})||(i=i===null?Yn.errors:i.concat(Yn.errors),o=i.length);var a=c===o}else var a=!0;if(a){if(t.data!==void 0){let c=t.data;const d=o;if(!(c&&typeof c=="object"&&!Array.isArray(c)))return wd.errors=[{instancePath:e+"/data",schemaPath:"#/properties/data/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=d===o}else var a=!0;if(a){if(t.signature!==void 0){const c=o;if(typeof t.signature!="string")return wd.errors=[{instancePath:e+"/signature",schemaPath:"#/properties/signature/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=c===o}else var a=!0;if(a)if(t.privateData!==void 0){let c=t.privateData;const d=o;if(!(c&&typeof c=="object"&&!Array.isArray(c)))return wd.errors=[{instancePath:e+"/privateData",schemaPath:"#/properties/privateData/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=d===o}else var a=!0}}}}}else return wd.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return wd.errors=i,o===0}const efe=S1;function S1(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t))for(const a in t)return S1.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:a},message:"must NOT have additional properties"}],!1;else return S1.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return S1.errors=i,o===0}const tfe=Sm;function Sm(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){let a;if(t.orderStatus===void 0&&(a="orderStatus"))return Sm.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:a},message:"must have required property '"+a+"'"}],!1;for(const u in t)if(u!=="orderStatus")return Sm.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:u},message:"must NOT have additional properties"}],!1;if(t.orderStatus!==void 0&&typeof t.orderStatus!="string")return Sm.errors=[{instancePath:e+"/orderStatus",schemaPath:"#/properties/orderStatus/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1}else return Sm.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Sm.errors=i,o===0}const rfe=Tm;function jn(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){let l;if(t.currencyCode===void 0&&(l="currencyCode")||t.amount===void 0&&(l="amount"))return jn.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:l},message:"must have required property '"+l+"'"}],!1;for(const c in t)if(!(c==="currencyCode"||c==="amount"||c==="fee"||c==="paymentInstruction"))return jn.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:c},message:"must NOT have additional properties"}],!1;{if(t.currencyCode!==void 0){const c=o;if(typeof t.currencyCode!="string")return jn.errors=[{instancePath:e+"/currencyCode",schemaPath:"#/properties/currencyCode/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=c===o}else var a=!0;if(a){if(t.amount!==void 0){let c=t.amount;const d=o;if(typeof c=="string"){if(!Os.test(c))return jn.errors=[{instancePath:e+"/amount",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return jn.errors=[{instancePath:e+"/amount",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=d===o}else var a=!0;if(a){if(t.fee!==void 0){let c=t.fee;const d=o;if(typeof c=="string"){if(!Os.test(c))return jn.errors=[{instancePath:e+"/fee",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return jn.errors=[{instancePath:e+"/fee",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=d===o}else var a=!0;if(a)if(t.paymentInstruction!==void 0){let c=t.paymentInstruction;const d=o;if(c&&typeof c=="object"&&!Array.isArray(c)){for(const f in c)if(!(f==="link"||f==="instruction"))return jn.errors=[{instancePath:e+"/paymentInstruction",schemaPath:"#/definitions/PaymentInstruction/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:f},message:"must NOT have additional properties"}],!1;{if(c.link!==void 0){const f=o;if(typeof c.link!="string")return jn.errors=[{instancePath:e+"/paymentInstruction/link",schemaPath:"#/definitions/PaymentInstruction/properties/link/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=f===o}else var u=!0;if(u)if(c.instruction!==void 0){const f=o;if(typeof c.instruction!="string")return jn.errors=[{instancePath:e+"/paymentInstruction/instruction",schemaPath:"#/definitions/PaymentInstruction/properties/instruction/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=f===o}else var u=!0}}else return jn.errors=[{instancePath:e+"/paymentInstruction",schemaPath:"#/definitions/PaymentInstruction/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=d===o}else var a=!0}}}}else return jn.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return jn.errors=i,o===0}function Tm(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(o===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let u;if(t.expiresAt===void 0&&(u="expiresAt")||t.payin===void 0&&(u="payin")||t.payout===void 0&&(u="payout"))return Tm.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:u},message:"must have required property '"+u+"'"}],!1;{const l=o;for(const c in t)if(!(c==="expiresAt"||c==="payin"||c==="payout"))return Tm.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:c},message:"must NOT have additional properties"}],!1;if(l===o){if(t.expiresAt!==void 0){const c=o;if(typeof t.expiresAt!="string")return Tm.errors=[{instancePath:e+"/expiresAt",schemaPath:"#/properties/expiresAt/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=c===o}else var a=!0;if(a){if(t.payin!==void 0){const c=o;jn(t.payin,{instancePath:e+"/payin",parentData:t,parentDataProperty:"payin",rootData:s})||(i=i===null?jn.errors:i.concat(jn.errors),o=i.length);var a=c===o}else var a=!0;if(a)if(t.payout!==void 0){const c=o;jn(t.payout,{instancePath:e+"/payout",parentData:t,parentDataProperty:"payout",rootData:s})||(i=i===null?jn.errors:i.concat(jn.errors),o=i.length);var a=c===o}else var a=!0}}}}else return Tm.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Tm.errors=i,o===0}const nfe=Ei,ife={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://tbdex.dev/resource.schema.json",type:"object",additionalProperties:!1,properties:{metadata:{type:"object",properties:{from:{$ref:"definitions.json#/definitions/did",description:"The PFI's DID"},kind:{type:"string",enum:["offering","balance"],description:"The resource kind (e.g. Offering)"},id:{type:"string",description:"The resource id"},createdAt:{type:"string",description:"When the resource was created at. Expressed as ISO8601"},updatedAt:{type:"string",description:"When the resource was last updated. Expressed as ISO8601"},protocol:{type:"string",description:"Version of the protocol in use (x.x format)"}},required:["from","kind","id","createdAt","protocol"],description:"The metadata object contains fields about the resource and is present for every tbdex resources of all types."},data:{description:"The actual resource content",type:"object"},signature:{type:"string",description:"Signature that verifies that authenticity and integrity of a message"}},required:["metadata","data","signature"],description:"ResourceModel"};function Ei(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){let l;if(t.metadata===void 0&&(l="metadata")||t.data===void 0&&(l="data")||t.signature===void 0&&(l="signature"))return Ei.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:l},message:"must have required property '"+l+"'"}],!1;for(const c in t)if(!(c==="metadata"||c==="data"||c==="signature"))return Ei.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:c},message:"must NOT have additional properties"}],!1;{if(t.metadata!==void 0){let c=t.metadata;const d=o;if(c&&typeof c=="object"&&!Array.isArray(c)){let h;if(c.from===void 0&&(h="from")||c.kind===void 0&&(h="kind")||c.id===void 0&&(h="id")||c.createdAt===void 0&&(h="createdAt")||c.protocol===void 0&&(h="protocol"))return Ei.errors=[{instancePath:e+"/metadata",schemaPath:"#/properties/metadata/required",keyword:"required",params:{missingProperty:h},message:"must have required property '"+h+"'"}],!1;if(c.from!==void 0){let f=c.from;const p=o;if(typeof f=="string"){if(!tP.test(f))return Ei.errors=[{instancePath:e+"/metadata/from",schemaPath:"definitions.json#/definitions/did/pattern",keyword:"pattern",params:{pattern:"^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"},message:'must match pattern "^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"'}],!1}else return Ei.errors=[{instancePath:e+"/metadata/from",schemaPath:"definitions.json#/definitions/did/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=p===o}else var a=!0;if(a){if(c.kind!==void 0){let f=c.kind;const p=o;if(typeof f!="string")return Ei.errors=[{instancePath:e+"/metadata/kind",schemaPath:"#/properties/metadata/properties/kind/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(f==="offering"||f==="balance"))return Ei.errors=[{instancePath:e+"/metadata/kind",schemaPath:"#/properties/metadata/properties/kind/enum",keyword:"enum",params:{allowedValues:ife.properties.metadata.properties.kind.enum},message:"must be equal to one of the allowed values"}],!1;var a=p===o}else var a=!0;if(a){if(c.id!==void 0){const f=o;if(typeof c.id!="string")return Ei.errors=[{instancePath:e+"/metadata/id",schemaPath:"#/properties/metadata/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=f===o}else var a=!0;if(a){if(c.createdAt!==void 0){const f=o;if(typeof c.createdAt!="string")return Ei.errors=[{instancePath:e+"/metadata/createdAt",schemaPath:"#/properties/metadata/properties/createdAt/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=f===o}else var a=!0;if(a){if(c.updatedAt!==void 0){const f=o;if(typeof c.updatedAt!="string")return Ei.errors=[{instancePath:e+"/metadata/updatedAt",schemaPath:"#/properties/metadata/properties/updatedAt/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=f===o}else var a=!0;if(a)if(c.protocol!==void 0){const f=o;if(typeof c.protocol!="string")return Ei.errors=[{instancePath:e+"/metadata/protocol",schemaPath:"#/properties/metadata/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=f===o}else var a=!0}}}}}else return Ei.errors=[{instancePath:e+"/metadata",schemaPath:"#/properties/metadata/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var u=d===o}else var u=!0;if(u){if(t.data!==void 0){let c=t.data;const d=o;if(!(c&&typeof c=="object"&&!Array.isArray(c)))return Ei.errors=[{instancePath:e+"/data",schemaPath:"#/properties/data/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var u=d===o}else var u=!0;if(u)if(t.signature!==void 0){const c=o;if(typeof t.signature!="string")return Ei.errors=[{instancePath:e+"/signature",schemaPath:"#/properties/signature/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=c===o}else var u=!0}}}else return Ei.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Ei.errors=i,o===0}const sfe=Ts;function Ts(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){let l;if(t.salt===void 0&&(l="salt"))return Ts.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:l},message:"must have required property '"+l+"'"}],!1;if(t.additionalProperties!==void 0){var a=!1;return Ts.errors=[{instancePath:e+"/additionalProperties",schemaPath:"#/properties/additionalProperties/false schema",keyword:"false schema",params:{},message:"boolean schema is false"}],!1}else var a=!0;if(a){if(t.salt!==void 0){const c=o;if(typeof t.salt!="string")return Ts.errors=[{instancePath:e+"/salt",schemaPath:"#/properties/salt/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=c===o}else var a=!0;if(a){if(t.claims!==void 0){let c=t.claims;const d=o;if(Array.isArray(c)){var u=!0;const f=c.length;for(let p=0;p<f;p++){const m=o;if(typeof c[p]!="string")return Ts.errors=[{instancePath:e+"/claims/"+p,schemaPath:"#/properties/claims/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=m===o;if(!u)break}}else return Ts.errors=[{instancePath:e+"/claims",schemaPath:"#/properties/claims/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var a=d===o}else var a=!0;if(a){if(t.payin!==void 0){let c=t.payin;const d=o;if(c&&typeof c=="object"&&!Array.isArray(c)){for(const f in c)if(f!=="paymentDetails")return Ts.errors=[{instancePath:e+"/payin",schemaPath:"#/properties/payin/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:f},message:"must NOT have additional properties"}],!1;if(c.paymentDetails!==void 0){let f=c.paymentDetails;if(!(f&&typeof f=="object"&&!Array.isArray(f)))return Ts.errors=[{instancePath:e+"/payin/paymentDetails",schemaPath:"#/properties/payin/properties/paymentDetails/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1}}else return Ts.errors=[{instancePath:e+"/payin",schemaPath:"#/properties/payin/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=d===o}else var a=!0;if(a)if(t.payout!==void 0){let c=t.payout;const d=o;if(c&&typeof c=="object"&&!Array.isArray(c)){for(const f in c)if(f!=="paymentDetails")return Ts.errors=[{instancePath:e+"/payout",schemaPath:"#/properties/payout/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:f},message:"must NOT have additional properties"}],!1;if(c.paymentDetails!==void 0){let f=c.paymentDetails;if(!(f&&typeof f=="object"&&!Array.isArray(f)))return Ts.errors=[{instancePath:e+"/payout/paymentDetails",schemaPath:"#/properties/payout/properties/paymentDetails/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1}}else return Ts.errors=[{instancePath:e+"/payout",schemaPath:"#/properties/payout/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=d===o}else var a=!0}}}}else return Ts.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Ts.errors=i,o===0}const ofe=Ai;function Ai(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){let c;if(t.offeringId===void 0&&(c="offeringId")||t.payin===void 0&&(c="payin")||t.payout===void 0&&(c="payout"))return Ai.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:c},message:"must have required property '"+c+"'"}],!1;if(t.additionalProperties!==void 0){var a=!1;return Ai.errors=[{instancePath:e+"/additionalProperties",schemaPath:"#/properties/additionalProperties/false schema",keyword:"false schema",params:{},message:"boolean schema is false"}],!1}else var a=!0;if(a){if(t.offeringId!==void 0){const d=o;if(typeof t.offeringId!="string")return Ai.errors=[{instancePath:e+"/offeringId",schemaPath:"#/properties/offeringId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=d===o}else var a=!0;if(a){if(t.claimsHash!==void 0){const d=o;if(typeof t.claimsHash!="string")return Ai.errors=[{instancePath:e+"/claimsHash",schemaPath:"#/properties/claimsHash/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=d===o}else var a=!0;if(a){if(t.payin!==void 0){let d=t.payin;const h=o;if(d&&typeof d=="object"&&!Array.isArray(d)){let p;if(d.amount===void 0&&(p="amount")||d.kind===void 0&&(p="kind"))return Ai.errors=[{instancePath:e+"/payin",schemaPath:"#/properties/payin/required",keyword:"required",params:{missingProperty:p},message:"must have required property '"+p+"'"}],!1;if(d.amount!==void 0){let m=d.amount;const E=o;if(typeof m=="string"){if(!Os.test(m))return Ai.errors=[{instancePath:e+"/payin/amount",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return Ai.errors=[{instancePath:e+"/payin/amount",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=E===o}else var u=!0;if(u){if(d.kind!==void 0){const m=o;if(typeof d.kind!="string")return Ai.errors=[{instancePath:e+"/payin/kind",schemaPath:"#/properties/payin/properties/kind/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=m===o}else var u=!0;if(u)if(d.paymentDetailsHash!==void 0){const m=o;if(typeof d.paymentDetailsHash!="string")return Ai.errors=[{instancePath:e+"/payin/paymentDetailsHash",schemaPath:"#/properties/payin/properties/paymentDetailsHash/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=m===o}else var u=!0}}else return Ai.errors=[{instancePath:e+"/payin",schemaPath:"#/properties/payin/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=h===o}else var a=!0;if(a)if(t.payout!==void 0){let d=t.payout;const h=o;if(d&&typeof d=="object"&&!Array.isArray(d)){let p;if(d.kind===void 0&&(p="kind"))return Ai.errors=[{instancePath:e+"/payout",schemaPath:"#/properties/payout/required",keyword:"required",params:{missingProperty:p},message:"must have required property '"+p+"'"}],!1;if(d.kind!==void 0){const m=o;if(typeof d.kind!="string")return Ai.errors=[{instancePath:e+"/payout/kind",schemaPath:"#/properties/payout/properties/kind/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var l=m===o}else var l=!0;if(l)if(d.paymentDetailsHash!==void 0){const m=o;if(typeof d.paymentDetailsHash!="string")return Ai.errors=[{instancePath:e+"/payout/paymentDetailsHash",schemaPath:"#/properties/payout/properties/paymentDetailsHash/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var l=m===o}else var l=!0}else return Ai.errors=[{instancePath:e+"/payout",schemaPath:"#/properties/payout/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=h===o}else var a=!0}}}}else return Ai.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Ai.errors=i,o===0}const afe=Object.freeze(Object.defineProperty({__proto__:null,balance:Yde,close:Hde,definitions:zde,message:Zde,offering:Wde,order:efe,orderstatus:tfe,quote:rfe,resource:nfe,rfq:ofe,rfqPrivate:sfe},Symbol.toStringTag,{value:"Module"}));function zv(t,e){let r=afe[e];if(!r)throw new Error(`no validator found for ${e}`);r(t),r.errors&&ufe(r.errors)}function ufe(t){const[e]=t;let{instancePath:r,message:n,params:s}=e;throw r||(r="message"),n=s.allowedValues?`${n} - ${s.allowedValues.join(", ")}`:n,new Error(`${r}: ${n}`)}class kE{constructor(e,r,n){Se(this,"metadata");Se(this,"data");Se(this,"_signature");this.metadata=e,this.data=r,this._signature=n}static generateId(e){return GC(e).toString()}async sign(e){this._signature=await np.sign({did:e,payload:this.digest(),detached:!0})}async verify(){return this.validate(),this.verifySignature()}async verifySignature(){if(this.signature===void 0)throw new Error("Could not verify message signature because no signature is missing");const e=await np.verify({detachedPayload:this.digest(),signature:this.signature});if(this.metadata.from!==e)throw new Error("Signature verification failed: Expected DID in kid of JWS header to match metadata.from");return e}digest(){return np.digest({metadata:this.metadata,data:this.data})}validate(){zv(this.toJSON(),"resource"),this.validateData()}validateData(){zv(this.data,this.kind)}toJSON(){return{metadata:this.metadata,data:this.data,signature:this.signature}}get signature(){return this._signature}get id(){return this.metadata.id}get from(){return this.metadata.from}get createdAt(){return this.metadata.createdAt}get updatedAt(){return this.metadata.updatedAt}get protocol(){return this.metadata.protocol}isOffering(){return this.metadata.kind==="offering"}isBalance(){return this.metadata.kind==="balance"}}class Ju{constructor(e,r,n){Se(this,"metadata");Se(this,"data");Se(this,"_signature");this.metadata=e,this.data=r,this._signature=n}static generateId(e){return GC(e).toString()}async sign(e){this._signature=await np.sign({did:e,payload:this.digest(),detached:!0})}async verify(){return this.validate(),await this.verifySignature()}async verifySignature(){if(this.signature===void 0)throw new Error("Could not verify message signature because no signature is missing");const e=await np.verify({detachedPayload:this.digest(),signature:this.signature});if(this.metadata.from!==e)throw new Error("Signature verification failed: Expected DID in kid of JWS header to match metadata.from");return e}digest(){return np.digest({metadata:this.metadata,data:this.data})}validate(){zv(this.toJSON(),"message"),this.validateData()}validateData(){zv(this.data,this.kind)}get signature(){return this._signature}get id(){return this.metadata.id}get exchangeId(){return this.metadata.exchangeId}get from(){return this.metadata.from}get to(){return this.metadata.to}get createdAt(){return this.metadata.createdAt}get externalId(){return this.metadata.externalId}get protocol(){return this.metadata.protocol}isRfq(){return this.metadata.kind==="rfq"}isQuote(){return this.metadata.kind==="quote"}isOrder(){return this.metadata.kind==="order"}isOrderStatus(){return this.metadata.kind==="orderstatus"}isClose(){return this.metadata.kind==="close"}toJSON(){return{metadata:this.metadata,data:this.data,signature:this.signature}}}var cfe=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,AT=Math.ceil,Bo=Math.floor,Cs="[BigNumber Error] ",oF=Cs+"Number primitive has more than 15 significant digits: ",ga=1e14,Ut=14,ST=9007199254740991,TT=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],Xl=1e7,Jn=1e9;function XL(t){var e,r,n,s=_.prototype={constructor:_,toString:null,valueOf:null},i=new _(1),o=20,a=4,u=-7,l=21,c=-1e7,d=1e7,h=!1,f=1,p=0,m={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},E="0123456789abcdefghijklmnopqrstuvwxyz",A=!0;function _(w,b){var T,P,C,k,K,L,q,se,X=this;if(!(X instanceof _))return new _(w,b);if(b==null){if(w&&w._isBigNumber===!0){X.s=w.s,!w.c||w.e>d?X.c=X.e=null:w.e<c?X.c=[X.e=0]:(X.e=w.e,X.c=w.c.slice());return}if((L=typeof w=="number")&&w*0==0){if(X.s=1/w<0?(w=-w,-1):1,w===~~w){for(k=0,K=w;K>=10;K/=10,k++);k>d?X.c=X.e=null:(X.e=k,X.c=[w]);return}se=String(w)}else{if(!cfe.test(se=String(w)))return n(X,se,L);X.s=se.charCodeAt(0)==45?(se=se.slice(1),-1):1}(k=se.indexOf("."))>-1&&(se=se.replace(".","")),(K=se.search(/e/i))>0?(k<0&&(k=K),k+=+se.slice(K+1),se=se.substring(0,K)):k<0&&(k=se.length)}else{if(ln(b,2,E.length,"Base"),b==10&&A)return X=new _(w),x(X,o+X.e+1,a);if(se=String(w),L=typeof w=="number"){if(w*0!=0)return n(X,se,L,b);if(X.s=1/w<0?(se=se.slice(1),-1):1,_.DEBUG&&se.replace(/^0\.0*|\./,"").length>15)throw Error(oF+w)}else X.s=se.charCodeAt(0)===45?(se=se.slice(1),-1):1;for(T=E.slice(0,b),k=K=0,q=se.length;K<q;K++)if(T.indexOf(P=se.charAt(K))<0){if(P=="."){if(K>k){k=q;continue}}else if(!C&&(se==se.toUpperCase()&&(se=se.toLowerCase())||se==se.toLowerCase()&&(se=se.toUpperCase()))){C=!0,K=-1,k=0;continue}return n(X,String(w),L,b)}L=!1,se=r(se,b,10,X.s),(k=se.indexOf("."))>-1?se=se.replace(".",""):k=se.length}for(K=0;se.charCodeAt(K)===48;K++);for(q=se.length;se.charCodeAt(--q)===48;);if(se=se.slice(K,++q)){if(q-=K,L&&_.DEBUG&&q>15&&(w>ST||w!==Bo(w)))throw Error(oF+X.s*w);if((k=k-K-1)>d)X.c=X.e=null;else if(k<c)X.c=[X.e=0];else{if(X.e=k,X.c=[],K=(k+1)%Ut,k<0&&(K+=Ut),K<q){for(K&&X.c.push(+se.slice(0,K)),q-=Ut;K<q;)X.c.push(+se.slice(K,K+=Ut));K=Ut-(se=se.slice(K)).length}else K-=q;for(;K--;se+="0");X.c.push(+se)}}else X.c=[X.e=0]}_.clone=XL,_.ROUND_UP=0,_.ROUND_DOWN=1,_.ROUND_CEIL=2,_.ROUND_FLOOR=3,_.ROUND_HALF_UP=4,_.ROUND_HALF_DOWN=5,_.ROUND_HALF_EVEN=6,_.ROUND_HALF_CEIL=7,_.ROUND_HALF_FLOOR=8,_.EUCLID=9,_.config=_.set=function(w){var b,T;if(w!=null)if(typeof w=="object"){if(w.hasOwnProperty(b="DECIMAL_PLACES")&&(T=w[b],ln(T,0,Jn,b),o=T),w.hasOwnProperty(b="ROUNDING_MODE")&&(T=w[b],ln(T,0,8,b),a=T),w.hasOwnProperty(b="EXPONENTIAL_AT")&&(T=w[b],T&&T.pop?(ln(T[0],-Jn,0,b),ln(T[1],0,Jn,b),u=T[0],l=T[1]):(ln(T,-Jn,Jn,b),u=-(l=T<0?-T:T))),w.hasOwnProperty(b="RANGE"))if(T=w[b],T&&T.pop)ln(T[0],-Jn,-1,b),ln(T[1],1,Jn,b),c=T[0],d=T[1];else if(ln(T,-Jn,Jn,b),T)c=-(d=T<0?-T:T);else throw Error(Cs+b+" cannot be zero: "+T);if(w.hasOwnProperty(b="CRYPTO"))if(T=w[b],T===!!T)if(T)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))h=T;else throw h=!T,Error(Cs+"crypto unavailable");else h=T;else throw Error(Cs+b+" not true or false: "+T);if(w.hasOwnProperty(b="MODULO_MODE")&&(T=w[b],ln(T,0,9,b),f=T),w.hasOwnProperty(b="POW_PRECISION")&&(T=w[b],ln(T,0,Jn,b),p=T),w.hasOwnProperty(b="FORMAT"))if(T=w[b],typeof T=="object")m=T;else throw Error(Cs+b+" not an object: "+T);if(w.hasOwnProperty(b="ALPHABET"))if(T=w[b],typeof T=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(T))A=T.slice(0,10)=="0123456789",E=T;else throw Error(Cs+b+" invalid: "+T)}else throw Error(Cs+"Object expected: "+w);return{DECIMAL_PLACES:o,ROUNDING_MODE:a,EXPONENTIAL_AT:[u,l],RANGE:[c,d],CRYPTO:h,MODULO_MODE:f,POW_PRECISION:p,FORMAT:m,ALPHABET:E}},_.isBigNumber=function(w){if(!w||w._isBigNumber!==!0)return!1;if(!_.DEBUG)return!0;var b,T,P=w.c,C=w.e,k=w.s;e:if({}.toString.call(P)=="[object Array]"){if((k===1||k===-1)&&C>=-Jn&&C<=Jn&&C===Bo(C)){if(P[0]===0){if(C===0&&P.length===1)return!0;break e}if(b=(C+1)%Ut,b<1&&(b+=Ut),String(P[0]).length==b){for(b=0;b<P.length;b++)if(T=P[b],T<0||T>=ga||T!==Bo(T))break e;if(T!==0)return!0}}}else if(P===null&&C===null&&(k===null||k===1||k===-1))return!0;throw Error(Cs+"Invalid BigNumber: "+w)},_.maximum=_.max=function(){return v(arguments,-1)},_.minimum=_.min=function(){return v(arguments,1)},_.random=function(){var w=9007199254740992,b=Math.random()*w&2097151?function(){return Bo(Math.random()*w)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(T){var P,C,k,K,L,q=0,se=[],X=new _(i);if(T==null?T=o:ln(T,0,Jn),K=AT(T/Ut),h)if(crypto.getRandomValues){for(P=crypto.getRandomValues(new Uint32Array(K*=2));q<K;)L=P[q]*131072+(P[q+1]>>>11),L>=9e15?(C=crypto.getRandomValues(new Uint32Array(2)),P[q]=C[0],P[q+1]=C[1]):(se.push(L%1e14),q+=2);q=K/2}else if(crypto.randomBytes){for(P=crypto.randomBytes(K*=7);q<K;)L=(P[q]&31)*281474976710656+P[q+1]*1099511627776+P[q+2]*4294967296+P[q+3]*16777216+(P[q+4]<<16)+(P[q+5]<<8)+P[q+6],L>=9e15?crypto.randomBytes(7).copy(P,q):(se.push(L%1e14),q+=7);q=K/7}else throw h=!1,Error(Cs+"crypto unavailable");if(!h)for(;q<K;)L=b(),L<9e15&&(se[q++]=L%1e14);for(K=se[--q],T%=Ut,K&&T&&(L=TT[Ut-T],se[q]=Bo(K/L)*L);se[q]===0;se.pop(),q--);if(q<0)se=[k=0];else{for(k=-1;se[0]===0;se.splice(0,1),k-=Ut);for(q=1,L=se[0];L>=10;L/=10,q++);q<Ut&&(k-=Ut-q)}return X.e=k,X.c=se,X}}(),_.sum=function(){for(var w=1,b=arguments,T=new _(b[0]);w<b.length;)T=T.plus(b[w++]);return T},r=function(){var w="0123456789";function b(T,P,C,k){for(var K,L=[0],q,se=0,X=T.length;se<X;){for(q=L.length;q--;L[q]*=P);for(L[0]+=k.indexOf(T.charAt(se++)),K=0;K<L.length;K++)L[K]>C-1&&(L[K+1]==null&&(L[K+1]=0),L[K+1]+=L[K]/C|0,L[K]%=C)}return L.reverse()}return function(T,P,C,k,K){var L,q,se,X,re,W,B,te,z=T.indexOf("."),$=o,F=a;for(z>=0&&(X=p,p=0,T=T.replace(".",""),te=new _(P),W=te.pow(T.length-z),p=X,te.c=b(Sc($o(W.c),W.e,"0"),10,C,w),te.e=te.c.length),B=b(T,P,C,K?(L=E,w):(L=w,E)),se=X=B.length;B[--X]==0;B.pop());if(!B[0])return L.charAt(0);if(z<0?--se:(W.c=B,W.e=se,W.s=k,W=e(W,te,$,F,C),B=W.c,re=W.r,se=W.e),q=se+$+1,z=B[q],X=C/2,re=re||q<0||B[q+1]!=null,re=F<4?(z!=null||re)&&(F==0||F==(W.s<0?3:2)):z>X||z==X&&(F==4||re||F==6&&B[q-1]&1||F==(W.s<0?8:7)),q<1||!B[0])T=re?Sc(L.charAt(1),-$,L.charAt(0)):L.charAt(0);else{if(B.length=q,re)for(--C;++B[--q]>C;)B[q]=0,q||(++se,B=[1].concat(B));for(X=B.length;!B[--X];);for(z=0,T="";z<=X;T+=L.charAt(B[z++]));T=Sc(T,se,L.charAt(0))}return T}}(),e=function(){function w(P,C,k){var K,L,q,se,X=0,re=P.length,W=C%Xl,B=C/Xl|0;for(P=P.slice();re--;)q=P[re]%Xl,se=P[re]/Xl|0,K=B*q+se*W,L=W*q+K%Xl*Xl+X,X=(L/k|0)+(K/Xl|0)+B*se,P[re]=L%k;return X&&(P=[X].concat(P)),P}function b(P,C,k,K){var L,q;if(k!=K)q=k>K?1:-1;else for(L=q=0;L<k;L++)if(P[L]!=C[L]){q=P[L]>C[L]?1:-1;break}return q}function T(P,C,k,K){for(var L=0;k--;)P[k]-=L,L=P[k]<C[k]?1:0,P[k]=L*K+P[k]-C[k];for(;!P[0]&&P.length>1;P.splice(0,1));}return function(P,C,k,K,L){var q,se,X,re,W,B,te,z,$,F,ee,ne,le,me,ve,Pe,Ue,M=P.s==C.s?1:-1,V=P.c,oe=C.c;if(!V||!V[0]||!oe||!oe[0])return new _(!P.s||!C.s||(V?oe&&V[0]==oe[0]:!oe)?NaN:V&&V[0]==0||!oe?M*0:M/0);for(z=new _(M),$=z.c=[],se=P.e-C.e,M=k+se+1,L||(L=ga,se=Fo(P.e/Ut)-Fo(C.e/Ut),M=M/Ut|0),X=0;oe[X]==(V[X]||0);X++);if(oe[X]>(V[X]||0)&&se--,M<0)$.push(1),re=!0;else{for(me=V.length,Pe=oe.length,X=0,M+=2,W=Bo(L/(oe[0]+1)),W>1&&(oe=w(oe,W,L),V=w(V,W,L),Pe=oe.length,me=V.length),le=Pe,F=V.slice(0,Pe),ee=F.length;ee<Pe;F[ee++]=0);Ue=oe.slice(),Ue=[0].concat(Ue),ve=oe[0],oe[1]>=L/2&&ve++;do{if(W=0,q=b(oe,F,Pe,ee),q<0){if(ne=F[0],Pe!=ee&&(ne=ne*L+(F[1]||0)),W=Bo(ne/ve),W>1)for(W>=L&&(W=L-1),B=w(oe,W,L),te=B.length,ee=F.length;b(B,F,te,ee)==1;)W--,T(B,Pe<te?Ue:oe,te,L),te=B.length,q=1;else W==0&&(q=W=1),B=oe.slice(),te=B.length;if(te<ee&&(B=[0].concat(B)),T(F,B,ee,L),ee=F.length,q==-1)for(;b(oe,F,Pe,ee)<1;)W++,T(F,Pe<ee?Ue:oe,ee,L),ee=F.length}else q===0&&(W++,F=[0]);$[X++]=W,F[0]?F[ee++]=V[le]||0:(F=[V[le]],ee=1)}while((le++<me||F[0]!=null)&&M--);re=F[0]!=null,$[0]||$.splice(0,1)}if(L==ga){for(X=1,M=$[0];M>=10;M/=10,X++);x(z,k+(z.e=X+se*Ut-1)+1,K,re)}else z.e=se,z.r=+re;return z}}();function g(w,b,T,P){var C,k,K,L,q;if(T==null?T=a:ln(T,0,8),!w.c)return w.toString();if(C=w.c[0],K=w.e,b==null)q=$o(w.c),q=P==1||P==2&&(K<=u||K>=l)?mb(q,K):Sc(q,K,"0");else if(w=x(new _(w),b,T),k=w.e,q=$o(w.c),L=q.length,P==1||P==2&&(b<=k||k<=u)){for(;L<b;q+="0",L++);q=mb(q,k)}else if(b-=K,q=Sc(q,k,"0"),k+1>L){if(--b>0)for(q+=".";b--;q+="0");}else if(b+=k-L,b>0)for(k+1==L&&(q+=".");b--;q+="0");return w.s<0&&C?"-"+q:q}function v(w,b){for(var T,P,C=1,k=new _(w[0]);C<w.length;C++)P=new _(w[C]),(!P.s||(T=nh(k,P))===b||T===0&&k.s===b)&&(k=P);return k}function S(w,b,T){for(var P=1,C=b.length;!b[--C];b.pop());for(C=b[0];C>=10;C/=10,P++);return(T=P+T*Ut-1)>d?w.c=w.e=null:T<c?w.c=[w.e=0]:(w.e=T,w.c=b),w}n=function(){var w=/^(-?)0([xbo])(?=\w[\w.]*$)/i,b=/^([^.]+)\.$/,T=/^\.([^.]+)$/,P=/^-?(Infinity|NaN)$/,C=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(k,K,L,q){var se,X=L?K:K.replace(C,"");if(P.test(X))k.s=isNaN(X)?null:X<0?-1:1;else{if(!L&&(X=X.replace(w,function(re,W,B){return se=(B=B.toLowerCase())=="x"?16:B=="b"?2:8,!q||q==se?W:re}),q&&(se=q,X=X.replace(b,"$1").replace(T,"0.$1")),K!=X))return new _(X,se);if(_.DEBUG)throw Error(Cs+"Not a"+(q?" base "+q:"")+" number: "+K);k.s=null}k.c=k.e=null}}();function x(w,b,T,P){var C,k,K,L,q,se,X,re=w.c,W=TT;if(re){e:{for(C=1,L=re[0];L>=10;L/=10,C++);if(k=b-C,k<0)k+=Ut,K=b,q=re[se=0],X=Bo(q/W[C-K-1]%10);else if(se=AT((k+1)/Ut),se>=re.length)if(P){for(;re.length<=se;re.push(0));q=X=0,C=1,k%=Ut,K=k-Ut+1}else break e;else{for(q=L=re[se],C=1;L>=10;L/=10,C++);k%=Ut,K=k-Ut+C,X=K<0?0:Bo(q/W[C-K-1]%10)}if(P=P||b<0||re[se+1]!=null||(K<0?q:q%W[C-K-1]),P=T<4?(X||P)&&(T==0||T==(w.s<0?3:2)):X>5||X==5&&(T==4||P||T==6&&(k>0?K>0?q/W[C-K]:0:re[se-1])%10&1||T==(w.s<0?8:7)),b<1||!re[0])return re.length=0,P?(b-=w.e+1,re[0]=W[(Ut-b%Ut)%Ut],w.e=-b||0):re[0]=w.e=0,w;if(k==0?(re.length=se,L=1,se--):(re.length=se+1,L=W[Ut-k],re[se]=K>0?Bo(q/W[C-K]%W[K])*L:0),P)for(;;)if(se==0){for(k=1,K=re[0];K>=10;K/=10,k++);for(K=re[0]+=L,L=1;K>=10;K/=10,L++);k!=L&&(w.e++,re[0]==ga&&(re[0]=1));break}else{if(re[se]+=L,re[se]!=ga)break;re[se--]=0,L=1}for(k=re.length;re[--k]===0;re.pop());}w.e>d?w.c=w.e=null:w.e<c&&(w.c=[w.e=0])}return w}function D(w){var b,T=w.e;return T===null?w.toString():(b=$o(w.c),b=T<=u||T>=l?mb(b,T):Sc(b,T,"0"),w.s<0?"-"+b:b)}return s.absoluteValue=s.abs=function(){var w=new _(this);return w.s<0&&(w.s=1),w},s.comparedTo=function(w,b){return nh(this,new _(w,b))},s.decimalPlaces=s.dp=function(w,b){var T,P,C,k=this;if(w!=null)return ln(w,0,Jn),b==null?b=a:ln(b,0,8),x(new _(k),w+k.e+1,b);if(!(T=k.c))return null;if(P=((C=T.length-1)-Fo(this.e/Ut))*Ut,C=T[C])for(;C%10==0;C/=10,P--);return P<0&&(P=0),P},s.dividedBy=s.div=function(w,b){return e(this,new _(w,b),o,a)},s.dividedToIntegerBy=s.idiv=function(w,b){return e(this,new _(w,b),0,1)},s.exponentiatedBy=s.pow=function(w,b){var T,P,C,k,K,L,q,se,X,re=this;if(w=new _(w),w.c&&!w.isInteger())throw Error(Cs+"Exponent not an integer: "+D(w));if(b!=null&&(b=new _(b)),L=w.e>14,!re.c||!re.c[0]||re.c[0]==1&&!re.e&&re.c.length==1||!w.c||!w.c[0])return X=new _(Math.pow(+D(re),L?w.s*(2-pb(w)):+D(w))),b?X.mod(b):X;if(q=w.s<0,b){if(b.c?!b.c[0]:!b.s)return new _(NaN);P=!q&&re.isInteger()&&b.isInteger(),P&&(re=re.mod(b))}else{if(w.e>9&&(re.e>0||re.e<-1||(re.e==0?re.c[0]>1||L&&re.c[1]>=24e7:re.c[0]<8e13||L&&re.c[0]<=9999975e7)))return k=re.s<0&&pb(w)?-0:0,re.e>-1&&(k=1/k),new _(q?1/k:k);p&&(k=AT(p/Ut+2))}for(L?(T=new _(.5),q&&(w.s=1),se=pb(w)):(C=Math.abs(+D(w)),se=C%2),X=new _(i);;){if(se){if(X=X.times(re),!X.c)break;k?X.c.length>k&&(X.c.length=k):P&&(X=X.mod(b))}if(C){if(C=Bo(C/2),C===0)break;se=C%2}else if(w=w.times(T),x(w,w.e+1,1),w.e>14)se=pb(w);else{if(C=+D(w),C===0)break;se=C%2}re=re.times(re),k?re.c&&re.c.length>k&&(re.c.length=k):P&&(re=re.mod(b))}return P?X:(q&&(X=i.div(X)),b?X.mod(b):k?x(X,p,a,K):X)},s.integerValue=function(w){var b=new _(this);return w==null?w=a:ln(w,0,8),x(b,b.e+1,w)},s.isEqualTo=s.eq=function(w,b){return nh(this,new _(w,b))===0},s.isFinite=function(){return!!this.c},s.isGreaterThan=s.gt=function(w,b){return nh(this,new _(w,b))>0},s.isGreaterThanOrEqualTo=s.gte=function(w,b){return(b=nh(this,new _(w,b)))===1||b===0},s.isInteger=function(){return!!this.c&&Fo(this.e/Ut)>this.c.length-2},s.isLessThan=s.lt=function(w,b){return nh(this,new _(w,b))<0},s.isLessThanOrEqualTo=s.lte=function(w,b){return(b=nh(this,new _(w,b)))===-1||b===0},s.isNaN=function(){return!this.s},s.isNegative=function(){return this.s<0},s.isPositive=function(){return this.s>0},s.isZero=function(){return!!this.c&&this.c[0]==0},s.minus=function(w,b){var T,P,C,k,K=this,L=K.s;if(w=new _(w,b),b=w.s,!L||!b)return new _(NaN);if(L!=b)return w.s=-b,K.plus(w);var q=K.e/Ut,se=w.e/Ut,X=K.c,re=w.c;if(!q||!se){if(!X||!re)return X?(w.s=-b,w):new _(re?K:NaN);if(!X[0]||!re[0])return re[0]?(w.s=-b,w):new _(X[0]?K:a==3?-0:0)}if(q=Fo(q),se=Fo(se),X=X.slice(),L=q-se){for((k=L<0)?(L=-L,C=X):(se=q,C=re),C.reverse(),b=L;b--;C.push(0));C.reverse()}else for(P=(k=(L=X.length)<(b=re.length))?L:b,L=b=0;b<P;b++)if(X[b]!=re[b]){k=X[b]<re[b];break}if(k&&(C=X,X=re,re=C,w.s=-w.s),b=(P=re.length)-(T=X.length),b>0)for(;b--;X[T++]=0);for(b=ga-1;P>L;){if(X[--P]<re[P]){for(T=P;T&&!X[--T];X[T]=b);--X[T],X[P]+=ga}X[P]-=re[P]}for(;X[0]==0;X.splice(0,1),--se);return X[0]?S(w,X,se):(w.s=a==3?-1:1,w.c=[w.e=0],w)},s.modulo=s.mod=function(w,b){var T,P,C=this;return w=new _(w,b),!C.c||!w.s||w.c&&!w.c[0]?new _(NaN):!w.c||C.c&&!C.c[0]?new _(C):(f==9?(P=w.s,w.s=1,T=e(C,w,0,3),w.s=P,T.s*=P):T=e(C,w,0,f),w=C.minus(T.times(w)),!w.c[0]&&f==1&&(w.s=C.s),w)},s.multipliedBy=s.times=function(w,b){var T,P,C,k,K,L,q,se,X,re,W,B,te,z,$,F=this,ee=F.c,ne=(w=new _(w,b)).c;if(!ee||!ne||!ee[0]||!ne[0])return!F.s||!w.s||ee&&!ee[0]&&!ne||ne&&!ne[0]&&!ee?w.c=w.e=w.s=null:(w.s*=F.s,!ee||!ne?w.c=w.e=null:(w.c=[0],w.e=0)),w;for(P=Fo(F.e/Ut)+Fo(w.e/Ut),w.s*=F.s,q=ee.length,re=ne.length,q<re&&(te=ee,ee=ne,ne=te,C=q,q=re,re=C),C=q+re,te=[];C--;te.push(0));for(z=ga,$=Xl,C=re;--C>=0;){for(T=0,W=ne[C]%$,B=ne[C]/$|0,K=q,k=C+K;k>C;)se=ee[--K]%$,X=ee[K]/$|0,L=B*se+X*W,se=W*se+L%$*$+te[k]+T,T=(se/z|0)+(L/$|0)+B*X,te[k--]=se%z;te[k]=T}return T?++P:te.splice(0,1),S(w,te,P)},s.negated=function(){var w=new _(this);return w.s=-w.s||null,w},s.plus=function(w,b){var T,P=this,C=P.s;if(w=new _(w,b),b=w.s,!C||!b)return new _(NaN);if(C!=b)return w.s=-b,P.minus(w);var k=P.e/Ut,K=w.e/Ut,L=P.c,q=w.c;if(!k||!K){if(!L||!q)return new _(C/0);if(!L[0]||!q[0])return q[0]?w:new _(L[0]?P:C*0)}if(k=Fo(k),K=Fo(K),L=L.slice(),C=k-K){for(C>0?(K=k,T=q):(C=-C,T=L),T.reverse();C--;T.push(0));T.reverse()}for(C=L.length,b=q.length,C-b<0&&(T=q,q=L,L=T,b=C),C=0;b;)C=(L[--b]=L[b]+q[b]+C)/ga|0,L[b]=ga===L[b]?0:L[b]%ga;return C&&(L=[C].concat(L),++K),S(w,L,K)},s.precision=s.sd=function(w,b){var T,P,C,k=this;if(w!=null&&w!==!!w)return ln(w,1,Jn),b==null?b=a:ln(b,0,8),x(new _(k),w,b);if(!(T=k.c))return null;if(C=T.length-1,P=C*Ut+1,C=T[C]){for(;C%10==0;C/=10,P--);for(C=T[0];C>=10;C/=10,P++);}return w&&k.e+1>P&&(P=k.e+1),P},s.shiftedBy=function(w){return ln(w,-ST,ST),this.times("1e"+w)},s.squareRoot=s.sqrt=function(){var w,b,T,P,C,k=this,K=k.c,L=k.s,q=k.e,se=o+4,X=new _("0.5");if(L!==1||!K||!K[0])return new _(!L||L<0&&(!K||K[0])?NaN:K?k:1/0);if(L=Math.sqrt(+D(k)),L==0||L==1/0?(b=$o(K),(b.length+q)%2==0&&(b+="0"),L=Math.sqrt(+b),q=Fo((q+1)/2)-(q<0||q%2),L==1/0?b="5e"+q:(b=L.toExponential(),b=b.slice(0,b.indexOf("e")+1)+q),T=new _(b)):T=new _(L+""),T.c[0]){for(q=T.e,L=q+se,L<3&&(L=0);;)if(C=T,T=X.times(C.plus(e(k,C,se,1))),$o(C.c).slice(0,L)===(b=$o(T.c)).slice(0,L))if(T.e<q&&--L,b=b.slice(L-3,L+1),b=="9999"||!P&&b=="4999"){if(!P&&(x(C,C.e+o+2,0),C.times(C).eq(k))){T=C;break}se+=4,L+=4,P=1}else{(!+b||!+b.slice(1)&&b.charAt(0)=="5")&&(x(T,T.e+o+2,1),w=!T.times(T).eq(k));break}}return x(T,T.e+o+1,a,w)},s.toExponential=function(w,b){return w!=null&&(ln(w,0,Jn),w++),g(this,w,b,1)},s.toFixed=function(w,b){return w!=null&&(ln(w,0,Jn),w=w+this.e+1),g(this,w,b)},s.toFormat=function(w,b,T){var P,C=this;if(T==null)w!=null&&b&&typeof b=="object"?(T=b,b=null):w&&typeof w=="object"?(T=w,w=b=null):T=m;else if(typeof T!="object")throw Error(Cs+"Argument not an object: "+T);if(P=C.toFixed(w,b),C.c){var k,K=P.split("."),L=+T.groupSize,q=+T.secondaryGroupSize,se=T.groupSeparator||"",X=K[0],re=K[1],W=C.s<0,B=W?X.slice(1):X,te=B.length;if(q&&(k=L,L=q,q=k,te-=k),L>0&&te>0){for(k=te%L||L,X=B.substr(0,k);k<te;k+=L)X+=se+B.substr(k,L);q>0&&(X+=se+B.slice(k)),W&&(X="-"+X)}P=re?X+(T.decimalSeparator||"")+((q=+T.fractionGroupSize)?re.replace(new RegExp("\\d{"+q+"}\\B","g"),"$&"+(T.fractionGroupSeparator||"")):re):X}return(T.prefix||"")+P+(T.suffix||"")},s.toFraction=function(w){var b,T,P,C,k,K,L,q,se,X,re,W,B=this,te=B.c;if(w!=null&&(L=new _(w),!L.isInteger()&&(L.c||L.s!==1)||L.lt(i)))throw Error(Cs+"Argument "+(L.isInteger()?"out of range: ":"not an integer: ")+D(L));if(!te)return new _(B);for(b=new _(i),se=T=new _(i),P=q=new _(i),W=$o(te),k=b.e=W.length-B.e-1,b.c[0]=TT[(K=k%Ut)<0?Ut+K:K],w=!w||L.comparedTo(b)>0?k>0?b:se:L,K=d,d=1/0,L=new _(W),q.c[0]=0;X=e(L,b,0,1),C=T.plus(X.times(P)),C.comparedTo(w)!=1;)T=P,P=C,se=q.plus(X.times(C=se)),q=C,b=L.minus(X.times(C=b)),L=C;return C=e(w.minus(T),P,0,1),q=q.plus(C.times(se)),T=T.plus(C.times(P)),q.s=se.s=B.s,k=k*2,re=e(se,P,k,a).minus(B).abs().comparedTo(e(q,T,k,a).minus(B).abs())<1?[se,P]:[q,T],d=K,re},s.toNumber=function(){return+D(this)},s.toPrecision=function(w,b){return w!=null&&ln(w,1,Jn),g(this,w,b,2)},s.toString=function(w){var b,T=this,P=T.s,C=T.e;return C===null?P?(b="Infinity",P<0&&(b="-"+b)):b="NaN":(w==null?b=C<=u||C>=l?mb($o(T.c),C):Sc($o(T.c),C,"0"):w===10&&A?(T=x(new _(T),o+C+1,a),b=Sc($o(T.c),T.e,"0")):(ln(w,2,E.length,"Base"),b=r(Sc($o(T.c),C,"0"),10,w,P,!0)),P<0&&T.c[0]&&(b="-"+b)),b},s.valueOf=s.toJSON=function(){return D(this)},s._isBigNumber=!0,s[Symbol.toStringTag]="BigNumber",s[Symbol.for("nodejs.util.inspect.custom")]=s.valueOf,t!=null&&_.set(t),_}function Fo(t){var e=t|0;return t>0||t===e?e:e-1}function $o(t){for(var e,r,n=1,s=t.length,i=t[0]+"";n<s;){for(e=t[n++]+"",r=Ut-e.length;r--;e="0"+e);i+=e}for(s=i.length;i.charCodeAt(--s)===48;);return i.slice(0,s+1||1)}function nh(t,e){var r,n,s=t.c,i=e.c,o=t.s,a=e.s,u=t.e,l=e.e;if(!o||!a)return null;if(r=s&&!s[0],n=i&&!i[0],r||n)return r?n?0:-a:o;if(o!=a)return o;if(r=o<0,n=u==l,!s||!i)return n?0:!s^r?1:-1;if(!n)return u>l^r?1:-1;for(a=(u=s.length)<(l=i.length)?u:l,o=0;o<a;o++)if(s[o]!=i[o])return s[o]>i[o]^r?1:-1;return u==l?0:u>l^r?1:-1}function ln(t,e,r,n){if(t<e||t>r||t!==Bo(t))throw Error(Cs+(n||"Argument")+(typeof t=="number"?t<e||t>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function pb(t){var e=t.c.length-1;return Fo(t.e/Ut)==e&&t.c[e]%2!=0}function mb(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function Sc(t,e,r){var n,s;if(e<0){for(s=r+".";++e;s+=r);t=s+t}else if(n=t.length,++e>n){for(s=r,e-=n;--e;s+=r);t+=s}else e<n&&(t=t.slice(0,e)+"."+t.slice(e));return t}var yb=XL();function lfe(t){if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")}function dfe(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,u=t.charAt(0),l=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var m=0,E=0,A=0,_=p.length;A!==_&&p[A]===0;)A++,m++;for(var g=(_-A)*c+1>>>0,v=new Uint8Array(g);A!==_;){for(var S=p[A],x=0,D=g-1;(S!==0||x<E)&&D!==-1;D--,x++)S+=256*v[D]>>>0,v[D]=S%a>>>0,S=S/a>>>0;if(S!==0)throw new Error("Non-zero carry");E=x,A++}for(var w=g-E;w!==g&&v[w]===0;)w++;for(var b=u.repeat(m);w<g;++w)b+=t.charAt(v[w]);return b}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var m=0;if(p[m]!==" "){for(var E=0,A=0;p[m]===u;)E++,m++;for(var _=(p.length-m)*l+1>>>0,g=new Uint8Array(_);p[m];){var v=r[p.charCodeAt(m)];if(v===255)return;for(var S=0,x=_-1;(v!==0||S<A)&&x!==-1;x--,S++)v+=a*g[x]>>>0,g[x]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");A=S,m++}if(p[m]!==" "){for(var D=_-A;D!==_&&g[D]===0;)D++;for(var w=new Uint8Array(E+(_-D)),b=E;D!==_;)w[b++]=g[D++];return w}}}function f(p){var m=h(p);if(m)return m;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var ffe=dfe,hfe=ffe;let pfe=class{constructor(e,r,n){Se(this,"name");Se(this,"prefix");Se(this,"baseEncode");this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},mfe=class{constructor(e,r,n){Se(this,"name");Se(this,"prefix");Se(this,"baseDecode");Se(this,"prefixCodePoint");if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return YL(this,e)}},yfe=class{constructor(e){Se(this,"decoders");this.decoders=e}or(e){return YL(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n!=null)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function YL(t,e){return new yfe({...t.decoders??{[t.prefix]:t},...e.decoders??{[e.prefix]:e}})}let gfe=class{constructor(e,r,n,s){Se(this,"name");Se(this,"prefix");Se(this,"baseEncode");Se(this,"baseDecode");Se(this,"encoder");Se(this,"decoder");this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new pfe(e,r,n),this.decoder=new mfe(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};function ZL({name:t,prefix:e,encode:r,decode:n}){return new gfe(t,e,r,n)}function QL({name:t,prefix:e,alphabet:r}){const{encode:n,decode:s}=hfe(r,t);return ZL({prefix:e,name:t,encode:n,decode:i=>lfe(s(i))})}function vfe(t,e,r,n){const s={};for(let c=0;c<e.length;++c)s[e[c]]=c;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,u=0,l=0;for(let c=0;c<i;++c){const d=s[t[c]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);u=u<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&u>>a)}if(a>=r||255&u<<8-a)throw new SyntaxError("Unexpected end of data");return o}function wfe(t,e,r){const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let u=0;u<t.length;++u)for(a=a<<8|t[u],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o!==0&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i}function wo({name:t,prefix:e,bitsPerChar:r,alphabet:n}){return ZL({prefix:e,name:t,encode(s){return wfe(s,n,r)},decode(s){return vfe(s,n,r,t)}})}wo({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});wo({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});wo({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});wo({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});wo({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});wo({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});wo({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});wo({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});const aF=wo({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),gb=QL({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});QL({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});wo({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});wo({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const Tc=wo({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});wo({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function _fe(t){return t.byteOffset!==0||t.byteLength!==t.buffer.byteLength}function bfe(t){return typeof t!="object"||t===null?!1:typeof t[Symbol.asyncIterator]=="function"}function uF(t){const r=Object.prototype.toString.call(t).match(/\s([a-zA-Z0-9]+)/),[n,s]=r;return s}var qg=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},cF=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(o){return new Promise(function(a,u){o=t[i](o),s(a,u,o.done,o.value)})}}function s(i,o,a,u){Promise.resolve(u).then(function(l){i({value:l,done:a})},o)}};const vb=new TextEncoder,ih=new TextDecoder;let Yl=class Ds{constructor(e,r){this.data=e,this.format=r}static arrayBuffer(e){return new Ds(e,"ArrayBuffer")}static asyncIterable(e){if(!bfe(e))throw new TypeError("Input must be of type AsyncIterable.");return new Ds(e,"AsyncIterable")}static base32Z(e){return new Ds(e,"Base32Z")}static base58Btc(e){return new Ds(e,"Base58Btc")}static base64Url(e){return new Ds(e,"Base64Url")}static bufferSource(e){return new Ds(e,"BufferSource")}static hex(e){if(typeof e!="string")throw new TypeError("Hex input must be a string.");if(e.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new Ds(e,"Hex")}static multibase(e){return new Ds(e,"Multibase")}static object(e){return new Ds(e,"Object")}static string(e){return new Ds(e,"String")}static uint8Array(e){return new Ds(e,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return gb.baseDecode(this.data).buffer;case"Base64Url":return Tc.baseDecode(this.data).buffer;case"BufferSource":{if(uF(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return _fe(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return qg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return aF.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return gb.baseEncode(e)}case"Multibase":return this.data.substring(1);case"Uint8Array":return gb.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return Tc.baseEncode(e)}case"BufferSource":{const e=this.toUint8Array();return Tc.baseEncode(e)}case"Object":{const e=JSON.stringify(this.data),r=vb.encode(e);return Tc.baseEncode(r)}case"String":{const e=vb.encode(this.data);return Tc.baseEncode(e)}case"Uint8Array":return Tc.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){return qg(this,void 0,void 0,function*(){var e,r,n,s;switch(this.format){case"AsyncIterable":{const u=[];try{for(var i=!0,o=cF(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const c=s;u.push(c)}}catch(c){r={error:c}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return new Blob(u)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){const e=Array.from({length:256},(r,n)=>n.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{const r=this.toUint8Array();return Ds.uint8Array(r).toHex()}case"Base64Url":{const r=this.toUint8Array();return Ds.uint8Array(r).toHex()}case"Uint8Array":{let r="";for(let n=0;n<this.data.length;n++)r+=e[this.data[n]];return r}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{const e=Tc.baseDecode(this.data),r=ih.decode(e);return JSON.parse(r)}case"String":return JSON.parse(this.data);case"Uint8Array":{const e=ih.decode(this.data);return JSON.parse(e)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return qg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toStringAsync();return JSON.parse(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return ih.decode(this.data);case"Base64Url":{const e=Tc.baseDecode(this.data);return ih.decode(e)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return ih.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){return qg(this,void 0,void 0,function*(){var e,r,n,s;switch(this.format){case"AsyncIterable":{let u="";try{for(var i=!0,o=cF(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const l=s;typeof l=="string"?u+=l:u+=ih.decode(l,{stream:!0})}}catch(l){r={error:l}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return u+=ih.decode(void 0,{stream:!1}),u}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return aF.baseDecode(this.data);case"Base58Btc":return gb.baseDecode(this.data);case"Base64Url":return Tc.baseDecode(this.data);case"BufferSource":{const e=uF(this.data);if(e==="Uint8Array")return this.data;if(e==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{const e=new Uint8Array(this.data.length/2);for(let r=0;r<this.data.length;r+=2){const n=parseInt(this.data.substring(r,r+2),16);if(isNaN(n))throw new TypeError("Input is not a valid hexadecimal string.");e[r/2]=n}return e}case"Object":{const e=JSON.stringify(this.data);return vb.encode(e)}case"String":return vb.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return qg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toArrayBufferAsync();return new Uint8Array(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}};var Efe=eK,lF=128,Afe=127,Sfe=~Afe,Tfe=Math.pow(2,31);function eK(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Tfe;)e[r++]=t&255|lF,t/=128;for(;t&Sfe;)e[r++]=t&255|lF,t>>>=7;return e[r]=t|0,eK.bytes=r-n+1,e}var Dfe=rP,xfe=128,dF=127;function rP(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw rP.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&dF)<<s:(o&dF)*Math.pow(2,s),s+=7}while(o>=xfe);return rP.bytes=i-n,r}var Pfe=Math.pow(2,7),Cfe=Math.pow(2,14),Ife=Math.pow(2,21),kfe=Math.pow(2,28),$fe=Math.pow(2,35),Ofe=Math.pow(2,42),Rfe=Math.pow(2,49),Nfe=Math.pow(2,56),Bfe=Math.pow(2,63),Ffe=function(t){return t<Pfe?1:t<Cfe?2:t<Ife?3:t<kfe?4:t<$fe?5:t<Ofe?6:t<Rfe?7:t<Nfe?8:t<Bfe?9:10},Mfe={encode:Efe,decode:Dfe,encodingLength:Ffe},$E=Mfe;function fF(t,e=0){return[$E.decode(t,e),$E.decode.bytes]}function jfe(t,e,r=0){return $E.encode(t,e,r),e}function Ufe(t){return $E.encodingLength(t)}let If=class _d{static addPrefix(e){var r;let{code:n,data:s,name:i}=e;if(!(i?!n:n))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(n=_d.codeToName.has(n)?n:_d.nameToCode.get(i),n===void 0)throw new Error(`Unsupported multicodec: ${(r=e.name)!==null&&r!==void 0?r:e.code}`);const o=Ufe(n),a=new Uint8Array(o+s.byteLength);return a.set(s,o),jfe(n,a),a}static getCodeFromData(e){const{prefixedData:r}=e,[n,s]=fF(r);return n}static getCodeFromName(e){const{name:r}=e,n=_d.nameToCode.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static getNameFromCode(e){const{code:r}=e,n=_d.codeToName.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static registerCodec(e){_d.codeToName.set(e.code,e.name),_d.nameToCode.set(e.name,e.code)}static removePrefix(e){const{prefixedData:r}=e,[n,s]=fF(r),i=_d.codeToName.get(n);if(i===void 0)throw new Error(`Unsupported multicodec: ${n}`);return{code:n,data:r.slice(s),name:i}}};If.codeToName=new Map;If.nameToCode=new Map;If.registerCodec({code:237,name:"ed25519-pub"});If.registerCodec({code:4864,name:"ed25519-priv"});If.registerCodec({code:236,name:"x25519-pub"});If.registerCodec({code:4866,name:"x25519-priv"});If.registerCodec({code:231,name:"secp256k1-pub"});If.registerCodec({code:4865,name:"secp256k1-priv"});function Lfe(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,u=t.charAt(0),l=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var m=0,E=0,A=0,_=p.length;A!==_&&p[A]===0;)A++,m++;for(var g=(_-A)*c+1>>>0,v=new Uint8Array(g);A!==_;){for(var S=p[A],x=0,D=g-1;(S!==0||x<E)&&D!==-1;D--,x++)S+=256*v[D]>>>0,v[D]=S%a>>>0,S=S/a>>>0;if(S!==0)throw new Error("Non-zero carry");E=x,A++}for(var w=g-E;w!==g&&v[w]===0;)w++;for(var b=u.repeat(m);w<g;++w)b+=t.charAt(v[w]);return b}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var m=0;if(p[m]!==" "){for(var E=0,A=0;p[m]===u;)E++,m++;for(var _=(p.length-m)*l+1>>>0,g=new Uint8Array(_);p[m];){var v=r[p.charCodeAt(m)];if(v===255)return;for(var S=0,x=_-1;(v!==0||S<A)&&x!==-1;x--,S++)v+=a*g[x]>>>0,g[x]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");A=S,m++}if(p[m]!==" "){for(var D=_-A;D!==_&&g[D]===0;)D++;for(var w=new Uint8Array(E+(_-D)),b=E;D!==_;)w[b++]=g[D++];return w}}}function f(p){var m=h(p);if(m)return m;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var Kfe=Lfe,Vfe=Kfe;const qfe=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};let Hfe=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},zfe=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return tK(this,e)}},Wfe=class{constructor(e){this.decoders=e}or(e){return tK(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const tK=(t,e)=>new Wfe({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let Gfe=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new Hfe(e,r,n),this.decoder=new zfe(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const rK=({name:t,prefix:e,encode:r,decode:n})=>new Gfe(t,e,r,n),nK=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:s}=Vfe(r,e);return rK({prefix:t,name:e,encode:n,decode:i=>qfe(s(i))})},Jfe=(t,e,r,n)=>{const s={};for(let c=0;c<e.length;++c)s[e[c]]=c;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,u=0,l=0;for(let c=0;c<i;++c){const d=s[t[c]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);u=u<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&u>>a)}if(a>=r||255&u<<8-a)throw new SyntaxError("Unexpected end of data");return o},Xfe=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let u=0;u<t.length;++u)for(a=a<<8|t[u],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},_o=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>rK({prefix:e,name:t,encode(s){return Xfe(s,n,r)},decode(s){return Jfe(s,n,r,t)}});_o({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});_o({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});_o({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});_o({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});_o({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});_o({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});_o({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});_o({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});const hF=_o({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),wb=nK({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});nK({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});_o({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});_o({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const Dc=_o({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});_o({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function Yfe(t){return t.byteOffset!==0||t.byteLength!==t.buffer.byteLength}function Zfe(t){return typeof t!="object"||t===null?!1:typeof t[Symbol.asyncIterator]=="function"}function pF(t){const r=Object.prototype.toString.call(t).match(/\s([a-zA-Z0-9]+)/),[n,s]=r;return s}var Hg=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},mF=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(o){return new Promise(function(a,u){o=t[i](o),s(a,u,o.done,o.value)})}}function s(i,o,a,u){Promise.resolve(u).then(function(l){i({value:l,done:a})},o)}};const _b=new TextEncoder,sh=new TextDecoder;let gr=class xs{constructor(e,r){this.data=e,this.format=r}static arrayBuffer(e){return new xs(e,"ArrayBuffer")}static asyncIterable(e){if(!Zfe(e))throw new TypeError("Input must be of type AsyncIterable.");return new xs(e,"AsyncIterable")}static base32Z(e){return new xs(e,"Base32Z")}static base58Btc(e){return new xs(e,"Base58Btc")}static base64Url(e){return new xs(e,"Base64Url")}static bufferSource(e){return new xs(e,"BufferSource")}static hex(e){if(typeof e!="string")throw new TypeError("Hex input must be a string.");if(e.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new xs(e,"Hex")}static multibase(e){return new xs(e,"Multibase")}static object(e){return new xs(e,"Object")}static string(e){return new xs(e,"String")}static uint8Array(e){return new xs(e,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return wb.baseDecode(this.data).buffer;case"Base64Url":return Dc.baseDecode(this.data).buffer;case"BufferSource":{if(pF(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return Yfe(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return Hg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return hF.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return wb.baseEncode(e)}case"Multibase":return this.data.substring(1);case"Uint8Array":return wb.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return Dc.baseEncode(e)}case"BufferSource":{const e=this.toUint8Array();return Dc.baseEncode(e)}case"Object":{const e=JSON.stringify(this.data),r=_b.encode(e);return Dc.baseEncode(r)}case"String":{const e=_b.encode(this.data);return Dc.baseEncode(e)}case"Uint8Array":return Dc.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){var e,r,n,s;return Hg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const u=[];try{for(var i=!0,o=mF(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const c=s;u.push(c)}}catch(c){r={error:c}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return new Blob(u)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){const e=Array.from({length:256},(r,n)=>n.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{const r=this.toUint8Array();return xs.uint8Array(r).toHex()}case"Base64Url":{const r=this.toUint8Array();return xs.uint8Array(r).toHex()}case"Uint8Array":{let r="";for(let n=0;n<this.data.length;n++)r+=e[this.data[n]];return r}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{const e=Dc.baseDecode(this.data),r=sh.decode(e);return JSON.parse(r)}case"String":return JSON.parse(this.data);case"Uint8Array":{const e=sh.decode(this.data);return JSON.parse(e)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return Hg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toStringAsync();return JSON.parse(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return sh.decode(this.data);case"Base64Url":{const e=Dc.baseDecode(this.data);return sh.decode(e)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return sh.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){var e,r,n,s;return Hg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let u="";try{for(var i=!0,o=mF(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const l=s;typeof l=="string"?u+=l:u+=sh.decode(l,{stream:!0})}}catch(l){r={error:l}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return u+=sh.decode(void 0,{stream:!1}),u}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return hF.baseDecode(this.data);case"Base58Btc":return wb.baseDecode(this.data);case"Base64Url":return Dc.baseDecode(this.data);case"BufferSource":{const e=pF(this.data);if(e==="Uint8Array")return this.data;if(e==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{const e=new Uint8Array(this.data.length/2);for(let r=0;r<this.data.length;r+=2){const n=parseInt(this.data.substring(r,r+2),16);if(isNaN(n))throw new TypeError("Input is not a valid hexadecimal string.");e[r/2]=n}return e}case"Object":{const e=JSON.stringify(this.data);return _b.encode(e)}case"String":return _b.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return Hg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toArrayBufferAsync();return new Uint8Array(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}};var Qfe=iK,yF=128,ehe=127,the=~ehe,rhe=Math.pow(2,31);function iK(t,e,r){e=e||[],r=r||0;for(var n=r;t>=rhe;)e[r++]=t&255|yF,t/=128;for(;t&the;)e[r++]=t&255|yF,t>>>=7;return e[r]=t|0,iK.bytes=r-n+1,e}var nhe=nP,ihe=128,gF=127;function nP(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw nP.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&gF)<<s:(o&gF)*Math.pow(2,s),s+=7}while(o>=ihe);return nP.bytes=i-n,r}var she=Math.pow(2,7),ohe=Math.pow(2,14),ahe=Math.pow(2,21),uhe=Math.pow(2,28),che=Math.pow(2,35),lhe=Math.pow(2,42),dhe=Math.pow(2,49),fhe=Math.pow(2,56),hhe=Math.pow(2,63),phe=function(t){return t<she?1:t<ohe?2:t<ahe?3:t<uhe?4:t<che?5:t<lhe?6:t<dhe?7:t<fhe?8:t<hhe?9:10},mhe={encode:Qfe,decode:nhe,encodingLength:phe},OE=mhe;const vF=(t,e=0)=>[OE.decode(t,e),OE.decode.bytes],yhe=(t,e,r=0)=>(OE.encode(t,e,r),e),ghe=t=>OE.encodingLength(t);let kf=class bd{static addPrefix(e){var r;let{code:n,data:s,name:i}=e;if(!(i?!n:n))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(n=bd.codeToName.has(n)?n:bd.nameToCode.get(i),n===void 0)throw new Error(`Unsupported multicodec: ${(r=e.name)!==null&&r!==void 0?r:e.code}`);const o=ghe(n),a=new Uint8Array(o+s.byteLength);return a.set(s,o),yhe(n,a),a}static getCodeFromData(e){const{prefixedData:r}=e,[n,s]=vF(r);return n}static getCodeFromName(e){const{name:r}=e,n=bd.nameToCode.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static getNameFromCode(e){const{code:r}=e,n=bd.codeToName.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static registerCodec(e){bd.codeToName.set(e.code,e.name),bd.nameToCode.set(e.name,e.code)}static removePrefix(e){const{prefixedData:r}=e,[n,s]=vF(r),i=bd.codeToName.get(n);if(i===void 0)throw new Error(`Unsupported multicodec: ${n}`);return{code:n,data:r.slice(s),name:i}}};kf.codeToName=new Map;kf.nameToCode=new Map;kf.registerCodec({code:237,name:"ed25519-pub"});kf.registerCodec({code:4864,name:"ed25519-priv"});kf.registerCodec({code:236,name:"x25519-pub"});kf.registerCodec({code:4866,name:"x25519-priv"});kf.registerCodec({code:231,name:"secp256k1-pub"});kf.registerCodec({code:4865,name:"secp256k1-priv"});function sK(t){Object.keys(t).forEach(e=>{t[e]===void 0?delete t[e]:typeof t[e]=="object"&&sK(t[e])})}var oh=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let vhe=class{constructor(){this.store=new Map}clear(){return oh(this,void 0,void 0,function*(){this.store.clear()})}close(){return oh(this,void 0,void 0,function*(){})}delete(e){return oh(this,void 0,void 0,function*(){return this.store.delete(e)})}get(e){return oh(this,void 0,void 0,function*(){return this.store.get(e)})}has(e){return oh(this,void 0,void 0,function*(){return this.store.has(e)})}list(){return oh(this,void 0,void 0,function*(){return Array.from(this.store.values())})}set(e,r){return oh(this,void 0,void 0,function*(){this.store.set(e,r)})}};function whe(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function oK(t,...e){if(!whe(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function wF(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function _he(t,e){oK(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const bhe=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const DT=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),tu=(t,e)=>t<<32-e|t>>>e;new Uint8Array(new Uint32Array([287454020]).buffer)[0];function Ehe(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function aK(t){return typeof t=="string"&&(t=Ehe(t)),oK(t),t}let Ahe=class{clone(){return this._cloneInto()}};function She(t){const e=n=>t().update(aK(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function The(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),u=n?4:0,l=n?0:4;t.setUint32(e+u,o,n),t.setUint32(e+l,a,n)}const Dhe=(t,e,r)=>t&e^~t&r,xhe=(t,e,r)=>t&e^t&r^e&r;let Phe=class extends Ahe{constructor(e,r,n,s){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=DT(this.buffer)}update(e){wF(this);const{view:r,buffer:n,blockLen:s}=this;e=aK(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const u=DT(e);for(;s<=i-o;o+=s)this.process(u,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){wF(this),_he(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)r[d]=0;The(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=DT(e),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=u/4,c=this.get();if(l>c.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,c[d],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%r&&e.buffer.set(n),e}};const Che=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Zl=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ql=new Uint32Array(64);let Ihe=class extends Phe{constructor(){super(64,32,8,!1),this.A=Zl[0]|0,this.B=Zl[1]|0,this.C=Zl[2]|0,this.D=Zl[3]|0,this.E=Zl[4]|0,this.F=Zl[5]|0,this.G=Zl[6]|0,this.H=Zl[7]|0}get(){const{A:e,B:r,C:n,D:s,E:i,F:o,G:a,H:u}=this;return[e,r,n,s,i,o,a,u]}set(e,r,n,s,i,o,a,u){this.A=e|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=u|0}process(e,r){for(let d=0;d<16;d++,r+=4)Ql[d]=e.getUint32(r,!1);for(let d=16;d<64;d++){const h=Ql[d-15],f=Ql[d-2],p=tu(h,7)^tu(h,18)^h>>>3,m=tu(f,17)^tu(f,19)^f>>>10;Ql[d]=m+Ql[d-7]+p+Ql[d-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:u,G:l,H:c}=this;for(let d=0;d<64;d++){const h=tu(a,6)^tu(a,11)^tu(a,25),f=c+h+Dhe(a,u,l)+Che[d]+Ql[d]|0,m=(tu(n,2)^tu(n,13)^tu(n,22))+xhe(n,s,i)|0;c=l,l=u,u=a,a=o+f|0,o=i,i=s,s=n,n=f+m|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,u=u+this.F|0,l=l+this.G|0,c=c+this.H|0,this.set(n,s,i,o,a,u,l,c)}roundClean(){Ql.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const Wv=She(()=>new Ihe);var khe=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let uK=class{static digest(e){return khe(this,arguments,void 0,function*({data:r}){return Wv(r)})}},UI=class{};var $he=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let Ohe=class extends UI{digest(e){return $he(this,arguments,void 0,function*({algorithm:r,data:n}){switch(r){case"SHA-256":return yield uK.digest({data:n})}})}};function Rhe(t){const e=n=>{if(n!==null&&typeof n=="object"&&!Array.isArray(n)){const s=Object.keys(n).sort(),i={};for(const o of s)i[o]=e(n[o]);return i}return n},r=e(t);return JSON.stringify(r)}var Nhe=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};const _F="urn:jwk:";function Kn(t){return Nhe(this,arguments,void 0,function*({jwk:e}){const r=e.kty;let n;if(r==="EC")n={crv:e.crv,kty:e.kty,x:e.x,y:e.y};else if(r==="oct")n={k:e.k,kty:e.kty};else if(r==="OKP")n={crv:e.crv,kty:e.kty,x:e.x};else if(r==="RSA")n={e:e.e,kty:e.kty,n:e.n};else throw new Error(`Unsupported key type: ${r}`);sK(n);const s=Rhe(n),i=gr.string(s).toUint8Array(),o=yield uK.digest({data:i});return gr.uint8Array(o).toBase64Url()})}function ip(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="EC"||typeof t.d!="string"||typeof t.x!="string")}function LI(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t)||"d"in t||t.kty!=="EC"||typeof t.x!="string")}function nv(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="OKP"||typeof t.d!="string"||typeof t.x!="string")}function cK(t){return!(!t||typeof t!="object"||"d"in t||!("kty"in t&&"crv"in t&&"x"in t)||t.kty!=="OKP"||typeof t.x!="string")}function Bhe(t){if(!t||typeof t!="object")return!1;switch(t.kty){case"EC":case"OKP":case"RSA":return"d"in t;case"oct":return"k"in t;default:return!1}}var yi=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},Fhe=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let zg=class lu{static adjustSignatureToLowS(e){return yi(this,arguments,void 0,function*({signature:r}){const n=et.Signature.fromCompact(r);return n.hasHighS()?n.normalizeS().toCompactRawBytes():r})}static bytesToPrivateKey(e){return yi(this,arguments,void 0,function*({privateKeyBytes:r}){const n=yield lu.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"secp256k1",d:gr.uint8Array(r).toBase64Url(),x:gr.uint8Array(n.x).toBase64Url(),y:gr.uint8Array(n.y).toBase64Url()};return s.kid=yield Kn({jwk:s}),s})}static bytesToPublicKey(e){return yi(this,arguments,void 0,function*({publicKeyBytes:r}){const n=yield lu.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"secp256k1",x:gr.uint8Array(n.x).toBase64Url(),y:gr.uint8Array(n.y).toBase64Url()};return s.kid=yield Kn({jwk:s}),s})}static compressPublicKey(e){return yi(this,arguments,void 0,function*({publicKeyBytes:r}){return et.ProjectivePoint.fromHex(r).toRawBytes(!0)})}static computePublicKey(e){return yi(this,arguments,void 0,function*({key:r}){const n=yield lu.privateKeyToBytes({privateKey:r}),s=yield lu.getCurvePoint({keyBytes:n}),i={kty:"EC",crv:"secp256k1",x:gr.uint8Array(s.x).toBase64Url(),y:gr.uint8Array(s.y).toBase64Url()};return i.kid=yield Kn({jwk:i}),i})}static convertDerToCompactSignature(e){return yi(this,arguments,void 0,function*({derSignature:r}){return et.Signature.fromDER(r).toCompactRawBytes()})}static decompressPublicKey(e){return yi(this,arguments,void 0,function*({publicKeyBytes:r}){return et.ProjectivePoint.fromHex(r).toRawBytes(!1)})}static generateKey(){return yi(this,void 0,void 0,function*(){const e=et.utils.randomPrivateKey(),r=yield lu.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Kn({jwk:r}),r})}static getPublicKey(e){return yi(this,arguments,void 0,function*({key:r}){var n;if(!(ip(r)&&r.crv==="secp256k1"))throw new Error("Secp256k1: The provided key is not a secp256k1 private JWK.");let s=Fhe(r,["d"]);return(n=s.kid)!==null&&n!==void 0||(s.kid=yield Kn({jwk:s})),s})}static privateKeyToBytes(e){return yi(this,arguments,void 0,function*({privateKey:r}){if(!ip(r))throw new Error("Secp256k1: The provided key is not a valid EC private key.");return gr.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return yi(this,arguments,void 0,function*({publicKey:r}){if(!(LI(r)&&r.y))throw new Error("Secp256k1: The provided key is not a valid EC public key.");const n=new Uint8Array([4]),s=gr.base64Url(r.x).toUint8Array(),i=gr.base64Url(r.y).toUint8Array();return new Uint8Array([...n,...s,...i])})}static sharedSecret(e){return yi(this,arguments,void 0,function*({privateKeyA:r,publicKeyB:n}){if("x"in r&&"x"in n&&r.x===n.x)throw new Error("Secp256k1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const s=yield lu.privateKeyToBytes({privateKey:r}),i=yield lu.publicKeyToBytes({publicKey:n});return et.getSharedSecret(s,i,!0).slice(1)})}static sign(e){return yi(this,arguments,void 0,function*({data:r,key:n}){const s=yield lu.privateKeyToBytes({privateKey:n}),i=Wv(r);return et.sign(i,s).toCompactRawBytes()})}static validatePrivateKey(e){return yi(this,arguments,void 0,function*({privateKeyBytes:r}){return et.utils.isValidPrivateKey(r)})}static validatePublicKey(e){return yi(this,arguments,void 0,function*({publicKeyBytes:r}){try{et.ProjectivePoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return yi(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=yield lu.publicKeyToBytes({publicKey:r}),o=Wv(s);return et.verify(n,o,i,{lowS:!1})})}static getCurvePoint(e){return yi(this,arguments,void 0,function*({keyBytes:r}){r.byteLength===32&&(r=et.getPublicKey(r));const n=et.ProjectivePoint.fromHex(r),s=Yr(n.x,32),i=Yr(n.y,32);return{x:s,y:i}})}};var gi=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},Mhe=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let Wg=class du{static adjustSignatureToLowS(e){return gi(this,arguments,void 0,function*({signature:r}){const n=tt.Signature.fromCompact(r);return n.hasHighS()?n.normalizeS().toCompactRawBytes():r})}static bytesToPrivateKey(e){return gi(this,arguments,void 0,function*({privateKeyBytes:r}){const n=yield du.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"P-256",d:gr.uint8Array(r).toBase64Url(),x:gr.uint8Array(n.x).toBase64Url(),y:gr.uint8Array(n.y).toBase64Url()};return s.kid=yield Kn({jwk:s}),s})}static bytesToPublicKey(e){return gi(this,arguments,void 0,function*({publicKeyBytes:r}){const n=yield du.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"P-256",x:gr.uint8Array(n.x).toBase64Url(),y:gr.uint8Array(n.y).toBase64Url()};return s.kid=yield Kn({jwk:s}),s})}static compressPublicKey(e){return gi(this,arguments,void 0,function*({publicKeyBytes:r}){return tt.ProjectivePoint.fromHex(r).toRawBytes(!0)})}static computePublicKey(e){return gi(this,arguments,void 0,function*({key:r}){const n=yield du.privateKeyToBytes({privateKey:r}),s=yield du.getCurvePoint({keyBytes:n}),i={kty:"EC",crv:"P-256",x:gr.uint8Array(s.x).toBase64Url(),y:gr.uint8Array(s.y).toBase64Url()};return i.kid=yield Kn({jwk:i}),i})}static convertDerToCompactSignature(e){return gi(this,arguments,void 0,function*({derSignature:r}){return tt.Signature.fromDER(r).toCompactRawBytes()})}static decompressPublicKey(e){return gi(this,arguments,void 0,function*({publicKeyBytes:r}){return tt.ProjectivePoint.fromHex(r).toRawBytes(!1)})}static generateKey(){return gi(this,void 0,void 0,function*(){const e=tt.utils.randomPrivateKey(),r=yield du.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Kn({jwk:r}),r})}static getPublicKey(e){return gi(this,arguments,void 0,function*({key:r}){var n;if(!(ip(r)&&r.crv==="P-256"))throw new Error("Secp256r1: The provided key is not a 'P-256' private JWK.");let s=Mhe(r,["d"]);return(n=s.kid)!==null&&n!==void 0||(s.kid=yield Kn({jwk:s})),s})}static privateKeyToBytes(e){return gi(this,arguments,void 0,function*({privateKey:r}){if(!ip(r))throw new Error("Secp256r1: The provided key is not a valid EC private key.");return gr.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return gi(this,arguments,void 0,function*({publicKey:r}){if(!(LI(r)&&r.y))throw new Error("Secp256r1: The provided key is not a valid EC public key.");const n=new Uint8Array([4]),s=gr.base64Url(r.x).toUint8Array(),i=gr.base64Url(r.y).toUint8Array();return new Uint8Array([...n,...s,...i])})}static sharedSecret(e){return gi(this,arguments,void 0,function*({privateKeyA:r,publicKeyB:n}){if("x"in r&&"x"in n&&r.x===n.x)throw new Error("Secp256r1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const s=yield du.privateKeyToBytes({privateKey:r}),i=yield du.publicKeyToBytes({publicKey:n});return tt.getSharedSecret(s,i,!0).slice(1)})}static sign(e){return gi(this,arguments,void 0,function*({data:r,key:n}){const s=yield du.privateKeyToBytes({privateKey:n}),i=Wv(r);return tt.sign(i,s).toCompactRawBytes()})}static validatePrivateKey(e){return gi(this,arguments,void 0,function*({privateKeyBytes:r}){return tt.utils.isValidPrivateKey(r)})}static validatePublicKey(e){return gi(this,arguments,void 0,function*({publicKeyBytes:r}){try{tt.ProjectivePoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return gi(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=yield du.publicKeyToBytes({publicKey:r}),o=Wv(s);return tt.verify(n,o,i,{lowS:!1})})}static getCurvePoint(e){return gi(this,arguments,void 0,function*({keyBytes:r}){r.byteLength===32&&(r=tt.getPublicKey(r));const n=tt.ProjectivePoint.fromHex(r),s=Yr(n.x,32),i=Yr(n.y,32);return{x:s,y:i}})}};var Gg=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let bF=class extends UI{computePublicKey(e){return Gg(this,arguments,void 0,function*({key:r}){if(!ip(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":{const n=yield zg.computePublicKey({key:r});return n.alg="ES256K",n}case"P-256":{const n=yield Wg.computePublicKey({key:r});return n.alg="ES256",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}generateKey(e){return Gg(this,arguments,void 0,function*({algorithm:r}){switch(r){case"ES256K":case"secp256k1":{const n=yield zg.generateKey();return n.alg="ES256K",n}case"ES256":case"secp256r1":{const n=yield Wg.generateKey();return n.alg="ES256",n}}})}getPublicKey(e){return Gg(this,arguments,void 0,function*({key:r}){if(!ip(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":{const n=yield zg.getPublicKey({key:r});return n.alg="ES256K",n}case"P-256":{const n=yield Wg.getPublicKey({key:r});return n.alg="ES256",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}sign(e){return Gg(this,arguments,void 0,function*({key:r,data:n}){if(!ip(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":return yield zg.sign({key:r,data:n});case"P-256":return yield Wg.sign({key:r,data:n});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}verify(e){return Gg(this,arguments,void 0,function*({key:r,signature:n,data:s}){if(!LI(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) public key.");switch(r.crv){case"secp256k1":return yield zg.verify({key:r,signature:n,data:s});case"P-256":return yield Wg.verify({key:r,signature:n,data:s});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}};var Oo=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},jhe=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let Jg=class Ed{static bytesToPrivateKey(e){return Oo(this,arguments,void 0,function*({privateKeyBytes:r}){const n=wr.getPublicKey(r),s={crv:"Ed25519",d:gr.uint8Array(r).toBase64Url(),kty:"OKP",x:gr.uint8Array(n).toBase64Url()};return s.kid=yield Kn({jwk:s}),s})}static bytesToPublicKey(e){return Oo(this,arguments,void 0,function*({publicKeyBytes:r}){const n={kty:"OKP",crv:"Ed25519",x:gr.uint8Array(r).toBase64Url()};return n.kid=yield Kn({jwk:n}),n})}static computePublicKey(e){return Oo(this,arguments,void 0,function*({key:r}){const n=yield Ed.privateKeyToBytes({privateKey:r}),s=wr.getPublicKey(n),i={kty:"OKP",crv:"Ed25519",x:gr.uint8Array(s).toBase64Url()};return i.kid=yield Kn({jwk:i}),i})}static convertPrivateKeyToX25519(e){return Oo(this,arguments,void 0,function*({privateKey:r}){const n=yield Ed.privateKeyToBytes({privateKey:r}),s=Bw(n),i=Oi.getPublicKey(s),o={kty:"OKP",crv:"X25519",d:gr.uint8Array(s).toBase64Url(),x:gr.uint8Array(i).toBase64Url()};return o.kid=yield Kn({jwk:o}),o})}static convertPublicKeyToX25519(e){return Oo(this,arguments,void 0,function*({publicKey:r}){const n=yield Ed.publicKeyToBytes({publicKey:r});if(!(yield Ed.validatePublicKey({publicKeyBytes:n})))throw new Error("Ed25519: Invalid public key.");const i=Nw(n),o={kty:"OKP",crv:"X25519",x:gr.uint8Array(i).toBase64Url()};return o.kid=yield Kn({jwk:o}),o})}static generateKey(){return Oo(this,void 0,void 0,function*(){const e=wr.utils.randomPrivateKey(),r=yield Ed.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Kn({jwk:r}),r})}static getPublicKey(e){return Oo(this,arguments,void 0,function*({key:r}){var n;if(!(nv(r)&&r.crv==="Ed25519"))throw new Error("Ed25519: The provided key is not an Ed25519 private JWK.");let s=jhe(r,["d"]);return(n=s.kid)!==null&&n!==void 0||(s.kid=yield Kn({jwk:s})),s})}static privateKeyToBytes(e){return Oo(this,arguments,void 0,function*({privateKey:r}){if(!nv(r))throw new Error("Ed25519: The provided key is not a valid OKP private key.");return gr.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return Oo(this,arguments,void 0,function*({publicKey:r}){if(!cK(r))throw new Error("Ed25519: The provided key is not a valid OKP public key.");return gr.base64Url(r.x).toUint8Array()})}static sign(e){return Oo(this,arguments,void 0,function*({key:r,data:n}){const s=yield Ed.privateKeyToBytes({privateKey:r});return wr.sign(n,s)})}static validatePublicKey(e){return Oo(this,arguments,void 0,function*({publicKeyBytes:r}){try{wr.ExtendedPoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return Oo(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=yield Ed.publicKeyToBytes({publicKey:r});return wr.verify(n,s,i)})}};var Xg=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let Uhe=class extends UI{computePublicKey(e){return Xg(this,arguments,void 0,function*({key:r}){if(!nv(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":{const n=yield Jg.computePublicKey({key:r});return n.alg="EdDSA",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}generateKey(e){return Xg(this,arguments,void 0,function*({algorithm:r}){switch(r){case"Ed25519":{const n=yield Jg.generateKey();return n.alg="EdDSA",n}}})}getPublicKey(e){return Xg(this,arguments,void 0,function*({key:r}){if(!nv(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":{const n=yield Jg.getPublicKey({key:r});return n.alg="EdDSA",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}sign(e){return Xg(this,arguments,void 0,function*({key:r,data:n}){if(!nv(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":return yield Jg.sign({key:r,data:n});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}verify(e){return Xg(this,arguments,void 0,function*({key:r,signature:n,data:s}){if(!cK(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) public key.");switch(r.crv){case"Ed25519":return yield Jg.verify({key:r,signature:n,data:s});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}};var xc=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};const xT={Ed25519:{implementation:Uhe,names:["Ed25519"]},secp256k1:{implementation:bF,names:["ES256K","secp256k1"]},secp256r1:{implementation:bF,names:["ES256","secp256r1"]},"SHA-256":{implementation:Ohe,names:["SHA-256"]}};let Lhe=class{constructor(e){var r;this._algorithmInstances=new Map,this._keyStore=(r=e==null?void 0:e.keyStore)!==null&&r!==void 0?r:new vhe}digest(e){return xc(this,arguments,void 0,function*({algorithm:r,data:n}){return yield this.getAlgorithm({algorithm:r}).digest({algorithm:r,data:n})})}exportKey(e){return xc(this,arguments,void 0,function*({keyUri:r}){return yield this.getPrivateKey({keyUri:r})})}generateKey(e){return xc(this,arguments,void 0,function*({algorithm:r}){const s=yield this.getAlgorithm({algorithm:r}).generateKey({algorithm:r});if((s==null?void 0:s.kid)===void 0)throw new Error("Generated key is missing a required property: kid");const i=`${_F}${s.kid}`;return yield this._keyStore.set(i,s),i})}getKeyUri(e){return xc(this,arguments,void 0,function*({key:r}){const n=yield Kn({jwk:r});return`${_F}${n}`})}getPublicKey(e){return xc(this,arguments,void 0,function*({keyUri:r}){const n=yield this.getPrivateKey({keyUri:r}),s=this.getAlgorithmName({key:n});return yield this.getAlgorithm({algorithm:s}).getPublicKey({key:n})})}importKey(e){return xc(this,arguments,void 0,function*({key:r}){var n;if(!Bhe(r))throw new TypeError("Invalid key provided. Must be a private key in JWK format.");const s=structuredClone(r);(n=s.kid)!==null&&n!==void 0||(s.kid=yield Kn({jwk:s}));const i=yield this.getKeyUri({key:s});return yield this._keyStore.set(i,s),i})}sign(e){return xc(this,arguments,void 0,function*({keyUri:r,data:n}){const s=yield this.getPrivateKey({keyUri:r}),i=this.getAlgorithmName({key:s});return this.getAlgorithm({algorithm:i}).sign({data:n,key:s})})}verify(e){return xc(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=this.getAlgorithmName({key:r});return this.getAlgorithm({algorithm:i}).verify({key:r,signature:n,data:s})})}getAlgorithm({algorithm:e}){var r;const n=(r=xT[e])===null||r===void 0?void 0:r.implementation;if(!n)throw new Error(`Algorithm not supported: ${e}`);return this._algorithmInstances.has(n)||this._algorithmInstances.set(n,new n),this._algorithmInstances.get(n)}getAlgorithmName({key:e}){const r=e.alg,n=e.crv;for(const s in xT){const i=xT[s];if(r&&i.names.includes(r))return s;if(n&&i.names.includes(n))return s}throw new Error(`Unable to determine algorithm based on provided input: alg=${r}, crv=${n}`)}getPrivateKey(e){return xc(this,arguments,void 0,function*({keyUri:r}){const n=yield this._keyStore.get(r);if(!n)throw new Error(`Key not found: ${r}`);return n})}};function Khe(){return bhe.randomUUID()}var Gv;(function(t){t.authentication="authentication",t.assertionMethod="assertionMethod",t.keyAgreement="keyAgreement",t.capabilityInvocation="capabilityInvocation",t.capabilityDelegation="capabilityDelegation"})(Gv||(Gv={}));const Ni={"@context":"https://w3id.org/did-resolution/v1",didResolutionMetadata:{},didDocument:null,didDocumentMetadata:{}};let br=class lK{constructor({method:e,id:r,path:n,query:s,fragment:i,params:o}){this.uri=`did:${e}:${r}`,this.method=e,this.id=r,this.path=n,this.query=s,this.fragment=i,this.params=o}static parse(e){if(!e)return null;const r=lK.DID_URI_PATTERN.exec(e);if(!r||!r.groups)return null;const{method:n,id:s,path:i,query:o,fragment:a}=r.groups,u={uri:`did:${n}:${s}`,method:n,id:s};if(i&&(u.path=i),o&&(u.query=o.slice(1)),a&&(u.fragment=a.slice(1)),o){const l={},c=o.slice(1).split("&");for(const d of c){const[h,f]=d.split("=");l[h]=f}u.params=l}return u}};br.METHOD_PATTERN="([a-z0-9]+)";br.PCT_ENCODED_PATTERN="(?:%[0-9a-fA-F]{2})";br.ID_CHAR_PATTERN=`(?:[a-zA-Z0-9._-]|${br.PCT_ENCODED_PATTERN})`;br.METHOD_ID_PATTERN=`((?:${br.ID_CHAR_PATTERN}*:)*(${br.ID_CHAR_PATTERN}+))`;br.PATH_PATTERN="(/[^#?]*)?";br.QUERY_PATTERN="([?][^#]*)?";br.FRAGMENT_PATTERN="(#.*)?";br.DID_URI_PATTERN=new RegExp(`^did:(?<method>${br.METHOD_PATTERN}):(?<id>${br.METHOD_ID_PATTERN})(?<path>${br.PATH_PATTERN})(?<query>${br.QUERY_PATTERN})(?<fragment>${br.FRAGMENT_PATTERN})$`);let pt=class dK extends Error{constructor(e,r){super(`${e}: ${r}`),this.code=e,this.name="DidError",Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,dK)}};var ot;(function(t){t.InvalidDid="invalidDid",t.MethodNotSupported="methodNotSupported",t.InternalError="internalError",t.InvalidDidDocument="invalidDidDocument",t.InvalidDidDocumentLength="invalidDidDocumentLength",t.InvalidDidUrl="invalidDidUrl",t.InvalidPreviousDidProof="invalidPreviousDidProof",t.InvalidPublicKey="invalidPublicKey",t.InvalidPublicKeyLength="invalidPublicKeyLength",t.InvalidPublicKeyType="invalidPublicKeyType",t.InvalidSignature="invalidSignature",t.NotFound="notFound",t.RepresentationNotSupported="representationNotSupported",t.UnsupportedPublicKeyType="unsupportedPublicKeyType"})(ot||(ot={}));function Vhe(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,u=t.charAt(0),l=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var m=0,E=0,A=0,_=p.length;A!==_&&p[A]===0;)A++,m++;for(var g=(_-A)*c+1>>>0,v=new Uint8Array(g);A!==_;){for(var S=p[A],x=0,D=g-1;(S!==0||x<E)&&D!==-1;D--,x++)S+=256*v[D]>>>0,v[D]=S%a>>>0,S=S/a>>>0;if(S!==0)throw new Error("Non-zero carry");E=x,A++}for(var w=g-E;w!==g&&v[w]===0;)w++;for(var b=u.repeat(m);w<g;++w)b+=t.charAt(v[w]);return b}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var m=0;if(p[m]!==" "){for(var E=0,A=0;p[m]===u;)E++,m++;for(var _=(p.length-m)*l+1>>>0,g=new Uint8Array(_);p[m];){var v=r[p.charCodeAt(m)];if(v===255)return;for(var S=0,x=_-1;(v!==0||S<A)&&x!==-1;x--,S++)v+=a*g[x]>>>0,g[x]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");A=S,m++}if(p[m]!==" "){for(var D=_-A;D!==_&&g[D]===0;)D++;for(var w=new Uint8Array(E+(_-D)),b=E;D!==_;)w[b++]=g[D++];return w}}}function f(p){var m=h(p);if(m)return m;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var qhe=Vhe,Hhe=qhe;const zhe=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};let Whe=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Ghe=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return fK(this,e)}},Jhe=class{constructor(e){this.decoders=e}or(e){return fK(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const fK=(t,e)=>new Jhe({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let Xhe=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new Whe(e,r,n),this.decoder=new Ghe(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const hK=({name:t,prefix:e,encode:r,decode:n})=>new Xhe(t,e,r,n),pK=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:s}=Hhe(r,e);return hK({prefix:t,name:e,encode:n,decode:i=>zhe(s(i))})},Yhe=(t,e,r,n)=>{const s={};for(let c=0;c<e.length;++c)s[e[c]]=c;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,u=0,l=0;for(let c=0;c<i;++c){const d=s[t[c]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);u=u<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&u>>a)}if(a>=r||255&u<<8-a)throw new SyntaxError("Unexpected end of data");return o},Zhe=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let u=0;u<t.length;++u)for(a=a<<8|t[u],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},bo=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>hK({prefix:e,name:t,encode(s){return Zhe(s,n,r)},decode(s){return Yhe(s,n,r,t)}});bo({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});bo({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});bo({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});bo({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});bo({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});bo({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});bo({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});bo({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});const EF=bo({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),bb=pK({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});pK({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});bo({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});bo({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const Pc=bo({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});bo({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function Qhe(t){return t.byteOffset!==0||t.byteLength!==t.buffer.byteLength}function epe(t){return typeof t!="object"||t===null?!1:typeof t[Symbol.asyncIterator]=="function"}function iP(t){const r=Object.prototype.toString.call(t).match(/\s([a-zA-Z0-9]+)/),[n,s]=r;return s}var Yg=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},AF=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(o){return new Promise(function(a,u){o=t[i](o),s(a,u,o.done,o.value)})}}function s(i,o,a,u){Promise.resolve(u).then(function(l){i({value:l,done:a})},o)}};const Eb=new TextEncoder,ah=new TextDecoder;let _t=class Ps{constructor(e,r){this.data=e,this.format=r}static arrayBuffer(e){return new Ps(e,"ArrayBuffer")}static asyncIterable(e){if(!epe(e))throw new TypeError("Input must be of type AsyncIterable.");return new Ps(e,"AsyncIterable")}static base32Z(e){return new Ps(e,"Base32Z")}static base58Btc(e){return new Ps(e,"Base58Btc")}static base64Url(e){return new Ps(e,"Base64Url")}static bufferSource(e){return new Ps(e,"BufferSource")}static hex(e){if(typeof e!="string")throw new TypeError("Hex input must be a string.");if(e.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new Ps(e,"Hex")}static multibase(e){return new Ps(e,"Multibase")}static object(e){return new Ps(e,"Object")}static string(e){return new Ps(e,"String")}static uint8Array(e){return new Ps(e,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return bb.baseDecode(this.data).buffer;case"Base64Url":return Pc.baseDecode(this.data).buffer;case"BufferSource":{if(iP(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return Qhe(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return Yg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return EF.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return bb.baseEncode(e)}case"Multibase":return this.data.substring(1);case"Uint8Array":return bb.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return Pc.baseEncode(e)}case"BufferSource":{const e=this.toUint8Array();return Pc.baseEncode(e)}case"Object":{const e=JSON.stringify(this.data),r=Eb.encode(e);return Pc.baseEncode(r)}case"String":{const e=Eb.encode(this.data);return Pc.baseEncode(e)}case"Uint8Array":return Pc.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){var e,r,n,s;return Yg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const u=[];try{for(var i=!0,o=AF(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const c=s;u.push(c)}}catch(c){r={error:c}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return new Blob(u)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){const e=Array.from({length:256},(r,n)=>n.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{const r=this.toUint8Array();return Ps.uint8Array(r).toHex()}case"Base64Url":{const r=this.toUint8Array();return Ps.uint8Array(r).toHex()}case"Uint8Array":{let r="";for(let n=0;n<this.data.length;n++)r+=e[this.data[n]];return r}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{const e=Pc.baseDecode(this.data),r=ah.decode(e);return JSON.parse(r)}case"String":return JSON.parse(this.data);case"Uint8Array":{const e=ah.decode(this.data);return JSON.parse(e)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return Yg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toStringAsync();return JSON.parse(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return ah.decode(this.data);case"Base64Url":{const e=Pc.baseDecode(this.data);return ah.decode(e)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return ah.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){var e,r,n,s;return Yg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let u="";try{for(var i=!0,o=AF(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const l=s;typeof l=="string"?u+=l:u+=ah.decode(l,{stream:!0})}}catch(l){r={error:l}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return u+=ah.decode(void 0,{stream:!1}),u}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return EF.baseDecode(this.data);case"Base58Btc":return bb.baseDecode(this.data);case"Base64Url":return Pc.baseDecode(this.data);case"BufferSource":{const e=iP(this.data);if(e==="Uint8Array")return this.data;if(e==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{const e=new Uint8Array(this.data.length/2);for(let r=0;r<this.data.length;r+=2){const n=parseInt(this.data.substring(r,r+2),16);if(isNaN(n))throw new TypeError("Input is not a valid hexadecimal string.");e[r/2]=n}return e}case"Object":{const e=JSON.stringify(this.data);return Eb.encode(e)}case"String":return Eb.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return Yg(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toArrayBufferAsync();return new Uint8Array(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}};var tpe=mK,SF=128,rpe=127,npe=~rpe,ipe=Math.pow(2,31);function mK(t,e,r){e=e||[],r=r||0;for(var n=r;t>=ipe;)e[r++]=t&255|SF,t/=128;for(;t&npe;)e[r++]=t&255|SF,t>>>=7;return e[r]=t|0,mK.bytes=r-n+1,e}var spe=sP,ope=128,TF=127;function sP(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw sP.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&TF)<<s:(o&TF)*Math.pow(2,s),s+=7}while(o>=ope);return sP.bytes=i-n,r}var ape=Math.pow(2,7),upe=Math.pow(2,14),cpe=Math.pow(2,21),lpe=Math.pow(2,28),dpe=Math.pow(2,35),fpe=Math.pow(2,42),hpe=Math.pow(2,49),ppe=Math.pow(2,56),mpe=Math.pow(2,63),ype=function(t){return t<ape?1:t<upe?2:t<cpe?3:t<lpe?4:t<dpe?5:t<fpe?6:t<hpe?7:t<ppe?8:t<mpe?9:10},gpe={encode:tpe,decode:spe,encodingLength:ype},RE=gpe;const DF=(t,e=0)=>[RE.decode(t,e),RE.decode.bytes],vpe=(t,e,r=0)=>(RE.encode(t,e,r),e),wpe=t=>RE.encodingLength(t);let ua=class Ad{static addPrefix(e){var r;let{code:n,data:s,name:i}=e;if(!(i?!n:n))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(n=Ad.codeToName.has(n)?n:Ad.nameToCode.get(i),n===void 0)throw new Error(`Unsupported multicodec: ${(r=e.name)!==null&&r!==void 0?r:e.code}`);const o=wpe(n),a=new Uint8Array(o+s.byteLength);return a.set(s,o),vpe(n,a),a}static getCodeFromData(e){const{prefixedData:r}=e,[n,s]=DF(r);return n}static getCodeFromName(e){const{name:r}=e,n=Ad.nameToCode.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static getNameFromCode(e){const{code:r}=e,n=Ad.codeToName.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static registerCodec(e){Ad.codeToName.set(e.code,e.name),Ad.nameToCode.set(e.name,e.code)}static removePrefix(e){const{prefixedData:r}=e,[n,s]=DF(r),i=Ad.codeToName.get(n);if(i===void 0)throw new Error(`Unsupported multicodec: ${n}`);return{code:n,data:r.slice(s),name:i}}};ua.codeToName=new Map;ua.nameToCode=new Map;ua.registerCodec({code:237,name:"ed25519-pub"});ua.registerCodec({code:4864,name:"ed25519-priv"});ua.registerCodec({code:236,name:"x25519-pub"});ua.registerCodec({code:4866,name:"x25519-priv"});ua.registerCodec({code:231,name:"secp256k1-pub"});ua.registerCodec({code:4865,name:"secp256k1-priv"});function yK(t){Object.keys(t).forEach(e=>{t[e]===void 0?delete t[e]:typeof t[e]=="object"&&yK(t[e])})}var uh=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let _pe=class{constructor(){this.store=new Map}clear(){return uh(this,void 0,void 0,function*(){this.store.clear()})}close(){return uh(this,void 0,void 0,function*(){})}delete(e){return uh(this,void 0,void 0,function*(){return this.store.delete(e)})}get(e){return uh(this,void 0,void 0,function*(){return this.store.get(e)})}has(e){return uh(this,void 0,void 0,function*(){return this.store.has(e)})}list(){return uh(this,void 0,void 0,function*(){return Array.from(this.store.values())})}set(e,r){return uh(this,void 0,void 0,function*(){this.store.set(e,r)})}};function bpe(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function Epe(t,...e){if(!bpe(t))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function xF(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Ape(t,e){Epe(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Spe(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}const PT=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),ru=(t,e)=>t<<32-e|t>>>e,Tpe=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Tpe)throw new Error("Non little-endian hardware is not supported");function Dpe(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function gK(t){if(typeof t=="string"&&(t=Dpe(t)),!Spe(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}let xpe=class{clone(){return this._cloneInto()}};function Ppe(t){const e=n=>t().update(gK(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Cpe(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),u=n?4:0,l=n?0:4;t.setUint32(e+u,o,n),t.setUint32(e+l,a,n)}class Ipe extends xpe{constructor(e,r,n,s){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=PT(this.buffer)}update(e){xF(this);const{view:r,buffer:n,blockLen:s}=this;e=gK(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const u=PT(e);for(;s<=i-o;o+=s)this.process(u,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){xF(this),Ape(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)r[d]=0;Cpe(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=PT(e),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=u/4,c=this.get();if(l>c.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,c[d],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%r&&e.buffer.set(n),e}}const kpe=(t,e,r)=>t&e^~t&r,$pe=(t,e,r)=>t&e^t&r^e&r,Ope=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ed=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),td=new Uint32Array(64);let Rpe=class extends Ipe{constructor(){super(64,32,8,!1),this.A=ed[0]|0,this.B=ed[1]|0,this.C=ed[2]|0,this.D=ed[3]|0,this.E=ed[4]|0,this.F=ed[5]|0,this.G=ed[6]|0,this.H=ed[7]|0}get(){const{A:e,B:r,C:n,D:s,E:i,F:o,G:a,H:u}=this;return[e,r,n,s,i,o,a,u]}set(e,r,n,s,i,o,a,u){this.A=e|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=u|0}process(e,r){for(let d=0;d<16;d++,r+=4)td[d]=e.getUint32(r,!1);for(let d=16;d<64;d++){const h=td[d-15],f=td[d-2],p=ru(h,7)^ru(h,18)^h>>>3,m=ru(f,17)^ru(f,19)^f>>>10;td[d]=m+td[d-7]+p+td[d-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:u,G:l,H:c}=this;for(let d=0;d<64;d++){const h=ru(a,6)^ru(a,11)^ru(a,25),f=c+h+kpe(a,u,l)+Ope[d]+td[d]|0,m=(ru(n,2)^ru(n,13)^ru(n,22))+$pe(n,s,i)|0;c=l,l=u,u=a,a=o+f|0,o=i,i=s,s=n,n=f+m|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,u=u+this.F|0,l=l+this.G|0,c=c+this.H|0,this.set(n,s,i,o,a,u,l,c)}roundClean(){td.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const Jv=Ppe(()=>new Rpe);var Npe=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let vK=class{static digest({data:e}){return Npe(this,void 0,void 0,function*(){return Jv(e)})}},KI=class{};var Bpe=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let Fpe=class extends KI{digest({algorithm:e,data:r}){return Bpe(this,void 0,void 0,function*(){switch(e){case"SHA-256":return yield vK.digest({data:r})}})}};function Mpe(t){const e=n=>{if(n!==null&&typeof n=="object"&&!Array.isArray(n)){const s=Object.keys(n).sort(),i={};for(const o of s)i[o]=e(n[o]);return i}return n},r=e(t);return JSON.stringify(r)}var jpe=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};const PF="urn:jwk:";function Nr({jwk:t}){return jpe(this,void 0,void 0,function*(){const e=t.kty;let r;if(e==="EC")r={crv:t.crv,kty:t.kty,x:t.x,y:t.y};else if(e==="oct")r={k:t.k,kty:t.kty};else if(e==="OKP")r={crv:t.crv,kty:t.kty,x:t.x};else if(e==="RSA")r={e:t.e,kty:t.kty,n:t.n};else throw new Error(`Unsupported key type: ${e}`);yK(r);const n=Mpe(r),s=_t.string(n).toUint8Array(),i=yield vK.digest({data:s});return _t.uint8Array(i).toBase64Url()})}function sp(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="EC"||typeof t.d!="string"||typeof t.x!="string")}function VI(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t)||"d"in t||t.kty!=="EC"||typeof t.x!="string")}function op(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="OKP"||typeof t.d!="string"||typeof t.x!="string")}function qI(t){return!(!t||typeof t!="object"||"d"in t||!("kty"in t&&"crv"in t&&"x"in t)||t.kty!=="OKP"||typeof t.x!="string")}function Upe(t){if(!t||typeof t!="object")return!1;switch(t.kty){case"EC":case"OKP":case"RSA":return"d"in t;case"oct":return"k"in t;default:return!1}}var vi=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},Lpe=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let ho=class fu{static adjustSignatureToLowS({signature:e}){return vi(this,void 0,void 0,function*(){const r=et.Signature.fromCompact(e);return r.hasHighS()?r.normalizeS().toCompactRawBytes():e})}static bytesToPrivateKey({privateKeyBytes:e}){return vi(this,void 0,void 0,function*(){const r=yield fu.getCurvePoint({keyBytes:e}),n={kty:"EC",crv:"secp256k1",d:_t.uint8Array(e).toBase64Url(),x:_t.uint8Array(r.x).toBase64Url(),y:_t.uint8Array(r.y).toBase64Url()};return n.kid=yield Nr({jwk:n}),n})}static bytesToPublicKey({publicKeyBytes:e}){return vi(this,void 0,void 0,function*(){const r=yield fu.getCurvePoint({keyBytes:e}),n={kty:"EC",crv:"secp256k1",x:_t.uint8Array(r.x).toBase64Url(),y:_t.uint8Array(r.y).toBase64Url()};return n.kid=yield Nr({jwk:n}),n})}static compressPublicKey({publicKeyBytes:e}){return vi(this,void 0,void 0,function*(){return et.ProjectivePoint.fromHex(e).toRawBytes(!0)})}static computePublicKey({key:e}){return vi(this,void 0,void 0,function*(){const r=yield fu.privateKeyToBytes({privateKey:e}),n=yield fu.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"secp256k1",x:_t.uint8Array(n.x).toBase64Url(),y:_t.uint8Array(n.y).toBase64Url()};return s.kid=yield Nr({jwk:s}),s})}static convertDerToCompactSignature({derSignature:e}){return vi(this,void 0,void 0,function*(){return et.Signature.fromDER(e).toCompactRawBytes()})}static decompressPublicKey({publicKeyBytes:e}){return vi(this,void 0,void 0,function*(){return et.ProjectivePoint.fromHex(e).toRawBytes(!1)})}static generateKey(){return vi(this,void 0,void 0,function*(){const e=et.utils.randomPrivateKey(),r=yield fu.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Nr({jwk:r}),r})}static getPublicKey({key:e}){var r;return vi(this,void 0,void 0,function*(){if(!(sp(e)&&e.crv==="secp256k1"))throw new Error("Secp256k1: The provided key is not a secp256k1 private JWK.");let n=Lpe(e,["d"]);return(r=n.kid)!==null&&r!==void 0||(n.kid=yield Nr({jwk:n})),n})}static privateKeyToBytes({privateKey:e}){return vi(this,void 0,void 0,function*(){if(!sp(e))throw new Error("Secp256k1: The provided key is not a valid EC private key.");return _t.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return vi(this,void 0,void 0,function*(){if(!(VI(e)&&e.y))throw new Error("Secp256k1: The provided key is not a valid EC public key.");const r=new Uint8Array([4]),n=_t.base64Url(e.x).toUint8Array(),s=_t.base64Url(e.y).toUint8Array();return new Uint8Array([...r,...n,...s])})}static sharedSecret({privateKeyA:e,publicKeyB:r}){return vi(this,void 0,void 0,function*(){if("x"in e&&"x"in r&&e.x===r.x)throw new Error("Secp256k1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const n=yield fu.privateKeyToBytes({privateKey:e}),s=yield fu.publicKeyToBytes({publicKey:r});return et.getSharedSecret(n,s,!0).slice(1)})}static sign({data:e,key:r}){return vi(this,void 0,void 0,function*(){const n=yield fu.privateKeyToBytes({privateKey:r}),s=Jv(e);return et.sign(s,n).toCompactRawBytes()})}static validatePrivateKey({privateKeyBytes:e}){return vi(this,void 0,void 0,function*(){return et.utils.isValidPrivateKey(e)})}static validatePublicKey({publicKeyBytes:e}){return vi(this,void 0,void 0,function*(){try{et.ProjectivePoint.fromHex(e).assertValidity()}catch{return!1}return!0})}static verify({key:e,signature:r,data:n}){return vi(this,void 0,void 0,function*(){const s=yield fu.publicKeyToBytes({publicKey:e}),i=Jv(n);return et.verify(r,i,s,{lowS:!1})})}static getCurvePoint({keyBytes:e}){return vi(this,void 0,void 0,function*(){e.byteLength===32&&(e=et.getPublicKey(e));const r=et.ProjectivePoint.fromHex(e),n=Yr(r.x,32),s=Yr(r.y,32);return{x:n,y:s}})}};var wi=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},Kpe=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let Yo=class hu{static adjustSignatureToLowS({signature:e}){return wi(this,void 0,void 0,function*(){const r=tt.Signature.fromCompact(e);return r.hasHighS()?r.normalizeS().toCompactRawBytes():e})}static bytesToPrivateKey({privateKeyBytes:e}){return wi(this,void 0,void 0,function*(){const r=yield hu.getCurvePoint({keyBytes:e}),n={kty:"EC",crv:"P-256",d:_t.uint8Array(e).toBase64Url(),x:_t.uint8Array(r.x).toBase64Url(),y:_t.uint8Array(r.y).toBase64Url()};return n.kid=yield Nr({jwk:n}),n})}static bytesToPublicKey({publicKeyBytes:e}){return wi(this,void 0,void 0,function*(){const r=yield hu.getCurvePoint({keyBytes:e}),n={kty:"EC",crv:"P-256",x:_t.uint8Array(r.x).toBase64Url(),y:_t.uint8Array(r.y).toBase64Url()};return n.kid=yield Nr({jwk:n}),n})}static compressPublicKey({publicKeyBytes:e}){return wi(this,void 0,void 0,function*(){return tt.ProjectivePoint.fromHex(e).toRawBytes(!0)})}static computePublicKey({key:e}){return wi(this,void 0,void 0,function*(){const r=yield hu.privateKeyToBytes({privateKey:e}),n=yield hu.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"P-256",x:_t.uint8Array(n.x).toBase64Url(),y:_t.uint8Array(n.y).toBase64Url()};return s.kid=yield Nr({jwk:s}),s})}static convertDerToCompactSignature({derSignature:e}){return wi(this,void 0,void 0,function*(){return tt.Signature.fromDER(e).toCompactRawBytes()})}static decompressPublicKey({publicKeyBytes:e}){return wi(this,void 0,void 0,function*(){return tt.ProjectivePoint.fromHex(e).toRawBytes(!1)})}static generateKey(){return wi(this,void 0,void 0,function*(){const e=tt.utils.randomPrivateKey(),r=yield hu.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Nr({jwk:r}),r})}static getPublicKey({key:e}){var r;return wi(this,void 0,void 0,function*(){if(!(sp(e)&&e.crv==="P-256"))throw new Error("Secp256r1: The provided key is not a 'P-256' private JWK.");let n=Kpe(e,["d"]);return(r=n.kid)!==null&&r!==void 0||(n.kid=yield Nr({jwk:n})),n})}static privateKeyToBytes({privateKey:e}){return wi(this,void 0,void 0,function*(){if(!sp(e))throw new Error("Secp256r1: The provided key is not a valid EC private key.");return _t.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return wi(this,void 0,void 0,function*(){if(!(VI(e)&&e.y))throw new Error("Secp256r1: The provided key is not a valid EC public key.");const r=new Uint8Array([4]),n=_t.base64Url(e.x).toUint8Array(),s=_t.base64Url(e.y).toUint8Array();return new Uint8Array([...r,...n,...s])})}static sharedSecret({privateKeyA:e,publicKeyB:r}){return wi(this,void 0,void 0,function*(){if("x"in e&&"x"in r&&e.x===r.x)throw new Error("Secp256r1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const n=yield hu.privateKeyToBytes({privateKey:e}),s=yield hu.publicKeyToBytes({publicKey:r});return tt.getSharedSecret(n,s,!0).slice(1)})}static sign({data:e,key:r}){return wi(this,void 0,void 0,function*(){const n=yield hu.privateKeyToBytes({privateKey:r}),s=Jv(e);return tt.sign(s,n).toCompactRawBytes()})}static validatePrivateKey({privateKeyBytes:e}){return wi(this,void 0,void 0,function*(){return tt.utils.isValidPrivateKey(e)})}static validatePublicKey({publicKeyBytes:e}){return wi(this,void 0,void 0,function*(){try{tt.ProjectivePoint.fromHex(e).assertValidity()}catch{return!1}return!0})}static verify({key:e,signature:r,data:n}){return wi(this,void 0,void 0,function*(){const s=yield hu.publicKeyToBytes({publicKey:e}),i=Jv(n);return tt.verify(r,i,s,{lowS:!1})})}static getCurvePoint({keyBytes:e}){return wi(this,void 0,void 0,function*(){e.byteLength===32&&(e=tt.getPublicKey(e));const r=tt.ProjectivePoint.fromHex(e),n=Yr(r.x,32),s=Yr(r.y,32);return{x:n,y:s}})}};var Zg=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let CF=class extends KI{computePublicKey({key:e}){return Zg(this,void 0,void 0,function*(){if(!sp(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(e.crv){case"secp256k1":{const r=yield ho.computePublicKey({key:e});return r.alg="ES256K",r}case"P-256":{const r=yield Yo.computePublicKey({key:e});return r.alg="ES256",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}generateKey({algorithm:e}){return Zg(this,void 0,void 0,function*(){switch(e){case"ES256K":case"secp256k1":{const r=yield ho.generateKey();return r.alg="ES256K",r}case"ES256":case"secp256r1":{const r=yield Yo.generateKey();return r.alg="ES256",r}}})}getPublicKey({key:e}){return Zg(this,void 0,void 0,function*(){if(!sp(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(e.crv){case"secp256k1":{const r=yield ho.getPublicKey({key:e});return r.alg="ES256K",r}case"P-256":{const r=yield Yo.getPublicKey({key:e});return r.alg="ES256",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}sign({key:e,data:r}){return Zg(this,void 0,void 0,function*(){if(!sp(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(e.crv){case"secp256k1":return yield ho.sign({key:e,data:r});case"P-256":return yield Yo.sign({key:e,data:r});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}verify({key:e,signature:r,data:n}){return Zg(this,void 0,void 0,function*(){if(!VI(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) public key.");switch(e.crv){case"secp256k1":return yield ho.verify({key:e,signature:r,data:n});case"P-256":return yield Yo.verify({key:e,signature:r,data:n});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}};var Ro=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},Vpe=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let Fs=class Sd{static bytesToPrivateKey({privateKeyBytes:e}){return Ro(this,void 0,void 0,function*(){const r=wr.getPublicKey(e),n={crv:"Ed25519",d:_t.uint8Array(e).toBase64Url(),kty:"OKP",x:_t.uint8Array(r).toBase64Url()};return n.kid=yield Nr({jwk:n}),n})}static bytesToPublicKey({publicKeyBytes:e}){return Ro(this,void 0,void 0,function*(){const r={kty:"OKP",crv:"Ed25519",x:_t.uint8Array(e).toBase64Url()};return r.kid=yield Nr({jwk:r}),r})}static computePublicKey({key:e}){return Ro(this,void 0,void 0,function*(){const r=yield Sd.privateKeyToBytes({privateKey:e}),n=wr.getPublicKey(r),s={kty:"OKP",crv:"Ed25519",x:_t.uint8Array(n).toBase64Url()};return s.kid=yield Nr({jwk:s}),s})}static convertPrivateKeyToX25519({privateKey:e}){return Ro(this,void 0,void 0,function*(){const r=yield Sd.privateKeyToBytes({privateKey:e}),n=Bw(r),s=Oi.getPublicKey(n),i={kty:"OKP",crv:"X25519",d:_t.uint8Array(n).toBase64Url(),x:_t.uint8Array(s).toBase64Url()};return i.kid=yield Nr({jwk:i}),i})}static convertPublicKeyToX25519({publicKey:e}){return Ro(this,void 0,void 0,function*(){const r=yield Sd.publicKeyToBytes({publicKey:e});if(!(yield Sd.validatePublicKey({publicKeyBytes:r})))throw new Error("Ed25519: Invalid public key.");const s=Nw(r),i={kty:"OKP",crv:"X25519",x:_t.uint8Array(s).toBase64Url()};return i.kid=yield Nr({jwk:i}),i})}static generateKey(){return Ro(this,void 0,void 0,function*(){const e=wr.utils.randomPrivateKey(),r=yield Sd.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Nr({jwk:r}),r})}static getPublicKey({key:e}){var r;return Ro(this,void 0,void 0,function*(){if(!(op(e)&&e.crv==="Ed25519"))throw new Error("Ed25519: The provided key is not an Ed25519 private JWK.");let n=Vpe(e,["d"]);return(r=n.kid)!==null&&r!==void 0||(n.kid=yield Nr({jwk:n})),n})}static privateKeyToBytes({privateKey:e}){return Ro(this,void 0,void 0,function*(){if(!op(e))throw new Error("Ed25519: The provided key is not a valid OKP private key.");return _t.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return Ro(this,void 0,void 0,function*(){if(!qI(e))throw new Error("Ed25519: The provided key is not a valid OKP public key.");return _t.base64Url(e.x).toUint8Array()})}static sign({key:e,data:r}){return Ro(this,void 0,void 0,function*(){const n=yield Sd.privateKeyToBytes({privateKey:e});return wr.sign(r,n)})}static validatePublicKey({publicKeyBytes:e}){return Ro(this,void 0,void 0,function*(){try{wr.ExtendedPoint.fromHex(e).assertValidity()}catch{return!1}return!0})}static verify({key:e,signature:r,data:n}){return Ro(this,void 0,void 0,function*(){const s=yield Sd.publicKeyToBytes({publicKey:e});return wr.verify(r,n,s)})}};var Qg=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let qpe=class extends KI{computePublicKey({key:e}){return Qg(this,void 0,void 0,function*(){if(!op(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(e.crv){case"Ed25519":{const r=yield Fs.computePublicKey({key:e});return r.alg="EdDSA",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}generateKey({algorithm:e}){return Qg(this,void 0,void 0,function*(){switch(e){case"Ed25519":{const r=yield Fs.generateKey();return r.alg="EdDSA",r}}})}getPublicKey({key:e}){return Qg(this,void 0,void 0,function*(){if(!op(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(e.crv){case"Ed25519":{const r=yield Fs.getPublicKey({key:e});return r.alg="EdDSA",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}sign({key:e,data:r}){return Qg(this,void 0,void 0,function*(){if(!op(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(e.crv){case"Ed25519":return yield Fs.sign({key:e,data:r});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}verify({key:e,signature:r,data:n}){return Qg(this,void 0,void 0,function*(){if(!qI(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) public key.");switch(e.crv){case"Ed25519":return yield Fs.verify({key:e,signature:r,data:n});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}};var Cc=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};const CT={Ed25519:{implementation:qpe,names:["Ed25519"]},secp256k1:{implementation:CF,names:["ES256K","secp256k1"]},secp256r1:{implementation:CF,names:["ES256","secp256r1"]},"SHA-256":{implementation:Fpe,names:["SHA-256"]}};let gl=class{constructor(e){var r;this._algorithmInstances=new Map,this._keyStore=(r=e==null?void 0:e.keyStore)!==null&&r!==void 0?r:new _pe}digest({algorithm:e,data:r}){return Cc(this,void 0,void 0,function*(){return yield this.getAlgorithm({algorithm:e}).digest({algorithm:e,data:r})})}exportKey({keyUri:e}){return Cc(this,void 0,void 0,function*(){return yield this.getPrivateKey({keyUri:e})})}generateKey({algorithm:e}){return Cc(this,void 0,void 0,function*(){const n=yield this.getAlgorithm({algorithm:e}).generateKey({algorithm:e});if((n==null?void 0:n.kid)===void 0)throw new Error("Generated key is missing a required property: kid");const s=`${PF}${n.kid}`;return yield this._keyStore.set(s,n),s})}getKeyUri({key:e}){return Cc(this,void 0,void 0,function*(){const r=yield Nr({jwk:e});return`${PF}${r}`})}getPublicKey({keyUri:e}){return Cc(this,void 0,void 0,function*(){const r=yield this.getPrivateKey({keyUri:e}),n=this.getAlgorithmName({key:r});return yield this.getAlgorithm({algorithm:n}).getPublicKey({key:r})})}importKey({key:e}){var r;return Cc(this,void 0,void 0,function*(){if(!Upe(e))throw new TypeError("Invalid key provided. Must be a private key in JWK format.");const n=structuredClone(e);(r=n.kid)!==null&&r!==void 0||(n.kid=yield Nr({jwk:n}));const s=yield this.getKeyUri({key:n});return yield this._keyStore.set(s,n),s})}sign({keyUri:e,data:r}){return Cc(this,void 0,void 0,function*(){const n=yield this.getPrivateKey({keyUri:e}),s=this.getAlgorithmName({key:n});return this.getAlgorithm({algorithm:s}).sign({data:r,key:n})})}verify({key:e,signature:r,data:n}){return Cc(this,void 0,void 0,function*(){const s=this.getAlgorithmName({key:e});return this.getAlgorithm({algorithm:s}).verify({key:e,signature:r,data:n})})}getAlgorithm({algorithm:e}){var r;const n=(r=CT[e])===null||r===void 0?void 0:r.implementation;if(!n)throw new Error(`Algorithm not supported: ${e}`);return this._algorithmInstances.has(n)||this._algorithmInstances.set(n,new n),this._algorithmInstances.get(n)}getAlgorithmName({key:e}){const r=e.alg,n=e.crv;for(const s in CT){const i=CT[s];if(r&&i.names.includes(r))return s;if(n&&i.names.includes(n))return s}throw new Error(`Unable to determine algorithm based on provided input: alg=${r}, crv=${n}`)}getPrivateKey({keyUri:e}){return Cc(this,void 0,void 0,function*(){const r=yield this._keyStore.get(e);if(!r)throw new Error(`Key not found: ${e}`);return r})}};function Hpe(t){const e={Ed25519:"EdDSA","P-256":"ES256","P-384":"ES384","P-521":"ES512",secp256k1:"ES256K"};if(t.alg&&Object.values(e).includes(t.alg))return t.alg;if(t.crv&&Object.keys(e).includes(t.crv))return e[t.crv];throw new Error(`Unable to determine algorithm based on provided input: alg=${t.alg}, crv=${t.crv}. Supported 'alg' values: ${Object.values(e).join(", ")}. Supported 'crv' values: ${Object.keys(e).join(", ")}.`)}var rd=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},zpe=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let wK=class R0{static bytesToPrivateKey({privateKeyBytes:e}){return rd(this,void 0,void 0,function*(){const r=Oi.getPublicKey(e),n={kty:"OKP",crv:"X25519",d:_t.uint8Array(e).toBase64Url(),x:_t.uint8Array(r).toBase64Url()};return n.kid=yield Nr({jwk:n}),n})}static bytesToPublicKey({publicKeyBytes:e}){return rd(this,void 0,void 0,function*(){const r={kty:"OKP",crv:"X25519",x:_t.uint8Array(e).toBase64Url()};return r.kid=yield Nr({jwk:r}),r})}static computePublicKey({key:e}){return rd(this,void 0,void 0,function*(){const r=yield R0.privateKeyToBytes({privateKey:e}),n=Oi.getPublicKey(r),s={kty:"OKP",crv:"X25519",x:_t.uint8Array(n).toBase64Url()};return s.kid=yield Nr({jwk:s}),s})}static generateKey(){return rd(this,void 0,void 0,function*(){const e=Oi.utils.randomPrivateKey(),r=yield R0.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Nr({jwk:r}),r})}static getPublicKey({key:e}){var r;return rd(this,void 0,void 0,function*(){if(!(op(e)&&e.crv==="X25519"))throw new Error("X25519: The provided key is not an X25519 private JWK.");let n=zpe(e,["d"]);return(r=n.kid)!==null&&r!==void 0||(n.kid=yield Nr({jwk:n})),n})}static privateKeyToBytes({privateKey:e}){return rd(this,void 0,void 0,function*(){if(!op(e))throw new Error("X25519: The provided key is not a valid OKP private key.");return _t.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return rd(this,void 0,void 0,function*(){if(!qI(e))throw new Error("X25519: The provided key is not a valid OKP public key.");return _t.base64Url(e.x).toUint8Array()})}static sharedSecret({privateKeyA:e,publicKeyB:r}){return rd(this,void 0,void 0,function*(){if("x"in e&&"x"in r&&e.x===r.x)throw new Error("X25519: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const n=yield R0.privateKeyToBytes({privateKey:e}),s=yield R0.publicKeyToBytes({publicKey:r});return Oi.getSharedSecret(n,s)})}};function Ra(t){if(typeof t=="string"&&t.length!==0)return t.split("#").pop()}function _K({didDocument:t}){var e,r;if(!t)throw new TypeError("Required parameter missing: 'didDocument'");const n=[];return n.push(...(r=(e=t.verificationMethod)===null||e===void 0?void 0:e.filter(NE))!==null&&r!==void 0?r:[]),Object.keys(Gv).forEach(s=>{var i,o;n.push(...(o=(i=t[s])===null||i===void 0?void 0:i.filter(NE))!==null&&o!==void 0?o:[])}),n}function Wpe({didDocument:t}){const r=_K({didDocument:t}).map(n=>n.type);return[...new Set(r)]}function Gpe({didDocument:t,methodId:e}){const r=[];return Object.keys(Gv).forEach(n=>{if(Array.isArray(t[n])){const s=t[n],i=Ra(e);s.some(a=>{const u=Ra(a)===i,l=NE(a)&&Ra(a.id)===i;return u||l})&&r.push(n)}}),r}function NE(t){return!(!t||typeof t!="object"||t===null||!("id"in t&&"type"in t&&"controller"in t)||typeof t.id!="string"||typeof t.type!="string"||typeof t.controller!="string")}function bK({keyBytes:t,multicodecCode:e,multicodecName:r}){const n=ua.addPrefix({code:e,data:t,name:r}),s=_t.uint8Array(n).toBase58Btc();return _t.base58Btc(s).toMultibase()}function IF({multibaseKeyId:t}){try{const e=_t.multibase(t).toBase58Btc(),r=_t.base58Btc(e).toUint8Array(),{code:n,data:s,name:i}=ua.removePrefix({prefixedData:r});return{keyBytes:s,multicodecCode:n,multicodecName:i}}catch{throw new pt(ot.InvalidDid,`Invalid multibase identifier: ${t}`)}}var e0=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let vf=class EK{constructor({uri:e,document:r,metadata:n,keyManager:s}){this.uri=e,this.document=r,this.metadata=n,this.keyManager=s}export(){return e0(this,void 0,void 0,function*(){if(!(Array.isArray(this.document.verificationMethod)&&this.document.verificationMethod.length>0))throw new Error(`DID document for '${this.uri}' is missing verification methods`);let e={uri:this.uri,document:this.document,metadata:this.metadata};if("exportKey"in this.keyManager&&typeof this.keyManager.exportKey=="function"){const r=[];for(let n of this.document.verificationMethod){if(!n.publicKeyJwk)throw new Error(`Verification method '${n.id}' does not contain a public key in JWK format`);const s=yield this.keyManager.getKeyUri({key:n.publicKeyJwk}),i=yield this.keyManager.exportKey({keyUri:s});r.push(Object.assign({},i))}e.privateKeys=r}return e})}getSigner(e){return e0(this,void 0,void 0,function*(){var r;const n=(r=this.document.verificationMethod)===null||r===void 0?void 0:r.find(u=>{var l,c;return Ra(u.id)===((l=Ra(e==null?void 0:e.methodId))!==null&&l!==void 0?l:Ra((c=this.document.assertionMethod)===null||c===void 0?void 0:c[0]))});if(!(n&&n.publicKeyJwk))throw new pt(ot.InternalError,"A verification method intended for signing could not be determined from the DID Document");const s=yield this.keyManager.getKeyUri({key:n.publicKeyJwk}),i=yield this.keyManager.getPublicKey({keyUri:s}),o=this.keyManager;return{algorithm:Hpe(i),keyId:n.id,sign(u){return e0(this,arguments,void 0,function*({data:l}){return yield o.sign({data:l,keyUri:s})})},verify(u){return e0(this,arguments,void 0,function*({data:l,signature:c}){return yield o.verify({data:l,key:i,signature:c})})}}})}static import(e){return e0(this,arguments,void 0,function*({portableDid:r,keyManager:n=new gl}){var s;const i=_K({didDocument:r.document});if(i.length===0)throw new pt(ot.InvalidDidDocument,"At least one verification method is required but 0 were given");for(let a of(s=r.privateKeys)!==null&&s!==void 0?s:[])yield n.importKey({key:a});for(let a of i){if(!a.publicKeyJwk)throw new Error(`Verification method '${a.id}' does not contain a public key in JWK format`);const u=yield n.getKeyUri({key:a.publicKeyJwk});yield n.getPublicKey({keyUri:u})}return new EK({uri:r.uri,document:r.document,metadata:r.metadata,keyManager:n})})}};var kF=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let Vw=class{static getSigningMethod(e){return kF(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement getSigningMethod()")})}static resolve(e,r){return kF(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement resolve()")})}};var ni=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},$F=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};const OF="https://diddht.tbddev.org",Jpe=0,nd=7200,T1=";",ss=",";var oP;(function(t){t[t.Discoverable=0]="Discoverable",t[t.Organization=1]="Organization",t[t.Government=2]="Government",t[t.Corporation=3]="Corporation",t[t.LocalBusiness=4]="LocalBusiness",t[t.SoftwarePackage=5]="SoftwarePackage",t[t.WebApp=6]="WebApp",t[t.FinancialInstitution=7]="FinancialInstitution"})(oP||(oP={}));var hs;(function(t){t[t.Ed25519=0]="Ed25519",t[t.secp256k1=1]="secp256k1",t[t.secp256r1=2]="secp256r1",t[t.X25519=3]="X25519"})(hs||(hs={}));var aP;(function(t){t.authentication="auth",t.assertionMethod="asm",t.capabilityDelegation="del",t.capabilityInvocation="inv",t.keyAgreement="agm"})(aP||(aP={}));const AK={Ed25519:hs.Ed25519,ES256K:hs.secp256k1,ES256:hs.secp256r1,"P-256":hs.secp256r1,secp256k1:hs.secp256k1,secp256r1:hs.secp256r1,X25519:hs.X25519},RF={[hs.Ed25519]:"EdDSA",[hs.secp256k1]:"ES256K",[hs.secp256r1]:"ES256",[hs.X25519]:"ECDH-ES+A256KW"};let BE=class uP extends Vw{static create(){return ni(this,arguments,void 0,function*({keyManager:e=new gl,options:r={}}={}){var n,s,i,o,a,u,l,c,d,h,f;if(!((n=r.verificationMethods)===null||n===void 0)&&n.some(S=>!(S.algorithm in AK)))throw new Error("One or more verification method algorithms are not supported");const p=(s=r.verificationMethods)===null||s===void 0?void 0:s.filter(S=>"id"in S).map(S=>S.id);if(p&&p.length!==new Set(p).size)throw new Error("One or more verification method IDs are not unique");if(!((i=r.services)===null||i===void 0)&&i.some(S=>!S.id||!S.type||!S.serviceEndpoint))throw new Error("One or more services are missing required properties");const m=yield e.generateKey({algorithm:"Ed25519"}),E=yield e.getPublicKey({keyUri:m}),A=yield Gi.identityKeyToIdentifier({identityKey:E}),_=Object.assign(Object.assign({id:A},r.alsoKnownAs&&{alsoKnownAs:r.alsoKnownAs}),r.controllers&&{controller:r.controllers}),g=[...(o=r.verificationMethods)!==null&&o!==void 0?o:[]];g!=null&&g.some(S=>{var x;return((x=S.id)===null||x===void 0?void 0:x.split("#").pop())==="0"})||g.unshift({algorithm:"Ed25519",id:"0",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]});for(const S of g){const x=S.id&&S.id.split("#").pop()==="0"?m:yield e.generateKey({algorithm:S.algorithm}),D=yield e.getPublicKey({keyUri:x});let w=(u=(a=S.id)!==null&&a!==void 0?a:D.kid)!==null&&u!==void 0?u:yield Nr({jwk:D});w=`${A}#${Ra(w)}`,(l=_.verificationMethod)!==null&&l!==void 0||(_.verificationMethod=[]),_.verificationMethod.push({id:w,type:"JsonWebKey",controller:(c=S.controller)!==null&&c!==void 0?c:A,publicKeyJwk:D});for(const b of(d=S.purposes)!==null&&d!==void 0?d:[])_[b]||(_[b]=[]),_[b].push(w)}(h=r.services)===null||h===void 0||h.forEach(S=>{var x;(x=_.service)!==null&&x!==void 0||(_.service=[]),S.id=`${A}#${S.id.split("#").pop()}`,_.service.push(S)});const v=new vf({uri:A,document:_,metadata:Object.assign({published:!1},r.types&&{types:r.types}),keyManager:e});if(!((f=r.publish)!==null&&f!==void 0)||f){const S=yield uP.publish({did:v,gatewayUri:r.gatewayUri});v.metadata=S.didDocumentMetadata}return v})}static import(e){return ni(this,arguments,void 0,function*({portableDid:r,keyManager:n=new gl}){var s;const i=br.parse(r.uri);if((i==null?void 0:i.method)!==uP.methodName)throw new pt(ot.MethodNotSupported,"Method not supported");const o=yield vf.import({portableDid:r,keyManager:n});if(!(!((s=o.document.verificationMethod)===null||s===void 0)&&s.some(a=>{var u;return((u=a.id)===null||u===void 0?void 0:u.split("#").pop())==="0"})))throw new pt(ot.InvalidDidDocument,"DID document must contain an Identity Key");return o})}static getSigningMethod(e){return ni(this,arguments,void 0,function*({didDocument:r,methodId:n="#0"}){var s;const i=br.parse(r.id);if(i&&i.method!==this.methodName)throw new pt(ot.MethodNotSupported,`Method not supported: ${i.method}`);const o=(s=r.verificationMethod)===null||s===void 0?void 0:s.find(a=>{var u,l;return Ra(a.id)===((u=Ra(n))!==null&&u!==void 0?u:Ra((l=r.assertionMethod)===null||l===void 0?void 0:l[0]))});if(!(o&&o.publicKeyJwk))throw new pt(ot.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static publish(e){return ni(this,arguments,void 0,function*({did:r,gatewayUri:n=OF}){return yield NF.put({did:r,gatewayUri:n})})}static resolve(e){return ni(this,arguments,void 0,function*(r,n={}){var s;const i=(s=n==null?void 0:n.gatewayUri)!==null&&s!==void 0?s:OF;try{yield Gi.identifierToIdentityKey({didUri:r});const{didDocument:o,didDocumentMetadata:a}=yield NF.get({didUri:r,gatewayUri:i});return Object.assign(Object.assign({},Ni),{didDocument:o,didDocumentMetadata:a})}catch(o){if(!(o instanceof pt))throw new Error(o);return Object.assign(Object.assign({},Ni),{didResolutionMetadata:Object.assign({error:o.code},o.message&&{errorMessage:o.message})})}})}};BE.methodName="dht";let NF=class vh{static get(e){return ni(this,arguments,void 0,function*({didUri:r,gatewayUri:n}){const s=Gi.identifierToIdentityKeyBytes({didUri:r}),i=yield vh.pkarrGet({gatewayUri:n,publicKeyBytes:s}),o=yield Gi.parseBep44GetMessage({bep44Message:i}),a=yield vh.fromDnsPacket({didUri:r,dnsPacket:o});return a.didDocumentMetadata.versionId=i.seq.toString(),a})}static put(e){return ni(this,arguments,void 0,function*({did:r,gatewayUri:n}){const s=yield vh.toDnsPacket({didDocument:r.document,didMetadata:r.metadata,authoritativeGatewayUris:[n]}),i=yield Gi.createBep44PutMessage({dnsPacket:s,publicKeyBytes:Gi.identifierToIdentityKeyBytes({didUri:r.uri}),signer:yield r.getSigner({methodId:"0"})}),o=yield vh.pkarrPut({gatewayUri:n,bep44Message:i});return{didDocument:r.document,didDocumentMetadata:Object.assign(Object.assign({},r.metadata),{published:o,versionId:i.seq.toString()}),didRegistrationMetadata:{}}})}static pkarrGet(e){return ni(this,arguments,void 0,function*({gatewayUri:r,publicKeyBytes:n}){const s=_t.uint8Array(n).toBase32Z(),i=new URL(s,r).href;let o;try{if(o=yield fetch(i,{method:"GET"}),!o.ok)throw new pt(ot.NotFound,`Pkarr record not found for: ${s}`)}catch(l){throw l instanceof pt?l:new pt(ot.InternalError,`Failed to fetch Pkarr record: ${l.message}`)}const a=yield o.arrayBuffer();if(!a)throw new pt(ot.NotFound,`Pkarr record not found for: ${s}`);if(a.byteLength<72)throw new pt(ot.InvalidDidDocumentLength,`Pkarr response must be at least 72 bytes but got: ${a.byteLength}`);if(a.byteLength>1072)throw new pt(ot.InvalidDidDocumentLength,`Pkarr response exceeds 1000 byte limit: ${a.byteLength}`);return{k:n,seq:Number(new DataView(a).getBigUint64(64)),sig:new Uint8Array(a,0,64),v:new Uint8Array(a,72)}})}static pkarrPut(e){return ni(this,arguments,void 0,function*({gatewayUri:r,bep44Message:n}){const s=_t.uint8Array(n.k).toBase32Z(),i=new URL(s,r).href,o=new Uint8Array(n.v.length+72);o.set(n.sig,0),new DataView(o.buffer).setBigUint64(n.sig.length,BigInt(n.seq)),o.set(n.v,n.sig.length+8);let a;try{a=yield fetch(i,{method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:o})}catch(u){throw new pt(ot.InternalError,`Failed to put Pkarr record for identifier ${s}: ${u.message}`)}return a.ok})}static fromDnsPacket(e){return ni(this,arguments,void 0,function*({didUri:r,dnsPacket:n}){var s,i,o;const a={id:r},u={published:!0},l=new Map;for(const c of(s=n==null?void 0:n.answers)!==null&&s!==void 0?s:[]){if(c.type!=="TXT")continue;const d=c.name.split(".")[0].substring(1);switch(!0){case d.startsWith("aka"):{const h=Gi.parseTxtDataToString(c.data);a.alsoKnownAs=h.split(ss);break}case d.startsWith("cnt"):{const h=Gi.parseTxtDataToString(c.data);a.controller=h.includes(ss)?h.split(ss):h;break}case d.startsWith("k"):{const{id:h,t:f,k:p,c:m,a:E}=Gi.parseTxtDataToObject(c.data),A=_t.base64Url(p).toUint8Array(),_=hs[Number(f)];let g=yield Gi.keyConverter(_).bytesToPublicKey({publicKeyBytes:A});g.alg=E||RF[Number(f)];const v=d==="k0"?"0":h!==void 0?h:yield Nr({jwk:g});(i=a.verificationMethod)!==null&&i!==void 0||(a.verificationMethod=[]);const S=`${r}#${v}`;a.verificationMethod.push({id:S,type:"JsonWebKey",controller:m??r,publicKeyJwk:g}),l.set(d,S);break}case d.startsWith("s"):{const h=Gi.parseTxtDataToObject(c.data),{id:f,t:p,se:m}=h,E=$F(h,["id","t","se"]),A=m.includes(ss)?m.split(ss):[m],_=Object.fromEntries(Object.entries(E).map(([g,v])=>[g,v.includes(ss)?v.split(ss):v]));(o=a.service)!==null&&o!==void 0||(a.service=[]),a.service.push(Object.assign(Object.assign({},_),{id:`${r}#${f}`,type:p,serviceEndpoint:A}));break}case d.startsWith("typ"):{const{id:h}=Gi.parseTxtDataToObject(c.data);u.types=h.split(ss).map(f=>Number(f));break}case d.startsWith("did"):{const h=_=>_.split(ss).map(g=>l.get(g)).filter(g=>typeof g=="string"),{auth:f,asm:p,del:m,inv:E,agm:A}=Gi.parseTxtDataToObject(c.data);f&&(a.authentication=h(f)),p&&(a.assertionMethod=h(p)),m&&(a.capabilityDelegation=h(m)),E&&(a.capabilityInvocation=h(E)),A&&(a.keyAgreement=h(A));break}}}return{didDocument:a,didDocumentMetadata:u,didResolutionMetadata:{}}})}static toDnsPacket(e){return ni(this,arguments,void 0,function*({didDocument:r,didMetadata:n,authoritativeGatewayUris:s,previousDidProof:i}){var o,a,u,l,c;const d=[],h=[],f=new Map,p=[],m=[];if(i!==void 0){const{signature:_,previousDid:g}=i;yield Gi.validatePreviousDidProof({newDid:r.id,previousDidProof:i}),d.push({type:"TXT",name:"_prv._did.",ttl:nd,data:`id=${g};s=${_}`})}if(r.alsoKnownAs&&d.push({type:"TXT",name:"_aka._did.",ttl:nd,data:r.alsoKnownAs.join(ss)}),r.controller){const _=Array.isArray(r.controller)?r.controller.join(ss):r.controller;d.push({type:"TXT",name:"_cnt._did.",ttl:nd,data:_})}for(const[_,g]of(a=(o=r.verificationMethod)===null||o===void 0?void 0:o.entries())!==null&&a!==void 0?a:[]){const v=`k${_}`;m.push(v);let S=g.id.split("#").pop();f.set(S,v);const x=g.publicKeyJwk;if(!(x!=null&&x.crv&&x.crv in AK))throw new pt(ot.InvalidPublicKeyType,`Verification method '${g.id}' contains an unsupported key type: ${(u=x==null?void 0:x.crv)!==null&&u!==void 0?u:"undefined"}`);const D=hs[x.crv],w=yield Gi.keyConverter(x.crv).publicKeyToBytes({publicKey:x}),b=_t.uint8Array(w).toBase64Url(),T=[`t=${D}`,`k=${b}`];S!=="0"&&(yield Nr({jwk:x}))!==S&&T.unshift(`id=${S}`),x.alg!==RF[D]&&T.push(`a=${x.alg}`),g.controller!==r.id&&T.push(`c=${g.controller}`),d.push({type:"TXT",name:`_${v}._did.`,ttl:nd,data:T.join(T1)})}(l=r.service)===null||l===void 0||l.forEach((_,g)=>{const v=`s${g}`;p.push(v);let{id:S,type:x,serviceEndpoint:D}=_,w=$F(_,["id","type","serviceEndpoint"]);S=Ra(S),D=Array.isArray(D)?D.join(","):D;const T=Object.entries(Object.assign({id:S,t:x,se:D},w)).map(([C,k])=>`${C}=${k}`).join(T1),P=Gi.chunkDataIfNeeded(T);d.push({type:"TXT",name:`_${v}._did.`,ttl:nd,data:P})});const E=[`v=${Jpe}`];if(m.length&&E.push(`vm=${m.join(ss)}`),Object.keys(Gv).forEach(_=>{var g;const v=(g=r[_])===null||g===void 0?void 0:g.map(S=>f.get(S.split("#").pop()));if(v){const S=aP[_];E.push(`${S}=${v.join(ss)}`)}}),p.length&&E.push(`svc=${p.join(ss)}`),!((c=n.types)===null||c===void 0)&&c.length){const g=n.types.map(v=>typeof v=="string"?oP[v]:v);d.push({type:"TXT",name:"_typ._did.",ttl:nd,data:`id=${g.join(ss)}`})}d.push({type:"TXT",name:"_did."+vh.getUniqueDidSuffix(r.id)+".",ttl:nd,data:E.join(T1)});for(const _ of s||[])h.push({type:"NS",name:"_did."+vh.getUniqueDidSuffix(r.id)+".",ttl:nd,data:_+"."});return{id:0,type:"response",flags:MI,answers:[...d,...h]}})}static getUniqueDidSuffix(e){return e.split(":")[2]}},Gi=class D1{static createBep44PutMessage(e){return ni(this,arguments,void 0,function*({dnsPacket:r,publicKeyBytes:n,signer:s}){const i=Math.ceil(Date.now()/1e3),o=Hv(r),a=gy.encode({seq:i,v:o}).subarray(1,-1);if(a.length>1e3)throw new pt(ot.InvalidDidDocumentLength,`DNS packet exceeds the 1000 byte maximum size: ${a.length} bytes`);const u=yield s.sign({data:a});return{k:n,seq:i,sig:u,v:o}})}static identifierToIdentityKey(e){return ni(this,arguments,void 0,function*({didUri:r}){let n=D1.identifierToIdentityKeyBytes({didUri:r});return yield Fs.bytesToPublicKey({publicKeyBytes:n})})}static identifierToIdentityKeyBytes({didUri:e}){const r=br.parse(e);if(!r)throw new pt(ot.InvalidDid,`Invalid DID URI: ${e}`);if(r.method!==BE.methodName)throw new pt(ot.MethodNotSupported,`Method not supported: ${r.method}`);let n;try{n=_t.base32Z(r.id).toUint8Array()}catch{throw new pt(ot.InvalidPublicKey,"Failed to decode method-specific identifier")}if(n.length!==32)throw new pt(ot.InvalidPublicKeyLength,`Invalid public key length: ${n.length}`);return n}static identityKeyToIdentifier(e){return ni(this,arguments,void 0,function*({identityKey:r}){const n=yield Fs.publicKeyToBytes({publicKey:r}),s=_t.uint8Array(n).toBase32Z();return`did:${BE.methodName}:${s}`})}static keyConverter(e){const n={Ed25519:Fs,"P-256":{publicKeyToBytes:s=>ni(this,[s],void 0,function*({publicKey:i}){const o=yield Yo.publicKeyToBytes({publicKey:i});return yield Yo.compressPublicKey({publicKeyBytes:o})}),bytesToPublicKey:Yo.bytesToPublicKey,privateKeyToBytes:Yo.privateKeyToBytes,bytesToPrivateKey:Yo.bytesToPrivateKey},secp256k1:{publicKeyToBytes:s=>ni(this,[s],void 0,function*({publicKey:i}){const o=yield ho.publicKeyToBytes({publicKey:i});return yield ho.compressPublicKey({publicKeyBytes:o})}),bytesToPublicKey:ho.bytesToPublicKey,privateKeyToBytes:ho.privateKeyToBytes,bytesToPrivateKey:ho.bytesToPrivateKey},X25519:wK}[e];if(!n)throw new pt(ot.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static parseBep44GetMessage(e){return ni(this,arguments,void 0,function*({bep44Message:r}){const n=yield Fs.bytesToPublicKey({publicKeyBytes:r.k}),s=gy.encode({seq:r.seq,v:r.v}).subarray(1,-1);if(!(yield Fs.verify({key:n,signature:r.sig,data:s})))throw new pt(ot.InvalidSignature,"Invalid signature for DHT BEP44 message");return jI(r.v)})}static parseTxtDataToObject(e){return this.parseTxtDataToString(e).split(T1).reduce((r,n)=>{const[s,i]=n.split("=");return r[s]=i,r},{})}static parseTxtDataToString(e){if(typeof e=="string")return e;if(e instanceof Uint8Array)return _t.uint8Array(e).toString();if(Array.isArray(e))return e.map(r=>this.parseTxtDataToString(r)).join("");throw new pt(ot.InternalError,"Pkarr returned DNS TXT record with invalid data type")}static validatePreviousDidProof(e){return ni(this,arguments,void 0,function*({newDid:r,previousDidProof:n}){const s=yield D1.identifierToIdentityKey({didUri:n.previousDid}),i=D1.identifierToIdentityKeyBytes({didUri:r}),o=_t.base64Url(n.signature).toUint8Array();if(!(yield Fs.verify({key:s,data:i,signature:o})))throw new pt(ot.InvalidPreviousDidProof,"The previous DID proof is invalid.")})}static chunkDataIfNeeded(e){if(e.length<=255)return e;const r=[];for(let n=0;n<e.length;n+=255)r.push(e.slice(n,n+255));return r}};var Bd=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},Su;(function(t){t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.secp256r1="secp256r1",t.X25519="X25519"})(Su||(Su={}));const Xpe={Ed25519:Su.Ed25519,ES256K:Su.secp256k1,ES256:Su.secp256r1,"P-256":Su.secp256r1,secp256k1:Su.secp256k1,secp256r1:Su.secp256r1},BF="https://ion.tbd.engineering";let SK=class N0 extends Vw{static create(){return Bd(this,arguments,void 0,function*({keyManager:e=new gl,options:r={}}={}){var n,s,i,o,a,u,l;if(!((n=r.verificationMethods)===null||n===void 0)&&n.some(S=>!(S.algorithm in Xpe)))throw new Error("One or more verification method algorithms are not supported");const c=(s=r.verificationMethods)===null||s===void 0?void 0:s.filter(S=>"id"in S).map(S=>S.id);if(c&&c.length!==new Set(c).size)throw new Error("One or more verification method IDs are not unique");if(!((i=r.services)===null||i===void 0)&&i.some(S=>!S.id||!S.type||!S.serviceEndpoint))throw new Error("One or more services are missing required properties");const d={algorithm:"Ed25519",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]},h=[];for(const S of(o=r.verificationMethods)!==null&&o!==void 0?o:[d]){const x=yield e.generateKey({algorithm:S.algorithm}),D=yield e.getPublicKey({keyUri:x});h.push({id:S.id,publicKeyJwk:D,purposes:(a=S.purposes)!==null&&a!==void 0?a:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]})}const f=yield e.generateKey({algorithm:Su.secp256k1}),p=yield e.getPublicKey({keyUri:f}),m=yield e.generateKey({algorithm:Su.secp256k1}),E=yield e.getPublicKey({keyUri:m}),A=yield t0.computeLongFormDidUri({recoveryKey:p,updateKey:E,services:(u=r.services)!==null&&u!==void 0?u:[],verificationMethods:h}),{didDocument:_,didResolutionMetadata:g}=yield N0.resolve(A,{gatewayUri:r.gatewayUri});if(_===null)throw new Error(`Unable to resolve DID during creation: ${g==null?void 0:g.error}`);const v=new vf({uri:A,document:_,metadata:{published:!1,canonicalId:A.split(":",3).join(":"),recoveryKey:p,updateKey:E},keyManager:e});if(!((l=r.publish)!==null&&l!==void 0)||l){const S=yield N0.publish({did:v,gatewayUri:r.gatewayUri});v.metadata=S.didDocumentMetadata}return v})}static getSigningMethod(e){return Bd(this,arguments,void 0,function*({didDocument:r,methodId:n}){var s;const i=br.parse(r.id);if(i&&i.method!==this.methodName)throw new pt(ot.MethodNotSupported,`Method not supported: ${i.method}`);const o=(s=r.verificationMethod)===null||s===void 0?void 0:s.find(a=>{var u;return a.id===(n??((u=r.assertionMethod)===null||u===void 0?void 0:u[0]))});if(!(o&&o.publicKeyJwk))throw new pt(ot.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static import(e){return Bd(this,arguments,void 0,function*({portableDid:r,keyManager:n=new gl}){const s=br.parse(r.uri);if((s==null?void 0:s.method)!==N0.methodName)throw new pt(ot.MethodNotSupported,"Method not supported");return yield vf.import({portableDid:r,keyManager:n})})}static publish(e){return Bd(this,arguments,void 0,function*({did:r,gatewayUri:n=BF}){var s,i,o;const a=(i=(s=r.document.verificationMethod)===null||s===void 0?void 0:s.map(c=>({id:c.id,publicKeyJwk:c.publicKeyJwk,purposes:Gpe({didDocument:r.document,methodId:c.id})})))!==null&&i!==void 0?i:[],u=yield t0.createIonDocument({services:(o=r.document.service)!==null&&o!==void 0?o:[],verificationMethods:a}),l=yield t0.constructCreateRequest({ionDocument:u,recoveryKey:r.metadata.recoveryKey,updateKey:r.metadata.updateKey});try{const c=t0.appendPathToUrl({baseUrl:n,path:"/operations"}),d=yield fetch(c,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});return{didDocument:r.document,didDocumentMetadata:Object.assign(Object.assign({},r.metadata),{published:d.ok}),didRegistrationMetadata:{}}}catch{return{didDocument:null,didDocumentMetadata:{published:!1},didRegistrationMetadata:{error:ot.InternalError,errorMessage:`Failed to publish DID document for: ${r.uri}`}}}})}static resolve(e){return Bd(this,arguments,void 0,function*(r,n={}){var s,i;const o=br.parse(r);if(!o)return Object.assign(Object.assign({},Ni),{didResolutionMetadata:{error:"invalidDid"}});if(o.method!==N0.methodName)return Object.assign(Object.assign({},Ni),{didResolutionMetadata:{error:"methodNotSupported"}});const a=(s=n==null?void 0:n.gatewayUri)!==null&&s!==void 0?s:BF;try{const u=t0.appendPathToUrl({baseUrl:a,path:`/identifiers/${r}`}),l=yield fetch(u);if(!l.ok)throw new pt(ot.NotFound,`Unable to find DID document for: ${r}`);const{didDocument:c,didDocumentMetadata:d}=yield l.json();return Object.assign(Object.assign(Object.assign({},Ni),c&&{didDocument:c}),{didDocumentMetadata:Object.assign({published:(i=d==null?void 0:d.method)===null||i===void 0?void 0:i.published},d)})}catch(u){if(!(u instanceof pt))throw new Error(u);return Object.assign(Object.assign({},Ni),{didResolutionMetadata:Object.assign({error:u.code},u.message&&{errorMessage:u.message})})}})}};SK.methodName="ion";let t0=class wh{static appendPathToUrl({baseUrl:e,path:r}){const n=new URL(e);return n.pathname=n.pathname.endsWith("/")?n.pathname:n.pathname+"/",n.pathname+=r.startsWith("/")?r.substring(1):r,n.toString()}static computeLongFormDidUri(e){return Bd(this,arguments,void 0,function*({recoveryKey:r,updateKey:n,services:s,verificationMethods:i}){const o=yield wh.createIonDocument({services:s,verificationMethods:i}),a=wh.normalizeJwk(r),u=wh.normalizeJwk(n);return yield Lw.createLongFormDid({document:o,recoveryKey:a,updateKey:u})})}static constructCreateRequest(e){return Bd(this,arguments,void 0,function*({ionDocument:r,recoveryKey:n,updateKey:s}){return yield Ji.createCreateRequest({document:r,recoveryKey:wh.normalizeJwk(n),updateKey:wh.normalizeJwk(s)})})}static createIonDocument(e){return Bd(this,arguments,void 0,function*({services:r,verificationMethods:n}){var s,i;const o=[];for(const l of n){let c=(i=(s=l.id)!==null&&s!==void 0?s:l.publicKeyJwk.kid)!==null&&i!==void 0?i:yield Nr({jwk:l.publicKeyJwk});c=`${c.split("#").pop()}`;const d={id:c,publicKeyJwk:wh.normalizeJwk(l.publicKeyJwk),purposes:l.purposes,type:"JsonWebKey2020"};o.push(d)}const a=r.map(l=>Object.assign(Object.assign({},l),{id:`${l.id.split("#").pop()}`}));return{publicKeys:o,services:a}})}static normalizeJwk(e){const r=e.kty;let n;if(r==="EC")n={crv:e.crv,kty:e.kty,x:e.x,y:e.y};else if(r==="oct")n={k:e.k,kty:e.kty};else if(r==="OKP")n={crv:e.crv,kty:e.kty,x:e.x};else if(r==="RSA")n={e:e.e,kty:e.kty,n:e.n};else throw new Error(`Unsupported key type: ${r}`);return n}};var Ab=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let TK=class B0 extends Vw{static create(){return Ab(this,arguments,void 0,function*({keyManager:e=new gl,options:r={}}={}){var n,s,i,o;if(r.algorithm&&r.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(r.verificationMethods&&r.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");const a=(o=(n=r.algorithm)!==null&&n!==void 0?n:(i=(s=r.verificationMethods)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.algorithm)!==null&&o!==void 0?o:"Ed25519",u=yield e.generateKey({algorithm:a}),l=yield e.getPublicKey({keyUri:u}),c=_t.object(l).toBase64Url(),d=`did:${B0.methodName}:${c}`,f=(yield B0.resolve(d)).didDocument;return new vf({uri:d,document:f,metadata:{},keyManager:e})})}static getSigningMethod(e){return Ab(this,arguments,void 0,function*({didDocument:r}){var n;const s=br.parse(r.id);if(s&&s.method!==this.methodName)throw new pt(ot.MethodNotSupported,`Method not supported: ${s.method}`);const[i]=(n=r.verificationMethod)!==null&&n!==void 0?n:[];if(!(i&&i.publicKeyJwk))throw new pt(ot.InternalError,"A verification method intended for signing could not be determined from the DID Document");return i})}static import(e){return Ab(this,arguments,void 0,function*({portableDid:r,keyManager:n=new gl}){const s=br.parse(r.uri);if((s==null?void 0:s.method)!==B0.methodName)throw new pt(ot.MethodNotSupported,"Method not supported");const i=yield vf.import({portableDid:r,keyManager:n});if(i.document.verificationMethod.length!==1)throw new pt(ot.InvalidDidDocument,"DID document must contain exactly one verification method");return i})}static resolve(e,r){return Ab(this,void 0,void 0,function*(){const n=br.parse(e);let s;try{s=_t.base64Url(n.id).toObject()}catch{}if(!n||!s)return Object.assign(Object.assign({},Ni),{didResolutionMetadata:{error:"invalidDid"}});if(n.method!==B0.methodName)return Object.assign(Object.assign({},Ni),{didResolutionMetadata:{error:"methodNotSupported"}});const i={"@context":["https://www.w3.org/ns/did/v1"],id:n.uri},o=`${i.id}#0`;switch(i.verificationMethod=[{id:o,type:"JsonWebKey",controller:i.id,publicKeyJwk:s}],i.authentication=[o],i.assertionMethod=[o],i.capabilityInvocation=[o],i.capabilityDelegation=[o],i.keyAgreement=[o],s.use){case"sig":{delete i.keyAgreement;break}case"enc":{delete i.authentication,delete i.assertionMethod,delete i.capabilityInvocation,delete i.capabilityDelegation;break}}return Object.assign(Object.assign({},Ni),{didDocument:i})})}};TK.methodName="jwk";var xa=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},Mc;(function(t){t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.secp256r1="secp256r1",t.X25519="X25519"})(Mc||(Mc={}));const IT={Ed25519VerificationKey2020:"https://w3id.org/security/suites/ed25519-2020/v1",JsonWebKey2020:"https://w3id.org/security/suites/jws-2020/v1",X25519KeyAgreementKey2020:"https://w3id.org/security/suites/x25519-2020/v1"},Ype={Ed25519:Mc.Ed25519,ES256K:Mc.secp256k1,ES256:Mc.secp256r1,"P-256":Mc.secp256r1,secp256k1:Mc.secp256k1,secp256r1:Mc.secp256r1,X25519:Mc.X25519};let DK=class Nc extends Vw{static create(){return xa(this,arguments,void 0,function*({keyManager:e=new gl,options:r={}}={}){var n,s,i,o;if(r.algorithm&&r.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(r.verificationMethods&&r.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");const a=(o=(n=r.algorithm)!==null&&n!==void 0?n:(i=(s=r.verificationMethods)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.algorithm)!==null&&o!==void 0?o:"Ed25519",u=yield e.generateKey({algorithm:a}),l=yield e.getPublicKey({keyUri:u}),c=yield Vo.publicKeyToMultibaseId({publicKey:l}),d=`did:${Nc.methodName}:${c}`,f=(yield Nc.resolve(d,r)).didDocument;return new vf({uri:d,document:f,metadata:{},keyManager:e})})}static getSigningMethod(e){return xa(this,arguments,void 0,function*({didDocument:r}){var n;const s=br.parse(r.id);if(s&&s.method!==this.methodName)throw new pt(ot.MethodNotSupported,`Method not supported: ${s.method}`);const[i]=r.assertionMethod||[],o=(n=r.verificationMethod)===null||n===void 0?void 0:n.find(a=>a.id===i);if(!(o&&o.publicKeyJwk))throw new pt(ot.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static import(e){return xa(this,arguments,void 0,function*({portableDid:r,keyManager:n=new gl}){const s=br.parse(r.uri);if((s==null?void 0:s.method)!==Nc.methodName)throw new pt(ot.MethodNotSupported,"Method not supported");const i=yield vf.import({portableDid:r,keyManager:n});if(i.document.verificationMethod.length!==1)throw new pt(ot.InvalidDidDocument,"DID document must contain exactly one verification method");return i})}static resolve(e,r){return xa(this,void 0,void 0,function*(){try{const n=yield Nc.createDocument({didUri:e,options:r});return Object.assign(Object.assign({},Ni),{didDocument:n})}catch(n){if(!(n instanceof pt))throw new Error(n);return Object.assign(Object.assign({},Ni),{didResolutionMetadata:Object.assign({error:n.code},n.message&&{errorMessage:n.message})})}})}static createDocument(e){return xa(this,arguments,void 0,function*({didUri:r,options:n={}}){const{defaultContext:s="https://www.w3.org/ns/did/v1",enableEncryptionKeyDerivation:i=!1,enableExperimentalPublicKeyTypes:o=!1,publicKeyFormat:a="JsonWebKey2020"}=n,u={id:""},l=br.parse(r);if(!l)throw new pt(ot.InvalidDid,`Invalid DID URI: ${r}`);const c=l.id;if(l.method!==Nc.methodName)throw new pt(ot.MethodNotSupported,`Method not supported: ${l.method}`);if(!Nc.validateIdentifier(l))throw new pt(ot.InvalidDid,`Invalid DID URI: ${r}`);const d=yield Nc.createSignatureMethod({didUri:r,multibaseValue:c,options:{enableExperimentalPublicKeyTypes:o,publicKeyFormat:a}});if(u.id=l.uri,u.verificationMethod=[d],u.authentication=[d.id],u.assertionMethod=[d.id],u.capabilityInvocation=[d.id],u.capabilityDelegation=[d.id],i===!0){const p=a==="Ed25519VerificationKey2020"?"X25519KeyAgreementKey2020":"JsonWebKey2020",m=yield this.createEncryptionMethod({didUri:r,multibaseValue:c,options:{enableExperimentalPublicKeyTypes:o,publicKeyFormat:p}});u.verificationMethod.push(m),u.keyAgreement=[m.id]}const h=[s];return Wpe({didDocument:u}).forEach(p=>{const m=IT[p];h.push(m)}),u["@context"]=h,u})}static createEncryptionMethod(e){return xa(this,arguments,void 0,function*({didUri:r,multibaseValue:n,options:s}){const{enableExperimentalPublicKeyTypes:i,publicKeyFormat:o}=s,a={id:"",type:"",controller:""},{keyBytes:u,multicodecCode:l}=yield Nc.deriveEncryptionKey({multibaseValue:n}),c=u.byteLength,d=Vo.MULTICODEC_PUBLIC_KEY_LENGTH[l];if(c!==d)throw new pt(ot.InvalidPublicKeyLength,`Expected ${c} bytes. Actual: ${d}`);const h=bK({keyBytes:u,multicodecCode:l});a.id=`${r}#${h}`;try{new URL(a.id)}catch{throw new pt(ot.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(o in IT))throw new pt(ot.UnsupportedPublicKeyType,`Unsupported format: ${o}`);if(i===!1&&!["Multikey","JsonWebKey2020","X25519KeyAgreementKey2020"].includes(o))throw new pt(ot.InvalidPublicKeyType,`Specified '${o}' without setting enableExperimentalPublicKeyTypes to true.`);if(a.type=o,a.controller=r,o==="X25519KeyAgreementKey2020"&&(a.publicKeyMultibase=h),o==="JsonWebKey2020"){const{crv:p}=yield Vo.multicodecToJwk({code:l});a.publicKeyJwk=yield Vo.keyConverter(p).bytesToPublicKey({publicKeyBytes:u})}return a})}static createSignatureMethod(e){return xa(this,arguments,void 0,function*({didUri:r,multibaseValue:n,options:s}){const{enableExperimentalPublicKeyTypes:i,publicKeyFormat:o}=s,a={id:"",type:"",controller:""},{keyBytes:u,multicodecCode:l,multicodecName:c}=IF({multibaseKeyId:n}),d=u.byteLength,h=Vo.MULTICODEC_PUBLIC_KEY_LENGTH[l];if(d!==h)throw new pt(ot.InvalidPublicKeyLength,`Expected ${d} bytes. Actual: ${h}`);let f=!1;switch(c){case"secp256k1-pub":f=yield ho.validatePublicKey({publicKeyBytes:u});break;case"ed25519-pub":f=yield Fs.validatePublicKey({publicKeyBytes:u});break;case"x25519-pub":f=!0;break}if(!f)throw new pt(ot.InvalidPublicKey,"Invalid public key detected.");a.id=`${r}#${n}`;try{new URL(a.id)}catch{throw new pt(ot.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(o in IT))throw new pt(ot.UnsupportedPublicKeyType,`Unsupported format: ${o}`);if(i===!1&&!["Multikey","JsonWebKey2020","Ed25519VerificationKey2020"].includes(o))throw new pt(ot.InvalidPublicKeyType,`Specified '${o}' without setting enableExperimentalPublicKeyTypes to true.`);if(a.type=o,a.controller=r,o==="Ed25519VerificationKey2020"&&(a.publicKeyMultibase=n),o==="JsonWebKey2020"){const{crv:m}=yield Vo.multicodecToJwk({code:l});a.publicKeyJwk=yield Vo.keyConverter(m).bytesToPublicKey({publicKeyBytes:u})}return a})}static deriveEncryptionKey(e){return xa(this,arguments,void 0,function*({multibaseValue:r}){let n={keyBytes:new Uint8Array,multicodecCode:0};const{keyBytes:s,multicodecCode:i}=IF({multibaseKeyId:r});if(i===237){const o=yield Vo.keyConverter("Ed25519").bytesToPublicKey({publicKeyBytes:s}),a=yield Fs.convertPublicKeyToX25519({publicKey:o});n={keyBytes:yield Vo.keyConverter("Ed25519").publicKeyToBytes({publicKey:a}),multicodecCode:236}}return n})}static validateIdentifier(e){const{method:r,id:n}=e,[s]=e.uri.split(":",1);return s==="did"&&r==="key"&&Number("1")>0&&iP(n)==="String"&&n.startsWith("z")}};DK.methodName="key";let Vo=class Dm{static jwkToMulticodec(e){return xa(this,arguments,void 0,function*({jwk:r}){const n=[];r.crv&&(n.push(r.crv),r.d?n.push("private"):n.push("public"));const s=n.join(":"),i=Dm.JWK_TO_MULTICODEC[s];if(i===void 0)throw new Error(`Unsupported JWK to Multicodec conversion: '${s}'`);return{code:ua.getCodeFromName({name:i}),name:i}})}static keyCompressor(e){const n={"P-256":Yo.compressPublicKey,secp256k1:ho.compressPublicKey}[e];if(!n)throw new pt(ot.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static keyConverter(e){const n={Ed25519:Fs,"P-256":Yo,secp256k1:ho,X25519:wK}[e];if(!n)throw new pt(ot.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static multicodecToJwk(e){return xa(this,arguments,void 0,function*({code:r,name:n}){if(!(n?!r:r))throw new Error("Either 'name' or 'code' must be defined, but not both.");n=n===void 0?ua.getNameFromCode({code:r}):n;const s=n,i=Dm.MULTICODEC_TO_JWK[s];if(i===void 0)throw new Error("Unsupported Multicodec to JWK conversion");return Object.assign({},i)})}static publicKeyToMultibaseId(e){return xa(this,arguments,void 0,function*({publicKey:r}){var n;if(!(r!=null&&r.crv&&r.crv in Ype))throw new pt(ot.InvalidPublicKeyType,`Public key contains an unsupported key type: ${(n=r==null?void 0:r.crv)!==null&&n!==void 0?n:"undefined"}`);let s=yield Dm.keyConverter(r.crv).publicKeyToBytes({publicKey:r});/^(secp256k1|P-256|P-384|P-521)$/.test(r.crv)&&(s=yield Dm.keyCompressor(r.crv)({publicKeyBytes:s}));const{name:i}=yield Dm.jwkToMulticodec({jwk:r});return bK({keyBytes:s,multicodecName:i})})}};Vo.JWK_TO_MULTICODEC={"Ed25519:public":"ed25519-pub","Ed25519:private":"ed25519-priv","secp256k1:public":"secp256k1-pub","secp256k1:private":"secp256k1-priv","X25519:public":"x25519-pub","X25519:private":"x25519-priv"};Vo.MULTICODEC_PUBLIC_KEY_LENGTH={231:33,236:32,237:32};Vo.MULTICODEC_TO_JWK={"ed25519-pub":{crv:"Ed25519",kty:"OKP",x:""},"ed25519-priv":{crv:"Ed25519",kty:"OKP",x:"",d:""},"secp256k1-pub":{crv:"secp256k1",kty:"EC",x:"",y:""},"secp256k1-priv":{crv:"secp256k1",kty:"EC",x:"",y:"",d:""},"x25519-pub":{crv:"X25519",kty:"OKP",x:""},"x25519-priv":{crv:"X25519",kty:"OKP",x:"",d:""}};var Zpe=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};let xK=class PK extends Vw{static resolve(e,r){return Zpe(this,void 0,void 0,function*(){const n=br.parse(e);if(!n)return Object.assign(Object.assign({},Ni),{didResolutionMetadata:{error:"invalidDid"}});if(n.method!==PK.methodName)return Object.assign(Object.assign({},Ni),{didResolutionMetadata:{error:"methodNotSupported"}});let s=`https://${n.id.replace(/:/g,"/")}`;s=decodeURIComponent(s);const i=n.id.includes(":")?`${s}/did.json`:`${s}/.well-known/did.json`;try{const o=yield fetch(i);if(!o.ok)throw new Error("HTTP error status code returned");const a=yield o.json();return Object.assign(Object.assign({},Ni),{didDocument:a})}catch{return Object.assign(Object.assign({},Ni),{didResolutionMetadata:{error:"notFound"}})}})}};xK.methodName="web";const Qpe={get:function(t){return null},set:function(t,e){return null},delete:function(t){return null},clear:function(){return null},close:function(){return null}};var FF=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};class eme{constructor({cache:e,didResolvers:r}){this.didResolvers=new Map,this.cache=e||Qpe;for(const n of r)this.didResolvers.set(n.methodName,n)}resolve(e,r){return FF(this,void 0,void 0,function*(){const n=br.parse(e);if(!n)return Object.assign(Object.assign({},Ni),{didResolutionMetadata:{error:ot.InvalidDid,errorMessage:`Invalid DID URI: ${e}`}});const s=this.didResolvers.get(n.method);if(!s)return Object.assign(Object.assign({},Ni),{didResolutionMetadata:{error:ot.MethodNotSupported,errorMessage:`Method not supported: ${n.method}`}});const i=yield this.cache.get(n.uri);if(i)return i;{const o=yield s.resolve(n.uri,r);return o.didResolutionMetadata.error||(yield this.cache.set(n.uri,o)),o}})}dereference(e,r){return FF(this,void 0,void 0,function*(){const n=br.parse(e);if(!n)return{dereferencingMetadata:{error:ot.InvalidDidUrl},contentStream:null,contentMetadata:{}};const{didDocument:s,didResolutionMetadata:i,didDocumentMetadata:o}=yield this.resolve(n.uri);if(!s)return{dereferencingMetadata:{error:i.error},contentStream:null,contentMetadata:{}};if(!n.fragment||n.query)return{dereferencingMetadata:{contentType:"application/did+json"},contentStream:s,contentMetadata:o};const{service:a=[],verificationMethod:u=[]}=s,l=new Set([e,n.fragment,`#${n.fragment}`]);let c;for(let d of u)if(l.has(d.id)){c=d;break}for(let d of a)if(l.has(d.id)){c=d;break}return c?{dereferencingMetadata:{contentType:"application/did+json"},contentStream:c,contentMetadata:i}:{dereferencingMetadata:{error:ot.NotFound},contentStream:null,contentMetadata:{}}})}}var MF=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};const tme=new Lhe;class Uu{static sign(e){return MF(this,void 0,void 0,function*(){const{signerDid:r,payload:n}=e,s=yield r.getSigner();let i=s.keyId;i.charAt(0)==="#"&&(i=`${r.uri}${i}`);const o={typ:"JWT",alg:s.algorithm,kid:i},a=Yl.object(o).toBase64Url(),u=Yl.object(n).toBase64Url(),l=`${a}.${u}`,c=Yl.string(l).toUint8Array(),d=yield s.sign({data:c}),h=Yl.uint8Array(d).toBase64Url();return`${l}.${h}`})}static verify(e){return MF(this,void 0,void 0,function*(){const{decoded:r,encoded:n}=Uu.parse({jwt:e.jwt});if(r.payload.exp&&Math.floor(Date.now()/1e3)>r.payload.exp)throw new Error("Verification failed: JWT is expired");const s=yield Uu.didResolver.dereference(r.header.kid);if(s.dereferencingMetadata.error)throw new Error(`Failed to resolve ${r.header.kid}`);const i=s.contentStream;if(!i||!NE(i))throw new Error("Verification failed: Expected kid in JWT header to dereference a DID Document Verification Method");const o=i.publicKeyJwk;if(!o)throw new Error("Verification failed: Expected kid in JWT header to dereference to a DID Document Verification Method with publicKeyJwk");if(o.alg&&o.alg!==r.header.alg)throw new Error("Verification failed: Expected alg in JWT header to match DID Document Verification Method alg");const a=`${n.header}.${n.payload}`,u=Yl.string(a).toUint8Array(),l=Yl.base64Url(n.signature).toUint8Array();if(!(yield tme.verify({key:o,signature:l,data:u})))throw new Error("Signature verification failed: Integrity mismatch");return r})}static parse(e){const r=e.jwt.split(".");if(r.length!==3)throw new Error(`Verification failed: Malformed JWT. expected 3 parts. got ${r.length}`);const[n,s,i]=r;let o,a;try{o=Yl.base64Url(n).toObject()}catch{throw new Error("Verification failed: Malformed JWT. Invalid base64url encoding for JWT header")}if(!o.typ||o.typ!=="JWT")throw new Error("Verification failed: Expected JWT header to contain typ property set to JWT");if(!o.alg||!o.kid)throw new Error("Verification failed: Expected JWT header to contain alg and kid");try{a=Yl.base64Url(s).toObject()}catch{throw new Error("Verification failed: Malformed JWT. Invalid base64url encoding for JWT payload")}return{decoded:{header:o,payload:a},encoded:{header:n,payload:s,signature:i}}}}Uu.didResolver=new eme({didResolvers:[BE,SK,DK,TK,xK]});const Be={INFO:"info",WARN:"warn",ERROR:"error"},FE=class{constructor(t,e,r){Se(this,"tag");Se(this,"status");Se(this,"message");this.tag=t,this.status=e,this.message=r}},rme=t=>{function e(r){return r.status===Be.ERROR}return t.filter(r=>e(r)).length>0};var Ey={},HI={},CK={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.parseDid=t.IProofType=t.IProofPurpose=void 0,function(n){n.verificationMethod="verificationMethod",n.assertionMethod="assertionMethod",n.authentication="authentication",n.keyAgreement="keyAgreement",n.contractAgreement="contactAgreement",n.capabilityInvocation="capabilityInvocation",n.capabilityDelegation="capabilityDelegation"}(t.IProofPurpose||(t.IProofPurpose={})),function(n){n.Ed25519Signature2018="Ed25519Signature2018",n.Ed25519Signature2020="Ed25519Signature2020",n.EcdsaSecp256k1Signature2019="EcdsaSecp256k1Signature2019",n.EcdsaSecp256k1RecoverySignature2020="EcdsaSecp256k1RecoverySignature2020",n.JsonWebSignature2020="JsonWebSignature2020",n.RsaSignature2018="RsaSignature2018",n.GpgSignature2020="GpgSignature2020",n.JcsEd25519Signature2020="JcsEd25519Signature2020",n.BbsBlsSignatureProof2020="BbsBlsSignatureProof2020",n.BbsBlsBoundSignatureProof2020="BbsBlsBoundSignatureProof2020",n.JwtProof2020="JwtProof2020"}(t.IProofType||(t.IProofType={}));const e=n=>{const s=r(n);if(s===null)throw new Error("invalid did");return s};t.parseDid=e;const r=n=>{const i="(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))",o="([a-z0-9]+)",a=`((?:${i}*:)*(${i}+))`,u="[a-zA-Z0-9_.:%-]",c=`((${`;${u}+=${u}*`})*)`,d="(/[^#?]*)?",h="([?][^#]*)?",f="(#.*)?",p=new RegExp(`^did:${o}:${a}${c}${d}${h}${f}$`);if(n===""||!n)return null;const m=n.match(p);if(m){const E={did:`did:${m[1]}:${m[2]}`,method:m[1],id:m[2],didUrl:n};if(m[4]){const A=m[4].slice(1).split(";");E.params={};for(const _ of A){const g=_.split("=");E.params[g[0]]=g[1]}}return m[6]&&(E.path=m[6]),m[7]&&(E.query=m[7].slice(1)),m[8]&&(E.fragment=m[8].slice(1)),E}return null}})(CK);var IK={};Object.defineProperty(IK,"__esModule",{value:!0});var kK={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.JWT_PROOF_TYPE_2020=t.DocumentFormat=t.OriginalType=void 0,function(e){e.JSONLD="json-ld",e.JWT_ENCODED="jwt-encoded",e.JWT_DECODED="jwt-decoded"}(t.OriginalType||(t.OriginalType={})),function(e){e[e.JWT=0]="JWT",e[e.JSONLD=1]="JSONLD",e[e.EIP712=2]="EIP712"}(t.DocumentFormat||(t.DocumentFormat={})),t.JWT_PROOF_TYPE_2020="JwtProof2020"})(kK);var $K={};Object.defineProperty($K,"__esModule",{value:!0});(function(t){var e=Ar&&Ar.__createBinding||(Object.create?function(n,s,i,o){o===void 0&&(o=i);var a=Object.getOwnPropertyDescriptor(s,i);(!a||("get"in a?!s.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return s[i]}}),Object.defineProperty(n,o,a)}:function(n,s,i,o){o===void 0&&(o=i),n[o]=s[i]}),r=Ar&&Ar.__exportStar||function(n,s){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(s,i)&&e(s,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(CK,t),r(IK,t),r(kK,t),r($K,t)})(HI);var zI={},yS={};Object.defineProperty(yS,"__esModule",{value:!0});yS.ObjectUtils=void 0;let nme=class OK{static asArray(e){return Array.isArray(e)?e:[e]}static isObject(e){return Object.prototype.toString.call(e)==="[object Object]"}static isUrlAbsolute(e){const r=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;OK.isString(e)&&r.test(e)}static isString(e){return typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"}};yS.ObjectUtils=nme;(function(t){var e=Ar&&Ar.__createBinding||(Object.create?function(n,s,i,o){o===void 0&&(o=i);var a=Object.getOwnPropertyDescriptor(s,i);(!a||("get"in a?!s.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return s[i]}}),Object.defineProperty(n,o,a)}:function(n,s,i,o){o===void 0&&(o=i),n[o]=s[i]}),r=Ar&&Ar.__exportStar||function(n,s){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(s,i)&&e(s,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(yS,t)})(zI);var RK={},gS={};function cP(t){this.message=t}cP.prototype=new Error,cP.prototype.name="InvalidCharacterError";var jF=typeof window<"u"&&window.atob&&window.atob.bind(window)||function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new cP("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,s=0,i=0,o="";n=e.charAt(i++);~n&&(r=s%4?64*r+n:n,s++%4)?o+=String.fromCharCode(255&r>>(-2*s&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return o};function ime(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return function(r){return decodeURIComponent(jF(r).replace(/(.)/g,function(n,s){var i=s.charCodeAt(0).toString(16).toUpperCase();return i.length<2&&(i="0"+i),"%"+i}))}(e)}catch{return jF(e)}}function Xv(t){this.message=t}function sme(t,e){if(typeof t!="string")throw new Xv("Invalid token specified");var r=(e=e||{}).header===!0?0:1;try{return JSON.parse(ime(t.split(".")[r]))}catch(n){throw new Xv("Invalid token specified: "+n.message)}}Xv.prototype=new Error,Xv.prototype.name="InvalidTokenError";const ome=Object.freeze(Object.defineProperty({__proto__:null,InvalidTokenError:Xv,default:sme},Symbol.toStringTag,{value:"Module"})),ame=Bte(ome);var UF=Ar&&Ar.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r},ume=Ar&&Ar.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(gS,"__esModule",{value:!0});gS.CredentialMapper=void 0;const nu=HI,cm=ume(ame),LF=zI;class Bt{static decodeVerifiablePresentation(e){var r;if(Bt.isJwtEncoded(e)){const n=(0,cm.default)(e),s=(0,cm.default)(e,{header:!0});return n.vp.proof={type:nu.IProofType.JwtProof2020,created:n.nbf,proofPurpose:nu.IProofPurpose.authentication,verificationMethod:(r=s.kid)!==null&&r!==void 0?r:n.iss,jwt:e},n}else return Bt.isJwtDecodedPresentation(e)?e:Bt.isJsonLdAsString(e)?JSON.parse(e):e}static decodeVerifiableCredential(e){var r;if(Bt.isJwtEncoded(e)){const n=(0,cm.default)(e),s=(0,cm.default)(e,{header:!0});return n.vc.proof={type:nu.IProofType.JwtProof2020,created:n.nbf,proofPurpose:nu.IProofPurpose.authentication,verificationMethod:(r=s.kid)!==null&&r!==void 0?r:n.iss,jwt:e},n}else return Bt.isJwtDecodedCredential(e)?e:Bt.isJsonLdAsString(e)?JSON.parse(e):e}static toWrappedVerifiablePresentation(e,r){const n=Bt.getFirstProof(e),s=typeof e!="string"&&Bt.hasJWTProofType(e)?n==null?void 0:n.jwt:e;if(!s)throw Error("Could not determine original presentation, probably it was a converted JWT presentation, that is now missing the JWT value in the proof");const i=Bt.decodeVerifiablePresentation(s),o=Bt.isJwtEncoded(s),a=Bt.isJwtDecodedPresentation(s),u=o?nu.OriginalType.JWT_ENCODED:a?nu.OriginalType.JWT_DECODED:nu.OriginalType.JSONLD,l=a||o?"jwt_vp":"ldp_vp";let c;if(o||a?c=Bt.jwtDecodedPresentationToUniformPresentation(i,!1,r):c=i,!c||!("verifiableCredential"in c)||!c.verifiableCredential||c.verifiableCredential.length===0)throw Error("VP needs to have at least one verifiable credential at this point");const d=Bt.toWrappedVerifiableCredentials(c.verifiableCredential,r),h=Object.assign(Object.assign({},c),{verifiableCredential:d});return{type:u,format:l,original:s,decoded:i,presentation:h,vcs:d}}static toWrappedVerifiableCredentials(e,r){return e.map(n=>Bt.toWrappedVerifiableCredential(n,r))}static toWrappedVerifiableCredential(e,r){var n;const s=Bt.getFirstProof(e),i=Bt.hasJWTProofType(e)&&s&&(n=s.jwt)!==null&&n!==void 0?n:e;if(!i)throw Error("Could not determine original credential, probably it was a converted JWT credential, that is now missing the JWT value in the proof");const o=Bt.decodeVerifiableCredential(i),a=Bt.isJwtEncoded(i),u=Bt.isJwtDecodedCredential(i),l=a?nu.OriginalType.JWT_ENCODED:u?nu.OriginalType.JWT_DECODED:nu.OriginalType.JSONLD,c=a||u?Bt.jwtDecodedCredentialToUniformCredential(o,r):o;return{original:i,decoded:o,format:a||u?"jwt_vc":"ldp_vc",type:l,credential:c}}static isJwtEncoded(e){return LF.ObjectUtils.isString(e)&&e.startsWith("ey")}static isJsonLdAsString(e){return LF.ObjectUtils.isString(e)&&e.includes("@context")}static isJwtDecodedCredential(e){return e.vc!==void 0&&e.iss!==void 0}static isJwtDecodedPresentation(e){return e.vp!==void 0&&e.iss!==void 0}static jwtEncodedPresentationToUniformPresentation(e,r=!0,n){return Bt.jwtDecodedPresentationToUniformPresentation((0,cm.default)(e),r,n)}static jwtDecodedPresentationToUniformPresentation(e,r=!0,n){const{iss:s,aud:i,jti:o,vp:a}=e,u=UF(e,["iss","aud","jti","vp"]),l=Object.assign(Object.assign({},u),a);if(r){if(!a.verifiableCredential)throw Error("Verifiable Presentation should have a verifiable credential at this point");l.verifiableCredential=a.verifiableCredential.map(c=>Bt.toUniformCredential(c,n))}if(s){const c=l.holder;if(c&&c!==s)throw new Error(`Inconsistent holders between JWT claim (${s}) and VC value (${c})`);l.holder=s}if(i){const c=l.verifier;if(c&&c!==i)throw new Error(`Inconsistent holders between JWT claim (${i}) and VC value (${c})`);l.verifier=i}if(o){const c=l.id;if(c&&c!==o)throw new Error(`Inconsistent VP ids between JWT claim (${o}) and VP value (${c})`);l.id=o}return l}static toUniformCredential(e,r){var n;const s=typeof e!="string"&&Bt.hasJWTProofType(e)?(n=Bt.getFirstProof(e))===null||n===void 0?void 0:n.jwt:e;if(!s)throw Error("Could not determine original credential from passed in credential. Probably because a JWT proof type was present, but now is not available anymore");const i=Bt.decodeVerifiableCredential(s),o=Bt.isJwtEncoded(s);return Bt.isJwtDecodedCredential(s)||o?Bt.jwtDecodedCredentialToUniformCredential(i,r):i}static toUniformPresentation(e,r){var n;const s=Bt.getFirstProof(e),i=typeof e!="string"&&Bt.hasJWTProofType(e)?s==null?void 0:s.jwt:e;if(!i)throw Error("Could not determine original presentation, probably it was a converted JWT presentation, that is now missing the JWT value in the proof");const o=Bt.decodeVerifiablePresentation(i),a=Bt.isJwtEncoded(i),u=Bt.isJwtDecodedPresentation(i),l=a||u?Bt.jwtDecodedPresentationToUniformPresentation(o,!1):o;return r!=null&&r.addContextIfMissing&&!l["@context"]&&(l["@context"]=["https://www.w3.org/2018/credentials/v1"]),l.verifiableCredential=(n=l.verifiableCredential)===null||n===void 0?void 0:n.map(c=>Bt.toUniformCredential(c,r)),l}static jwtEncodedCredentialToUniformCredential(e,r){return Bt.jwtDecodedCredentialToUniformCredential((0,cm.default)(e),r)}static jwtDecodedCredentialToUniformCredential(e,r){const{exp:n,nbf:s,iss:i,vc:o,sub:a,jti:u}=e,l=UF(e,["exp","nbf","iss","vc","sub","jti"]),c=Object.assign(Object.assign({},l),o),d=(r==null?void 0:r.maxTimeSkewInMS)!==void 0?r.maxTimeSkewInMS:999;if(n){const h=c.expirationDate,f=parseInt(n.toString()),p=f<9999999999?new Date(f*1e3).toISOString().replace(/\.000Z/,"Z"):new Date(f).toISOString();if(h&&h!==p){const m=Math.abs(new Date(p).getTime()-new Date(h).getTime());if(!d||m>d)throw new Error(`Inconsistent expiration dates between JWT claim (${p}) and VC value (${h})`)}c.expirationDate=p}if(s){const h=c.issuanceDate,f=parseInt(s.toString()),p=f<9999999999?new Date(f*1e3).toISOString().replace(/\.000Z/,"Z"):new Date(f).toISOString();if(h&&h!==p){const m=Math.abs(new Date(p).getTime()-new Date(h).getTime());if(!d||m>d)throw new Error(`Inconsistent issuance dates between JWT claim (${p}) and VC value (${h})`)}c.issuanceDate=p}if(i){const h=c.issuer;if(h){if(typeof h=="string"){if(h!==i)throw new Error(`Inconsistent issuers between JWT claim (${i}) and VC value (${h})`)}else if(h.id!==i)throw new Error(`Inconsistent issuers between JWT claim (${i}) and VC value (${h.id})`)}else c.issuer=i}if(a){const h=Array.isArray(c.credentialSubject)?c.credentialSubject:[c.credentialSubject];for(let f=0;f<h.length;f++){const p=h[f].id;if(p&&p!==a)throw new Error(`Inconsistent credential subject ids between JWT claim (${a}) and VC value (${p})`);Array.isArray(c.credentialSubject)?c.credentialSubject[f].id=a:c.credentialSubject.id=a}}if(u){const h=c.id;if(h&&h!==u)throw new Error(`Inconsistent credential ids between JWT claim (${u}) and VC value (${h})`);c.id=u}return c}static toExternalVerifiableCredential(e){let r;if(e.proof){if(!e.proof.type)throw new Error("Verifiable credential proof is missing a type");if(!e.proof.created)throw new Error("Verifiable credential proof is missing a created date");if(!e.proof.proofPurpose)throw new Error("Verifiable credential proof is missing a proof purpose");if(!e.proof.verificationMethod)throw new Error("Verifiable credential proof is missing a verification method");r=Object.assign(Object.assign({},e.proof),{type:e.proof.type,created:e.proof.created,proofPurpose:e.proof.proofPurpose,verificationMethod:e.proof.verificationMethod})}return Object.assign(Object.assign({},e),{type:e.type?typeof e.type=="string"?[e.type]:e.type:["VerifiableCredential"],proof:r})}static storedCredentialToOriginalFormat(e){const r=Bt.detectDocumentType(e);if(typeof e=="string"){if(r===0)return Bt.toCompactJWT(e);if(r===1)return JSON.parse(e)}return e}static storedPresentationToOriginalFormat(e){const r=Bt.detectDocumentType(e);if(typeof e=="string"){if(r===0)return Bt.toCompactJWT(e);if(r===1)return JSON.parse(e)}return e}static toCompactJWT(e){if(!e||Bt.detectDocumentType(e)!==0)throw Error("Cannot convert non JWT credential to JWT");if(typeof e=="string")return e;let r;if("vp"in e?r=e.vp.proof:"vc"in e?r=e.vc.proof:r=Array.isArray(e.proof)?e.proof[0].jwt:e.proof.jwt,!r)throw Error("Could not get JWT from supplied document");return r}static detectDocumentType(e){if(typeof e=="string")return this.isJsonLdAsString(e)?1:0;const r="vc"in e?e.vc.proof:"vp"in e?e.vp.proof:e.proof,n=Array.isArray(r)?r[0]:r;return n!=null&&n.jwt?0:(n==null?void 0:n.type)==="EthereumEip712Signature2021"?2:1}static hasJWTProofType(e){var r;return typeof e=="string"?!1:!!(!((r=Bt.getFirstProof(e))===null||r===void 0)&&r.jwt)}static getFirstProof(e){if(!e||typeof e=="string")return;const r="vc"in e?e.vc.proof:"vp"in e?e.vp.proof:e.proof;return Array.isArray(r)?r[0]:r}}gS.CredentialMapper=Bt;(function(t){var e=Ar&&Ar.__createBinding||(Object.create?function(n,s,i,o){o===void 0&&(o=i);var a=Object.getOwnPropertyDescriptor(s,i);(!a||("get"in a?!s.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return s[i]}}),Object.defineProperty(n,o,a)}:function(n,s,i,o){o===void 0&&(o=i),n[o]=s[i]}),r=Ar&&Ar.__exportStar||function(n,s){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(s,i)&&e(s,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(gS,t)})(RK);(function(t){var e=Ar&&Ar.__createBinding||(Object.create?function(n,s,i,o){o===void 0&&(o=i);var a=Object.getOwnPropertyDescriptor(s,i);(!a||("get"in a?!s.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return s[i]}}),Object.defineProperty(n,o,a)}:function(n,s,i,o){o===void 0&&(o=i),n[o]=s[i]}),r=Ar&&Ar.__exportStar||function(n,s){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(s,i)&&e(s,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(HI,t),r(zI,t),r(RK,t)})(Ey);var lP;(function(t){t.INPUT_CANDIDATE_DOESNT_CONTAIN_PROPERTY="Input candidate does not contain property",t.INPUT_CANDIDATE_FAILED_FILTER_EVALUATION="Input candidate failed filter evaluation",t.INPUT_CANDIDATE_IS_ELIGIBLE_FOR_PRESENTATION_SUBMISSION="The input candidate is eligible for submission",t.INPUT_CANDIDATE_IS_NOT_ELIGIBLE_FOR_PRESENTATION_SUBMISSION="The input candidate is not eligible for submission",t.INPUT_DESCRIPTOR_CONTEXT_CONTAINS_HASHLINK_VERIFICATION_NOT_SUPPORTED="Input descriptor contains hashlink. This version doesn't support hashlink verification.",t.LIMIT_DISCLOSURE_APPLIED="added variable in the limit_disclosure to the verifiableCredential",t.LIMIT_DISCLOSURE_NOT_SUPPORTED="Limit disclosure not supported",t.SUBJECT_IS_NOT_ISSUER="subject is not issuer",t.SUBJECT_IS_ISSUER="subject is issuer",t.FORMAT_RESTRICTION_PASSED="the Credential format of the candidate inputs matches the required formats",t.FORMAT_RESTRICTION_DIDNT_PASS="the Credential format of the candidate inputs didn't match the required formats",t.URI_EVALUATION_PASSED="@context URI(s) for the schema of the candidate input is equal to one of the input_descriptors object uri values.",t.URI_EVALUATION_DIDNT_PASS="@context URI for the of the candidate input MUST be equal to one of the input_descriptors object uri values exactly.",t.UNKNOWN_EXCEPTION="unknown exception occurred: ",t.VERIFIABLE_CREDENTIAL_MANDATORY_FIELD_NOT_PRESENT="mandatory field not present in the verifiableCredential"})(lP||(lP={}));const On=lP;var ze,Ga,NK,Td,He,WI,BK,Le,Ir,ye,Kt,er,Fr,Ie,Ve,ut,je;ze={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9};Ga={};Ga[ze.BooleanLiteral]="Boolean";Ga[ze.EOF]="<end>";Ga[ze.Identifier]="Identifier";Ga[ze.Keyword]="Keyword";Ga[ze.NullLiteral]="Null";Ga[ze.NumericLiteral]="Numeric";Ga[ze.Punctuator]="Punctuator";Ga[ze.StringLiteral]="String";Ga[ze.RegularExpression]="RegularExpression";NK=["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="];var yt={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement"};Td={Data:1,Get:2,Set:4};He={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"};WI={NonAsciiIdentifierStart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]"),NonAsciiIdentifierPart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮ̀-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁ҃-҇Ҋ-ԧԱ-Ֆՙա-և֑-ׇֽֿׁׂׅׄא-תװ-ײؐ-ؚؠ-٩ٮ-ۓە-ۜ۟-۪ۨ-ۼۿܐ-݊ݍ-ޱ߀-ߵߺࠀ-࠭ࡀ-࡛ࢠࢢ-ࢬࣤ-ࣾऀ-ॣ०-९ॱ-ॷॹ-ॿঁ-ঃঅ-ঌএঐও-নপ-রলশ-হ়-ৄেৈো-ৎৗড়ঢ়য়-ৣ০-ৱਁ-ਃਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹ਼ਾ-ੂੇੈੋ-੍ੑਖ਼-ੜਫ਼੦-ੵઁ-ઃઅ-ઍએ-ઑઓ-નપ-રલળવ-હ઼-ૅે-ૉો-્ૐૠ-ૣ૦-૯ଁ-ଃଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହ଼-ୄେୈୋ-୍ୖୗଡ଼ଢ଼ୟ-ୣ୦-୯ୱஂஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹா-ூெ-ைொ-்ௐௗ௦-௯ఁ-ఃఅ-ఌఎ-ఐఒ-నప-ళవ-హఽ-ౄె-ైొ-్ౕౖౘౙౠ-ౣ౦-౯ಂಃಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹ಼-ೄೆ-ೈೊ-್ೕೖೞೠ-ೣ೦-೯ೱೲംഃഅ-ഌഎ-ഐഒ-ഺഽ-ൄെ-ൈൊ-ൎൗൠ-ൣ൦-൯ൺ-ൿංඃඅ-ඖක-නඳ-රලව-ෆ්ා-ුූෘ-ෟෲෳก-ฺเ-๎๐-๙ກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ູົ-ຽເ-ໄໆ່-ໍ໐-໙ໜ-ໟༀ༘༙༠-༩༹༵༷༾-ཇཉ-ཬཱ-྄྆-ྗྙ-ྼ࿆က-၉ၐ-ႝႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚ፝-፟ᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-᜔ᜠ-᜴ᝀ-ᝓᝠ-ᝬᝮ-ᝰᝲᝳក-៓ៗៜ៝០-៩᠋-᠍᠐-᠙ᠠ-ᡷᢀ-ᢪᢰ-ᣵᤀ-ᤜᤠ-ᤫᤰ-᤻᥆-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉ᧐-᧙ᨀ-ᨛᨠ-ᩞ᩠-᩿᩼-᪉᪐-᪙ᪧᬀ-ᭋ᭐-᭙᭫-᭳ᮀ-᯳ᰀ-᰷᱀-᱉ᱍ-ᱽ᳐-᳔᳒-ᳶᴀ-ᷦ᷼-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼ‌‍‿⁀⁔ⁱⁿₐ-ₜ⃐-⃥⃜⃡-⃰ℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯ⵿-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⷠ-ⷿⸯ々-〇〡-〯〱-〵〸-〼ぁ-ゖ゙゚ゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘫꙀ-꙯ꙴ-꙽ꙿ-ꚗꚟ-꛱ꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠧꡀ-ꡳꢀ-꣄꣐-꣙꣠-ꣷꣻ꤀-꤭ꤰ-꥓ꥠ-ꥼꦀ-꧀ꧏ-꧙ꨀ-ꨶꩀ-ꩍ꩐-꩙ꩠ-ꩶꩺꩻꪀ-ꫂꫛ-ꫝꫠ-ꫯꫲ-꫶ꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯪ꯬꯭꯰-꯹가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻ︀-️︠-︦︳︴﹍-﹏ﹰ-ﹴﹶ-ﻼ０-９Ａ-Ｚ＿ａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]")};function qw(t,e){if(!t)throw new Error("ASSERT: "+e)}function qc(t){return t>=48&&t<=57}function FK(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function iv(t){return"01234567".indexOf(t)>=0}function cme(t){return t===32||t===9||t===11||t===12||t===160||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function wp(t){return t===10||t===13||t===8232||t===8233}function zy(t){return t==64||t===36||t===95||t>=65&&t<=90||t>=97&&t<=122||t===92||t>=128&&WI.NonAsciiIdentifierStart.test(String.fromCharCode(t))}function ME(t){return t===36||t===95||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||t===92||t>=128&&WI.NonAsciiIdentifierPart.test(String.fromCharCode(t))}function lme(t){switch(t){case"class":case"enum":case"export":case"extends":case"import":case"super":return!0;default:return!1}}function Hw(t){switch(t){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}}function ca(t){return t==="eval"||t==="arguments"}function dme(t){if(Ir&&Hw(t))return!0;switch(t.length){case 2:return t==="if"||t==="in"||t==="do";case 3:return t==="var"||t==="for"||t==="new"||t==="try"||t==="let";case 4:return t==="this"||t==="else"||t==="case"||t==="void"||t==="with"||t==="enum";case 5:return t==="while"||t==="break"||t==="catch"||t==="throw"||t==="const"||t==="yield"||t==="class"||t==="super";case 6:return t==="return"||t==="typeof"||t==="delete"||t==="switch"||t==="export"||t==="import";case 7:return t==="default"||t==="finally"||t==="extends";case 8:return t==="function"||t==="continue"||t==="debugger";case 10:return t==="instanceof";default:return!1}}function dP(t,e,r,n,s){var i;qw(typeof r=="number","Comment must have valid position"),!(ut.lastCommentStart>=r)&&(ut.lastCommentStart=r,i={type:t,value:e},je.range&&(i.range=[r,n]),je.loc&&(i.loc=s),je.comments.push(i),je.attachComment&&(je.leadingComments.push(i),je.trailingComments.push(i)))}function kT(t){var e,r,n,s;for(e=ye-t,r={start:{line:Kt,column:ye-er-t}};ye<Fr;)if(n=Le.charCodeAt(ye),++ye,wp(n)){je.comments&&(s=Le.slice(e+t,ye-1),r.end={line:Kt,column:ye-er-1},dP("Line",s,e,ye-1,r)),n===13&&Le.charCodeAt(ye)===10&&++ye,++Kt,er=ye;return}je.comments&&(s=Le.slice(e+t,ye),r.end={line:Kt,column:ye-er},dP("Line",s,e,ye,r))}function fme(){var t,e,r,n;for(je.comments&&(t=ye-2,e={start:{line:Kt,column:ye-er-2}});ye<Fr;)if(r=Le.charCodeAt(ye),wp(r))r===13&&Le.charCodeAt(ye+1)===10&&++ye,++Kt,++ye,er=ye,ye>=Fr&&Ht({},He.UnexpectedToken,"ILLEGAL");else if(r===42){if(Le.charCodeAt(ye+1)===47){++ye,++ye,je.comments&&(n=Le.slice(t+2,ye-2),e.end={line:Kt,column:ye-er},dP("Block",n,t,ye,e));return}++ye}else++ye;Ht({},He.UnexpectedToken,"ILLEGAL")}function $f(){var t,e;for(e=ye===0;ye<Fr;)if(t=Le.charCodeAt(ye),cme(t))++ye;else if(wp(t))++ye,t===13&&Le.charCodeAt(ye)===10&&++ye,++Kt,er=ye,e=!0;else if(t===47)if(t=Le.charCodeAt(ye+1),t===47)++ye,++ye,kT(2),e=!0;else if(t===42)++ye,++ye,fme();else break;else if(e&&t===45)if(Le.charCodeAt(ye+1)===45&&Le.charCodeAt(ye+2)===62)ye+=3,kT(3);else break;else if(t===60)if(Le.slice(ye+1,ye+4)==="!--")++ye,++ye,++ye,++ye,kT(4);else break;else break}function jE(t){var e,r,n,s=0;for(r=t==="u"?4:2,e=0;e<r;++e)if(ye<Fr&&FK(Le[ye]))n=Le[ye++],s=s*16+"0123456789abcdef".indexOf(n.toLowerCase());else return"";return String.fromCharCode(s)}function MK(){var t,e;for(t=Le.charCodeAt(ye++),e=String.fromCharCode(t),t===92&&(Le.charCodeAt(ye)!==117&&Ht({},He.UnexpectedToken,"ILLEGAL"),++ye,t=jE("u"),(!t||t==="\\"||!zy(t.charCodeAt(0)))&&Ht({},He.UnexpectedToken,"ILLEGAL"),e=t);ye<Fr&&(t=Le.charCodeAt(ye),!!ME(t));)++ye,e+=String.fromCharCode(t),t===92&&(e=e.substr(0,e.length-1),Le.charCodeAt(ye)!==117&&Ht({},He.UnexpectedToken,"ILLEGAL"),++ye,t=jE("u"),(!t||t==="\\"||!ME(t.charCodeAt(0)))&&Ht({},He.UnexpectedToken,"ILLEGAL"),e+=t);return e}function hme(){var t,e;for(t=ye++;ye<Fr;){if(e=Le.charCodeAt(ye),e===92)return ye=t,MK();if(ME(e))++ye;else break}return Le.slice(t,ye)}function pme(){var t,e,r;return t=ye,e=Le.charCodeAt(ye)===92?MK():hme(),e.length===1?r=ze.Identifier:dme(e)?r=ze.Keyword:e==="null"?r=ze.NullLiteral:e==="true"||e==="false"?r=ze.BooleanLiteral:r=ze.Identifier,{type:r,value:e,lineNumber:Kt,lineStart:er,start:t,end:ye}}function Hc(){var t=ye,e=Le.charCodeAt(ye),r,n=Le[ye],s,i,o;switch(e){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++ye,je.tokenize&&(e===40?je.openParenToken=je.tokens.length:e===123&&(je.openCurlyToken=je.tokens.length)),{type:ze.Punctuator,value:String.fromCharCode(e),lineNumber:Kt,lineStart:er,start:t,end:ye};default:if(r=Le.charCodeAt(ye+1),r===61)switch(e){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return ye+=2,{type:ze.Punctuator,value:String.fromCharCode(e)+String.fromCharCode(r),lineNumber:Kt,lineStart:er,start:t,end:ye};case 33:case 61:return ye+=2,Le.charCodeAt(ye)===61&&++ye,{type:ze.Punctuator,value:Le.slice(t,ye),lineNumber:Kt,lineStart:er,start:t,end:ye}}}if(o=Le.substr(ye,4),o===">>>=")return ye+=4,{type:ze.Punctuator,value:o,lineNumber:Kt,lineStart:er,start:t,end:ye};if(i=o.substr(0,3),i===">>>"||i==="<<="||i===">>=")return ye+=3,{type:ze.Punctuator,value:i,lineNumber:Kt,lineStart:er,start:t,end:ye};if(s=i.substr(0,2),n===s[1]&&"+-<>&|".indexOf(n)>=0||s==="=>")return ye+=2,{type:ze.Punctuator,value:s,lineNumber:Kt,lineStart:er,start:t,end:ye};if("<>=!+-*%&|^/".indexOf(n)>=0)return++ye,{type:ze.Punctuator,value:n,lineNumber:Kt,lineStart:er,start:t,end:ye};Ht({},He.UnexpectedToken,"ILLEGAL")}function mme(t){for(var e="";ye<Fr&&FK(Le[ye]);)e+=Le[ye++];return e.length===0&&Ht({},He.UnexpectedToken,"ILLEGAL"),zy(Le.charCodeAt(ye))&&Ht({},He.UnexpectedToken,"ILLEGAL"),{type:ze.NumericLiteral,value:parseInt("0x"+e,16),lineNumber:Kt,lineStart:er,start:t,end:ye}}function yme(t){for(var e="0"+Le[ye++];ye<Fr&&iv(Le[ye]);)e+=Le[ye++];return(zy(Le.charCodeAt(ye))||qc(Le.charCodeAt(ye)))&&Ht({},He.UnexpectedToken,"ILLEGAL"),{type:ze.NumericLiteral,value:parseInt(e,8),octal:!0,lineNumber:Kt,lineStart:er,start:t,end:ye}}function KF(){var t,e,r;if(r=Le[ye],qw(qc(r.charCodeAt(0))||r===".","Numeric literal must start with a decimal digit or a decimal point"),e=ye,t="",r!=="."){if(t=Le[ye++],r=Le[ye],t==="0"){if(r==="x"||r==="X")return++ye,mme(e);if(iv(r))return yme(e);r&&qc(r.charCodeAt(0))&&Ht({},He.UnexpectedToken,"ILLEGAL")}for(;qc(Le.charCodeAt(ye));)t+=Le[ye++];r=Le[ye]}if(r==="."){for(t+=Le[ye++];qc(Le.charCodeAt(ye));)t+=Le[ye++];r=Le[ye]}if(r==="e"||r==="E")if(t+=Le[ye++],r=Le[ye],(r==="+"||r==="-")&&(t+=Le[ye++]),qc(Le.charCodeAt(ye)))for(;qc(Le.charCodeAt(ye));)t+=Le[ye++];else Ht({},He.UnexpectedToken,"ILLEGAL");return zy(Le.charCodeAt(ye))&&Ht({},He.UnexpectedToken,"ILLEGAL"),{type:ze.NumericLiteral,value:parseFloat(t),lineNumber:Kt,lineStart:er,start:e,end:ye}}function gme(){var t="",e,r,n,s,i,o,a=!1,u,l;for(u=Kt,l=er,e=Le[ye],qw(e==="'"||e==='"',"String literal must starts with a quote"),r=ye,++ye;ye<Fr;)if(n=Le[ye++],n===e){e="";break}else if(n==="\\")if(n=Le[ye++],!n||!wp(n.charCodeAt(0)))switch(n){case"u":case"x":o=ye,i=jE(n),i?t+=i:(ye=o,t+=n);break;case"n":t+=`
`;break;case"r":t+="\r";break;case"t":t+="	";break;case"b":t+="\b";break;case"f":t+="\f";break;case"v":t+="\v";break;default:iv(n)?(s="01234567".indexOf(n),s!==0&&(a=!0),ye<Fr&&iv(Le[ye])&&(a=!0,s=s*8+"01234567".indexOf(Le[ye++]),"0123".indexOf(n)>=0&&ye<Fr&&iv(Le[ye])&&(s=s*8+"01234567".indexOf(Le[ye++]))),t+=String.fromCharCode(s)):t+=n;break}else++Kt,n==="\r"&&Le[ye]===`
`&&++ye,er=ye;else{if(wp(n.charCodeAt(0)))break;t+=n}return e!==""&&Ht({},He.UnexpectedToken,"ILLEGAL"),{type:ze.StringLiteral,value:t,octal:a,startLineNumber:u,startLineStart:l,lineNumber:Kt,lineStart:er,start:r,end:ye}}function vme(t,e){var r;try{r=new RegExp(t,e)}catch{Ht({},He.InvalidRegExp)}return r}function wme(){var t,e,r,n,s;for(t=Le[ye],qw(t==="/","Regular expression literal must start with a slash"),e=Le[ye++],r=!1,n=!1;ye<Fr;)if(t=Le[ye++],e+=t,t==="\\")t=Le[ye++],wp(t.charCodeAt(0))&&Ht({},He.UnterminatedRegExp),e+=t;else if(wp(t.charCodeAt(0)))Ht({},He.UnterminatedRegExp);else if(r)t==="]"&&(r=!1);else if(t==="/"){n=!0;break}else t==="["&&(r=!0);return n||Ht({},He.UnterminatedRegExp),s=e.substr(1,e.length-2),{value:s,literal:e}}function _me(){var t,e,r,n;for(e="",r="";ye<Fr&&(t=Le[ye],!!ME(t.charCodeAt(0)));)if(++ye,t==="\\"&&ye<Fr)if(t=Le[ye],t==="u"){if(++ye,n=ye,t=jE("u"),t)for(r+=t,e+="\\u";n<ye;++n)e+=Le[n];else ye=n,r+="u",e+="\\u";kr({},He.UnexpectedToken,"ILLEGAL")}else e+="\\",kr({},He.UnexpectedToken,"ILLEGAL");else r+=t,e+=t;return{value:r,literal:e}}function jK(){var t,e,r,n;return Ve=null,$f(),t=ye,e=wme(),r=_me(),n=vme(e.value,r.value),je.tokenize?{type:ze.RegularExpression,value:n,lineNumber:Kt,lineStart:er,start:t,end:ye}:{literal:e.literal+r.literal,value:n,start:t,end:ye}}function _h(){var t,e,r,n;return $f(),t=ye,e={start:{line:Kt,column:ye-er}},r=jK(),e.end={line:Kt,column:ye-er},je.tokenize||(je.tokens.length>0&&(n=je.tokens[je.tokens.length-1],n.range[0]===t&&n.type==="Punctuator"&&(n.value==="/"||n.value==="/=")&&je.tokens.pop()),je.tokens.push({type:"RegularExpression",value:r.literal,range:[t,ye],loc:e})),r}function bme(t){return t.type===ze.Identifier||t.type===ze.Keyword||t.type===ze.BooleanLiteral||t.type===ze.NullLiteral}function Eme(){var t,e;if(t=je.tokens[je.tokens.length-1],!t)return _h();if(t.type==="Punctuator"){if(t.value==="]")return Hc();if(t.value===")")return e=je.tokens[je.openParenToken-1],e&&e.type==="Keyword"&&(e.value==="if"||e.value==="while"||e.value==="for"||e.value==="with")?_h():Hc();if(t.value==="}"){if(je.tokens[je.openCurlyToken-3]&&je.tokens[je.openCurlyToken-3].type==="Keyword"){if(e=je.tokens[je.openCurlyToken-4],!e)return Hc()}else if(je.tokens[je.openCurlyToken-4]&&je.tokens[je.openCurlyToken-4].type==="Keyword"){if(e=je.tokens[je.openCurlyToken-5],!e)return _h()}else return Hc();return NK.indexOf(e.value)>=0?Hc():_h()}return _h()}return t.type==="Keyword"?_h():Hc()}function GI(){var t;return $f(),ye>=Fr?{type:ze.EOF,lineNumber:Kt,lineStart:er,start:ye,end:ye}:(t=Le.charCodeAt(ye),zy(t)?pme():t===40||t===41||t===59?Hc():t===39||t===34?gme():t===46?qc(Le.charCodeAt(ye+1))?KF():Hc():qc(t)?KF():je.tokenize&&t===47?Eme():Hc())}function UK(){var t,e,r;return $f(),t={start:{line:Kt,column:ye-er}},e=GI(),t.end={line:Kt,column:ye-er},e.type!==ze.EOF&&(r=Le.slice(e.start,e.end),je.tokens.push({type:Ga[e.type],value:r,range:[e.start,e.end],loc:t})),e}function tr(){var t;return t=Ve,ye=t.end,Kt=t.lineNumber,er=t.lineStart,Ve=typeof je.tokens<"u"?UK():GI(),ye=t.end,Kt=t.lineNumber,er=t.lineStart,t}function LK(){var t,e,r;t=ye,e=Kt,r=er,Ve=typeof je.tokens<"u"?UK():GI(),ye=t,Kt=e,er=r}function VF(t,e){this.line=t,this.column=e}function Ame(t,e,r,n){this.start=new VF(t,e),this.end=new VF(r,n)}BK={name:"SyntaxTree",processComment:function(t){var e,r;if(!(t.type===yt.Program&&t.body.length>0)){for(je.trailingComments.length>0?je.trailingComments[0].range[0]>=t.range[1]?(r=je.trailingComments,je.trailingComments=[]):je.trailingComments.length=0:je.bottomRightStack.length>0&&je.bottomRightStack[je.bottomRightStack.length-1].trailingComments&&je.bottomRightStack[je.bottomRightStack.length-1].trailingComments[0].range[0]>=t.range[1]&&(r=je.bottomRightStack[je.bottomRightStack.length-1].trailingComments,delete je.bottomRightStack[je.bottomRightStack.length-1].trailingComments);je.bottomRightStack.length>0&&je.bottomRightStack[je.bottomRightStack.length-1].range[0]>=t.range[0];)e=je.bottomRightStack.pop();e?e.leadingComments&&e.leadingComments[e.leadingComments.length-1].range[1]<=t.range[0]&&(t.leadingComments=e.leadingComments,delete e.leadingComments):je.leadingComments.length>0&&je.leadingComments[je.leadingComments.length-1].range[1]<=t.range[0]&&(t.leadingComments=je.leadingComments,je.leadingComments=[]),r&&(t.trailingComments=r),je.bottomRightStack.push(t)}},markEnd:function(t,e){return je.range&&(t.range=[e.start,ye]),je.loc&&(t.loc=new Ame(e.startLineNumber===void 0?e.lineNumber:e.startLineNumber,e.start-(e.startLineStart===void 0?e.lineStart:e.startLineStart),Kt,ye-er),this.postProcess(t)),je.attachComment&&this.processComment(t),t},postProcess:function(t){return je.source&&(t.loc.source=je.source),t},createArrayExpression:function(t){return{type:yt.ArrayExpression,elements:t}},createAssignmentExpression:function(t,e,r){return{type:yt.AssignmentExpression,operator:t,left:e,right:r}},createBinaryExpression:function(t,e,r){var n=t==="||"||t==="&&"?yt.LogicalExpression:yt.BinaryExpression;return{type:n,operator:t,left:e,right:r}},createBlockStatement:function(t){return{type:yt.BlockStatement,body:t}},createBreakStatement:function(t){return{type:yt.BreakStatement,label:t}},createCallExpression:function(t,e){return{type:yt.CallExpression,callee:t,arguments:e}},createCatchClause:function(t,e){return{type:yt.CatchClause,param:t,body:e}},createConditionalExpression:function(t,e,r){return{type:yt.ConditionalExpression,test:t,consequent:e,alternate:r}},createContinueStatement:function(t){return{type:yt.ContinueStatement,label:t}},createDebuggerStatement:function(){return{type:yt.DebuggerStatement}},createDoWhileStatement:function(t,e){return{type:yt.DoWhileStatement,body:t,test:e}},createEmptyStatement:function(){return{type:yt.EmptyStatement}},createExpressionStatement:function(t){return{type:yt.ExpressionStatement,expression:t}},createForStatement:function(t,e,r,n){return{type:yt.ForStatement,init:t,test:e,update:r,body:n}},createForInStatement:function(t,e,r){return{type:yt.ForInStatement,left:t,right:e,body:r,each:!1}},createFunctionDeclaration:function(t,e,r,n){return{type:yt.FunctionDeclaration,id:t,params:e,defaults:r,body:n,rest:null,generator:!1,expression:!1}},createFunctionExpression:function(t,e,r,n){return{type:yt.FunctionExpression,id:t,params:e,defaults:r,body:n,rest:null,generator:!1,expression:!1}},createIdentifier:function(t){return{type:yt.Identifier,name:t}},createIfStatement:function(t,e,r){return{type:yt.IfStatement,test:t,consequent:e,alternate:r}},createLabeledStatement:function(t,e){return{type:yt.LabeledStatement,label:t,body:e}},createLiteral:function(t){return{type:yt.Literal,value:t.value,raw:Le.slice(t.start,t.end)}},createMemberExpression:function(t,e,r){return{type:yt.MemberExpression,computed:t==="[",object:e,property:r}},createNewExpression:function(t,e){return{type:yt.NewExpression,callee:t,arguments:e}},createObjectExpression:function(t){return{type:yt.ObjectExpression,properties:t}},createPostfixExpression:function(t,e){return{type:yt.UpdateExpression,operator:t,argument:e,prefix:!1}},createProgram:function(t){return{type:yt.Program,body:t}},createProperty:function(t,e,r){return{type:yt.Property,key:e,value:r,kind:t}},createReturnStatement:function(t){return{type:yt.ReturnStatement,argument:t}},createSequenceExpression:function(t){return{type:yt.SequenceExpression,expressions:t}},createSwitchCase:function(t,e){return{type:yt.SwitchCase,test:t,consequent:e}},createSwitchStatement:function(t,e){return{type:yt.SwitchStatement,discriminant:t,cases:e}},createThisExpression:function(){return{type:yt.ThisExpression}},createThrowStatement:function(t){return{type:yt.ThrowStatement,argument:t}},createTryStatement:function(t,e,r,n){return{type:yt.TryStatement,block:t,guardedHandlers:e,handlers:r,finalizer:n}},createUnaryExpression:function(t,e){return t==="++"||t==="--"?{type:yt.UpdateExpression,operator:t,argument:e,prefix:!0}:{type:yt.UnaryExpression,operator:t,argument:e,prefix:!0}},createVariableDeclaration:function(t,e){return{type:yt.VariableDeclaration,declarations:t,kind:e}},createVariableDeclarator:function(t,e){return{type:yt.VariableDeclarator,id:t,init:e}},createWhileStatement:function(t,e){return{type:yt.WhileStatement,test:t,body:e}},createWithStatement:function(t,e){return{type:yt.WithStatement,object:t,body:e}}};function zw(){var t,e,r,n;return t=ye,e=Kt,r=er,$f(),n=Kt!==e,ye=t,Kt=e,er=r,n}function Ht(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var s,i=e.replace(/%(\d)/g,function(o,a){return qw(a<r.length,"Message reference must be in range"),r[a]});throw typeof t.lineNumber=="number"?(s=new Error("Line "+t.lineNumber+": "+i),s.index=t.start,s.lineNumber=t.lineNumber,s.column=t.start-er+1):(s=new Error("Line "+Kt+": "+i),s.index=ye,s.lineNumber=Kt,s.column=ye-er+1),s.description=i,s}function kr(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{Ht.apply(null,t)}catch(r){if(je.errors)je.errors.push(r);else throw r}}function Xu(t){if(t.type===ze.EOF&&Ht(t,He.UnexpectedEOS),t.type===ze.NumericLiteral&&Ht(t,He.UnexpectedNumber),t.type===ze.StringLiteral&&Ht(t,He.UnexpectedString),t.type===ze.Identifier&&Ht(t,He.UnexpectedIdentifier),t.type===ze.Keyword){if(lme(t.value))Ht(t,He.UnexpectedReserved);else if(Ir&&Hw(t.value)){kr(t,He.StrictReservedWord);return}Ht(t,He.UnexpectedToken,t.value)}Ht(t,He.UnexpectedToken,t.value)}function Tt(t){var e=tr();(e.type!==ze.Punctuator||e.value!==t)&&Xu(e)}function Nn(t){var e=tr();(e.type!==ze.Keyword||e.value!==t)&&Xu(e)}function gt(t){return Ve.type===ze.Punctuator&&Ve.value===t}function Bi(t){return Ve.type===ze.Keyword&&Ve.value===t}function Sme(){var t;return Ve.type!==ze.Punctuator?!1:(t=Ve.value,t==="="||t==="*="||t==="/="||t==="%="||t==="+="||t==="-="||t==="<<="||t===">>="||t===">>>="||t==="&="||t==="^="||t==="|=")}function Yu(){var t;if(Le.charCodeAt(ye)===59||gt(";")){tr();return}t=Kt,$f(),Kt===t&&Ve.type!==ze.EOF&&!gt("}")&&Xu(Ve)}function vS(t){return t.type===yt.Identifier||t.type===yt.MemberExpression}function Tme(){var t=[],e;for(e=Ve,Tt("[");!gt("]");)gt(",")?(tr(),t.push(null)):(t.push(za()),gt("]")||Tt(","));return tr(),Ie.markEnd(Ie.createArrayExpression(t),e)}function $T(t,e){var r,n,s;return r=Ir,s=Ve,n=XI(),e&&Ir&&ca(t[0].name)&&kr(e,He.StrictParamName),Ir=r,Ie.markEnd(Ie.createFunctionExpression(null,t,[],n),s)}function Sb(){var t,e;return e=Ve,t=tr(),t.type===ze.StringLiteral||t.type===ze.NumericLiteral?(Ir&&t.octal&&kr(t,He.StrictOctalLiteral),Ie.markEnd(Ie.createLiteral(t),e)):Ie.markEnd(Ie.createIdentifier(t.value),e)}function Dme(){var t,e,r,n,s,i;if(t=Ve,i=Ve,t.type===ze.Identifier)return r=Sb(),t.value==="get"&&!gt(":")?(e=Sb(),Tt("("),Tt(")"),n=$T([]),Ie.markEnd(Ie.createProperty("get",e,n),i)):t.value==="set"&&!gt(":")?(e=Sb(),Tt("("),t=Ve,t.type!==ze.Identifier?(Tt(")"),kr(t,He.UnexpectedToken,t.value),n=$T([])):(s=[Of()],Tt(")"),n=$T(s,t)),Ie.markEnd(Ie.createProperty("set",e,n),i)):(Tt(":"),n=za(),Ie.markEnd(Ie.createProperty("init",r,n),i));if(t.type===ze.EOF||t.type===ze.Punctuator)Xu(t);else return e=Sb(),Tt(":"),n=za(),Ie.markEnd(Ie.createProperty("init",e,n),i)}function xme(){var t=[],e,r,n,s,i={},o=String,a;for(a=Ve,Tt("{");!gt("}");)e=Dme(),e.key.type===yt.Identifier?r=e.key.name:r=o(e.key.value),s=e.kind==="init"?Td.Data:e.kind==="get"?Td.Get:Td.Set,n="$"+r,Object.prototype.hasOwnProperty.call(i,n)?(i[n]===Td.Data?Ir&&s===Td.Data?kr({},He.StrictDuplicateProperty):s!==Td.Data&&kr({},He.AccessorDataProperty):s===Td.Data?kr({},He.AccessorDataProperty):i[n]&s&&kr({},He.AccessorGetSet),i[n]|=s):i[n]=s,t.push(e),gt("}")||Tt(",");return Tt("}"),Ie.markEnd(Ie.createObjectExpression(t),a)}function Pme(){var t;return Tt("("),t=oi(),Tt(")"),t}function KK(){var t,e,r,n;if(gt("("))return Pme();if(gt("["))return Tme();if(gt("{"))return xme();if(t=Ve.type,n=Ve,t===ze.Identifier)r=Ie.createIdentifier(tr().value);else if(t===ze.StringLiteral||t===ze.NumericLiteral)Ir&&Ve.octal&&kr(Ve,He.StrictOctalLiteral),r=Ie.createLiteral(tr());else if(t===ze.Keyword){if(Bi("function"))return tye();Bi("this")?(tr(),r=Ie.createThisExpression()):Xu(tr())}else t===ze.BooleanLiteral?(e=tr(),e.value=e.value==="true",r=Ie.createLiteral(e)):t===ze.NullLiteral?(e=tr(),e.value=null,r=Ie.createLiteral(e)):gt("/")||gt("/=")?(typeof je.tokens<"u"?r=Ie.createLiteral(_h()):r=Ie.createLiteral(jK()),LK()):Xu(tr());return Ie.markEnd(r,n)}function VK(){var t=[];if(Tt("("),!gt(")"))for(;ye<Fr&&(t.push(za()),!gt(")"));)Tt(",");return Tt(")"),t}function Cme(){var t,e;return e=Ve,t=tr(),bme(t)||Xu(t),Ie.markEnd(Ie.createIdentifier(t.value),e)}function qK(){return Tt("."),Cme()}function HK(){var t;return Tt("["),t=oi(),Tt("]"),t}function zK(){var t,e,r;return r=Ve,Nn("new"),t=kme(),e=gt("(")?VK():[],Ie.markEnd(Ie.createNewExpression(t,e),r)}function Ime(){var t,e,r,n,s;for(s=Ve,t=ut.allowIn,ut.allowIn=!0,e=Bi("new")?zK():KK(),ut.allowIn=t;;){if(gt("."))n=qK(),e=Ie.createMemberExpression(".",e,n);else if(gt("("))r=VK(),e=Ie.createCallExpression(e,r);else if(gt("["))n=HK(),e=Ie.createMemberExpression("[",e,n);else break;Ie.markEnd(e,s)}return e}function kme(){var t,e,r,n;for(n=Ve,t=ut.allowIn,e=Bi("new")?zK():KK(),ut.allowIn=t;gt(".")||gt("[");)gt("[")?(r=HK(),e=Ie.createMemberExpression("[",e,r)):(r=qK(),e=Ie.createMemberExpression(".",e,r)),Ie.markEnd(e,n);return e}function qF(){var t,e,r=Ve;return t=Ime(),Ve.type===ze.Punctuator&&(gt("++")||gt("--"))&&!zw()&&(Ir&&t.type===yt.Identifier&&ca(t.name)&&kr({},He.StrictLHSPostfix),vS(t)||kr({},He.InvalidLHSInAssignment),e=tr(),t=Ie.markEnd(Ie.createPostfixExpression(e.value,t),r)),t}function Zm(){var t,e,r;return Ve.type!==ze.Punctuator&&Ve.type!==ze.Keyword?e=qF():gt("++")||gt("--")?(r=Ve,t=tr(),e=Zm(),Ir&&e.type===yt.Identifier&&ca(e.name)&&kr({},He.StrictLHSPrefix),vS(e)||kr({},He.InvalidLHSInAssignment),e=Ie.createUnaryExpression(t.value,e),e=Ie.markEnd(e,r)):gt("+")||gt("-")||gt("~")||gt("!")?(r=Ve,t=tr(),e=Zm(),e=Ie.createUnaryExpression(t.value,e),e=Ie.markEnd(e,r)):Bi("delete")||Bi("void")||Bi("typeof")?(r=Ve,t=tr(),e=Zm(),e=Ie.createUnaryExpression(t.value,e),e=Ie.markEnd(e,r),Ir&&e.operator==="delete"&&e.argument.type===yt.Identifier&&kr({},He.StrictDelete)):e=qF(),e}function HF(t,e){var r=0;if(t.type!==ze.Punctuator&&t.type!==ze.Keyword)return 0;switch(t.value){case"||":r=1;break;case"&&":r=2;break;case"|":r=3;break;case"^":r=4;break;case"&":r=5;break;case"==":case"!=":case"===":case"!==":r=6;break;case"<":case">":case"<=":case">=":case"instanceof":r=7;break;case"in":r=e?7:0;break;case"<<":case">>":case">>>":r=8;break;case"+":case"-":r=9;break;case"*":case"/":case"%":r=11;break}return r}function $me(){var t,e,r,n,s,i,o,a,u,l;if(t=Ve,u=Zm(),n=Ve,s=HF(n,ut.allowIn),s===0)return u;for(n.prec=s,tr(),e=[t,Ve],o=Zm(),i=[u,n,o];(s=HF(Ve,ut.allowIn))>0;){for(;i.length>2&&s<=i[i.length-2].prec;)o=i.pop(),a=i.pop().value,u=i.pop(),r=Ie.createBinaryExpression(a,u,o),e.pop(),t=e[e.length-1],Ie.markEnd(r,t),i.push(r);n=tr(),n.prec=s,i.push(n),e.push(Ve),r=Zm(),i.push(r)}for(l=i.length-1,r=i[l],e.pop();l>1;)r=Ie.createBinaryExpression(i[l-1].value,i[l-2],r),l-=2,t=e.pop(),Ie.markEnd(r,t);return r}function Ome(){var t,e,r,n,s;return s=Ve,t=$me(),gt("?")&&(tr(),e=ut.allowIn,ut.allowIn=!0,r=za(),ut.allowIn=e,Tt(":"),n=za(),t=Ie.createConditionalExpression(t,r,n),Ie.markEnd(t,s)),t}function za(){var t,e,r,n,s;return t=Ve,s=Ve,n=e=Ome(),Sme()&&(vS(e)||kr({},He.InvalidLHSInAssignment),Ir&&e.type===yt.Identifier&&ca(e.name)&&kr(t,He.StrictLHSAssignment),t=tr(),r=za(),n=Ie.markEnd(Ie.createAssignmentExpression(t.value,e,r),s)),n}function oi(){var t,e=Ve;if(t=za(),gt(",")){for(t=Ie.createSequenceExpression([t]);ye<Fr&&gt(",");)tr(),t.expressions.push(za());Ie.markEnd(t,e)}return t}function Rme(){for(var t=[],e;ye<Fr&&!(gt("}")||(e=Yv(),typeof e>"u"));)t.push(e);return t}function UE(){var t,e;return e=Ve,Tt("{"),t=Rme(),Tt("}"),Ie.markEnd(Ie.createBlockStatement(t),e)}function Of(){var t,e;return e=Ve,t=tr(),t.type!==ze.Identifier&&Xu(t),Ie.markEnd(Ie.createIdentifier(t.value),e)}function Nme(t){var e=null,r,n;return n=Ve,r=Of(),Ir&&ca(r.name)&&kr({},He.StrictVarName),t==="const"?(Tt("="),e=za()):gt("=")&&(tr(),e=za()),Ie.markEnd(Ie.createVariableDeclarator(r,e),n)}function JI(t){var e=[];do{if(e.push(Nme(t)),!gt(","))break;tr()}while(ye<Fr);return e}function Bme(){var t;return Nn("var"),t=JI(),Yu(),Ie.createVariableDeclaration(t,"var")}function Fme(t){var e,r;return r=Ve,Nn(t),e=JI(t),Yu(),Ie.markEnd(Ie.createVariableDeclaration(e,t),r)}function Mme(){return Tt(";"),Ie.createEmptyStatement()}function jme(){var t=oi();return Yu(),Ie.createExpressionStatement(t)}function Ume(){var t,e,r;return Nn("if"),Tt("("),t=oi(),Tt(")"),e=Zu(),Bi("else")?(tr(),r=Zu()):r=null,Ie.createIfStatement(t,e,r)}function Lme(){var t,e,r;return Nn("do"),r=ut.inIteration,ut.inIteration=!0,t=Zu(),ut.inIteration=r,Nn("while"),Tt("("),e=oi(),Tt(")"),gt(";")&&tr(),Ie.createDoWhileStatement(t,e)}function Kme(){var t,e,r;return Nn("while"),Tt("("),t=oi(),Tt(")"),r=ut.inIteration,ut.inIteration=!0,e=Zu(),ut.inIteration=r,Ie.createWhileStatement(t,e)}function Vme(){var t,e,r;return r=Ve,t=tr(),e=JI(),Ie.markEnd(Ie.createVariableDeclaration(e,t.value),r)}function qme(){var t,e,r,n,s,i,o;return t=e=r=null,Nn("for"),Tt("("),gt(";")?tr():(Bi("var")||Bi("let")?(ut.allowIn=!1,t=Vme(),ut.allowIn=!0,t.declarations.length===1&&Bi("in")&&(tr(),n=t,s=oi(),t=null)):(ut.allowIn=!1,t=oi(),ut.allowIn=!0,Bi("in")&&(vS(t)||kr({},He.InvalidLHSInForIn),tr(),n=t,s=oi(),t=null)),typeof n>"u"&&Tt(";")),typeof n>"u"&&(gt(";")||(e=oi()),Tt(";"),gt(")")||(r=oi())),Tt(")"),o=ut.inIteration,ut.inIteration=!0,i=Zu(),ut.inIteration=o,typeof n>"u"?Ie.createForStatement(t,e,r,i):Ie.createForInStatement(n,s,i)}function Hme(){var t=null,e;return Nn("continue"),Le.charCodeAt(ye)===59?(tr(),ut.inIteration||Ht({},He.IllegalContinue),Ie.createContinueStatement(null)):zw()?(ut.inIteration||Ht({},He.IllegalContinue),Ie.createContinueStatement(null)):(Ve.type===ze.Identifier&&(t=Of(),e="$"+t.name,Object.prototype.hasOwnProperty.call(ut.labelSet,e)||Ht({},He.UnknownLabel,t.name)),Yu(),t===null&&!ut.inIteration&&Ht({},He.IllegalContinue),Ie.createContinueStatement(t))}function zme(){var t=null,e;return Nn("break"),Le.charCodeAt(ye)===59?(tr(),ut.inIteration||ut.inSwitch||Ht({},He.IllegalBreak),Ie.createBreakStatement(null)):zw()?(ut.inIteration||ut.inSwitch||Ht({},He.IllegalBreak),Ie.createBreakStatement(null)):(Ve.type===ze.Identifier&&(t=Of(),e="$"+t.name,Object.prototype.hasOwnProperty.call(ut.labelSet,e)||Ht({},He.UnknownLabel,t.name)),Yu(),t===null&&!(ut.inIteration||ut.inSwitch)&&Ht({},He.IllegalBreak),Ie.createBreakStatement(t))}function Wme(){var t=null;return Nn("return"),ut.inFunctionBody||kr({},He.IllegalReturn),Le.charCodeAt(ye)===32&&zy(Le.charCodeAt(ye+1))?(t=oi(),Yu(),Ie.createReturnStatement(t)):zw()?Ie.createReturnStatement(null):(gt(";")||!gt("}")&&Ve.type!==ze.EOF&&(t=oi()),Yu(),Ie.createReturnStatement(t))}function Gme(){var t,e;return Ir&&($f(),kr({},He.StrictModeWith)),Nn("with"),Tt("("),t=oi(),Tt(")"),e=Zu(),Ie.createWithStatement(t,e)}function Jme(){var t,e=[],r,n;for(n=Ve,Bi("default")?(tr(),t=null):(Nn("case"),t=oi()),Tt(":");ye<Fr&&!(gt("}")||Bi("default")||Bi("case"));)r=Zu(),e.push(r);return Ie.markEnd(Ie.createSwitchCase(t,e),n)}function Xme(){var t,e,r,n,s;if(Nn("switch"),Tt("("),t=oi(),Tt(")"),Tt("{"),e=[],gt("}"))return tr(),Ie.createSwitchStatement(t,e);for(n=ut.inSwitch,ut.inSwitch=!0,s=!1;ye<Fr&&!gt("}");)r=Jme(),r.test===null&&(s&&Ht({},He.MultipleDefaultsInSwitch),s=!0),e.push(r);return ut.inSwitch=n,Tt("}"),Ie.createSwitchStatement(t,e)}function Yme(){var t;return Nn("throw"),zw()&&Ht({},He.NewlineAfterThrow),t=oi(),Yu(),Ie.createThrowStatement(t)}function Zme(){var t,e,r;return r=Ve,Nn("catch"),Tt("("),gt(")")&&Xu(Ve),t=Of(),Ir&&ca(t.name)&&kr({},He.StrictCatchVariable),Tt(")"),e=UE(),Ie.markEnd(Ie.createCatchClause(t,e),r)}function Qme(){var t,e=[],r=null;return Nn("try"),t=UE(),Bi("catch")&&e.push(Zme()),Bi("finally")&&(tr(),r=UE()),e.length===0&&!r&&Ht({},He.NoCatchOrFinally),Ie.createTryStatement(t,[],e,r)}function eye(){return Nn("debugger"),Yu(),Ie.createDebuggerStatement()}function Zu(){var t=Ve.type,e,r,n,s;if(t===ze.EOF&&Xu(Ve),t===ze.Punctuator&&Ve.value==="{")return UE();if(s=Ve,t===ze.Punctuator)switch(Ve.value){case";":return Ie.markEnd(Mme(),s);case"(":return Ie.markEnd(jme(),s)}if(t===ze.Keyword)switch(Ve.value){case"break":return Ie.markEnd(zme(),s);case"continue":return Ie.markEnd(Hme(),s);case"debugger":return Ie.markEnd(eye(),s);case"do":return Ie.markEnd(Lme(),s);case"for":return Ie.markEnd(qme(),s);case"function":return Ie.markEnd(GK(),s);case"if":return Ie.markEnd(Ume(),s);case"return":return Ie.markEnd(Wme(),s);case"switch":return Ie.markEnd(Xme(),s);case"throw":return Ie.markEnd(Yme(),s);case"try":return Ie.markEnd(Qme(),s);case"var":return Ie.markEnd(Bme(),s);case"while":return Ie.markEnd(Kme(),s);case"with":return Ie.markEnd(Gme(),s)}return e=oi(),e.type===yt.Identifier&&gt(":")?(tr(),n="$"+e.name,Object.prototype.hasOwnProperty.call(ut.labelSet,n)&&Ht({},He.Redeclaration,"Label",e.name),ut.labelSet[n]=!0,r=Zu(),delete ut.labelSet[n],Ie.markEnd(Ie.createLabeledStatement(e,r),s)):(Yu(),Ie.markEnd(Ie.createExpressionStatement(e),s))}function XI(){var t,e=[],r,n,s,i,o,a,u,l;for(l=Ve,Tt("{");ye<Fr&&!(Ve.type!==ze.StringLiteral||(r=Ve,t=Yv(),e.push(t),t.expression.type!==yt.Literal));)n=Le.slice(r.start+1,r.end-1),n==="use strict"?(Ir=!0,s&&kr(s,He.StrictOctalLiteral)):!s&&r.octal&&(s=r);for(i=ut.labelSet,o=ut.inIteration,a=ut.inSwitch,u=ut.inFunctionBody,ut.labelSet={},ut.inIteration=!1,ut.inSwitch=!1,ut.inFunctionBody=!0;ye<Fr&&!(gt("}")||(t=Yv(),typeof t>"u"));)e.push(t);return Tt("}"),ut.labelSet=i,ut.inIteration=o,ut.inSwitch=a,ut.inFunctionBody=u,Ie.markEnd(Ie.createBlockStatement(e),l)}function WK(t){var e,r=[],n,s,i,o,a;if(Tt("("),!gt(")"))for(i={};ye<Fr&&(n=Ve,e=Of(),o="$"+n.value,Ir?(ca(n.value)&&(s=n,a=He.StrictParamName),Object.prototype.hasOwnProperty.call(i,o)&&(s=n,a=He.StrictParamDupe)):t||(ca(n.value)?(t=n,a=He.StrictParamName):Hw(n.value)?(t=n,a=He.StrictReservedWord):Object.prototype.hasOwnProperty.call(i,o)&&(t=n,a=He.StrictParamDupe)),r.push(e),i[o]=!0,!gt(")"));)Tt(",");return Tt(")"),{params:r,stricted:s,firstRestricted:t,message:a}}function GK(){var t,e=[],r,n,s,i,o,a,u,l;return l=Ve,Nn("function"),n=Ve,t=Of(),Ir?ca(n.value)&&kr(n,He.StrictFunctionName):ca(n.value)?(o=n,a=He.StrictFunctionName):Hw(n.value)&&(o=n,a=He.StrictReservedWord),i=WK(o),e=i.params,s=i.stricted,o=i.firstRestricted,i.message&&(a=i.message),u=Ir,r=XI(),Ir&&o&&Ht(o,a),Ir&&s&&kr(s,a),Ir=u,Ie.markEnd(Ie.createFunctionDeclaration(t,e,[],r),l)}function tye(){var t,e=null,r,n,s,i,o=[],a,u,l;return l=Ve,Nn("function"),gt("(")||(t=Ve,e=Of(),Ir?ca(t.value)&&kr(t,He.StrictFunctionName):ca(t.value)?(n=t,s=He.StrictFunctionName):Hw(t.value)&&(n=t,s=He.StrictReservedWord)),i=WK(n),o=i.params,r=i.stricted,n=i.firstRestricted,i.message&&(s=i.message),u=Ir,a=XI(),Ir&&n&&Ht(n,s),Ir&&r&&kr(r,s),Ir=u,Ie.markEnd(Ie.createFunctionExpression(e,o,[],a),l)}function Yv(){if(Ve.type===ze.Keyword)switch(Ve.value){case"const":case"let":return Fme(Ve.value);case"function":return GK();default:return Zu()}if(Ve.type!==ze.EOF)return Zu()}function rye(){for(var t,e=[],r,n,s;ye<Fr&&(r=Ve,!(r.type!==ze.StringLiteral||(t=Yv(),e.push(t),t.expression.type!==yt.Literal)));)n=Le.slice(r.start+1,r.end-1),n==="use strict"?(Ir=!0,s&&kr(s,He.StrictOctalLiteral)):!s&&r.octal&&(s=r);for(;ye<Fr&&(t=Yv(),!(typeof t>"u"));)e.push(t);return e}function nye(){var t,e;return $f(),LK(),e=Ve,Ir=!1,t=rye(),Ie.markEnd(Ie.createProgram(t),e)}function iye(){var t,e,r,n=[];for(t=0;t<je.tokens.length;++t)e=je.tokens[t],r={type:e.type,value:e.value},je.range&&(r.range=e.range),je.loc&&(r.loc=e.loc),n.push(r);je.tokens=n}function fP(t,e){var r,n;n=String,typeof t!="string"&&!(t instanceof String)&&(t=n(t)),Ie=BK,Le=t,ye=0,Kt=Le.length>0?1:0,er=0,Fr=Le.length,Ve=null,ut={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},je={};try{r=nye(),typeof je.comments<"u"&&(r.comments=je.comments),typeof je.tokens<"u"&&(iye(),r.tokens=je.tokens),typeof je.errors<"u"&&(r.errors=je.errors)}catch(s){throw s}finally{je={}}return r}function sye(t,e,r,n){function s(u){return String(u).match(/^[0-9]+$/)?parseInt(u):Number.isFinite(u)?parseInt(u,10):0}if(typeof e=="string")throw new Error("start cannot be a string");if(typeof r=="string")throw new Error("end cannot be a string");if(typeof n=="string")throw new Error("step cannot be a string");var i=t.length;if(n===0)throw new Error("step cannot be zero");if(n=n?s(n):1,e=e<0?i+e:e,r=r<0?i+r:r,e=s(e===0?0:e||(n>0?0:i-1)),r=s(r===0?0:r||(n>0?i:-1)),e=n>0?Math.max(0,e):Math.min(i,e),r=n>0?Math.min(r,i):Math.max(-1,r),n>0&&r<=e)return[];if(n<0&&e<=r)return[];for(var o=[],a=e;a!=r&&!(n<0&&a<=r||n>0&&a>=r);a+=n)o.push(t[a]);return o}var JK={},XK={};const oye="estraverse",aye="ECMAScript JS AST traversal functions",uye="https://github.com/estools/estraverse",cye="estraverse.js",lye="4.3.0",dye={node:">=4.0"},fye=[{name:"Yusuke Suzuki",email:"utatane.tea@gmail.com",web:"http://github.com/Constellation"}],hye={type:"git",url:"http://github.com/estools/estraverse.git"},pye={"babel-preset-env":"^1.6.1","babel-register":"^6.3.13",chai:"^2.1.1",espree:"^1.11.0",gulp:"^3.8.10","gulp-bump":"^0.2.2","gulp-filter":"^2.0.0","gulp-git":"^1.0.1","gulp-tag-version":"^1.3.0",jshint:"^2.5.6",mocha:"^2.1.0"},mye="BSD-2-Clause",yye={test:"npm run-script lint && npm run-script unit-test",lint:"jshint estraverse.js","unit-test":"mocha --compilers js:babel-register"},gye={name:oye,description:aye,homepage:uye,main:cye,version:lye,engines:dye,maintainers:fye,repository:hye,devDependencies:pye,license:mye,scripts:yye};(function(t){(function e(r){var n,s,i,o,a,u;function l(v){var S={},x,D;for(x in v)v.hasOwnProperty(x)&&(D=v[x],typeof D=="object"&&D!==null?S[x]=l(D):S[x]=D);return S}function c(v,S){var x,D,w,b;for(D=v.length,w=0;D;)x=D>>>1,b=w+x,S(v[b])?D=x:(w=b+1,D-=x+1);return w}n={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ComprehensionBlock:"ComprehensionBlock",ComprehensionExpression:"ComprehensionExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DirectiveStatement:"DirectiveStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",ForOfStatement:"ForOfStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",GeneratorExpression:"GeneratorExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportExpression:"ImportExpression",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",ModuleSpecifier:"ModuleSpecifier",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Program:"Program",Property:"Property",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"},i={AssignmentExpression:["left","right"],AssignmentPattern:["left","right"],ArrayExpression:["elements"],ArrayPattern:["elements"],ArrowFunctionExpression:["params","body"],AwaitExpression:["argument"],BlockStatement:["body"],BinaryExpression:["left","right"],BreakStatement:["label"],CallExpression:["callee","arguments"],CatchClause:["param","body"],ClassBody:["body"],ClassDeclaration:["id","superClass","body"],ClassExpression:["id","superClass","body"],ComprehensionBlock:["left","right"],ComprehensionExpression:["blocks","filter","body"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DirectiveStatement:[],DoWhileStatement:["body","test"],EmptyStatement:[],ExportAllDeclaration:["source"],ExportDefaultDeclaration:["declaration"],ExportNamedDeclaration:["declaration","specifiers","source"],ExportSpecifier:["exported","local"],ExpressionStatement:["expression"],ForStatement:["init","test","update","body"],ForInStatement:["left","right","body"],ForOfStatement:["left","right","body"],FunctionDeclaration:["id","params","body"],FunctionExpression:["id","params","body"],GeneratorExpression:["blocks","filter","body"],Identifier:[],IfStatement:["test","consequent","alternate"],ImportExpression:["source"],ImportDeclaration:["specifiers","source"],ImportDefaultSpecifier:["local"],ImportNamespaceSpecifier:["local"],ImportSpecifier:["imported","local"],Literal:[],LabeledStatement:["label","body"],LogicalExpression:["left","right"],MemberExpression:["object","property"],MetaProperty:["meta","property"],MethodDefinition:["key","value"],ModuleSpecifier:[],NewExpression:["callee","arguments"],ObjectExpression:["properties"],ObjectPattern:["properties"],Program:["body"],Property:["key","value"],RestElement:["argument"],ReturnStatement:["argument"],SequenceExpression:["expressions"],SpreadElement:["argument"],Super:[],SwitchStatement:["discriminant","cases"],SwitchCase:["test","consequent"],TaggedTemplateExpression:["tag","quasi"],TemplateElement:[],TemplateLiteral:["quasis","expressions"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handler","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],YieldExpression:["argument"]},o={},a={},u={},s={Break:o,Skip:a,Remove:u};function d(v,S){this.parent=v,this.key=S}d.prototype.replace=function(S){this.parent[this.key]=S},d.prototype.remove=function(){return Array.isArray(this.parent)?(this.parent.splice(this.key,1),!0):(this.replace(null),!1)};function h(v,S,x,D){this.node=v,this.path=S,this.wrap=x,this.ref=D}function f(){}f.prototype.path=function(){var S,x,D,w,b,T;function P(C,k){if(Array.isArray(k))for(D=0,w=k.length;D<w;++D)C.push(k[D]);else C.push(k)}if(!this.__current.path)return null;for(b=[],S=2,x=this.__leavelist.length;S<x;++S)T=this.__leavelist[S],P(b,T.path);return P(b,this.__current.path),b},f.prototype.type=function(){var v=this.current();return v.type||this.__current.wrap},f.prototype.parents=function(){var S,x,D;for(D=[],S=1,x=this.__leavelist.length;S<x;++S)D.push(this.__leavelist[S].node);return D},f.prototype.current=function(){return this.__current.node},f.prototype.__execute=function(S,x){var D,w;return w=void 0,D=this.__current,this.__current=x,this.__state=null,S&&(w=S.call(this,x.node,this.__leavelist[this.__leavelist.length-1].node)),this.__current=D,w},f.prototype.notify=function(S){this.__state=S},f.prototype.skip=function(){this.notify(a)},f.prototype.break=function(){this.notify(o)},f.prototype.remove=function(){this.notify(u)},f.prototype.__initialize=function(v,S){this.visitor=S,this.root=v,this.__worklist=[],this.__leavelist=[],this.__current=null,this.__state=null,this.__fallback=null,S.fallback==="iteration"?this.__fallback=Object.keys:typeof S.fallback=="function"&&(this.__fallback=S.fallback),this.__keys=i,S.keys&&(this.__keys=Object.assign(Object.create(this.__keys),S.keys))};function p(v){return v==null?!1:typeof v=="object"&&typeof v.type=="string"}function m(v,S){return(v===n.ObjectExpression||v===n.ObjectPattern)&&S==="properties"}f.prototype.traverse=function(S,x){var D,w,b,T,P,C,k,K,L,q,se,X;for(this.__initialize(S,x),X={},D=this.__worklist,w=this.__leavelist,D.push(new h(S,null,null,null)),w.push(new h(null,null,null,null));D.length;){if(b=D.pop(),b===X){if(b=w.pop(),C=this.__execute(x.leave,b),this.__state===o||C===o)return;continue}if(b.node){if(C=this.__execute(x.enter,b),this.__state===o||C===o)return;if(D.push(X),w.push(b),this.__state===a||C===a)continue;if(T=b.node,P=T.type||b.wrap,q=this.__keys[P],!q)if(this.__fallback)q=this.__fallback(T);else throw new Error("Unknown node type "+P+".");for(K=q.length;(K-=1)>=0;)if(k=q[K],se=T[k],!!se)if(Array.isArray(se)){for(L=se.length;(L-=1)>=0;)if(se[L]){if(m(P,q[K]))b=new h(se[L],[k,L],"Property",null);else if(p(se[L]))b=new h(se[L],[k,L],null,null);else continue;D.push(b)}}else p(se)&&D.push(new h(se,k,null,null))}}},f.prototype.replace=function(S,x){var D,w,b,T,P,C,k,K,L,q,se,X,re;function W(B){var te,z,$,F;if(B.ref.remove()){for(z=B.ref.key,F=B.ref.parent,te=D.length;te--;)if($=D[te],$.ref&&$.ref.parent===F){if($.ref.key<z)break;--$.ref.key}}}for(this.__initialize(S,x),se={},D=this.__worklist,w=this.__leavelist,X={root:S},C=new h(S,null,null,new d(X,"root")),D.push(C),w.push(C);D.length;){if(C=D.pop(),C===se){if(C=w.pop(),P=this.__execute(x.leave,C),P!==void 0&&P!==o&&P!==a&&P!==u&&C.ref.replace(P),(this.__state===u||P===u)&&W(C),this.__state===o||P===o)return X.root;continue}if(P=this.__execute(x.enter,C),P!==void 0&&P!==o&&P!==a&&P!==u&&(C.ref.replace(P),C.node=P),(this.__state===u||P===u)&&(W(C),C.node=null),this.__state===o||P===o)return X.root;if(b=C.node,!!b&&(D.push(se),w.push(C),!(this.__state===a||P===a))){if(T=b.type||C.wrap,L=this.__keys[T],!L)if(this.__fallback)L=this.__fallback(b);else throw new Error("Unknown node type "+T+".");for(k=L.length;(k-=1)>=0;)if(re=L[k],q=b[re],!!q)if(Array.isArray(q)){for(K=q.length;(K-=1)>=0;)if(q[K]){if(m(T,L[k]))C=new h(q[K],[re,K],"Property",new d(q,K));else if(p(q[K]))C=new h(q[K],[re,K],null,new d(q,K));else continue;D.push(C)}}else p(q)&&D.push(new h(q,re,null,new d(b,re)))}}return X.root};function E(v,S){var x=new f;return x.traverse(v,S)}function A(v,S){var x=new f;return x.replace(v,S)}function _(v,S){var x;return x=c(S,function(w){return w.range[0]>v.range[0]}),v.extendedRange=[v.range[0],v.range[1]],x!==S.length&&(v.extendedRange[1]=S[x].range[0]),x-=1,x>=0&&(v.extendedRange[0]=S[x].range[1]),v}function g(v,S,x){var D=[],w,b,T,P;if(!v.range)throw new Error("attachComments needs range information");if(!x.length){if(S.length){for(T=0,b=S.length;T<b;T+=1)w=l(S[T]),w.extendedRange=[0,v.range[0]],D.push(w);v.leadingComments=D}return v}for(T=0,b=S.length;T<b;T+=1)D.push(_(l(S[T]),x));return P=0,E(v,{enter:function(C){for(var k;P<D.length&&(k=D[P],!(k.extendedRange[1]>C.range[0]));)k.extendedRange[1]===C.range[0]?(C.leadingComments||(C.leadingComments=[]),C.leadingComments.push(k),D.splice(P,1)):P+=1;if(P===D.length)return s.Break;if(D[P].extendedRange[0]>C.range[1])return s.Skip}}),P=0,E(v,{leave:function(C){for(var k;P<D.length&&(k=D[P],!(C.range[1]<k.extendedRange[0]));)C.range[1]===k.extendedRange[0]?(C.trailingComments||(C.trailingComments=[]),C.trailingComments.push(k),D.splice(P,1)):P+=1;if(P===D.length)return s.Break;if(D[P].extendedRange[0]>C.range[1])return s.Skip}}),v}return r.version=gye.version,r.Syntax=n,r.traverse=E,r.replace=A,r.attachComments=g,r.VisitorKeys=i,r.VisitorOption=s,r.Controller=f,r.cloneEnvironment=function(){return e({})},r})(t)})(XK);var x1={},YK={exports:{}};(function(){function t(o){if(o==null)return!1;switch(o.type){case"ArrayExpression":case"AssignmentExpression":case"BinaryExpression":case"CallExpression":case"ConditionalExpression":case"FunctionExpression":case"Identifier":case"Literal":case"LogicalExpression":case"MemberExpression":case"NewExpression":case"ObjectExpression":case"SequenceExpression":case"ThisExpression":case"UnaryExpression":case"UpdateExpression":return!0}return!1}function e(o){if(o==null)return!1;switch(o.type){case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"WhileStatement":return!0}return!1}function r(o){if(o==null)return!1;switch(o.type){case"BlockStatement":case"BreakStatement":case"ContinueStatement":case"DebuggerStatement":case"DoWhileStatement":case"EmptyStatement":case"ExpressionStatement":case"ForInStatement":case"ForStatement":case"IfStatement":case"LabeledStatement":case"ReturnStatement":case"SwitchStatement":case"ThrowStatement":case"TryStatement":case"VariableDeclaration":case"WhileStatement":case"WithStatement":return!0}return!1}function n(o){return r(o)||o!=null&&o.type==="FunctionDeclaration"}function s(o){switch(o.type){case"IfStatement":return o.alternate!=null?o.alternate:o.consequent;case"LabeledStatement":case"ForStatement":case"ForInStatement":case"WhileStatement":case"WithStatement":return o.body}return null}function i(o){var a;if(o.type!=="IfStatement"||o.alternate==null)return!1;a=o.consequent;do{if(a.type==="IfStatement"&&a.alternate==null)return!0;a=s(a)}while(a);return!1}YK.exports={isExpression:t,isStatement:r,isIterationStatement:e,isSourceElement:n,isProblematicIfStatement:i,trailingStatement:s}})();var vye=YK.exports,ZK={exports:{}};(function(){var t,e,r,n,s,i;e={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,NonAsciiIdentifierPart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/},t={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/};function o(E){return 48<=E&&E<=57}function a(E){return 48<=E&&E<=57||97<=E&&E<=102||65<=E&&E<=70}function u(E){return E>=48&&E<=55}r=[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function l(E){return E===32||E===9||E===11||E===12||E===160||E>=5760&&r.indexOf(E)>=0}function c(E){return E===10||E===13||E===8232||E===8233}function d(E){if(E<=65535)return String.fromCharCode(E);var A=String.fromCharCode(Math.floor((E-65536)/1024)+55296),_=String.fromCharCode((E-65536)%1024+56320);return A+_}for(n=new Array(128),i=0;i<128;++i)n[i]=i>=97&&i<=122||i>=65&&i<=90||i===36||i===95;for(s=new Array(128),i=0;i<128;++i)s[i]=i>=97&&i<=122||i>=65&&i<=90||i>=48&&i<=57||i===36||i===95;function h(E){return E<128?n[E]:e.NonAsciiIdentifierStart.test(d(E))}function f(E){return E<128?s[E]:e.NonAsciiIdentifierPart.test(d(E))}function p(E){return E<128?n[E]:t.NonAsciiIdentifierStart.test(d(E))}function m(E){return E<128?s[E]:t.NonAsciiIdentifierPart.test(d(E))}ZK.exports={isDecimalDigit:o,isHexDigit:a,isOctalDigit:u,isWhiteSpace:l,isLineTerminator:c,isIdentifierStartES5:h,isIdentifierPartES5:f,isIdentifierStartES6:p,isIdentifierPartES6:m}})();var QK=ZK.exports,eV={exports:{}};(function(){var t=QK;function e(h){switch(h){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"let":return!0;default:return!1}}function r(h,f){return!f&&h==="yield"?!1:n(h,f)}function n(h,f){if(f&&e(h))return!0;switch(h.length){case 2:return h==="if"||h==="in"||h==="do";case 3:return h==="var"||h==="for"||h==="new"||h==="try";case 4:return h==="this"||h==="else"||h==="case"||h==="void"||h==="with"||h==="enum";case 5:return h==="while"||h==="break"||h==="catch"||h==="throw"||h==="const"||h==="yield"||h==="class"||h==="super";case 6:return h==="return"||h==="typeof"||h==="delete"||h==="switch"||h==="export"||h==="import";case 7:return h==="default"||h==="finally"||h==="extends";case 8:return h==="function"||h==="continue"||h==="debugger";case 10:return h==="instanceof";default:return!1}}function s(h,f){return h==="null"||h==="true"||h==="false"||r(h,f)}function i(h,f){return h==="null"||h==="true"||h==="false"||n(h,f)}function o(h){return h==="eval"||h==="arguments"}function a(h){var f,p,m;if(h.length===0||(m=h.charCodeAt(0),!t.isIdentifierStartES5(m)))return!1;for(f=1,p=h.length;f<p;++f)if(m=h.charCodeAt(f),!t.isIdentifierPartES5(m))return!1;return!0}function u(h,f){return(h-55296)*1024+(f-56320)+65536}function l(h){var f,p,m,E,A;if(h.length===0)return!1;for(A=t.isIdentifierStartES6,f=0,p=h.length;f<p;++f){if(m=h.charCodeAt(f),55296<=m&&m<=56319){if(++f,f>=p||(E=h.charCodeAt(f),!(56320<=E&&E<=57343)))return!1;m=u(m,E)}if(!A(m))return!1;A=t.isIdentifierPartES6}return!0}function c(h,f){return a(h)&&!s(h,f)}function d(h,f){return l(h)&&!i(h,f)}eV.exports={isKeywordES5:r,isKeywordES6:n,isReservedWordES5:s,isReservedWordES6:i,isRestrictedWord:o,isIdentifierNameES5:a,isIdentifierNameES6:l,isIdentifierES5:c,isIdentifierES6:d}})();var wye=eV.exports;(function(){x1.ast=vye,x1.code=QK,x1.keyword=wye})();var r0={},OT={},Tb={},Db={},zF;function _ye(){if(zF)return Db;zF=1;var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return Db.encode=function(e){if(0<=e&&e<t.length)return t[e];throw new TypeError("Must be between 0 and 63: "+e)},Db.decode=function(e){var r=65,n=90,s=97,i=122,o=48,a=57,u=43,l=47,c=26,d=52;return r<=e&&e<=n?e-r:s<=e&&e<=i?e-s+c:o<=e&&e<=a?e-o+d:e==u?62:e==l?63:-1},Db}var WF;function tV(){if(WF)return Tb;WF=1;var t=_ye(),e=5,r=1<<e,n=r-1,s=r;function i(a){return a<0?(-a<<1)+1:(a<<1)+0}function o(a){var u=(a&1)===1,l=a>>1;return u?-l:l}return Tb.encode=function(u){var l="",c,d=i(u);do c=d&n,d>>>=e,d>0&&(c|=s),l+=t.encode(c);while(d>0);return l},Tb.decode=function(u,l,c){var d=u.length,h=0,f=0,p,m;do{if(l>=d)throw new Error("Expected more digits in base 64 VLQ value.");if(m=t.decode(u.charCodeAt(l++)),m===-1)throw new Error("Invalid base64 digit: "+u.charAt(l-1));p=!!(m&s),m&=n,h=h+(m<<f),f+=e}while(p);c.value=o(h),c.rest=l},Tb}var RT={},GF;function Ww(){return GF||(GF=1,function(t){function e(v,S,x){if(S in v)return v[S];if(arguments.length===3)return x;throw new Error('"'+S+'" is a required argument.')}t.getArg=e;var r=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,n=/^data:.+\,.+$/;function s(v){var S=v.match(r);return S?{scheme:S[1],auth:S[2],host:S[3],port:S[4],path:S[5]}:null}t.urlParse=s;function i(v){var S="";return v.scheme&&(S+=v.scheme+":"),S+="//",v.auth&&(S+=v.auth+"@"),v.host&&(S+=v.host),v.port&&(S+=":"+v.port),v.path&&(S+=v.path),S}t.urlGenerate=i;function o(v){var S=v,x=s(v);if(x){if(!x.path)return v;S=x.path}for(var D=t.isAbsolute(S),w=S.split(/\/+/),b,T=0,P=w.length-1;P>=0;P--)b=w[P],b==="."?w.splice(P,1):b===".."?T++:T>0&&(b===""?(w.splice(P+1,T),T=0):(w.splice(P,2),T--));return S=w.join("/"),S===""&&(S=D?"/":"."),x?(x.path=S,i(x)):S}t.normalize=o;function a(v,S){v===""&&(v="."),S===""&&(S=".");var x=s(S),D=s(v);if(D&&(v=D.path||"/"),x&&!x.scheme)return D&&(x.scheme=D.scheme),i(x);if(x||S.match(n))return S;if(D&&!D.host&&!D.path)return D.host=S,i(D);var w=S.charAt(0)==="/"?S:o(v.replace(/\/+$/,"")+"/"+S);return D?(D.path=w,i(D)):w}t.join=a,t.isAbsolute=function(v){return v.charAt(0)==="/"||r.test(v)};function u(v,S){v===""&&(v="."),v=v.replace(/\/$/,"");for(var x=0;S.indexOf(v+"/")!==0;){var D=v.lastIndexOf("/");if(D<0||(v=v.slice(0,D),v.match(/^([^\/]+:\/)?\/*$/)))return S;++x}return Array(x+1).join("../")+S.substr(v.length+1)}t.relative=u;var l=function(){var v=Object.create(null);return!("__proto__"in v)}();function c(v){return v}function d(v){return f(v)?"$"+v:v}t.toSetString=l?c:d;function h(v){return f(v)?v.slice(1):v}t.fromSetString=l?c:h;function f(v){if(!v)return!1;var S=v.length;if(S<9||v.charCodeAt(S-1)!==95||v.charCodeAt(S-2)!==95||v.charCodeAt(S-3)!==111||v.charCodeAt(S-4)!==116||v.charCodeAt(S-5)!==111||v.charCodeAt(S-6)!==114||v.charCodeAt(S-7)!==112||v.charCodeAt(S-8)!==95||v.charCodeAt(S-9)!==95)return!1;for(var x=S-10;x>=0;x--)if(v.charCodeAt(x)!==36)return!1;return!0}function p(v,S,x){var D=E(v.source,S.source);return D!==0||(D=v.originalLine-S.originalLine,D!==0)||(D=v.originalColumn-S.originalColumn,D!==0||x)||(D=v.generatedColumn-S.generatedColumn,D!==0)||(D=v.generatedLine-S.generatedLine,D!==0)?D:E(v.name,S.name)}t.compareByOriginalPositions=p;function m(v,S,x){var D=v.generatedLine-S.generatedLine;return D!==0||(D=v.generatedColumn-S.generatedColumn,D!==0||x)||(D=E(v.source,S.source),D!==0)||(D=v.originalLine-S.originalLine,D!==0)||(D=v.originalColumn-S.originalColumn,D!==0)?D:E(v.name,S.name)}t.compareByGeneratedPositionsDeflated=m;function E(v,S){return v===S?0:v===null?1:S===null?-1:v>S?1:-1}function A(v,S){var x=v.generatedLine-S.generatedLine;return x!==0||(x=v.generatedColumn-S.generatedColumn,x!==0)||(x=E(v.source,S.source),x!==0)||(x=v.originalLine-S.originalLine,x!==0)||(x=v.originalColumn-S.originalColumn,x!==0)?x:E(v.name,S.name)}t.compareByGeneratedPositionsInflated=A;function _(v){return JSON.parse(v.replace(/^\)]}'[^\n]*\n/,""))}t.parseSourceMapInput=_;function g(v,S,x){if(S=S||"",v&&(v[v.length-1]!=="/"&&S[0]!=="/"&&(v+="/"),S=v+S),x){var D=s(x);if(!D)throw new Error("sourceMapURL could not be parsed");if(D.path){var w=D.path.lastIndexOf("/");w>=0&&(D.path=D.path.substring(0,w+1))}S=a(i(D),S)}return o(S)}t.computeSourceURL=g}(RT)),RT}var NT={},JF;function rV(){if(JF)return NT;JF=1;var t=Ww(),e=Object.prototype.hasOwnProperty,r=typeof Map<"u";function n(){this._array=[],this._set=r?new Map:Object.create(null)}return n.fromArray=function(i,o){for(var a=new n,u=0,l=i.length;u<l;u++)a.add(i[u],o);return a},n.prototype.size=function(){return r?this._set.size:Object.getOwnPropertyNames(this._set).length},n.prototype.add=function(i,o){var a=r?i:t.toSetString(i),u=r?this.has(i):e.call(this._set,a),l=this._array.length;(!u||o)&&this._array.push(i),u||(r?this._set.set(i,l):this._set[a]=l)},n.prototype.has=function(i){if(r)return this._set.has(i);var o=t.toSetString(i);return e.call(this._set,o)},n.prototype.indexOf=function(i){if(r){var o=this._set.get(i);if(o>=0)return o}else{var a=t.toSetString(i);if(e.call(this._set,a))return this._set[a]}throw new Error('"'+i+'" is not in the set.')},n.prototype.at=function(i){if(i>=0&&i<this._array.length)return this._array[i];throw new Error("No element indexed by "+i)},n.prototype.toArray=function(){return this._array.slice()},NT.ArraySet=n,NT}var BT={},XF;function bye(){if(XF)return BT;XF=1;var t=Ww();function e(n,s){var i=n.generatedLine,o=s.generatedLine,a=n.generatedColumn,u=s.generatedColumn;return o>i||o==i&&u>=a||t.compareByGeneratedPositionsInflated(n,s)<=0}function r(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}return r.prototype.unsortedForEach=function(s,i){this._array.forEach(s,i)},r.prototype.add=function(s){e(this._last,s)?(this._last=s,this._array.push(s)):(this._sorted=!1,this._array.push(s))},r.prototype.toArray=function(){return this._sorted||(this._array.sort(t.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},BT.MappingList=r,BT}var YF;function nV(){if(YF)return OT;YF=1;var t=tV(),e=Ww(),r=rV().ArraySet,n=bye().MappingList;function s(i){i||(i={}),this._file=e.getArg(i,"file",null),this._sourceRoot=e.getArg(i,"sourceRoot",null),this._skipValidation=e.getArg(i,"skipValidation",!1),this._sources=new r,this._names=new r,this._mappings=new n,this._sourcesContents=null}return s.prototype._version=3,s.fromSourceMap=function(o){var a=o.sourceRoot,u=new s({file:o.file,sourceRoot:a});return o.eachMapping(function(l){var c={generated:{line:l.generatedLine,column:l.generatedColumn}};l.source!=null&&(c.source=l.source,a!=null&&(c.source=e.relative(a,c.source)),c.original={line:l.originalLine,column:l.originalColumn},l.name!=null&&(c.name=l.name)),u.addMapping(c)}),o.sources.forEach(function(l){var c=l;a!==null&&(c=e.relative(a,l)),u._sources.has(c)||u._sources.add(c);var d=o.sourceContentFor(l);d!=null&&u.setSourceContent(l,d)}),u},s.prototype.addMapping=function(o){var a=e.getArg(o,"generated"),u=e.getArg(o,"original",null),l=e.getArg(o,"source",null),c=e.getArg(o,"name",null);this._skipValidation||this._validateMapping(a,u,l,c),l!=null&&(l=String(l),this._sources.has(l)||this._sources.add(l)),c!=null&&(c=String(c),this._names.has(c)||this._names.add(c)),this._mappings.add({generatedLine:a.line,generatedColumn:a.column,originalLine:u!=null&&u.line,originalColumn:u!=null&&u.column,source:l,name:c})},s.prototype.setSourceContent=function(o,a){var u=o;this._sourceRoot!=null&&(u=e.relative(this._sourceRoot,u)),a!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[e.toSetString(u)]=a):this._sourcesContents&&(delete this._sourcesContents[e.toSetString(u)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))},s.prototype.applySourceMap=function(o,a,u){var l=a;if(a==null){if(o.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);l=o.file}var c=this._sourceRoot;c!=null&&(l=e.relative(c,l));var d=new r,h=new r;this._mappings.unsortedForEach(function(f){if(f.source===l&&f.originalLine!=null){var p=o.originalPositionFor({line:f.originalLine,column:f.originalColumn});p.source!=null&&(f.source=p.source,u!=null&&(f.source=e.join(u,f.source)),c!=null&&(f.source=e.relative(c,f.source)),f.originalLine=p.line,f.originalColumn=p.column,p.name!=null&&(f.name=p.name))}var m=f.source;m!=null&&!d.has(m)&&d.add(m);var E=f.name;E!=null&&!h.has(E)&&h.add(E)},this),this._sources=d,this._names=h,o.sources.forEach(function(f){var p=o.sourceContentFor(f);p!=null&&(u!=null&&(f=e.join(u,f)),c!=null&&(f=e.relative(c,f)),this.setSourceContent(f,p))},this)},s.prototype._validateMapping=function(o,a,u,l){if(a&&typeof a.line!="number"&&typeof a.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(o&&"line"in o&&"column"in o&&o.line>0&&o.column>=0&&!a&&!u&&!l)){if(o&&"line"in o&&"column"in o&&a&&"line"in a&&"column"in a&&o.line>0&&o.column>=0&&a.line>0&&a.column>=0&&u)return;throw new Error("Invalid mapping: "+JSON.stringify({generated:o,source:u,original:a,name:l}))}},s.prototype._serializeMappings=function(){for(var o=0,a=1,u=0,l=0,c=0,d=0,h="",f,p,m,E,A=this._mappings.toArray(),_=0,g=A.length;_<g;_++){if(p=A[_],f="",p.generatedLine!==a)for(o=0;p.generatedLine!==a;)f+=";",a++;else if(_>0){if(!e.compareByGeneratedPositionsInflated(p,A[_-1]))continue;f+=","}f+=t.encode(p.generatedColumn-o),o=p.generatedColumn,p.source!=null&&(E=this._sources.indexOf(p.source),f+=t.encode(E-d),d=E,f+=t.encode(p.originalLine-1-l),l=p.originalLine-1,f+=t.encode(p.originalColumn-u),u=p.originalColumn,p.name!=null&&(m=this._names.indexOf(p.name),f+=t.encode(m-c),c=m)),h+=f}return h},s.prototype._generateSourcesContent=function(o,a){return o.map(function(u){if(!this._sourcesContents)return null;a!=null&&(u=e.relative(a,u));var l=e.toSetString(u);return Object.prototype.hasOwnProperty.call(this._sourcesContents,l)?this._sourcesContents[l]:null},this)},s.prototype.toJSON=function(){var o={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(o.file=this._file),this._sourceRoot!=null&&(o.sourceRoot=this._sourceRoot),this._sourcesContents&&(o.sourcesContent=this._generateSourcesContent(o.sources,o.sourceRoot)),o},s.prototype.toString=function(){return JSON.stringify(this.toJSON())},OT.SourceMapGenerator=s,OT}var n0={},FT={},ZF;function Eye(){return ZF||(ZF=1,function(t){t.GREATEST_LOWER_BOUND=1,t.LEAST_UPPER_BOUND=2;function e(r,n,s,i,o,a){var u=Math.floor((n-r)/2)+r,l=o(s,i[u],!0);return l===0?u:l>0?n-u>1?e(u,n,s,i,o,a):a==t.LEAST_UPPER_BOUND?n<i.length?n:-1:u:u-r>1?e(r,u,s,i,o,a):a==t.LEAST_UPPER_BOUND?u:r<0?-1:r}t.search=function(n,s,i,o){if(s.length===0)return-1;var a=e(-1,s.length,n,s,i,o||t.GREATEST_LOWER_BOUND);if(a<0)return-1;for(;a-1>=0&&i(s[a],s[a-1],!0)===0;)--a;return a}}(FT)),FT}var MT={},QF;function Aye(){if(QF)return MT;QF=1;function t(n,s,i){var o=n[s];n[s]=n[i],n[i]=o}function e(n,s){return Math.round(n+Math.random()*(s-n))}function r(n,s,i,o){if(i<o){var a=e(i,o),u=i-1;t(n,a,o);for(var l=n[o],c=i;c<o;c++)s(n[c],l)<=0&&(u+=1,t(n,u,c));t(n,u+1,c);var d=u+1;r(n,s,i,d-1),r(n,s,d+1,o)}}return MT.quickSort=function(n,s){r(n,s,0,n.length-1)},MT}var e6;function Sye(){if(e6)return n0;e6=1;var t=Ww(),e=Eye(),r=rV().ArraySet,n=tV(),s=Aye().quickSort;function i(l,c){var d=l;return typeof l=="string"&&(d=t.parseSourceMapInput(l)),d.sections!=null?new u(d,c):new o(d,c)}i.fromSourceMap=function(l,c){return o.fromSourceMap(l,c)},i.prototype._version=3,i.prototype.__generatedMappings=null,Object.defineProperty(i.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),i.prototype.__originalMappings=null,Object.defineProperty(i.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),i.prototype._charIsMappingSeparator=function(c,d){var h=c.charAt(d);return h===";"||h===","},i.prototype._parseMappings=function(c,d){throw new Error("Subclasses must implement _parseMappings")},i.GENERATED_ORDER=1,i.ORIGINAL_ORDER=2,i.GREATEST_LOWER_BOUND=1,i.LEAST_UPPER_BOUND=2,i.prototype.eachMapping=function(c,d,h){var f=d||null,p=h||i.GENERATED_ORDER,m;switch(p){case i.GENERATED_ORDER:m=this._generatedMappings;break;case i.ORIGINAL_ORDER:m=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var E=this.sourceRoot;m.map(function(A){var _=A.source===null?null:this._sources.at(A.source);return _=t.computeSourceURL(E,_,this._sourceMapURL),{source:_,generatedLine:A.generatedLine,generatedColumn:A.generatedColumn,originalLine:A.originalLine,originalColumn:A.originalColumn,name:A.name===null?null:this._names.at(A.name)}},this).forEach(c,f)},i.prototype.allGeneratedPositionsFor=function(c){var d=t.getArg(c,"line"),h={source:t.getArg(c,"source"),originalLine:d,originalColumn:t.getArg(c,"column",0)};if(h.source=this._findSourceIndex(h.source),h.source<0)return[];var f=[],p=this._findMapping(h,this._originalMappings,"originalLine","originalColumn",t.compareByOriginalPositions,e.LEAST_UPPER_BOUND);if(p>=0){var m=this._originalMappings[p];if(c.column===void 0)for(var E=m.originalLine;m&&m.originalLine===E;)f.push({line:t.getArg(m,"generatedLine",null),column:t.getArg(m,"generatedColumn",null),lastColumn:t.getArg(m,"lastGeneratedColumn",null)}),m=this._originalMappings[++p];else for(var A=m.originalColumn;m&&m.originalLine===d&&m.originalColumn==A;)f.push({line:t.getArg(m,"generatedLine",null),column:t.getArg(m,"generatedColumn",null),lastColumn:t.getArg(m,"lastGeneratedColumn",null)}),m=this._originalMappings[++p]}return f},n0.SourceMapConsumer=i;function o(l,c){var d=l;typeof l=="string"&&(d=t.parseSourceMapInput(l));var h=t.getArg(d,"version"),f=t.getArg(d,"sources"),p=t.getArg(d,"names",[]),m=t.getArg(d,"sourceRoot",null),E=t.getArg(d,"sourcesContent",null),A=t.getArg(d,"mappings"),_=t.getArg(d,"file",null);if(h!=this._version)throw new Error("Unsupported version: "+h);m&&(m=t.normalize(m)),f=f.map(String).map(t.normalize).map(function(g){return m&&t.isAbsolute(m)&&t.isAbsolute(g)?t.relative(m,g):g}),this._names=r.fromArray(p.map(String),!0),this._sources=r.fromArray(f,!0),this._absoluteSources=this._sources.toArray().map(function(g){return t.computeSourceURL(m,g,c)}),this.sourceRoot=m,this.sourcesContent=E,this._mappings=A,this._sourceMapURL=c,this.file=_}o.prototype=Object.create(i.prototype),o.prototype.consumer=i,o.prototype._findSourceIndex=function(l){var c=l;if(this.sourceRoot!=null&&(c=t.relative(this.sourceRoot,c)),this._sources.has(c))return this._sources.indexOf(c);var d;for(d=0;d<this._absoluteSources.length;++d)if(this._absoluteSources[d]==l)return d;return-1},o.fromSourceMap=function(c,d){var h=Object.create(o.prototype),f=h._names=r.fromArray(c._names.toArray(),!0),p=h._sources=r.fromArray(c._sources.toArray(),!0);h.sourceRoot=c._sourceRoot,h.sourcesContent=c._generateSourcesContent(h._sources.toArray(),h.sourceRoot),h.file=c._file,h._sourceMapURL=d,h._absoluteSources=h._sources.toArray().map(function(x){return t.computeSourceURL(h.sourceRoot,x,d)});for(var m=c._mappings.toArray().slice(),E=h.__generatedMappings=[],A=h.__originalMappings=[],_=0,g=m.length;_<g;_++){var v=m[_],S=new a;S.generatedLine=v.generatedLine,S.generatedColumn=v.generatedColumn,v.source&&(S.source=p.indexOf(v.source),S.originalLine=v.originalLine,S.originalColumn=v.originalColumn,v.name&&(S.name=f.indexOf(v.name)),A.push(S)),E.push(S)}return s(h.__originalMappings,t.compareByOriginalPositions),h},o.prototype._version=3,Object.defineProperty(o.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function a(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}o.prototype._parseMappings=function(c,d){for(var h=1,f=0,p=0,m=0,E=0,A=0,_=c.length,g=0,v={},S={},x=[],D=[],w,b,T,P,C;g<_;)if(c.charAt(g)===";")h++,g++,f=0;else if(c.charAt(g)===",")g++;else{for(w=new a,w.generatedLine=h,P=g;P<_&&!this._charIsMappingSeparator(c,P);P++);if(b=c.slice(g,P),T=v[b],T)g+=b.length;else{for(T=[];g<P;)n.decode(c,g,S),C=S.value,g=S.rest,T.push(C);if(T.length===2)throw new Error("Found a source, but no line and column");if(T.length===3)throw new Error("Found a source and line, but no column");v[b]=T}w.generatedColumn=f+T[0],f=w.generatedColumn,T.length>1&&(w.source=E+T[1],E+=T[1],w.originalLine=p+T[2],p=w.originalLine,w.originalLine+=1,w.originalColumn=m+T[3],m=w.originalColumn,T.length>4&&(w.name=A+T[4],A+=T[4])),D.push(w),typeof w.originalLine=="number"&&x.push(w)}s(D,t.compareByGeneratedPositionsDeflated),this.__generatedMappings=D,s(x,t.compareByOriginalPositions),this.__originalMappings=x},o.prototype._findMapping=function(c,d,h,f,p,m){if(c[h]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+c[h]);if(c[f]<0)throw new TypeError("Column must be greater than or equal to 0, got "+c[f]);return e.search(c,d,p,m)},o.prototype.computeColumnSpans=function(){for(var c=0;c<this._generatedMappings.length;++c){var d=this._generatedMappings[c];if(c+1<this._generatedMappings.length){var h=this._generatedMappings[c+1];if(d.generatedLine===h.generatedLine){d.lastGeneratedColumn=h.generatedColumn-1;continue}}d.lastGeneratedColumn=1/0}},o.prototype.originalPositionFor=function(c){var d={generatedLine:t.getArg(c,"line"),generatedColumn:t.getArg(c,"column")},h=this._findMapping(d,this._generatedMappings,"generatedLine","generatedColumn",t.compareByGeneratedPositionsDeflated,t.getArg(c,"bias",i.GREATEST_LOWER_BOUND));if(h>=0){var f=this._generatedMappings[h];if(f.generatedLine===d.generatedLine){var p=t.getArg(f,"source",null);p!==null&&(p=this._sources.at(p),p=t.computeSourceURL(this.sourceRoot,p,this._sourceMapURL));var m=t.getArg(f,"name",null);return m!==null&&(m=this._names.at(m)),{source:p,line:t.getArg(f,"originalLine",null),column:t.getArg(f,"originalColumn",null),name:m}}}return{source:null,line:null,column:null,name:null}},o.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(c){return c==null}):!1},o.prototype.sourceContentFor=function(c,d){if(!this.sourcesContent)return null;var h=this._findSourceIndex(c);if(h>=0)return this.sourcesContent[h];var f=c;this.sourceRoot!=null&&(f=t.relative(this.sourceRoot,f));var p;if(this.sourceRoot!=null&&(p=t.urlParse(this.sourceRoot))){var m=f.replace(/^file:\/\//,"");if(p.scheme=="file"&&this._sources.has(m))return this.sourcesContent[this._sources.indexOf(m)];if((!p.path||p.path=="/")&&this._sources.has("/"+f))return this.sourcesContent[this._sources.indexOf("/"+f)]}if(d)return null;throw new Error('"'+f+'" is not in the SourceMap.')},o.prototype.generatedPositionFor=function(c){var d=t.getArg(c,"source");if(d=this._findSourceIndex(d),d<0)return{line:null,column:null,lastColumn:null};var h={source:d,originalLine:t.getArg(c,"line"),originalColumn:t.getArg(c,"column")},f=this._findMapping(h,this._originalMappings,"originalLine","originalColumn",t.compareByOriginalPositions,t.getArg(c,"bias",i.GREATEST_LOWER_BOUND));if(f>=0){var p=this._originalMappings[f];if(p.source===h.source)return{line:t.getArg(p,"generatedLine",null),column:t.getArg(p,"generatedColumn",null),lastColumn:t.getArg(p,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},n0.BasicSourceMapConsumer=o;function u(l,c){var d=l;typeof l=="string"&&(d=t.parseSourceMapInput(l));var h=t.getArg(d,"version"),f=t.getArg(d,"sections");if(h!=this._version)throw new Error("Unsupported version: "+h);this._sources=new r,this._names=new r;var p={line:-1,column:0};this._sections=f.map(function(m){if(m.url)throw new Error("Support for url field in sections not implemented.");var E=t.getArg(m,"offset"),A=t.getArg(E,"line"),_=t.getArg(E,"column");if(A<p.line||A===p.line&&_<p.column)throw new Error("Section offsets must be ordered and non-overlapping.");return p=E,{generatedOffset:{generatedLine:A+1,generatedColumn:_+1},consumer:new i(t.getArg(m,"map"),c)}})}return u.prototype=Object.create(i.prototype),u.prototype.constructor=i,u.prototype._version=3,Object.defineProperty(u.prototype,"sources",{get:function(){for(var l=[],c=0;c<this._sections.length;c++)for(var d=0;d<this._sections[c].consumer.sources.length;d++)l.push(this._sections[c].consumer.sources[d]);return l}}),u.prototype.originalPositionFor=function(c){var d={generatedLine:t.getArg(c,"line"),generatedColumn:t.getArg(c,"column")},h=e.search(d,this._sections,function(p,m){var E=p.generatedLine-m.generatedOffset.generatedLine;return E||p.generatedColumn-m.generatedOffset.generatedColumn}),f=this._sections[h];return f?f.consumer.originalPositionFor({line:d.generatedLine-(f.generatedOffset.generatedLine-1),column:d.generatedColumn-(f.generatedOffset.generatedLine===d.generatedLine?f.generatedOffset.generatedColumn-1:0),bias:c.bias}):{source:null,line:null,column:null,name:null}},u.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(c){return c.consumer.hasContentsOfAllSources()})},u.prototype.sourceContentFor=function(c,d){for(var h=0;h<this._sections.length;h++){var f=this._sections[h],p=f.consumer.sourceContentFor(c,!0);if(p)return p}if(d)return null;throw new Error('"'+c+'" is not in the SourceMap.')},u.prototype.generatedPositionFor=function(c){for(var d=0;d<this._sections.length;d++){var h=this._sections[d];if(h.consumer._findSourceIndex(t.getArg(c,"source"))!==-1){var f=h.consumer.generatedPositionFor(c);if(f){var p={line:f.line+(h.generatedOffset.generatedLine-1),column:f.column+(h.generatedOffset.generatedLine===f.line?h.generatedOffset.generatedColumn-1:0)};return p}}}return{line:null,column:null}},u.prototype._parseMappings=function(c,d){this.__generatedMappings=[],this.__originalMappings=[];for(var h=0;h<this._sections.length;h++)for(var f=this._sections[h],p=f.consumer._generatedMappings,m=0;m<p.length;m++){var E=p[m],A=f.consumer._sources.at(E.source);A=t.computeSourceURL(f.consumer.sourceRoot,A,this._sourceMapURL),this._sources.add(A),A=this._sources.indexOf(A);var _=null;E.name&&(_=f.consumer._names.at(E.name),this._names.add(_),_=this._names.indexOf(_));var g={source:A,generatedLine:E.generatedLine+(f.generatedOffset.generatedLine-1),generatedColumn:E.generatedColumn+(f.generatedOffset.generatedLine===E.generatedLine?f.generatedOffset.generatedColumn-1:0),originalLine:E.originalLine,originalColumn:E.originalColumn,name:_};this.__generatedMappings.push(g),typeof g.originalLine=="number"&&this.__originalMappings.push(g)}s(this.__generatedMappings,t.compareByGeneratedPositionsDeflated),s(this.__originalMappings,t.compareByOriginalPositions)},n0.IndexedSourceMapConsumer=u,n0}var jT={},t6;function Tye(){if(t6)return jT;t6=1;var t=nV().SourceMapGenerator,e=Ww(),r=/(\r?\n)/,n=10,s="$$$isSourceNode$$$";function i(o,a,u,l,c){this.children=[],this.sourceContents={},this.line=o??null,this.column=a??null,this.source=u??null,this.name=c??null,this[s]=!0,l!=null&&this.add(l)}return i.fromStringWithSourceMap=function(a,u,l){var c=new i,d=a.split(r),h=0,f=function(){var _=v(),g=v()||"";return _+g;function v(){return h<d.length?d[h++]:void 0}},p=1,m=0,E=null;return u.eachMapping(function(_){if(E!==null)if(p<_.generatedLine)A(E,f()),p++,m=0;else{var g=d[h]||"",v=g.substr(0,_.generatedColumn-m);d[h]=g.substr(_.generatedColumn-m),m=_.generatedColumn,A(E,v),E=_;return}for(;p<_.generatedLine;)c.add(f()),p++;if(m<_.generatedColumn){var g=d[h]||"";c.add(g.substr(0,_.generatedColumn)),d[h]=g.substr(_.generatedColumn),m=_.generatedColumn}E=_},this),h<d.length&&(E&&A(E,f()),c.add(d.splice(h).join(""))),u.sources.forEach(function(_){var g=u.sourceContentFor(_);g!=null&&(l!=null&&(_=e.join(l,_)),c.setSourceContent(_,g))}),c;function A(_,g){if(_===null||_.source===void 0)c.add(g);else{var v=l?e.join(l,_.source):_.source;c.add(new i(_.originalLine,_.originalColumn,v,g,_.name))}}},i.prototype.add=function(a){if(Array.isArray(a))a.forEach(function(u){this.add(u)},this);else if(a[s]||typeof a=="string")a&&this.children.push(a);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+a);return this},i.prototype.prepend=function(a){if(Array.isArray(a))for(var u=a.length-1;u>=0;u--)this.prepend(a[u]);else if(a[s]||typeof a=="string")this.children.unshift(a);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+a);return this},i.prototype.walk=function(a){for(var u,l=0,c=this.children.length;l<c;l++)u=this.children[l],u[s]?u.walk(a):u!==""&&a(u,{source:this.source,line:this.line,column:this.column,name:this.name})},i.prototype.join=function(a){var u,l,c=this.children.length;if(c>0){for(u=[],l=0;l<c-1;l++)u.push(this.children[l]),u.push(a);u.push(this.children[l]),this.children=u}return this},i.prototype.replaceRight=function(a,u){var l=this.children[this.children.length-1];return l[s]?l.replaceRight(a,u):typeof l=="string"?this.children[this.children.length-1]=l.replace(a,u):this.children.push("".replace(a,u)),this},i.prototype.setSourceContent=function(a,u){this.sourceContents[e.toSetString(a)]=u},i.prototype.walkSourceContents=function(a){for(var u=0,l=this.children.length;u<l;u++)this.children[u][s]&&this.children[u].walkSourceContents(a);for(var c=Object.keys(this.sourceContents),u=0,l=c.length;u<l;u++)a(e.fromSetString(c[u]),this.sourceContents[c[u]])},i.prototype.toString=function(){var a="";return this.walk(function(u){a+=u}),a},i.prototype.toStringWithSourceMap=function(a){var u={code:"",line:1,column:0},l=new t(a),c=!1,d=null,h=null,f=null,p=null;return this.walk(function(m,E){u.code+=m,E.source!==null&&E.line!==null&&E.column!==null?((d!==E.source||h!==E.line||f!==E.column||p!==E.name)&&l.addMapping({source:E.source,original:{line:E.line,column:E.column},generated:{line:u.line,column:u.column},name:E.name}),d=E.source,h=E.line,f=E.column,p=E.name,c=!0):c&&(l.addMapping({generated:{line:u.line,column:u.column}}),d=null,c=!1);for(var A=0,_=m.length;A<_;A++)m.charCodeAt(A)===n?(u.line++,u.column=0,A+1===_?(d=null,c=!1):c&&l.addMapping({source:E.source,original:{line:E.line,column:E.column},generated:{line:u.line,column:u.column},name:E.name})):u.column++}),this.walkSourceContents(function(m,E){l.setSourceContent(m,E)}),{code:u.code,map:l}},jT.SourceNode=i,jT}var r6;function Dye(){return r6||(r6=1,r0.SourceMapGenerator=nV().SourceMapGenerator,r0.SourceMapConsumer=Sye().SourceMapConsumer,r0.SourceNode=Tye().SourceNode),r0}const xye="escodegen",Pye="ECMAScript code generator",Cye="http://github.com/estools/escodegen",Iye="escodegen.js",kye={esgenerate:"./bin/esgenerate.js",escodegen:"./bin/escodegen.js"},$ye=["LICENSE.BSD","README.md","bin","escodegen.js","package.json"],Oye="1.14.3",Rye={node:">=4.0"},Nye=[{name:"Yusuke Suzuki",email:"utatane.tea@gmail.com",web:"http://github.com/Constellation"}],Bye={type:"git",url:"http://github.com/estools/escodegen.git"},Fye={estraverse:"^4.2.0",esutils:"^2.0.2",esprima:"^4.0.1",optionator:"^0.8.1"},Mye={"source-map":"~0.6.1"},jye={acorn:"^7.1.0",bluebird:"^3.4.7","bower-registry-client":"^1.0.0",chai:"^3.5.0","commonjs-everywhere":"^0.9.7",gulp:"^3.8.10","gulp-eslint":"^3.0.1","gulp-mocha":"^3.0.1",semver:"^5.1.0"},Uye="BSD-2-Clause",Lye={test:"gulp travis","unit-test":"gulp test",lint:"gulp lint",release:"node tools/release.js","build-min":"./node_modules/.bin/cjsify -ma path: tools/entry-point.js > escodegen.browser.min.js",build:"./node_modules/.bin/cjsify -a path: tools/entry-point.js > escodegen.browser.js"},Kye={name:xye,description:Pye,homepage:Cye,main:Iye,bin:kye,files:$ye,version:Oye,engines:Rye,maintainers:Nye,repository:Bye,dependencies:Fye,optionalDependencies:Mye,devDependencies:jye,license:Uye,scripts:Lye};(function(t){(function(){var e,r,n,s,i,o,a,u,l,c,d,h,f,p,m,E,A,_,g,v,S,x,D,w,b,T;i=XK,o=x1,e=i.Syntax;function P(O){return Ct.Expression.hasOwnProperty(O.type)}function C(O){return Ct.Statement.hasOwnProperty(O.type)}r={Sequence:0,Yield:1,Assignment:1,Conditional:2,ArrowFunction:2,LogicalOR:3,LogicalAND:4,BitwiseOR:5,BitwiseXOR:6,BitwiseAND:7,Equality:8,Relational:9,BitwiseSHIFT:10,Additive:11,Multiplicative:12,Exponentiation:13,Await:14,Unary:14,Postfix:15,Call:16,New:17,TaggedTemplate:18,Member:19,Primary:20},n={"||":r.LogicalOR,"&&":r.LogicalAND,"|":r.BitwiseOR,"^":r.BitwiseXOR,"&":r.BitwiseAND,"==":r.Equality,"!=":r.Equality,"===":r.Equality,"!==":r.Equality,is:r.Equality,isnt:r.Equality,"<":r.Relational,">":r.Relational,"<=":r.Relational,">=":r.Relational,in:r.Relational,instanceof:r.Relational,"<<":r.BitwiseSHIFT,">>":r.BitwiseSHIFT,">>>":r.BitwiseSHIFT,"+":r.Additive,"-":r.Additive,"*":r.Multiplicative,"%":r.Multiplicative,"/":r.Multiplicative,"**":r.Exponentiation};var k=1,K=2,L=4,q=8,se=16,X=32,re=K|L,W=k|K,B=k|K|L,te=k,z=L,$=k|L,F=k,ee=k|X,ne=0,le=k|se,me=k|q;function ve(){return{indent:null,base:null,parse:null,comment:!1,format:{indent:{style:"    ",base:0,adjustMultilineComment:!1},newline:`
`,space:" ",json:!1,renumber:!1,hexadecimal:!1,quotes:"single",escapeless:!1,compact:!1,parentheses:!0,semicolons:!0,safeConcatenation:!1,preserveBlankLines:!1},moz:{comprehensionExpressionStartsWithAssignment:!1,starlessGenerator:!1},sourceMap:null,sourceMapRoot:null,sourceMapWithCode:!1,directive:!1,raw:!0,verbatim:null,sourceCode:null}}function Pe(O,Y){var H="";for(Y|=0;Y>0;Y>>>=1,O+=O)Y&1&&(H+=O);return H}function Ue(O){return/[\r\n]/g.test(O)}function M(O){var Y=O.length;return Y&&o.code.isLineTerminator(O.charCodeAt(Y-1))}function V(O,Y){var H;for(H in Y)Y.hasOwnProperty(H)&&(O[H]=Y[H]);return O}function oe(O,Y){var H,Z;function ae(Te){return typeof Te=="object"&&Te instanceof Object&&!(Te instanceof RegExp)}for(H in Y)Y.hasOwnProperty(H)&&(Z=Y[H],ae(Z)?ae(O[H])?oe(O[H],Z):O[H]=oe({},Z):O[H]=Z);return O}function j(O){var Y,H,Z,ae,Te;if(O!==O)throw new Error("Numeric literal whose value is NaN");if(O<0||O===0&&1/O<0)throw new Error("Numeric literal whose value is negative");if(O===1/0)return l?"null":c?"1e400":"1e+400";if(Y=""+O,!c||Y.length<3)return Y;for(H=Y.indexOf("."),!l&&Y.charCodeAt(0)===48&&H===1&&(H=0,Y=Y.slice(1)),Z=Y,Y=Y.replace("e+","e"),ae=0,(Te=Z.indexOf("e"))>0&&(ae=+Z.slice(Te+1),Z=Z.slice(0,Te)),H>=0&&(ae-=Z.length-H-1,Z=+(Z.slice(0,H)+Z.slice(H+1))+""),Te=0;Z.charCodeAt(Z.length+Te-1)===48;)--Te;return Te!==0&&(ae-=Te,Z=Z.slice(0,Te)),ae!==0&&(Z+="e"+ae),(Z.length<Y.length||d&&O>1e12&&Math.floor(O)===O&&(Z="0x"+O.toString(16)).length<Y.length)&&+Z===O&&(Y=Z),Y}function I(O,Y){return(O&-2)===8232?(Y?"u":"\\u")+(O===8232?"2028":"2029"):O===10||O===13?(Y?"":"\\")+(O===10?"n":"r"):String.fromCharCode(O)}function N(O){var Y,H,Z,ae,Te,xe,$e,qe;if(H=O.toString(),O.source){if(Y=H.match(/\/([^/]*)$/),!Y)return H;for(Z=Y[1],H="",$e=!1,qe=!1,ae=0,Te=O.source.length;ae<Te;++ae)xe=O.source.charCodeAt(ae),qe?(H+=I(xe,qe),qe=!1):($e?xe===93&&($e=!1):xe===47?H+="\\":xe===91&&($e=!0),H+=I(xe,qe),qe=xe===92);return"/"+H+"/"+Z}return H}function Q(O,Y){var H;return O===8?"\\b":O===12?"\\f":O===9?"\\t":(H=O.toString(16).toUpperCase(),l||O>255?"\\u"+"0000".slice(H.length)+H:O===0&&!o.code.isDecimalDigit(Y)?"\\0":O===11?"\\x0B":"\\x"+"00".slice(H.length)+H)}function ce(O){if(O===92)return"\\\\";if(O===10)return"\\n";if(O===13)return"\\r";if(O===8232)return"\\u2028";if(O===8233)return"\\u2029";throw new Error("Incorrectly classified character")}function pe(O){var Y,H,Z,ae;for(ae=h==="double"?'"':"'",Y=0,H=O.length;Y<H;++Y)if(Z=O.charCodeAt(Y),Z===39){ae='"';break}else if(Z===34){ae="'";break}else Z===92&&++Y;return ae+O+ae}function he(O){var Y="",H,Z,ae,Te=0,xe=0,$e,qe;for(H=0,Z=O.length;H<Z;++H){if(ae=O.charCodeAt(H),ae===39)++Te;else if(ae===34)++xe;else if(ae===47&&l)Y+="\\";else if(o.code.isLineTerminator(ae)||ae===92){Y+=ce(ae);continue}else if(!o.code.isIdentifierPartES5(ae)&&(l&&ae<32||!l&&!f&&(ae<32||ae>126))){Y+=Q(ae,O.charCodeAt(H+1));continue}Y+=String.fromCharCode(ae)}if($e=!(h==="double"||h==="auto"&&xe<Te),qe=$e?"'":'"',!($e?Te:xe))return qe+Y+qe;for(O=Y,Y=qe,H=0,Z=O.length;H<Z;++H)ae=O.charCodeAt(H),(ae===39&&$e||ae===34&&!$e)&&(Y+="\\"),Y+=String.fromCharCode(ae);return Y+qe}function Ce(O){var Y,H,Z,ae="";for(Y=0,H=O.length;Y<H;++Y)Z=O[Y],ae+=Array.isArray(Z)?Ce(Z):Z;return ae}function _e(O,Y){if(!x)return Array.isArray(O)?Ce(O):O;if(Y==null){if(O instanceof s)return O;Y={}}return Y.loc==null?new s(null,null,x,O,Y.name||null):new s(Y.loc.start.line,Y.loc.start.column,x===!0?Y.loc.source||null:x,O,Y.name||null)}function G(){return m||" "}function J(O,Y){var H,Z,ae,Te;return H=_e(O).toString(),H.length===0?[Y]:(Z=_e(Y).toString(),Z.length===0?[O]:(ae=H.charCodeAt(H.length-1),Te=Z.charCodeAt(0),(ae===43||ae===45)&&ae===Te||o.code.isIdentifierPartES5(ae)&&o.code.isIdentifierPartES5(Te)||ae===47&&Te===105?[O,G(),Y]:o.code.isWhiteSpace(ae)||o.code.isLineTerminator(ae)||o.code.isWhiteSpace(Te)||o.code.isLineTerminator(Te)?[O,Y]:[O,m,Y]))}function ge(O){return[a,O]}function be(O){var Y;Y=a,a+=u,O(a),a=Y}function ke(O){var Y;for(Y=O.length-1;Y>=0&&!o.code.isLineTerminator(O.charCodeAt(Y));--Y);return O.length-1-Y}function At(O,Y){var H,Z,ae,Te,xe,$e,qe,Nt;for(H=O.split(/\r\n|[\r\n]/),$e=Number.MAX_VALUE,Z=1,ae=H.length;Z<ae;++Z){for(Te=H[Z],xe=0;xe<Te.length&&o.code.isWhiteSpace(Te.charCodeAt(xe));)++xe;$e>xe&&($e=xe)}for(typeof Y<"u"?(qe=a,H[1][$e]==="*"&&(Y+=" "),a=Y):($e&1&&--$e,qe=a),Z=1,ae=H.length;Z<ae;++Z)Nt=_e(ge(H[Z].slice($e))),H[Z]=x?Nt.join(""):Nt;return a=qe,H.join(`
`)}function kt(O,Y){if(O.type==="Line"){if(M(O.value))return"//"+O.value;var H="//"+O.value;return w||(H+=`
`),H}return v.format.indent.adjustMultilineComment&&/[\n\r]/.test(O.value)?At("/*"+O.value+"*/",Y):"/*"+O.value+"*/"}function $r(O,Y){var H,Z,ae,Te,xe,$e,qe,Nt,de,ue,fe,Ae,Ee,We;if(O.leadingComments&&O.leadingComments.length>0){if(Te=Y,w){for(ae=O.leadingComments[0],Y=[],Nt=ae.extendedRange,de=ae.range,fe=D.substring(Nt[0],de[0]),We=(fe.match(/\n/g)||[]).length,We>0?(Y.push(Pe(`
`,We)),Y.push(ge(kt(ae)))):(Y.push(fe),Y.push(kt(ae))),ue=de,H=1,Z=O.leadingComments.length;H<Z;H++)ae=O.leadingComments[H],de=ae.range,Ae=D.substring(ue[1],de[0]),We=(Ae.match(/\n/g)||[]).length,Y.push(Pe(`
`,We)),Y.push(ge(kt(ae))),ue=de;Ee=D.substring(de[1],Nt[1]),We=(Ee.match(/\n/g)||[]).length,Y.push(Pe(`
`,We))}else for(ae=O.leadingComments[0],Y=[],_&&O.type===e.Program&&O.body.length===0&&Y.push(`
`),Y.push(kt(ae)),M(_e(Y).toString())||Y.push(`
`),H=1,Z=O.leadingComments.length;H<Z;++H)ae=O.leadingComments[H],qe=[kt(ae)],M(_e(qe).toString())||qe.push(`
`),Y.push(ge(qe));Y.push(ge(Te))}if(O.trailingComments)if(w)ae=O.trailingComments[0],Nt=ae.extendedRange,de=ae.range,fe=D.substring(Nt[0],de[0]),We=(fe.match(/\n/g)||[]).length,We>0?(Y.push(Pe(`
`,We)),Y.push(ge(kt(ae)))):(Y.push(fe),Y.push(kt(ae)));else for(xe=!M(_e(Y).toString()),$e=Pe(" ",ke(_e([a,Y,u]).toString())),H=0,Z=O.trailingComments.length;H<Z;++H)ae=O.trailingComments[H],xe?(H===0?Y=[Y,u]:Y=[Y,$e],Y.push(kt(ae,$e))):Y=[Y,ge(kt(ae))],H!==Z-1&&!M(_e(Y).toString())&&(Y=[Y,`
`]);return Y}function Wt(O,Y,H){var Z,ae=0;for(Z=O;Z<Y;Z++)D[Z]===`
`&&ae++;for(Z=1;Z<ae;Z++)H.push(p)}function cr(O,Y,H){return Y<H?["(",O,")"]:O}function zs(O){var Y,H,Z;for(Z=O.split(/\r\n|\n/),Y=1,H=Z.length;Y<H;Y++)Z[Y]=p+a+Z[Y];return Z}function un(O,Y){var H,Z,ae;return H=O[v.verbatim],typeof H=="string"?Z=cr(zs(H),r.Sequence,Y):(Z=zs(H.content),ae=H.precedence!=null?H.precedence:r.Sequence,Z=cr(Z,ae,Y)),_e(Z,O)}function Ct(){}Ct.prototype.maybeBlock=function(O,Y){var H,Z,ae=this;return Z=!v.comment||!O.leadingComments,O.type===e.BlockStatement&&Z?[m,this.generateStatement(O,Y)]:O.type===e.EmptyStatement&&Z?";":(be(function(){H=[p,ge(ae.generateStatement(O,Y))]}),H)},Ct.prototype.maybeBlockSuffix=function(O,Y){var H=M(_e(Y).toString());return O.type===e.BlockStatement&&(!v.comment||!O.leadingComments)&&!H?[Y,m]:H?[Y,a]:[Y,p,a]};function Wr(O){return _e(O.name,O)}function _s(O,Y){return O.async?"async"+(Y?G():m):""}function Ws(O){var Y=O.generator&&!v.moz.starlessGenerator;return Y?"*"+m:""}function Ui(O){var Y=O.value,H="";return Y.async&&(H+=_s(Y,!O.computed)),Y.generator&&(H+=Ws(Y)?"*":""),H}Ct.prototype.generatePattern=function(O,Y,H){return O.type===e.Identifier?Wr(O):this.generateExpression(O,Y,H)},Ct.prototype.generateFunctionParams=function(O){var Y,H,Z,ae;if(ae=!1,O.type===e.ArrowFunctionExpression&&!O.rest&&(!O.defaults||O.defaults.length===0)&&O.params.length===1&&O.params[0].type===e.Identifier)Z=[_s(O,!0),Wr(O.params[0])];else{for(Z=O.type===e.ArrowFunctionExpression?[_s(O,!1)]:[],Z.push("("),O.defaults&&(ae=!0),Y=0,H=O.params.length;Y<H;++Y)ae&&O.defaults[Y]?Z.push(this.generateAssignment(O.params[Y],O.defaults[Y],"=",r.Assignment,B)):Z.push(this.generatePattern(O.params[Y],r.Assignment,B)),Y+1<H&&Z.push(","+m);O.rest&&(O.params.length&&Z.push(","+m),Z.push("..."),Z.push(Wr(O.rest))),Z.push(")")}return Z},Ct.prototype.generateFunctionBody=function(O){var Y,H;return Y=this.generateFunctionParams(O),O.type===e.ArrowFunctionExpression&&(Y.push(m),Y.push("=>")),O.expression?(Y.push(m),H=this.generateExpression(O.body,r.Assignment,B),H.toString().charAt(0)==="{"&&(H=["(",H,")"]),Y.push(H)):Y.push(this.maybeBlock(O.body,me)),Y},Ct.prototype.generateIterationForStatement=function(O,Y,H){var Z=["for"+(Y.await?G()+"await":"")+m+"("],ae=this;return be(function(){Y.left.type===e.VariableDeclaration?be(function(){Z.push(Y.left.kind+G()),Z.push(ae.generateStatement(Y.left.declarations[0],ne))}):Z.push(ae.generateExpression(Y.left,r.Call,B)),Z=J(Z,O),Z=[J(Z,ae.generateExpression(Y.right,r.Assignment,B)),")"]}),Z.push(this.maybeBlock(Y.body,H)),Z},Ct.prototype.generatePropertyKey=function(O,Y){var H=[];return Y&&H.push("["),H.push(this.generateExpression(O,r.Assignment,B)),Y&&H.push("]"),H},Ct.prototype.generateAssignment=function(O,Y,H,Z,ae){return r.Assignment<Z&&(ae|=k),cr([this.generateExpression(O,r.Call,ae),m+H+m,this.generateExpression(Y,r.Assignment,ae)],r.Assignment,Z)},Ct.prototype.semicolon=function(O){return!A&&O&X?"":";"},Ct.Statement={BlockStatement:function(O,Y){var H,Z,ae=["{",p],Te=this;return be(function(){O.body.length===0&&w&&(H=O.range,H[1]-H[0]>2&&(Z=D.substring(H[0]+1,H[1]-1),Z[0]===`
`&&(ae=["{"]),ae.push(Z)));var xe,$e,qe,Nt;for(Nt=F,Y&q&&(Nt|=se),xe=0,$e=O.body.length;xe<$e;++xe)w&&(xe===0&&(O.body[0].leadingComments&&(H=O.body[0].leadingComments[0].extendedRange,Z=D.substring(H[0],H[1]),Z[0]===`
`&&(ae=["{"])),O.body[0].leadingComments||Wt(O.range[0],O.body[0].range[0],ae)),xe>0&&!O.body[xe-1].trailingComments&&!O.body[xe].leadingComments&&Wt(O.body[xe-1].range[1],O.body[xe].range[0],ae)),xe===$e-1&&(Nt|=X),O.body[xe].leadingComments&&w?qe=Te.generateStatement(O.body[xe],Nt):qe=ge(Te.generateStatement(O.body[xe],Nt)),ae.push(qe),M(_e(qe).toString())||w&&xe<$e-1&&O.body[xe+1].leadingComments||ae.push(p),w&&xe===$e-1&&(O.body[xe].trailingComments||Wt(O.body[xe].range[1],O.range[1],ae))}),ae.push(ge("}")),ae},BreakStatement:function(O,Y){return O.label?"break "+O.label.name+this.semicolon(Y):"break"+this.semicolon(Y)},ContinueStatement:function(O,Y){return O.label?"continue "+O.label.name+this.semicolon(Y):"continue"+this.semicolon(Y)},ClassBody:function(O,Y){var H=["{",p],Z=this;return be(function(ae){var Te,xe;for(Te=0,xe=O.body.length;Te<xe;++Te)H.push(ae),H.push(Z.generateExpression(O.body[Te],r.Sequence,B)),Te+1<xe&&H.push(p)}),M(_e(H).toString())||H.push(p),H.push(a),H.push("}"),H},ClassDeclaration:function(O,Y){var H,Z;return H=["class"],O.id&&(H=J(H,this.generateExpression(O.id,r.Sequence,B))),O.superClass&&(Z=J("extends",this.generateExpression(O.superClass,r.Unary,B)),H=J(H,Z)),H.push(m),H.push(this.generateStatement(O.body,ee)),H},DirectiveStatement:function(O,Y){return v.raw&&O.raw?O.raw+this.semicolon(Y):pe(O.directive)+this.semicolon(Y)},DoWhileStatement:function(O,Y){var H=J("do",this.maybeBlock(O.body,F));return H=this.maybeBlockSuffix(O.body,H),J(H,["while"+m+"(",this.generateExpression(O.test,r.Sequence,B),")"+this.semicolon(Y)])},CatchClause:function(O,Y){var H,Z=this;return be(function(){var ae;O.param?(H=["catch"+m+"(",Z.generateExpression(O.param,r.Sequence,B),")"],O.guard&&(ae=Z.generateExpression(O.guard,r.Sequence,B),H.splice(2,0," if ",ae))):H=["catch"]}),H.push(this.maybeBlock(O.body,F)),H},DebuggerStatement:function(O,Y){return"debugger"+this.semicolon(Y)},EmptyStatement:function(O,Y){return";"},ExportDefaultDeclaration:function(O,Y){var H=["export"],Z;return Z=Y&X?ee:F,H=J(H,"default"),C(O.declaration)?H=J(H,this.generateStatement(O.declaration,Z)):H=J(H,this.generateExpression(O.declaration,r.Assignment,B)+this.semicolon(Y)),H},ExportNamedDeclaration:function(O,Y){var H=["export"],Z,ae=this;return Z=Y&X?ee:F,O.declaration?J(H,this.generateStatement(O.declaration,Z)):(O.specifiers&&(O.specifiers.length===0?H=J(H,"{"+m+"}"):O.specifiers[0].type===e.ExportBatchSpecifier?H=J(H,this.generateExpression(O.specifiers[0],r.Sequence,B)):(H=J(H,"{"),be(function(Te){var xe,$e;for(H.push(p),xe=0,$e=O.specifiers.length;xe<$e;++xe)H.push(Te),H.push(ae.generateExpression(O.specifiers[xe],r.Sequence,B)),xe+1<$e&&H.push(","+p)}),M(_e(H).toString())||H.push(p),H.push(a+"}")),O.source?H=J(H,["from"+m,this.generateExpression(O.source,r.Sequence,B),this.semicolon(Y)]):H.push(this.semicolon(Y))),H)},ExportAllDeclaration:function(O,Y){return["export"+m,"*"+m,"from"+m,this.generateExpression(O.source,r.Sequence,B),this.semicolon(Y)]},ExpressionStatement:function(O,Y){var H,Z;function ae($e){var qe;return $e.slice(0,5)!=="class"?!1:(qe=$e.charCodeAt(5),qe===123||o.code.isWhiteSpace(qe)||o.code.isLineTerminator(qe))}function Te($e){var qe;return $e.slice(0,8)!=="function"?!1:(qe=$e.charCodeAt(8),qe===40||o.code.isWhiteSpace(qe)||qe===42||o.code.isLineTerminator(qe))}function xe($e){var qe,Nt,de;if($e.slice(0,5)!=="async"||!o.code.isWhiteSpace($e.charCodeAt(5)))return!1;for(Nt=6,de=$e.length;Nt<de&&o.code.isWhiteSpace($e.charCodeAt(Nt));++Nt);return Nt===de||$e.slice(Nt,Nt+8)!=="function"?!1:(qe=$e.charCodeAt(Nt+8),qe===40||o.code.isWhiteSpace(qe)||qe===42||o.code.isLineTerminator(qe))}return H=[this.generateExpression(O.expression,r.Sequence,B)],Z=_e(H).toString(),Z.charCodeAt(0)===123||ae(Z)||Te(Z)||xe(Z)||g&&Y&se&&O.expression.type===e.Literal&&typeof O.expression.value=="string"?H=["(",H,")"+this.semicolon(Y)]:H.push(this.semicolon(Y)),H},ImportDeclaration:function(O,Y){var H,Z,ae=this;return O.specifiers.length===0?["import",m,this.generateExpression(O.source,r.Sequence,B),this.semicolon(Y)]:(H=["import"],Z=0,O.specifiers[Z].type===e.ImportDefaultSpecifier&&(H=J(H,[this.generateExpression(O.specifiers[Z],r.Sequence,B)]),++Z),O.specifiers[Z]&&(Z!==0&&H.push(","),O.specifiers[Z].type===e.ImportNamespaceSpecifier?H=J(H,[m,this.generateExpression(O.specifiers[Z],r.Sequence,B)]):(H.push(m+"{"),O.specifiers.length-Z===1?(H.push(m),H.push(this.generateExpression(O.specifiers[Z],r.Sequence,B)),H.push(m+"}"+m)):(be(function(Te){var xe,$e;for(H.push(p),xe=Z,$e=O.specifiers.length;xe<$e;++xe)H.push(Te),H.push(ae.generateExpression(O.specifiers[xe],r.Sequence,B)),xe+1<$e&&H.push(","+p)}),M(_e(H).toString())||H.push(p),H.push(a+"}"+m)))),H=J(H,["from"+m,this.generateExpression(O.source,r.Sequence,B),this.semicolon(Y)]),H)},VariableDeclarator:function(O,Y){var H=Y&k?B:re;return O.init?[this.generateExpression(O.id,r.Assignment,H),m,"=",m,this.generateExpression(O.init,r.Assignment,H)]:this.generatePattern(O.id,r.Assignment,H)},VariableDeclaration:function(O,Y){var H,Z,ae,Te,xe,$e=this;H=[O.kind],xe=Y&k?F:ne;function qe(){for(Te=O.declarations[0],v.comment&&Te.leadingComments?(H.push(`
`),H.push(ge($e.generateStatement(Te,xe)))):(H.push(G()),H.push($e.generateStatement(Te,xe))),Z=1,ae=O.declarations.length;Z<ae;++Z)Te=O.declarations[Z],v.comment&&Te.leadingComments?(H.push(","+p),H.push(ge($e.generateStatement(Te,xe)))):(H.push(","+m),H.push($e.generateStatement(Te,xe)))}return O.declarations.length>1?be(qe):qe(),H.push(this.semicolon(Y)),H},ThrowStatement:function(O,Y){return[J("throw",this.generateExpression(O.argument,r.Sequence,B)),this.semicolon(Y)]},TryStatement:function(O,Y){var H,Z,ae,Te;if(H=["try",this.maybeBlock(O.block,F)],H=this.maybeBlockSuffix(O.block,H),O.handlers)for(Z=0,ae=O.handlers.length;Z<ae;++Z)H=J(H,this.generateStatement(O.handlers[Z],F)),(O.finalizer||Z+1!==ae)&&(H=this.maybeBlockSuffix(O.handlers[Z].body,H));else{for(Te=O.guardedHandlers||[],Z=0,ae=Te.length;Z<ae;++Z)H=J(H,this.generateStatement(Te[Z],F)),(O.finalizer||Z+1!==ae)&&(H=this.maybeBlockSuffix(Te[Z].body,H));if(O.handler)if(Array.isArray(O.handler))for(Z=0,ae=O.handler.length;Z<ae;++Z)H=J(H,this.generateStatement(O.handler[Z],F)),(O.finalizer||Z+1!==ae)&&(H=this.maybeBlockSuffix(O.handler[Z].body,H));else H=J(H,this.generateStatement(O.handler,F)),O.finalizer&&(H=this.maybeBlockSuffix(O.handler.body,H))}return O.finalizer&&(H=J(H,["finally",this.maybeBlock(O.finalizer,F)])),H},SwitchStatement:function(O,Y){var H,Z,ae,Te,xe,$e=this;if(be(function(){H=["switch"+m+"(",$e.generateExpression(O.discriminant,r.Sequence,B),")"+m+"{"+p]}),O.cases)for(xe=F,ae=0,Te=O.cases.length;ae<Te;++ae)ae===Te-1&&(xe|=X),Z=ge(this.generateStatement(O.cases[ae],xe)),H.push(Z),M(_e(Z).toString())||H.push(p);return H.push(ge("}")),H},SwitchCase:function(O,Y){var H,Z,ae,Te,xe,$e=this;return be(function(){for(O.test?H=[J("case",$e.generateExpression(O.test,r.Sequence,B)),":"]:H=["default:"],ae=0,Te=O.consequent.length,Te&&O.consequent[0].type===e.BlockStatement&&(Z=$e.maybeBlock(O.consequent[0],F),H.push(Z),ae=1),ae!==Te&&!M(_e(H).toString())&&H.push(p),xe=F;ae<Te;++ae)ae===Te-1&&Y&X&&(xe|=X),Z=ge($e.generateStatement(O.consequent[ae],xe)),H.push(Z),ae+1!==Te&&!M(_e(Z).toString())&&H.push(p)}),H},IfStatement:function(O,Y){var H,Z,ae,Te=this;return be(function(){H=["if"+m+"(",Te.generateExpression(O.test,r.Sequence,B),")"]}),ae=Y&X,Z=F,ae&&(Z|=X),O.alternate?(H.push(this.maybeBlock(O.consequent,F)),H=this.maybeBlockSuffix(O.consequent,H),O.alternate.type===e.IfStatement?H=J(H,["else ",this.generateStatement(O.alternate,Z)]):H=J(H,J("else",this.maybeBlock(O.alternate,Z)))):H.push(this.maybeBlock(O.consequent,Z)),H},ForStatement:function(O,Y){var H,Z=this;return be(function(){H=["for"+m+"("],O.init?O.init.type===e.VariableDeclaration?H.push(Z.generateStatement(O.init,ne)):(H.push(Z.generateExpression(O.init,r.Sequence,re)),H.push(";")):H.push(";"),O.test&&(H.push(m),H.push(Z.generateExpression(O.test,r.Sequence,B))),H.push(";"),O.update&&(H.push(m),H.push(Z.generateExpression(O.update,r.Sequence,B))),H.push(")")}),H.push(this.maybeBlock(O.body,Y&X?ee:F)),H},ForInStatement:function(O,Y){return this.generateIterationForStatement("in",O,Y&X?ee:F)},ForOfStatement:function(O,Y){return this.generateIterationForStatement("of",O,Y&X?ee:F)},LabeledStatement:function(O,Y){return[O.label.name+":",this.maybeBlock(O.body,Y&X?ee:F)]},Program:function(O,Y){var H,Z,ae,Te,xe;for(Te=O.body.length,H=[_&&Te>0?`
`:""],xe=le,ae=0;ae<Te;++ae)!_&&ae===Te-1&&(xe|=X),w&&(ae===0&&(O.body[0].leadingComments||Wt(O.range[0],O.body[ae].range[0],H)),ae>0&&!O.body[ae-1].trailingComments&&!O.body[ae].leadingComments&&Wt(O.body[ae-1].range[1],O.body[ae].range[0],H)),Z=ge(this.generateStatement(O.body[ae],xe)),H.push(Z),ae+1<Te&&!M(_e(Z).toString())&&(w&&O.body[ae+1].leadingComments||H.push(p)),w&&ae===Te-1&&(O.body[ae].trailingComments||Wt(O.body[ae].range[1],O.range[1],H));return H},FunctionDeclaration:function(O,Y){return[_s(O,!0),"function",Ws(O)||G(),O.id?Wr(O.id):"",this.generateFunctionBody(O)]},ReturnStatement:function(O,Y){return O.argument?[J("return",this.generateExpression(O.argument,r.Sequence,B)),this.semicolon(Y)]:["return"+this.semicolon(Y)]},WhileStatement:function(O,Y){var H,Z=this;return be(function(){H=["while"+m+"(",Z.generateExpression(O.test,r.Sequence,B),")"]}),H.push(this.maybeBlock(O.body,Y&X?ee:F)),H},WithStatement:function(O,Y){var H,Z=this;return be(function(){H=["with"+m+"(",Z.generateExpression(O.object,r.Sequence,B),")"]}),H.push(this.maybeBlock(O.body,Y&X?ee:F)),H}},V(Ct.prototype,Ct.Statement),Ct.Expression={SequenceExpression:function(O,Y,H){var Z,ae,Te;for(r.Sequence<Y&&(H|=k),Z=[],ae=0,Te=O.expressions.length;ae<Te;++ae)Z.push(this.generateExpression(O.expressions[ae],r.Assignment,H)),ae+1<Te&&Z.push(","+m);return cr(Z,r.Sequence,Y)},AssignmentExpression:function(O,Y,H){return this.generateAssignment(O.left,O.right,O.operator,Y,H)},ArrowFunctionExpression:function(O,Y,H){return cr(this.generateFunctionBody(O),r.ArrowFunction,Y)},ConditionalExpression:function(O,Y,H){return r.Conditional<Y&&(H|=k),cr([this.generateExpression(O.test,r.LogicalOR,H),m+"?"+m,this.generateExpression(O.consequent,r.Assignment,H),m+":"+m,this.generateExpression(O.alternate,r.Assignment,H)],r.Conditional,Y)},LogicalExpression:function(O,Y,H){return this.BinaryExpression(O,Y,H)},BinaryExpression:function(O,Y,H){var Z,ae,Te,xe,$e,qe;return xe=n[O.operator],ae=O.operator==="**"?r.Postfix:xe,Te=O.operator==="**"?xe:xe+1,xe<Y&&(H|=k),$e=this.generateExpression(O.left,ae,H),qe=$e.toString(),qe.charCodeAt(qe.length-1)===47&&o.code.isIdentifierPartES5(O.operator.charCodeAt(0))?Z=[$e,G(),O.operator]:Z=J($e,O.operator),$e=this.generateExpression(O.right,Te,H),O.operator==="/"&&$e.toString().charAt(0)==="/"||O.operator.slice(-1)==="<"&&$e.toString().slice(0,3)==="!--"?(Z.push(G()),Z.push($e)):Z=J(Z,$e),O.operator==="in"&&!(H&k)?["(",Z,")"]:cr(Z,xe,Y)},CallExpression:function(O,Y,H){var Z,ae,Te;for(Z=[this.generateExpression(O.callee,r.Call,W)],Z.push("("),ae=0,Te=O.arguments.length;ae<Te;++ae)Z.push(this.generateExpression(O.arguments[ae],r.Assignment,B)),ae+1<Te&&Z.push(","+m);return Z.push(")"),H&K?cr(Z,r.Call,Y):["(",Z,")"]},NewExpression:function(O,Y,H){var Z,ae,Te,xe,$e;if(ae=O.arguments.length,$e=H&L&&!E&&ae===0?$:te,Z=J("new",this.generateExpression(O.callee,r.New,$e)),!(H&L)||E||ae>0){for(Z.push("("),Te=0,xe=ae;Te<xe;++Te)Z.push(this.generateExpression(O.arguments[Te],r.Assignment,B)),Te+1<xe&&Z.push(","+m);Z.push(")")}return cr(Z,r.New,Y)},MemberExpression:function(O,Y,H){var Z,ae;return Z=[this.generateExpression(O.object,r.Call,H&K?W:te)],O.computed?(Z.push("["),Z.push(this.generateExpression(O.property,r.Sequence,H&K?B:$)),Z.push("]")):(O.object.type===e.Literal&&typeof O.object.value=="number"&&(ae=_e(Z).toString(),ae.indexOf(".")<0&&!/[eExX]/.test(ae)&&o.code.isDecimalDigit(ae.charCodeAt(ae.length-1))&&!(ae.length>=2&&ae.charCodeAt(0)===48)&&Z.push(" ")),Z.push("."),Z.push(Wr(O.property))),cr(Z,r.Member,Y)},MetaProperty:function(O,Y,H){var Z;return Z=[],Z.push(typeof O.meta=="string"?O.meta:Wr(O.meta)),Z.push("."),Z.push(typeof O.property=="string"?O.property:Wr(O.property)),cr(Z,r.Member,Y)},UnaryExpression:function(O,Y,H){var Z,ae,Te,xe,$e;return ae=this.generateExpression(O.argument,r.Unary,B),m===""?Z=J(O.operator,ae):(Z=[O.operator],O.operator.length>2?Z=J(Z,ae):(xe=_e(Z).toString(),$e=xe.charCodeAt(xe.length-1),Te=ae.toString().charCodeAt(0),(($e===43||$e===45)&&$e===Te||o.code.isIdentifierPartES5($e)&&o.code.isIdentifierPartES5(Te))&&Z.push(G()),Z.push(ae))),cr(Z,r.Unary,Y)},YieldExpression:function(O,Y,H){var Z;return O.delegate?Z="yield*":Z="yield",O.argument&&(Z=J(Z,this.generateExpression(O.argument,r.Yield,B))),cr(Z,r.Yield,Y)},AwaitExpression:function(O,Y,H){var Z=J(O.all?"await*":"await",this.generateExpression(O.argument,r.Await,B));return cr(Z,r.Await,Y)},UpdateExpression:function(O,Y,H){return O.prefix?cr([O.operator,this.generateExpression(O.argument,r.Unary,B)],r.Unary,Y):cr([this.generateExpression(O.argument,r.Postfix,B),O.operator],r.Postfix,Y)},FunctionExpression:function(O,Y,H){var Z=[_s(O,!0),"function"];return O.id?(Z.push(Ws(O)||G()),Z.push(Wr(O.id))):Z.push(Ws(O)||m),Z.push(this.generateFunctionBody(O)),Z},ArrayPattern:function(O,Y,H){return this.ArrayExpression(O,Y,H,!0)},ArrayExpression:function(O,Y,H,Z){var ae,Te,xe=this;return O.elements.length?(Te=Z?!1:O.elements.length>1,ae=["[",Te?p:""],be(function($e){var qe,Nt;for(qe=0,Nt=O.elements.length;qe<Nt;++qe)O.elements[qe]?(ae.push(Te?$e:""),ae.push(xe.generateExpression(O.elements[qe],r.Assignment,B))):(Te&&ae.push($e),qe+1===Nt&&ae.push(",")),qe+1<Nt&&ae.push(","+(Te?p:m))}),Te&&!M(_e(ae).toString())&&ae.push(p),ae.push(Te?a:""),ae.push("]"),ae):"[]"},RestElement:function(O,Y,H){return"..."+this.generatePattern(O.argument)},ClassExpression:function(O,Y,H){var Z,ae;return Z=["class"],O.id&&(Z=J(Z,this.generateExpression(O.id,r.Sequence,B))),O.superClass&&(ae=J("extends",this.generateExpression(O.superClass,r.Unary,B)),Z=J(Z,ae)),Z.push(m),Z.push(this.generateStatement(O.body,ee)),Z},MethodDefinition:function(O,Y,H){var Z,ae;return O.static?Z=["static"+m]:Z=[],O.kind==="get"||O.kind==="set"?ae=[J(O.kind,this.generatePropertyKey(O.key,O.computed)),this.generateFunctionBody(O.value)]:ae=[Ui(O),this.generatePropertyKey(O.key,O.computed),this.generateFunctionBody(O.value)],J(Z,ae)},Property:function(O,Y,H){return O.kind==="get"||O.kind==="set"?[O.kind,G(),this.generatePropertyKey(O.key,O.computed),this.generateFunctionBody(O.value)]:O.shorthand?O.value.type==="AssignmentPattern"?this.AssignmentPattern(O.value,r.Sequence,B):this.generatePropertyKey(O.key,O.computed):O.method?[Ui(O),this.generatePropertyKey(O.key,O.computed),this.generateFunctionBody(O.value)]:[this.generatePropertyKey(O.key,O.computed),":"+m,this.generateExpression(O.value,r.Assignment,B)]},ObjectExpression:function(O,Y,H){var Z,ae,Te,xe=this;return O.properties.length?(Z=O.properties.length>1,be(function(){Te=xe.generateExpression(O.properties[0],r.Sequence,B)}),!Z&&!Ue(_e(Te).toString())?["{",m,Te,m,"}"]:(be(function($e){var qe,Nt;if(ae=["{",p,$e,Te],Z)for(ae.push(","+p),qe=1,Nt=O.properties.length;qe<Nt;++qe)ae.push($e),ae.push(xe.generateExpression(O.properties[qe],r.Sequence,B)),qe+1<Nt&&ae.push(","+p)}),M(_e(ae).toString())||ae.push(p),ae.push(a),ae.push("}"),ae)):"{}"},AssignmentPattern:function(O,Y,H){return this.generateAssignment(O.left,O.right,"=",Y,H)},ObjectPattern:function(O,Y,H){var Z,ae,Te,xe,$e,qe=this;if(!O.properties.length)return"{}";if(xe=!1,O.properties.length===1)$e=O.properties[0],$e.type===e.Property&&$e.value.type!==e.Identifier&&(xe=!0);else for(ae=0,Te=O.properties.length;ae<Te;++ae)if($e=O.properties[ae],$e.type===e.Property&&!$e.shorthand){xe=!0;break}return Z=["{",xe?p:""],be(function(Nt){var de,ue;for(de=0,ue=O.properties.length;de<ue;++de)Z.push(xe?Nt:""),Z.push(qe.generateExpression(O.properties[de],r.Sequence,B)),de+1<ue&&Z.push(","+(xe?p:m))}),xe&&!M(_e(Z).toString())&&Z.push(p),Z.push(xe?a:""),Z.push("}"),Z},ThisExpression:function(O,Y,H){return"this"},Super:function(O,Y,H){return"super"},Identifier:function(O,Y,H){return Wr(O)},ImportDefaultSpecifier:function(O,Y,H){return Wr(O.id||O.local)},ImportNamespaceSpecifier:function(O,Y,H){var Z=["*"],ae=O.id||O.local;return ae&&Z.push(m+"as"+G()+Wr(ae)),Z},ImportSpecifier:function(O,Y,H){var Z=O.imported,ae=[Z.name],Te=O.local;return Te&&Te.name!==Z.name&&ae.push(G()+"as"+G()+Wr(Te)),ae},ExportSpecifier:function(O,Y,H){var Z=O.local,ae=[Z.name],Te=O.exported;return Te&&Te.name!==Z.name&&ae.push(G()+"as"+G()+Wr(Te)),ae},Literal:function(O,Y,H){var Z;if(O.hasOwnProperty("raw")&&S&&v.raw)try{if(Z=S(O.raw).body[0].expression,Z.type===e.Literal&&Z.value===O.value)return O.raw}catch{}return O.regex?"/"+O.regex.pattern+"/"+O.regex.flags:O.value===null?"null":typeof O.value=="string"?he(O.value):typeof O.value=="number"?j(O.value):typeof O.value=="boolean"?O.value?"true":"false":N(O.value)},GeneratorExpression:function(O,Y,H){return this.ComprehensionExpression(O,Y,H)},ComprehensionExpression:function(O,Y,H){var Z,ae,Te,xe,$e=this;return Z=O.type===e.GeneratorExpression?["("]:["["],v.moz.comprehensionExpressionStartsWithAssignment&&(xe=this.generateExpression(O.body,r.Assignment,B),Z.push(xe)),O.blocks&&be(function(){for(ae=0,Te=O.blocks.length;ae<Te;++ae)xe=$e.generateExpression(O.blocks[ae],r.Sequence,B),ae>0||v.moz.comprehensionExpressionStartsWithAssignment?Z=J(Z,xe):Z.push(xe)}),O.filter&&(Z=J(Z,"if"+m),xe=this.generateExpression(O.filter,r.Sequence,B),Z=J(Z,["(",xe,")"])),v.moz.comprehensionExpressionStartsWithAssignment||(xe=this.generateExpression(O.body,r.Assignment,B),Z=J(Z,xe)),Z.push(O.type===e.GeneratorExpression?")":"]"),Z},ComprehensionBlock:function(O,Y,H){var Z;return O.left.type===e.VariableDeclaration?Z=[O.left.kind,G(),this.generateStatement(O.left.declarations[0],ne)]:Z=this.generateExpression(O.left,r.Call,B),Z=J(Z,O.of?"of":"in"),Z=J(Z,this.generateExpression(O.right,r.Sequence,B)),["for"+m+"(",Z,")"]},SpreadElement:function(O,Y,H){return["...",this.generateExpression(O.argument,r.Assignment,B)]},TaggedTemplateExpression:function(O,Y,H){var Z=W;H&K||(Z=te);var ae=[this.generateExpression(O.tag,r.Call,Z),this.generateExpression(O.quasi,r.Primary,z)];return cr(ae,r.TaggedTemplate,Y)},TemplateElement:function(O,Y,H){return O.value.raw},TemplateLiteral:function(O,Y,H){var Z,ae,Te;for(Z=["`"],ae=0,Te=O.quasis.length;ae<Te;++ae)Z.push(this.generateExpression(O.quasis[ae],r.Primary,B)),ae+1<Te&&(Z.push("${"+m),Z.push(this.generateExpression(O.expressions[ae],r.Sequence,B)),Z.push(m+"}"));return Z.push("`"),Z},ModuleSpecifier:function(O,Y,H){return this.Literal(O,Y,H)},ImportExpression:function(O,Y,H){return cr(["import(",this.generateExpression(O.source,r.Assignment,B),")"],r.Call,Y)}},V(Ct.prototype,Ct.Expression),Ct.prototype.generateExpression=function(O,Y,H){var Z,ae;return ae=O.type||e.Property,v.verbatim&&O.hasOwnProperty(v.verbatim)?un(O,Y):(Z=this[ae](O,Y,H),v.comment&&(Z=$r(O,Z)),_e(Z,O))},Ct.prototype.generateStatement=function(O,Y){var H,Z;return H=this[O.type](O,Y),v.comment&&(H=$r(O,H)),Z=_e(H).toString(),O.type===e.Program&&!_&&p===""&&Z.charAt(Z.length-1)===`
`&&(H=x?_e(H).replaceRight(/\s+$/,""):Z.replace(/\s+$/,"")),_e(H,O)};function rs(O){var Y;if(Y=new Ct,C(O))return Y.generateStatement(O,F);if(P(O))return Y.generateExpression(O,r.Sequence,B);throw new Error("Unknown node type: "+O.type)}function ci(O,Y){var H=ve(),Z,ae;return Y!=null?(typeof Y.indent=="string"&&(H.format.indent.style=Y.indent),typeof Y.base=="number"&&(H.format.indent.base=Y.base),Y=oe(H,Y),u=Y.format.indent.style,typeof Y.base=="string"?a=Y.base:a=Pe(u,Y.format.indent.base)):(Y=H,u=Y.format.indent.style,a=Pe(u,Y.format.indent.base)),l=Y.format.json,c=Y.format.renumber,d=l?!1:Y.format.hexadecimal,h=l?"double":Y.format.quotes,f=Y.format.escapeless,p=Y.format.newline,m=Y.format.space,Y.format.compact&&(p=m=u=a=""),E=Y.format.parentheses,A=Y.format.semicolons,_=Y.format.safeConcatenation,g=Y.directive,S=l?null:Y.parse,x=Y.sourceMap,D=Y.sourceCode,w=Y.format.preserveBlankLines&&D!==null,v=Y,x&&(t.browser?s=Ar.sourceMap.SourceNode:s=Dye().SourceNode),Z=rs(O),x?(ae=Z.toStringWithSourceMap({file:Y.file,sourceRoot:Y.sourceMapRoot}),Y.sourceContent&&ae.map.setSourceContent(Y.sourceMap,Y.sourceContent),Y.sourceMapWithCode?ae:ae.map.toString()):(ae={code:Z.toString(),map:null},Y.sourceMapWithCode?ae:ae.code)}b={indent:{style:"",base:0},renumber:!0,hexadecimal:!0,quotes:"auto",escapeless:!0,compact:!0,parentheses:!1,semicolons:!1},T=ve().format,t.version=Kye.version,t.generate=ci,t.attachComments=i.attachComments,t.Precedence=oe({},r),t.browser=!1,t.FORMAT_MINIFY=b,t.FORMAT_DEFAULTS=T})()})(JK);var Vye=JK.generate,qye=function(t,e){e||(e={});var r={},n=function s(i,o){if(i.type==="Literal")return i.value;if(i.type==="UnaryExpression"){var a=s(i.argument);return i.operator==="+"?+a:i.operator==="-"?-a:i.operator==="~"?~a:i.operator==="!"?!a:r}else if(i.type==="ArrayExpression"){for(var u=[],l=0,c=i.elements.length;l<c;l++){var d=s(i.elements[l]);if(d===r)return r;u.push(d)}return u}else if(i.type==="ObjectExpression"){for(var h={},l=0;l<i.properties.length;l++){var f=i.properties[l],p=f.value===null?f.value:s(f.value);if(p===r)return r;h[f.key.value||f.key.name]=p}return h}else if(i.type==="BinaryExpression"||i.type==="LogicalExpression"){var c=s(i.left);if(c===r)return r;var m=s(i.right);if(m===r)return r;var E=i.operator;return E==="=="?c==m:E==="==="?c===m:E==="!="?c!=m:E==="!=="?c!==m:E==="+"?c+m:E==="-"?c-m:E==="*"?c*m:E==="/"?c/m:E==="%"?c%m:E==="<"?c<m:E==="<="?c<=m:E===">"?c>m:E===">="?c>=m:E==="|"?c|m:E==="&"?c&m:E==="^"?c^m:E==="&&"?c&&m:E==="||"?c||m:r}else{if(i.type==="Identifier")return{}.hasOwnProperty.call(e,i.name)?e[i.name]:r;if(i.type==="ThisExpression")return{}.hasOwnProperty.call(e,"this")?e.this:r;if(i.type==="CallExpression"){var A=s(i.callee);if(A===r||typeof A!="function")return r;var _=i.callee.object?s(i.callee.object):r;_===r&&(_=null);for(var g=[],l=0,c=i.arguments.length;l<c;l++){var d=s(i.arguments[l]);if(d===r)return r;g.push(d)}return A.apply(_,g)}else if(i.type==="MemberExpression"){var h=s(i.object);if(h===r||typeof h=="function")return r;if(i.property.type==="Identifier")return h[i.property.name];var f=s(i.property);return f===r?r:h[f]}else if(i.type==="ConditionalExpression"){var a=s(i.test);return a===r?r:s(a?i.consequent:i.alternate)}else if(i.type==="ExpressionStatement"){var a=s(i.expression);return a===r?r:a}else{if(i.type==="ReturnStatement")return s(i.argument);if(i.type==="FunctionExpression"){var v=i.body.body,S={};Object.keys(e).forEach(function(K){S[K]=e[K]});for(var l=0;l<i.params.length;l++){var x=i.params[l];if(x.type=="Identifier")e[x.name]=null;else return r}for(var l in v)if(s(v[l])===r)return r;e=S;var D=Object.keys(e),w=D.map(function(K){return e[K]});return Function(D.join(", "),"return "+Vye(i)).apply(null,w)}else if(i.type==="TemplateLiteral"){for(var b="",l=0;l<i.expressions.length;l++)b+=s(i.quasis[l]),b+=s(i.expressions[l]);return b+=s(i.quasis[l]),b}else if(i.type==="TaggedTemplateExpression"){var T=s(i.tag),P=i.quasi,C=P.quasis.map(s),k=P.expressions.map(s);return T.apply(null,[C].concat(k))}else return i.type==="TemplateElement"?i.value.cooked:r}}}(t);return n===r?void 0:n};const Hye=nc(qye);function n6(t){return function(e,r,n,s){var i=e.value,o=e.path,a=[],u=(function(l,c){iV(l)?(l.forEach(function(d,h){a.length>=s||n(h,d,r)&&a.push({path:c.concat(h),value:d})}),l.forEach(function(d,h){a.length>=s||t&&u(d,c.concat(h))})):Wye(l)&&(Object.keys(l).forEach(function(d){a.length>=s||n(d,l[d],r)&&a.push({path:c.concat(d),value:l[d]})}),Object.keys(l).forEach(function(d){a.length>=s||t&&u(l[d],c.concat(d))}))}).bind(this);return u(i,o),a}}function hP(t,e){try{return Hye(t,e)}catch{}}function xb(t){return function(e,r,n){return this.descend(r,e.expression.value,t,n)}}function Pb(t){return function(e,r,n){return this.traverse(r,e.expression.value,t,n)}}function i6(t){return t=t.filter(function(e){return e}),Jye(t,function(e){return e.path.map(function(r){return String(r).replace("-","--")}).join("-")})}function zye(t){var e=String(t);return e.match(/^-?[0-9]+$/)?parseInt(e):null}function iV(t){return Array.isArray(t)}function Wye(t){return t&&!(t instanceof Array)&&t instanceof Object}function UT(t,e,r){var n=fP(e).body[0].expression,s=hP(n,{"@":t.value}),i=r.replace(/\{\{\s*value\s*\}\}/g,s),o=vr.nodes(t.value,i);return o.forEach(function(a){a.path=t.path.concat(a.path.slice(1))}),o}var Gye=function(){function t(){this._fns={"member-child-identifier":function(e,r){var n=e.expression.value,s=r.value;if(s instanceof Object&&n in s)return[{value:s[n],path:r.path.concat(n)}]},"member-descendant-identifier":Pb(function(e,r,n){return e==n}),"subscript-child-numeric_literal":xb(function(e,r,n){return e===n}),"member-child-numeric_literal":xb(function(e,r,n){return String(e)===String(n)}),"subscript-descendant-numeric_literal":Pb(function(e,r,n){return e===n}),"member-child-wildcard":xb(function(){return!0}),"member-descendant-wildcard":Pb(function(){return!0}),"subscript-descendant-wildcard":Pb(function(){return!0}),"subscript-child-wildcard":xb(function(){return!0}),"subscript-child-slice":function(e,r){if(iV(r.value)){var n=e.expression.value.split(":").map(zye),s=r.value.map(function(i,o){return{value:i,path:r.path.concat(o)}});return sye.apply(null,[s].concat(n))}},"subscript-child-union":function(e,r){var n=[];return e.expression.value.forEach(function(s){var i={operation:"subscript",scope:"child",expression:s.expression},o=this.resolve(i),a=o(i,r);a&&(n=n.concat(a))},this),i6(n)},"subscript-descendant-union":function(e,r,n){var s=this,i=[],o=vr.nodes(r,"$..*").slice(1);return o.forEach(function(a){i.length>=n||e.expression.value.forEach(function(u){var l={operation:"subscript",scope:"child",expression:u.expression},c=s.resolve(l),d=c(l,a);i=i.concat(d)})}),i6(i)},"subscript-child-filter_expression":function(e,r,n){var s=e.expression.value.slice(2,-1),i=fP(s).body[0].expression,o=function(a,u){return hP(i,{"@":u})};return this.descend(r,null,o,n)},"subscript-descendant-filter_expression":function(e,r,n){var s=e.expression.value.slice(2,-1),i=fP(s).body[0].expression,o=function(a,u){return hP(i,{"@":u})};return this.traverse(r,null,o,n)},"subscript-child-script_expression":function(e,r){var n=e.expression.value.slice(1,-1);return UT(r,n,"$[{{value}}]")},"member-child-script_expression":function(e,r){var n=e.expression.value.slice(1,-1);return UT(r,n,"$.{{value}}")},"member-descendant-script_expression":function(e,r){var n=e.expression.value.slice(1,-1);return UT(r,n,"$..value")}},this.initialize()}return t.prototype.initialize=function(){this.traverse=n6(!0),this.descend=n6(),this._fns["subscript-child-string_literal"]=this._fns["member-child-identifier"],this._fns["member-descendant-numeric_literal"]=this._fns["subscript-descendant-string_literal"]=this._fns["member-descendant-identifier"]},t.prototype.resolve=function(e){var r=[e.operation,e.scope,e.expression.type].join("-"),n=this._fns[r];if(!n)throw new Error("couldn't resolve key: "+r);return n.bind(this)},t.prototype.register=function(e,r){if(!(r instanceof Function))throw new Error("handler must be a function");this._fns[e]=r},t}();function Jye(t,e){for(var r=[],n=[],s=0,i=t==null?void 0:t.length;s<i;s++){var o=t[s],a=e?e(o,s):o;n.includes(a)||(n.push(a),r.push(o))}return r}var Xye={identifier:"[a-zA-Z_]+[a-zA-Z0-9_]*",integer:"-?(?:0|[1-9][0-9]*)",qq_string:'"(?:\\\\["bfnrt/\\\\]|\\\\u[a-fA-F0-9]{4}|[^"\\\\])*"',q_string:"'(?:\\\\['bfnrt/\\\\]|\\\\u[a-fA-F0-9]{4}|[^'\\\\])*'"};function Yye(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var sV={};(function(t){var e=function(){var r=function(w,b,T,P){for(T=T||{},P=w.length;P--;T[w[P]]=b);return T},n=[1,5],s=[1,6],i=[1,7],o=[1,8],a=[1,9],u=[1,18],l=[1,19],c=[1,20],d=[1,12,14,22],h=[1,29],f=[1,30],p=[1,33],m=[1,35],E=[1,31],A=[1,36],_=[1,37],g=[24,28],v={trace:function(){},yy:{},symbols_:{error:2,JSON_PATH:3,DOLLAR:4,PATH_COMPONENTS:5,LEADING_CHILD_MEMBER_EXPRESSION:6,PATH_COMPONENT:7,MEMBER_COMPONENT:8,SUBSCRIPT_COMPONENT:9,CHILD_MEMBER_COMPONENT:10,DESCENDANT_MEMBER_COMPONENT:11,DOT:12,MEMBER_EXPRESSION:13,DOT_DOT:14,STAR:15,IDENTIFIER:16,SCRIPT_EXPRESSION:17,INTEGER:18,END:19,CHILD_SUBSCRIPT_COMPONENT:20,DESCENDANT_SUBSCRIPT_COMPONENT:21,"[":22,SUBSCRIPT:23,"]":24,SUBSCRIPT_EXPRESSION:25,SUBSCRIPT_EXPRESSION_LIST:26,SUBSCRIPT_EXPRESSION_LISTABLE:27,",":28,STRING_LITERAL:29,ARRAY_SLICE:30,FILTER_EXPRESSION:31,QQ_STRING:32,Q_STRING:33,$accept:0,$end:1},terminals_:{2:"error",4:"DOLLAR",12:"DOT",14:"DOT_DOT",15:"STAR",16:"IDENTIFIER",17:"SCRIPT_EXPRESSION",18:"INTEGER",19:"END",22:"[",24:"]",28:",",30:"ARRAY_SLICE",31:"FILTER_EXPRESSION",32:"QQ_STRING",33:"Q_STRING"},productions_:[0,[3,1],[3,2],[3,1],[3,2],[5,1],[5,2],[7,1],[7,1],[8,1],[8,1],[10,2],[6,1],[11,2],[13,1],[13,1],[13,1],[13,1],[13,1],[9,1],[9,1],[20,3],[21,4],[23,1],[23,1],[26,1],[26,3],[27,1],[27,1],[27,1],[25,1],[25,1],[25,1],[29,1],[29,1]],performAction:function(b,T,P,C,k,K,L){C.ast||(C.ast=S,S.initialize());var q=K.length-1;switch(k){case 1:return C.ast.set({expression:{type:"root",value:K[q]}}),C.ast.unshift(),C.ast.yield();case 2:return C.ast.set({expression:{type:"root",value:K[q-1]}}),C.ast.unshift(),C.ast.yield();case 3:return C.ast.unshift(),C.ast.yield();case 4:return C.ast.set({operation:"member",scope:"child",expression:{type:"identifier",value:K[q-1]}}),C.ast.unshift(),C.ast.yield();case 5:case 6:case 11:case 13:case 18:case 21:case 22:case 23:break;case 7:C.ast.set({operation:"member"}),C.ast.push();break;case 8:C.ast.set({operation:"subscript"}),C.ast.push();break;case 9:case 19:C.ast.set({scope:"child"});break;case 10:case 20:C.ast.set({scope:"descendant"});break;case 12:C.ast.set({scope:"child",operation:"member"});break;case 14:C.ast.set({expression:{type:"wildcard",value:K[q]}});break;case 15:C.ast.set({expression:{type:"identifier",value:K[q]}});break;case 16:C.ast.set({expression:{type:"script_expression",value:K[q]}});break;case 17:C.ast.set({expression:{type:"numeric_literal",value:parseInt(K[q])}});break;case 24:K[q].length>1?C.ast.set({expression:{type:"union",value:K[q]}}):this.$=K[q];break;case 25:this.$=[K[q]];break;case 26:this.$=K[q-2].concat(K[q]);break;case 27:this.$={expression:{type:"numeric_literal",value:parseInt(K[q])}},C.ast.set(this.$);break;case 28:this.$={expression:{type:"string_literal",value:K[q]}},C.ast.set(this.$);break;case 29:this.$={expression:{type:"slice",value:K[q]}},C.ast.set(this.$);break;case 30:this.$={expression:{type:"wildcard",value:K[q]}},C.ast.set(this.$);break;case 31:this.$={expression:{type:"script_expression",value:K[q]}},C.ast.set(this.$);break;case 32:this.$={expression:{type:"filter_expression",value:K[q]}},C.ast.set(this.$);break;case 33:case 34:this.$=K[q];break}},table:[{3:1,4:[1,2],6:3,13:4,15:n,16:s,17:i,18:o,19:a},{1:[3]},{1:[2,1],5:10,7:11,8:12,9:13,10:14,11:15,12:u,14:l,20:16,21:17,22:c},{1:[2,3],5:21,7:11,8:12,9:13,10:14,11:15,12:u,14:l,20:16,21:17,22:c},r(d,[2,12]),r(d,[2,14]),r(d,[2,15]),r(d,[2,16]),r(d,[2,17]),r(d,[2,18]),{1:[2,2],7:22,8:12,9:13,10:14,11:15,12:u,14:l,20:16,21:17,22:c},r(d,[2,5]),r(d,[2,7]),r(d,[2,8]),r(d,[2,9]),r(d,[2,10]),r(d,[2,19]),r(d,[2,20]),{13:23,15:n,16:s,17:i,18:o,19:a},{13:24,15:n,16:s,17:i,18:o,19:a,22:[1,25]},{15:h,17:f,18:p,23:26,25:27,26:28,27:32,29:34,30:m,31:E,32:A,33:_},{1:[2,4],7:22,8:12,9:13,10:14,11:15,12:u,14:l,20:16,21:17,22:c},r(d,[2,6]),r(d,[2,11]),r(d,[2,13]),{15:h,17:f,18:p,23:38,25:27,26:28,27:32,29:34,30:m,31:E,32:A,33:_},{24:[1,39]},{24:[2,23]},{24:[2,24],28:[1,40]},{24:[2,30]},{24:[2,31]},{24:[2,32]},r(g,[2,25]),r(g,[2,27]),r(g,[2,28]),r(g,[2,29]),r(g,[2,33]),r(g,[2,34]),{24:[1,41]},r(d,[2,21]),{18:p,27:42,29:34,30:m,32:A,33:_},r(d,[2,22]),r(g,[2,26])],defaultActions:{27:[2,23],29:[2,30],30:[2,31],31:[2,32]},parseError:function(b,T){if(T.recoverable)this.trace(b);else{var P=new Error(b);throw P.hash=T,P}},parse:function(b){var T=this,P=[0],C=[null],k=[],K=this.table,L="",q=0,se=0,X=2,re=1,W=k.slice.call(arguments,1),B=Object.create(this.lexer),te={yy:{}};for(var z in this.yy)Object.prototype.hasOwnProperty.call(this.yy,z)&&(te.yy[z]=this.yy[z]);B.setInput(b,te.yy),te.yy.lexer=B,te.yy.parser=this,typeof B.yylloc>"u"&&(B.yylloc={});var $=B.yylloc;k.push($);var F=B.options&&B.options.ranges;typeof te.yy.parseError=="function"?this.parseError=te.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var ee=function(){var I;return I=B.lex()||re,typeof I!="number"&&(I=T.symbols_[I]||I),I},ne,le,me,ve,Pe={},Ue,M,V,oe;;){if(le=P[P.length-1],this.defaultActions[le]?me=this.defaultActions[le]:((ne===null||typeof ne>"u")&&(ne=ee()),me=K[le]&&K[le][ne]),typeof me>"u"||!me.length||!me[0]){var j="";oe=[];for(Ue in K[le])this.terminals_[Ue]&&Ue>X&&oe.push("'"+this.terminals_[Ue]+"'");B.showPosition?j="Parse error on line "+(q+1)+`:
`+B.showPosition()+`
Expecting `+oe.join(", ")+", got '"+(this.terminals_[ne]||ne)+"'":j="Parse error on line "+(q+1)+": Unexpected "+(ne==re?"end of input":"'"+(this.terminals_[ne]||ne)+"'"),this.parseError(j,{text:B.match,token:this.terminals_[ne]||ne,line:B.yylineno,loc:$,expected:oe})}if(me[0]instanceof Array&&me.length>1)throw new Error("Parse Error: multiple actions possible at state: "+le+", token: "+ne);switch(me[0]){case 1:P.push(ne),C.push(B.yytext),k.push(B.yylloc),P.push(me[1]),ne=null,se=B.yyleng,L=B.yytext,q=B.yylineno,$=B.yylloc;break;case 2:if(M=this.productions_[me[1]][1],Pe.$=C[C.length-M],Pe._$={first_line:k[k.length-(M||1)].first_line,last_line:k[k.length-1].last_line,first_column:k[k.length-(M||1)].first_column,last_column:k[k.length-1].last_column},F&&(Pe._$.range=[k[k.length-(M||1)].range[0],k[k.length-1].range[1]]),ve=this.performAction.apply(Pe,[L,se,q,te.yy,me[1],C,k].concat(W)),typeof ve<"u")return ve;M&&(P=P.slice(0,-1*M*2),C=C.slice(0,-1*M),k=k.slice(0,-1*M)),P.push(this.productions_[me[1]][0]),C.push(Pe.$),k.push(Pe._$),V=K[P[P.length-2]][P[P.length-1]],P.push(V);break;case 3:return!0}}return!0}},S={initialize:function(){this._nodes=[],this._node={},this._stash=[]},set:function(w){for(var b in w)this._node[b]=w[b];return this._node},node:function(w){return arguments.length&&(this._node=w),this._node},push:function(){this._nodes.push(this._node),this._node={}},unshift:function(){this._nodes.unshift(this._node),this._node={}},yield:function(){var w=this._nodes;return this.initialize(),w}},x=function(){var w={EOF:1,parseError:function(T,P){if(this.yy.parser)this.yy.parser.parseError(T,P);else throw new Error(T)},setInput:function(b,T){return this.yy=T||this.yy||{},this._input=b,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var b=this._input[0];this.yytext+=b,this.yyleng++,this.offset++,this.match+=b,this.matched+=b;var T=b.match(/(?:\r\n?|\n).*/g);return T?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),b},unput:function(b){var T=b.length,P=b.split(/(?:\r\n?|\n)/g);this._input=b+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-T),this.offset-=T;var C=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),P.length-1&&(this.yylineno-=P.length-1);var k=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:P?(P.length===C.length?this.yylloc.first_column:0)+C[C.length-P.length].length-P[0].length:this.yylloc.first_column-T},this.options.ranges&&(this.yylloc.range=[k[0],k[0]+this.yyleng-T]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(b){this.unput(this.match.slice(b))},pastInput:function(){var b=this.matched.substr(0,this.matched.length-this.match.length);return(b.length>20?"...":"")+b.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var b=this.match;return b.length<20&&(b+=this._input.substr(0,20-b.length)),(b.substr(0,20)+(b.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var b=this.pastInput(),T=new Array(b.length+1).join("-");return b+this.upcomingInput()+`
`+T+"^"},test_match:function(b,T){var P,C,k;if(this.options.backtrack_lexer&&(k={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(k.yylloc.range=this.yylloc.range.slice(0))),C=b[0].match(/(?:\r\n?|\n).*/g),C&&(this.yylineno+=C.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:C?C[C.length-1].length-C[C.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+b[0].length},this.yytext+=b[0],this.match+=b[0],this.matches=b,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(b[0].length),this.matched+=b[0],P=this.performAction.call(this,this.yy,this,T,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),P)return P;if(this._backtrack){for(var K in k)this[K]=k[K];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var b,T,P,C;this._more||(this.yytext="",this.match="");for(var k=this._currentRules(),K=0;K<k.length;K++)if(P=this._input.match(this.rules[k[K]]),P&&(!T||P[0].length>T[0].length)){if(T=P,C=K,this.options.backtrack_lexer){if(b=this.test_match(P,k[K]),b!==!1)return b;if(this._backtrack){T=!1;continue}else return!1}else if(!this.options.flex)break}return T?(b=this.test_match(T,k[C]),b!==!1?b:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var T=this.next();return T||this.lex()},begin:function(T){this.conditionStack.push(T)},popState:function(){var T=this.conditionStack.length-1;return T>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(T){return T=this.conditionStack.length-1-Math.abs(T||0),T>=0?this.conditionStack[T]:"INITIAL"},pushState:function(T){this.begin(T)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(T,P,C,k){switch(C){case 0:return 4;case 1:return 14;case 2:return 12;case 3:return 15;case 4:return 16;case 5:return 22;case 6:return 24;case 7:return 28;case 8:return 30;case 9:return 18;case 10:return P.yytext=P.yytext.substr(1,P.yyleng-2),32;case 11:return P.yytext=P.yytext.substr(1,P.yyleng-2),33;case 12:return 17;case 13:return 31}},rules:[/^(?:\$)/,/^(?:\.\.)/,/^(?:\.)/,/^(?:\*)/,/^(?:[a-zA-Z_]+[a-zA-Z0-9_]*)/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?:((-?(?:0|[1-9][0-9]*)))?\:((-?(?:0|[1-9][0-9]*)))?(\:((-?(?:0|[1-9][0-9]*)))?)?)/,/^(?:(-?(?:0|[1-9][0-9]*)))/,/^(?:"(?:\\["bfnrt\/\\]|\\u[a-fA-F0-9]{4}|[^"\\])*")/,/^(?:'(?:\\['bfnrt\/\\]|\\u[a-fA-F0-9]{4}|[^'\\])*')/,/^(?:\(.+?\)(?=\]))/,/^(?:\?\(.+?\)(?=\]))/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return w}();v.lexer=x;function D(){this.yy={}}return D.prototype=v,v.Parser=D,new D}();typeof Yye<"u"&&(t.parser=e,t.Parser=e.Parser,t.parse=function(){return e.parse.apply(e,arguments)})})(sV);function Cb(){var t=new sV.Parser,e=t.parseError;return t.yy.parseError=function(){t.yy.ast&&t.yy.ast.initialize(),e.apply(t,arguments)},t}var Xn=function(){function t(){}return t.ok=function(e,r){if(!e)throw new Error(r)},t.equal=function(e,r,n){if(e!==r)throw new Error(n)},t}(),vr=function(){function t(){}return t.parse=function(e){return Xn.ok(typeof e=="string","we need a path"),new Cb().parse(e)},t.parent=function(e,r){Xn.ok(e instanceof Object,"obj needs to be an object"),Xn.ok(r,"we need a path");var n=this.nodes(e,r)[0];return n.path.pop(),this.value(e,n.path)},t.apply=function(e,r,n){Xn.ok(e instanceof Object,"obj needs to be an object"),Xn.ok(r,"we need a path"),Xn.equal(typeof n,"function","fn needs to be function");var s=this.nodes(e,r).sort(function(i,o){return o.path.length-i.path.length});return s.forEach(function(i){var o=i.path.pop(),a=this.value(e,this.stringify(i.path)),u=i.value=n.call(e,a[o]);a[o]=u},this),s},t.value=function(e,r,n){if(Xn.ok(e instanceof Object,"obj needs to be an object"),Xn.ok(r,"we need a path"),n!==void 0){var s=this.nodes(e,r).shift();if(!s)return this._vivify(e,r,n);var i=s.path.slice(-1).shift(),o=this.parent(e,this.stringify(s.path));o[i]=n}return this.query(e,this.stringify(r),1).shift()},t._vivify=function(e,r,n){var s=this;Xn.ok(e instanceof Object,"obj needs to be an object"),Xn.ok(r,"we need a path");var i=new Cb().parse(r).map(function(a){return a.expression.value}),o=function(a,u){var l=a.pop(),c=s.value(e,a);c||(o(a.concat(),typeof l=="string"?{}:[]),c=s.value(e,a)),c[l]=u};return o(i,n),this.query(e,r)[0]},t.query=function(e,r,n){Xn.ok(e instanceof Object,"obj needs to be an object"),Xn.ok(typeof r=="string","we need a path");var s=this.nodes(e,r,n).map(function(i){return i.value});return s},t.paths=function(e,r,n){Xn.ok(e instanceof Object,"obj needs to be an object"),Xn.ok(r,"we need a path");var s=this.nodes(e,r,n).map(function(i){return i.path});return s},t.nodes=function(e,r,n){if(Xn.ok(e instanceof Object,"obj needs to be an object"),Xn.ok(r,"we need a path"),n===0)return[];var s=new Cb().parse(r),i=new Gye,o=[{path:["$"],value:e}],a=[];return s.length&&s[0].expression.type=="root"&&s.shift(),s.length?(s.forEach(function(u,l){if(!(a.length>=n)){var c=i.resolve(u),d=[];o.forEach(function(h){if(!(a.length>=n)){var f=c(u,h,n);l==s.length-1?a=a.concat(f||[]):d=d.concat(f||[])}}),o=d}}),n?a.slice(0,n):a):o},t.stringify=function(e){Xn.ok(e,"we need a path");var r="$",n={"descendant-member":"..{{value}}","child-member":".{{value}}","descendant-subscript":"..[{{value}}]","child-subscript":"[{{value}}]"};return e=this._normalize(e),e.forEach(function(s){if(s.expression.type!="root"){var i=[s.scope,s.operation].join("-"),o=n[i],a;if(s.expression.type=="string_literal"?a=JSON.stringify(s.expression.value):a=s.expression.value,!o)throw new Error("couldn't find template "+i);r+=o.replace(/{{value}}/,a)}}),r},t._normalize=function(e){if(Xn.ok(e,"we need a path"),typeof e=="string")return new Cb().parse(e);if(Array.isArray(e)&&typeof e[0]=="string"){var r=[{expression:{type:"root",value:"$"}}];return e.forEach(function(n,s){if(!(n=="$"&&s===0))if(typeof n=="string"&&n.match("^"+Xye.identifier+"$"))r.push({operation:"member",scope:"child",expression:{value:n,type:"identifier"}});else{var i=typeof n=="number"?"numeric_literal":"string_literal";r.push({operation:"subscript",scope:"child",expression:{value:n,type:i}})}}),r}else if(Array.isArray(e)&&typeof e[0]=="object")return e;throw new Error("couldn't understand path "+e)},t}();const Um=class Um{static extractInputField(e,r){let n=[];if(r){for(const s of r)if(n=vr.nodes(e,s),n.length)break}return n}static changePropertyNameRecursively(e,r,n){const s=Um.extractInputField(e,["$.."+r]);for(const i of s)this.copyResultPathToDestinationDefinition(i.path,e,n)}static copyResultPathToDestinationDefinition(e,r,n){let s=r;for(let i=1;i<e.length;i++)if(i+1<e.length&&(s=s[e[i]]),e.length==i+1){s[n]=s[e[i]],delete s[e[i]];break}}static changeSpecialPathsRecursively(e){const r=Um.extractInputField(e,["$..path"]);for(const n of r)this.modifyPathsWithSpecialCharacter(n.path,e)}static modifyPathsWithSpecialCharacter(e,r){let n=r;for(let s=1;s<e.length;s++)if(s+1<e.length&&(n=n[e[s]]),e.length==s+1){const i=n[e[s]],o=[];for(let a=0;a<i.length;a++)o.push(this.modifyPathWithSpecialCharacter(i[a]));n[e[s]]=o;break}}static modifyPathWithSpecialCharacter(e){const r=this.matchAll(e,this.REGEX_PATH);return e=this.modifyPathRecursive(r,e),e}static modifyPathRecursive(e,r){let n=e.next(),s=!1;for(;n&&!n.done&&!s;){const i=n.value.index;if(i&&i==1)r=r.charAt(0)+"['"+n.value[0]+"']"+r.substring(i+n.value[0].length),s=!0,this.modifyPathRecursive(e,r);else if(i&&i>1&&r.substring(i-2,i)!=="['"&&r.substring(i-2,i)!=='["')if(r.substring(i-2,i)===".."){r=r.substring(0,i-2)+"..['"+n.value[0]+"']"+r.substring(i+n.value[0].length),s=!0;const o=this.matchAll(r,this.REGEX_PATH);this.modifyPathRecursive(o,r)}else r.charAt(i-1)==="."&&(r=r.substring(0,i-1)+"['"+n.value[0]+"']"+r.substring(i+n.value[0].length),s=!0,this.modifyPathRecursive(e,r));n=e.next()}return r}};Se(Um,"matchAll",require("string.prototype.matchall")),Se(Um,"REGEX_PATH",/@\w+/g);let ia=Um;class so{static asArray(e){return Array.isArray(e)?e:[e]}static isObject(e){return Object.prototype.toString.call(e)==="[object Object]"}static isUrlAbsolute(e){const r=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;so.isString(e)&&r.test(e)}static isString(e){return typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"}static getDistinctFieldInObject(e,r){const n=e.map(s=>s[r]);return Array.from(new Set(n))}}class Fd{static optionalNonEmptyString(e){return e==null||e.length>0}static nonEmptyString(e){return e!=null&&e.length>0}static isValidDIDURI(e){const n="^did:([a-z0-9]+)(:([a-zA-Z0-9\\.\\-_]|%[0-9a-fA-F]{2})+)+(/("+"[a-zA-Z-\\._~]|%[0-9a-fA-F]{2}|[!$&'()*+,;=:@]"+")*)?";return new RegExp(n).test(e)}}class Zye{constructor(e,r,n,s,i,o){Se(this,"input_descriptors");Se(this,"format");Se(this,"id");Se(this,"name");Se(this,"purpose");Se(this,"submission_requirements");this.id=e,this.input_descriptors=r,this.format=n,this.name=s,this.purpose=i,this.submission_requirements=o}getVersion(){return Ma.v1}}class Qye{constructor(e,r,n,s,i,o,a){Se(this,"format");Se(this,"frame");Se(this,"id");Se(this,"input_descriptors");Se(this,"name");Se(this,"purpose");Se(this,"submission_requirements");this.format=n,this.frame=s,this.id=e,this.input_descriptors=r,this.name=i,this.purpose=o,this.submission_requirements=a}getVersion(){return Ma.v2}}var Ma;(function(t){t.v1="v1",t.v2="v2"})(Ma||(Ma={}));class cs{static modelEntityToInternalPresentationDefinitionV1(e){const r=cs.createCopyAndModifyPresentationDefinition(e);return new Zye(r.id,r.input_descriptors,r.format,r.name,r.purpose,r.submission_requirements)}static modelEntityInternalPresentationDefinitionV2(e){const r=cs.createCopyAndModifyPresentationDefinition(e);return new Qye(r.id,r.input_descriptors,r.format,r.frame,r.name,r.purpose,r.submission_requirements)}static createCopyAndModifyPresentationDefinition(e){const r=JSON.parse(JSON.stringify(e));return ia.changePropertyNameRecursively(r,"_const","const"),ia.changePropertyNameRecursively(r,"_enum","enum"),ia.changeSpecialPathsRecursively(r),r}static mapExternalVerifiablePresentationToWrappedVP(e){return Ey.CredentialMapper.toWrappedVerifiablePresentation(e)}static mapExternalVerifiableCredentialsToWrappedVcs(e){return Ey.CredentialMapper.toWrappedVerifiableCredentials(Array.isArray(e)?e:[e])}static toInternalPresentationDefinition(e){const r=JSON.parse(JSON.stringify(e)),n=pP(r);if(n.error)throw n.error;return n.version==Ma.v1?cs.modelEntityToInternalPresentationDefinitionV1(r):cs.modelEntityInternalPresentationDefinitionV2(r)}}var YI={exports:{}};YI.exports=ZI;YI.exports.default=ZI;const Bn={$schema:"http://json-schema.org/draft-07/schema#",title:"Presentation Definition",definitions:{schema:{type:"object",properties:{uri:{type:"string"},required:{type:"boolean"}},required:["uri"],additionalProperties:!1},issuance:{type:"object",properties:{manifest:{type:"string"}},additionalProperties:!0},filter:{type:"object",properties:{type:{type:"string"},format:{type:"string"},pattern:{type:"string"},minimum:{type:["number","string"]},minLength:{type:"integer"},maxLength:{type:"integer"},exclusiveMinimum:{type:["number","string"]},exclusiveMaximum:{type:["number","string"]},maximum:{type:["number","string"]},const:{type:["number","string"]},enum:{type:"array",items:{type:["number","string"]}},not:{type:"object",minProperties:1}},required:["type"],additionalProperties:!1},format:{type:"object",patternProperties:{"^jwt$|^jwt_vc$|^jwt_vp$":{type:"object",properties:{alg:{type:"array",minItems:1,items:{type:"string"}}},required:["alg"],additionalProperties:!1},"^ldp_vc$|^ldp_vp$|^ldp$":{type:"object",properties:{proof_type:{type:"array",minItems:1,items:{type:"string"}}},required:["proof_type"],additionalProperties:!1},additionalProperties:!1},additionalProperties:!1},submission_requirements:{type:"object",oneOf:[{properties:{name:{type:"string"},purpose:{type:"string"},rule:{type:"string",enum:["all","pick"]},count:{type:"integer",minimum:1},min:{type:"integer",minimum:0},max:{type:"integer",minimum:0},from:{type:"string"}},required:["rule","from"],additionalProperties:!1},{properties:{name:{type:"string"},purpose:{type:"string"},rule:{type:"string",enum:["all","pick"]},count:{type:"integer",minimum:1},min:{type:"integer",minimum:0},max:{type:"integer",minimum:0},from_nested:{type:"array",minItems:1,items:{$ref:"#/definitions/submission_requirements"}}},required:["rule","from_nested"],additionalProperties:!1}]},input_descriptors:{type:"object",properties:{id:{type:"string"},name:{type:"string"},purpose:{type:"string"},group:{type:"array",items:{type:"string"}},schema:{type:"array",items:{$ref:"#/definitions/schema"}},issuance:{type:"array",items:{$ref:"#/definitions/issuance"}},constraints:{type:"object",properties:{limit_disclosure:{type:"string",enum:["required","preferred"]},statuses:{type:"object",properties:{active:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}},suspended:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}},revoked:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}}}},fields:{type:"array",items:{$ref:"#/definitions/field"}},subject_is_issuer:{type:"string",enum:["required","preferred"]},is_holder:{type:"array",items:{type:"object",properties:{field_id:{type:"array",items:{type:"string"}},directive:{type:"string",enum:["required","preferred"]}},required:["field_id","directive"],additionalProperties:!1}},same_subject:{type:"array",items:{type:"object",properties:{field_id:{type:"array",items:{type:"string"}},directive:{type:"string",enum:["required","preferred"]}},required:["field_id","directive"],additionalProperties:!1}}},additionalProperties:!1}},required:["id","schema"],additionalProperties:!1},field:{type:"object",oneOf:[{properties:{id:{type:"string"},path:{type:"array",items:{type:"string"}},purpose:{type:"string"},filter:{$ref:"#/definitions/filter"}},required:["path"],additionalProperties:!1},{properties:{id:{type:"string"},path:{type:"array",items:{type:"string"}},purpose:{type:"string"},filter:{$ref:"#/definitions/filter"},predicate:{type:"string",enum:["required","preferred"]}},required:["path","filter","predicate"],additionalProperties:!1}]}},type:"object",properties:{presentation_definition:{type:"object",properties:{id:{type:"string"},name:{type:"string"},purpose:{type:"string"},format:{$ref:"#/definitions/format"},submission_requirements:{type:"array",items:{$ref:"#/definitions/submission_requirements"}},input_descriptors:{type:"array",items:{$ref:"#/definitions/input_descriptors"}}},required:["id","input_descriptors"],additionalProperties:!1}}},rn={type:"object",patternProperties:{"^jwt$|^jwt_vc$|^jwt_vp$":{type:"object",properties:{alg:{type:"array",minItems:1,items:{type:"string"}}},required:["alg"],additionalProperties:!1},"^ldp_vc$|^ldp_vp$|^ldp$":{type:"object",properties:{proof_type:{type:"array",minItems:1,items:{type:"string"}}},required:["proof_type"],additionalProperties:!1},additionalProperties:!1},additionalProperties:!1},s6=new RegExp("^jwt$|^jwt_vc$|^jwt_vp$","u"),o6=new RegExp("^ldp_vc$|^ldp_vp$|^ldp$","u"),a6=new RegExp("additionalProperties","u");function P1(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){for(const a in t)if(!(s6.test(a)||o6.test(a)||a6.test(a))){const u={instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:a},message:"must NOT have additional properties",schema:!1,parentSchema:rn,data:t};i===null?i=[u]:i.push(u),o++}for(const a in t)if(s6.test(a)){let u=t[a];if(u&&typeof u=="object"&&!Array.isArray(u)){if(u.alg===void 0){const l={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24/required",keyword:"required",params:{missingProperty:"alg"},message:"must have required property 'alg'",schema:rn.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$"].required,parentSchema:rn.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$"],data:u};i===null?i=[l]:i.push(l),o++}for(const l in u)if(l!=="alg"){const c={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:l},message:"must NOT have additional properties",schema:!1,parentSchema:rn.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$"],data:u};i===null?i=[c]:i.push(c),o++}if(u.alg!==void 0){let l=u.alg;if(Array.isArray(l)){if(l.length<1){const d={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/alg",schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24/properties/alg/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items",schema:1,parentSchema:rn.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$"].properties.alg,data:l};i===null?i=[d]:i.push(d),o++}const c=l.length;for(let d=0;d<c;d++){let h=l[d];if(typeof h!="string"){const f={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/alg/"+d,schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24/properties/alg/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:rn.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$"].properties.alg.items.type,parentSchema:rn.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$"].properties.alg.items,data:h};i===null?i=[f]:i.push(f),o++}}}else{const c={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/alg",schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24/properties/alg/type",keyword:"type",params:{type:"array"},message:"must be array",schema:rn.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$"].properties.alg.type,parentSchema:rn.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$"].properties.alg,data:l};i===null?i=[c]:i.push(c),o++}}}else{const l={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24/type",keyword:"type",params:{type:"object"},message:"must be object",schema:rn.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$"].type,parentSchema:rn.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$"],data:u};i===null?i=[l]:i.push(l),o++}}for(const a in t)if(o6.test(a)){let u=t[a];if(u&&typeof u=="object"&&!Array.isArray(u)){if(u.proof_type===void 0){const l={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/required",keyword:"required",params:{missingProperty:"proof_type"},message:"must have required property 'proof_type'",schema:rn.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].required,parentSchema:rn.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"],data:u};i===null?i=[l]:i.push(l),o++}for(const l in u)if(l!=="proof_type"){const c={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:l},message:"must NOT have additional properties",schema:!1,parentSchema:rn.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"],data:u};i===null?i=[c]:i.push(c),o++}if(u.proof_type!==void 0){let l=u.proof_type;if(Array.isArray(l)){if(l.length<1){const d={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/proof_type",schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/properties/proof_type/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items",schema:1,parentSchema:rn.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].properties.proof_type,data:l};i===null?i=[d]:i.push(d),o++}const c=l.length;for(let d=0;d<c;d++){let h=l[d];if(typeof h!="string"){const f={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/proof_type/"+d,schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/properties/proof_type/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:rn.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].properties.proof_type.items.type,parentSchema:rn.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].properties.proof_type.items,data:h};i===null?i=[f]:i.push(f),o++}}}else{const c={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/proof_type",schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/properties/proof_type/type",keyword:"type",params:{type:"array"},message:"must be array",schema:rn.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].properties.proof_type.type,parentSchema:rn.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].properties.proof_type,data:l};i===null?i=[c]:i.push(c),o++}}}else{const l={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/type",keyword:"type",params:{type:"object"},message:"must be object",schema:rn.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].type,parentSchema:rn.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"],data:u};i===null?i=[l]:i.push(l),o++}}for(const a in t)if(a6.test(a)){const u={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/additionalProperties/false schema",keyword:"false schema",params:{},message:"boolean schema is false",schema:!1,parentSchema:rn.patternProperties.additionalProperties,data:t[a]};i===null?i=[u]:i.push(u),o++}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:rn.type,parentSchema:rn,data:t};i===null?i=[a]:i.push(a),o++}return P1.errors=i,o===0}const ct={type:"object",oneOf:[{properties:{name:{type:"string"},purpose:{type:"string"},rule:{type:"string",enum:["all","pick"]},count:{type:"integer",minimum:1},min:{type:"integer",minimum:0},max:{type:"integer",minimum:0},from:{type:"string"}},required:["rule","from"],additionalProperties:!1},{properties:{name:{type:"string"},purpose:{type:"string"},rule:{type:"string",enum:["all","pick"]},count:{type:"integer",minimum:1},min:{type:"integer",minimum:0},max:{type:"integer",minimum:0},from_nested:{type:"array",minItems:1,items:{$ref:"#/definitions/submission_requirements"}}},required:["rule","from_nested"],additionalProperties:!1}]},LT={validate:sv};function sv(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(!(t&&typeof t=="object"&&!Array.isArray(t))){const f={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:ct.type,parentSchema:ct,data:t};i===null?i=[f]:i.push(f),o++}const a=o;let u=!1,l=null;const c=o;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.rule===void 0){const f={instancePath:e,schemaPath:"#/oneOf/0/required",keyword:"required",params:{missingProperty:"rule"},message:"must have required property 'rule'",schema:ct.oneOf[0].required,parentSchema:ct.oneOf[0],data:t};i===null?i=[f]:i.push(f),o++}if(t.from===void 0){const f={instancePath:e,schemaPath:"#/oneOf/0/required",keyword:"required",params:{missingProperty:"from"},message:"must have required property 'from'",schema:ct.oneOf[0].required,parentSchema:ct.oneOf[0],data:t};i===null?i=[f]:i.push(f),o++}for(const f in t)if(!(f==="name"||f==="purpose"||f==="rule"||f==="count"||f==="min"||f==="max"||f==="from")){const p={instancePath:e,schemaPath:"#/oneOf/0/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:f},message:"must NOT have additional properties",schema:!1,parentSchema:ct.oneOf[0],data:t};i===null?i=[p]:i.push(p),o++}if(t.name!==void 0){let f=t.name;if(typeof f!="string"){const p={instancePath:e+"/name",schemaPath:"#/oneOf/0/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string",schema:ct.oneOf[0].properties.name.type,parentSchema:ct.oneOf[0].properties.name,data:f};i===null?i=[p]:i.push(p),o++}}if(t.purpose!==void 0){let f=t.purpose;if(typeof f!="string"){const p={instancePath:e+"/purpose",schemaPath:"#/oneOf/0/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:ct.oneOf[0].properties.purpose.type,parentSchema:ct.oneOf[0].properties.purpose,data:f};i===null?i=[p]:i.push(p),o++}}if(t.rule!==void 0){let f=t.rule;if(typeof f!="string"){const p={instancePath:e+"/rule",schemaPath:"#/oneOf/0/properties/rule/type",keyword:"type",params:{type:"string"},message:"must be string",schema:ct.oneOf[0].properties.rule.type,parentSchema:ct.oneOf[0].properties.rule,data:f};i===null?i=[p]:i.push(p),o++}if(!(f==="all"||f==="pick")){const p={instancePath:e+"/rule",schemaPath:"#/oneOf/0/properties/rule/enum",keyword:"enum",params:{allowedValues:ct.oneOf[0].properties.rule.enum},message:"must be equal to one of the allowed values",schema:ct.oneOf[0].properties.rule.enum,parentSchema:ct.oneOf[0].properties.rule,data:f};i===null?i=[p]:i.push(p),o++}}if(t.count!==void 0){let f=t.count;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/count",schemaPath:"#/oneOf/0/properties/count/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:ct.oneOf[0].properties.count.type,parentSchema:ct.oneOf[0].properties.count,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<1||isNaN(f))){const p={instancePath:e+"/count",schemaPath:"#/oneOf/0/properties/count/minimum",keyword:"minimum",params:{comparison:">=",limit:1},message:"must be >= 1",schema:1,parentSchema:ct.oneOf[0].properties.count,data:f};i===null?i=[p]:i.push(p),o++}}if(t.min!==void 0){let f=t.min;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/min",schemaPath:"#/oneOf/0/properties/min/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:ct.oneOf[0].properties.min.type,parentSchema:ct.oneOf[0].properties.min,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<0||isNaN(f))){const p={instancePath:e+"/min",schemaPath:"#/oneOf/0/properties/min/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0",schema:0,parentSchema:ct.oneOf[0].properties.min,data:f};i===null?i=[p]:i.push(p),o++}}if(t.max!==void 0){let f=t.max;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/max",schemaPath:"#/oneOf/0/properties/max/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:ct.oneOf[0].properties.max.type,parentSchema:ct.oneOf[0].properties.max,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<0||isNaN(f))){const p={instancePath:e+"/max",schemaPath:"#/oneOf/0/properties/max/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0",schema:0,parentSchema:ct.oneOf[0].properties.max,data:f};i===null?i=[p]:i.push(p),o++}}if(t.from!==void 0){let f=t.from;if(typeof f!="string"){const p={instancePath:e+"/from",schemaPath:"#/oneOf/0/properties/from/type",keyword:"type",params:{type:"string"},message:"must be string",schema:ct.oneOf[0].properties.from.type,parentSchema:ct.oneOf[0].properties.from,data:f};i===null?i=[p]:i.push(p),o++}}}var h=c===o;h&&(u=!0,l=0);const d=o;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.rule===void 0){const f={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:"rule"},message:"must have required property 'rule'",schema:ct.oneOf[1].required,parentSchema:ct.oneOf[1],data:t};i===null?i=[f]:i.push(f),o++}if(t.from_nested===void 0){const f={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:"from_nested"},message:"must have required property 'from_nested'",schema:ct.oneOf[1].required,parentSchema:ct.oneOf[1],data:t};i===null?i=[f]:i.push(f),o++}for(const f in t)if(!(f==="name"||f==="purpose"||f==="rule"||f==="count"||f==="min"||f==="max"||f==="from_nested")){const p={instancePath:e,schemaPath:"#/oneOf/1/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:f},message:"must NOT have additional properties",schema:!1,parentSchema:ct.oneOf[1],data:t};i===null?i=[p]:i.push(p),o++}if(t.name!==void 0){let f=t.name;if(typeof f!="string"){const p={instancePath:e+"/name",schemaPath:"#/oneOf/1/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string",schema:ct.oneOf[1].properties.name.type,parentSchema:ct.oneOf[1].properties.name,data:f};i===null?i=[p]:i.push(p),o++}}if(t.purpose!==void 0){let f=t.purpose;if(typeof f!="string"){const p={instancePath:e+"/purpose",schemaPath:"#/oneOf/1/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:ct.oneOf[1].properties.purpose.type,parentSchema:ct.oneOf[1].properties.purpose,data:f};i===null?i=[p]:i.push(p),o++}}if(t.rule!==void 0){let f=t.rule;if(typeof f!="string"){const p={instancePath:e+"/rule",schemaPath:"#/oneOf/1/properties/rule/type",keyword:"type",params:{type:"string"},message:"must be string",schema:ct.oneOf[1].properties.rule.type,parentSchema:ct.oneOf[1].properties.rule,data:f};i===null?i=[p]:i.push(p),o++}if(!(f==="all"||f==="pick")){const p={instancePath:e+"/rule",schemaPath:"#/oneOf/1/properties/rule/enum",keyword:"enum",params:{allowedValues:ct.oneOf[1].properties.rule.enum},message:"must be equal to one of the allowed values",schema:ct.oneOf[1].properties.rule.enum,parentSchema:ct.oneOf[1].properties.rule,data:f};i===null?i=[p]:i.push(p),o++}}if(t.count!==void 0){let f=t.count;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/count",schemaPath:"#/oneOf/1/properties/count/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:ct.oneOf[1].properties.count.type,parentSchema:ct.oneOf[1].properties.count,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<1||isNaN(f))){const p={instancePath:e+"/count",schemaPath:"#/oneOf/1/properties/count/minimum",keyword:"minimum",params:{comparison:">=",limit:1},message:"must be >= 1",schema:1,parentSchema:ct.oneOf[1].properties.count,data:f};i===null?i=[p]:i.push(p),o++}}if(t.min!==void 0){let f=t.min;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/min",schemaPath:"#/oneOf/1/properties/min/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:ct.oneOf[1].properties.min.type,parentSchema:ct.oneOf[1].properties.min,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<0||isNaN(f))){const p={instancePath:e+"/min",schemaPath:"#/oneOf/1/properties/min/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0",schema:0,parentSchema:ct.oneOf[1].properties.min,data:f};i===null?i=[p]:i.push(p),o++}}if(t.max!==void 0){let f=t.max;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/max",schemaPath:"#/oneOf/1/properties/max/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:ct.oneOf[1].properties.max.type,parentSchema:ct.oneOf[1].properties.max,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<0||isNaN(f))){const p={instancePath:e+"/max",schemaPath:"#/oneOf/1/properties/max/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0",schema:0,parentSchema:ct.oneOf[1].properties.max,data:f};i===null?i=[p]:i.push(p),o++}}if(t.from_nested!==void 0){let f=t.from_nested;if(Array.isArray(f)){if(f.length<1){const m={instancePath:e+"/from_nested",schemaPath:"#/oneOf/1/properties/from_nested/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items",schema:1,parentSchema:ct.oneOf[1].properties.from_nested,data:f};i===null?i=[m]:i.push(m),o++}const p=f.length;for(let m=0;m<p;m++)LT.validate(f[m],{instancePath:e+"/from_nested/"+m,parentData:f,parentDataProperty:m,rootData:s})||(i=i===null?LT.validate.errors:i.concat(LT.validate.errors),o=i.length)}else{const p={instancePath:e+"/from_nested",schemaPath:"#/oneOf/1/properties/from_nested/type",keyword:"type",params:{type:"array"},message:"must be array",schema:ct.oneOf[1].properties.from_nested.type,parentSchema:ct.oneOf[1].properties.from_nested,data:f};i===null?i=[p]:i.push(p),o++}}}var h=d===o;if(h&&u?(u=!1,l=[l,1]):h&&(u=!0,l=1),u)o=a,i!==null&&(a?i.length=a:i=null);else{const f={instancePath:e,schemaPath:"#/oneOf",keyword:"oneOf",params:{passingSchemas:l},message:"must match exactly one schema in oneOf",schema:ct.oneOf,parentSchema:ct,data:t};i===null?i=[f]:i.push(f),o++}return sv.errors=i,o===0}const Re={type:"object",properties:{id:{type:"string"},name:{type:"string"},purpose:{type:"string"},group:{type:"array",items:{type:"string"}},schema:{type:"array",items:{$ref:"#/definitions/schema"}},issuance:{type:"array",items:{$ref:"#/definitions/issuance"}},constraints:{type:"object",properties:{limit_disclosure:{type:"string",enum:["required","preferred"]},statuses:{type:"object",properties:{active:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}},suspended:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}},revoked:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}}}},fields:{type:"array",items:{$ref:"#/definitions/field"}},subject_is_issuer:{type:"string",enum:["required","preferred"]},is_holder:{type:"array",items:{type:"object",properties:{field_id:{type:"array",items:{type:"string"}},directive:{type:"string",enum:["required","preferred"]}},required:["field_id","directive"],additionalProperties:!1}},same_subject:{type:"array",items:{type:"object",properties:{field_id:{type:"array",items:{type:"string"}},directive:{type:"string",enum:["required","preferred"]}},required:["field_id","directive"],additionalProperties:!1}}},additionalProperties:!1}},required:["id","schema"],additionalProperties:!1},Ic={type:"object",properties:{uri:{type:"string"},required:{type:"boolean"}},required:["uri"],additionalProperties:!1};function C1(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.uri===void 0){const a={instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:"uri"},message:"must have required property 'uri'",schema:Ic.required,parentSchema:Ic,data:t};i===null?i=[a]:i.push(a),o++}for(const a in t)if(!(a==="uri"||a==="required")){const u={instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:a},message:"must NOT have additional properties",schema:!1,parentSchema:Ic,data:t};i===null?i=[u]:i.push(u),o++}if(t.uri!==void 0){let a=t.uri;if(typeof a!="string"){const u={instancePath:e+"/uri",schemaPath:"#/properties/uri/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ic.properties.uri.type,parentSchema:Ic.properties.uri,data:a};i===null?i=[u]:i.push(u),o++}}if(t.required!==void 0){let a=t.required;if(typeof a!="boolean"){const u={instancePath:e+"/required",schemaPath:"#/properties/required/type",keyword:"type",params:{type:"boolean"},message:"must be boolean",schema:Ic.properties.required.type,parentSchema:Ic.properties.required,data:a};i===null?i=[u]:i.push(u),o++}}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Ic.type,parentSchema:Ic,data:t};i===null?i=[a]:i.push(a),o++}return C1.errors=i,o===0}const Ib={type:"object",properties:{manifest:{type:"string"}},additionalProperties:!0};function I1(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.manifest!==void 0){let a=t.manifest;if(typeof a!="string"){const u={instancePath:e+"/manifest",schemaPath:"#/properties/manifest/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ib.properties.manifest.type,parentSchema:Ib.properties.manifest,data:a};i===null?i=[u]:i.push(u),o++}}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Ib.type,parentSchema:Ib,data:t};i===null?i=[a]:i.push(a),o++}return I1.errors=i,o===0}const sr={type:"object",oneOf:[{properties:{id:{type:"string"},path:{type:"array",items:{type:"string"}},purpose:{type:"string"},filter:{$ref:"#/definitions/filter"}},required:["path"],additionalProperties:!1},{properties:{id:{type:"string"},path:{type:"array",items:{type:"string"}},purpose:{type:"string"},filter:{$ref:"#/definitions/filter"},predicate:{type:"string",enum:["required","preferred"]}},required:["path","filter","predicate"],additionalProperties:!1}]},Jt={type:"object",properties:{type:{type:"string"},format:{type:"string"},pattern:{type:"string"},minimum:{type:["number","string"]},minLength:{type:"integer"},maxLength:{type:"integer"},exclusiveMinimum:{type:["number","string"]},exclusiveMaximum:{type:["number","string"]},maximum:{type:["number","string"]},const:{type:["number","string"]},enum:{type:"array",items:{type:["number","string"]}},not:{type:"object",minProperties:1}},required:["type"],additionalProperties:!1},ege=Object.prototype.hasOwnProperty;function bh(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.type===void 0){const a={instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:"type"},message:"must have required property 'type'",schema:Jt.required,parentSchema:Jt,data:t};i===null?i=[a]:i.push(a),o++}for(const a in t)if(!ege.call(Jt.properties,a)){const u={instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:a},message:"must NOT have additional properties",schema:!1,parentSchema:Jt,data:t};i===null?i=[u]:i.push(u),o++}if(t.type!==void 0){let a=t.type;if(typeof a!="string"){const u={instancePath:e+"/type",schemaPath:"#/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Jt.properties.type.type,parentSchema:Jt.properties.type,data:a};i===null?i=[u]:i.push(u),o++}}if(t.format!==void 0){let a=t.format;if(typeof a!="string"){const u={instancePath:e+"/format",schemaPath:"#/properties/format/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Jt.properties.format.type,parentSchema:Jt.properties.format,data:a};i===null?i=[u]:i.push(u),o++}}if(t.pattern!==void 0){let a=t.pattern;if(typeof a!="string"){const u={instancePath:e+"/pattern",schemaPath:"#/properties/pattern/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Jt.properties.pattern.type,parentSchema:Jt.properties.pattern,data:a};i===null?i=[u]:i.push(u),o++}}if(t.minimum!==void 0){let a=t.minimum;if(typeof a!="number"&&typeof a!="string"){const u={instancePath:e+"/minimum",schemaPath:"#/properties/minimum/type",keyword:"type",params:{type:Jt.properties.minimum.type},message:"must be number,string",schema:Jt.properties.minimum.type,parentSchema:Jt.properties.minimum,data:a};i===null?i=[u]:i.push(u),o++}}if(t.minLength!==void 0){let a=t.minLength;if(!(typeof a=="number"&&!(a%1)&&!isNaN(a))){const u={instancePath:e+"/minLength",schemaPath:"#/properties/minLength/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:Jt.properties.minLength.type,parentSchema:Jt.properties.minLength,data:a};i===null?i=[u]:i.push(u),o++}}if(t.maxLength!==void 0){let a=t.maxLength;if(!(typeof a=="number"&&!(a%1)&&!isNaN(a))){const u={instancePath:e+"/maxLength",schemaPath:"#/properties/maxLength/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:Jt.properties.maxLength.type,parentSchema:Jt.properties.maxLength,data:a};i===null?i=[u]:i.push(u),o++}}if(t.exclusiveMinimum!==void 0){let a=t.exclusiveMinimum;if(typeof a!="number"&&typeof a!="string"){const u={instancePath:e+"/exclusiveMinimum",schemaPath:"#/properties/exclusiveMinimum/type",keyword:"type",params:{type:Jt.properties.exclusiveMinimum.type},message:"must be number,string",schema:Jt.properties.exclusiveMinimum.type,parentSchema:Jt.properties.exclusiveMinimum,data:a};i===null?i=[u]:i.push(u),o++}}if(t.exclusiveMaximum!==void 0){let a=t.exclusiveMaximum;if(typeof a!="number"&&typeof a!="string"){const u={instancePath:e+"/exclusiveMaximum",schemaPath:"#/properties/exclusiveMaximum/type",keyword:"type",params:{type:Jt.properties.exclusiveMaximum.type},message:"must be number,string",schema:Jt.properties.exclusiveMaximum.type,parentSchema:Jt.properties.exclusiveMaximum,data:a};i===null?i=[u]:i.push(u),o++}}if(t.maximum!==void 0){let a=t.maximum;if(typeof a!="number"&&typeof a!="string"){const u={instancePath:e+"/maximum",schemaPath:"#/properties/maximum/type",keyword:"type",params:{type:Jt.properties.maximum.type},message:"must be number,string",schema:Jt.properties.maximum.type,parentSchema:Jt.properties.maximum,data:a};i===null?i=[u]:i.push(u),o++}}if(t.const!==void 0){let a=t.const;if(typeof a!="number"&&typeof a!="string"){const u={instancePath:e+"/const",schemaPath:"#/properties/const/type",keyword:"type",params:{type:Jt.properties.const.type},message:"must be number,string",schema:Jt.properties.const.type,parentSchema:Jt.properties.const,data:a};i===null?i=[u]:i.push(u),o++}}if(t.enum!==void 0){let a=t.enum;if(Array.isArray(a)){const u=a.length;for(let l=0;l<u;l++){let c=a[l];if(typeof c!="number"&&typeof c!="string"){const d={instancePath:e+"/enum/"+l,schemaPath:"#/properties/enum/items/type",keyword:"type",params:{type:Jt.properties.enum.items.type},message:"must be number,string",schema:Jt.properties.enum.items.type,parentSchema:Jt.properties.enum.items,data:c};i===null?i=[d]:i.push(d),o++}}}else{const u={instancePath:e+"/enum",schemaPath:"#/properties/enum/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Jt.properties.enum.type,parentSchema:Jt.properties.enum,data:a};i===null?i=[u]:i.push(u),o++}}if(t.not!==void 0){let a=t.not;if(a&&typeof a=="object"&&!Array.isArray(a)){if(Object.keys(a).length<1){const u={instancePath:e+"/not",schemaPath:"#/properties/not/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties",schema:1,parentSchema:Jt.properties.not,data:a};i===null?i=[u]:i.push(u),o++}}else{const u={instancePath:e+"/not",schemaPath:"#/properties/not/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Jt.properties.not.type,parentSchema:Jt.properties.not,data:a};i===null?i=[u]:i.push(u),o++}}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Jt.type,parentSchema:Jt,data:t};i===null?i=[a]:i.push(a),o++}return bh.errors=i,o===0}function k1(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(!(t&&typeof t=="object"&&!Array.isArray(t))){const f={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:sr.type,parentSchema:sr,data:t};i===null?i=[f]:i.push(f),o++}const a=o;let u=!1,l=null;const c=o;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.path===void 0){const f={instancePath:e,schemaPath:"#/oneOf/0/required",keyword:"required",params:{missingProperty:"path"},message:"must have required property 'path'",schema:sr.oneOf[0].required,parentSchema:sr.oneOf[0],data:t};i===null?i=[f]:i.push(f),o++}for(const f in t)if(!(f==="id"||f==="path"||f==="purpose"||f==="filter")){const p={instancePath:e,schemaPath:"#/oneOf/0/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:f},message:"must NOT have additional properties",schema:!1,parentSchema:sr.oneOf[0],data:t};i===null?i=[p]:i.push(p),o++}if(t.id!==void 0){let f=t.id;if(typeof f!="string"){const p={instancePath:e+"/id",schemaPath:"#/oneOf/0/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string",schema:sr.oneOf[0].properties.id.type,parentSchema:sr.oneOf[0].properties.id,data:f};i===null?i=[p]:i.push(p),o++}}if(t.path!==void 0){let f=t.path;if(Array.isArray(f)){const p=f.length;for(let m=0;m<p;m++){let E=f[m];if(typeof E!="string"){const A={instancePath:e+"/path/"+m,schemaPath:"#/oneOf/0/properties/path/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:sr.oneOf[0].properties.path.items.type,parentSchema:sr.oneOf[0].properties.path.items,data:E};i===null?i=[A]:i.push(A),o++}}}else{const p={instancePath:e+"/path",schemaPath:"#/oneOf/0/properties/path/type",keyword:"type",params:{type:"array"},message:"must be array",schema:sr.oneOf[0].properties.path.type,parentSchema:sr.oneOf[0].properties.path,data:f};i===null?i=[p]:i.push(p),o++}}if(t.purpose!==void 0){let f=t.purpose;if(typeof f!="string"){const p={instancePath:e+"/purpose",schemaPath:"#/oneOf/0/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:sr.oneOf[0].properties.purpose.type,parentSchema:sr.oneOf[0].properties.purpose,data:f};i===null?i=[p]:i.push(p),o++}}t.filter!==void 0&&(bh(t.filter,{instancePath:e+"/filter",parentData:t,parentDataProperty:"filter",rootData:s})||(i=i===null?bh.errors:i.concat(bh.errors),o=i.length))}var h=c===o;h&&(u=!0,l=0);const d=o;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.path===void 0){const f={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:"path"},message:"must have required property 'path'",schema:sr.oneOf[1].required,parentSchema:sr.oneOf[1],data:t};i===null?i=[f]:i.push(f),o++}if(t.filter===void 0){const f={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:"filter"},message:"must have required property 'filter'",schema:sr.oneOf[1].required,parentSchema:sr.oneOf[1],data:t};i===null?i=[f]:i.push(f),o++}if(t.predicate===void 0){const f={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:"predicate"},message:"must have required property 'predicate'",schema:sr.oneOf[1].required,parentSchema:sr.oneOf[1],data:t};i===null?i=[f]:i.push(f),o++}for(const f in t)if(!(f==="id"||f==="path"||f==="purpose"||f==="filter"||f==="predicate")){const p={instancePath:e,schemaPath:"#/oneOf/1/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:f},message:"must NOT have additional properties",schema:!1,parentSchema:sr.oneOf[1],data:t};i===null?i=[p]:i.push(p),o++}if(t.id!==void 0){let f=t.id;if(typeof f!="string"){const p={instancePath:e+"/id",schemaPath:"#/oneOf/1/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string",schema:sr.oneOf[1].properties.id.type,parentSchema:sr.oneOf[1].properties.id,data:f};i===null?i=[p]:i.push(p),o++}}if(t.path!==void 0){let f=t.path;if(Array.isArray(f)){const p=f.length;for(let m=0;m<p;m++){let E=f[m];if(typeof E!="string"){const A={instancePath:e+"/path/"+m,schemaPath:"#/oneOf/1/properties/path/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:sr.oneOf[1].properties.path.items.type,parentSchema:sr.oneOf[1].properties.path.items,data:E};i===null?i=[A]:i.push(A),o++}}}else{const p={instancePath:e+"/path",schemaPath:"#/oneOf/1/properties/path/type",keyword:"type",params:{type:"array"},message:"must be array",schema:sr.oneOf[1].properties.path.type,parentSchema:sr.oneOf[1].properties.path,data:f};i===null?i=[p]:i.push(p),o++}}if(t.purpose!==void 0){let f=t.purpose;if(typeof f!="string"){const p={instancePath:e+"/purpose",schemaPath:"#/oneOf/1/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:sr.oneOf[1].properties.purpose.type,parentSchema:sr.oneOf[1].properties.purpose,data:f};i===null?i=[p]:i.push(p),o++}}if(t.filter!==void 0&&(bh(t.filter,{instancePath:e+"/filter",parentData:t,parentDataProperty:"filter",rootData:s})||(i=i===null?bh.errors:i.concat(bh.errors),o=i.length)),t.predicate!==void 0){let f=t.predicate;if(typeof f!="string"){const p={instancePath:e+"/predicate",schemaPath:"#/oneOf/1/properties/predicate/type",keyword:"type",params:{type:"string"},message:"must be string",schema:sr.oneOf[1].properties.predicate.type,parentSchema:sr.oneOf[1].properties.predicate,data:f};i===null?i=[p]:i.push(p),o++}if(!(f==="required"||f==="preferred")){const p={instancePath:e+"/predicate",schemaPath:"#/oneOf/1/properties/predicate/enum",keyword:"enum",params:{allowedValues:sr.oneOf[1].properties.predicate.enum},message:"must be equal to one of the allowed values",schema:sr.oneOf[1].properties.predicate.enum,parentSchema:sr.oneOf[1].properties.predicate,data:f};i===null?i=[p]:i.push(p),o++}}}var h=d===o;if(h&&u?(u=!1,l=[l,1]):h&&(u=!0,l=1),u)o=a,i!==null&&(a?i.length=a:i=null);else{const f={instancePath:e,schemaPath:"#/oneOf",keyword:"oneOf",params:{passingSchemas:l},message:"must match exactly one schema in oneOf",schema:sr.oneOf,parentSchema:sr,data:t};i===null?i=[f]:i.push(f),o++}return k1.errors=i,o===0}function $1(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.id===void 0){const a={instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:"id"},message:"must have required property 'id'",schema:Re.required,parentSchema:Re,data:t};i===null?i=[a]:i.push(a),o++}if(t.schema===void 0){const a={instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:"schema"},message:"must have required property 'schema'",schema:Re.required,parentSchema:Re,data:t};i===null?i=[a]:i.push(a),o++}for(const a in t)if(!(a==="id"||a==="name"||a==="purpose"||a==="group"||a==="schema"||a==="issuance"||a==="constraints")){const u={instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:a},message:"must NOT have additional properties",schema:!1,parentSchema:Re,data:t};i===null?i=[u]:i.push(u),o++}if(t.id!==void 0){let a=t.id;if(typeof a!="string"){const u={instancePath:e+"/id",schemaPath:"#/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Re.properties.id.type,parentSchema:Re.properties.id,data:a};i===null?i=[u]:i.push(u),o++}}if(t.name!==void 0){let a=t.name;if(typeof a!="string"){const u={instancePath:e+"/name",schemaPath:"#/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Re.properties.name.type,parentSchema:Re.properties.name,data:a};i===null?i=[u]:i.push(u),o++}}if(t.purpose!==void 0){let a=t.purpose;if(typeof a!="string"){const u={instancePath:e+"/purpose",schemaPath:"#/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Re.properties.purpose.type,parentSchema:Re.properties.purpose,data:a};i===null?i=[u]:i.push(u),o++}}if(t.group!==void 0){let a=t.group;if(Array.isArray(a)){const u=a.length;for(let l=0;l<u;l++){let c=a[l];if(typeof c!="string"){const d={instancePath:e+"/group/"+l,schemaPath:"#/properties/group/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Re.properties.group.items.type,parentSchema:Re.properties.group.items,data:c};i===null?i=[d]:i.push(d),o++}}}else{const u={instancePath:e+"/group",schemaPath:"#/properties/group/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Re.properties.group.type,parentSchema:Re.properties.group,data:a};i===null?i=[u]:i.push(u),o++}}if(t.schema!==void 0){let a=t.schema;if(Array.isArray(a)){const u=a.length;for(let l=0;l<u;l++)C1(a[l],{instancePath:e+"/schema/"+l,parentData:a,parentDataProperty:l,rootData:s})||(i=i===null?C1.errors:i.concat(C1.errors),o=i.length)}else{const u={instancePath:e+"/schema",schemaPath:"#/properties/schema/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Re.properties.schema.type,parentSchema:Re.properties.schema,data:a};i===null?i=[u]:i.push(u),o++}}if(t.issuance!==void 0){let a=t.issuance;if(Array.isArray(a)){const u=a.length;for(let l=0;l<u;l++)I1(a[l],{instancePath:e+"/issuance/"+l,parentData:a,parentDataProperty:l,rootData:s})||(i=i===null?I1.errors:i.concat(I1.errors),o=i.length)}else{const u={instancePath:e+"/issuance",schemaPath:"#/properties/issuance/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Re.properties.issuance.type,parentSchema:Re.properties.issuance,data:a};i===null?i=[u]:i.push(u),o++}}if(t.constraints!==void 0){let a=t.constraints;if(a&&typeof a=="object"&&!Array.isArray(a)){for(const u in a)if(!(u==="limit_disclosure"||u==="statuses"||u==="fields"||u==="subject_is_issuer"||u==="is_holder"||u==="same_subject")){const l={instancePath:e+"/constraints",schemaPath:"#/properties/constraints/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:u},message:"must NOT have additional properties",schema:!1,parentSchema:Re.properties.constraints,data:a};i===null?i=[l]:i.push(l),o++}if(a.limit_disclosure!==void 0){let u=a.limit_disclosure;if(typeof u!="string"){const l={instancePath:e+"/constraints/limit_disclosure",schemaPath:"#/properties/constraints/properties/limit_disclosure/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Re.properties.constraints.properties.limit_disclosure.type,parentSchema:Re.properties.constraints.properties.limit_disclosure,data:u};i===null?i=[l]:i.push(l),o++}if(!(u==="required"||u==="preferred")){const l={instancePath:e+"/constraints/limit_disclosure",schemaPath:"#/properties/constraints/properties/limit_disclosure/enum",keyword:"enum",params:{allowedValues:Re.properties.constraints.properties.limit_disclosure.enum},message:"must be equal to one of the allowed values",schema:Re.properties.constraints.properties.limit_disclosure.enum,parentSchema:Re.properties.constraints.properties.limit_disclosure,data:u};i===null?i=[l]:i.push(l),o++}}if(a.statuses!==void 0){let u=a.statuses;if(u&&typeof u=="object"&&!Array.isArray(u)){if(u.active!==void 0){let l=u.active;if(l&&typeof l=="object"&&!Array.isArray(l)){if(l.directive!==void 0){let c=l.directive;if(typeof c!="string"){const d={instancePath:e+"/constraints/statuses/active/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/active/properties/directive/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Re.properties.constraints.properties.statuses.properties.active.properties.directive.type,parentSchema:Re.properties.constraints.properties.statuses.properties.active.properties.directive,data:c};i===null?i=[d]:i.push(d),o++}if(!(c==="required"||c==="allowed"||c==="disallowed")){const d={instancePath:e+"/constraints/statuses/active/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/active/properties/directive/enum",keyword:"enum",params:{allowedValues:Re.properties.constraints.properties.statuses.properties.active.properties.directive.enum},message:"must be equal to one of the allowed values",schema:Re.properties.constraints.properties.statuses.properties.active.properties.directive.enum,parentSchema:Re.properties.constraints.properties.statuses.properties.active.properties.directive,data:c};i===null?i=[d]:i.push(d),o++}}}else{const c={instancePath:e+"/constraints/statuses/active",schemaPath:"#/properties/constraints/properties/statuses/properties/active/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Re.properties.constraints.properties.statuses.properties.active.type,parentSchema:Re.properties.constraints.properties.statuses.properties.active,data:l};i===null?i=[c]:i.push(c),o++}}if(u.suspended!==void 0){let l=u.suspended;if(l&&typeof l=="object"&&!Array.isArray(l)){if(l.directive!==void 0){let c=l.directive;if(typeof c!="string"){const d={instancePath:e+"/constraints/statuses/suspended/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/suspended/properties/directive/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Re.properties.constraints.properties.statuses.properties.suspended.properties.directive.type,parentSchema:Re.properties.constraints.properties.statuses.properties.suspended.properties.directive,data:c};i===null?i=[d]:i.push(d),o++}if(!(c==="required"||c==="allowed"||c==="disallowed")){const d={instancePath:e+"/constraints/statuses/suspended/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/suspended/properties/directive/enum",keyword:"enum",params:{allowedValues:Re.properties.constraints.properties.statuses.properties.suspended.properties.directive.enum},message:"must be equal to one of the allowed values",schema:Re.properties.constraints.properties.statuses.properties.suspended.properties.directive.enum,parentSchema:Re.properties.constraints.properties.statuses.properties.suspended.properties.directive,data:c};i===null?i=[d]:i.push(d),o++}}}else{const c={instancePath:e+"/constraints/statuses/suspended",schemaPath:"#/properties/constraints/properties/statuses/properties/suspended/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Re.properties.constraints.properties.statuses.properties.suspended.type,parentSchema:Re.properties.constraints.properties.statuses.properties.suspended,data:l};i===null?i=[c]:i.push(c),o++}}if(u.revoked!==void 0){let l=u.revoked;if(l&&typeof l=="object"&&!Array.isArray(l)){if(l.directive!==void 0){let c=l.directive;if(typeof c!="string"){const d={instancePath:e+"/constraints/statuses/revoked/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/revoked/properties/directive/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Re.properties.constraints.properties.statuses.properties.revoked.properties.directive.type,parentSchema:Re.properties.constraints.properties.statuses.properties.revoked.properties.directive,data:c};i===null?i=[d]:i.push(d),o++}if(!(c==="required"||c==="allowed"||c==="disallowed")){const d={instancePath:e+"/constraints/statuses/revoked/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/revoked/properties/directive/enum",keyword:"enum",params:{allowedValues:Re.properties.constraints.properties.statuses.properties.revoked.properties.directive.enum},message:"must be equal to one of the allowed values",schema:Re.properties.constraints.properties.statuses.properties.revoked.properties.directive.enum,parentSchema:Re.properties.constraints.properties.statuses.properties.revoked.properties.directive,data:c};i===null?i=[d]:i.push(d),o++}}}else{const c={instancePath:e+"/constraints/statuses/revoked",schemaPath:"#/properties/constraints/properties/statuses/properties/revoked/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Re.properties.constraints.properties.statuses.properties.revoked.type,parentSchema:Re.properties.constraints.properties.statuses.properties.revoked,data:l};i===null?i=[c]:i.push(c),o++}}}else{const l={instancePath:e+"/constraints/statuses",schemaPath:"#/properties/constraints/properties/statuses/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Re.properties.constraints.properties.statuses.type,parentSchema:Re.properties.constraints.properties.statuses,data:u};i===null?i=[l]:i.push(l),o++}}if(a.fields!==void 0){let u=a.fields;if(Array.isArray(u)){const l=u.length;for(let c=0;c<l;c++)k1(u[c],{instancePath:e+"/constraints/fields/"+c,parentData:u,parentDataProperty:c,rootData:s})||(i=i===null?k1.errors:i.concat(k1.errors),o=i.length)}else{const l={instancePath:e+"/constraints/fields",schemaPath:"#/properties/constraints/properties/fields/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Re.properties.constraints.properties.fields.type,parentSchema:Re.properties.constraints.properties.fields,data:u};i===null?i=[l]:i.push(l),o++}}if(a.subject_is_issuer!==void 0){let u=a.subject_is_issuer;if(typeof u!="string"){const l={instancePath:e+"/constraints/subject_is_issuer",schemaPath:"#/properties/constraints/properties/subject_is_issuer/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Re.properties.constraints.properties.subject_is_issuer.type,parentSchema:Re.properties.constraints.properties.subject_is_issuer,data:u};i===null?i=[l]:i.push(l),o++}if(!(u==="required"||u==="preferred")){const l={instancePath:e+"/constraints/subject_is_issuer",schemaPath:"#/properties/constraints/properties/subject_is_issuer/enum",keyword:"enum",params:{allowedValues:Re.properties.constraints.properties.subject_is_issuer.enum},message:"must be equal to one of the allowed values",schema:Re.properties.constraints.properties.subject_is_issuer.enum,parentSchema:Re.properties.constraints.properties.subject_is_issuer,data:u};i===null?i=[l]:i.push(l),o++}}if(a.is_holder!==void 0){let u=a.is_holder;if(Array.isArray(u)){const l=u.length;for(let c=0;c<l;c++){let d=u[c];if(d&&typeof d=="object"&&!Array.isArray(d)){if(d.field_id===void 0){const h={instancePath:e+"/constraints/is_holder/"+c,schemaPath:"#/properties/constraints/properties/is_holder/items/required",keyword:"required",params:{missingProperty:"field_id"},message:"must have required property 'field_id'",schema:Re.properties.constraints.properties.is_holder.items.required,parentSchema:Re.properties.constraints.properties.is_holder.items,data:d};i===null?i=[h]:i.push(h),o++}if(d.directive===void 0){const h={instancePath:e+"/constraints/is_holder/"+c,schemaPath:"#/properties/constraints/properties/is_holder/items/required",keyword:"required",params:{missingProperty:"directive"},message:"must have required property 'directive'",schema:Re.properties.constraints.properties.is_holder.items.required,parentSchema:Re.properties.constraints.properties.is_holder.items,data:d};i===null?i=[h]:i.push(h),o++}for(const h in d)if(!(h==="field_id"||h==="directive")){const f={instancePath:e+"/constraints/is_holder/"+c,schemaPath:"#/properties/constraints/properties/is_holder/items/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:h},message:"must NOT have additional properties",schema:!1,parentSchema:Re.properties.constraints.properties.is_holder.items,data:d};i===null?i=[f]:i.push(f),o++}if(d.field_id!==void 0){let h=d.field_id;if(Array.isArray(h)){const f=h.length;for(let p=0;p<f;p++){let m=h[p];if(typeof m!="string"){const E={instancePath:e+"/constraints/is_holder/"+c+"/field_id/"+p,schemaPath:"#/properties/constraints/properties/is_holder/items/properties/field_id/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Re.properties.constraints.properties.is_holder.items.properties.field_id.items.type,parentSchema:Re.properties.constraints.properties.is_holder.items.properties.field_id.items,data:m};i===null?i=[E]:i.push(E),o++}}}else{const f={instancePath:e+"/constraints/is_holder/"+c+"/field_id",schemaPath:"#/properties/constraints/properties/is_holder/items/properties/field_id/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Re.properties.constraints.properties.is_holder.items.properties.field_id.type,parentSchema:Re.properties.constraints.properties.is_holder.items.properties.field_id,data:h};i===null?i=[f]:i.push(f),o++}}if(d.directive!==void 0){let h=d.directive;if(typeof h!="string"){const f={instancePath:e+"/constraints/is_holder/"+c+"/directive",schemaPath:"#/properties/constraints/properties/is_holder/items/properties/directive/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Re.properties.constraints.properties.is_holder.items.properties.directive.type,parentSchema:Re.properties.constraints.properties.is_holder.items.properties.directive,data:h};i===null?i=[f]:i.push(f),o++}if(!(h==="required"||h==="preferred")){const f={instancePath:e+"/constraints/is_holder/"+c+"/directive",schemaPath:"#/properties/constraints/properties/is_holder/items/properties/directive/enum",keyword:"enum",params:{allowedValues:Re.properties.constraints.properties.is_holder.items.properties.directive.enum},message:"must be equal to one of the allowed values",schema:Re.properties.constraints.properties.is_holder.items.properties.directive.enum,parentSchema:Re.properties.constraints.properties.is_holder.items.properties.directive,data:h};i===null?i=[f]:i.push(f),o++}}}else{const h={instancePath:e+"/constraints/is_holder/"+c,schemaPath:"#/properties/constraints/properties/is_holder/items/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Re.properties.constraints.properties.is_holder.items.type,parentSchema:Re.properties.constraints.properties.is_holder.items,data:d};i===null?i=[h]:i.push(h),o++}}}else{const l={instancePath:e+"/constraints/is_holder",schemaPath:"#/properties/constraints/properties/is_holder/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Re.properties.constraints.properties.is_holder.type,parentSchema:Re.properties.constraints.properties.is_holder,data:u};i===null?i=[l]:i.push(l),o++}}if(a.same_subject!==void 0){let u=a.same_subject;if(Array.isArray(u)){const l=u.length;for(let c=0;c<l;c++){let d=u[c];if(d&&typeof d=="object"&&!Array.isArray(d)){if(d.field_id===void 0){const h={instancePath:e+"/constraints/same_subject/"+c,schemaPath:"#/properties/constraints/properties/same_subject/items/required",keyword:"required",params:{missingProperty:"field_id"},message:"must have required property 'field_id'",schema:Re.properties.constraints.properties.same_subject.items.required,parentSchema:Re.properties.constraints.properties.same_subject.items,data:d};i===null?i=[h]:i.push(h),o++}if(d.directive===void 0){const h={instancePath:e+"/constraints/same_subject/"+c,schemaPath:"#/properties/constraints/properties/same_subject/items/required",keyword:"required",params:{missingProperty:"directive"},message:"must have required property 'directive'",schema:Re.properties.constraints.properties.same_subject.items.required,parentSchema:Re.properties.constraints.properties.same_subject.items,data:d};i===null?i=[h]:i.push(h),o++}for(const h in d)if(!(h==="field_id"||h==="directive")){const f={instancePath:e+"/constraints/same_subject/"+c,schemaPath:"#/properties/constraints/properties/same_subject/items/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:h},message:"must NOT have additional properties",schema:!1,parentSchema:Re.properties.constraints.properties.same_subject.items,data:d};i===null?i=[f]:i.push(f),o++}if(d.field_id!==void 0){let h=d.field_id;if(Array.isArray(h)){const f=h.length;for(let p=0;p<f;p++){let m=h[p];if(typeof m!="string"){const E={instancePath:e+"/constraints/same_subject/"+c+"/field_id/"+p,schemaPath:"#/properties/constraints/properties/same_subject/items/properties/field_id/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Re.properties.constraints.properties.same_subject.items.properties.field_id.items.type,parentSchema:Re.properties.constraints.properties.same_subject.items.properties.field_id.items,data:m};i===null?i=[E]:i.push(E),o++}}}else{const f={instancePath:e+"/constraints/same_subject/"+c+"/field_id",schemaPath:"#/properties/constraints/properties/same_subject/items/properties/field_id/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Re.properties.constraints.properties.same_subject.items.properties.field_id.type,parentSchema:Re.properties.constraints.properties.same_subject.items.properties.field_id,data:h};i===null?i=[f]:i.push(f),o++}}if(d.directive!==void 0){let h=d.directive;if(typeof h!="string"){const f={instancePath:e+"/constraints/same_subject/"+c+"/directive",schemaPath:"#/properties/constraints/properties/same_subject/items/properties/directive/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Re.properties.constraints.properties.same_subject.items.properties.directive.type,parentSchema:Re.properties.constraints.properties.same_subject.items.properties.directive,data:h};i===null?i=[f]:i.push(f),o++}if(!(h==="required"||h==="preferred")){const f={instancePath:e+"/constraints/same_subject/"+c+"/directive",schemaPath:"#/properties/constraints/properties/same_subject/items/properties/directive/enum",keyword:"enum",params:{allowedValues:Re.properties.constraints.properties.same_subject.items.properties.directive.enum},message:"must be equal to one of the allowed values",schema:Re.properties.constraints.properties.same_subject.items.properties.directive.enum,parentSchema:Re.properties.constraints.properties.same_subject.items.properties.directive,data:h};i===null?i=[f]:i.push(f),o++}}}else{const h={instancePath:e+"/constraints/same_subject/"+c,schemaPath:"#/properties/constraints/properties/same_subject/items/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Re.properties.constraints.properties.same_subject.items.type,parentSchema:Re.properties.constraints.properties.same_subject.items,data:d};i===null?i=[h]:i.push(h),o++}}}else{const l={instancePath:e+"/constraints/same_subject",schemaPath:"#/properties/constraints/properties/same_subject/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Re.properties.constraints.properties.same_subject.type,parentSchema:Re.properties.constraints.properties.same_subject,data:u};i===null?i=[l]:i.push(l),o++}}}else{const u={instancePath:e+"/constraints",schemaPath:"#/properties/constraints/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Re.properties.constraints.type,parentSchema:Re.properties.constraints,data:a};i===null?i=[u]:i.push(u),o++}}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Re.type,parentSchema:Re,data:t};i===null?i=[a]:i.push(a),o++}return $1.errors=i,o===0}function ZI(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.presentation_definition!==void 0){let a=t.presentation_definition;if(a&&typeof a=="object"&&!Array.isArray(a)){if(a.id===void 0){const u={instancePath:e+"/presentation_definition",schemaPath:"#/properties/presentation_definition/required",keyword:"required",params:{missingProperty:"id"},message:"must have required property 'id'",schema:Bn.properties.presentation_definition.required,parentSchema:Bn.properties.presentation_definition,data:a};i===null?i=[u]:i.push(u),o++}if(a.input_descriptors===void 0){const u={instancePath:e+"/presentation_definition",schemaPath:"#/properties/presentation_definition/required",keyword:"required",params:{missingProperty:"input_descriptors"},message:"must have required property 'input_descriptors'",schema:Bn.properties.presentation_definition.required,parentSchema:Bn.properties.presentation_definition,data:a};i===null?i=[u]:i.push(u),o++}for(const u in a)if(!(u==="id"||u==="name"||u==="purpose"||u==="format"||u==="submission_requirements"||u==="input_descriptors")){const l={instancePath:e+"/presentation_definition",schemaPath:"#/properties/presentation_definition/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:u},message:"must NOT have additional properties",schema:!1,parentSchema:Bn.properties.presentation_definition,data:a};i===null?i=[l]:i.push(l),o++}if(a.id!==void 0){let u=a.id;if(typeof u!="string"){const l={instancePath:e+"/presentation_definition/id",schemaPath:"#/properties/presentation_definition/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Bn.properties.presentation_definition.properties.id.type,parentSchema:Bn.properties.presentation_definition.properties.id,data:u};i===null?i=[l]:i.push(l),o++}}if(a.name!==void 0){let u=a.name;if(typeof u!="string"){const l={instancePath:e+"/presentation_definition/name",schemaPath:"#/properties/presentation_definition/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Bn.properties.presentation_definition.properties.name.type,parentSchema:Bn.properties.presentation_definition.properties.name,data:u};i===null?i=[l]:i.push(l),o++}}if(a.purpose!==void 0){let u=a.purpose;if(typeof u!="string"){const l={instancePath:e+"/presentation_definition/purpose",schemaPath:"#/properties/presentation_definition/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Bn.properties.presentation_definition.properties.purpose.type,parentSchema:Bn.properties.presentation_definition.properties.purpose,data:u};i===null?i=[l]:i.push(l),o++}}if(a.format!==void 0&&(P1(a.format,{instancePath:e+"/presentation_definition/format",parentData:a,parentDataProperty:"format",rootData:s})||(i=i===null?P1.errors:i.concat(P1.errors),o=i.length)),a.submission_requirements!==void 0){let u=a.submission_requirements;if(Array.isArray(u)){const l=u.length;for(let c=0;c<l;c++)sv(u[c],{instancePath:e+"/presentation_definition/submission_requirements/"+c,parentData:u,parentDataProperty:c,rootData:s})||(i=i===null?sv.errors:i.concat(sv.errors),o=i.length)}else{const l={instancePath:e+"/presentation_definition/submission_requirements",schemaPath:"#/properties/presentation_definition/properties/submission_requirements/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Bn.properties.presentation_definition.properties.submission_requirements.type,parentSchema:Bn.properties.presentation_definition.properties.submission_requirements,data:u};i===null?i=[l]:i.push(l),o++}}if(a.input_descriptors!==void 0){let u=a.input_descriptors;if(Array.isArray(u)){const l=u.length;for(let c=0;c<l;c++)$1(u[c],{instancePath:e+"/presentation_definition/input_descriptors/"+c,parentData:u,parentDataProperty:c,rootData:s})||(i=i===null?$1.errors:i.concat($1.errors),o=i.length)}else{const l={instancePath:e+"/presentation_definition/input_descriptors",schemaPath:"#/properties/presentation_definition/properties/input_descriptors/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Bn.properties.presentation_definition.properties.input_descriptors.type,parentSchema:Bn.properties.presentation_definition.properties.input_descriptors,data:u};i===null?i=[l]:i.push(l),o++}}}else{const u={instancePath:e+"/presentation_definition",schemaPath:"#/properties/presentation_definition/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Bn.properties.presentation_definition.type,parentSchema:Bn.properties.presentation_definition,data:a};i===null?i=[u]:i.push(u),o++}}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Bn.type,parentSchema:Bn,data:t};i===null?i=[a]:i.push(a),o++}return ZI.errors=i,o===0}var tge=YI.exports;const oV=nc(tge);var QI={exports:{}},Wy={};Object.defineProperty(Wy,"__esModule",{value:!0});const aV=mS;aV.code='require("ajv/dist/runtime/equal").default';Wy.default=aV;QI.exports=ek;QI.exports.default=ek;const _n={$schema:"http://json-schema.org/draft-07/schema#",title:"Presentation Definition",definitions:{issuance:{type:"object",properties:{manifest:{type:"string"}},additionalProperties:!0},format:{type:"object",patternProperties:{"^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$":{type:"object",properties:{alg:{type:"array",minItems:1,items:{type:"string"}}},required:["alg"],additionalProperties:!1},"^ldp_vc$|^ldp_vp$|^ldp$":{type:"object",properties:{proof_type:{type:"array",minItems:1,items:{type:"string"}}},required:["proof_type"],additionalProperties:!1},additionalProperties:!1},additionalProperties:!1},submission_requirements:{type:"object",oneOf:[{properties:{name:{type:"string"},purpose:{type:"string"},rule:{type:"string",enum:["all","pick"]},count:{type:"integer",minimum:1},min:{type:"integer",minimum:0},max:{type:"integer",minimum:0},from:{type:"string"}},required:["rule","from"],additionalProperties:!1},{properties:{name:{type:"string"},purpose:{type:"string"},rule:{type:"string",enum:["all","pick"]},count:{type:"integer",minimum:1},min:{type:"integer",minimum:0},max:{type:"integer",minimum:0},from_nested:{type:"array",minItems:1,items:{$ref:"#/definitions/submission_requirements"}}},required:["rule","from_nested"],additionalProperties:!1}]},input_descriptors:{type:"object",properties:{id:{type:"string"},name:{type:"string"},purpose:{type:"string"},issuance:{type:"array",items:{$ref:"#/definitions/issuance"}},group:{type:"array",items:{type:"string"}},format:{$ref:"#/definitions/format"},constraints:{type:"object",properties:{limit_disclosure:{type:"string",enum:["required","preferred"]},statuses:{type:"object",properties:{active:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}},suspended:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}},revoked:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}}}},fields:{type:"array",items:{$ref:"#/definitions/field"}},subject_is_issuer:{type:"string",enum:["required","preferred"]},is_holder:{type:"array",items:{type:"object",properties:{field_id:{type:"array",items:{type:"string"}},directive:{type:"string",enum:["required","preferred"]}},required:["field_id","directive"],additionalProperties:!1}},same_subject:{type:"array",items:{type:"object",properties:{field_id:{type:"array",items:{type:"string"}},directive:{type:"string",enum:["required","preferred"]}},required:["field_id","directive"],additionalProperties:!1}}},additionalProperties:!1}},required:["id"],additionalProperties:!1},field:{type:"object",oneOf:[{properties:{id:{type:"string"},path:{type:"array",items:{type:"string"}},purpose:{type:"string"},intent_to_retain:{type:"boolean"},filter:{$ref:"http://json-schema.org/schema#"},name:{type:"string"}},required:["path"],additionalProperties:!1},{properties:{id:{type:"string"},path:{type:"array",items:{type:"string"}},purpose:{type:"string"},intent_to_retain:{type:"boolean"},filter:{$ref:"http://json-schema.org/schema#"},predicate:{type:"string",enum:["required","preferred"]},name:{type:"string"}},required:["path","filter","predicate"],additionalProperties:!1}]}},type:"object",properties:{presentation_definition:{type:"object",properties:{id:{type:"string"},name:{type:"string"},purpose:{type:"string"},format:{$ref:"#/definitions/format"},frame:{type:"object",additionalProperties:!0},submission_requirements:{type:"array",items:{$ref:"#/definitions/submission_requirements"}},input_descriptors:{type:"array",items:{$ref:"#/definitions/input_descriptors"}}},required:["id","input_descriptors"],additionalProperties:!1}}},nn={type:"object",patternProperties:{"^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$":{type:"object",properties:{alg:{type:"array",minItems:1,items:{type:"string"}}},required:["alg"],additionalProperties:!1},"^ldp_vc$|^ldp_vp$|^ldp$":{type:"object",properties:{proof_type:{type:"array",minItems:1,items:{type:"string"}}},required:["proof_type"],additionalProperties:!1},additionalProperties:!1},additionalProperties:!1},u6=new RegExp("^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$","u"),c6=new RegExp("^ldp_vc$|^ldp_vp$|^ldp$","u"),l6=new RegExp("additionalProperties","u");function ap(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){for(const a in t)if(!(u6.test(a)||c6.test(a)||l6.test(a))){const u={instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:a},message:"must NOT have additional properties",schema:!1,parentSchema:nn,data:t};i===null?i=[u]:i.push(u),o++}for(const a in t)if(u6.test(a)){let u=t[a];if(u&&typeof u=="object"&&!Array.isArray(u)){if(u.alg===void 0){const l={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24%7C%5Emso_mdoc%24/required",keyword:"required",params:{missingProperty:"alg"},message:"must have required property 'alg'",schema:nn.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$"].required,parentSchema:nn.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$"],data:u};i===null?i=[l]:i.push(l),o++}for(const l in u)if(l!=="alg"){const c={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24%7C%5Emso_mdoc%24/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:l},message:"must NOT have additional properties",schema:!1,parentSchema:nn.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$"],data:u};i===null?i=[c]:i.push(c),o++}if(u.alg!==void 0){let l=u.alg;if(Array.isArray(l)){if(l.length<1){const d={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/alg",schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24%7C%5Emso_mdoc%24/properties/alg/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items",schema:1,parentSchema:nn.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$"].properties.alg,data:l};i===null?i=[d]:i.push(d),o++}const c=l.length;for(let d=0;d<c;d++){let h=l[d];if(typeof h!="string"){const f={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/alg/"+d,schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24%7C%5Emso_mdoc%24/properties/alg/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:nn.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$"].properties.alg.items.type,parentSchema:nn.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$"].properties.alg.items,data:h};i===null?i=[f]:i.push(f),o++}}}else{const c={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/alg",schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24%7C%5Emso_mdoc%24/properties/alg/type",keyword:"type",params:{type:"array"},message:"must be array",schema:nn.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$"].properties.alg.type,parentSchema:nn.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$"].properties.alg,data:l};i===null?i=[c]:i.push(c),o++}}}else{const l={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24%7C%5Emso_mdoc%24/type",keyword:"type",params:{type:"object"},message:"must be object",schema:nn.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$"].type,parentSchema:nn.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$"],data:u};i===null?i=[l]:i.push(l),o++}}for(const a in t)if(c6.test(a)){let u=t[a];if(u&&typeof u=="object"&&!Array.isArray(u)){if(u.proof_type===void 0){const l={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/required",keyword:"required",params:{missingProperty:"proof_type"},message:"must have required property 'proof_type'",schema:nn.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].required,parentSchema:nn.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"],data:u};i===null?i=[l]:i.push(l),o++}for(const l in u)if(l!=="proof_type"){const c={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:l},message:"must NOT have additional properties",schema:!1,parentSchema:nn.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"],data:u};i===null?i=[c]:i.push(c),o++}if(u.proof_type!==void 0){let l=u.proof_type;if(Array.isArray(l)){if(l.length<1){const d={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/proof_type",schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/properties/proof_type/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items",schema:1,parentSchema:nn.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].properties.proof_type,data:l};i===null?i=[d]:i.push(d),o++}const c=l.length;for(let d=0;d<c;d++){let h=l[d];if(typeof h!="string"){const f={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/proof_type/"+d,schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/properties/proof_type/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:nn.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].properties.proof_type.items.type,parentSchema:nn.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].properties.proof_type.items,data:h};i===null?i=[f]:i.push(f),o++}}}else{const c={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/proof_type",schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/properties/proof_type/type",keyword:"type",params:{type:"array"},message:"must be array",schema:nn.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].properties.proof_type.type,parentSchema:nn.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].properties.proof_type,data:l};i===null?i=[c]:i.push(c),o++}}}else{const l={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/type",keyword:"type",params:{type:"object"},message:"must be object",schema:nn.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].type,parentSchema:nn.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"],data:u};i===null?i=[l]:i.push(l),o++}}for(const a in t)if(l6.test(a)){const u={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/additionalProperties/false schema",keyword:"false schema",params:{},message:"boolean schema is false",schema:!1,parentSchema:nn.patternProperties.additionalProperties,data:t[a]};i===null?i=[u]:i.push(u),o++}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:nn.type,parentSchema:nn,data:t};i===null?i=[a]:i.push(a),o++}return ap.errors=i,o===0}const lt={type:"object",oneOf:[{properties:{name:{type:"string"},purpose:{type:"string"},rule:{type:"string",enum:["all","pick"]},count:{type:"integer",minimum:1},min:{type:"integer",minimum:0},max:{type:"integer",minimum:0},from:{type:"string"}},required:["rule","from"],additionalProperties:!1},{properties:{name:{type:"string"},purpose:{type:"string"},rule:{type:"string",enum:["all","pick"]},count:{type:"integer",minimum:1},min:{type:"integer",minimum:0},max:{type:"integer",minimum:0},from_nested:{type:"array",minItems:1,items:{$ref:"#/definitions/submission_requirements"}}},required:["rule","from_nested"],additionalProperties:!1}]},KT={validate:ov};function ov(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(!(t&&typeof t=="object"&&!Array.isArray(t))){const f={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:lt.type,parentSchema:lt,data:t};i===null?i=[f]:i.push(f),o++}const a=o;let u=!1,l=null;const c=o;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.rule===void 0){const f={instancePath:e,schemaPath:"#/oneOf/0/required",keyword:"required",params:{missingProperty:"rule"},message:"must have required property 'rule'",schema:lt.oneOf[0].required,parentSchema:lt.oneOf[0],data:t};i===null?i=[f]:i.push(f),o++}if(t.from===void 0){const f={instancePath:e,schemaPath:"#/oneOf/0/required",keyword:"required",params:{missingProperty:"from"},message:"must have required property 'from'",schema:lt.oneOf[0].required,parentSchema:lt.oneOf[0],data:t};i===null?i=[f]:i.push(f),o++}for(const f in t)if(!(f==="name"||f==="purpose"||f==="rule"||f==="count"||f==="min"||f==="max"||f==="from")){const p={instancePath:e,schemaPath:"#/oneOf/0/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:f},message:"must NOT have additional properties",schema:!1,parentSchema:lt.oneOf[0],data:t};i===null?i=[p]:i.push(p),o++}if(t.name!==void 0){let f=t.name;if(typeof f!="string"){const p={instancePath:e+"/name",schemaPath:"#/oneOf/0/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string",schema:lt.oneOf[0].properties.name.type,parentSchema:lt.oneOf[0].properties.name,data:f};i===null?i=[p]:i.push(p),o++}}if(t.purpose!==void 0){let f=t.purpose;if(typeof f!="string"){const p={instancePath:e+"/purpose",schemaPath:"#/oneOf/0/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:lt.oneOf[0].properties.purpose.type,parentSchema:lt.oneOf[0].properties.purpose,data:f};i===null?i=[p]:i.push(p),o++}}if(t.rule!==void 0){let f=t.rule;if(typeof f!="string"){const p={instancePath:e+"/rule",schemaPath:"#/oneOf/0/properties/rule/type",keyword:"type",params:{type:"string"},message:"must be string",schema:lt.oneOf[0].properties.rule.type,parentSchema:lt.oneOf[0].properties.rule,data:f};i===null?i=[p]:i.push(p),o++}if(!(f==="all"||f==="pick")){const p={instancePath:e+"/rule",schemaPath:"#/oneOf/0/properties/rule/enum",keyword:"enum",params:{allowedValues:lt.oneOf[0].properties.rule.enum},message:"must be equal to one of the allowed values",schema:lt.oneOf[0].properties.rule.enum,parentSchema:lt.oneOf[0].properties.rule,data:f};i===null?i=[p]:i.push(p),o++}}if(t.count!==void 0){let f=t.count;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/count",schemaPath:"#/oneOf/0/properties/count/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:lt.oneOf[0].properties.count.type,parentSchema:lt.oneOf[0].properties.count,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<1||isNaN(f))){const p={instancePath:e+"/count",schemaPath:"#/oneOf/0/properties/count/minimum",keyword:"minimum",params:{comparison:">=",limit:1},message:"must be >= 1",schema:1,parentSchema:lt.oneOf[0].properties.count,data:f};i===null?i=[p]:i.push(p),o++}}if(t.min!==void 0){let f=t.min;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/min",schemaPath:"#/oneOf/0/properties/min/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:lt.oneOf[0].properties.min.type,parentSchema:lt.oneOf[0].properties.min,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<0||isNaN(f))){const p={instancePath:e+"/min",schemaPath:"#/oneOf/0/properties/min/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0",schema:0,parentSchema:lt.oneOf[0].properties.min,data:f};i===null?i=[p]:i.push(p),o++}}if(t.max!==void 0){let f=t.max;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/max",schemaPath:"#/oneOf/0/properties/max/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:lt.oneOf[0].properties.max.type,parentSchema:lt.oneOf[0].properties.max,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<0||isNaN(f))){const p={instancePath:e+"/max",schemaPath:"#/oneOf/0/properties/max/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0",schema:0,parentSchema:lt.oneOf[0].properties.max,data:f};i===null?i=[p]:i.push(p),o++}}if(t.from!==void 0){let f=t.from;if(typeof f!="string"){const p={instancePath:e+"/from",schemaPath:"#/oneOf/0/properties/from/type",keyword:"type",params:{type:"string"},message:"must be string",schema:lt.oneOf[0].properties.from.type,parentSchema:lt.oneOf[0].properties.from,data:f};i===null?i=[p]:i.push(p),o++}}}var h=c===o;h&&(u=!0,l=0);const d=o;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.rule===void 0){const f={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:"rule"},message:"must have required property 'rule'",schema:lt.oneOf[1].required,parentSchema:lt.oneOf[1],data:t};i===null?i=[f]:i.push(f),o++}if(t.from_nested===void 0){const f={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:"from_nested"},message:"must have required property 'from_nested'",schema:lt.oneOf[1].required,parentSchema:lt.oneOf[1],data:t};i===null?i=[f]:i.push(f),o++}for(const f in t)if(!(f==="name"||f==="purpose"||f==="rule"||f==="count"||f==="min"||f==="max"||f==="from_nested")){const p={instancePath:e,schemaPath:"#/oneOf/1/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:f},message:"must NOT have additional properties",schema:!1,parentSchema:lt.oneOf[1],data:t};i===null?i=[p]:i.push(p),o++}if(t.name!==void 0){let f=t.name;if(typeof f!="string"){const p={instancePath:e+"/name",schemaPath:"#/oneOf/1/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string",schema:lt.oneOf[1].properties.name.type,parentSchema:lt.oneOf[1].properties.name,data:f};i===null?i=[p]:i.push(p),o++}}if(t.purpose!==void 0){let f=t.purpose;if(typeof f!="string"){const p={instancePath:e+"/purpose",schemaPath:"#/oneOf/1/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:lt.oneOf[1].properties.purpose.type,parentSchema:lt.oneOf[1].properties.purpose,data:f};i===null?i=[p]:i.push(p),o++}}if(t.rule!==void 0){let f=t.rule;if(typeof f!="string"){const p={instancePath:e+"/rule",schemaPath:"#/oneOf/1/properties/rule/type",keyword:"type",params:{type:"string"},message:"must be string",schema:lt.oneOf[1].properties.rule.type,parentSchema:lt.oneOf[1].properties.rule,data:f};i===null?i=[p]:i.push(p),o++}if(!(f==="all"||f==="pick")){const p={instancePath:e+"/rule",schemaPath:"#/oneOf/1/properties/rule/enum",keyword:"enum",params:{allowedValues:lt.oneOf[1].properties.rule.enum},message:"must be equal to one of the allowed values",schema:lt.oneOf[1].properties.rule.enum,parentSchema:lt.oneOf[1].properties.rule,data:f};i===null?i=[p]:i.push(p),o++}}if(t.count!==void 0){let f=t.count;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/count",schemaPath:"#/oneOf/1/properties/count/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:lt.oneOf[1].properties.count.type,parentSchema:lt.oneOf[1].properties.count,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<1||isNaN(f))){const p={instancePath:e+"/count",schemaPath:"#/oneOf/1/properties/count/minimum",keyword:"minimum",params:{comparison:">=",limit:1},message:"must be >= 1",schema:1,parentSchema:lt.oneOf[1].properties.count,data:f};i===null?i=[p]:i.push(p),o++}}if(t.min!==void 0){let f=t.min;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/min",schemaPath:"#/oneOf/1/properties/min/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:lt.oneOf[1].properties.min.type,parentSchema:lt.oneOf[1].properties.min,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<0||isNaN(f))){const p={instancePath:e+"/min",schemaPath:"#/oneOf/1/properties/min/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0",schema:0,parentSchema:lt.oneOf[1].properties.min,data:f};i===null?i=[p]:i.push(p),o++}}if(t.max!==void 0){let f=t.max;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/max",schemaPath:"#/oneOf/1/properties/max/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:lt.oneOf[1].properties.max.type,parentSchema:lt.oneOf[1].properties.max,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<0||isNaN(f))){const p={instancePath:e+"/max",schemaPath:"#/oneOf/1/properties/max/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0",schema:0,parentSchema:lt.oneOf[1].properties.max,data:f};i===null?i=[p]:i.push(p),o++}}if(t.from_nested!==void 0){let f=t.from_nested;if(Array.isArray(f)){if(f.length<1){const m={instancePath:e+"/from_nested",schemaPath:"#/oneOf/1/properties/from_nested/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items",schema:1,parentSchema:lt.oneOf[1].properties.from_nested,data:f};i===null?i=[m]:i.push(m),o++}const p=f.length;for(let m=0;m<p;m++)KT.validate(f[m],{instancePath:e+"/from_nested/"+m,parentData:f,parentDataProperty:m,rootData:s})||(i=i===null?KT.validate.errors:i.concat(KT.validate.errors),o=i.length)}else{const p={instancePath:e+"/from_nested",schemaPath:"#/oneOf/1/properties/from_nested/type",keyword:"type",params:{type:"array"},message:"must be array",schema:lt.oneOf[1].properties.from_nested.type,parentSchema:lt.oneOf[1].properties.from_nested,data:f};i===null?i=[p]:i.push(p),o++}}}var h=d===o;if(h&&u?(u=!1,l=[l,1]):h&&(u=!0,l=1),u)o=a,i!==null&&(a?i.length=a:i=null);else{const f={instancePath:e,schemaPath:"#/oneOf",keyword:"oneOf",params:{passingSchemas:l},message:"must match exactly one schema in oneOf",schema:lt.oneOf,parentSchema:lt,data:t};i===null?i=[f]:i.push(f),o++}return ov.errors=i,o===0}const Fe={type:"object",properties:{id:{type:"string"},name:{type:"string"},purpose:{type:"string"},issuance:{type:"array",items:{$ref:"#/definitions/issuance"}},group:{type:"array",items:{type:"string"}},format:{$ref:"#/definitions/format"},constraints:{type:"object",properties:{limit_disclosure:{type:"string",enum:["required","preferred"]},statuses:{type:"object",properties:{active:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}},suspended:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}},revoked:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}}}},fields:{type:"array",items:{$ref:"#/definitions/field"}},subject_is_issuer:{type:"string",enum:["required","preferred"]},is_holder:{type:"array",items:{type:"object",properties:{field_id:{type:"array",items:{type:"string"}},directive:{type:"string",enum:["required","preferred"]}},required:["field_id","directive"],additionalProperties:!1}},same_subject:{type:"array",items:{type:"object",properties:{field_id:{type:"array",items:{type:"string"}},directive:{type:"string",enum:["required","preferred"]}},required:["field_id","directive"],additionalProperties:!1}}},additionalProperties:!1}},required:["id"],additionalProperties:!1},kb={type:"object",properties:{manifest:{type:"string"}},additionalProperties:!0};function O1(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.manifest!==void 0){let a=t.manifest;if(typeof a!="string"){const u={instancePath:e+"/manifest",schemaPath:"#/properties/manifest/type",keyword:"type",params:{type:"string"},message:"must be string",schema:kb.properties.manifest.type,parentSchema:kb.properties.manifest,data:a};i===null?i=[u]:i.push(u),o++}}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:kb.type,parentSchema:kb,data:t};i===null?i=[a]:i.push(a),o++}return O1.errors=i,o===0}const jt={type:"object",oneOf:[{properties:{id:{type:"string"},path:{type:"array",items:{type:"string"}},purpose:{type:"string"},intent_to_retain:{type:"boolean"},filter:{$ref:"http://json-schema.org/schema#"},name:{type:"string"}},required:["path"],additionalProperties:!1},{properties:{id:{type:"string"},path:{type:"array",items:{type:"string"}},purpose:{type:"string"},intent_to_retain:{type:"boolean"},filter:{$ref:"http://json-schema.org/schema#"},predicate:{type:"string",enum:["required","preferred"]},name:{type:"string"}},required:["path","filter","predicate"],additionalProperties:!1}]},Ye={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0},VT={type:"integer",minimum:0};function io(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(!(typeof t=="number"&&!(t%1)&&!isNaN(t))){const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:VT.type,parentSchema:VT,data:t};i===null?i=[a]:i.push(a),o++}if(typeof t=="number"&&(t<0||isNaN(t))){const a={instancePath:e,schemaPath:"#/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0",schema:0,parentSchema:VT,data:t};i===null?i=[a]:i.push(a),o++}return io.errors=i,o===0}function pu(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;return io(t,{instancePath:e,parentData:r,parentDataProperty:n,rootData:s})||(i=i===null?io.errors:i.concat(io.errors),o=i.length),pu.errors=i,o===0}const qT={type:"array",minItems:1,items:{$ref:"#"}},HT={validate:It};function eo(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(Array.isArray(t)){if(t.length<1){const u={instancePath:e,schemaPath:"#/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items",schema:1,parentSchema:qT,data:t};i===null?i=[u]:i.push(u),o++}const a=t.length;for(let u=0;u<a;u++)HT.validate(t[u],{instancePath:e+"/"+u,parentData:t,parentDataProperty:u,rootData:s})||(i=i===null?HT.validate.errors:i.concat(HT.validate.errors),o=i.length)}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"array"},message:"must be array",schema:qT.type,parentSchema:qT,data:t};i===null?i=[a]:i.push(a),o++}return eo.errors=i,o===0}const i0={type:"array",items:{type:"string"},uniqueItems:!0,default:[]};function Eh(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(Array.isArray(t)){const a=t.length;for(let c=0;c<a;c++){let d=t[c];if(typeof d!="string"){const h={instancePath:e+"/"+c,schemaPath:"#/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:i0.items.type,parentSchema:i0.items,data:d};i===null?i=[h]:i.push(h),o++}}let u=t.length,l;if(u>1){const c={};for(;u--;){let d=t[u];if(typeof d=="string"){if(typeof c[d]=="number"){l=c[d];const h={instancePath:e,schemaPath:"#/uniqueItems",keyword:"uniqueItems",params:{i:u,j:l},message:"must NOT have duplicate items (items ## "+l+" and "+u+" are identical)",schema:!0,parentSchema:i0,data:t};i===null?i=[h]:i.push(h),o++;break}c[d]=u}}}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"array"},message:"must be array",schema:i0.type,parentSchema:i0,data:t};i===null?i=[a]:i.push(a),o++}return Eh.errors=i,o===0}const zT={enum:["array","boolean","integer","null","number","object","string"]};function Ah(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(!(t==="array"||t==="boolean"||t==="integer"||t==="null"||t==="number"||t==="object"||t==="string")){const a={instancePath:e,schemaPath:"#/enum",keyword:"enum",params:{allowedValues:zT.enum},message:"must be equal to one of the allowed values",schema:zT.enum,parentSchema:zT,data:t};i===null?i=[a]:i.push(a),o++}return Ah.errors=i,o===0}const d6=Wy.default;function It(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(!(t&&typeof t=="object"&&!Array.isArray(t))&&typeof t!="boolean"){const d={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:Ye.type},message:"must be object,boolean",schema:Ye.type,parentSchema:Ye,data:t};i===null?i=[d]:i.push(d),o++}if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.$id!==void 0){let d=t.$id;if(typeof d!="string"){const h={instancePath:e+"/$id",schemaPath:"#/properties/%24id/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ye.properties.$id.type,parentSchema:Ye.properties.$id,data:d};i===null?i=[h]:i.push(h),o++}}if(t.$schema!==void 0){let d=t.$schema;if(typeof d!="string"){const h={instancePath:e+"/$schema",schemaPath:"#/properties/%24schema/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ye.properties.$schema.type,parentSchema:Ye.properties.$schema,data:d};i===null?i=[h]:i.push(h),o++}}if(t.$ref!==void 0){let d=t.$ref;if(typeof d!="string"){const h={instancePath:e+"/$ref",schemaPath:"#/properties/%24ref/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ye.properties.$ref.type,parentSchema:Ye.properties.$ref,data:d};i===null?i=[h]:i.push(h),o++}}if(t.$comment!==void 0){let d=t.$comment;if(typeof d!="string"){const h={instancePath:e+"/$comment",schemaPath:"#/properties/%24comment/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ye.properties.$comment.type,parentSchema:Ye.properties.$comment,data:d};i===null?i=[h]:i.push(h),o++}}if(t.title!==void 0){let d=t.title;if(typeof d!="string"){const h={instancePath:e+"/title",schemaPath:"#/properties/title/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ye.properties.title.type,parentSchema:Ye.properties.title,data:d};i===null?i=[h]:i.push(h),o++}}if(t.description!==void 0){let d=t.description;if(typeof d!="string"){const h={instancePath:e+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ye.properties.description.type,parentSchema:Ye.properties.description,data:d};i===null?i=[h]:i.push(h),o++}}if(t.readOnly!==void 0){let d=t.readOnly;if(typeof d!="boolean"){const h={instancePath:e+"/readOnly",schemaPath:"#/properties/readOnly/type",keyword:"type",params:{type:"boolean"},message:"must be boolean",schema:Ye.properties.readOnly.type,parentSchema:Ye.properties.readOnly,data:d};i===null?i=[h]:i.push(h),o++}}if(t.examples!==void 0){let d=t.examples;if(!Array.isArray(d)){const h={instancePath:e+"/examples",schemaPath:"#/properties/examples/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Ye.properties.examples.type,parentSchema:Ye.properties.examples,data:d};i===null?i=[h]:i.push(h),o++}}if(t.multipleOf!==void 0){let d=t.multipleOf;if(typeof d=="number"){if(d<=0||isNaN(d)){const h={instancePath:e+"/multipleOf",schemaPath:"#/properties/multipleOf/exclusiveMinimum",keyword:"exclusiveMinimum",params:{comparison:">",limit:0},message:"must be > 0",schema:0,parentSchema:Ye.properties.multipleOf,data:d};i===null?i=[h]:i.push(h),o++}}else{const h={instancePath:e+"/multipleOf",schemaPath:"#/properties/multipleOf/type",keyword:"type",params:{type:"number"},message:"must be number",schema:Ye.properties.multipleOf.type,parentSchema:Ye.properties.multipleOf,data:d};i===null?i=[h]:i.push(h),o++}}if(t.maximum!==void 0){let d=t.maximum;if(typeof d!="number"){const h={instancePath:e+"/maximum",schemaPath:"#/properties/maximum/type",keyword:"type",params:{type:"number"},message:"must be number",schema:Ye.properties.maximum.type,parentSchema:Ye.properties.maximum,data:d};i===null?i=[h]:i.push(h),o++}}if(t.exclusiveMaximum!==void 0){let d=t.exclusiveMaximum;if(typeof d!="number"){const h={instancePath:e+"/exclusiveMaximum",schemaPath:"#/properties/exclusiveMaximum/type",keyword:"type",params:{type:"number"},message:"must be number",schema:Ye.properties.exclusiveMaximum.type,parentSchema:Ye.properties.exclusiveMaximum,data:d};i===null?i=[h]:i.push(h),o++}}if(t.minimum!==void 0){let d=t.minimum;if(typeof d!="number"){const h={instancePath:e+"/minimum",schemaPath:"#/properties/minimum/type",keyword:"type",params:{type:"number"},message:"must be number",schema:Ye.properties.minimum.type,parentSchema:Ye.properties.minimum,data:d};i===null?i=[h]:i.push(h),o++}}if(t.exclusiveMinimum!==void 0){let d=t.exclusiveMinimum;if(typeof d!="number"){const h={instancePath:e+"/exclusiveMinimum",schemaPath:"#/properties/exclusiveMinimum/type",keyword:"type",params:{type:"number"},message:"must be number",schema:Ye.properties.exclusiveMinimum.type,parentSchema:Ye.properties.exclusiveMinimum,data:d};i===null?i=[h]:i.push(h),o++}}if(t.maxLength!==void 0&&(io(t.maxLength,{instancePath:e+"/maxLength",parentData:t,parentDataProperty:"maxLength",rootData:s})||(i=i===null?io.errors:i.concat(io.errors),o=i.length)),t.minLength!==void 0&&(pu(t.minLength,{instancePath:e+"/minLength",parentData:t,parentDataProperty:"minLength",rootData:s})||(i=i===null?pu.errors:i.concat(pu.errors),o=i.length)),t.pattern!==void 0){let d=t.pattern;if(typeof d!="string"){const h={instancePath:e+"/pattern",schemaPath:"#/properties/pattern/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ye.properties.pattern.type,parentSchema:Ye.properties.pattern,data:d};i===null?i=[h]:i.push(h),o++}}if(t.additionalItems!==void 0&&(It(t.additionalItems,{instancePath:e+"/additionalItems",parentData:t,parentDataProperty:"additionalItems",rootData:s})||(i=i===null?It.errors:i.concat(It.errors),o=i.length)),t.items!==void 0){let d=t.items;const h=o;let f=!1;const p=o;It(d,{instancePath:e+"/items",parentData:t,parentDataProperty:"items",rootData:s})||(i=i===null?It.errors:i.concat(It.errors),o=i.length);var a=p===o;if(f=f||a,!f){const m=o;eo(d,{instancePath:e+"/items",parentData:t,parentDataProperty:"items",rootData:s})||(i=i===null?eo.errors:i.concat(eo.errors),o=i.length);var a=m===o;f=f||a}if(f)o=h,i!==null&&(h?i.length=h:i=null);else{const m={instancePath:e+"/items",schemaPath:"#/properties/items/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf",schema:Ye.properties.items.anyOf,parentSchema:Ye.properties.items,data:d};i===null?i=[m]:i.push(m),o++}}if(t.maxItems!==void 0&&(io(t.maxItems,{instancePath:e+"/maxItems",parentData:t,parentDataProperty:"maxItems",rootData:s})||(i=i===null?io.errors:i.concat(io.errors),o=i.length)),t.minItems!==void 0&&(pu(t.minItems,{instancePath:e+"/minItems",parentData:t,parentDataProperty:"minItems",rootData:s})||(i=i===null?pu.errors:i.concat(pu.errors),o=i.length)),t.uniqueItems!==void 0){let d=t.uniqueItems;if(typeof d!="boolean"){const h={instancePath:e+"/uniqueItems",schemaPath:"#/properties/uniqueItems/type",keyword:"type",params:{type:"boolean"},message:"must be boolean",schema:Ye.properties.uniqueItems.type,parentSchema:Ye.properties.uniqueItems,data:d};i===null?i=[h]:i.push(h),o++}}if(t.contains!==void 0&&(It(t.contains,{instancePath:e+"/contains",parentData:t,parentDataProperty:"contains",rootData:s})||(i=i===null?It.errors:i.concat(It.errors),o=i.length)),t.maxProperties!==void 0&&(io(t.maxProperties,{instancePath:e+"/maxProperties",parentData:t,parentDataProperty:"maxProperties",rootData:s})||(i=i===null?io.errors:i.concat(io.errors),o=i.length)),t.minProperties!==void 0&&(pu(t.minProperties,{instancePath:e+"/minProperties",parentData:t,parentDataProperty:"minProperties",rootData:s})||(i=i===null?pu.errors:i.concat(pu.errors),o=i.length)),t.required!==void 0&&(Eh(t.required,{instancePath:e+"/required",parentData:t,parentDataProperty:"required",rootData:s})||(i=i===null?Eh.errors:i.concat(Eh.errors),o=i.length)),t.additionalProperties!==void 0&&(It(t.additionalProperties,{instancePath:e+"/additionalProperties",parentData:t,parentDataProperty:"additionalProperties",rootData:s})||(i=i===null?It.errors:i.concat(It.errors),o=i.length)),t.definitions!==void 0){let d=t.definitions;if(d&&typeof d=="object"&&!Array.isArray(d))for(const h in d)It(d[h],{instancePath:e+"/definitions/"+h.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:d,parentDataProperty:h,rootData:s})||(i=i===null?It.errors:i.concat(It.errors),o=i.length);else{const h={instancePath:e+"/definitions",schemaPath:"#/properties/definitions/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Ye.properties.definitions.type,parentSchema:Ye.properties.definitions,data:d};i===null?i=[h]:i.push(h),o++}}if(t.properties!==void 0){let d=t.properties;if(d&&typeof d=="object"&&!Array.isArray(d))for(const h in d)It(d[h],{instancePath:e+"/properties/"+h.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:d,parentDataProperty:h,rootData:s})||(i=i===null?It.errors:i.concat(It.errors),o=i.length);else{const h={instancePath:e+"/properties",schemaPath:"#/properties/properties/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Ye.properties.properties.type,parentSchema:Ye.properties.properties,data:d};i===null?i=[h]:i.push(h),o++}}if(t.patternProperties!==void 0){let d=t.patternProperties;if(d&&typeof d=="object"&&!Array.isArray(d)){for(const h in d){var u=o===o;if(!u){const p={instancePath:e+"/patternProperties",schemaPath:"#/properties/patternProperties/propertyNames",keyword:"propertyNames",params:{propertyName:h},message:"property name must be valid",schema:Ye.properties.patternProperties.propertyNames,parentSchema:Ye.properties.patternProperties,data:d};i===null?i=[p]:i.push(p),o++}}for(const h in d)It(d[h],{instancePath:e+"/patternProperties/"+h.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:d,parentDataProperty:h,rootData:s})||(i=i===null?It.errors:i.concat(It.errors),o=i.length)}else{const h={instancePath:e+"/patternProperties",schemaPath:"#/properties/patternProperties/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Ye.properties.patternProperties.type,parentSchema:Ye.properties.patternProperties,data:d};i===null?i=[h]:i.push(h),o++}}if(t.dependencies!==void 0){let d=t.dependencies;if(d&&typeof d=="object"&&!Array.isArray(d))for(const h in d){let f=d[h];const p=o;let m=!1;const E=o;It(f,{instancePath:e+"/dependencies/"+h.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:d,parentDataProperty:h,rootData:s})||(i=i===null?It.errors:i.concat(It.errors),o=i.length);var l=E===o;if(m=m||l,!m){const A=o;Eh(f,{instancePath:e+"/dependencies/"+h.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:d,parentDataProperty:h,rootData:s})||(i=i===null?Eh.errors:i.concat(Eh.errors),o=i.length);var l=A===o;m=m||l}if(m)o=p,i!==null&&(p?i.length=p:i=null);else{const A={instancePath:e+"/dependencies/"+h.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/dependencies/additionalProperties/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf",schema:Ye.properties.dependencies.additionalProperties.anyOf,parentSchema:Ye.properties.dependencies.additionalProperties,data:f};i===null?i=[A]:i.push(A),o++}}else{const h={instancePath:e+"/dependencies",schemaPath:"#/properties/dependencies/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Ye.properties.dependencies.type,parentSchema:Ye.properties.dependencies,data:d};i===null?i=[h]:i.push(h),o++}}if(t.propertyNames!==void 0&&(It(t.propertyNames,{instancePath:e+"/propertyNames",parentData:t,parentDataProperty:"propertyNames",rootData:s})||(i=i===null?It.errors:i.concat(It.errors),o=i.length)),t.enum!==void 0){let d=t.enum;if(Array.isArray(d)){if(d.length<1){const p={instancePath:e+"/enum",schemaPath:"#/properties/enum/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items",schema:1,parentSchema:Ye.properties.enum,data:d};i===null?i=[p]:i.push(p),o++}let h=d.length,f;if(h>1){e:for(;h--;)for(f=h;f--;)if(d6(d[h],d[f])){const p={instancePath:e+"/enum",schemaPath:"#/properties/enum/uniqueItems",keyword:"uniqueItems",params:{i:h,j:f},message:"must NOT have duplicate items (items ## "+f+" and "+h+" are identical)",schema:!0,parentSchema:Ye.properties.enum,data:d};i===null?i=[p]:i.push(p),o++;break e}}}else{const h={instancePath:e+"/enum",schemaPath:"#/properties/enum/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Ye.properties.enum.type,parentSchema:Ye.properties.enum,data:d};i===null?i=[h]:i.push(h),o++}}if(t.type!==void 0){let d=t.type;const h=o;let f=!1;const p=o;Ah(d,{instancePath:e+"/type",parentData:t,parentDataProperty:"type",rootData:s})||(i=i===null?Ah.errors:i.concat(Ah.errors),o=i.length);var c=p===o;if(f=f||c,!f){const m=o;if(Array.isArray(d)){if(d.length<1){const v={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf/1/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items",schema:1,parentSchema:Ye.properties.type.anyOf[1],data:d};i===null?i=[v]:i.push(v),o++}const A=d.length;for(let v=0;v<A;v++)Ah(d[v],{instancePath:e+"/type/"+v,parentData:d,parentDataProperty:v,rootData:s})||(i=i===null?Ah.errors:i.concat(Ah.errors),o=i.length);let _=d.length,g;if(_>1){e:for(;_--;)for(g=_;g--;)if(d6(d[_],d[g])){const v={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf/1/uniqueItems",keyword:"uniqueItems",params:{i:_,j:g},message:"must NOT have duplicate items (items ## "+g+" and "+_+" are identical)",schema:!0,parentSchema:Ye.properties.type.anyOf[1],data:d};i===null?i=[v]:i.push(v),o++;break e}}}else{const A={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf/1/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Ye.properties.type.anyOf[1].type,parentSchema:Ye.properties.type.anyOf[1],data:d};i===null?i=[A]:i.push(A),o++}var c=m===o;f=f||c}if(f)o=h,i!==null&&(h?i.length=h:i=null);else{const m={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf",schema:Ye.properties.type.anyOf,parentSchema:Ye.properties.type,data:d};i===null?i=[m]:i.push(m),o++}}if(t.format!==void 0){let d=t.format;if(typeof d!="string"){const h={instancePath:e+"/format",schemaPath:"#/properties/format/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ye.properties.format.type,parentSchema:Ye.properties.format,data:d};i===null?i=[h]:i.push(h),o++}}if(t.contentMediaType!==void 0){let d=t.contentMediaType;if(typeof d!="string"){const h={instancePath:e+"/contentMediaType",schemaPath:"#/properties/contentMediaType/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ye.properties.contentMediaType.type,parentSchema:Ye.properties.contentMediaType,data:d};i===null?i=[h]:i.push(h),o++}}if(t.contentEncoding!==void 0){let d=t.contentEncoding;if(typeof d!="string"){const h={instancePath:e+"/contentEncoding",schemaPath:"#/properties/contentEncoding/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ye.properties.contentEncoding.type,parentSchema:Ye.properties.contentEncoding,data:d};i===null?i=[h]:i.push(h),o++}}t.if!==void 0&&(It(t.if,{instancePath:e+"/if",parentData:t,parentDataProperty:"if",rootData:s})||(i=i===null?It.errors:i.concat(It.errors),o=i.length)),t.then!==void 0&&(It(t.then,{instancePath:e+"/then",parentData:t,parentDataProperty:"then",rootData:s})||(i=i===null?It.errors:i.concat(It.errors),o=i.length)),t.else!==void 0&&(It(t.else,{instancePath:e+"/else",parentData:t,parentDataProperty:"else",rootData:s})||(i=i===null?It.errors:i.concat(It.errors),o=i.length)),t.allOf!==void 0&&(eo(t.allOf,{instancePath:e+"/allOf",parentData:t,parentDataProperty:"allOf",rootData:s})||(i=i===null?eo.errors:i.concat(eo.errors),o=i.length)),t.anyOf!==void 0&&(eo(t.anyOf,{instancePath:e+"/anyOf",parentData:t,parentDataProperty:"anyOf",rootData:s})||(i=i===null?eo.errors:i.concat(eo.errors),o=i.length)),t.oneOf!==void 0&&(eo(t.oneOf,{instancePath:e+"/oneOf",parentData:t,parentDataProperty:"oneOf",rootData:s})||(i=i===null?eo.errors:i.concat(eo.errors),o=i.length)),t.not!==void 0&&(It(t.not,{instancePath:e+"/not",parentData:t,parentDataProperty:"not",rootData:s})||(i=i===null?It.errors:i.concat(It.errors),o=i.length))}return It.errors=i,o===0}function R1(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(!(t&&typeof t=="object"&&!Array.isArray(t))){const f={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:jt.type,parentSchema:jt,data:t};i===null?i=[f]:i.push(f),o++}const a=o;let u=!1,l=null;const c=o;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.path===void 0){const f={instancePath:e,schemaPath:"#/oneOf/0/required",keyword:"required",params:{missingProperty:"path"},message:"must have required property 'path'",schema:jt.oneOf[0].required,parentSchema:jt.oneOf[0],data:t};i===null?i=[f]:i.push(f),o++}for(const f in t)if(!(f==="id"||f==="path"||f==="purpose"||f==="intent_to_retain"||f==="filter"||f==="name")){const p={instancePath:e,schemaPath:"#/oneOf/0/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:f},message:"must NOT have additional properties",schema:!1,parentSchema:jt.oneOf[0],data:t};i===null?i=[p]:i.push(p),o++}if(t.id!==void 0){let f=t.id;if(typeof f!="string"){const p={instancePath:e+"/id",schemaPath:"#/oneOf/0/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string",schema:jt.oneOf[0].properties.id.type,parentSchema:jt.oneOf[0].properties.id,data:f};i===null?i=[p]:i.push(p),o++}}if(t.path!==void 0){let f=t.path;if(Array.isArray(f)){const p=f.length;for(let m=0;m<p;m++){let E=f[m];if(typeof E!="string"){const A={instancePath:e+"/path/"+m,schemaPath:"#/oneOf/0/properties/path/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:jt.oneOf[0].properties.path.items.type,parentSchema:jt.oneOf[0].properties.path.items,data:E};i===null?i=[A]:i.push(A),o++}}}else{const p={instancePath:e+"/path",schemaPath:"#/oneOf/0/properties/path/type",keyword:"type",params:{type:"array"},message:"must be array",schema:jt.oneOf[0].properties.path.type,parentSchema:jt.oneOf[0].properties.path,data:f};i===null?i=[p]:i.push(p),o++}}if(t.purpose!==void 0){let f=t.purpose;if(typeof f!="string"){const p={instancePath:e+"/purpose",schemaPath:"#/oneOf/0/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:jt.oneOf[0].properties.purpose.type,parentSchema:jt.oneOf[0].properties.purpose,data:f};i===null?i=[p]:i.push(p),o++}}if(t.intent_to_retain!==void 0){let f=t.intent_to_retain;if(typeof f!="boolean"){const p={instancePath:e+"/intent_to_retain",schemaPath:"#/oneOf/0/properties/intent_to_retain/type",keyword:"type",params:{type:"boolean"},message:"must be boolean",schema:jt.oneOf[0].properties.intent_to_retain.type,parentSchema:jt.oneOf[0].properties.intent_to_retain,data:f};i===null?i=[p]:i.push(p),o++}}if(t.filter!==void 0&&(It(t.filter,{instancePath:e+"/filter",parentData:t,parentDataProperty:"filter",rootData:s})||(i=i===null?It.errors:i.concat(It.errors),o=i.length)),t.name!==void 0){let f=t.name;if(typeof f!="string"){const p={instancePath:e+"/name",schemaPath:"#/oneOf/0/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string",schema:jt.oneOf[0].properties.name.type,parentSchema:jt.oneOf[0].properties.name,data:f};i===null?i=[p]:i.push(p),o++}}}var h=c===o;h&&(u=!0,l=0);const d=o;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.path===void 0){const f={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:"path"},message:"must have required property 'path'",schema:jt.oneOf[1].required,parentSchema:jt.oneOf[1],data:t};i===null?i=[f]:i.push(f),o++}if(t.filter===void 0){const f={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:"filter"},message:"must have required property 'filter'",schema:jt.oneOf[1].required,parentSchema:jt.oneOf[1],data:t};i===null?i=[f]:i.push(f),o++}if(t.predicate===void 0){const f={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:"predicate"},message:"must have required property 'predicate'",schema:jt.oneOf[1].required,parentSchema:jt.oneOf[1],data:t};i===null?i=[f]:i.push(f),o++}for(const f in t)if(!(f==="id"||f==="path"||f==="purpose"||f==="intent_to_retain"||f==="filter"||f==="predicate"||f==="name")){const p={instancePath:e,schemaPath:"#/oneOf/1/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:f},message:"must NOT have additional properties",schema:!1,parentSchema:jt.oneOf[1],data:t};i===null?i=[p]:i.push(p),o++}if(t.id!==void 0){let f=t.id;if(typeof f!="string"){const p={instancePath:e+"/id",schemaPath:"#/oneOf/1/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string",schema:jt.oneOf[1].properties.id.type,parentSchema:jt.oneOf[1].properties.id,data:f};i===null?i=[p]:i.push(p),o++}}if(t.path!==void 0){let f=t.path;if(Array.isArray(f)){const p=f.length;for(let m=0;m<p;m++){let E=f[m];if(typeof E!="string"){const A={instancePath:e+"/path/"+m,schemaPath:"#/oneOf/1/properties/path/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:jt.oneOf[1].properties.path.items.type,parentSchema:jt.oneOf[1].properties.path.items,data:E};i===null?i=[A]:i.push(A),o++}}}else{const p={instancePath:e+"/path",schemaPath:"#/oneOf/1/properties/path/type",keyword:"type",params:{type:"array"},message:"must be array",schema:jt.oneOf[1].properties.path.type,parentSchema:jt.oneOf[1].properties.path,data:f};i===null?i=[p]:i.push(p),o++}}if(t.purpose!==void 0){let f=t.purpose;if(typeof f!="string"){const p={instancePath:e+"/purpose",schemaPath:"#/oneOf/1/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:jt.oneOf[1].properties.purpose.type,parentSchema:jt.oneOf[1].properties.purpose,data:f};i===null?i=[p]:i.push(p),o++}}if(t.intent_to_retain!==void 0){let f=t.intent_to_retain;if(typeof f!="boolean"){const p={instancePath:e+"/intent_to_retain",schemaPath:"#/oneOf/1/properties/intent_to_retain/type",keyword:"type",params:{type:"boolean"},message:"must be boolean",schema:jt.oneOf[1].properties.intent_to_retain.type,parentSchema:jt.oneOf[1].properties.intent_to_retain,data:f};i===null?i=[p]:i.push(p),o++}}if(t.filter!==void 0&&(It(t.filter,{instancePath:e+"/filter",parentData:t,parentDataProperty:"filter",rootData:s})||(i=i===null?It.errors:i.concat(It.errors),o=i.length)),t.predicate!==void 0){let f=t.predicate;if(typeof f!="string"){const p={instancePath:e+"/predicate",schemaPath:"#/oneOf/1/properties/predicate/type",keyword:"type",params:{type:"string"},message:"must be string",schema:jt.oneOf[1].properties.predicate.type,parentSchema:jt.oneOf[1].properties.predicate,data:f};i===null?i=[p]:i.push(p),o++}if(!(f==="required"||f==="preferred")){const p={instancePath:e+"/predicate",schemaPath:"#/oneOf/1/properties/predicate/enum",keyword:"enum",params:{allowedValues:jt.oneOf[1].properties.predicate.enum},message:"must be equal to one of the allowed values",schema:jt.oneOf[1].properties.predicate.enum,parentSchema:jt.oneOf[1].properties.predicate,data:f};i===null?i=[p]:i.push(p),o++}}if(t.name!==void 0){let f=t.name;if(typeof f!="string"){const p={instancePath:e+"/name",schemaPath:"#/oneOf/1/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string",schema:jt.oneOf[1].properties.name.type,parentSchema:jt.oneOf[1].properties.name,data:f};i===null?i=[p]:i.push(p),o++}}}var h=d===o;if(h&&u?(u=!1,l=[l,1]):h&&(u=!0,l=1),u)o=a,i!==null&&(a?i.length=a:i=null);else{const f={instancePath:e,schemaPath:"#/oneOf",keyword:"oneOf",params:{passingSchemas:l},message:"must match exactly one schema in oneOf",schema:jt.oneOf,parentSchema:jt,data:t};i===null?i=[f]:i.push(f),o++}return R1.errors=i,o===0}function N1(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.id===void 0){const a={instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:"id"},message:"must have required property 'id'",schema:Fe.required,parentSchema:Fe,data:t};i===null?i=[a]:i.push(a),o++}for(const a in t)if(!(a==="id"||a==="name"||a==="purpose"||a==="issuance"||a==="group"||a==="format"||a==="constraints")){const u={instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:a},message:"must NOT have additional properties",schema:!1,parentSchema:Fe,data:t};i===null?i=[u]:i.push(u),o++}if(t.id!==void 0){let a=t.id;if(typeof a!="string"){const u={instancePath:e+"/id",schemaPath:"#/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Fe.properties.id.type,parentSchema:Fe.properties.id,data:a};i===null?i=[u]:i.push(u),o++}}if(t.name!==void 0){let a=t.name;if(typeof a!="string"){const u={instancePath:e+"/name",schemaPath:"#/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Fe.properties.name.type,parentSchema:Fe.properties.name,data:a};i===null?i=[u]:i.push(u),o++}}if(t.purpose!==void 0){let a=t.purpose;if(typeof a!="string"){const u={instancePath:e+"/purpose",schemaPath:"#/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Fe.properties.purpose.type,parentSchema:Fe.properties.purpose,data:a};i===null?i=[u]:i.push(u),o++}}if(t.issuance!==void 0){let a=t.issuance;if(Array.isArray(a)){const u=a.length;for(let l=0;l<u;l++)O1(a[l],{instancePath:e+"/issuance/"+l,parentData:a,parentDataProperty:l,rootData:s})||(i=i===null?O1.errors:i.concat(O1.errors),o=i.length)}else{const u={instancePath:e+"/issuance",schemaPath:"#/properties/issuance/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Fe.properties.issuance.type,parentSchema:Fe.properties.issuance,data:a};i===null?i=[u]:i.push(u),o++}}if(t.group!==void 0){let a=t.group;if(Array.isArray(a)){const u=a.length;for(let l=0;l<u;l++){let c=a[l];if(typeof c!="string"){const d={instancePath:e+"/group/"+l,schemaPath:"#/properties/group/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Fe.properties.group.items.type,parentSchema:Fe.properties.group.items,data:c};i===null?i=[d]:i.push(d),o++}}}else{const u={instancePath:e+"/group",schemaPath:"#/properties/group/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Fe.properties.group.type,parentSchema:Fe.properties.group,data:a};i===null?i=[u]:i.push(u),o++}}if(t.format!==void 0&&(ap(t.format,{instancePath:e+"/format",parentData:t,parentDataProperty:"format",rootData:s})||(i=i===null?ap.errors:i.concat(ap.errors),o=i.length)),t.constraints!==void 0){let a=t.constraints;if(a&&typeof a=="object"&&!Array.isArray(a)){for(const u in a)if(!(u==="limit_disclosure"||u==="statuses"||u==="fields"||u==="subject_is_issuer"||u==="is_holder"||u==="same_subject")){const l={instancePath:e+"/constraints",schemaPath:"#/properties/constraints/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:u},message:"must NOT have additional properties",schema:!1,parentSchema:Fe.properties.constraints,data:a};i===null?i=[l]:i.push(l),o++}if(a.limit_disclosure!==void 0){let u=a.limit_disclosure;if(typeof u!="string"){const l={instancePath:e+"/constraints/limit_disclosure",schemaPath:"#/properties/constraints/properties/limit_disclosure/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Fe.properties.constraints.properties.limit_disclosure.type,parentSchema:Fe.properties.constraints.properties.limit_disclosure,data:u};i===null?i=[l]:i.push(l),o++}if(!(u==="required"||u==="preferred")){const l={instancePath:e+"/constraints/limit_disclosure",schemaPath:"#/properties/constraints/properties/limit_disclosure/enum",keyword:"enum",params:{allowedValues:Fe.properties.constraints.properties.limit_disclosure.enum},message:"must be equal to one of the allowed values",schema:Fe.properties.constraints.properties.limit_disclosure.enum,parentSchema:Fe.properties.constraints.properties.limit_disclosure,data:u};i===null?i=[l]:i.push(l),o++}}if(a.statuses!==void 0){let u=a.statuses;if(u&&typeof u=="object"&&!Array.isArray(u)){if(u.active!==void 0){let l=u.active;if(l&&typeof l=="object"&&!Array.isArray(l)){if(l.directive!==void 0){let c=l.directive;if(typeof c!="string"){const d={instancePath:e+"/constraints/statuses/active/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/active/properties/directive/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Fe.properties.constraints.properties.statuses.properties.active.properties.directive.type,parentSchema:Fe.properties.constraints.properties.statuses.properties.active.properties.directive,data:c};i===null?i=[d]:i.push(d),o++}if(!(c==="required"||c==="allowed"||c==="disallowed")){const d={instancePath:e+"/constraints/statuses/active/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/active/properties/directive/enum",keyword:"enum",params:{allowedValues:Fe.properties.constraints.properties.statuses.properties.active.properties.directive.enum},message:"must be equal to one of the allowed values",schema:Fe.properties.constraints.properties.statuses.properties.active.properties.directive.enum,parentSchema:Fe.properties.constraints.properties.statuses.properties.active.properties.directive,data:c};i===null?i=[d]:i.push(d),o++}}}else{const c={instancePath:e+"/constraints/statuses/active",schemaPath:"#/properties/constraints/properties/statuses/properties/active/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Fe.properties.constraints.properties.statuses.properties.active.type,parentSchema:Fe.properties.constraints.properties.statuses.properties.active,data:l};i===null?i=[c]:i.push(c),o++}}if(u.suspended!==void 0){let l=u.suspended;if(l&&typeof l=="object"&&!Array.isArray(l)){if(l.directive!==void 0){let c=l.directive;if(typeof c!="string"){const d={instancePath:e+"/constraints/statuses/suspended/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/suspended/properties/directive/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Fe.properties.constraints.properties.statuses.properties.suspended.properties.directive.type,parentSchema:Fe.properties.constraints.properties.statuses.properties.suspended.properties.directive,data:c};i===null?i=[d]:i.push(d),o++}if(!(c==="required"||c==="allowed"||c==="disallowed")){const d={instancePath:e+"/constraints/statuses/suspended/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/suspended/properties/directive/enum",keyword:"enum",params:{allowedValues:Fe.properties.constraints.properties.statuses.properties.suspended.properties.directive.enum},message:"must be equal to one of the allowed values",schema:Fe.properties.constraints.properties.statuses.properties.suspended.properties.directive.enum,parentSchema:Fe.properties.constraints.properties.statuses.properties.suspended.properties.directive,data:c};i===null?i=[d]:i.push(d),o++}}}else{const c={instancePath:e+"/constraints/statuses/suspended",schemaPath:"#/properties/constraints/properties/statuses/properties/suspended/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Fe.properties.constraints.properties.statuses.properties.suspended.type,parentSchema:Fe.properties.constraints.properties.statuses.properties.suspended,data:l};i===null?i=[c]:i.push(c),o++}}if(u.revoked!==void 0){let l=u.revoked;if(l&&typeof l=="object"&&!Array.isArray(l)){if(l.directive!==void 0){let c=l.directive;if(typeof c!="string"){const d={instancePath:e+"/constraints/statuses/revoked/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/revoked/properties/directive/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Fe.properties.constraints.properties.statuses.properties.revoked.properties.directive.type,parentSchema:Fe.properties.constraints.properties.statuses.properties.revoked.properties.directive,data:c};i===null?i=[d]:i.push(d),o++}if(!(c==="required"||c==="allowed"||c==="disallowed")){const d={instancePath:e+"/constraints/statuses/revoked/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/revoked/properties/directive/enum",keyword:"enum",params:{allowedValues:Fe.properties.constraints.properties.statuses.properties.revoked.properties.directive.enum},message:"must be equal to one of the allowed values",schema:Fe.properties.constraints.properties.statuses.properties.revoked.properties.directive.enum,parentSchema:Fe.properties.constraints.properties.statuses.properties.revoked.properties.directive,data:c};i===null?i=[d]:i.push(d),o++}}}else{const c={instancePath:e+"/constraints/statuses/revoked",schemaPath:"#/properties/constraints/properties/statuses/properties/revoked/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Fe.properties.constraints.properties.statuses.properties.revoked.type,parentSchema:Fe.properties.constraints.properties.statuses.properties.revoked,data:l};i===null?i=[c]:i.push(c),o++}}}else{const l={instancePath:e+"/constraints/statuses",schemaPath:"#/properties/constraints/properties/statuses/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Fe.properties.constraints.properties.statuses.type,parentSchema:Fe.properties.constraints.properties.statuses,data:u};i===null?i=[l]:i.push(l),o++}}if(a.fields!==void 0){let u=a.fields;if(Array.isArray(u)){const l=u.length;for(let c=0;c<l;c++)R1(u[c],{instancePath:e+"/constraints/fields/"+c,parentData:u,parentDataProperty:c,rootData:s})||(i=i===null?R1.errors:i.concat(R1.errors),o=i.length)}else{const l={instancePath:e+"/constraints/fields",schemaPath:"#/properties/constraints/properties/fields/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Fe.properties.constraints.properties.fields.type,parentSchema:Fe.properties.constraints.properties.fields,data:u};i===null?i=[l]:i.push(l),o++}}if(a.subject_is_issuer!==void 0){let u=a.subject_is_issuer;if(typeof u!="string"){const l={instancePath:e+"/constraints/subject_is_issuer",schemaPath:"#/properties/constraints/properties/subject_is_issuer/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Fe.properties.constraints.properties.subject_is_issuer.type,parentSchema:Fe.properties.constraints.properties.subject_is_issuer,data:u};i===null?i=[l]:i.push(l),o++}if(!(u==="required"||u==="preferred")){const l={instancePath:e+"/constraints/subject_is_issuer",schemaPath:"#/properties/constraints/properties/subject_is_issuer/enum",keyword:"enum",params:{allowedValues:Fe.properties.constraints.properties.subject_is_issuer.enum},message:"must be equal to one of the allowed values",schema:Fe.properties.constraints.properties.subject_is_issuer.enum,parentSchema:Fe.properties.constraints.properties.subject_is_issuer,data:u};i===null?i=[l]:i.push(l),o++}}if(a.is_holder!==void 0){let u=a.is_holder;if(Array.isArray(u)){const l=u.length;for(let c=0;c<l;c++){let d=u[c];if(d&&typeof d=="object"&&!Array.isArray(d)){if(d.field_id===void 0){const h={instancePath:e+"/constraints/is_holder/"+c,schemaPath:"#/properties/constraints/properties/is_holder/items/required",keyword:"required",params:{missingProperty:"field_id"},message:"must have required property 'field_id'",schema:Fe.properties.constraints.properties.is_holder.items.required,parentSchema:Fe.properties.constraints.properties.is_holder.items,data:d};i===null?i=[h]:i.push(h),o++}if(d.directive===void 0){const h={instancePath:e+"/constraints/is_holder/"+c,schemaPath:"#/properties/constraints/properties/is_holder/items/required",keyword:"required",params:{missingProperty:"directive"},message:"must have required property 'directive'",schema:Fe.properties.constraints.properties.is_holder.items.required,parentSchema:Fe.properties.constraints.properties.is_holder.items,data:d};i===null?i=[h]:i.push(h),o++}for(const h in d)if(!(h==="field_id"||h==="directive")){const f={instancePath:e+"/constraints/is_holder/"+c,schemaPath:"#/properties/constraints/properties/is_holder/items/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:h},message:"must NOT have additional properties",schema:!1,parentSchema:Fe.properties.constraints.properties.is_holder.items,data:d};i===null?i=[f]:i.push(f),o++}if(d.field_id!==void 0){let h=d.field_id;if(Array.isArray(h)){const f=h.length;for(let p=0;p<f;p++){let m=h[p];if(typeof m!="string"){const E={instancePath:e+"/constraints/is_holder/"+c+"/field_id/"+p,schemaPath:"#/properties/constraints/properties/is_holder/items/properties/field_id/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Fe.properties.constraints.properties.is_holder.items.properties.field_id.items.type,parentSchema:Fe.properties.constraints.properties.is_holder.items.properties.field_id.items,data:m};i===null?i=[E]:i.push(E),o++}}}else{const f={instancePath:e+"/constraints/is_holder/"+c+"/field_id",schemaPath:"#/properties/constraints/properties/is_holder/items/properties/field_id/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Fe.properties.constraints.properties.is_holder.items.properties.field_id.type,parentSchema:Fe.properties.constraints.properties.is_holder.items.properties.field_id,data:h};i===null?i=[f]:i.push(f),o++}}if(d.directive!==void 0){let h=d.directive;if(typeof h!="string"){const f={instancePath:e+"/constraints/is_holder/"+c+"/directive",schemaPath:"#/properties/constraints/properties/is_holder/items/properties/directive/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Fe.properties.constraints.properties.is_holder.items.properties.directive.type,parentSchema:Fe.properties.constraints.properties.is_holder.items.properties.directive,data:h};i===null?i=[f]:i.push(f),o++}if(!(h==="required"||h==="preferred")){const f={instancePath:e+"/constraints/is_holder/"+c+"/directive",schemaPath:"#/properties/constraints/properties/is_holder/items/properties/directive/enum",keyword:"enum",params:{allowedValues:Fe.properties.constraints.properties.is_holder.items.properties.directive.enum},message:"must be equal to one of the allowed values",schema:Fe.properties.constraints.properties.is_holder.items.properties.directive.enum,parentSchema:Fe.properties.constraints.properties.is_holder.items.properties.directive,data:h};i===null?i=[f]:i.push(f),o++}}}else{const h={instancePath:e+"/constraints/is_holder/"+c,schemaPath:"#/properties/constraints/properties/is_holder/items/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Fe.properties.constraints.properties.is_holder.items.type,parentSchema:Fe.properties.constraints.properties.is_holder.items,data:d};i===null?i=[h]:i.push(h),o++}}}else{const l={instancePath:e+"/constraints/is_holder",schemaPath:"#/properties/constraints/properties/is_holder/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Fe.properties.constraints.properties.is_holder.type,parentSchema:Fe.properties.constraints.properties.is_holder,data:u};i===null?i=[l]:i.push(l),o++}}if(a.same_subject!==void 0){let u=a.same_subject;if(Array.isArray(u)){const l=u.length;for(let c=0;c<l;c++){let d=u[c];if(d&&typeof d=="object"&&!Array.isArray(d)){if(d.field_id===void 0){const h={instancePath:e+"/constraints/same_subject/"+c,schemaPath:"#/properties/constraints/properties/same_subject/items/required",keyword:"required",params:{missingProperty:"field_id"},message:"must have required property 'field_id'",schema:Fe.properties.constraints.properties.same_subject.items.required,parentSchema:Fe.properties.constraints.properties.same_subject.items,data:d};i===null?i=[h]:i.push(h),o++}if(d.directive===void 0){const h={instancePath:e+"/constraints/same_subject/"+c,schemaPath:"#/properties/constraints/properties/same_subject/items/required",keyword:"required",params:{missingProperty:"directive"},message:"must have required property 'directive'",schema:Fe.properties.constraints.properties.same_subject.items.required,parentSchema:Fe.properties.constraints.properties.same_subject.items,data:d};i===null?i=[h]:i.push(h),o++}for(const h in d)if(!(h==="field_id"||h==="directive")){const f={instancePath:e+"/constraints/same_subject/"+c,schemaPath:"#/properties/constraints/properties/same_subject/items/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:h},message:"must NOT have additional properties",schema:!1,parentSchema:Fe.properties.constraints.properties.same_subject.items,data:d};i===null?i=[f]:i.push(f),o++}if(d.field_id!==void 0){let h=d.field_id;if(Array.isArray(h)){const f=h.length;for(let p=0;p<f;p++){let m=h[p];if(typeof m!="string"){const E={instancePath:e+"/constraints/same_subject/"+c+"/field_id/"+p,schemaPath:"#/properties/constraints/properties/same_subject/items/properties/field_id/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Fe.properties.constraints.properties.same_subject.items.properties.field_id.items.type,parentSchema:Fe.properties.constraints.properties.same_subject.items.properties.field_id.items,data:m};i===null?i=[E]:i.push(E),o++}}}else{const f={instancePath:e+"/constraints/same_subject/"+c+"/field_id",schemaPath:"#/properties/constraints/properties/same_subject/items/properties/field_id/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Fe.properties.constraints.properties.same_subject.items.properties.field_id.type,parentSchema:Fe.properties.constraints.properties.same_subject.items.properties.field_id,data:h};i===null?i=[f]:i.push(f),o++}}if(d.directive!==void 0){let h=d.directive;if(typeof h!="string"){const f={instancePath:e+"/constraints/same_subject/"+c+"/directive",schemaPath:"#/properties/constraints/properties/same_subject/items/properties/directive/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Fe.properties.constraints.properties.same_subject.items.properties.directive.type,parentSchema:Fe.properties.constraints.properties.same_subject.items.properties.directive,data:h};i===null?i=[f]:i.push(f),o++}if(!(h==="required"||h==="preferred")){const f={instancePath:e+"/constraints/same_subject/"+c+"/directive",schemaPath:"#/properties/constraints/properties/same_subject/items/properties/directive/enum",keyword:"enum",params:{allowedValues:Fe.properties.constraints.properties.same_subject.items.properties.directive.enum},message:"must be equal to one of the allowed values",schema:Fe.properties.constraints.properties.same_subject.items.properties.directive.enum,parentSchema:Fe.properties.constraints.properties.same_subject.items.properties.directive,data:h};i===null?i=[f]:i.push(f),o++}}}else{const h={instancePath:e+"/constraints/same_subject/"+c,schemaPath:"#/properties/constraints/properties/same_subject/items/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Fe.properties.constraints.properties.same_subject.items.type,parentSchema:Fe.properties.constraints.properties.same_subject.items,data:d};i===null?i=[h]:i.push(h),o++}}}else{const l={instancePath:e+"/constraints/same_subject",schemaPath:"#/properties/constraints/properties/same_subject/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Fe.properties.constraints.properties.same_subject.type,parentSchema:Fe.properties.constraints.properties.same_subject,data:u};i===null?i=[l]:i.push(l),o++}}}else{const u={instancePath:e+"/constraints",schemaPath:"#/properties/constraints/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Fe.properties.constraints.type,parentSchema:Fe.properties.constraints,data:a};i===null?i=[u]:i.push(u),o++}}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Fe.type,parentSchema:Fe,data:t};i===null?i=[a]:i.push(a),o++}return N1.errors=i,o===0}function ek(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.presentation_definition!==void 0){let a=t.presentation_definition;if(a&&typeof a=="object"&&!Array.isArray(a)){if(a.id===void 0){const u={instancePath:e+"/presentation_definition",schemaPath:"#/properties/presentation_definition/required",keyword:"required",params:{missingProperty:"id"},message:"must have required property 'id'",schema:_n.properties.presentation_definition.required,parentSchema:_n.properties.presentation_definition,data:a};i===null?i=[u]:i.push(u),o++}if(a.input_descriptors===void 0){const u={instancePath:e+"/presentation_definition",schemaPath:"#/properties/presentation_definition/required",keyword:"required",params:{missingProperty:"input_descriptors"},message:"must have required property 'input_descriptors'",schema:_n.properties.presentation_definition.required,parentSchema:_n.properties.presentation_definition,data:a};i===null?i=[u]:i.push(u),o++}for(const u in a)if(!(u==="id"||u==="name"||u==="purpose"||u==="format"||u==="frame"||u==="submission_requirements"||u==="input_descriptors")){const l={instancePath:e+"/presentation_definition",schemaPath:"#/properties/presentation_definition/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:u},message:"must NOT have additional properties",schema:!1,parentSchema:_n.properties.presentation_definition,data:a};i===null?i=[l]:i.push(l),o++}if(a.id!==void 0){let u=a.id;if(typeof u!="string"){const l={instancePath:e+"/presentation_definition/id",schemaPath:"#/properties/presentation_definition/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string",schema:_n.properties.presentation_definition.properties.id.type,parentSchema:_n.properties.presentation_definition.properties.id,data:u};i===null?i=[l]:i.push(l),o++}}if(a.name!==void 0){let u=a.name;if(typeof u!="string"){const l={instancePath:e+"/presentation_definition/name",schemaPath:"#/properties/presentation_definition/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string",schema:_n.properties.presentation_definition.properties.name.type,parentSchema:_n.properties.presentation_definition.properties.name,data:u};i===null?i=[l]:i.push(l),o++}}if(a.purpose!==void 0){let u=a.purpose;if(typeof u!="string"){const l={instancePath:e+"/presentation_definition/purpose",schemaPath:"#/properties/presentation_definition/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:_n.properties.presentation_definition.properties.purpose.type,parentSchema:_n.properties.presentation_definition.properties.purpose,data:u};i===null?i=[l]:i.push(l),o++}}if(a.format!==void 0&&(ap(a.format,{instancePath:e+"/presentation_definition/format",parentData:a,parentDataProperty:"format",rootData:s})||(i=i===null?ap.errors:i.concat(ap.errors),o=i.length)),a.frame!==void 0){let u=a.frame;if(!(u&&typeof u=="object"&&!Array.isArray(u))){const l={instancePath:e+"/presentation_definition/frame",schemaPath:"#/properties/presentation_definition/properties/frame/type",keyword:"type",params:{type:"object"},message:"must be object",schema:_n.properties.presentation_definition.properties.frame.type,parentSchema:_n.properties.presentation_definition.properties.frame,data:u};i===null?i=[l]:i.push(l),o++}}if(a.submission_requirements!==void 0){let u=a.submission_requirements;if(Array.isArray(u)){const l=u.length;for(let c=0;c<l;c++)ov(u[c],{instancePath:e+"/presentation_definition/submission_requirements/"+c,parentData:u,parentDataProperty:c,rootData:s})||(i=i===null?ov.errors:i.concat(ov.errors),o=i.length)}else{const l={instancePath:e+"/presentation_definition/submission_requirements",schemaPath:"#/properties/presentation_definition/properties/submission_requirements/type",keyword:"type",params:{type:"array"},message:"must be array",schema:_n.properties.presentation_definition.properties.submission_requirements.type,parentSchema:_n.properties.presentation_definition.properties.submission_requirements,data:u};i===null?i=[l]:i.push(l),o++}}if(a.input_descriptors!==void 0){let u=a.input_descriptors;if(Array.isArray(u)){const l=u.length;for(let c=0;c<l;c++)N1(u[c],{instancePath:e+"/presentation_definition/input_descriptors/"+c,parentData:u,parentDataProperty:c,rootData:s})||(i=i===null?N1.errors:i.concat(N1.errors),o=i.length)}else{const l={instancePath:e+"/presentation_definition/input_descriptors",schemaPath:"#/properties/presentation_definition/properties/input_descriptors/type",keyword:"type",params:{type:"array"},message:"must be array",schema:_n.properties.presentation_definition.properties.input_descriptors.type,parentSchema:_n.properties.presentation_definition.properties.input_descriptors,data:u};i===null?i=[l]:i.push(l),o++}}}else{const u={instancePath:e+"/presentation_definition",schemaPath:"#/properties/presentation_definition/type",keyword:"type",params:{type:"object"},message:"must be object",schema:_n.properties.presentation_definition.type,parentSchema:_n.properties.presentation_definition,data:a};i===null?i=[u]:i.push(u),o++}}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:_n.type,parentSchema:_n,data:t};i===null?i=[a]:i.push(a),o++}return ek.errors=i,o===0}var rge=QI.exports;const uV=nc(rge);function nge(t){return(Array.isArray(t.credentialSubject)?t.credentialSubject:[t.credentialSubject]).filter(r=>!!r.id).map(r=>r.id)}function ige(t){return so.isString(t.issuer)?t.issuer:t.issuer.id}function pP(t){const e=JSON.parse(JSON.stringify(t));ia.changePropertyNameRecursively(e,"_const","const"),ia.changePropertyNameRecursively(e,"_enum","enum");const r={presentation_definition:e};let n=uV(r);return n?{version:Ma.v2}:(n=oV(r),n?{version:Ma.v1}:{error:"This is not a valid PresentationDefinition"})}function LE(t,e){let r=(t==null?void 0:t.map(n=>n.toLowerCase()).map(n=>n.startsWith("did:")?n:`did:${n}`))??[];return r.includes("did")?[]:r}function sge(t,e){const r=LE(e);return r.length===0||r.some(n=>t.toLowerCase().startsWith(n))}function oge(t,e){const r=LE(e);return r.length===0?t:r.flatMap(n=>t.filter(s=>s.toLowerCase().startsWith(n)))}class ac{constructor(e){Se(this,"_client");Se(this,"nextHandler");this._client=e}setNext(e){return this.nextHandler=e,e}getNext(){return this.nextHandler}hasNext(){return this.nextHandler!=null}get client(){return this._client}get wrappedVcs(){return this._client.wrappedVcs}set wrappedVcs(e){this._client.wrappedVcs=e}get presentationSubmission(){return this._client.presentationSubmission}set presentationSubmission(e){this._client.presentationSubmission=e}getResults(){return this._client.results}updatePresentationSubmission(e){this._client.assertPresentationSubmission(),this.presentationSubmission.descriptor_map.forEach((r,n,s)=>{let i;this.getResults().filter(a=>a.status===Be.ERROR&&a.evaluator===this.getName()).find(a=>(i=vr.query(e,a.input_descriptor_path)[0],a.verifiable_credential_path===r.path&&(i==null?void 0:i.id)===r.id))&&delete s[n]})}removeDuplicate(e){return e.reduce((r,n)=>r.find(i=>i.input_descriptor_path===n.input_descriptor_path&&i.verifiable_credential_path===n.verifiable_credential_path)?r:r.concat([n]),[])}}var mP={exports:{}},cV={},ja={},Ay={},Gw={},zt={},Zv={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.regexpCode=t.getEsmExportName=t.getProperty=t.safeStringify=t.stringify=t.strConcat=t.addCodeArg=t.str=t._=t.nil=t._Code=t.Name=t.IDENTIFIER=t._CodeOrName=void 0;class e{}t._CodeOrName=e,t.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class r extends e{constructor(_){if(super(),!t.IDENTIFIER.test(_))throw new Error("CodeGen: name must be a valid identifier");this.str=_}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}t.Name=r;class n extends e{constructor(_){super(),this._items=typeof _=="string"?[_]:_}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const _=this._items[0];return _===""||_==='""'}get str(){var _;return(_=this._str)!==null&&_!==void 0?_:this._str=this._items.reduce((g,v)=>`${g}${v}`,"")}get names(){var _;return(_=this._names)!==null&&_!==void 0?_:this._names=this._items.reduce((g,v)=>(v instanceof r&&(g[v.str]=(g[v.str]||0)+1),g),{})}}t._Code=n,t.nil=new n("");function s(A,..._){const g=[A[0]];let v=0;for(;v<_.length;)a(g,_[v]),g.push(A[++v]);return new n(g)}t._=s;const i=new n("+");function o(A,..._){const g=[f(A[0])];let v=0;for(;v<_.length;)g.push(i),a(g,_[v]),g.push(i,f(A[++v]));return u(g),new n(g)}t.str=o;function a(A,_){_ instanceof n?A.push(..._._items):_ instanceof r?A.push(_):A.push(d(_))}t.addCodeArg=a;function u(A){let _=1;for(;_<A.length-1;){if(A[_]===i){const g=l(A[_-1],A[_+1]);if(g!==void 0){A.splice(_-1,3,g);continue}A[_++]="+"}_++}}function l(A,_){if(_==='""')return A;if(A==='""')return _;if(typeof A=="string")return _ instanceof r||A[A.length-1]!=='"'?void 0:typeof _!="string"?`${A.slice(0,-1)}${_}"`:_[0]==='"'?A.slice(0,-1)+_.slice(1):void 0;if(typeof _=="string"&&_[0]==='"'&&!(A instanceof r))return`"${A}${_.slice(1)}`}function c(A,_){return _.emptyStr()?A:A.emptyStr()?_:o`${A}${_}`}t.strConcat=c;function d(A){return typeof A=="number"||typeof A=="boolean"||A===null?A:f(Array.isArray(A)?A.join(","):A)}function h(A){return new n(f(A))}t.stringify=h;function f(A){return JSON.stringify(A).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}t.safeStringify=f;function p(A){return typeof A=="string"&&t.IDENTIFIER.test(A)?new n(`.${A}`):s`[${A}]`}t.getProperty=p;function m(A){if(typeof A=="string"&&t.IDENTIFIER.test(A))return new n(`${A}`);throw new Error(`CodeGen: invalid export name: ${A}, use explicit $id name mapping`)}t.getEsmExportName=m;function E(A){return new n(A.toString())}t.regexpCode=E})(Zv);var yP={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ValueScope=t.ValueScopeName=t.Scope=t.varKinds=t.UsedValueState=void 0;const e=Zv;class r extends Error{constructor(l){super(`CodeGen: "code" for ${l} not defined`),this.value=l.value}}var n;(function(u){u[u.Started=0]="Started",u[u.Completed=1]="Completed"})(n||(t.UsedValueState=n={})),t.varKinds={const:new e.Name("const"),let:new e.Name("let"),var:new e.Name("var")};class s{constructor({prefixes:l,parent:c}={}){this._names={},this._prefixes=l,this._parent=c}toName(l){return l instanceof e.Name?l:this.name(l)}name(l){return new e.Name(this._newName(l))}_newName(l){const c=this._names[l]||this._nameGroup(l);return`${l}${c.index++}`}_nameGroup(l){var c,d;if(!((d=(c=this._parent)===null||c===void 0?void 0:c._prefixes)===null||d===void 0)&&d.has(l)||this._prefixes&&!this._prefixes.has(l))throw new Error(`CodeGen: prefix "${l}" is not allowed in this scope`);return this._names[l]={prefix:l,index:0}}}t.Scope=s;class i extends e.Name{constructor(l,c){super(c),this.prefix=l}setValue(l,{property:c,itemIndex:d}){this.value=l,this.scopePath=(0,e._)`.${new e.Name(c)}[${d}]`}}t.ValueScopeName=i;const o=(0,e._)`\n`;class a extends s{constructor(l){super(l),this._values={},this._scope=l.scope,this.opts={...l,_n:l.lines?o:e.nil}}get(){return this._scope}name(l){return new i(l,this._newName(l))}value(l,c){var d;if(c.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const h=this.toName(l),{prefix:f}=h,p=(d=c.key)!==null&&d!==void 0?d:c.ref;let m=this._values[f];if(m){const _=m.get(p);if(_)return _}else m=this._values[f]=new Map;m.set(p,h);const E=this._scope[f]||(this._scope[f]=[]),A=E.length;return E[A]=c.ref,h.setValue(c,{property:f,itemIndex:A}),h}getValue(l,c){const d=this._values[l];if(d)return d.get(c)}scopeRefs(l,c=this._values){return this._reduceValues(c,d=>{if(d.scopePath===void 0)throw new Error(`CodeGen: name "${d}" has no value`);return(0,e._)`${l}${d.scopePath}`})}scopeCode(l=this._values,c,d){return this._reduceValues(l,h=>{if(h.value===void 0)throw new Error(`CodeGen: name "${h}" has no value`);return h.value.code},c,d)}_reduceValues(l,c,d={},h){let f=e.nil;for(const p in l){const m=l[p];if(!m)continue;const E=d[p]=d[p]||new Map;m.forEach(A=>{if(E.has(A))return;E.set(A,n.Started);let _=c(A);if(_){const g=this.opts.es5?t.varKinds.var:t.varKinds.const;f=(0,e._)`${f}${g} ${A} = ${_};${this.opts._n}`}else if(_=h==null?void 0:h(A))f=(0,e._)`${f}${_}${this.opts._n}`;else throw new r(A);E.set(A,n.Completed)})}return f}}t.ValueScope=a})(yP);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.or=t.and=t.not=t.CodeGen=t.operators=t.varKinds=t.ValueScopeName=t.ValueScope=t.Scope=t.Name=t.regexpCode=t.stringify=t.getProperty=t.nil=t.strConcat=t.str=t._=void 0;const e=Zv,r=yP;var n=Zv;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(t,"strConcat",{enumerable:!0,get:function(){return n.strConcat}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(t,"getProperty",{enumerable:!0,get:function(){return n.getProperty}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(t,"regexpCode",{enumerable:!0,get:function(){return n.regexpCode}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return n.Name}});var s=yP;Object.defineProperty(t,"Scope",{enumerable:!0,get:function(){return s.Scope}}),Object.defineProperty(t,"ValueScope",{enumerable:!0,get:function(){return s.ValueScope}}),Object.defineProperty(t,"ValueScopeName",{enumerable:!0,get:function(){return s.ValueScopeName}}),Object.defineProperty(t,"varKinds",{enumerable:!0,get:function(){return s.varKinds}}),t.operators={GT:new e._Code(">"),GTE:new e._Code(">="),LT:new e._Code("<"),LTE:new e._Code("<="),EQ:new e._Code("==="),NEQ:new e._Code("!=="),NOT:new e._Code("!"),OR:new e._Code("||"),AND:new e._Code("&&"),ADD:new e._Code("+")};class i{optimizeNodes(){return this}optimizeNames($,F){return this}}class o extends i{constructor($,F,ee){super(),this.varKind=$,this.name=F,this.rhs=ee}render({es5:$,_n:F}){const ee=$?r.varKinds.var:this.varKind,ne=this.rhs===void 0?"":` = ${this.rhs}`;return`${ee} ${this.name}${ne};`+F}optimizeNames($,F){if($[this.name.str])return this.rhs&&(this.rhs=K(this.rhs,$,F)),this}get names(){return this.rhs instanceof e._CodeOrName?this.rhs.names:{}}}class a extends i{constructor($,F,ee){super(),this.lhs=$,this.rhs=F,this.sideEffects=ee}render({_n:$}){return`${this.lhs} = ${this.rhs};`+$}optimizeNames($,F){if(!(this.lhs instanceof e.Name&&!$[this.lhs.str]&&!this.sideEffects))return this.rhs=K(this.rhs,$,F),this}get names(){const $=this.lhs instanceof e.Name?{}:{...this.lhs.names};return k($,this.rhs)}}class u extends a{constructor($,F,ee,ne){super($,ee,ne),this.op=F}render({_n:$}){return`${this.lhs} ${this.op}= ${this.rhs};`+$}}class l extends i{constructor($){super(),this.label=$,this.names={}}render({_n:$}){return`${this.label}:`+$}}class c extends i{constructor($){super(),this.label=$,this.names={}}render({_n:$}){return`break${this.label?` ${this.label}`:""};`+$}}class d extends i{constructor($){super(),this.error=$}render({_n:$}){return`throw ${this.error};`+$}get names(){return this.error.names}}class h extends i{constructor($){super(),this.code=$}render({_n:$}){return`${this.code};`+$}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames($,F){return this.code=K(this.code,$,F),this}get names(){return this.code instanceof e._CodeOrName?this.code.names:{}}}class f extends i{constructor($=[]){super(),this.nodes=$}render($){return this.nodes.reduce((F,ee)=>F+ee.render($),"")}optimizeNodes(){const{nodes:$}=this;let F=$.length;for(;F--;){const ee=$[F].optimizeNodes();Array.isArray(ee)?$.splice(F,1,...ee):ee?$[F]=ee:$.splice(F,1)}return $.length>0?this:void 0}optimizeNames($,F){const{nodes:ee}=this;let ne=ee.length;for(;ne--;){const le=ee[ne];le.optimizeNames($,F)||(L($,le.names),ee.splice(ne,1))}return ee.length>0?this:void 0}get names(){return this.nodes.reduce(($,F)=>C($,F.names),{})}}class p extends f{render($){return"{"+$._n+super.render($)+"}"+$._n}}class m extends f{}class E extends p{}E.kind="else";class A extends p{constructor($,F){super(F),this.condition=$}render($){let F=`if(${this.condition})`+super.render($);return this.else&&(F+="else "+this.else.render($)),F}optimizeNodes(){super.optimizeNodes();const $=this.condition;if($===!0)return this.nodes;let F=this.else;if(F){const ee=F.optimizeNodes();F=this.else=Array.isArray(ee)?new E(ee):ee}if(F)return $===!1?F instanceof A?F:F.nodes:this.nodes.length?this:new A(q($),F instanceof A?[F]:F.nodes);if(!($===!1||!this.nodes.length))return this}optimizeNames($,F){var ee;if(this.else=(ee=this.else)===null||ee===void 0?void 0:ee.optimizeNames($,F),!!(super.optimizeNames($,F)||this.else))return this.condition=K(this.condition,$,F),this}get names(){const $=super.names;return k($,this.condition),this.else&&C($,this.else.names),$}}A.kind="if";class _ extends p{}_.kind="for";class g extends _{constructor($){super(),this.iteration=$}render($){return`for(${this.iteration})`+super.render($)}optimizeNames($,F){if(super.optimizeNames($,F))return this.iteration=K(this.iteration,$,F),this}get names(){return C(super.names,this.iteration.names)}}class v extends _{constructor($,F,ee,ne){super(),this.varKind=$,this.name=F,this.from=ee,this.to=ne}render($){const F=$.es5?r.varKinds.var:this.varKind,{name:ee,from:ne,to:le}=this;return`for(${F} ${ee}=${ne}; ${ee}<${le}; ${ee}++)`+super.render($)}get names(){const $=k(super.names,this.from);return k($,this.to)}}class S extends _{constructor($,F,ee,ne){super(),this.loop=$,this.varKind=F,this.name=ee,this.iterable=ne}render($){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render($)}optimizeNames($,F){if(super.optimizeNames($,F))return this.iterable=K(this.iterable,$,F),this}get names(){return C(super.names,this.iterable.names)}}class x extends p{constructor($,F,ee){super(),this.name=$,this.args=F,this.async=ee}render($){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render($)}}x.kind="func";class D extends f{render($){return"return "+super.render($)}}D.kind="return";class w extends p{render($){let F="try"+super.render($);return this.catch&&(F+=this.catch.render($)),this.finally&&(F+=this.finally.render($)),F}optimizeNodes(){var $,F;return super.optimizeNodes(),($=this.catch)===null||$===void 0||$.optimizeNodes(),(F=this.finally)===null||F===void 0||F.optimizeNodes(),this}optimizeNames($,F){var ee,ne;return super.optimizeNames($,F),(ee=this.catch)===null||ee===void 0||ee.optimizeNames($,F),(ne=this.finally)===null||ne===void 0||ne.optimizeNames($,F),this}get names(){const $=super.names;return this.catch&&C($,this.catch.names),this.finally&&C($,this.finally.names),$}}class b extends p{constructor($){super(),this.error=$}render($){return`catch(${this.error})`+super.render($)}}b.kind="catch";class T extends p{render($){return"finally"+super.render($)}}T.kind="finally";class P{constructor($,F={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...F,_n:F.lines?`
`:""},this._extScope=$,this._scope=new r.Scope({parent:$}),this._nodes=[new m]}toString(){return this._root.render(this.opts)}name($){return this._scope.name($)}scopeName($){return this._extScope.name($)}scopeValue($,F){const ee=this._extScope.value($,F);return(this._values[ee.prefix]||(this._values[ee.prefix]=new Set)).add(ee),ee}getScopeValue($,F){return this._extScope.getValue($,F)}scopeRefs($){return this._extScope.scopeRefs($,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def($,F,ee,ne){const le=this._scope.toName(F);return ee!==void 0&&ne&&(this._constants[le.str]=ee),this._leafNode(new o($,le,ee)),le}const($,F,ee){return this._def(r.varKinds.const,$,F,ee)}let($,F,ee){return this._def(r.varKinds.let,$,F,ee)}var($,F,ee){return this._def(r.varKinds.var,$,F,ee)}assign($,F,ee){return this._leafNode(new a($,F,ee))}add($,F){return this._leafNode(new u($,t.operators.ADD,F))}code($){return typeof $=="function"?$():$!==e.nil&&this._leafNode(new h($)),this}object(...$){const F=["{"];for(const[ee,ne]of $)F.length>1&&F.push(","),F.push(ee),(ee!==ne||this.opts.es5)&&(F.push(":"),(0,e.addCodeArg)(F,ne));return F.push("}"),new e._Code(F)}if($,F,ee){if(this._blockNode(new A($)),F&&ee)this.code(F).else().code(ee).endIf();else if(F)this.code(F).endIf();else if(ee)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf($){return this._elseNode(new A($))}else(){return this._elseNode(new E)}endIf(){return this._endBlockNode(A,E)}_for($,F){return this._blockNode($),F&&this.code(F).endFor(),this}for($,F){return this._for(new g($),F)}forRange($,F,ee,ne,le=this.opts.es5?r.varKinds.var:r.varKinds.let){const me=this._scope.toName($);return this._for(new v(le,me,F,ee),()=>ne(me))}forOf($,F,ee,ne=r.varKinds.const){const le=this._scope.toName($);if(this.opts.es5){const me=F instanceof e.Name?F:this.var("_arr",F);return this.forRange("_i",0,(0,e._)`${me}.length`,ve=>{this.var(le,(0,e._)`${me}[${ve}]`),ee(le)})}return this._for(new S("of",ne,le,F),()=>ee(le))}forIn($,F,ee,ne=this.opts.es5?r.varKinds.var:r.varKinds.const){if(this.opts.ownProperties)return this.forOf($,(0,e._)`Object.keys(${F})`,ee);const le=this._scope.toName($);return this._for(new S("in",ne,le,F),()=>ee(le))}endFor(){return this._endBlockNode(_)}label($){return this._leafNode(new l($))}break($){return this._leafNode(new c($))}return($){const F=new D;if(this._blockNode(F),this.code($),F.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(D)}try($,F,ee){if(!F&&!ee)throw new Error('CodeGen: "try" without "catch" and "finally"');const ne=new w;if(this._blockNode(ne),this.code($),F){const le=this.name("e");this._currNode=ne.catch=new b(le),F(le)}return ee&&(this._currNode=ne.finally=new T,this.code(ee)),this._endBlockNode(b,T)}throw($){return this._leafNode(new d($))}block($,F){return this._blockStarts.push(this._nodes.length),$&&this.code($).endBlock(F),this}endBlock($){const F=this._blockStarts.pop();if(F===void 0)throw new Error("CodeGen: not in self-balancing block");const ee=this._nodes.length-F;if(ee<0||$!==void 0&&ee!==$)throw new Error(`CodeGen: wrong number of nodes: ${ee} vs ${$} expected`);return this._nodes.length=F,this}func($,F=e.nil,ee,ne){return this._blockNode(new x($,F,ee)),ne&&this.code(ne).endFunc(),this}endFunc(){return this._endBlockNode(x)}optimize($=1){for(;$-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode($){return this._currNode.nodes.push($),this}_blockNode($){this._currNode.nodes.push($),this._nodes.push($)}_endBlockNode($,F){const ee=this._currNode;if(ee instanceof $||F&&ee instanceof F)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${F?`${$.kind}/${F.kind}`:$.kind}"`)}_elseNode($){const F=this._currNode;if(!(F instanceof A))throw new Error('CodeGen: "else" without "if"');return this._currNode=F.else=$,this}get _root(){return this._nodes[0]}get _currNode(){const $=this._nodes;return $[$.length-1]}set _currNode($){const F=this._nodes;F[F.length-1]=$}}t.CodeGen=P;function C(z,$){for(const F in $)z[F]=(z[F]||0)+($[F]||0);return z}function k(z,$){return $ instanceof e._CodeOrName?C(z,$.names):z}function K(z,$,F){if(z instanceof e.Name)return ee(z);if(!ne(z))return z;return new e._Code(z._items.reduce((le,me)=>(me instanceof e.Name&&(me=ee(me)),me instanceof e._Code?le.push(...me._items):le.push(me),le),[]));function ee(le){const me=F[le.str];return me===void 0||$[le.str]!==1?le:(delete $[le.str],me)}function ne(le){return le instanceof e._Code&&le._items.some(me=>me instanceof e.Name&&$[me.str]===1&&F[me.str]!==void 0)}}function L(z,$){for(const F in $)z[F]=(z[F]||0)-($[F]||0)}function q(z){return typeof z=="boolean"||typeof z=="number"||z===null?!z:(0,e._)`!${te(z)}`}t.not=q;const se=B(t.operators.AND);function X(...z){return z.reduce(se)}t.and=X;const re=B(t.operators.OR);function W(...z){return z.reduce(re)}t.or=W;function B(z){return($,F)=>$===e.nil?F:F===e.nil?$:(0,e._)`${te($)} ${z} ${te(F)}`}function te(z){return z instanceof e.Name?z:(0,e._)`(${z})`}})(zt);var Ge={};Object.defineProperty(Ge,"__esModule",{value:!0});Ge.checkStrictMode=Ge.getErrorPath=Ge.Type=Ge.useFunc=Ge.setEvaluated=Ge.evaluatedPropsToName=Ge.mergeEvaluated=Ge.eachItem=Ge.unescapeJsonPointer=Ge.escapeJsonPointer=Ge.escapeFragment=Ge.unescapeFragment=Ge.schemaRefOrVal=Ge.schemaHasRulesButRef=Ge.schemaHasRules=Ge.checkUnknownRules=Ge.alwaysValidSchema=Ge.toHash=void 0;const Vr=zt,age=Zv;function uge(t){const e={};for(const r of t)e[r]=!0;return e}Ge.toHash=uge;function cge(t,e){return typeof e=="boolean"?e:Object.keys(e).length===0?!0:(lV(t,e),!dV(e,t.self.RULES.all))}Ge.alwaysValidSchema=cge;function lV(t,e=t.schema){const{opts:r,self:n}=t;if(!r.strictSchema||typeof e=="boolean")return;const s=n.RULES.keywords;for(const i in e)s[i]||pV(t,`unknown keyword: "${i}"`)}Ge.checkUnknownRules=lV;function dV(t,e){if(typeof t=="boolean")return!t;for(const r in t)if(e[r])return!0;return!1}Ge.schemaHasRules=dV;function lge(t,e){if(typeof t=="boolean")return!t;for(const r in t)if(r!=="$ref"&&e.all[r])return!0;return!1}Ge.schemaHasRulesButRef=lge;function dge({topSchemaRef:t,schemaPath:e},r,n,s){if(!s){if(typeof r=="number"||typeof r=="boolean")return r;if(typeof r=="string")return(0,Vr._)`${r}`}return(0,Vr._)`${t}${e}${(0,Vr.getProperty)(n)}`}Ge.schemaRefOrVal=dge;function fge(t){return fV(decodeURIComponent(t))}Ge.unescapeFragment=fge;function hge(t){return encodeURIComponent(tk(t))}Ge.escapeFragment=hge;function tk(t){return typeof t=="number"?`${t}`:t.replace(/~/g,"~0").replace(/\//g,"~1")}Ge.escapeJsonPointer=tk;function fV(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}Ge.unescapeJsonPointer=fV;function pge(t,e){if(Array.isArray(t))for(const r of t)e(r);else e(t)}Ge.eachItem=pge;function f6({mergeNames:t,mergeToName:e,mergeValues:r,resultToName:n}){return(s,i,o,a)=>{const u=o===void 0?i:o instanceof Vr.Name?(i instanceof Vr.Name?t(s,i,o):e(s,i,o),o):i instanceof Vr.Name?(e(s,o,i),i):r(i,o);return a===Vr.Name&&!(u instanceof Vr.Name)?n(s,u):u}}Ge.mergeEvaluated={props:f6({mergeNames:(t,e,r)=>t.if((0,Vr._)`${r} !== true && ${e} !== undefined`,()=>{t.if((0,Vr._)`${e} === true`,()=>t.assign(r,!0),()=>t.assign(r,(0,Vr._)`${r} || {}`).code((0,Vr._)`Object.assign(${r}, ${e})`))}),mergeToName:(t,e,r)=>t.if((0,Vr._)`${r} !== true`,()=>{e===!0?t.assign(r,!0):(t.assign(r,(0,Vr._)`${r} || {}`),rk(t,r,e))}),mergeValues:(t,e)=>t===!0?!0:{...t,...e},resultToName:hV}),items:f6({mergeNames:(t,e,r)=>t.if((0,Vr._)`${r} !== true && ${e} !== undefined`,()=>t.assign(r,(0,Vr._)`${e} === true ? true : ${r} > ${e} ? ${r} : ${e}`)),mergeToName:(t,e,r)=>t.if((0,Vr._)`${r} !== true`,()=>t.assign(r,e===!0?!0:(0,Vr._)`${r} > ${e} ? ${r} : ${e}`)),mergeValues:(t,e)=>t===!0?!0:Math.max(t,e),resultToName:(t,e)=>t.var("items",e)})};function hV(t,e){if(e===!0)return t.var("props",!0);const r=t.var("props",(0,Vr._)`{}`);return e!==void 0&&rk(t,r,e),r}Ge.evaluatedPropsToName=hV;function rk(t,e,r){Object.keys(r).forEach(n=>t.assign((0,Vr._)`${e}${(0,Vr.getProperty)(n)}`,!0))}Ge.setEvaluated=rk;const h6={};function mge(t,e){return t.scopeValue("func",{ref:e,code:h6[e.code]||(h6[e.code]=new age._Code(e.code))})}Ge.useFunc=mge;var gP;(function(t){t[t.Num=0]="Num",t[t.Str=1]="Str"})(gP||(Ge.Type=gP={}));function yge(t,e,r){if(t instanceof Vr.Name){const n=e===gP.Num;return r?n?(0,Vr._)`"[" + ${t} + "]"`:(0,Vr._)`"['" + ${t} + "']"`:n?(0,Vr._)`"/" + ${t}`:(0,Vr._)`"/" + ${t}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,Vr.getProperty)(t).toString():"/"+tk(t)}Ge.getErrorPath=yge;function pV(t,e,r=t.opts.strictSchema){if(r){if(e=`strict mode: ${e}`,r===!0)throw new Error(e);t.self.logger.warn(e)}}Ge.checkStrictMode=pV;var uc={};Object.defineProperty(uc,"__esModule",{value:!0});const qi=zt,gge={data:new qi.Name("data"),valCxt:new qi.Name("valCxt"),instancePath:new qi.Name("instancePath"),parentData:new qi.Name("parentData"),parentDataProperty:new qi.Name("parentDataProperty"),rootData:new qi.Name("rootData"),dynamicAnchors:new qi.Name("dynamicAnchors"),vErrors:new qi.Name("vErrors"),errors:new qi.Name("errors"),this:new qi.Name("this"),self:new qi.Name("self"),scope:new qi.Name("scope"),json:new qi.Name("json"),jsonPos:new qi.Name("jsonPos"),jsonLen:new qi.Name("jsonLen"),jsonPart:new qi.Name("jsonPart")};uc.default=gge;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.extendErrors=t.resetErrorsCount=t.reportExtraError=t.reportError=t.keyword$DataError=t.keywordError=void 0;const e=zt,r=Ge,n=uc;t.keywordError={message:({keyword:E})=>(0,e.str)`must pass "${E}" keyword validation`},t.keyword$DataError={message:({keyword:E,schemaType:A})=>A?(0,e.str)`"${E}" keyword must be ${A} ($data)`:(0,e.str)`"${E}" keyword is invalid ($data)`};function s(E,A=t.keywordError,_,g){const{it:v}=E,{gen:S,compositeRule:x,allErrors:D}=v,w=d(E,A,_);g??(x||D)?u(S,w):l(v,(0,e._)`[${w}]`)}t.reportError=s;function i(E,A=t.keywordError,_){const{it:g}=E,{gen:v,compositeRule:S,allErrors:x}=g,D=d(E,A,_);u(v,D),S||x||l(g,n.default.vErrors)}t.reportExtraError=i;function o(E,A){E.assign(n.default.errors,A),E.if((0,e._)`${n.default.vErrors} !== null`,()=>E.if(A,()=>E.assign((0,e._)`${n.default.vErrors}.length`,A),()=>E.assign(n.default.vErrors,null)))}t.resetErrorsCount=o;function a({gen:E,keyword:A,schemaValue:_,data:g,errsCount:v,it:S}){if(v===void 0)throw new Error("ajv implementation error");const x=E.name("err");E.forRange("i",v,n.default.errors,D=>{E.const(x,(0,e._)`${n.default.vErrors}[${D}]`),E.if((0,e._)`${x}.instancePath === undefined`,()=>E.assign((0,e._)`${x}.instancePath`,(0,e.strConcat)(n.default.instancePath,S.errorPath))),E.assign((0,e._)`${x}.schemaPath`,(0,e.str)`${S.errSchemaPath}/${A}`),S.opts.verbose&&(E.assign((0,e._)`${x}.schema`,_),E.assign((0,e._)`${x}.data`,g))})}t.extendErrors=a;function u(E,A){const _=E.const("err",A);E.if((0,e._)`${n.default.vErrors} === null`,()=>E.assign(n.default.vErrors,(0,e._)`[${_}]`),(0,e._)`${n.default.vErrors}.push(${_})`),E.code((0,e._)`${n.default.errors}++`)}function l(E,A){const{gen:_,validateName:g,schemaEnv:v}=E;v.$async?_.throw((0,e._)`new ${E.ValidationError}(${A})`):(_.assign((0,e._)`${g}.errors`,A),_.return(!1))}const c={keyword:new e.Name("keyword"),schemaPath:new e.Name("schemaPath"),params:new e.Name("params"),propertyName:new e.Name("propertyName"),message:new e.Name("message"),schema:new e.Name("schema"),parentSchema:new e.Name("parentSchema")};function d(E,A,_){const{createErrors:g}=E.it;return g===!1?(0,e._)`{}`:h(E,A,_)}function h(E,A,_={}){const{gen:g,it:v}=E,S=[f(v,_),p(E,_)];return m(E,A,S),g.object(...S)}function f({errorPath:E},{instancePath:A}){const _=A?(0,e.str)`${E}${(0,r.getErrorPath)(A,r.Type.Str)}`:E;return[n.default.instancePath,(0,e.strConcat)(n.default.instancePath,_)]}function p({keyword:E,it:{errSchemaPath:A}},{schemaPath:_,parentSchema:g}){let v=g?A:(0,e.str)`${A}/${E}`;return _&&(v=(0,e.str)`${v}${(0,r.getErrorPath)(_,r.Type.Str)}`),[c.schemaPath,v]}function m(E,{params:A,message:_},g){const{keyword:v,data:S,schemaValue:x,it:D}=E,{opts:w,propertyName:b,topSchemaRef:T,schemaPath:P}=D;g.push([c.keyword,v],[c.params,typeof A=="function"?A(E):A||(0,e._)`{}`]),w.messages&&g.push([c.message,typeof _=="function"?_(E):_]),w.verbose&&g.push([c.schema,x],[c.parentSchema,(0,e._)`${T}${P}`],[n.default.data,S]),b&&g.push([c.propertyName,b])}})(Gw);Object.defineProperty(Ay,"__esModule",{value:!0});Ay.boolOrEmptySchema=Ay.topBoolOrEmptySchema=void 0;const vge=Gw,wge=zt,_ge=uc,bge={message:"boolean schema is false"};function Ege(t){const{gen:e,schema:r,validateName:n}=t;r===!1?mV(t,!1):typeof r=="object"&&r.$async===!0?e.return(_ge.default.data):(e.assign((0,wge._)`${n}.errors`,null),e.return(!0))}Ay.topBoolOrEmptySchema=Ege;function Age(t,e){const{gen:r,schema:n}=t;n===!1?(r.var(e,!1),mV(t)):r.var(e,!0)}Ay.boolOrEmptySchema=Age;function mV(t,e){const{gen:r,data:n}=t,s={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,vge.reportError)(s,bge,void 0,e)}var Vn={},_p={};Object.defineProperty(_p,"__esModule",{value:!0});_p.getRules=_p.isJSONType=void 0;const Sge=["string","number","integer","boolean","null","object","array"],Tge=new Set(Sge);function Dge(t){return typeof t=="string"&&Tge.has(t)}_p.isJSONType=Dge;function xge(){const t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...t,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}_p.getRules=xge;var al={};Object.defineProperty(al,"__esModule",{value:!0});al.shouldUseRule=al.shouldUseGroup=al.schemaHasRulesForType=void 0;function Pge({schema:t,self:e},r){const n=e.RULES.types[r];return n&&n!==!0&&yV(t,n)}al.schemaHasRulesForType=Pge;function yV(t,e){return e.rules.some(r=>gV(t,r))}al.shouldUseGroup=yV;function gV(t,e){var r;return t[e.keyword]!==void 0||((r=e.definition.implements)===null||r===void 0?void 0:r.some(n=>t[n]!==void 0))}al.shouldUseRule=gV;Object.defineProperty(Vn,"__esModule",{value:!0});Vn.reportTypeError=Vn.checkDataTypes=Vn.checkDataType=Vn.coerceAndCheckDataType=Vn.getJSONTypes=Vn.getSchemaTypes=Vn.DataType=void 0;const Cge=_p,Ige=al,kge=Gw,Lt=zt,vV=Ge;var Qm;(function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong"})(Qm||(Vn.DataType=Qm={}));function $ge(t){const e=wV(t.type);if(e.includes("null")){if(t.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&t.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');t.nullable===!0&&e.push("null")}return e}Vn.getSchemaTypes=$ge;function wV(t){const e=Array.isArray(t)?t:t?[t]:[];if(e.every(Cge.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}Vn.getJSONTypes=wV;function Oge(t,e){const{gen:r,data:n,opts:s}=t,i=Rge(e,s.coerceTypes),o=e.length>0&&!(i.length===0&&e.length===1&&(0,Ige.schemaHasRulesForType)(t,e[0]));if(o){const a=nk(e,n,s.strictNumbers,Qm.Wrong);r.if(a,()=>{i.length?Nge(t,e,i):ik(t)})}return o}Vn.coerceAndCheckDataType=Oge;const _V=new Set(["string","number","integer","boolean","null"]);function Rge(t,e){return e?t.filter(r=>_V.has(r)||e==="array"&&r==="array"):[]}function Nge(t,e,r){const{gen:n,data:s,opts:i}=t,o=n.let("dataType",(0,Lt._)`typeof ${s}`),a=n.let("coerced",(0,Lt._)`undefined`);i.coerceTypes==="array"&&n.if((0,Lt._)`${o} == 'object' && Array.isArray(${s}) && ${s}.length == 1`,()=>n.assign(s,(0,Lt._)`${s}[0]`).assign(o,(0,Lt._)`typeof ${s}`).if(nk(e,s,i.strictNumbers),()=>n.assign(a,s))),n.if((0,Lt._)`${a} !== undefined`);for(const l of r)(_V.has(l)||l==="array"&&i.coerceTypes==="array")&&u(l);n.else(),ik(t),n.endIf(),n.if((0,Lt._)`${a} !== undefined`,()=>{n.assign(s,a),Bge(t,a)});function u(l){switch(l){case"string":n.elseIf((0,Lt._)`${o} == "number" || ${o} == "boolean"`).assign(a,(0,Lt._)`"" + ${s}`).elseIf((0,Lt._)`${s} === null`).assign(a,(0,Lt._)`""`);return;case"number":n.elseIf((0,Lt._)`${o} == "boolean" || ${s} === null
              || (${o} == "string" && ${s} && ${s} == +${s})`).assign(a,(0,Lt._)`+${s}`);return;case"integer":n.elseIf((0,Lt._)`${o} === "boolean" || ${s} === null
              || (${o} === "string" && ${s} && ${s} == +${s} && !(${s} % 1))`).assign(a,(0,Lt._)`+${s}`);return;case"boolean":n.elseIf((0,Lt._)`${s} === "false" || ${s} === 0 || ${s} === null`).assign(a,!1).elseIf((0,Lt._)`${s} === "true" || ${s} === 1`).assign(a,!0);return;case"null":n.elseIf((0,Lt._)`${s} === "" || ${s} === 0 || ${s} === false`),n.assign(a,null);return;case"array":n.elseIf((0,Lt._)`${o} === "string" || ${o} === "number"
              || ${o} === "boolean" || ${s} === null`).assign(a,(0,Lt._)`[${s}]`)}}}function Bge({gen:t,parentData:e,parentDataProperty:r},n){t.if((0,Lt._)`${e} !== undefined`,()=>t.assign((0,Lt._)`${e}[${r}]`,n))}function vP(t,e,r,n=Qm.Correct){const s=n===Qm.Correct?Lt.operators.EQ:Lt.operators.NEQ;let i;switch(t){case"null":return(0,Lt._)`${e} ${s} null`;case"array":i=(0,Lt._)`Array.isArray(${e})`;break;case"object":i=(0,Lt._)`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":i=o((0,Lt._)`!(${e} % 1) && !isNaN(${e})`);break;case"number":i=o();break;default:return(0,Lt._)`typeof ${e} ${s} ${t}`}return n===Qm.Correct?i:(0,Lt.not)(i);function o(a=Lt.nil){return(0,Lt.and)((0,Lt._)`typeof ${e} == "number"`,a,r?(0,Lt._)`isFinite(${e})`:Lt.nil)}}Vn.checkDataType=vP;function nk(t,e,r,n){if(t.length===1)return vP(t[0],e,r,n);let s;const i=(0,vV.toHash)(t);if(i.array&&i.object){const o=(0,Lt._)`typeof ${e} != "object"`;s=i.null?o:(0,Lt._)`!${e} || ${o}`,delete i.null,delete i.array,delete i.object}else s=Lt.nil;i.number&&delete i.integer;for(const o in i)s=(0,Lt.and)(s,vP(o,e,r,n));return s}Vn.checkDataTypes=nk;const Fge={message:({schema:t})=>`must be ${t}`,params:({schema:t,schemaValue:e})=>typeof t=="string"?(0,Lt._)`{type: ${t}}`:(0,Lt._)`{type: ${e}}`};function ik(t){const e=Mge(t);(0,kge.reportError)(e,Fge)}Vn.reportTypeError=ik;function Mge(t){const{gen:e,data:r,schema:n}=t,s=(0,vV.schemaRefOrVal)(t,n,"type");return{gen:e,keyword:"type",data:r,schema:n.type,schemaCode:s,schemaValue:s,parentSchema:n,params:{},it:t}}var wS={};Object.defineProperty(wS,"__esModule",{value:!0});wS.assignDefaults=void 0;const lm=zt,jge=Ge;function Uge(t,e){const{properties:r,items:n}=t.schema;if(e==="object"&&r)for(const s in r)p6(t,s,r[s].default);else e==="array"&&Array.isArray(n)&&n.forEach((s,i)=>p6(t,i,s.default))}wS.assignDefaults=Uge;function p6(t,e,r){const{gen:n,compositeRule:s,data:i,opts:o}=t;if(r===void 0)return;const a=(0,lm._)`${i}${(0,lm.getProperty)(e)}`;if(s){(0,jge.checkStrictMode)(t,`default is ignored for: ${a}`);return}let u=(0,lm._)`${a} === undefined`;o.useDefaults==="empty"&&(u=(0,lm._)`${u} || ${a} === null || ${a} === ""`),n.if(u,(0,lm._)`${a} = ${(0,lm.stringify)(r)}`)}var ku={},Zt={};Object.defineProperty(Zt,"__esModule",{value:!0});Zt.validateUnion=Zt.validateArray=Zt.usePattern=Zt.callValidateCode=Zt.schemaProperties=Zt.allSchemaProperties=Zt.noPropertyInData=Zt.propertyInData=Zt.isOwnProperty=Zt.hasPropFunc=Zt.reportMissingProp=Zt.checkMissingProp=Zt.checkReportMissingProp=void 0;const en=zt,sk=Ge,id=uc,Lge=Ge;function Kge(t,e){const{gen:r,data:n,it:s}=t;r.if(ak(r,n,e,s.opts.ownProperties),()=>{t.setParams({missingProperty:(0,en._)`${e}`},!0),t.error()})}Zt.checkReportMissingProp=Kge;function Vge({gen:t,data:e,it:{opts:r}},n,s){return(0,en.or)(...n.map(i=>(0,en.and)(ak(t,e,i,r.ownProperties),(0,en._)`${s} = ${i}`)))}Zt.checkMissingProp=Vge;function qge(t,e){t.setParams({missingProperty:e},!0),t.error()}Zt.reportMissingProp=qge;function bV(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,en._)`Object.prototype.hasOwnProperty`})}Zt.hasPropFunc=bV;function ok(t,e,r){return(0,en._)`${bV(t)}.call(${e}, ${r})`}Zt.isOwnProperty=ok;function Hge(t,e,r,n){const s=(0,en._)`${e}${(0,en.getProperty)(r)} !== undefined`;return n?(0,en._)`${s} && ${ok(t,e,r)}`:s}Zt.propertyInData=Hge;function ak(t,e,r,n){const s=(0,en._)`${e}${(0,en.getProperty)(r)} === undefined`;return n?(0,en.or)(s,(0,en.not)(ok(t,e,r))):s}Zt.noPropertyInData=ak;function EV(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}Zt.allSchemaProperties=EV;function zge(t,e){return EV(e).filter(r=>!(0,sk.alwaysValidSchema)(t,e[r]))}Zt.schemaProperties=zge;function Wge({schemaCode:t,data:e,it:{gen:r,topSchemaRef:n,schemaPath:s,errorPath:i},it:o},a,u,l){const c=l?(0,en._)`${t}, ${e}, ${n}${s}`:e,d=[[id.default.instancePath,(0,en.strConcat)(id.default.instancePath,i)],[id.default.parentData,o.parentData],[id.default.parentDataProperty,o.parentDataProperty],[id.default.rootData,id.default.rootData]];o.opts.dynamicRef&&d.push([id.default.dynamicAnchors,id.default.dynamicAnchors]);const h=(0,en._)`${c}, ${r.object(...d)}`;return u!==en.nil?(0,en._)`${a}.call(${u}, ${h})`:(0,en._)`${a}(${h})`}Zt.callValidateCode=Wge;const Gge=(0,en._)`new RegExp`;function Jge({gen:t,it:{opts:e}},r){const n=e.unicodeRegExp?"u":"",{regExp:s}=e.code,i=s(r,n);return t.scopeValue("pattern",{key:i.toString(),ref:i,code:(0,en._)`${s.code==="new RegExp"?Gge:(0,Lge.useFunc)(t,s)}(${r}, ${n})`})}Zt.usePattern=Jge;function Xge(t){const{gen:e,data:r,keyword:n,it:s}=t,i=e.name("valid");if(s.allErrors){const a=e.let("valid",!0);return o(()=>e.assign(a,!1)),a}return e.var(i,!0),o(()=>e.break()),i;function o(a){const u=e.const("len",(0,en._)`${r}.length`);e.forRange("i",0,u,l=>{t.subschema({keyword:n,dataProp:l,dataPropType:sk.Type.Num},i),e.if((0,en.not)(i),a)})}}Zt.validateArray=Xge;function Yge(t){const{gen:e,schema:r,keyword:n,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(u=>(0,sk.alwaysValidSchema)(s,u))&&!s.opts.unevaluated)return;const o=e.let("valid",!1),a=e.name("_valid");e.block(()=>r.forEach((u,l)=>{const c=t.subschema({keyword:n,schemaProp:l,compositeRule:!0},a);e.assign(o,(0,en._)`${o} || ${a}`),t.mergeValidEvaluated(c,a)||e.if((0,en.not)(o))})),t.result(o,()=>t.reset(),()=>t.error(!0))}Zt.validateUnion=Yge;Object.defineProperty(ku,"__esModule",{value:!0});ku.validateKeywordUsage=ku.validSchemaType=ku.funcKeywordCode=ku.macroKeywordCode=void 0;const ls=zt,Ch=uc,Zge=Zt,Qge=Gw;function e0e(t,e){const{gen:r,keyword:n,schema:s,parentSchema:i,it:o}=t,a=e.macro.call(o.self,s,i,o),u=AV(r,n,a);o.opts.validateSchema!==!1&&o.self.validateSchema(a,!0);const l=r.name("valid");t.subschema({schema:a,schemaPath:ls.nil,errSchemaPath:`${o.errSchemaPath}/${n}`,topSchemaRef:u,compositeRule:!0},l),t.pass(l,()=>t.error(!0))}ku.macroKeywordCode=e0e;function t0e(t,e){var r;const{gen:n,keyword:s,schema:i,parentSchema:o,$data:a,it:u}=t;n0e(u,e);const l=!a&&e.compile?e.compile.call(u.self,i,o,u):e.validate,c=AV(n,s,l),d=n.let("valid");t.block$data(d,h),t.ok((r=e.valid)!==null&&r!==void 0?r:d);function h(){if(e.errors===!1)m(),e.modifying&&m6(t),E(()=>t.error());else{const A=e.async?f():p();e.modifying&&m6(t),E(()=>r0e(t,A))}}function f(){const A=n.let("ruleErrs",null);return n.try(()=>m((0,ls._)`await `),_=>n.assign(d,!1).if((0,ls._)`${_} instanceof ${u.ValidationError}`,()=>n.assign(A,(0,ls._)`${_}.errors`),()=>n.throw(_))),A}function p(){const A=(0,ls._)`${c}.errors`;return n.assign(A,null),m(ls.nil),A}function m(A=e.async?(0,ls._)`await `:ls.nil){const _=u.opts.passContext?Ch.default.this:Ch.default.self,g=!("compile"in e&&!a||e.schema===!1);n.assign(d,(0,ls._)`${A}${(0,Zge.callValidateCode)(t,c,_,g)}`,e.modifying)}function E(A){var _;n.if((0,ls.not)((_=e.valid)!==null&&_!==void 0?_:d),A)}}ku.funcKeywordCode=t0e;function m6(t){const{gen:e,data:r,it:n}=t;e.if(n.parentData,()=>e.assign(r,(0,ls._)`${n.parentData}[${n.parentDataProperty}]`))}function r0e(t,e){const{gen:r}=t;r.if((0,ls._)`Array.isArray(${e})`,()=>{r.assign(Ch.default.vErrors,(0,ls._)`${Ch.default.vErrors} === null ? ${e} : ${Ch.default.vErrors}.concat(${e})`).assign(Ch.default.errors,(0,ls._)`${Ch.default.vErrors}.length`),(0,Qge.extendErrors)(t)},()=>t.error())}function n0e({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function AV(t,e,r){if(r===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,ls.stringify)(r)})}function i0e(t,e,r=!1){return!e.length||e.some(n=>n==="array"?Array.isArray(t):n==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==n||r&&typeof t>"u")}ku.validSchemaType=i0e;function s0e({schema:t,opts:e,self:r,errSchemaPath:n},s,i){if(Array.isArray(s.keyword)?!s.keyword.includes(i):s.keyword!==i)throw new Error("ajv implementation error");const o=s.dependencies;if(o!=null&&o.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${i}: ${o.join(",")}`);if(s.validateSchema&&!s.validateSchema(t[i])){const u=`keyword "${i}" value is invalid at path "${n}": `+r.errorsText(s.validateSchema.errors);if(e.validateSchema==="log")r.logger.error(u);else throw new Error(u)}}ku.validateKeywordUsage=s0e;var tf={};Object.defineProperty(tf,"__esModule",{value:!0});tf.extendSubschemaMode=tf.extendSubschemaData=tf.getSubschema=void 0;const xu=zt,SV=Ge;function o0e(t,{keyword:e,schemaProp:r,schema:n,schemaPath:s,errSchemaPath:i,topSchemaRef:o}){if(e!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){const a=t.schema[e];return r===void 0?{schema:a,schemaPath:(0,xu._)`${t.schemaPath}${(0,xu.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[r],schemaPath:(0,xu._)`${t.schemaPath}${(0,xu.getProperty)(e)}${(0,xu.getProperty)(r)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,SV.escapeFragment)(r)}`}}if(n!==void 0){if(s===void 0||i===void 0||o===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:s,topSchemaRef:o,errSchemaPath:i}}throw new Error('either "keyword" or "schema" must be passed')}tf.getSubschema=o0e;function a0e(t,e,{dataProp:r,dataPropType:n,data:s,dataTypes:i,propertyName:o}){if(s!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:a}=e;if(r!==void 0){const{errorPath:l,dataPathArr:c,opts:d}=e,h=a.let("data",(0,xu._)`${e.data}${(0,xu.getProperty)(r)}`,!0);u(h),t.errorPath=(0,xu.str)`${l}${(0,SV.getErrorPath)(r,n,d.jsPropertySyntax)}`,t.parentDataProperty=(0,xu._)`${r}`,t.dataPathArr=[...c,t.parentDataProperty]}if(s!==void 0){const l=s instanceof xu.Name?s:a.let("data",s,!0);u(l),o!==void 0&&(t.propertyName=o)}i&&(t.dataTypes=i);function u(l){t.data=l,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,l]}}tf.extendSubschemaData=a0e;function u0e(t,{jtdDiscriminator:e,jtdMetadata:r,compositeRule:n,createErrors:s,allErrors:i}){n!==void 0&&(t.compositeRule=n),s!==void 0&&(t.createErrors=s),i!==void 0&&(t.allErrors=i),t.jtdDiscriminator=e,t.jtdMetadata=r}tf.extendSubschemaMode=u0e;var Ii={},TV={exports:{}},Gd=TV.exports=function(t,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var n=typeof r=="function"?r:r.pre||function(){},s=r.post||function(){};B1(e,n,s,t,"",t)};Gd.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};Gd.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Gd.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Gd.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function B1(t,e,r,n,s,i,o,a,u,l){if(n&&typeof n=="object"&&!Array.isArray(n)){e(n,s,i,o,a,u,l);for(var c in n){var d=n[c];if(Array.isArray(d)){if(c in Gd.arrayKeywords)for(var h=0;h<d.length;h++)B1(t,e,r,d[h],s+"/"+c+"/"+h,i,s,c,n,h)}else if(c in Gd.propsKeywords){if(d&&typeof d=="object")for(var f in d)B1(t,e,r,d[f],s+"/"+c+"/"+c0e(f),i,s,c,n,f)}else(c in Gd.keywords||t.allKeys&&!(c in Gd.skipKeywords))&&B1(t,e,r,d,s+"/"+c,i,s,c,n)}r(n,s,i,o,a,u,l)}}function c0e(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}var DV=TV.exports;Object.defineProperty(Ii,"__esModule",{value:!0});Ii.getSchemaRefs=Ii.resolveUrl=Ii.normalizeId=Ii._getFullPath=Ii.getFullPath=Ii.inlineRef=void 0;const l0e=Ge,d0e=mS,f0e=DV,h0e=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function p0e(t,e=!0){return typeof t=="boolean"?!0:e===!0?!wP(t):e?xV(t)<=e:!1}Ii.inlineRef=p0e;const m0e=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function wP(t){for(const e in t){if(m0e.has(e))return!0;const r=t[e];if(Array.isArray(r)&&r.some(wP)||typeof r=="object"&&wP(r))return!0}return!1}function xV(t){let e=0;for(const r in t){if(r==="$ref")return 1/0;if(e++,!h0e.has(r)&&(typeof t[r]=="object"&&(0,l0e.eachItem)(t[r],n=>e+=xV(n)),e===1/0))return 1/0}return e}function PV(t,e="",r){r!==!1&&(e=ey(e));const n=t.parse(e);return CV(t,n)}Ii.getFullPath=PV;function CV(t,e){return t.serialize(e).split("#")[0]+"#"}Ii._getFullPath=CV;const y0e=/#\/?$/;function ey(t){return t?t.replace(y0e,""):""}Ii.normalizeId=ey;function g0e(t,e,r){return r=ey(r),t.resolve(e,r)}Ii.resolveUrl=g0e;const v0e=/^[a-z_][-a-z0-9._]*$/i;function w0e(t,e){if(typeof t=="boolean")return{};const{schemaId:r,uriResolver:n}=this.opts,s=ey(t[r]||e),i={"":s},o=PV(n,s,!1),a={},u=new Set;return f0e(t,{allKeys:!0},(d,h,f,p)=>{if(p===void 0)return;const m=o+h;let E=i[p];typeof d[r]=="string"&&(E=A.call(this,d[r])),_.call(this,d.$anchor),_.call(this,d.$dynamicAnchor),i[h]=E;function A(g){const v=this.opts.uriResolver.resolve;if(g=ey(E?v(E,g):g),u.has(g))throw c(g);u.add(g);let S=this.refs[g];return typeof S=="string"&&(S=this.refs[S]),typeof S=="object"?l(d,S.schema,g):g!==ey(m)&&(g[0]==="#"?(l(d,a[g],g),a[g]=d):this.refs[g]=m),g}function _(g){if(typeof g=="string"){if(!v0e.test(g))throw new Error(`invalid anchor "${g}"`);A.call(this,`#${g}`)}}}),a;function l(d,h,f){if(h!==void 0&&!d0e(d,h))throw c(f)}function c(d){return new Error(`reference "${d}" resolves to more than one schema`)}}Ii.getSchemaRefs=w0e;Object.defineProperty(ja,"__esModule",{value:!0});ja.getData=ja.KeywordCxt=ja.validateFunctionCode=void 0;const IV=Ay,y6=Vn,uk=al,KE=Vn,_0e=wS,av=ku,WT=tf,rt=zt,$t=uc,b0e=Ii,ul=Ge,s0=Gw;function E0e(t){if(OV(t)&&(RV(t),$V(t))){T0e(t);return}kV(t,()=>(0,IV.topBoolOrEmptySchema)(t))}ja.validateFunctionCode=E0e;function kV({gen:t,validateName:e,schema:r,schemaEnv:n,opts:s},i){s.code.es5?t.func(e,(0,rt._)`${$t.default.data}, ${$t.default.valCxt}`,n.$async,()=>{t.code((0,rt._)`"use strict"; ${g6(r,s)}`),S0e(t,s),t.code(i)}):t.func(e,(0,rt._)`${$t.default.data}, ${A0e(s)}`,n.$async,()=>t.code(g6(r,s)).code(i))}function A0e(t){return(0,rt._)`{${$t.default.instancePath}="", ${$t.default.parentData}, ${$t.default.parentDataProperty}, ${$t.default.rootData}=${$t.default.data}${t.dynamicRef?(0,rt._)`, ${$t.default.dynamicAnchors}={}`:rt.nil}}={}`}function S0e(t,e){t.if($t.default.valCxt,()=>{t.var($t.default.instancePath,(0,rt._)`${$t.default.valCxt}.${$t.default.instancePath}`),t.var($t.default.parentData,(0,rt._)`${$t.default.valCxt}.${$t.default.parentData}`),t.var($t.default.parentDataProperty,(0,rt._)`${$t.default.valCxt}.${$t.default.parentDataProperty}`),t.var($t.default.rootData,(0,rt._)`${$t.default.valCxt}.${$t.default.rootData}`),e.dynamicRef&&t.var($t.default.dynamicAnchors,(0,rt._)`${$t.default.valCxt}.${$t.default.dynamicAnchors}`)},()=>{t.var($t.default.instancePath,(0,rt._)`""`),t.var($t.default.parentData,(0,rt._)`undefined`),t.var($t.default.parentDataProperty,(0,rt._)`undefined`),t.var($t.default.rootData,$t.default.data),e.dynamicRef&&t.var($t.default.dynamicAnchors,(0,rt._)`{}`)})}function T0e(t){const{schema:e,opts:r,gen:n}=t;kV(t,()=>{r.$comment&&e.$comment&&BV(t),I0e(t),n.let($t.default.vErrors,null),n.let($t.default.errors,0),r.unevaluated&&D0e(t),NV(t),O0e(t)})}function D0e(t){const{gen:e,validateName:r}=t;t.evaluated=e.const("evaluated",(0,rt._)`${r}.evaluated`),e.if((0,rt._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,rt._)`${t.evaluated}.props`,(0,rt._)`undefined`)),e.if((0,rt._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,rt._)`${t.evaluated}.items`,(0,rt._)`undefined`))}function g6(t,e){const r=typeof t=="object"&&t[e.schemaId];return r&&(e.code.source||e.code.process)?(0,rt._)`/*# sourceURL=${r} */`:rt.nil}function x0e(t,e){if(OV(t)&&(RV(t),$V(t))){P0e(t,e);return}(0,IV.boolOrEmptySchema)(t,e)}function $V({schema:t,self:e}){if(typeof t=="boolean")return!t;for(const r in t)if(e.RULES.all[r])return!0;return!1}function OV(t){return typeof t.schema!="boolean"}function P0e(t,e){const{schema:r,gen:n,opts:s}=t;s.$comment&&r.$comment&&BV(t),k0e(t),$0e(t);const i=n.const("_errs",$t.default.errors);NV(t,i),n.var(e,(0,rt._)`${i} === ${$t.default.errors}`)}function RV(t){(0,ul.checkUnknownRules)(t),C0e(t)}function NV(t,e){if(t.opts.jtd)return v6(t,[],!1,e);const r=(0,y6.getSchemaTypes)(t.schema),n=(0,y6.coerceAndCheckDataType)(t,r);v6(t,r,!n,e)}function C0e(t){const{schema:e,errSchemaPath:r,opts:n,self:s}=t;e.$ref&&n.ignoreKeywordsWithRef&&(0,ul.schemaHasRulesButRef)(e,s.RULES)&&s.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function I0e(t){const{schema:e,opts:r}=t;e.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,ul.checkStrictMode)(t,"default is ignored in the schema root")}function k0e(t){const e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,b0e.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function $0e(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function BV({gen:t,schemaEnv:e,schema:r,errSchemaPath:n,opts:s}){const i=r.$comment;if(s.$comment===!0)t.code((0,rt._)`${$t.default.self}.logger.log(${i})`);else if(typeof s.$comment=="function"){const o=(0,rt.str)`${n}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,rt._)`${$t.default.self}.opts.$comment(${i}, ${o}, ${a}.schema)`)}}function O0e(t){const{gen:e,schemaEnv:r,validateName:n,ValidationError:s,opts:i}=t;r.$async?e.if((0,rt._)`${$t.default.errors} === 0`,()=>e.return($t.default.data),()=>e.throw((0,rt._)`new ${s}(${$t.default.vErrors})`)):(e.assign((0,rt._)`${n}.errors`,$t.default.vErrors),i.unevaluated&&R0e(t),e.return((0,rt._)`${$t.default.errors} === 0`))}function R0e({gen:t,evaluated:e,props:r,items:n}){r instanceof rt.Name&&t.assign((0,rt._)`${e}.props`,r),n instanceof rt.Name&&t.assign((0,rt._)`${e}.items`,n)}function v6(t,e,r,n){const{gen:s,schema:i,data:o,allErrors:a,opts:u,self:l}=t,{RULES:c}=l;if(i.$ref&&(u.ignoreKeywordsWithRef||!(0,ul.schemaHasRulesButRef)(i,c))){s.block(()=>jV(t,"$ref",c.all.$ref.definition));return}u.jtd||N0e(t,e),s.block(()=>{for(const h of c.rules)d(h);d(c.post)});function d(h){(0,uk.shouldUseGroup)(i,h)&&(h.type?(s.if((0,KE.checkDataType)(h.type,o,u.strictNumbers)),w6(t,h),e.length===1&&e[0]===h.type&&r&&(s.else(),(0,KE.reportTypeError)(t)),s.endIf()):w6(t,h),a||s.if((0,rt._)`${$t.default.errors} === ${n||0}`))}}function w6(t,e){const{gen:r,schema:n,opts:{useDefaults:s}}=t;s&&(0,_0e.assignDefaults)(t,e.type),r.block(()=>{for(const i of e.rules)(0,uk.shouldUseRule)(n,i)&&jV(t,i.keyword,i.definition,e.type)})}function N0e(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(B0e(t,e),t.opts.allowUnionTypes||F0e(t,e),M0e(t,t.dataTypes))}function B0e(t,e){if(e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(r=>{FV(t.dataTypes,r)||ck(t,`type "${r}" not allowed by context "${t.dataTypes.join(",")}"`)}),U0e(t,e)}}function F0e(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&ck(t,"use allowUnionTypes to allow union type keyword")}function M0e(t,e){const r=t.self.RULES.all;for(const n in r){const s=r[n];if(typeof s=="object"&&(0,uk.shouldUseRule)(t.schema,s)){const{type:i}=s.definition;i.length&&!i.some(o=>j0e(e,o))&&ck(t,`missing type "${i.join(",")}" for keyword "${n}"`)}}}function j0e(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function FV(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function U0e(t,e){const r=[];for(const n of t.dataTypes)FV(e,n)?r.push(n):e.includes("integer")&&n==="number"&&r.push("integer");t.dataTypes=r}function ck(t,e){const r=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${r}" (strictTypes)`,(0,ul.checkStrictMode)(t,e,t.opts.strictTypes)}let MV=class{constructor(e,r,n){if((0,av.validateKeywordUsage)(e,r,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=r.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,ul.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=r,this.$data)this.schemaCode=e.gen.const("vSchema",UV(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,av.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=e.gen.const("_errs",$t.default.errors))}result(e,r,n){this.failResult((0,rt.not)(e),r,n)}failResult(e,r,n){this.gen.if(e),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,r){this.failResult((0,rt.not)(e),void 0,r)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);const{schemaCode:r}=this;this.fail((0,rt._)`${r} !== undefined && (${(0,rt.or)(this.invalid$data(),e)})`)}error(e,r,n){if(r){this.setParams(r),this._error(e,n),this.setParams({});return}this._error(e,n)}_error(e,r){(e?s0.reportExtraError:s0.reportError)(this,this.def.error,r)}$dataError(){(0,s0.reportError)(this,this.def.$dataError||s0.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,s0.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,r){r?Object.assign(this.params,e):this.params=e}block$data(e,r,n=rt.nil){this.gen.block(()=>{this.check$data(e,n),r()})}check$data(e=rt.nil,r=rt.nil){if(!this.$data)return;const{gen:n,schemaCode:s,schemaType:i,def:o}=this;n.if((0,rt.or)((0,rt._)`${s} === undefined`,r)),e!==rt.nil&&n.assign(e,!0),(i.length||o.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==rt.nil&&n.assign(e,!1)),n.else()}invalid$data(){const{gen:e,schemaCode:r,schemaType:n,def:s,it:i}=this;return(0,rt.or)(o(),a());function o(){if(n.length){if(!(r instanceof rt.Name))throw new Error("ajv implementation error");const u=Array.isArray(n)?n:[n];return(0,rt._)`${(0,KE.checkDataTypes)(u,r,i.opts.strictNumbers,KE.DataType.Wrong)}`}return rt.nil}function a(){if(s.validateSchema){const u=e.scopeValue("validate$data",{ref:s.validateSchema});return(0,rt._)`!${u}(${r})`}return rt.nil}}subschema(e,r){const n=(0,WT.getSubschema)(this.it,e);(0,WT.extendSubschemaData)(n,this.it,e),(0,WT.extendSubschemaMode)(n,e);const s={...this.it,...n,items:void 0,props:void 0};return x0e(s,r),s}mergeEvaluated(e,r){const{it:n,gen:s}=this;n.opts.unevaluated&&(n.props!==!0&&e.props!==void 0&&(n.props=ul.mergeEvaluated.props(s,e.props,n.props,r)),n.items!==!0&&e.items!==void 0&&(n.items=ul.mergeEvaluated.items(s,e.items,n.items,r)))}mergeValidEvaluated(e,r){const{it:n,gen:s}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return s.if(r,()=>this.mergeEvaluated(e,rt.Name)),!0}};ja.KeywordCxt=MV;function jV(t,e,r,n){const s=new MV(t,r,e);"code"in r?r.code(s,n):s.$data&&r.validate?(0,av.funcKeywordCode)(s,r):"macro"in r?(0,av.macroKeywordCode)(s,r):(r.compile||r.validate)&&(0,av.funcKeywordCode)(s,r)}const L0e=/^\/(?:[^~]|~0|~1)*$/,K0e=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function UV(t,{dataLevel:e,dataNames:r,dataPathArr:n}){let s,i;if(t==="")return $t.default.rootData;if(t[0]==="/"){if(!L0e.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);s=t,i=$t.default.rootData}else{const l=K0e.exec(t);if(!l)throw new Error(`Invalid JSON-pointer: ${t}`);const c=+l[1];if(s=l[2],s==="#"){if(c>=e)throw new Error(u("property/index",c));return n[e-c]}if(c>e)throw new Error(u("data",c));if(i=r[e-c],!s)return i}let o=i;const a=s.split("/");for(const l of a)l&&(i=(0,rt._)`${i}${(0,rt.getProperty)((0,ul.unescapeJsonPointer)(l))}`,o=(0,rt._)`${o} && ${i}`);return o;function u(l,c){return`Cannot access ${l} ${c} levels up, current level is ${e}`}}ja.getData=UV;var Jw={};Object.defineProperty(Jw,"__esModule",{value:!0});let V0e=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};Jw.default=V0e;var Gy={};Object.defineProperty(Gy,"__esModule",{value:!0});const GT=Ii;let q0e=class extends Error{constructor(e,r,n,s){super(s||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,GT.resolveUrl)(e,r,n),this.missingSchema=(0,GT.normalizeId)((0,GT.getFullPath)(e,this.missingRef))}};Gy.default=q0e;var Ms={};Object.defineProperty(Ms,"__esModule",{value:!0});Ms.resolveSchema=Ms.getCompilingSchema=Ms.resolveRef=Ms.compileSchema=Ms.SchemaEnv=void 0;const va=zt,H0e=Jw,ch=uc,ka=Ii,_6=Ge,z0e=ja;let _S=class{constructor(e){var r;this.refs={},this.dynamicAnchors={};let n;typeof e.schema=="object"&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(r=e.baseId)!==null&&r!==void 0?r:(0,ka.normalizeId)(n==null?void 0:n[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=n==null?void 0:n.$async,this.refs={}}};Ms.SchemaEnv=_S;function lk(t){const e=LV.call(this,t);if(e)return e;const r=(0,ka.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:n,lines:s}=this.opts.code,{ownProperties:i}=this.opts,o=new va.CodeGen(this.scope,{es5:n,lines:s,ownProperties:i});let a;t.$async&&(a=o.scopeValue("Error",{ref:H0e.default,code:(0,va._)`require("ajv/dist/runtime/validation_error").default`}));const u=o.scopeName("validate");t.validateName=u;const l={gen:o,allErrors:this.opts.allErrors,data:ch.default.data,parentData:ch.default.parentData,parentDataProperty:ch.default.parentDataProperty,dataNames:[ch.default.data],dataPathArr:[va.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:o.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,va.stringify)(t.schema)}:{ref:t.schema}),validateName:u,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:r,baseId:t.baseId||r,schemaPath:va.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,va._)`""`,opts:this.opts,self:this};let c;try{this._compilations.add(t),(0,z0e.validateFunctionCode)(l),o.optimize(this.opts.code.optimize);const d=o.toString();c=`${o.scopeRefs(ch.default.scope)}return ${d}`,this.opts.code.process&&(c=this.opts.code.process(c,t));const f=new Function(`${ch.default.self}`,`${ch.default.scope}`,c)(this,this.scope.get());if(this.scope.value(u,{ref:f}),f.errors=null,f.schema=t.schema,f.schemaEnv=t,t.$async&&(f.$async=!0),this.opts.code.source===!0&&(f.source={validateName:u,validateCode:d,scopeValues:o._values}),this.opts.unevaluated){const{props:p,items:m}=l;f.evaluated={props:p instanceof va.Name?void 0:p,items:m instanceof va.Name?void 0:m,dynamicProps:p instanceof va.Name,dynamicItems:m instanceof va.Name},f.source&&(f.source.evaluated=(0,va.stringify)(f.evaluated))}return t.validate=f,t}catch(d){throw delete t.validate,delete t.validateName,c&&this.logger.error("Error compiling schema, function code:",c),d}finally{this._compilations.delete(t)}}Ms.compileSchema=lk;function W0e(t,e,r){var n;r=(0,ka.resolveUrl)(this.opts.uriResolver,e,r);const s=t.refs[r];if(s)return s;let i=X0e.call(this,t,r);if(i===void 0){const o=(n=t.localRefs)===null||n===void 0?void 0:n[r],{schemaId:a}=this.opts;o&&(i=new _S({schema:o,schemaId:a,root:t,baseId:e}))}if(i!==void 0)return t.refs[r]=G0e.call(this,i)}Ms.resolveRef=W0e;function G0e(t){return(0,ka.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:lk.call(this,t)}function LV(t){for(const e of this._compilations)if(J0e(e,t))return e}Ms.getCompilingSchema=LV;function J0e(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function X0e(t,e){let r;for(;typeof(r=this.refs[e])=="string";)e=r;return r||this.schemas[e]||bS.call(this,t,e)}function bS(t,e){const r=this.opts.uriResolver.parse(e),n=(0,ka._getFullPath)(this.opts.uriResolver,r);let s=(0,ka.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&n===s)return JT.call(this,r,t);const i=(0,ka.normalizeId)(n),o=this.refs[i]||this.schemas[i];if(typeof o=="string"){const a=bS.call(this,t,o);return typeof(a==null?void 0:a.schema)!="object"?void 0:JT.call(this,r,a)}if(typeof(o==null?void 0:o.schema)=="object"){if(o.validate||lk.call(this,o),i===(0,ka.normalizeId)(e)){const{schema:a}=o,{schemaId:u}=this.opts,l=a[u];return l&&(s=(0,ka.resolveUrl)(this.opts.uriResolver,s,l)),new _S({schema:a,schemaId:u,root:t,baseId:s})}return JT.call(this,r,o)}}Ms.resolveSchema=bS;const Y0e=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function JT(t,{baseId:e,schema:r,root:n}){var s;if(((s=t.fragment)===null||s===void 0?void 0:s[0])!=="/")return;for(const a of t.fragment.slice(1).split("/")){if(typeof r=="boolean")return;const u=r[(0,_6.unescapeFragment)(a)];if(u===void 0)return;r=u;const l=typeof r=="object"&&r[this.opts.schemaId];!Y0e.has(a)&&l&&(e=(0,ka.resolveUrl)(this.opts.uriResolver,e,l))}let i;if(typeof r!="boolean"&&r.$ref&&!(0,_6.schemaHasRulesButRef)(r,this.RULES)){const a=(0,ka.resolveUrl)(this.opts.uriResolver,e,r.$ref);i=bS.call(this,n,a)}const{schemaId:o}=this.opts;if(i=i||new _S({schema:r,schemaId:o,root:n,baseId:e}),i.schema!==i.root.schema)return i}const Z0e="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",Q0e="Meta-schema for $data reference (JSON AnySchema extension proposal)",eve="object",tve=["$data"],rve={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},nve=!1,ive={$id:Z0e,description:Q0e,type:eve,required:tve,properties:rve,additionalProperties:nve};var dk={},ES={exports:{}};const sve={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};var ove={HEX:sve};const{HEX:ave}=ove;function KV(t){if(qV(t,".")<3)return{host:t,isIPV4:!1};const e=t.match(/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/u)||[],[r]=e;return r?{host:cve(r,"."),isIPV4:!0}:{host:t,isIPV4:!1}}function _P(t,e=!1){let r="",n=!0;for(const s of t){if(ave[s]===void 0)return;s!=="0"&&n===!0&&(n=!1),n||(r+=s)}return e&&r.length===0&&(r="0"),r}function uve(t){let e=0;const r={error:!1,address:"",zone:""},n=[],s=[];let i=!1,o=!1,a=!1;function u(){if(s.length){if(i===!1){const l=_P(s);if(l!==void 0)n.push(l);else return r.error=!0,!1}s.length=0}return!0}for(let l=0;l<t.length;l++){const c=t[l];if(!(c==="["||c==="]"))if(c===":"){if(o===!0&&(a=!0),!u())break;if(e++,n.push(":"),e>7){r.error=!0;break}l-1>=0&&t[l-1]===":"&&(o=!0);continue}else if(c==="%"){if(!u())break;i=!0}else{s.push(c);continue}}return s.length&&(i?r.zone=s.join(""):a?n.push(s.join("")):n.push(_P(s))),r.address=n.join(""),r}function VV(t,e={}){if(qV(t,":")<2)return{host:t,isIPV6:!1};const r=uve(t);if(r.error)return{host:t,isIPV6:!1};{let n=r.address,s=r.address;return r.zone&&(n+="%"+r.zone,s+="%25"+r.zone),{host:n,escapedHost:s,isIPV6:!0}}}function cve(t,e){let r="",n=!0;const s=t.length;for(let i=0;i<s;i++){const o=t[i];o==="0"&&n?(i+1<=s&&t[i+1]===e||i+1===s)&&(r+=o,n=!1):(o===e?n=!0:n=!1,r+=o)}return r}function qV(t,e){let r=0;for(let n=0;n<t.length;n++)t[n]===e&&r++;return r}const b6=/^\.\.?\//u,E6=/^\/\.(?:\/|$)/u,A6=/^\/\.\.(?:\/|$)/u,lve=/^\/?(?:.|\n)*?(?=\/|$)/u;function dve(t){const e=[];for(;t.length;)if(t.match(b6))t=t.replace(b6,"");else if(t.match(E6))t=t.replace(E6,"/");else if(t.match(A6))t=t.replace(A6,"/"),e.pop();else if(t==="."||t==="..")t="";else{const r=t.match(lve);if(r){const n=r[0];t=t.slice(n.length),e.push(n)}else throw new Error("Unexpected dot segment condition")}return e.join("")}function fve(t,e){const r=e!==!0?escape:unescape;return t.scheme!==void 0&&(t.scheme=r(t.scheme)),t.userinfo!==void 0&&(t.userinfo=r(t.userinfo)),t.host!==void 0&&(t.host=r(t.host)),t.path!==void 0&&(t.path=r(t.path)),t.query!==void 0&&(t.query=r(t.query)),t.fragment!==void 0&&(t.fragment=r(t.fragment)),t}function hve(t,e){const r=[];if(t.userinfo!==void 0&&(r.push(t.userinfo),r.push("@")),t.host!==void 0){let n=unescape(t.host);const s=KV(n);if(s.isIPV4)n=s.host;else{const i=VV(s.host,{isIPV4:!1});i.isIPV6===!0?n=`[${i.escapedHost}]`:n=t.host}r.push(n)}return(typeof t.port=="number"||typeof t.port=="string")&&(r.push(":"),r.push(String(t.port))),r.length?r.join(""):void 0}var pve={recomposeAuthority:hve,normalizeComponentEncoding:fve,removeDotSegments:dve,normalizeIPv4:KV,normalizeIPv6:VV,stringArrayToHexStripped:_P};const mve=/^[\da-f]{8}\b-[\da-f]{4}\b-[\da-f]{4}\b-[\da-f]{4}\b-[\da-f]{12}$/iu,yve=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu;function HV(t){return typeof t.secure=="boolean"?t.secure:String(t.scheme).toLowerCase()==="wss"}function zV(t){return t.host||(t.error=t.error||"HTTP URIs must have a host."),t}function WV(t){const e=String(t.scheme).toLowerCase()==="https";return(t.port===(e?443:80)||t.port==="")&&(t.port=void 0),t.path||(t.path="/"),t}function gve(t){return t.secure=HV(t),t.resourceName=(t.path||"/")+(t.query?"?"+t.query:""),t.path=void 0,t.query=void 0,t}function vve(t){if((t.port===(HV(t)?443:80)||t.port==="")&&(t.port=void 0),typeof t.secure=="boolean"&&(t.scheme=t.secure?"wss":"ws",t.secure=void 0),t.resourceName){const[e,r]=t.resourceName.split("?");t.path=e&&e!=="/"?e:void 0,t.query=r,t.resourceName=void 0}return t.fragment=void 0,t}function wve(t,e){if(!t.path)return t.error="URN can not be parsed",t;const r=t.path.match(yve);if(r){const n=e.scheme||t.scheme||"urn";t.nid=r[1].toLowerCase(),t.nss=r[2];const s=`${n}:${e.nid||t.nid}`,i=fk[s];t.path=void 0,i&&(t=i.parse(t,e))}else t.error=t.error||"URN can not be parsed.";return t}function _ve(t,e){const r=e.scheme||t.scheme||"urn",n=t.nid.toLowerCase(),s=`${r}:${e.nid||n}`,i=fk[s];i&&(t=i.serialize(t,e));const o=t,a=t.nss;return o.path=`${n||e.nid}:${a}`,e.skipEscape=!0,o}function bve(t,e){const r=t;return r.uuid=r.nss,r.nss=void 0,!e.tolerant&&(!r.uuid||!mve.test(r.uuid))&&(r.error=r.error||"UUID is not valid."),r}function Eve(t){const e=t;return e.nss=(t.uuid||"").toLowerCase(),e}const GV={scheme:"http",domainHost:!0,parse:zV,serialize:WV},Ave={scheme:"https",domainHost:GV.domainHost,parse:zV,serialize:WV},F1={scheme:"ws",domainHost:!0,parse:gve,serialize:vve},Sve={scheme:"wss",domainHost:F1.domainHost,parse:F1.parse,serialize:F1.serialize},Tve={scheme:"urn",parse:wve,serialize:_ve,skipNormalize:!0},Dve={scheme:"urn:uuid",parse:bve,serialize:Eve,skipNormalize:!0},fk={http:GV,https:Ave,ws:F1,wss:Sve,urn:Tve,"urn:uuid":Dve};var xve=fk;const{normalizeIPv6:Pve,normalizeIPv4:Cve,removeDotSegments:F0,recomposeAuthority:Ive,normalizeComponentEncoding:$b}=pve,hk=xve;function kve(t,e){return typeof t=="string"?t=$u(vl(t,e),e):typeof t=="object"&&(t=vl($u(t,e),e)),t}function $ve(t,e,r){const n=Object.assign({scheme:"null"},r),s=JV(vl(t,n),vl(e,n),n,!0);return $u(s,{...n,skipEscape:!0})}function JV(t,e,r,n){const s={};return n||(t=vl($u(t,r),r),e=vl($u(e,r),r)),r=r||{},!r.tolerant&&e.scheme?(s.scheme=e.scheme,s.userinfo=e.userinfo,s.host=e.host,s.port=e.port,s.path=F0(e.path||""),s.query=e.query):(e.userinfo!==void 0||e.host!==void 0||e.port!==void 0?(s.userinfo=e.userinfo,s.host=e.host,s.port=e.port,s.path=F0(e.path||""),s.query=e.query):(e.path?(e.path.charAt(0)==="/"?s.path=F0(e.path):((t.userinfo!==void 0||t.host!==void 0||t.port!==void 0)&&!t.path?s.path="/"+e.path:t.path?s.path=t.path.slice(0,t.path.lastIndexOf("/")+1)+e.path:s.path=e.path,s.path=F0(s.path)),s.query=e.query):(s.path=t.path,e.query!==void 0?s.query=e.query:s.query=t.query),s.userinfo=t.userinfo,s.host=t.host,s.port=t.port),s.scheme=t.scheme),s.fragment=e.fragment,s}function Ove(t,e,r){return typeof t=="string"?(t=unescape(t),t=$u($b(vl(t,r),!0),{...r,skipEscape:!0})):typeof t=="object"&&(t=$u($b(t,!0),{...r,skipEscape:!0})),typeof e=="string"?(e=unescape(e),e=$u($b(vl(e,r),!0),{...r,skipEscape:!0})):typeof e=="object"&&(e=$u($b(e,!0),{...r,skipEscape:!0})),t.toLowerCase()===e.toLowerCase()}function $u(t,e){const r={host:t.host,scheme:t.scheme,userinfo:t.userinfo,port:t.port,path:t.path,query:t.query,nid:t.nid,nss:t.nss,uuid:t.uuid,fragment:t.fragment,reference:t.reference,resourceName:t.resourceName,secure:t.secure,error:""},n=Object.assign({},e),s=[],i=hk[(n.scheme||r.scheme||"").toLowerCase()];i&&i.serialize&&i.serialize(r,n),r.path!==void 0&&(n.skipEscape?r.path=unescape(r.path):(r.path=escape(r.path),r.scheme!==void 0&&(r.path=r.path.split("%3A").join(":")))),n.reference!=="suffix"&&r.scheme&&(s.push(r.scheme),s.push(":"));const o=Ive(r,n);if(o!==void 0&&(n.reference!=="suffix"&&s.push("//"),s.push(o),r.path&&r.path.charAt(0)!=="/"&&s.push("/")),r.path!==void 0){let a=r.path;!n.absolutePath&&(!i||!i.absolutePath)&&(a=F0(a)),o===void 0&&(a=a.replace(/^\/\//u,"/%2F")),s.push(a)}return r.query!==void 0&&(s.push("?"),s.push(r.query)),r.fragment!==void 0&&(s.push("#"),s.push(r.fragment)),s.join("")}const Rve=Array.from({length:127},(t,e)=>/[^!"$&'()*+,\-.;=_`a-z{}~]/u.test(String.fromCharCode(e)));function Nve(t){let e=0;for(let r=0,n=t.length;r<n;++r)if(e=t.charCodeAt(r),e>126||Rve[e])return!0;return!1}const Bve=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function vl(t,e){const r=Object.assign({},e),n={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},s=t.indexOf("%")!==-1;let i=!1;r.reference==="suffix"&&(t=(r.scheme?r.scheme+":":"")+"//"+t);const o=t.match(Bve);if(o){if(n.scheme=o[1],n.userinfo=o[3],n.host=o[4],n.port=parseInt(o[5],10),n.path=o[6]||"",n.query=o[7],n.fragment=o[8],isNaN(n.port)&&(n.port=o[5]),n.host){const u=Cve(n.host);if(u.isIPV4===!1){const l=Pve(u.host,{isIPV4:!1});n.host=l.host.toLowerCase(),i=l.isIPV6}else n.host=u.host,i=!0}n.scheme===void 0&&n.userinfo===void 0&&n.host===void 0&&n.port===void 0&&!n.path&&n.query===void 0?n.reference="same-document":n.scheme===void 0?n.reference="relative":n.fragment===void 0?n.reference="absolute":n.reference="uri",r.reference&&r.reference!=="suffix"&&r.reference!==n.reference&&(n.error=n.error||"URI is not a "+r.reference+" reference.");const a=hk[(r.scheme||n.scheme||"").toLowerCase()];if(!r.unicodeSupport&&(!a||!a.unicodeSupport)&&n.host&&(r.domainHost||a&&a.domainHost)&&i===!1&&Nve(n.host))try{n.host=URL.domainToASCII(n.host.toLowerCase())}catch(u){n.error=n.error||"Host's domain name can not be converted to ASCII: "+u}(!a||a&&!a.skipNormalize)&&(s&&n.scheme!==void 0&&(n.scheme=unescape(n.scheme)),s&&n.userinfo!==void 0&&(n.userinfo=unescape(n.userinfo)),s&&n.host!==void 0&&(n.host=unescape(n.host)),n.path!==void 0&&n.path.length&&(n.path=escape(unescape(n.path))),n.fragment!==void 0&&n.fragment.length&&(n.fragment=encodeURI(decodeURIComponent(n.fragment)))),a&&a.parse&&a.parse(n,r)}else n.error=n.error||"URI can not be parsed.";return n}const pk={SCHEMES:hk,normalize:kve,resolve:$ve,resolveComponents:JV,equal:Ove,serialize:$u,parse:vl};ES.exports=pk;ES.exports.default=pk;ES.exports.fastUri=pk;var Fve=ES.exports;Object.defineProperty(dk,"__esModule",{value:!0});const XV=Fve;XV.code='require("ajv/dist/runtime/uri").default';dk.default=XV;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;var e=ja;Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return e.KeywordCxt}});var r=zt;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return r.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return r.CodeGen}});const n=Jw,s=Gy,i=_p,o=Ms,a=zt,u=Ii,l=Vn,c=Ge,d=ive,h=dk,f=(W,B)=>new RegExp(W,B);f.code="new RegExp";const p=["removeAdditional","useDefaults","coerceTypes"],m=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),E={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},A={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},_=200;function g(W){var B,te,z,$,F,ee,ne,le,me,ve,Pe,Ue,M,V,oe,j,I,N,Q,ce,pe,he,Ce,_e,G;const J=W.strict,ge=(B=W.code)===null||B===void 0?void 0:B.optimize,be=ge===!0||ge===void 0?1:ge||0,ke=(z=(te=W.code)===null||te===void 0?void 0:te.regExp)!==null&&z!==void 0?z:f,At=($=W.uriResolver)!==null&&$!==void 0?$:h.default;return{strictSchema:(ee=(F=W.strictSchema)!==null&&F!==void 0?F:J)!==null&&ee!==void 0?ee:!0,strictNumbers:(le=(ne=W.strictNumbers)!==null&&ne!==void 0?ne:J)!==null&&le!==void 0?le:!0,strictTypes:(ve=(me=W.strictTypes)!==null&&me!==void 0?me:J)!==null&&ve!==void 0?ve:"log",strictTuples:(Ue=(Pe=W.strictTuples)!==null&&Pe!==void 0?Pe:J)!==null&&Ue!==void 0?Ue:"log",strictRequired:(V=(M=W.strictRequired)!==null&&M!==void 0?M:J)!==null&&V!==void 0?V:!1,code:W.code?{...W.code,optimize:be,regExp:ke}:{optimize:be,regExp:ke},loopRequired:(oe=W.loopRequired)!==null&&oe!==void 0?oe:_,loopEnum:(j=W.loopEnum)!==null&&j!==void 0?j:_,meta:(I=W.meta)!==null&&I!==void 0?I:!0,messages:(N=W.messages)!==null&&N!==void 0?N:!0,inlineRefs:(Q=W.inlineRefs)!==null&&Q!==void 0?Q:!0,schemaId:(ce=W.schemaId)!==null&&ce!==void 0?ce:"$id",addUsedSchema:(pe=W.addUsedSchema)!==null&&pe!==void 0?pe:!0,validateSchema:(he=W.validateSchema)!==null&&he!==void 0?he:!0,validateFormats:(Ce=W.validateFormats)!==null&&Ce!==void 0?Ce:!0,unicodeRegExp:(_e=W.unicodeRegExp)!==null&&_e!==void 0?_e:!0,int32range:(G=W.int32range)!==null&&G!==void 0?G:!0,uriResolver:At}}class v{constructor(B={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,B=this.opts={...B,...g(B)};const{es5:te,lines:z}=this.opts.code;this.scope=new a.ValueScope({scope:{},prefixes:m,es5:te,lines:z}),this.logger=C(B.logger);const $=B.validateFormats;B.validateFormats=!1,this.RULES=(0,i.getRules)(),S.call(this,E,B,"NOT SUPPORTED"),S.call(this,A,B,"DEPRECATED","warn"),this._metaOpts=T.call(this),B.formats&&w.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),B.keywords&&b.call(this,B.keywords),typeof B.meta=="object"&&this.addMetaSchema(B.meta),D.call(this),B.validateFormats=$}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:B,meta:te,schemaId:z}=this.opts;let $=d;z==="id"&&($={...d},$.id=$.$id,delete $.$id),te&&B&&this.addMetaSchema($,$[z],!1)}defaultMeta(){const{meta:B,schemaId:te}=this.opts;return this.opts.defaultMeta=typeof B=="object"?B[te]||B:void 0}validate(B,te){let z;if(typeof B=="string"){if(z=this.getSchema(B),!z)throw new Error(`no schema with key or ref "${B}"`)}else z=this.compile(B);const $=z(te);return"$async"in z||(this.errors=z.errors),$}compile(B,te){const z=this._addSchema(B,te);return z.validate||this._compileSchemaEnv(z)}compileAsync(B,te){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:z}=this.opts;return $.call(this,B,te);async function $(ve,Pe){await F.call(this,ve.$schema);const Ue=this._addSchema(ve,Pe);return Ue.validate||ee.call(this,Ue)}async function F(ve){ve&&!this.getSchema(ve)&&await $.call(this,{$ref:ve},!0)}async function ee(ve){try{return this._compileSchemaEnv(ve)}catch(Pe){if(!(Pe instanceof s.default))throw Pe;return ne.call(this,Pe),await le.call(this,Pe.missingSchema),ee.call(this,ve)}}function ne({missingSchema:ve,missingRef:Pe}){if(this.refs[ve])throw new Error(`AnySchema ${ve} is loaded but ${Pe} cannot be resolved`)}async function le(ve){const Pe=await me.call(this,ve);this.refs[ve]||await F.call(this,Pe.$schema),this.refs[ve]||this.addSchema(Pe,ve,te)}async function me(ve){const Pe=this._loading[ve];if(Pe)return Pe;try{return await(this._loading[ve]=z(ve))}finally{delete this._loading[ve]}}}addSchema(B,te,z,$=this.opts.validateSchema){if(Array.isArray(B)){for(const ee of B)this.addSchema(ee,void 0,z,$);return this}let F;if(typeof B=="object"){const{schemaId:ee}=this.opts;if(F=B[ee],F!==void 0&&typeof F!="string")throw new Error(`schema ${ee} must be string`)}return te=(0,u.normalizeId)(te||F),this._checkUnique(te),this.schemas[te]=this._addSchema(B,z,te,$,!0),this}addMetaSchema(B,te,z=this.opts.validateSchema){return this.addSchema(B,te,!0,z),this}validateSchema(B,te){if(typeof B=="boolean")return!0;let z;if(z=B.$schema,z!==void 0&&typeof z!="string")throw new Error("$schema must be a string");if(z=z||this.opts.defaultMeta||this.defaultMeta(),!z)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const $=this.validate(z,B);if(!$&&te){const F="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(F);else throw new Error(F)}return $}getSchema(B){let te;for(;typeof(te=x.call(this,B))=="string";)B=te;if(te===void 0){const{schemaId:z}=this.opts,$=new o.SchemaEnv({schema:{},schemaId:z});if(te=o.resolveSchema.call(this,$,B),!te)return;this.refs[B]=te}return te.validate||this._compileSchemaEnv(te)}removeSchema(B){if(B instanceof RegExp)return this._removeAllSchemas(this.schemas,B),this._removeAllSchemas(this.refs,B),this;switch(typeof B){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const te=x.call(this,B);return typeof te=="object"&&this._cache.delete(te.schema),delete this.schemas[B],delete this.refs[B],this}case"object":{const te=B;this._cache.delete(te);let z=B[this.opts.schemaId];return z&&(z=(0,u.normalizeId)(z),delete this.schemas[z],delete this.refs[z]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(B){for(const te of B)this.addKeyword(te);return this}addKeyword(B,te){let z;if(typeof B=="string")z=B,typeof te=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),te.keyword=z);else if(typeof B=="object"&&te===void 0){if(te=B,z=te.keyword,Array.isArray(z)&&!z.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(K.call(this,z,te),!te)return(0,c.eachItem)(z,F=>L.call(this,F)),this;se.call(this,te);const $={...te,type:(0,l.getJSONTypes)(te.type),schemaType:(0,l.getJSONTypes)(te.schemaType)};return(0,c.eachItem)(z,$.type.length===0?F=>L.call(this,F,$):F=>$.type.forEach(ee=>L.call(this,F,$,ee))),this}getKeyword(B){const te=this.RULES.all[B];return typeof te=="object"?te.definition:!!te}removeKeyword(B){const{RULES:te}=this;delete te.keywords[B],delete te.all[B];for(const z of te.rules){const $=z.rules.findIndex(F=>F.keyword===B);$>=0&&z.rules.splice($,1)}return this}addFormat(B,te){return typeof te=="string"&&(te=new RegExp(te)),this.formats[B]=te,this}errorsText(B=this.errors,{separator:te=", ",dataVar:z="data"}={}){return!B||B.length===0?"No errors":B.map($=>`${z}${$.instancePath} ${$.message}`).reduce(($,F)=>$+te+F)}$dataMetaSchema(B,te){const z=this.RULES.all;B=JSON.parse(JSON.stringify(B));for(const $ of te){const F=$.split("/").slice(1);let ee=B;for(const ne of F)ee=ee[ne];for(const ne in z){const le=z[ne];if(typeof le!="object")continue;const{$data:me}=le.definition,ve=ee[ne];me&&ve&&(ee[ne]=re(ve))}}return B}_removeAllSchemas(B,te){for(const z in B){const $=B[z];(!te||te.test(z))&&(typeof $=="string"?delete B[z]:$&&!$.meta&&(this._cache.delete($.schema),delete B[z]))}}_addSchema(B,te,z,$=this.opts.validateSchema,F=this.opts.addUsedSchema){let ee;const{schemaId:ne}=this.opts;if(typeof B=="object")ee=B[ne];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof B!="boolean")throw new Error("schema must be object or boolean")}let le=this._cache.get(B);if(le!==void 0)return le;z=(0,u.normalizeId)(ee||z);const me=u.getSchemaRefs.call(this,B,z);return le=new o.SchemaEnv({schema:B,schemaId:ne,meta:te,baseId:z,localRefs:me}),this._cache.set(le.schema,le),F&&!z.startsWith("#")&&(z&&this._checkUnique(z),this.refs[z]=le),$&&this.validateSchema(B,!0),le}_checkUnique(B){if(this.schemas[B]||this.refs[B])throw new Error(`schema with key or id "${B}" already exists`)}_compileSchemaEnv(B){if(B.meta?this._compileMetaSchema(B):o.compileSchema.call(this,B),!B.validate)throw new Error("ajv implementation error");return B.validate}_compileMetaSchema(B){const te=this.opts;this.opts=this._metaOpts;try{o.compileSchema.call(this,B)}finally{this.opts=te}}}v.ValidationError=n.default,v.MissingRefError=s.default,t.default=v;function S(W,B,te,z="error"){for(const $ in W){const F=$;F in B&&this.logger[z](`${te}: option ${$}. ${W[F]}`)}}function x(W){return W=(0,u.normalizeId)(W),this.schemas[W]||this.refs[W]}function D(){const W=this.opts.schemas;if(W)if(Array.isArray(W))this.addSchema(W);else for(const B in W)this.addSchema(W[B],B)}function w(){for(const W in this.opts.formats){const B=this.opts.formats[W];B&&this.addFormat(W,B)}}function b(W){if(Array.isArray(W)){this.addVocabulary(W);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const B in W){const te=W[B];te.keyword||(te.keyword=B),this.addKeyword(te)}}function T(){const W={...this.opts};for(const B of p)delete W[B];return W}const P={log(){},warn(){},error(){}};function C(W){if(W===!1)return P;if(W===void 0)return console;if(W.log&&W.warn&&W.error)return W;throw new Error("logger must implement log, warn and error methods")}const k=/^[a-z_$][a-z0-9_$:-]*$/i;function K(W,B){const{RULES:te}=this;if((0,c.eachItem)(W,z=>{if(te.keywords[z])throw new Error(`Keyword ${z} is already defined`);if(!k.test(z))throw new Error(`Keyword ${z} has invalid name`)}),!!B&&B.$data&&!("code"in B||"validate"in B))throw new Error('$data keyword must have "code" or "validate" function')}function L(W,B,te){var z;const $=B==null?void 0:B.post;if(te&&$)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:F}=this;let ee=$?F.post:F.rules.find(({type:le})=>le===te);if(ee||(ee={type:te,rules:[]},F.rules.push(ee)),F.keywords[W]=!0,!B)return;const ne={keyword:W,definition:{...B,type:(0,l.getJSONTypes)(B.type),schemaType:(0,l.getJSONTypes)(B.schemaType)}};B.before?q.call(this,ee,ne,B.before):ee.rules.push(ne),F.all[W]=ne,(z=B.implements)===null||z===void 0||z.forEach(le=>this.addKeyword(le))}function q(W,B,te){const z=W.rules.findIndex($=>$.keyword===te);z>=0?W.rules.splice(z,0,B):(W.rules.push(B),this.logger.warn(`rule ${te} is not defined`))}function se(W){let{metaSchema:B}=W;B!==void 0&&(W.$data&&this.opts.$data&&(B=re(B)),W.validateSchema=this.compile(B,!0))}const X={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function re(W){return{anyOf:[W,X]}}})(cV);var mk={},yk={},gk={};Object.defineProperty(gk,"__esModule",{value:!0});const Mve={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};gk.default=Mve;var bp={};Object.defineProperty(bp,"__esModule",{value:!0});bp.callRef=bp.getValidate=void 0;const jve=Gy,S6=Zt,Rs=zt,dm=uc,T6=Ms,Ob=Ge,Uve={keyword:"$ref",schemaType:"string",code(t){const{gen:e,schema:r,it:n}=t,{baseId:s,schemaEnv:i,validateName:o,opts:a,self:u}=n,{root:l}=i;if((r==="#"||r==="#/")&&s===l.baseId)return d();const c=T6.resolveRef.call(u,l,s,r);if(c===void 0)throw new jve.default(n.opts.uriResolver,s,r);if(c instanceof T6.SchemaEnv)return h(c);return f(c);function d(){if(i===l)return M1(t,o,i,i.$async);const p=e.scopeValue("root",{ref:l});return M1(t,(0,Rs._)`${p}.validate`,l,l.$async)}function h(p){const m=YV(t,p);M1(t,m,p,p.$async)}function f(p){const m=e.scopeValue("schema",a.code.source===!0?{ref:p,code:(0,Rs.stringify)(p)}:{ref:p}),E=e.name("valid"),A=t.subschema({schema:p,dataTypes:[],schemaPath:Rs.nil,topSchemaRef:m,errSchemaPath:r},E);t.mergeEvaluated(A),t.ok(E)}}};function YV(t,e){const{gen:r}=t;return e.validate?r.scopeValue("validate",{ref:e.validate}):(0,Rs._)`${r.scopeValue("wrapper",{ref:e})}.validate`}bp.getValidate=YV;function M1(t,e,r,n){const{gen:s,it:i}=t,{allErrors:o,schemaEnv:a,opts:u}=i,l=u.passContext?dm.default.this:Rs.nil;n?c():d();function c(){if(!a.$async)throw new Error("async schema referenced by sync schema");const p=s.let("valid");s.try(()=>{s.code((0,Rs._)`await ${(0,S6.callValidateCode)(t,e,l)}`),f(e),o||s.assign(p,!0)},m=>{s.if((0,Rs._)`!(${m} instanceof ${i.ValidationError})`,()=>s.throw(m)),h(m),o||s.assign(p,!1)}),t.ok(p)}function d(){t.result((0,S6.callValidateCode)(t,e,l),()=>f(e),()=>h(e))}function h(p){const m=(0,Rs._)`${p}.errors`;s.assign(dm.default.vErrors,(0,Rs._)`${dm.default.vErrors} === null ? ${m} : ${dm.default.vErrors}.concat(${m})`),s.assign(dm.default.errors,(0,Rs._)`${dm.default.vErrors}.length`)}function f(p){var m;if(!i.opts.unevaluated)return;const E=(m=r==null?void 0:r.validate)===null||m===void 0?void 0:m.evaluated;if(i.props!==!0)if(E&&!E.dynamicProps)E.props!==void 0&&(i.props=Ob.mergeEvaluated.props(s,E.props,i.props));else{const A=s.var("props",(0,Rs._)`${p}.evaluated.props`);i.props=Ob.mergeEvaluated.props(s,A,i.props,Rs.Name)}if(i.items!==!0)if(E&&!E.dynamicItems)E.items!==void 0&&(i.items=Ob.mergeEvaluated.items(s,E.items,i.items));else{const A=s.var("items",(0,Rs._)`${p}.evaluated.items`);i.items=Ob.mergeEvaluated.items(s,A,i.items,Rs.Name)}}}bp.callRef=M1;bp.default=Uve;Object.defineProperty(yk,"__esModule",{value:!0});const Lve=gk,Kve=bp,Vve=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",Lve.default,Kve.default];yk.default=Vve;var vk={},wk={};Object.defineProperty(wk,"__esModule",{value:!0});const VE=zt,sd=VE.operators,qE={maximum:{okStr:"<=",ok:sd.LTE,fail:sd.GT},minimum:{okStr:">=",ok:sd.GTE,fail:sd.LT},exclusiveMaximum:{okStr:"<",ok:sd.LT,fail:sd.GTE},exclusiveMinimum:{okStr:">",ok:sd.GT,fail:sd.LTE}},qve={message:({keyword:t,schemaCode:e})=>(0,VE.str)`must be ${qE[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,VE._)`{comparison: ${qE[t].okStr}, limit: ${e}}`},Hve={keyword:Object.keys(qE),type:"number",schemaType:"number",$data:!0,error:qve,code(t){const{keyword:e,data:r,schemaCode:n}=t;t.fail$data((0,VE._)`${r} ${qE[e].fail} ${n} || isNaN(${r})`)}};wk.default=Hve;var _k={};Object.defineProperty(_k,"__esModule",{value:!0});const uv=zt,zve={message:({schemaCode:t})=>(0,uv.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,uv._)`{multipleOf: ${t}}`},Wve={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:zve,code(t){const{gen:e,data:r,schemaCode:n,it:s}=t,i=s.opts.multipleOfPrecision,o=e.let("res"),a=i?(0,uv._)`Math.abs(Math.round(${o}) - ${o}) > 1e-${i}`:(0,uv._)`${o} !== parseInt(${o})`;t.fail$data((0,uv._)`(${n} === 0 || (${o} = ${r}/${n}, ${a}))`)}};_k.default=Wve;var bk={},Ek={};Object.defineProperty(Ek,"__esModule",{value:!0});function ZV(t){const e=t.length;let r=0,n=0,s;for(;n<e;)r++,s=t.charCodeAt(n++),s>=55296&&s<=56319&&n<e&&(s=t.charCodeAt(n),(s&64512)===56320&&n++);return r}Ek.default=ZV;ZV.code='require("ajv/dist/runtime/ucs2length").default';Object.defineProperty(bk,"__esModule",{value:!0});const Ih=zt,Gve=Ge,Jve=Ek,Xve={message({keyword:t,schemaCode:e}){const r=t==="maxLength"?"more":"fewer";return(0,Ih.str)`must NOT have ${r} than ${e} characters`},params:({schemaCode:t})=>(0,Ih._)`{limit: ${t}}`},Yve={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:Xve,code(t){const{keyword:e,data:r,schemaCode:n,it:s}=t,i=e==="maxLength"?Ih.operators.GT:Ih.operators.LT,o=s.opts.unicode===!1?(0,Ih._)`${r}.length`:(0,Ih._)`${(0,Gve.useFunc)(t.gen,Jve.default)}(${r})`;t.fail$data((0,Ih._)`${o} ${i} ${n}`)}};bk.default=Yve;var Ak={};Object.defineProperty(Ak,"__esModule",{value:!0});const Zve=Zt,HE=zt,Qve={message:({schemaCode:t})=>(0,HE.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,HE._)`{pattern: ${t}}`},ewe={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:Qve,code(t){const{data:e,$data:r,schema:n,schemaCode:s,it:i}=t,o=i.opts.unicodeRegExp?"u":"",a=r?(0,HE._)`(new RegExp(${s}, ${o}))`:(0,Zve.usePattern)(t,n);t.fail$data((0,HE._)`!${a}.test(${e})`)}};Ak.default=ewe;var Sk={};Object.defineProperty(Sk,"__esModule",{value:!0});const cv=zt,twe={message({keyword:t,schemaCode:e}){const r=t==="maxProperties"?"more":"fewer";return(0,cv.str)`must NOT have ${r} than ${e} properties`},params:({schemaCode:t})=>(0,cv._)`{limit: ${t}}`},rwe={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:twe,code(t){const{keyword:e,data:r,schemaCode:n}=t,s=e==="maxProperties"?cv.operators.GT:cv.operators.LT;t.fail$data((0,cv._)`Object.keys(${r}).length ${s} ${n}`)}};Sk.default=rwe;var Tk={};Object.defineProperty(Tk,"__esModule",{value:!0});const o0=Zt,lv=zt,nwe=Ge,iwe={message:({params:{missingProperty:t}})=>(0,lv.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,lv._)`{missingProperty: ${t}}`},swe={keyword:"required",type:"object",schemaType:"array",$data:!0,error:iwe,code(t){const{gen:e,schema:r,schemaCode:n,data:s,$data:i,it:o}=t,{opts:a}=o;if(!i&&r.length===0)return;const u=r.length>=a.loopRequired;if(o.allErrors?l():c(),a.strictRequired){const f=t.parentSchema.properties,{definedProperties:p}=t.it;for(const m of r)if((f==null?void 0:f[m])===void 0&&!p.has(m)){const E=o.schemaEnv.baseId+o.errSchemaPath,A=`required property "${m}" is not defined at "${E}" (strictRequired)`;(0,nwe.checkStrictMode)(o,A,o.opts.strictRequired)}}function l(){if(u||i)t.block$data(lv.nil,d);else for(const f of r)(0,o0.checkReportMissingProp)(t,f)}function c(){const f=e.let("missing");if(u||i){const p=e.let("valid",!0);t.block$data(p,()=>h(f,p)),t.ok(p)}else e.if((0,o0.checkMissingProp)(t,r,f)),(0,o0.reportMissingProp)(t,f),e.else()}function d(){e.forOf("prop",n,f=>{t.setParams({missingProperty:f}),e.if((0,o0.noPropertyInData)(e,s,f,a.ownProperties),()=>t.error())})}function h(f,p){t.setParams({missingProperty:f}),e.forOf(f,n,()=>{e.assign(p,(0,o0.propertyInData)(e,s,f,a.ownProperties)),e.if((0,lv.not)(p),()=>{t.error(),e.break()})},lv.nil)}}};Tk.default=swe;var Dk={};Object.defineProperty(Dk,"__esModule",{value:!0});const dv=zt,owe={message({keyword:t,schemaCode:e}){const r=t==="maxItems"?"more":"fewer";return(0,dv.str)`must NOT have ${r} than ${e} items`},params:({schemaCode:t})=>(0,dv._)`{limit: ${t}}`},awe={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:owe,code(t){const{keyword:e,data:r,schemaCode:n}=t,s=e==="maxItems"?dv.operators.GT:dv.operators.LT;t.fail$data((0,dv._)`${r}.length ${s} ${n}`)}};Dk.default=awe;var xk={};Object.defineProperty(xk,"__esModule",{value:!0});const XT=Vn,Si=zt,uwe=Ge,cwe=Wy,lwe={message:({params:{i:t,j:e}})=>(0,Si.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,Si._)`{i: ${t}, j: ${e}}`},dwe={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:lwe,code(t){const{gen:e,data:r,$data:n,schema:s,parentSchema:i,schemaCode:o,it:a}=t;if(!n&&!s)return;const u=e.let("valid"),l=i.items?(0,XT.getSchemaTypes)(i.items):[];t.block$data(u,c,(0,Si._)`${o} === false`),t.ok(u);function c(){const p=e.let("i",(0,Si._)`${r}.length`),m=e.let("j");t.setParams({i:p,j:m}),e.assign(u,!0),e.if((0,Si._)`${p} > 1`,()=>(d()?h:f)(p,m))}function d(){return l.length>0&&!l.some(p=>p==="object"||p==="array")}function h(p,m){const E=e.name("item"),A=(0,XT.checkDataTypes)(l,E,a.opts.strictNumbers,XT.DataType.Wrong),_=e.const("indices",(0,Si._)`{}`);e.for((0,Si._)`;${p}--;`,()=>{e.let(E,(0,Si._)`${r}[${p}]`),e.if(A,(0,Si._)`continue`),l.length>1&&e.if((0,Si._)`typeof ${E} == "string"`,(0,Si._)`${E} += "_"`),e.if((0,Si._)`typeof ${_}[${E}] == "number"`,()=>{e.assign(m,(0,Si._)`${_}[${E}]`),t.error(),e.assign(u,!1).break()}).code((0,Si._)`${_}[${E}] = ${p}`)})}function f(p,m){const E=(0,uwe.useFunc)(e,cwe.default),A=e.name("outer");e.label(A).for((0,Si._)`;${p}--;`,()=>e.for((0,Si._)`${m} = ${p}; ${m}--;`,()=>e.if((0,Si._)`${E}(${r}[${p}], ${r}[${m}])`,()=>{t.error(),e.assign(u,!1).break(A)})))}}};xk.default=dwe;var Pk={};Object.defineProperty(Pk,"__esModule",{value:!0});const bP=zt,fwe=Ge,hwe=Wy,pwe={message:"must be equal to constant",params:({schemaCode:t})=>(0,bP._)`{allowedValue: ${t}}`},mwe={keyword:"const",$data:!0,error:pwe,code(t){const{gen:e,data:r,$data:n,schemaCode:s,schema:i}=t;n||i&&typeof i=="object"?t.fail$data((0,bP._)`!${(0,fwe.useFunc)(e,hwe.default)}(${r}, ${s})`):t.fail((0,bP._)`${i} !== ${r}`)}};Pk.default=mwe;var Ck={};Object.defineProperty(Ck,"__esModule",{value:!0});const M0=zt,ywe=Ge,gwe=Wy,vwe={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,M0._)`{allowedValues: ${t}}`},wwe={keyword:"enum",schemaType:"array",$data:!0,error:vwe,code(t){const{gen:e,data:r,$data:n,schema:s,schemaCode:i,it:o}=t;if(!n&&s.length===0)throw new Error("enum must have non-empty array");const a=s.length>=o.opts.loopEnum;let u;const l=()=>u??(u=(0,ywe.useFunc)(e,gwe.default));let c;if(a||n)c=e.let("valid"),t.block$data(c,d);else{if(!Array.isArray(s))throw new Error("ajv implementation error");const f=e.const("vSchema",i);c=(0,M0.or)(...s.map((p,m)=>h(f,m)))}t.pass(c);function d(){e.assign(c,!1),e.forOf("v",i,f=>e.if((0,M0._)`${l()}(${r}, ${f})`,()=>e.assign(c,!0).break()))}function h(f,p){const m=s[p];return typeof m=="object"&&m!==null?(0,M0._)`${l()}(${r}, ${f}[${p}])`:(0,M0._)`${r} === ${m}`}}};Ck.default=wwe;Object.defineProperty(vk,"__esModule",{value:!0});const _we=wk,bwe=_k,Ewe=bk,Awe=Ak,Swe=Sk,Twe=Tk,Dwe=Dk,xwe=xk,Pwe=Pk,Cwe=Ck,Iwe=[_we.default,bwe.default,Ewe.default,Awe.default,Swe.default,Twe.default,Dwe.default,xwe.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},Pwe.default,Cwe.default];vk.default=Iwe;var Ik={},Jy={};Object.defineProperty(Jy,"__esModule",{value:!0});Jy.validateAdditionalItems=void 0;const kh=zt,EP=Ge,kwe={message:({params:{len:t}})=>(0,kh.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,kh._)`{limit: ${t}}`},$we={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:kwe,code(t){const{parentSchema:e,it:r}=t,{items:n}=e;if(!Array.isArray(n)){(0,EP.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}QV(t,n)}};function QV(t,e){const{gen:r,schema:n,data:s,keyword:i,it:o}=t;o.items=!0;const a=r.const("len",(0,kh._)`${s}.length`);if(n===!1)t.setParams({len:e.length}),t.pass((0,kh._)`${a} <= ${e.length}`);else if(typeof n=="object"&&!(0,EP.alwaysValidSchema)(o,n)){const l=r.var("valid",(0,kh._)`${a} <= ${e.length}`);r.if((0,kh.not)(l),()=>u(l)),t.ok(l)}function u(l){r.forRange("i",e.length,a,c=>{t.subschema({keyword:i,dataProp:c,dataPropType:EP.Type.Num},l),o.allErrors||r.if((0,kh.not)(l),()=>r.break())})}}Jy.validateAdditionalItems=QV;Jy.default=$we;var kk={},Xy={};Object.defineProperty(Xy,"__esModule",{value:!0});Xy.validateTuple=void 0;const D6=zt,j1=Ge,Owe=Zt,Rwe={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){const{schema:e,it:r}=t;if(Array.isArray(e))return e7(t,"additionalItems",e);r.items=!0,!(0,j1.alwaysValidSchema)(r,e)&&t.ok((0,Owe.validateArray)(t))}};function e7(t,e,r=t.schema){const{gen:n,parentSchema:s,data:i,keyword:o,it:a}=t;c(s),a.opts.unevaluated&&r.length&&a.items!==!0&&(a.items=j1.mergeEvaluated.items(n,r.length,a.items));const u=n.name("valid"),l=n.const("len",(0,D6._)`${i}.length`);r.forEach((d,h)=>{(0,j1.alwaysValidSchema)(a,d)||(n.if((0,D6._)`${l} > ${h}`,()=>t.subschema({keyword:o,schemaProp:h,dataProp:h},u)),t.ok(u))});function c(d){const{opts:h,errSchemaPath:f}=a,p=r.length,m=p===d.minItems&&(p===d.maxItems||d[e]===!1);if(h.strictTuples&&!m){const E=`"${o}" is ${p}-tuple, but minItems or maxItems/${e} are not specified or different at path "${f}"`;(0,j1.checkStrictMode)(a,E,h.strictTuples)}}}Xy.validateTuple=e7;Xy.default=Rwe;Object.defineProperty(kk,"__esModule",{value:!0});const Nwe=Xy,Bwe={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,Nwe.validateTuple)(t,"items")};kk.default=Bwe;var $k={};Object.defineProperty($k,"__esModule",{value:!0});const x6=zt,Fwe=Ge,Mwe=Zt,jwe=Jy,Uwe={message:({params:{len:t}})=>(0,x6.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,x6._)`{limit: ${t}}`},Lwe={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:Uwe,code(t){const{schema:e,parentSchema:r,it:n}=t,{prefixItems:s}=r;n.items=!0,!(0,Fwe.alwaysValidSchema)(n,e)&&(s?(0,jwe.validateAdditionalItems)(t,s):t.ok((0,Mwe.validateArray)(t)))}};$k.default=Lwe;var Ok={};Object.defineProperty(Ok,"__esModule",{value:!0});const zo=zt,Rb=Ge,Kwe={message:({params:{min:t,max:e}})=>e===void 0?(0,zo.str)`must contain at least ${t} valid item(s)`:(0,zo.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,zo._)`{minContains: ${t}}`:(0,zo._)`{minContains: ${t}, maxContains: ${e}}`},Vwe={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:Kwe,code(t){const{gen:e,schema:r,parentSchema:n,data:s,it:i}=t;let o,a;const{minContains:u,maxContains:l}=n;i.opts.next?(o=u===void 0?1:u,a=l):o=1;const c=e.const("len",(0,zo._)`${s}.length`);if(t.setParams({min:o,max:a}),a===void 0&&o===0){(0,Rb.checkStrictMode)(i,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&o>a){(0,Rb.checkStrictMode)(i,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,Rb.alwaysValidSchema)(i,r)){let m=(0,zo._)`${c} >= ${o}`;a!==void 0&&(m=(0,zo._)`${m} && ${c} <= ${a}`),t.pass(m);return}i.items=!0;const d=e.name("valid");a===void 0&&o===1?f(d,()=>e.if(d,()=>e.break())):o===0?(e.let(d,!0),a!==void 0&&e.if((0,zo._)`${s}.length > 0`,h)):(e.let(d,!1),h()),t.result(d,()=>t.reset());function h(){const m=e.name("_valid"),E=e.let("count",0);f(m,()=>e.if(m,()=>p(E)))}function f(m,E){e.forRange("i",0,c,A=>{t.subschema({keyword:"contains",dataProp:A,dataPropType:Rb.Type.Num,compositeRule:!0},m),E()})}function p(m){e.code((0,zo._)`${m}++`),a===void 0?e.if((0,zo._)`${m} >= ${o}`,()=>e.assign(d,!0).break()):(e.if((0,zo._)`${m} > ${a}`,()=>e.assign(d,!1).break()),o===1?e.assign(d,!0):e.if((0,zo._)`${m} >= ${o}`,()=>e.assign(d,!0)))}}};Ok.default=Vwe;var t7={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.validateSchemaDeps=t.validatePropertyDeps=t.error=void 0;const e=zt,r=Ge,n=Zt;t.error={message:({params:{property:u,depsCount:l,deps:c}})=>{const d=l===1?"property":"properties";return(0,e.str)`must have ${d} ${c} when property ${u} is present`},params:({params:{property:u,depsCount:l,deps:c,missingProperty:d}})=>(0,e._)`{property: ${u},
    missingProperty: ${d},
    depsCount: ${l},
    deps: ${c}}`};const s={keyword:"dependencies",type:"object",schemaType:"object",error:t.error,code(u){const[l,c]=i(u);o(u,l),a(u,c)}};function i({schema:u}){const l={},c={};for(const d in u){if(d==="__proto__")continue;const h=Array.isArray(u[d])?l:c;h[d]=u[d]}return[l,c]}function o(u,l=u.schema){const{gen:c,data:d,it:h}=u;if(Object.keys(l).length===0)return;const f=c.let("missing");for(const p in l){const m=l[p];if(m.length===0)continue;const E=(0,n.propertyInData)(c,d,p,h.opts.ownProperties);u.setParams({property:p,depsCount:m.length,deps:m.join(", ")}),h.allErrors?c.if(E,()=>{for(const A of m)(0,n.checkReportMissingProp)(u,A)}):(c.if((0,e._)`${E} && (${(0,n.checkMissingProp)(u,m,f)})`),(0,n.reportMissingProp)(u,f),c.else())}}t.validatePropertyDeps=o;function a(u,l=u.schema){const{gen:c,data:d,keyword:h,it:f}=u,p=c.name("valid");for(const m in l)(0,r.alwaysValidSchema)(f,l[m])||(c.if((0,n.propertyInData)(c,d,m,f.opts.ownProperties),()=>{const E=u.subschema({keyword:h,schemaProp:m},p);u.mergeValidEvaluated(E,p)},()=>c.var(p,!0)),u.ok(p))}t.validateSchemaDeps=a,t.default=s})(t7);var Rk={};Object.defineProperty(Rk,"__esModule",{value:!0});const r7=zt,qwe=Ge,Hwe={message:"property name must be valid",params:({params:t})=>(0,r7._)`{propertyName: ${t.propertyName}}`},zwe={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:Hwe,code(t){const{gen:e,schema:r,data:n,it:s}=t;if((0,qwe.alwaysValidSchema)(s,r))return;const i=e.name("valid");e.forIn("key",n,o=>{t.setParams({propertyName:o}),t.subschema({keyword:"propertyNames",data:o,dataTypes:["string"],propertyName:o,compositeRule:!0},i),e.if((0,r7.not)(i),()=>{t.error(!0),s.allErrors||e.break()})}),t.ok(i)}};Rk.default=zwe;var AS={};Object.defineProperty(AS,"__esModule",{value:!0});const Nb=Zt,ba=zt,Wwe=uc,Bb=Ge,Gwe={message:"must NOT have additional properties",params:({params:t})=>(0,ba._)`{additionalProperty: ${t.additionalProperty}}`},Jwe={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:Gwe,code(t){const{gen:e,schema:r,parentSchema:n,data:s,errsCount:i,it:o}=t;if(!i)throw new Error("ajv implementation error");const{allErrors:a,opts:u}=o;if(o.props=!0,u.removeAdditional!=="all"&&(0,Bb.alwaysValidSchema)(o,r))return;const l=(0,Nb.allSchemaProperties)(n.properties),c=(0,Nb.allSchemaProperties)(n.patternProperties);d(),t.ok((0,ba._)`${i} === ${Wwe.default.errors}`);function d(){e.forIn("key",s,E=>{!l.length&&!c.length?p(E):e.if(h(E),()=>p(E))})}function h(E){let A;if(l.length>8){const _=(0,Bb.schemaRefOrVal)(o,n.properties,"properties");A=(0,Nb.isOwnProperty)(e,_,E)}else l.length?A=(0,ba.or)(...l.map(_=>(0,ba._)`${E} === ${_}`)):A=ba.nil;return c.length&&(A=(0,ba.or)(A,...c.map(_=>(0,ba._)`${(0,Nb.usePattern)(t,_)}.test(${E})`))),(0,ba.not)(A)}function f(E){e.code((0,ba._)`delete ${s}[${E}]`)}function p(E){if(u.removeAdditional==="all"||u.removeAdditional&&r===!1){f(E);return}if(r===!1){t.setParams({additionalProperty:E}),t.error(),a||e.break();return}if(typeof r=="object"&&!(0,Bb.alwaysValidSchema)(o,r)){const A=e.name("valid");u.removeAdditional==="failing"?(m(E,A,!1),e.if((0,ba.not)(A),()=>{t.reset(),f(E)})):(m(E,A),a||e.if((0,ba.not)(A),()=>e.break()))}}function m(E,A,_){const g={keyword:"additionalProperties",dataProp:E,dataPropType:Bb.Type.Str};_===!1&&Object.assign(g,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema(g,A)}}};AS.default=Jwe;var Nk={};Object.defineProperty(Nk,"__esModule",{value:!0});const Xwe=ja,P6=Zt,YT=Ge,C6=AS,Ywe={keyword:"properties",type:"object",schemaType:"object",code(t){const{gen:e,schema:r,parentSchema:n,data:s,it:i}=t;i.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&C6.default.code(new Xwe.KeywordCxt(i,C6.default,"additionalProperties"));const o=(0,P6.allSchemaProperties)(r);for(const d of o)i.definedProperties.add(d);i.opts.unevaluated&&o.length&&i.props!==!0&&(i.props=YT.mergeEvaluated.props(e,(0,YT.toHash)(o),i.props));const a=o.filter(d=>!(0,YT.alwaysValidSchema)(i,r[d]));if(a.length===0)return;const u=e.name("valid");for(const d of a)l(d)?c(d):(e.if((0,P6.propertyInData)(e,s,d,i.opts.ownProperties)),c(d),i.allErrors||e.else().var(u,!0),e.endIf()),t.it.definedProperties.add(d),t.ok(u);function l(d){return i.opts.useDefaults&&!i.compositeRule&&r[d].default!==void 0}function c(d){t.subschema({keyword:"properties",schemaProp:d,dataProp:d},u)}}};Nk.default=Ywe;var Bk={};Object.defineProperty(Bk,"__esModule",{value:!0});const I6=Zt,Fb=zt,k6=Ge,$6=Ge,Zwe={keyword:"patternProperties",type:"object",schemaType:"object",code(t){const{gen:e,schema:r,data:n,parentSchema:s,it:i}=t,{opts:o}=i,a=(0,I6.allSchemaProperties)(r),u=a.filter(m=>(0,k6.alwaysValidSchema)(i,r[m]));if(a.length===0||u.length===a.length&&(!i.opts.unevaluated||i.props===!0))return;const l=o.strictSchema&&!o.allowMatchingProperties&&s.properties,c=e.name("valid");i.props!==!0&&!(i.props instanceof Fb.Name)&&(i.props=(0,$6.evaluatedPropsToName)(e,i.props));const{props:d}=i;h();function h(){for(const m of a)l&&f(m),i.allErrors?p(m):(e.var(c,!0),p(m),e.if(c))}function f(m){for(const E in l)new RegExp(m).test(E)&&(0,k6.checkStrictMode)(i,`property ${E} matches pattern ${m} (use allowMatchingProperties)`)}function p(m){e.forIn("key",n,E=>{e.if((0,Fb._)`${(0,I6.usePattern)(t,m)}.test(${E})`,()=>{const A=u.includes(m);A||t.subschema({keyword:"patternProperties",schemaProp:m,dataProp:E,dataPropType:$6.Type.Str},c),i.opts.unevaluated&&d!==!0?e.assign((0,Fb._)`${d}[${E}]`,!0):!A&&!i.allErrors&&e.if((0,Fb.not)(c),()=>e.break())})})}}};Bk.default=Zwe;var Fk={};Object.defineProperty(Fk,"__esModule",{value:!0});const Qwe=Ge,e_e={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){const{gen:e,schema:r,it:n}=t;if((0,Qwe.alwaysValidSchema)(n,r)){t.fail();return}const s=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},s),t.failResult(s,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};Fk.default=e_e;var Mk={};Object.defineProperty(Mk,"__esModule",{value:!0});const t_e=Zt,r_e={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:t_e.validateUnion,error:{message:"must match a schema in anyOf"}};Mk.default=r_e;var jk={};Object.defineProperty(jk,"__esModule",{value:!0});const U1=zt,n_e=Ge,i_e={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,U1._)`{passingSchemas: ${t.passing}}`},s_e={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:i_e,code(t){const{gen:e,schema:r,parentSchema:n,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(s.opts.discriminator&&n.discriminator)return;const i=r,o=e.let("valid",!1),a=e.let("passing",null),u=e.name("_valid");t.setParams({passing:a}),e.block(l),t.result(o,()=>t.reset(),()=>t.error(!0));function l(){i.forEach((c,d)=>{let h;(0,n_e.alwaysValidSchema)(s,c)?e.var(u,!0):h=t.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},u),d>0&&e.if((0,U1._)`${u} && ${o}`).assign(o,!1).assign(a,(0,U1._)`[${a}, ${d}]`).else(),e.if(u,()=>{e.assign(o,!0),e.assign(a,d),h&&t.mergeEvaluated(h,U1.Name)})})}}};jk.default=s_e;var Uk={};Object.defineProperty(Uk,"__esModule",{value:!0});const o_e=Ge,a_e={keyword:"allOf",schemaType:"array",code(t){const{gen:e,schema:r,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");const s=e.name("valid");r.forEach((i,o)=>{if((0,o_e.alwaysValidSchema)(n,i))return;const a=t.subschema({keyword:"allOf",schemaProp:o},s);t.ok(s),t.mergeEvaluated(a)})}};Uk.default=a_e;var Lk={};Object.defineProperty(Lk,"__esModule",{value:!0});const zE=zt,n7=Ge,u_e={message:({params:t})=>(0,zE.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,zE._)`{failingKeyword: ${t.ifClause}}`},c_e={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:u_e,code(t){const{gen:e,parentSchema:r,it:n}=t;r.then===void 0&&r.else===void 0&&(0,n7.checkStrictMode)(n,'"if" without "then" and "else" is ignored');const s=O6(n,"then"),i=O6(n,"else");if(!s&&!i)return;const o=e.let("valid",!0),a=e.name("_valid");if(u(),t.reset(),s&&i){const c=e.let("ifClause");t.setParams({ifClause:c}),e.if(a,l("then",c),l("else",c))}else s?e.if(a,l("then")):e.if((0,zE.not)(a),l("else"));t.pass(o,()=>t.error(!0));function u(){const c=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(c)}function l(c,d){return()=>{const h=t.subschema({keyword:c},a);e.assign(o,a),t.mergeValidEvaluated(h,o),d?e.assign(d,(0,zE._)`${c}`):t.setParams({ifClause:c})}}}};function O6(t,e){const r=t.schema[e];return r!==void 0&&!(0,n7.alwaysValidSchema)(t,r)}Lk.default=c_e;var Kk={};Object.defineProperty(Kk,"__esModule",{value:!0});const l_e=Ge,d_e={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:r}){e.if===void 0&&(0,l_e.checkStrictMode)(r,`"${t}" without "if" is ignored`)}};Kk.default=d_e;Object.defineProperty(Ik,"__esModule",{value:!0});const f_e=Jy,h_e=kk,p_e=Xy,m_e=$k,y_e=Ok,g_e=t7,v_e=Rk,w_e=AS,__e=Nk,b_e=Bk,E_e=Fk,A_e=Mk,S_e=jk,T_e=Uk,D_e=Lk,x_e=Kk;function P_e(t=!1){const e=[E_e.default,A_e.default,S_e.default,T_e.default,D_e.default,x_e.default,v_e.default,w_e.default,g_e.default,__e.default,b_e.default];return t?e.push(h_e.default,m_e.default):e.push(f_e.default,p_e.default),e.push(y_e.default),e}Ik.default=P_e;var Vk={},qk={};Object.defineProperty(qk,"__esModule",{value:!0});const bn=zt,C_e={message:({schemaCode:t})=>(0,bn.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,bn._)`{format: ${t}}`},I_e={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:C_e,code(t,e){const{gen:r,data:n,$data:s,schema:i,schemaCode:o,it:a}=t,{opts:u,errSchemaPath:l,schemaEnv:c,self:d}=a;if(!u.validateFormats)return;s?h():f();function h(){const p=r.scopeValue("formats",{ref:d.formats,code:u.code.formats}),m=r.const("fDef",(0,bn._)`${p}[${o}]`),E=r.let("fType"),A=r.let("format");r.if((0,bn._)`typeof ${m} == "object" && !(${m} instanceof RegExp)`,()=>r.assign(E,(0,bn._)`${m}.type || "string"`).assign(A,(0,bn._)`${m}.validate`),()=>r.assign(E,(0,bn._)`"string"`).assign(A,m)),t.fail$data((0,bn.or)(_(),g()));function _(){return u.strictSchema===!1?bn.nil:(0,bn._)`${o} && !${A}`}function g(){const v=c.$async?(0,bn._)`(${m}.async ? await ${A}(${n}) : ${A}(${n}))`:(0,bn._)`${A}(${n})`,S=(0,bn._)`(typeof ${A} == "function" ? ${v} : ${A}.test(${n}))`;return(0,bn._)`${A} && ${A} !== true && ${E} === ${e} && !${S}`}}function f(){const p=d.formats[i];if(!p){_();return}if(p===!0)return;const[m,E,A]=g(p);m===e&&t.pass(v());function _(){if(u.strictSchema===!1){d.logger.warn(S());return}throw new Error(S());function S(){return`unknown format "${i}" ignored in schema at path "${l}"`}}function g(S){const x=S instanceof RegExp?(0,bn.regexpCode)(S):u.code.formats?(0,bn._)`${u.code.formats}${(0,bn.getProperty)(i)}`:void 0,D=r.scopeValue("formats",{key:i,ref:S,code:x});return typeof S=="object"&&!(S instanceof RegExp)?[S.type||"string",S.validate,(0,bn._)`${D}.validate`]:["string",S,D]}function v(){if(typeof p=="object"&&!(p instanceof RegExp)&&p.async){if(!c.$async)throw new Error("async format in sync schema");return(0,bn._)`await ${A}(${n})`}return typeof E=="function"?(0,bn._)`${A}(${n})`:(0,bn._)`${A}.test(${n})`}}}};qk.default=I_e;Object.defineProperty(Vk,"__esModule",{value:!0});const k_e=qk,$_e=[k_e.default];Vk.default=$_e;var Sy={};Object.defineProperty(Sy,"__esModule",{value:!0});Sy.contentVocabulary=Sy.metadataVocabulary=void 0;Sy.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];Sy.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"];Object.defineProperty(mk,"__esModule",{value:!0});const O_e=yk,R_e=vk,N_e=Ik,B_e=Vk,R6=Sy,F_e=[O_e.default,R_e.default,(0,N_e.default)(),B_e.default,R6.metadataVocabulary,R6.contentVocabulary];mk.default=F_e;var Hk={},SS={};Object.defineProperty(SS,"__esModule",{value:!0});SS.DiscrError=void 0;var N6;(function(t){t.Tag="tag",t.Mapping="mapping"})(N6||(SS.DiscrError=N6={}));Object.defineProperty(Hk,"__esModule",{value:!0});const xm=zt,AP=SS,B6=Ms,M_e=Gy,j_e=Ge,U_e={message:({params:{discrError:t,tagName:e}})=>t===AP.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:r}})=>(0,xm._)`{error: ${t}, tag: ${r}, tagValue: ${e}}`},L_e={keyword:"discriminator",type:"object",schemaType:"object",error:U_e,code(t){const{gen:e,data:r,schema:n,parentSchema:s,it:i}=t,{oneOf:o}=s;if(!i.opts.discriminator)throw new Error("discriminator: requires discriminator option");const a=n.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!o)throw new Error("discriminator: requires oneOf keyword");const u=e.let("valid",!1),l=e.const("tag",(0,xm._)`${r}${(0,xm.getProperty)(a)}`);e.if((0,xm._)`typeof ${l} == "string"`,()=>c(),()=>t.error(!1,{discrError:AP.DiscrError.Tag,tag:l,tagName:a})),t.ok(u);function c(){const f=h();e.if(!1);for(const p in f)e.elseIf((0,xm._)`${l} === ${p}`),e.assign(u,d(f[p]));e.else(),t.error(!1,{discrError:AP.DiscrError.Mapping,tag:l,tagName:a}),e.endIf()}function d(f){const p=e.name("valid"),m=t.subschema({keyword:"oneOf",schemaProp:f},p);return t.mergeEvaluated(m,xm.Name),p}function h(){var f;const p={},m=A(s);let E=!0;for(let v=0;v<o.length;v++){let S=o[v];if(S!=null&&S.$ref&&!(0,j_e.schemaHasRulesButRef)(S,i.self.RULES)){const D=S.$ref;if(S=B6.resolveRef.call(i.self,i.schemaEnv.root,i.baseId,D),S instanceof B6.SchemaEnv&&(S=S.schema),S===void 0)throw new M_e.default(i.opts.uriResolver,i.baseId,D)}const x=(f=S==null?void 0:S.properties)===null||f===void 0?void 0:f[a];if(typeof x!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);E=E&&(m||A(S)),_(x,v)}if(!E)throw new Error(`discriminator: "${a}" must be required`);return p;function A({required:v}){return Array.isArray(v)&&v.includes(a)}function _(v,S){if(v.const)g(v.const,S);else if(v.enum)for(const x of v.enum)g(x,S);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function g(v,S){if(typeof v!="string"||v in p)throw new Error(`discriminator: "${a}" values must be unique strings`);p[v]=S}}}};Hk.default=L_e;const K_e="http://json-schema.org/draft-07/schema#",V_e="http://json-schema.org/draft-07/schema#",q_e="Core schema meta-schema",H_e={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},z_e=["object","boolean"],W_e={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},G_e={$schema:K_e,$id:V_e,title:q_e,definitions:H_e,type:z_e,properties:W_e,default:!0};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.MissingRefError=e.ValidationError=e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=e.Ajv=void 0;const r=cV,n=mk,s=Hk,i=G_e,o=["/properties"],a="http://json-schema.org/draft-07/schema";class u extends r.default{_addVocabularies(){super._addVocabularies(),n.default.forEach(p=>this.addVocabulary(p)),this.opts.discriminator&&this.addKeyword(s.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const p=this.opts.$data?this.$dataMetaSchema(i,o):i;this.addMetaSchema(p,a,!1),this.refs["http://json-schema.org/schema"]=a}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(a)?a:void 0)}}e.Ajv=u,t.exports=e=u,t.exports.Ajv=u,Object.defineProperty(e,"__esModule",{value:!0}),e.default=u;var l=ja;Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return l.KeywordCxt}});var c=zt;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return c._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return c.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return c.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return c.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return c.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return c.CodeGen}});var d=Jw;Object.defineProperty(e,"ValidationError",{enumerable:!0,get:function(){return d.default}});var h=Gy;Object.defineProperty(e,"MissingRefError",{enumerable:!0,get:function(){return h.default}})})(mP,mP.exports);var i7=mP.exports;const J_e=nc(i7);var SP={exports:{}},s7={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.formatNames=t.fastFormats=t.fullFormats=void 0;function e(b,T){return{validate:b,compare:T}}t.fullFormats={date:e(i,o),time:e(u,l),"date-time":e(d,h),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:m,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:w,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:A,int32:{type:"number",validate:v},int64:{type:"number",validate:S},float:{type:"number",validate:x},double:{type:"number",validate:x},password:!0,binary:!0},t.fastFormats={...t.fullFormats,date:e(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,o),time:e(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,l),"date-time":e(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,h),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i},t.formatNames=Object.keys(t.fullFormats);function r(b){return b%4===0&&(b%100!==0||b%400===0)}const n=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,s=[0,31,28,31,30,31,30,31,31,30,31,30,31];function i(b){const T=n.exec(b);if(!T)return!1;const P=+T[1],C=+T[2],k=+T[3];return C>=1&&C<=12&&k>=1&&k<=(C===2&&r(P)?29:s[C])}function o(b,T){if(b&&T)return b>T?1:b<T?-1:0}const a=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i;function u(b,T){const P=a.exec(b);if(!P)return!1;const C=+P[1],k=+P[2],K=+P[3],L=P[5];return(C<=23&&k<=59&&K<=59||C===23&&k===59&&K===60)&&(!T||L!=="")}function l(b,T){if(!(b&&T))return;const P=a.exec(b),C=a.exec(T);if(P&&C)return b=P[1]+P[2]+P[3]+(P[4]||""),T=C[1]+C[2]+C[3]+(C[4]||""),b>T?1:b<T?-1:0}const c=/t|\s/i;function d(b){const T=b.split(c);return T.length===2&&i(T[0])&&u(T[1],!0)}function h(b,T){if(!(b&&T))return;const[P,C]=b.split(c),[k,K]=T.split(c),L=o(P,k);if(L!==void 0)return L||l(C,K)}const f=/\/|:/,p=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function m(b){return f.test(b)&&p.test(b)}const E=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function A(b){return E.lastIndex=0,E.test(b)}const _=-(2**31),g=2**31-1;function v(b){return Number.isInteger(b)&&b<=g&&b>=_}function S(b){return Number.isInteger(b)}function x(){return!0}const D=/[^\\]\\Z/;function w(b){if(D.test(b))return!1;try{return new RegExp(b),!0}catch{return!1}}})(s7);var o7={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.formatLimitDefinition=void 0;const e=i7,r=zt,n=r.operators,s={formatMaximum:{okStr:"<=",ok:n.LTE,fail:n.GT},formatMinimum:{okStr:">=",ok:n.GTE,fail:n.LT},formatExclusiveMaximum:{okStr:"<",ok:n.LT,fail:n.GTE},formatExclusiveMinimum:{okStr:">",ok:n.GT,fail:n.LTE}},i={message:({keyword:a,schemaCode:u})=>r.str`should be ${s[a].okStr} ${u}`,params:({keyword:a,schemaCode:u})=>r._`{comparison: ${s[a].okStr}, limit: ${u}}`};t.formatLimitDefinition={keyword:Object.keys(s),type:"string",schemaType:"string",$data:!0,error:i,code(a){const{gen:u,data:l,schemaCode:c,keyword:d,it:h}=a,{opts:f,self:p}=h;if(!f.validateFormats)return;const m=new e.KeywordCxt(h,p.RULES.all.format.definition,"format");m.$data?E():A();function E(){const g=u.scopeValue("formats",{ref:p.formats,code:f.code.formats}),v=u.const("fmt",r._`${g}[${m.schemaCode}]`);a.fail$data(r.or(r._`typeof ${v} != "object"`,r._`${v} instanceof RegExp`,r._`typeof ${v}.compare != "function"`,_(v)))}function A(){const g=m.schema,v=p.formats[g];if(!v||v===!0)return;if(typeof v!="object"||v instanceof RegExp||typeof v.compare!="function")throw new Error(`"${d}": format "${g}" does not define "compare" function`);const S=u.scopeValue("formats",{key:g,ref:v,code:f.code.formats?r._`${f.code.formats}${r.getProperty(g)}`:void 0});a.fail$data(_(S))}function _(g){return r._`${g}.compare(${l}, ${c}) ${s[d].fail} 0`}},dependencies:["format"]};const o=a=>(a.addKeyword(t.formatLimitDefinition),a);t.default=o})(o7);(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});const r=s7,n=o7,s=zt,i=new s.Name("fullFormats"),o=new s.Name("fastFormats"),a=(l,c={keywords:!0})=>{if(Array.isArray(c))return u(l,c,r.fullFormats,i),l;const[d,h]=c.mode==="fast"?[r.fastFormats,o]:[r.fullFormats,i],f=c.formats||r.formatNames;return u(l,f,d,h),c.keywords&&n.default(l),l};a.get=(l,c="full")=>{const h=(c==="fast"?r.fastFormats:r.fullFormats)[l];if(!h)throw new Error(`Unknown format "${l}"`);return h};function u(l,c,d,h){var f,p;(f=(p=l.opts.code).formats)!==null&&f!==void 0||(p.formats=s._`require("ajv-formats/dist/formats").${h}`);for(const m of c)l.addFormat(m,d[m])}t.exports=e=a,Object.defineProperty(e,"__esModule",{value:!0}),e.default=a})(SP,SP.exports);var X_e=SP.exports;const Y_e=nc(X_e);class Z_e extends ac{constructor(e){super(e)}getName(){return"FilterEvaluation"}handle(e,r){const n=vr.nodes(e,"$..fields[*]");r.forEach((s,i)=>{this.createNoFieldResults(e,i,s),n.forEach(o=>{let a=[];o.value.path&&(a=ia.extractInputField(s.credential,o.value.path));let u=!1;for(const l of a)if(this.evaluateFilter(l,o.value)){u=!0;const c={result:{...a[0]},valid:!0,format:s.format};this.getResults().push({...this.createResultObject(vr.stringify(o.path.slice(0,3)),i,c)})}if(!u)if(a.length){const l={result:{...a[0]},valid:!1,format:s.format};this.createResponse(o,i,l,On.INPUT_CANDIDATE_FAILED_FILTER_EVALUATION)}else{const l={valid:!1,format:s.format};this.createResponse(o,i,l,On.INPUT_CANDIDATE_DOESNT_CONTAIN_PROPERTY)}})}),this.updatePresentationSubmission(e)}createNoFieldResults(e,r,n){e.input_descriptors.map((i,o)=>({index:o,inDesc:i})).filter(i=>{var o,a,u;return((o=i.inDesc.constraints)==null?void 0:o.fields)===void 0||((u=(a=i.inDesc.constraints)==null?void 0:a.fields)==null?void 0:u.length)===0}).forEach(i=>{const o={result:[],valid:!0,format:n.format};this.getResults().push({...this.createResultObject(`$.input_descriptors[${i.index}]`,r,o)})})}createResponse(e,r,n,s){this.getResults().push({...this.createResultObject(vr.stringify(e.path.slice(0,3)),r,n),status:Be.ERROR,message:s})}createResultObject(e,r,n){return{input_descriptor_path:e,verifiable_credential_path:`$[${r}]`,evaluator:this.getName(),status:Be.INFO,message:On.INPUT_CANDIDATE_IS_ELIGIBLE_FOR_PRESENTATION_SUBMISSION,payload:n}}evaluateFilter(e,r){var s;(s=r.filter)!=null&&s.format&&r.filter.format==="date"&&this.transformDateFormat(e);const n=new J_e({verbose:!0,code:{source:!0,lines:!0,esm:!1},allowUnionTypes:!0,allErrors:!0,strict:!1});return Y_e(n),r.filter?n.validate(r.filter,e.value):!0}transformDateFormat(e){const r=new Date(e.value);let n=r.getUTCMonth()+1+"";n.length===1&&(n="0"+n);let s=r.getUTCDate()+"";s.length===1&&(s="0"+s),e.value=r.getUTCFullYear()+"-"+n+"-"+s,e.value=r.toISOString().substring(0,r.toISOString().indexOf("T"))}}var xr={},a7={},u7={};Object.defineProperty(u7,"__esModule",{value:!0});var c7={};Object.defineProperty(c7,"__esModule",{value:!0});var l7={};Object.defineProperty(l7,"__esModule",{value:!0});var d7={};Object.defineProperty(d7,"__esModule",{value:!0});var f7={};Object.defineProperty(f7,"__esModule",{value:!0});var h7={};Object.defineProperty(h7,"__esModule",{value:!0});var TS={};Object.defineProperty(TS,"__esModule",{value:!0});TS.Directives=void 0;TS.Directives={Required:"required",Allowed:"allowed",Disallowed:"disallowed"};var DS={};Object.defineProperty(DS,"__esModule",{value:!0});DS.ExchangeStatus=void 0;DS.ExchangeStatus={Created:"CREATED",Submitted:"SUBMITTED",HolderDeclined:"HOLDER_DECLINED",Expired:"EXPIRED",Accepted:"ACCEPTED",VerifierDeclined:"VERIFIER_DECLINED"};var p7={};Object.defineProperty(p7,"__esModule",{value:!0});var m7={};Object.defineProperty(m7,"__esModule",{value:!0});var y7={};Object.defineProperty(y7,"__esModule",{value:!0});var g7={};Object.defineProperty(g7,"__esModule",{value:!0});var v7={};Object.defineProperty(v7,"__esModule",{value:!0});var w7={};Object.defineProperty(w7,"__esModule",{value:!0});var _7={};Object.defineProperty(_7,"__esModule",{value:!0});var b7={};Object.defineProperty(b7,"__esModule",{value:!0});var E7={};Object.defineProperty(E7,"__esModule",{value:!0});var A7={};Object.defineProperty(A7,"__esModule",{value:!0});var S7={};Object.defineProperty(S7,"__esModule",{value:!0});var T7={};Object.defineProperty(T7,"__esModule",{value:!0});var D7={};Object.defineProperty(D7,"__esModule",{value:!0});var x7={};Object.defineProperty(x7,"__esModule",{value:!0});var P7={};Object.defineProperty(P7,"__esModule",{value:!0});var C7={};Object.defineProperty(C7,"__esModule",{value:!0});var I7={};Object.defineProperty(I7,"__esModule",{value:!0});var k7={};Object.defineProperty(k7,"__esModule",{value:!0});var xS={};Object.defineProperty(xS,"__esModule",{value:!0});xS.Optionality=void 0;xS.Optionality={Required:"required",Preferred:"preferred"};var $7={};Object.defineProperty($7,"__esModule",{value:!0});var O7={};Object.defineProperty(O7,"__esModule",{value:!0});var R7={};Object.defineProperty(R7,"__esModule",{value:!0});var N7={};Object.defineProperty(N7,"__esModule",{value:!0});var B7={};Object.defineProperty(B7,"__esModule",{value:!0});var F7={};Object.defineProperty(F7,"__esModule",{value:!0});var M7={};Object.defineProperty(M7,"__esModule",{value:!0});var j7={};Object.defineProperty(j7,"__esModule",{value:!0});var U7={};Object.defineProperty(U7,"__esModule",{value:!0});var PS={};Object.defineProperty(PS,"__esModule",{value:!0});PS.Rules=void 0;PS.Rules={All:"all",Pick:"pick"};var L7={};Object.defineProperty(L7,"__esModule",{value:!0});var K7={};Object.defineProperty(K7,"__esModule",{value:!0});var CS={};Object.defineProperty(CS,"__esModule",{value:!0});CS.Status=void 0;CS.Status={Success:"SUCCESS",Warn:"WARN",Error:"ERROR"};var V7={};Object.defineProperty(V7,"__esModule",{value:!0});var q7={};Object.defineProperty(q7,"__esModule",{value:!0});var H7={};Object.defineProperty(H7,"__esModule",{value:!0});var z7={};Object.defineProperty(z7,"__esModule",{value:!0});(function(t){var e=Ar&&Ar.__createBinding||(Object.create?function(n,s,i,o){o===void 0&&(o=i);var a=Object.getOwnPropertyDescriptor(s,i);(!a||("get"in a?!s.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return s[i]}}),Object.defineProperty(n,o,a)}:function(n,s,i,o){o===void 0&&(o=i),n[o]=s[i]}),r=Ar&&Ar.__exportStar||function(n,s){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(s,i)&&e(s,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(u7,t),r(c7,t),r(l7,t),r(d7,t),r(f7,t),r(h7,t),r(TS,t),r(DS,t),r(p7,t),r(m7,t),r(y7,t),r(g7,t),r(v7,t),r(w7,t),r(_7,t),r(b7,t),r(E7,t),r(A7,t),r(S7,t),r(T7,t),r(D7,t),r(x7,t),r(P7,t),r(C7,t),r(I7,t),r(k7,t),r(xS,t),r($7,t),r(O7,t),r(R7,t),r(N7,t),r(B7,t),r(F7,t),r(M7,t),r(j7,t),r(U7,t),r(PS,t),r(L7,t),r(K7,t),r(CS,t),r(V7,t),r(q7,t),r(H7,t),r(z7,t)})(a7);(function(t){var e=Ar&&Ar.__createBinding||(Object.create?function(n,s,i,o){o===void 0&&(o=i);var a=Object.getOwnPropertyDescriptor(s,i);(!a||("get"in a?!s.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return s[i]}}),Object.defineProperty(n,o,a)}:function(n,s,i,o){o===void 0&&(o=i),n[o]=s[i]}),r=Ar&&Ar.__exportStar||function(n,s){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(s,i)&&e(s,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(a7,t)})(xr);class Q_e extends ac{constructor(r){super(r);Se(this,"fieldIdzInputDescriptorsSameSubjectRequired");Se(this,"fieldIdzInputDescriptorsSameSubjectPreferred");Se(this,"fieldIds");Se(this,"isHolder");Se(this,"credentialsSubjectsByPath");Se(this,"credentialsByPath");Se(this,"messages");this.fieldIdzInputDescriptorsSameSubjectRequired=new Map,this.fieldIdzInputDescriptorsSameSubjectPreferred=new Map,this.isHolder=[],this.fieldIds=[],this.credentialsSubjectsByPath=new Map,this.credentialsByPath=new Map,this.messages=new Map,this.messages.set(Be.INFO,"The field ids requiring the subject to be the holder"),this.messages.set(Be.WARN,"The field ids preferring the subject to be the holder"),this.messages.set(Be.ERROR,"The field id missing")}getName(){return"IsHolderEvaluation"}handle(r,n){this.findIsHolderFieldIdsToInputDescriptorsSets(r),this.findAllCredentialSubjects(n),this.confirmAllFieldSetHasSameSubject(this.fieldIdzInputDescriptorsSameSubjectRequired,Be.INFO,xr.Optionality.Required),this.confirmAllFieldSetHasSameSubject(this.fieldIdzInputDescriptorsSameSubjectPreferred,Be.WARN,xr.Optionality.Preferred),this.updatePresentationSubmission(r)}findIsHolderFieldIdsToInputDescriptorsSets(r){var i;this.fieldIds.push(...vr.nodes(r,"$..fields[*].id")),this.isHolder.push(...vr.nodes(r,"$..is_holder[*]"));const n=(i=this.fieldIds)==null?void 0:i.map(o=>o.value),s=[];s.push(...this.evaluateFields(this.fieldIdzInputDescriptorsSameSubjectPreferred,this.isHolder,n,xr.Optionality.Preferred)),s.push(...this.evaluateFields(this.fieldIdzInputDescriptorsSameSubjectRequired,this.isHolder,n,xr.Optionality.Required)),s.forEach(o=>this.getResults().push(this.createResult(o[1],o[0],["",{}],Be.ERROR,void 0)))}evaluateFields(r,n,s,i){const o=[];return n.filter(a=>a.value.directive===i).filter(a=>a.value.field_id.every(u=>s.includes(u))).forEach(a=>r.set(vr.stringify(a.path.slice(0,3)),a.value.field_id)),n.filter(a=>a.value.directive===i).filter(a=>!a.value.field_id.every(u=>s.includes(u))).forEach(a=>o.push([vr.stringify(a.path.slice(0,3)),a.value.field_id])),o}findAllCredentialSubjects(r){const n=vr.nodes(r.map(s=>s.credential),"$..credentialSubject");for(let s=0;s<n.length;s++){const i=n[s],o=vr.stringify(i.path.slice(0,2));this.credentialsSubjectsByPath.set(o,i.value),this.credentialsByPath.set(o,r[s])}}confirmAllFieldSetHasSameSubject(r,n,s){const i=Array.from(r).flatMap(l=>Array.from(this.credentialsSubjectsByPath).filter(c=>l[1].find(d=>Object.keys(c[1]).includes(d)))),o=this.mapCredentialPathsToInputDescriptors(s),a=Array.from(i).flatMap(l=>Object.keys(l[1]).filter(c=>c!=="id")),u=Array.from(r.values()).flatMap(l=>l.every(c=>a.includes(c)))[0];i.forEach(l=>{const c=o.get(l[0]);u&&l[1].id&&this.client.dids.includes(l[1].id)?this.getResults().push(this.createResult(Object.keys(l[1]).filter(d=>d!=="id"),c,l,n,this.credentialsByPath.get(l[0]))):this.getResults().push(this.createResult(Object.keys(l[1]).filter(d=>d!=="id"),c,l,Be.ERROR,this.credentialsByPath.get(l[0])))})}mapCredentialPathsToInputDescriptors(r){var s;const n=new Map;return(s=this.fieldIds)==null||s.forEach(i=>{const o=vr.stringify(i.path.slice(0,3));this.credentialsSubjectsByPath.forEach((a,u)=>{const l=this.isHolder.find(c=>vr.stringify(c.path.slice(0,3))===o);Object.keys(a).includes(i.value)&&(l==null?void 0:l.value.directive)===r&&n.set(u,o)})}),n}createResult(r,n,s,i,o,a){return{input_descriptor_path:n,verifiable_credential_path:s[0],evaluator:this.getName(),status:i,payload:{fieldIdSet:r,credentialSubject:s[1],...o?{format:o.format}:{}},message:a??this.messages.get(i)}}}class ebe extends ac{constructor(e){super(e)}getName(){return"LimitDisclosureEvaluation"}handle(e,r){e.input_descriptors.forEach((n,s)=>{var i,o,a;(i=n.constraints)!=null&&i.fields&&(((o=n.constraints)==null?void 0:o.limit_disclosure)===xr.Optionality.Required||((a=n.constraints)==null?void 0:a.limit_disclosure)===xr.Optionality.Preferred)&&this.evaluateLimitDisclosure(r,n.constraints,s)})}isLimitDisclosureSupported(e,r,n,s){const i=this.client.limitDisclosureSignatureSuites,o=e.decoded.proof;return!o||Array.isArray(o)||!o.type?!1:i!=null&&i.includes(o.type)?!0:(s==xr.Optionality.Required&&this.createLimitDisclosureNotSupportedResult(n,r),!1)}evaluateLimitDisclosure(e,r,n){const s=r==null?void 0:r.fields,i=r.limit_disclosure;e.forEach((o,a)=>{i&&this.isLimitDisclosureSupported(o,a,n,i)&&this.enforceLimitDisclosure(o.credential,s,n,a,e,i)})}enforceLimitDisclosure(e,r,n,s,i,o){const a=this.createVcWithRequiredFields(e,r,n,s);a&&(i[s].credential=a,this.createSuccessResult(n,`$[${s}]`,o))}createVcWithRequiredFields(e,r,n,s){let i={};i=Object.assign(i,e),i.credentialSubject={};for(const o of r)if(o.path){const a=ia.extractInputField(e,o.path);if(a.length>0)i=this.copyResultPathToDestinationCredential(a[0],e,i);else{this.createMandatoryFieldNotFoundResult(n,s,o.path);return}}return i}copyResultPathToDestinationCredential(e,r,n){let s={...r.credentialSubject};return e.path.forEach(i=>{s[i]&&(s={[i]:s[i]})}),n.credentialSubject={...n.credentialSubject,...s},n}createSuccessResult(e,r,n){return this.getResults().push({input_descriptor_path:`$.input_descriptors[${e}]`,verifiable_credential_path:`${r}`,evaluator:this.getName(),status:n===xr.Optionality.Required?Be.INFO:Be.WARN,message:On.LIMIT_DISCLOSURE_APPLIED,payload:void 0})}createMandatoryFieldNotFoundResult(e,r,n){return this.getResults().push({input_descriptor_path:`$.input_descriptors[${e}]`,verifiable_credential_path:`$[${r}]`,evaluator:this.getName(),status:Be.ERROR,message:On.VERIFIABLE_CREDENTIAL_MANDATORY_FIELD_NOT_PRESENT,payload:n})}createLimitDisclosureNotSupportedResult(e,r){return this.getResults().push({input_descriptor_path:`$.input_descriptors[${e}]`,verifiable_credential_path:`$[${r}]`,evaluator:this.getName(),status:Be.ERROR,message:On.LIMIT_DISCLOSURE_NOT_SUPPORTED})}}class tbe extends ac{constructor(e){super(e)}getName(){return"MarkForSubmissionEvaluation"}handle(e,r){const n=[...this.getResults()],s=n.filter(o=>o.status===Be.ERROR),i=this.retrieveNoErrorStatus(n,s);this.client.wrappedVcs=r,this.produceErrorResults(s),this.produceSuccessResults(i,e)}retrieveNoErrorStatus(e,r){return e.filter(s=>s.status!==Be.ERROR).filter(s=>!r.find(i=>s.input_descriptor_path===i.input_descriptor_path&&s.verifiable_credential_path===i.verifiable_credential_path))}produceSuccessResults(e,r){this.removeDuplicate(e).forEach(n=>{const i=vr.nodes(r,n.input_descriptor_path)[0].value.group;this.getResults().push({input_descriptor_path:n.input_descriptor_path,verifiable_credential_path:n.verifiable_credential_path,evaluator:this.getName(),status:Be.INFO,payload:{group:i},message:On.INPUT_CANDIDATE_IS_ELIGIBLE_FOR_PRESENTATION_SUBMISSION})})}produceErrorResults(e){this.removeDuplicate(e).forEach(r=>{const n={...r.payload};n.evaluator=r.evaluator,this.getResults().push({...r,evaluator:this.getName(),message:On.INPUT_CANDIDATE_IS_NOT_ELIGIBLE_FOR_PRESENTATION_SUBMISSION,payload:n})})}}class rbe extends ac{constructor(e){super(e)}getName(){return"PredicateRelatedFieldEvaluation"}handle(e){e.input_descriptors.forEach((r,n)=>{r.constraints&&this.examinePredicateRelatedField(n,r.constraints)})}examinePredicateRelatedField(e,r){if(r!=null&&r.fields)for(let n=0;n<r.fields.length;n++)for(let s=0;s<this.getResults().length;s++)this.examinePredicateForFilterEvaluationResult(this.getResults(),s,e,r,n)}examinePredicateForFilterEvaluationResult(e,r,n,s,i){var a;const o=this.retrieveResultInputDescriptorIdx(e[r].input_descriptor_path);if(e[r].payload&&e[r].payload.result&&e[r].payload.result.path&&e[r].evaluator==="FilterEvaluation"&&n===o&&s&&s.fields&&s.fields[i]&&s.fields[i].predicate&&s.fields[i].path&&((a=s.fields[i].path)!=null&&a.includes(this.concatenatePath(e[r].payload.result.path)))){const u={...e[r].payload.result},l=this.createResultObject(n,r,u,e);s.fields[i].predicate===xr.Optionality.Required||(l.payload.value=!0),e.push(l)}}retrieveResultInputDescriptorIdx(e){const r="$.input_descriptors[",n=e.indexOf(r),s=e.substring(n+r.length),i=s.indexOf("]"),o=s.substring(0,i);return parseInt(o)}concatenatePath(e){let r="";for(let n=0;n<e.length;n++)typeof e[n]=="number"?(r=r.substring(0,r.length-1),r+="[*]."):r+=e[n]+".";return r.substring(0,r.length-1)}createResultObject(e,r,n,s){return{input_descriptor_path:`$.input_descriptors[${e}]`,verifiable_credential_path:s[r].verifiable_credential_path,evaluator:this.getName(),status:Be.INFO,message:On.INPUT_CANDIDATE_IS_ELIGIBLE_FOR_PRESENTATION_SUBMISSION,payload:n}}}class nbe extends ac{constructor(r){super(r);Se(this,"fieldIds");Se(this,"sameSubject");Se(this,"messages");this.fieldIds=[],this.sameSubject=[],this.messages=new Map,this.messages.set(Be.INFO,"The field ids requiring the same subject to belong to same subject"),this.messages.set(Be.WARN,"The field ids preferring the same subject to belong to same subject"),this.messages.set(Be.ERROR,"The fields ids not belong to the same subject")}getName(){return"SameSubjectEvaluation"}handle(r,n){const s=this.mapSameSubjectFieldIdsToInputDescriptors(r),i=this.mapCredentialsToResultObjecs(n,s),o=this.countSameSubjectOccurrences(s,i);this.generateErrorResults(o,i),this.updatePresentationSubmission(r)}mapSameSubjectFieldIdsToInputDescriptors(r){this.fieldIds.push(...vr.nodes(r,"$..fields[*].id")),this.sameSubject.push(...vr.nodes(r,"$..same_subject[*]"));const n=[];return this.fieldIds.forEach(s=>{const i=this.sameSubject.find(o=>o.value.field_id.includes(s.value));i&&n.push([s,i])}),n}generateErrorResults(r,n){r.forEach((s,i)=>{const o=n.filter(a=>i===a.payload.fieldIdSet).map(a=>a.payload.credentialSubject.id);(o.length!==s||new Set(o).size!==1)&&n.forEach((a,u,l)=>{a.payload.fieldIdSet===i&&(a.status=Be.ERROR,a.message=this.messages.get(Be.ERROR),l[u]=a)})}),this.client.results.push(...n)}countSameSubjectOccurrences(r,n){const s=new Map;return r.forEach(i=>{n.filter(a=>i[1].value.field_id===a.payload.fieldIdSet)&&(s.has(i[1].value.field_id)&&s.get(i[1].value.field_id)?s.set(i[1].value.field_id,s.get(i[1].value.field_id)+1):s.set(i[1].value.field_id,1))}),s}mapCredentialsToResultObjecs(r,n){const s=[...vr.nodes(r.map(o=>o.credential),"$..credentialSubject")],i=[];return s.forEach(o=>{const a=n.find(u=>vr.query(o.value,`$..${u[0].value}`).length!==0);a&&a[1].value.directive===xr.Optionality.Required?i.push({input_descriptor_path:vr.stringify(a[0].path.slice(0,3)),status:Be.INFO,evaluator:this.getName(),payload:{fieldIdSet:a[1].value.field_id,credentialSubject:o.value},message:this.messages.get(Be.INFO),verifiable_credential_path:vr.stringify(o.path.slice(0,2))}):a&&a[1].value.directive===xr.Optionality.Preferred&&i.push({input_descriptor_path:vr.stringify(a[0].path.slice(0,3)),status:Be.WARN,evaluator:this.getName(),payload:{fieldIdSet:a[1].value.field_id,credentialSubject:o.value},message:this.messages.get(Be.WARN),verifiable_credential_path:vr.stringify(o.path.slice(0,2))})}),i}}class ibe extends ac{constructor(e){super(e)}getName(){return"SubjectIsIssuerEvaluation"}handle(e,r){e.input_descriptors.forEach((n,s)=>{const i=n.constraints;(i==null?void 0:i.subject_is_issuer)===xr.Optionality.Required?this.checkSubjectIsIssuer(n.id,r,s):this.getResults().push(...r.map((o,a)=>this.generateSuccessResult(s,`$[${a}]`,o,"not applicable")))}),this.updatePresentationSubmission(e)}checkSubjectIsIssuer(e,r,n){this.client.presentationSubmission.descriptor_map.forEach(s=>{if(s.id===e){const i=ia.extractInputField(r.map(o=>o.credential),[s.path]);for(const o of i){const a=ige(o.value);o&&o.value&&nge(o.value).every(u=>u===a)?this.getResults().push(this.generateSuccessResult(n,s.path,Ey.CredentialMapper.toWrappedVerifiableCredential(o.value))):this.getResults().push(this.generateErrorResult(n,s.path,Ey.CredentialMapper.toWrappedVerifiableCredential(o.value)))}}})}generateErrorResult(e,r,n){return{input_descriptor_path:`$.input_descriptors[${e}]`,evaluator:this.getName(),status:Be.ERROR,message:On.SUBJECT_IS_NOT_ISSUER,verifiable_credential_path:r,payload:{format:n.format}}}generateSuccessResult(e,r,n,s){return{input_descriptor_path:`$.input_descriptors[${e}]`,evaluator:this.getName(),status:Be.INFO,message:s??On.SUBJECT_IS_ISSUER,verifiable_credential_path:r,payload:{format:n.format}}}}let sbe=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,r)=>(r&=63,r<36?e+=r.toString(36):r<62?e+=(r-26).toString(36).toUpperCase():r>62?e+="-":e+="_",e),"");const Lc=class Lc extends ac{constructor(e){super(e)}getName(){return"UriEvaluation"}handle(e,r){e.input_descriptors.forEach((s,i)=>{const o=e.getVersion()!==Ma.v2?s.schema.map(a=>a.uri):[];r.forEach((a,u)=>{const l=Lc.buildVcContextAndSchemaUris(a.credential,e.getVersion());this.evaluateUris(a,l,o,i,u,e.getVersion())})});const n=this.getResults().filter(s=>s.status===Be.INFO).map(s=>{var o;return{id:vr.nodes(e,s.input_descriptor_path)[0].value.id,format:(o=s.payload)==null?void 0:o.format,path:s.verifiable_credential_path}});this.client.generatePresentationSubmission&&(!this.presentationSubmission||Object.keys(this.presentationSubmission).length===0)&&(this.presentationSubmission={id:sbe(),definition_id:e.id,descriptor_map:n})}evaluateUris(e,r,n,s,i,o){let a=!1;if(o===Ma.v1){for(let u=0;u<n.length;u++)Lc.containsHashlink(n[u])&&this.getResults().push(this.createWarnResultObject(s,i));for(let u=0;u<r.length;u++)n.find(l=>l===r[u])!=null&&(a=!0)}else a=!0;a?this.getResults().push(this.createSuccessResultObject(e,n,s,i)):this.getResults().push(this.createErrorResultObject(e,n,s,i))}static buildVcContextAndSchemaUris(e,r){const n=[];return Array.isArray(e["@context"])?e["@context"].forEach(s=>n.push(s)):n.push(e["@context"]),Array.isArray(e.credentialSchema)&&e.credentialSchema.length>0?e.credentialSchema.forEach(s=>n.push(s.id)):e.credentialSchema&&n.push(e.credentialSchema.id),r===Ma.v1&&(Array.isArray(e.type)?e.type.forEach(s=>n.push(s)):e.type&&n.push(e.type)),n}createSuccessResultObject(e,r,n,s){const i=this.createResult(n,s);return i.status=Be.INFO,i.message=On.URI_EVALUATION_PASSED,i.payload={format:e.format,vcContext:e.credential["@context"],vcCredentialSchema:e.credential.credentialSchema,inputDescriptorsUris:r},i}createErrorResultObject(e,r,n,s){const i=this.createResult(n,s);return i.status=Be.ERROR,i.message=On.URI_EVALUATION_DIDNT_PASS,i.payload={format:e.format,vcContext:e.credential["@context"],vcCredentialSchema:e.credential.credentialSchema,inputDescriptorsUris:r},i}createWarnResultObject(e,r){const n=this.createResult(e,r);return n.status=Be.WARN,n.message=On.URI_EVALUATION_DIDNT_PASS,n.payload=On.INPUT_DESCRIPTOR_CONTEXT_CONTAINS_HASHLINK_VERIFICATION_NOT_SUPPORTED,n}createResult(e,r){return{input_descriptor_path:`$.input_descriptors[${e}]`,verifiable_credential_path:`$[${r}]`,evaluator:this.getName(),status:Be.INFO,message:void 0}}static containsHashlink(e){return!(this.matchAll(e,Lc.HASHLINK_QUERY_URL_REGEX).next().done&&this.matchAll(e,Lc.HASHLINK_URL_ENCODED_REGEX).next().done)}};Se(Lc,"matchAll",require("string.prototype.matchall")),Se(Lc,"HASHLINK_URL_ENCODED_REGEX",/hl:[a-zA-Z0-9]+:[a-zA-Z0-9]+/g),Se(Lc,"HASHLINK_QUERY_URL_REGEX",/https*?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&/=]*)(hl=[a-zA-Z0-9]+)/g);let TP=Lc;class obe extends ac{constructor(e){super(e)}getName(){return"FormatRestrictionEvaluation"}handle(e,r){e.input_descriptors.forEach((n,s)=>{r.forEach((i,o)=>{!this.client.restrictToFormats||Object.keys(this.client.restrictToFormats).includes(i.format)?this.getResults().push(this.generateSuccessResult(s,`$[${o}]`,i,`${i.format} is allowed`)):this.getResults().push(this.generateErrorResult(s,`$[${o}]`,i))})}),this.updatePresentationSubmission(e)}generateErrorResult(e,r,n){return{input_descriptor_path:`$.input_descriptors[${e}]`,evaluator:this.getName(),status:Be.ERROR,message:On.FORMAT_RESTRICTION_DIDNT_PASS,verifiable_credential_path:r,payload:{format:n.format}}}generateSuccessResult(e,r,n,s){return{input_descriptor_path:`$.input_descriptors[${e}]`,evaluator:this.getName(),status:Be.INFO,message:s??On.FORMAT_RESTRICTION_PASSED,verifiable_credential_path:r,payload:{format:n.format}}}}class abe extends ac{constructor(e){super(e)}getName(){return"DIDRestrictionEvaluation"}handle(e,r){e.input_descriptors.forEach((n,s)=>{r.forEach((i,o)=>{const a=typeof i.credential.issuer=="object"?i.credential.issuer.id:i.credential.issuer;!this.client.hasRestrictToDIDMethods()||!a||sge(a,this.client.restrictToDIDMethods)||!a.toLowerCase().startsWith("did:")?this.getResults().push(this.generateSuccessResult(s,`$[${o}]`,i,`${a} is allowed`)):this.getResults().push(this.generateErrorResult(s,`$[${o}]`,i))})}),this.updatePresentationSubmission(e)}generateErrorResult(e,r,n){return{input_descriptor_path:`$.input_descriptors[${e}]`,evaluator:this.getName(),status:Be.ERROR,message:On.FORMAT_RESTRICTION_DIDNT_PASS,verifiable_credential_path:r,payload:{format:n.format}}}generateSuccessResult(e,r,n,s){return{input_descriptor_path:`$.input_descriptors[${e}]`,evaluator:this.getName(),status:Be.INFO,message:s??On.FORMAT_RESTRICTION_PASSED,verifiable_credential_path:r,payload:{format:n.format}}}}const F6=[Ey.IProofType.BbsBlsSignatureProof2020];class ube{constructor(){Se(this,"failed_catched",{tag:"root",status:Be.ERROR,message:On.UNKNOWN_EXCEPTION,stacktrace:""});Se(this,"_results");Se(this,"_wrappedVcs");Se(this,"_presentationSubmission");Se(this,"_dids");Se(this,"_limitDisclosureSignatureSuites");Se(this,"_restrictToFormats");Se(this,"_restrictToDIDMethods");Se(this,"_generatePresentationSubmission");this._results=[],this._wrappedVcs=[],this._presentationSubmission={},this._dids=[],this._limitDisclosureSignatureSuites=F6,this._restrictToDIDMethods=[],this._generatePresentationSubmission=!0}evaluate(e,r,n){this._restrictToDIDMethods=n!=null&&n.restrictToDIDMethods?LE(n==null?void 0:n.restrictToDIDMethods):[],this._dids=n!=null&&n.holderDIDs?oge(n.holderDIDs,this._restrictToDIDMethods):[],this._limitDisclosureSignatureSuites=n==null?void 0:n.limitDisclosureSignatureSuites,this._restrictToFormats=n==null?void 0:n.restrictToFormats,this._generatePresentationSubmission=(n==null?void 0:n.generatePresentationSubmission)!==void 0?n.generatePresentationSubmission:!0,n!=null&&n.presentationSubmission&&(this._presentationSubmission=n.presentationSubmission);let s=this.initEvaluationHandlers();for(s==null||s.handle(e,r);s!=null&&s.hasNext();){s=s.getNext();try{s==null||s.handle(e,r)}catch(i){throw this.failed_catched.message+=i.message,this.failed_catched.stacktrace=i,this.failed_catched}}}get results(){return this._results}get dids(){return this._dids}set dids(e){this._dids=e}assertPresentationSubmission(){if(!this.generatePresentationSubmission&&(!this.presentationSubmission||Object.keys(this.presentationSubmission).length===0))throw Error("No presentation submission present, but required option was set")}get generatePresentationSubmission(){return this._generatePresentationSubmission}set generatePresentationSubmission(e){this._generatePresentationSubmission=e}get presentationSubmission(){return this._presentationSubmission}set presentationSubmission(e){this._presentationSubmission=e}get wrappedVcs(){return this._wrappedVcs}set wrappedVcs(e){this._wrappedVcs=e}get limitDisclosureSignatureSuites(){return this._limitDisclosureSignatureSuites||F6}set limitDisclosureSignatureSuites(e){this._limitDisclosureSignatureSuites=e}get restrictToDIDMethods(){return this._restrictToDIDMethods}set restrictToDIDMethods(e){this._restrictToDIDMethods=LE(e)}hasRestrictToDIDMethods(){return this.restrictToDIDMethods&&this.restrictToDIDMethods.length>0}get restrictToFormats(){return this._restrictToFormats}set restrictToFormats(e){this._restrictToFormats=e}initEvaluationHandlers(){const e=new TP(this);return e.setNext(new abe(this)).setNext(new obe(this)).setNext(new Z_e(this)).setNext(new rbe(this)).setNext(new ebe(this)).setNext(new ibe(this)).setNext(new Q_e(this)).setNext(new nbe(this)).setNext(new tbe(this)),e}}class a0{constructor(){Se(this,"_client");this._client=new ube}getEvaluationClient(){return this._client}selectFrom(e,r,n){var a;let s;this._client.evaluate(e,r,n);const i=[...this.formatNotInfo(Be.WARN)],o=[...this.formatNotInfo(Be.ERROR)];if(e.submission_requirements){const u=this._client.results.filter(p=>p.evaluator==="MarkForSubmissionEvaluation"&&p.payload.group&&p.status!==Be.ERROR),l=Array.from(new Set(u));let c;try{c=this.matchSubmissionRequirements(e,e.submission_requirements,l)}catch(p){const m={status:Be.ERROR,message:JSON.stringify(p),tag:"matchSubmissionRequirements"};return{errors:o?[...o,m]:[m],warnings:i,areRequiredCredentialsPresent:Be.ERROR}}const h=this.extractMatches(c).map(p=>vr.nodes(this._client.wrappedVcs.map(m=>m.original),p)[0].value),f=this.determineAreRequiredCredentialsPresent(e,c);s={errors:f===Be.INFO?[]:o,matches:[...c],areRequiredCredentialsPresent:f,verifiableCredential:h,warnings:i}}else{const u=this._client.results.filter(c=>c.evaluator==="MarkForSubmissionEvaluation"&&c.status!==Be.ERROR);if(this.checkWithoutSubmissionRequirements(u,e).length)return{errors:o,matches:[],areRequiredCredentialsPresent:Be.ERROR,verifiableCredential:r.map(c=>c.original),warnings:i};{const c=this.matchWithoutSubmissionRequirements(u,e),h=this.extractMatches(c).map(f=>vr.nodes(this._client.wrappedVcs.map(p=>p.original),f)[0].value);s={errors:[],matches:[...c],areRequiredCredentialsPresent:Be.INFO,verifiableCredential:h,warnings:i}}}return this.fillSelectableCredentialsToVerifiableCredentialsMapping(s,r),s.areRequiredCredentialsPresent=this.determineAreRequiredCredentialsPresent(e,s==null?void 0:s.matches),this.remapMatches(r.map(u=>u.original),s.matches,s==null?void 0:s.verifiableCredential),(a=s.matches)==null||a.forEach(u=>{this.updateSubmissionRequirementMatchPathToAlias(u,"verifiableCredential")}),s.areRequiredCredentialsPresent===Be.INFO?s.errors=[]:(s.errors=o,s.warnings=i,s.verifiableCredential=r.map(u=>u.original)),s}remapMatches(e,r,n){r==null||r.forEach(s=>{s.from_nested?this.remapMatches(e,s.from_nested,n):(s.vc_path.forEach((i,o,a)=>{const u=vr.query(e,i)[0],l=n==null?void 0:n.findIndex(c=>JSON.stringify(c)===JSON.stringify(u));if(l===-1)throw new Error(`The index of the VerifiableCredential in your current call can't be found in your previously submitted credentials. Are you trying to send a new Credential?
verifiableCredential: ${u}`);a[o]=`$[${l}]`}),s.name)})}extractMatches(e){const r=[];return e.forEach(n=>{r.push(...n.vc_path),n.from_nested&&r.push(...this.extractMatches(n.from_nested))}),Array.from(new Set(r))}checkWithoutSubmissionRequirements(e,r){const n=[];if(!r.input_descriptors)return[];if(!e.length)return[{input_descriptor_path:"",evaluator:"checkWithoutSubmissionRequirement",verifiable_credential_path:"",status:Be.ERROR,payload:"Not all the InputDescriptors are addressed"}];const s=r.input_descriptors,i=so.getDistinctFieldInObject(e,"input_descriptor_path");if(i.length!==s.length){const o=i.map(a=>ia.extractInputField(r,[a])[0].value).map(a=>a.id);for(let a=0;a<r.input_descriptors.length;a++)o.indexOf(r.input_descriptors[a].id)==-1&&n.push({input_descriptor_path:`$.input_descriptors[${a}]`,evaluator:"checkWithoutSubmissionRequirement",verifiable_credential_path:"",status:Be.ERROR,payload:"Not all the InputDescriptors are addressed"})}return n}matchSubmissionRequirements(e,r,n){const s=[];for(const i of r){const o={name:e.name||e.id,rule:i.rule,vc_path:[]};if(i.from&&(o.from=i.from),i.min&&(o.min=i.min),i.max&&(o.max=i.max),i.count&&(o.count=i.count),i.from){const a=this.mapMatchingDescriptors(e,i,n);a&&(o.vc_path.push(...a.vc_path),o.name=a.name,s.push(o))}else if(i.from_nested)try{o.from_nested=this.matchSubmissionRequirements(e,i.from_nested,n),s.push(o)}catch(a){throw new Error(`Error in handling value of from_nested: ${i.from_nested}: err: ${a}`)}else throw new Error("Invalid SubmissionRequirement object: Must contain either 'from' or 'from_nested'")}return s}matchWithoutSubmissionRequirements(e,r){const n=[],s=this.createIdToVcMap(e);for(const[i,o]of s.entries())if(!(!o||!o.length))for(const a of o){const u=ia.extractInputField(r,[i]);u.length&&n.push({name:u[0].value.name||u[0].value.id,rule:xr.Rules.All,vc_path:[a]})}return this.removeDuplicateSubmissionRequirementMatches(n)}mapMatchingDescriptors(e,r,n){var i;const s={rule:r.rule,vc_path:[]};if(r!=null&&r.from){s.from=r.from;for(const o of n){const a=vr.query(e,o.input_descriptor_path)[0];a.group&&a.group.indexOf(r.from)===-1||(s.name=a.name||a.id,o.payload.group.includes(r.from)&&((i=s.vc_path)==null?void 0:i.indexOf(o.verifiable_credential_path))===-1&&s.vc_path.push(o.verifiable_credential_path))}}return s}evaluate(e,r,n){var i,o,a,u;this._client.evaluate(e,r,n);const s={areRequiredCredentialsPresent:Be.INFO,verifiableCredential:r.map(l=>l.original)};if(s.warnings=this.formatNotInfo(Be.WARN),s.errors=this.formatNotInfo(Be.ERROR),this._client.assertPresentationSubmission(),(i=this._client.presentationSubmission)!=null&&i.descriptor_map.length){const l=(o=this._client.presentationSubmission)==null?void 0:o.descriptor_map.length;for(let c=0;c<l;c++)this._client.presentationSubmission.descriptor_map[c]&&this._client.presentationSubmission.descriptor_map.push(this._client.presentationSubmission.descriptor_map[c]);this._client.presentationSubmission.descriptor_map.splice(0,l),s.value=JSON.parse(JSON.stringify(this._client.presentationSubmission))}return this._client.generatePresentationSubmission&&this.updatePresentationSubmissionPathToAlias("verifiableCredential",s.value),s.verifiableCredential=this._client.wrappedVcs.map(l=>l.original),s.areRequiredCredentialsPresent=(u=(a=s.value)==null?void 0:a.descriptor_map)!=null&&u.length?Be.INFO:Be.ERROR,s}formatNotInfo(e){return this._client.results.filter(r=>r.status===e).map(r=>{const n=r.verifiable_credential_path.substring(1);return{tag:r.evaluator,status:r.status,message:`${r.message}: ${r.input_descriptor_path}: $.verifiableCredential${n}`}})}submissionFrom(e,r){if(!this._client.results.length)throw Error("You need to call evaluate() before pex.presentationFrom()");if(!this._client.generatePresentationSubmission)return this._client.presentationSubmission;if(e.submission_requirements){const i=this._client.results.filter(d=>d.evaluator==="MarkForSubmissionEvaluation"&&d.payload.group&&d.status!==Be.ERROR),[o,a]=this.matchUserSelectedVcs(i,r),u=new Map;"input_descriptors"in e&&e.input_descriptors.forEach(d=>{d.group&&d.group.forEach(h=>{u.has(h)?u.set(h,u.get(h)+1):u.set(h,1)})});const l=this.evaluateRequirements(e.submission_requirements,o,u,0),c=a.filter(d=>l[1].find(h=>h.verifiable_credential_path===d[1]));return this.updatePresentationSubmission(c),this.updatePresentationSubmissionPathToAlias("verifiableCredential"),this._client.presentationSubmission}const n=this._client.results.filter(i=>i.evaluator==="MarkForSubmissionEvaluation"&&i.status!==Be.ERROR),s=this.matchUserSelectedVcs(n,r);return this.updatePresentationSubmission(s[1]),this.updatePresentationSubmissionPathToAlias("verifiableCredential"),this._client.presentationSubmission}updatePresentationSubmission(e){this._client.generatePresentationSubmission&&(this._client.presentationSubmission.descriptor_map=this._client.presentationSubmission.descriptor_map.filter(r=>e.find(n=>n[0]===r.path)).map(r=>{const n=e.find(s=>s[0]===r.path);return n&&(r.path=n[1]),r}))}matchUserSelectedVcs(e,r){const n=r.map((o,a)=>[a,JSON.stringify(o.original)]),s=this._client.wrappedVcs.map((o,a)=>[a,JSON.stringify(o.original)]),i=[];return n.forEach((o,a)=>{s.forEach((u,l)=>{u[1]===o[1]&&i.push([`$[${l}]`,`$[${a}]`])})}),e=e.filter(o=>i.find(a=>a[0]===o.verifiable_credential_path)).map(o=>{const a=i.find(u=>u[0]===o.verifiable_credential_path);return a&&(o.verifiable_credential_path=a[1]),o}),[e,i]}evaluateRequirements(e,r,n,s){let i=0;const o=[];for(const a of e)if(a.from){if(a.rule===xr.Rules.All){const[u,l]=this.countMatchingInputDescriptors(a,r);if(u!==n.get(a.from))throw Error(`Not all input descriptors are members of group ${a.from}`);i++,o.push(...l)}else if(a.rule===xr.Rules.Pick){const[u,l]=this.countMatchingInputDescriptors(a,r);try{this.handleCount(a,u,s),i++}catch(c){if(s===0)throw c}o.push(...l)}}else if(a.from_nested){const[u,l]=this.evaluateRequirements(a.from_nested,r,n,++s);i+=u,o.push(...l),this.handleCount(a,u,s)}return[i,o]}countMatchingInputDescriptors(e,r){let n=0;const s=[];for(const i of r)i.payload.group.includes(e.from)&&(s.push(i),n++);return[n,s]}handleCount(e,r,n){if(e.count&&r!==e.count)throw Error(`Count: expected: ${e.count} actual: ${r} at level: ${n}`);if(e.min&&r<e.min)throw Error(`Min: expected: ${e.min} actual: ${r} at level: ${n}`);if(e.max&&r>e.max)throw Error(`Max: expected: ${e.max} actual: ${r} at level: ${n}`)}removeDuplicateSubmissionRequirementMatches(e){return e.filter((r,n)=>{const s=JSON.stringify(r);return n===e.findIndex(i=>JSON.stringify(i)===s)})}fillSelectableCredentialsToVerifiableCredentialsMapping(e,r){var n;e&&((n=e.verifiableCredential)==null||n.forEach(s=>{var o;const i=so.isString(s)?r.findIndex(a=>s===a.original):r.findIndex(a=>JSON.stringify(s.proof)===JSON.stringify(a.credential.proof));if(i===-1)throw new Error("index is not right");(o=e.vcIndexes)==null||o.push(i)}))}determineAreRequiredCredentialsPresent(e,r,n){if(!r||!r.length)return Be.ERROR;const s=r.map(i=>this.determineSubmissionRequirementStatus(e,i));if(n){if(n.rule===xr.Rules.All&&s.includes(Be.ERROR))return Be.ERROR;const i=s.filter(o=>o!==Be.ERROR).length;if(n.count)return n.count>i?Be.ERROR:n.count<i?Be.WARN:Be.INFO;if(n.min&&n.min>i)return Be.ERROR;if(n.max&&n.max<i)return Be.WARN}else return s.includes(Be.ERROR)?Be.ERROR:s.includes(Be.WARN)?Be.WARN:Be.INFO;return Be.INFO}determineSubmissionRequirementStatus(e,r){if(r.from&&r.from_nested)throw new Error("Invalid submission_requirement object: MUST contain either a from or from_nested property.");if(!r.from&&!r.from_nested&&r.vc_path.length!==1)return Be.ERROR;if(r.from){const n=this.countGroupIDs(e.input_descriptors,r.from);switch(r.rule){case xr.Rules.All:return r.vc_path.length===n?Be.INFO:Be.WARN;case xr.Rules.Pick:return this.getPickRuleStatus(r);default:return Be.ERROR}}else if(r.from_nested)return this.determineAreRequiredCredentialsPresent(e,r.from_nested,r);return Be.INFO}getPickRuleStatus(e){return e.vc_path.length===0?Be.ERROR:e.count&&e.vc_path.length!==e.count?e.vc_path.length>e.count?Be.WARN:Be.ERROR:e.min&&e.vc_path.length<e.min?Be.ERROR:e.max&&e.vc_path.length>e.max?Be.WARN:Be.INFO}updateSubmissionRequirementMatchPathToAlias(e,r){const n=[];e.vc_path.forEach(s=>{n.push(s.replace("$","$."+r))}),e.vc_path=n,e.from_nested&&e.from_nested.forEach(s=>{this.updateSubmissionRequirementMatchPathToAlias(s,r)})}updatePresentationSubmissionPathToAlias(e,r){r?r.descriptor_map.forEach(n=>{this.replacePathWithAlias(n,e)}):this._client.generatePresentationSubmission&&this._client.presentationSubmission.descriptor_map.forEach(n=>{this.replacePathWithAlias(n,e)})}replacePathWithAlias(e,r){e.path=e.path.replace("$","$."+r),e.path_nested&&this.replacePathWithAlias(e.path_nested,r)}createIdToVcMap(e){const r=new Map,n=new Map;for(let s=0;s<e.length;s++){const i=e[s].input_descriptor_path;if(n.has(i)){const o=n.get(i);o&&o.push(e[s])}else n.set(i,[e[s]])}for(const[s,i]of n.entries()){const o=[];for(let a=0;a<i.length;a++)o.indexOf(i[a].verifiable_credential_path)===-1&&o.push(i[a].verifiable_credential_path);r.set(s,o)}return r}countGroupIDs(e,r){let n=0;for(const s of e)s.group&&s.group.includes(r)&&n++;return n}}var fv;(function(t){t[t.EXTERNAL=0]="EXTERNAL",t[t.PRESENTATION=1]="PRESENTATION"})(fv||(fv={}));var M6;(function(t){t.Jwk="Jwk",t.Base58="Base58",t.Hex="Hex",t.Multibase="Multibase"})(M6||(M6={}));var zk={exports:{}};zk.exports=Wk;zk.exports.default=Wk;const Pn={additionalProperties:!1,properties:{const:{$ref:"#/definitions/OneOfNumberString"},enum:{items:{$ref:"#/definitions/OneOfNumberString"},type:"array"},exclusiveMaximum:{$ref:"#/definitions/OneOfNumberString"},exclusiveMinimum:{$ref:"#/definitions/OneOfNumberString"},format:{type:"string"},maxLength:{type:"number"},maximum:{$ref:"#/definitions/OneOfNumberString"},minLength:{type:"number"},minimum:{$ref:"#/definitions/OneOfNumberString"},not:{type:"object"},pattern:{type:"string"},type:{type:"string"}},required:["type"],type:"object"},cbe=Object.prototype.hasOwnProperty,ZT={type:["number","string"]};function Fn(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(typeof t!="number"&&typeof t!="string"){const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:ZT.type},message:"must be number,string",schema:ZT.type,parentSchema:ZT,data:t};i===null?i=[a]:i.push(a),o++}return Fn.errors=i,o===0}function L1(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.type===void 0){const a={instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:"type"},message:"must have required property 'type'",schema:Pn.required,parentSchema:Pn,data:t};i===null?i=[a]:i.push(a),o++}for(const a in t)if(!cbe.call(Pn.properties,a)){const u={instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:a},message:"must NOT have additional properties",schema:!1,parentSchema:Pn,data:t};i===null?i=[u]:i.push(u),o++}if(t.const!==void 0&&(Fn(t.const,{instancePath:e+"/const",parentData:t,parentDataProperty:"const",rootData:s})||(i=i===null?Fn.errors:i.concat(Fn.errors),o=i.length)),t.enum!==void 0){let a=t.enum;if(Array.isArray(a)){const u=a.length;for(let l=0;l<u;l++)Fn(a[l],{instancePath:e+"/enum/"+l,parentData:a,parentDataProperty:l,rootData:s})||(i=i===null?Fn.errors:i.concat(Fn.errors),o=i.length)}else{const u={instancePath:e+"/enum",schemaPath:"#/properties/enum/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Pn.properties.enum.type,parentSchema:Pn.properties.enum,data:a};i===null?i=[u]:i.push(u),o++}}if(t.exclusiveMaximum!==void 0&&(Fn(t.exclusiveMaximum,{instancePath:e+"/exclusiveMaximum",parentData:t,parentDataProperty:"exclusiveMaximum",rootData:s})||(i=i===null?Fn.errors:i.concat(Fn.errors),o=i.length)),t.exclusiveMinimum!==void 0&&(Fn(t.exclusiveMinimum,{instancePath:e+"/exclusiveMinimum",parentData:t,parentDataProperty:"exclusiveMinimum",rootData:s})||(i=i===null?Fn.errors:i.concat(Fn.errors),o=i.length)),t.format!==void 0){let a=t.format;if(typeof a!="string"){const u={instancePath:e+"/format",schemaPath:"#/properties/format/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Pn.properties.format.type,parentSchema:Pn.properties.format,data:a};i===null?i=[u]:i.push(u),o++}}if(t.maxLength!==void 0){let a=t.maxLength;if(typeof a!="number"){const u={instancePath:e+"/maxLength",schemaPath:"#/properties/maxLength/type",keyword:"type",params:{type:"number"},message:"must be number",schema:Pn.properties.maxLength.type,parentSchema:Pn.properties.maxLength,data:a};i===null?i=[u]:i.push(u),o++}}if(t.maximum!==void 0&&(Fn(t.maximum,{instancePath:e+"/maximum",parentData:t,parentDataProperty:"maximum",rootData:s})||(i=i===null?Fn.errors:i.concat(Fn.errors),o=i.length)),t.minLength!==void 0){let a=t.minLength;if(typeof a!="number"){const u={instancePath:e+"/minLength",schemaPath:"#/properties/minLength/type",keyword:"type",params:{type:"number"},message:"must be number",schema:Pn.properties.minLength.type,parentSchema:Pn.properties.minLength,data:a};i===null?i=[u]:i.push(u),o++}}if(t.minimum!==void 0&&(Fn(t.minimum,{instancePath:e+"/minimum",parentData:t,parentDataProperty:"minimum",rootData:s})||(i=i===null?Fn.errors:i.concat(Fn.errors),o=i.length)),t.not!==void 0){let a=t.not;if(!(a&&typeof a=="object"&&!Array.isArray(a))){const u={instancePath:e+"/not",schemaPath:"#/properties/not/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Pn.properties.not.type,parentSchema:Pn.properties.not,data:a};i===null?i=[u]:i.push(u),o++}}if(t.pattern!==void 0){let a=t.pattern;if(typeof a!="string"){const u={instancePath:e+"/pattern",schemaPath:"#/properties/pattern/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Pn.properties.pattern.type,parentSchema:Pn.properties.pattern,data:a};i===null?i=[u]:i.push(u),o++}}if(t.type!==void 0){let a=t.type;if(typeof a!="string"){const u={instancePath:e+"/type",schemaPath:"#/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Pn.properties.type.type,parentSchema:Pn.properties.type,data:a};i===null?i=[u]:i.push(u),o++}}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Pn.type,parentSchema:Pn,data:t};i===null?i=[a]:i.push(a),o++}return L1.errors=i,o===0}function Wk(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;return L1(t,{instancePath:e,parentData:r,parentDataProperty:n,rootData:s})||(i=i===null?L1.errors:i.concat(L1.errors),o=i.length),Wk.errors=i,o===0}var lbe=zk.exports;const dbe=nc(lbe);var Gk={exports:{}};Gk.exports=Jk;Gk.exports.default=Jk;const Or={additionalProperties:!1,properties:{const:{$ref:"#/definitions/OneOfNumberString"},enum:{items:{$ref:"#/definitions/OneOfNumberString"},type:"array"},exclusiveMaximum:{$ref:"#/definitions/OneOfNumberString"},exclusiveMinimum:{$ref:"#/definitions/OneOfNumberString"},format:{type:"string"},formatExclusiveMaximum:{type:"string"},formatExclusiveMinimum:{type:"string"},formatMaximum:{type:"string"},formatMinimum:{type:"string"},maxLength:{type:"number"},maximum:{$ref:"#/definitions/OneOfNumberString"},minLength:{type:"number"},minimum:{$ref:"#/definitions/OneOfNumberString"},not:{type:"object"},pattern:{type:"string"},type:{type:"string"}},required:["type"],type:"object"},fbe=Object.prototype.hasOwnProperty,QT={type:["number","string"]};function Mn(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(typeof t!="number"&&typeof t!="string"){const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:QT.type},message:"must be number,string",schema:QT.type,parentSchema:QT,data:t};i===null?i=[a]:i.push(a),o++}return Mn.errors=i,o===0}function K1(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.type===void 0){const a={instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:"type"},message:"must have required property 'type'",schema:Or.required,parentSchema:Or,data:t};i===null?i=[a]:i.push(a),o++}for(const a in t)if(!fbe.call(Or.properties,a)){const u={instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:a},message:"must NOT have additional properties",schema:!1,parentSchema:Or,data:t};i===null?i=[u]:i.push(u),o++}if(t.const!==void 0&&(Mn(t.const,{instancePath:e+"/const",parentData:t,parentDataProperty:"const",rootData:s})||(i=i===null?Mn.errors:i.concat(Mn.errors),o=i.length)),t.enum!==void 0){let a=t.enum;if(Array.isArray(a)){const u=a.length;for(let l=0;l<u;l++)Mn(a[l],{instancePath:e+"/enum/"+l,parentData:a,parentDataProperty:l,rootData:s})||(i=i===null?Mn.errors:i.concat(Mn.errors),o=i.length)}else{const u={instancePath:e+"/enum",schemaPath:"#/properties/enum/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Or.properties.enum.type,parentSchema:Or.properties.enum,data:a};i===null?i=[u]:i.push(u),o++}}if(t.exclusiveMaximum!==void 0&&(Mn(t.exclusiveMaximum,{instancePath:e+"/exclusiveMaximum",parentData:t,parentDataProperty:"exclusiveMaximum",rootData:s})||(i=i===null?Mn.errors:i.concat(Mn.errors),o=i.length)),t.exclusiveMinimum!==void 0&&(Mn(t.exclusiveMinimum,{instancePath:e+"/exclusiveMinimum",parentData:t,parentDataProperty:"exclusiveMinimum",rootData:s})||(i=i===null?Mn.errors:i.concat(Mn.errors),o=i.length)),t.format!==void 0){let a=t.format;if(typeof a!="string"){const u={instancePath:e+"/format",schemaPath:"#/properties/format/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Or.properties.format.type,parentSchema:Or.properties.format,data:a};i===null?i=[u]:i.push(u),o++}}if(t.formatExclusiveMaximum!==void 0){let a=t.formatExclusiveMaximum;if(typeof a!="string"){const u={instancePath:e+"/formatExclusiveMaximum",schemaPath:"#/properties/formatExclusiveMaximum/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Or.properties.formatExclusiveMaximum.type,parentSchema:Or.properties.formatExclusiveMaximum,data:a};i===null?i=[u]:i.push(u),o++}}if(t.formatExclusiveMinimum!==void 0){let a=t.formatExclusiveMinimum;if(typeof a!="string"){const u={instancePath:e+"/formatExclusiveMinimum",schemaPath:"#/properties/formatExclusiveMinimum/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Or.properties.formatExclusiveMinimum.type,parentSchema:Or.properties.formatExclusiveMinimum,data:a};i===null?i=[u]:i.push(u),o++}}if(t.formatMaximum!==void 0){let a=t.formatMaximum;if(typeof a!="string"){const u={instancePath:e+"/formatMaximum",schemaPath:"#/properties/formatMaximum/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Or.properties.formatMaximum.type,parentSchema:Or.properties.formatMaximum,data:a};i===null?i=[u]:i.push(u),o++}}if(t.formatMinimum!==void 0){let a=t.formatMinimum;if(typeof a!="string"){const u={instancePath:e+"/formatMinimum",schemaPath:"#/properties/formatMinimum/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Or.properties.formatMinimum.type,parentSchema:Or.properties.formatMinimum,data:a};i===null?i=[u]:i.push(u),o++}}if(t.maxLength!==void 0){let a=t.maxLength;if(typeof a!="number"){const u={instancePath:e+"/maxLength",schemaPath:"#/properties/maxLength/type",keyword:"type",params:{type:"number"},message:"must be number",schema:Or.properties.maxLength.type,parentSchema:Or.properties.maxLength,data:a};i===null?i=[u]:i.push(u),o++}}if(t.maximum!==void 0&&(Mn(t.maximum,{instancePath:e+"/maximum",parentData:t,parentDataProperty:"maximum",rootData:s})||(i=i===null?Mn.errors:i.concat(Mn.errors),o=i.length)),t.minLength!==void 0){let a=t.minLength;if(typeof a!="number"){const u={instancePath:e+"/minLength",schemaPath:"#/properties/minLength/type",keyword:"type",params:{type:"number"},message:"must be number",schema:Or.properties.minLength.type,parentSchema:Or.properties.minLength,data:a};i===null?i=[u]:i.push(u),o++}}if(t.minimum!==void 0&&(Mn(t.minimum,{instancePath:e+"/minimum",parentData:t,parentDataProperty:"minimum",rootData:s})||(i=i===null?Mn.errors:i.concat(Mn.errors),o=i.length)),t.not!==void 0){let a=t.not;if(!(a&&typeof a=="object"&&!Array.isArray(a))){const u={instancePath:e+"/not",schemaPath:"#/properties/not/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Or.properties.not.type,parentSchema:Or.properties.not,data:a};i===null?i=[u]:i.push(u),o++}}if(t.pattern!==void 0){let a=t.pattern;if(typeof a!="string"){const u={instancePath:e+"/pattern",schemaPath:"#/properties/pattern/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Or.properties.pattern.type,parentSchema:Or.properties.pattern,data:a};i===null?i=[u]:i.push(u),o++}}if(t.type!==void 0){let a=t.type;if(typeof a!="string"){const u={instancePath:e+"/type",schemaPath:"#/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Or.properties.type.type,parentSchema:Or.properties.type,data:a};i===null?i=[u]:i.push(u),o++}}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Or.type,parentSchema:Or,data:t};i===null?i=[a]:i.push(a),o++}return K1.errors=i,o===0}function Jk(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;return K1(t,{instancePath:e,parentData:r,parentDataProperty:n,rootData:s})||(i=i===null?K1.errors:i.concat(K1.errors),o=i.length),Jk.errors=i,o===0}var hbe=Gk.exports;const pbe=nc(hbe);class Il{constructor(e,r){Se(this,"parentTag");Se(this,"myTag");this.parentTag=e,this.myTag=r}getTag(){return this.parentTag!=null?this.parentTag+"."+this.myTag:this.myTag}toChecked(e){return new FE(this.getTag(),Be.ERROR,e)}}class WE extends Il{constructor(r){super(r,"fields");Se(this,"mustHaveValidJsonPathsMsg",'field object "path" property must contain array of valid json paths');Se(this,"pathObjMustHaveValidJsonPathMsg",'field object "path" property must contain valid json paths.');Se(this,"filterMustBeValidJsonSchemaMsg",'field object "filter" property must be valid json schema');Se(this,"filterIsMustInPresenceOfPredicateMsg",'field object must have a "filter" property if "predicate" is present');Se(this,"filterIsNotValidJsonSchemaDescriptorMsg",'could not parse "filter" object as a valid json schema descriptor.');Se(this,"purposeShouldBeANonEmptyStringMsg","purpose should be a non empty string");Se(this,"shouldBeKnownOptionMsg","Unknown predicate property")}getValidations(r){let n=[];if(r)for(let s=0;s<r.length;s++)n=[...n,...this.getValidationsFor(r[s],s)];return n}getValidationsFor(r,n){return[{tag:this.getMyTag(n),target:r,predicate:this.mustHaveValidJsonPaths(),message:this.mustHaveValidJsonPathsMsg},{tag:this.getMyTag(n),target:r,predicate:this.filterMustBeValidJsonSchema(),message:this.filterMustBeValidJsonSchemaMsg},{tag:this.getMyTag(n),target:r,predicate:this.filterIsMustInPresenceOfPredicate(),message:this.filterIsMustInPresenceOfPredicateMsg},{tag:this.getMyTag(n),target:r,predicate:s=>WE.optionalNonEmptyString(s==null?void 0:s.purpose),message:this.purposeShouldBeANonEmptyStringMsg},{tag:this.getMyTag(n),target:r,predicate:s=>WE.shouldBeKnownOption(s==null?void 0:s.predicate),message:this.shouldBeKnownOptionMsg}]}getMyTag(r){return this.parentTag+"."+this.myTag+"["+r+"]"}mustHaveValidJsonPaths(){return r=>r.path!=null&&r.path.length>0&&this._validateJsonPaths(r.path)}_validateJsonPaths(r){const n=[];if(r.forEach(s=>{try{vr.parse(s)}catch{n.push(s)}}),n.length>0)throw this.toChecked(this.pathObjMustHaveValidJsonPathMsg+" Got: "+JSON.stringify(n));return!0}filterMustBeValidJsonSchema(){return r=>this._validateFilter(r.filter)}_validateFilter(r){if(r==null)return!0;let n=!1;try{n=pbe(r),n||(n=dbe(r))}catch{throw this.toChecked(this.filterIsNotValidJsonSchemaDescriptorMsg+" Got "+JSON.stringify(r))}return n}filterIsMustInPresenceOfPredicate(){return r=>!(r.predicate!=null&&r.filter==null)}static optionalNonEmptyString(r){return r==null||r.length>0}static shouldBeKnownOption(r){return r==null||r==xr.Optionality.Required||r==xr.Optionality.Preferred}}class Md extends Il{constructor(r){super(r,"constraints");Se(this,"disclosureLimitShouldHaveKnownValueMsg","limit_disclosure should have known value");Se(this,"statusShouldHaveKnownValueMsg","Unknown status property");Se(this,"statusDirectiveShouldHaveKnownValueMsg","status directive should have known value");Se(this,"subjectIsIssuerShouldBeKnownValueMsg","subject_is_issuer should be known value");Se(this,"fieldIdIsMandatoryMsg","field_id property is mandatory");Se(this,"fieldIdMustBeArrayOfStringsMsg","field_id property must be an array of strings");Se(this,"fieldIdMustCorrespondToFieldIdMsg","field_id must correspond to a present field object id property");Se(this,"directivePropertyIsMandatoryMsg","directive property is mandatory");Se(this,"oneOfTheKnownDirectivePropertiesMandatoryMsg","directive property must be one of [required, preferred]")}getValidations(r){let n=[];return r&&(n=[{tag:this.getTag(),target:r,predicate:s=>Md.disclosureLimitShouldHaveKnownValue(s.limit_disclosure),message:this.disclosureLimitShouldHaveKnownValueMsg},{tag:this.getTag(),target:r,predicate:s=>Md.statusShouldHaveKnownValue(s.statuses),message:this.statusShouldHaveKnownValueMsg},{tag:this.getTag(),target:r,predicate:Md.statusDirectiveShouldHaveKnownValue(),message:this.statusDirectiveShouldHaveKnownValueMsg},{tag:this.getTag(),target:r,predicate:s=>Md.shouldBeKnownOption(s.is_holder),message:this.subjectIsIssuerShouldBeKnownValueMsg},{tag:this.getTag(),target:r,predicate:s=>this.fieldIdInSubjectMustCorrespondToFieldId(s,s.is_holder),message:this.fieldIdMustCorrespondToFieldIdMsg},{tag:this.getTag(),target:r,predicate:s=>this.fieldIdInSubjectMustCorrespondToFieldId(s,s.same_subject),message:this.fieldIdMustCorrespondToFieldIdMsg},...this.getSubjectsValidations(r==null?void 0:r.is_holder),...this.getSubjectsValidations(r==null?void 0:r.same_subject),...this.getFieldsValidations(r)]),n}getFieldsValidations(r){var n;return(n=r==null?void 0:r.fields)!=null&&n.length?new WE(this.getTag()).getValidations(r.fields):[]}static disclosureLimitShouldHaveKnownValue(r){return!r||r===xr.Optionality.Preferred||r===xr.Optionality.Required}static statusShouldHaveKnownValue(r){return r==null||r.active!=null||r.revoked!=null||r.suspended!=null}static statusDirectiveShouldHaveKnownValue(){return r=>{var n,s,i;return this.pdStatusShouldBeKnown((n=r==null?void 0:r.statuses)==null?void 0:n.active)&&this.pdStatusShouldBeKnown((s=r==null?void 0:r.statuses)==null?void 0:s.revoked)&&this.pdStatusShouldBeKnown((i=r==null?void 0:r.statuses)==null?void 0:i.suspended)}}static pdStatusShouldBeKnown(r){return!r||r.directive===xr.Directives.Allowed||r.directive===xr.Directives.Disallowed||r.directive===xr.Directives.Required}static shouldBeKnownOption(r){return r?r.filter(n=>n.directive!==xr.Optionality.Preferred&&n.directive!==xr.Optionality.Required).length===0:!0}getSubjectsValidations(r){if(r){let n=[];for(let s=0;s<r.length;s++)n=[{tag:this.getMyTag(s),target:r[s],predicate:i=>Array.isArray(i.field_id),message:this.fieldIdMustBeArrayOfStringsMsg},{tag:this.getMyTag(s),target:r[s],predicate:i=>!!i.field_id,message:this.fieldIdIsMandatoryMsg},{tag:this.getMyTag(s),target:r[s],predicate:i=>i.field_id.length===i.field_id.filter(o=>typeof o=="string").length,message:this.fieldIdMustBeArrayOfStringsMsg},{tag:this.getMyTag(s),target:r[s],predicate:i=>i.directive!==void 0,message:this.directivePropertyIsMandatoryMsg},{tag:this.getMyTag(s),target:r[s],predicate:i=>i.directive===xr.Optionality.Preferred||i.directive===xr.Optionality.Required,message:this.oneOfTheKnownDirectivePropertiesMandatoryMsg}];return n}return[]}getMyTag(r){return this.parentTag+"."+this.myTag+"["+r+"]"}fieldIdInSubjectMustCorrespondToFieldId(r,n){if(n){for(const s of n)for(const i of s.field_id)if(!Md.isValidFieldId(r,i))return!1}return!0}static isValidFieldId(r,n){return r!=null&&r.fields?r.fields.map(s=>s.id).includes(n):!1}}class j6 extends Il{constructor(r){super(r,"input_descriptor");Se(this,"idMustBeNonEmptyStringMsg","input descriptor id must be non-empty string");Se(this,"nameShouldBeNonEmptyStringMsg","input descriptor name should be non-empty string");Se(this,"purposeShouldBeNonEmptyStringMsg","input descriptor purpose should be non-empty string");Se(this,"shouldHaveValidSchemaURIMsg","schema should have valid URI")}getValidations(r){let n=[];return n.push({tag:this.getTag(),target:r,predicate:s=>this.shouldHaveUniqueIds(s),message:"input descriptor ids must be unique"},{tag:this.getTag(),target:r,predicate:s=>this.shouldHaveUniqueFieldsIds(s),message:"fields id must be unique"}),r.forEach((s,i)=>{n=[...n,...this.getValidationFor(s,i),...this.constraintsValidations(s,i)]}),n}getValidationFor(r,n){return[{tag:this.getMyTag(n),target:r,predicate:s=>Fd.nonEmptyString(s==null?void 0:s.id),message:this.idMustBeNonEmptyStringMsg},{tag:this.getMyTag(n),target:r,predicate:this.isValidSchema(),message:this.shouldHaveValidSchemaURIMsg},{tag:this.getMyTag(n),target:r,predicate:s=>Fd.optionalNonEmptyString(s==null?void 0:s.name),message:this.nameShouldBeNonEmptyStringMsg},{tag:this.getMyTag(n),target:r,predicate:s=>Fd.optionalNonEmptyString(s==null?void 0:s.purpose),message:this.purposeShouldBeNonEmptyStringMsg}]}shouldHaveUniqueFieldsIds(r){const n=[],s=new Set,i=[];return r.map(o=>{var a;return(a=o.constraints)==null?void 0:a.fields}).forEach(o=>{o&&i.push(...o)}),i.forEach(o=>{o.id&&n.push(o.id)}),n.forEach(o=>s.add(o)),n.length===s.size}shouldHaveUniqueIds(r){const n=[],s=new Set;return r.forEach(i=>n.push(i.id)),n.forEach(i=>s.add(i)),n.length===s.size}getMyTag(r){return this.parentTag+"."+this.myTag+"["+r+"]"}isValidSchema(){return r=>r.schema.filter(n=>this.isAValidURI(n.uri)&&(n.required==null||typeof n.required=="boolean")).length>0}isAValidURI(r){if(r){if(!Fd.nonEmptyString(r))return!1}else return!1;if(r.startsWith("http://")||r.startsWith("https://"))try{new URL(r)}catch{return Fd.isValidDIDURI(r)}return!0}constraintsValidations(r,n){return r.constraints?new Md(this.getMyTag(n)).getValidations(r.constraints):[]}}class U6 extends Il{constructor(r){super(r,"input_descriptor");Se(this,"idMustBeNonEmptyStringMsg","input descriptor id must be non-empty string");Se(this,"nameShouldBeNonEmptyStringMsg","input descriptor name should be non-empty string");Se(this,"purposeShouldBeNonEmptyStringMsg","input descriptor purpose should be non-empty string")}getValidations(r){let n=[];return n.push({tag:this.getTag(),target:r,predicate:s=>this.shouldNotHaveSchema(s),message:"input descriptor should not have schema property"},{tag:this.getTag(),target:r,predicate:s=>this.shouldHaveUniqueIds(s),message:"input descriptor ids must be unique"},{tag:this.getTag(),target:r,predicate:s=>this.shouldHaveUniqueFieldsIds(s),message:"fields id must be unique"}),r.forEach((s,i)=>{n=[...n,...this.getValidationFor(s,i),...this.constraintsValidations(s,i)]}),n}getValidationFor(r,n){return[{tag:this.getMyTag(n),target:r,predicate:s=>Fd.nonEmptyString(s==null?void 0:s.id),message:this.idMustBeNonEmptyStringMsg},{tag:this.getMyTag(n),target:r,predicate:s=>Fd.optionalNonEmptyString(s==null?void 0:s.name),message:this.nameShouldBeNonEmptyStringMsg},{tag:this.getMyTag(n),target:r,predicate:s=>Fd.optionalNonEmptyString(s==null?void 0:s.purpose),message:this.purposeShouldBeNonEmptyStringMsg}]}shouldHaveUniqueFieldsIds(r){const n=[],s=new Set,i=[];return r.map(o=>{var a;return(a=o.constraints)==null?void 0:a.fields}).forEach(o=>{o&&i.push(...o)}),i.forEach(o=>{o.id&&n.push(o.id)}),n.forEach(o=>s.add(o)),n.length===s.size}shouldHaveUniqueIds(r){const n=[],s=new Set;return r.forEach(i=>n.push(i.id)),n.forEach(i=>s.add(i)),n.length===s.size}getMyTag(r){return this.parentTag+"."+this.myTag+"["+r+"]"}constraintsValidations(r,n){return r.constraints?new Md(this.getMyTag(n)).getValidations(r.constraints):[]}shouldNotHaveSchema(r){let n=!1;return r.forEach(s=>{s.schema&&(n=!0)}),!n}}class W7{static getJwtAlgos(){return["HS256","HS384","HS512","RS256","RS384","RS512","ES256","ES384","ES512","PS256","PS384","PS512","none","RSA1_5","RSA-OAEP","RSA-OAEP-256","A128KW","A192KW","A256KW","dir","ECDH-ES","ECDH-ES+A128KW","ECDH-ES+A192KW","ECDH-ES+A256KW","A128GCMKW","A192GCMKW","A256GCMKW","PBES2-HS256+A128KW","PBES2-HS384+A192KW","PBES2-HS512+A256KW"]}}class G7{static getLdpTypes(){return["Ed25519VerificationKey2018","Ed25519Signature2018","RsaSignature2018","EcdsaSecp256k1Signature2019","EcdsaSecp256k1RecoverySignature2020","JsonWebSignature2020","GpgSignature2020","JcsEd25519Signature2020","BbsBlsSignature2020","Bls12381G2Key2020"]}}class jd extends Il{constructor(r){super(r,"submission_requirements");Se(this,"ruleIsMandatoryMsg","rule is a mandatory field");Se(this,"needsOneFromOrFromNestedMsg","needs exactly one of from or from_nested");Se(this,"fromNestedShouldBeArrayMsg","The value of the from_nested property MUST be an array");Se(this,"isCountPositiveIntMsg","count must be a practical positive number");Se(this,"isMinPositiveIntMsg","min must be a practical positive number");Se(this,"isMaxPositiveIntMsg","max must be a practical positive number");Se(this,"ruleShouldBePickOrAllMsg","rule should be either pick or all")}getValidations(r){let n=[];if(r!=null&&r.length>0)for(let s=0;s<r.length;s++)n=[...n,...this.getMyValidations(s,r),...this.getSubValidations(s,r)];return n}getMyValidations(r,n){return[{tag:this.getMyTag(r),target:n[r],predicate:jd.ruleIsMandatory,message:this.ruleIsMandatoryMsg},{tag:this.getMyTag(r),target:n[r],predicate:jd.needsOneFromOrFromNested,message:this.needsOneFromOrFromNestedMsg},{tag:this.getMyTag(r),target:n[r],predicate:jd.fromNestedShouldBeArray,message:this.fromNestedShouldBeArrayMsg},{tag:this.getMyTag(r),target:n[r],predicate:this.isCountPositiveInt,message:this.isCountPositiveIntMsg},{tag:this.getMyTag(r),target:n[r],predicate:this.isMinPositiveInt,message:this.isMinPositiveIntMsg},{tag:this.getMyTag(r),target:n[r],predicate:this.isMaxPositiveInt,message:this.isMaxPositiveIntMsg},{tag:this.getMyTag(r),target:n[r],predicate:jd.ruleShouldBePickOrAll,message:this.ruleShouldBePickOrAllMsg}]}getMyTag(r){return this.parentTag+"."+this.myTag+"["+r+"]"}getSubValidations(r,n){const s=n[r].from_nested;return s!=null?new jd(this.getFromNestedTag(r)).getValidations(s):[]}getFromNestedTag(r){return this.getMyTag(r)+".from_nested"}isCountPositiveInt(r){return r.rule!=="pick"||r.count==null||0<r.count}isMinPositiveInt(r){return r.rule!=="pick"||r.min==null||0<=r.min}isMaxPositiveInt(r){return r.rule!=="pick"||r.max==null||0<r.max}static ruleIsMandatory(r){return r.rule!=null}static needsOneFromOrFromNested(r){return r.from==null!=(r.from_nested==null)}static fromNestedShouldBeArray(r){return r.from_nested==null||Array.isArray(r.from_nested)}static ruleShouldBePickOrAll(r){return r.rule==="pick"||r.rule==="all"}}class Mo extends Il{constructor(e){super(e,"presentation_definition")}getValidations(e){return e.submission_requirements?[...this.myValidations(e),...new j6(this.myTag).getValidations(e.input_descriptors),...new jd(this.myTag).getValidations(e.submission_requirements)]:[...this.myValidations(e),...new j6(this.myTag).getValidations(e.input_descriptors)]}myValidations(e){return[{tag:this.getTag(),target:e,predicate:r=>r!=null,message:"presentation_definition should be non null."},{tag:this.getTag(),target:e,predicate:this.shouldBeAsPerJsonSchema(),message:"presentation_definition should be as per json schema."},{tag:this.getTag(),target:e,predicate:r=>Mo.nonEmptyString(r==null?void 0:r.id),message:"id should not be empty"},{tag:this.getTag(),target:e,predicate:r=>Mo.optionalNonEmptyString(r==null?void 0:r.name),message:"name should be a non-empty string"},{tag:this.getTag(),target:e,predicate:r=>Mo.optionalNonEmptyString(r==null?void 0:r.purpose),message:"purpose should be a non-empty string"},{tag:this.getTag(),target:e,predicate:r=>Mo.formatValuesShouldNotBeEmpty(r==null?void 0:r.format),message:"formats values should not empty"},{tag:this.getTag(),target:e,predicate:r=>Mo.formatValuesShouldBeAmongKnownValues(r==null?void 0:r.format),message:"formats should only have known identifiers for alg or proof_type"},{tag:this.getTag(),target:e,predicate:r=>Mo.groupShouldMatchSubmissionRequirements(r),message:"input descriptor group should match the from in submission requirements."},{tag:this.getTag(),target:e,predicate:r=>Mo.shouldNotHaveFrameProperty(r),message:"input descriptor should not have frame property."}]}static optionalNonEmptyString(e){return e==null||e.length>0}static nonEmptyString(e){return e!=null&&e.length>0}static formatValuesShouldNotBeEmpty(e){var n,s,i,o,a,u;let r=!0;return(e==null?void 0:e.jwt)!=null&&(r=r&&((n=e.jwt.alg)==null?void 0:n.length)>0),(e==null?void 0:e.jwt_vc)!=null&&(r=r&&((s=e.jwt_vc.alg)==null?void 0:s.length)>0),(e==null?void 0:e.jwt_vp)!=null&&(r=r&&((i=e.jwt_vp.alg)==null?void 0:i.length)>0),(e==null?void 0:e.ldp)!=null&&(r=r&&((o=e.ldp.proof_type)==null?void 0:o.length)>0),(e==null?void 0:e.ldp_vc)!=null&&(r=r&&((a=e.ldp_vc.proof_type)==null?void 0:a.length)>0),(e==null?void 0:e.ldp_vp)!=null&&(r=r&&((u=e.ldp_vp.proof_type)==null?void 0:u.length)>0),r}static formatValuesShouldBeAmongKnownValues(e){let r=[];if(e){const n=W7.getJwtAlgos(),s=G7.getLdpTypes();r=[];for(const[i,o]of Object.entries(e))i.startsWith("jwt")?r.push(...Mo.isJWTAlgoKnown(o,n)):r.push(...Mo.isLDPProofKnown(o,s))}return r.length===0}static isJWTAlgoKnown(e,r){const n=[];if(e!=null&&e.alg!=null)for(const s of e.alg)r.includes(s)||n.push(s);return n}static isLDPProofKnown(e,r){const n=[];if(e!=null&&e.proof_type!=null)for(const s of e.proof_type)r.includes(s)||n.push(s);return n}static groupShouldMatchSubmissionRequirements(e){if(e.submission_requirements!=null&&e.submission_requirements.length>0){const r=[];e.input_descriptors.forEach(a=>{a.group&&r.push(...a.group)});const n=new Set(r),s=[];Mo.flatten(e.submission_requirements).forEach(a=>{a.from&&(Array.isArray(a.from)?s.push(...a.from):s.push(a.from))});const i=new Set(s);return new Set([...i].filter(a=>a!=null&&a.length>0&&!n.has(a))).size===0}return!0}static flatten(e){return e==null?void 0:e.reduce((r,n)=>r.concat(Array.isArray(n.from_nested)?this.flatten(n.from_nested):n),[])}shouldBeAsPerJsonSchema(){return e=>oV({presentation_definition:e})}static shouldNotHaveFrameProperty(e){return!e.frame}}class Xk extends Il{constructor(r){super(r,"frame");Se(this,"frameIsValidMsg","frame value is not valid")}getValidations(r){let n=[];return n=[...n,...this.getMyValidations(r)],n}getMyValidations(r){return[{tag:this.getMyTag(),target:r,predicate:Xk.frameIsValid,message:this.frameIsValidMsg}]}getMyTag(){return this.parentTag+"."+this.myTag}static frameIsValid(r){if(!r||Array.isArray(r)||typeof r!="object")return!1;const n=r;if(n&&n["@id"]){for(const s of so.asArray(r["@id"]))if(!(so.isObject(s)||so.isUrlAbsolute(s))||so.isString(s)&&s.indexOf("_:")===0)return!1}if(n["@types"]){for(const s of so.asArray(r["@types"]))if(!(so.isObject(s)||so.isUrlAbsolute(s))||so.isString(s)&&s.indexOf("_:")===0)return!1}return!0}}class Sa extends Il{constructor(e){super(e,"presentation_definition")}getValidations(e){let r=[];return e.submission_requirements?r=[...this.myValidations(e),...new U6(this.myTag).getValidations(e.input_descriptors),...new jd(this.myTag).getValidations(e.submission_requirements)]:r=[...this.myValidations(e),...new U6(this.myTag).getValidations(e.input_descriptors)],e.frame&&r.push(...new Xk(this.myTag).getValidations(e.frame)),r}myValidations(e){return[{tag:this.getTag(),target:e,predicate:r=>r!=null,message:"presentation_definition should be non null."},{tag:this.getTag(),target:e,predicate:this.shouldBeAsPerJsonSchema(),message:"presentation_definition should be as per json schema."},{tag:this.getTag(),target:e,predicate:r=>Sa.nonEmptyString(r==null?void 0:r.id),message:"id should not be empty"},{tag:this.getTag(),target:e,predicate:r=>Sa.optionalNonEmptyString(r==null?void 0:r.name),message:"name should be a non-empty string"},{tag:this.getTag(),target:e,predicate:r=>Sa.optionalNonEmptyString(r==null?void 0:r.purpose),message:"purpose should be a non-empty string"},{tag:this.getTag(),target:e,predicate:r=>Sa.formatValuesShouldNotBeEmpty(r==null?void 0:r.format),message:"formats values should not empty"},{tag:this.getTag(),target:e,predicate:r=>Sa.formatValuesShouldBeAmongKnownValues(r==null?void 0:r.format),message:"formats should only have known identifiers for alg or proof_type"},{tag:this.getTag(),target:e,predicate:r=>Sa.groupShouldMatchSubmissionRequirements(r),message:"input descriptor group should match the from in submission requirements."}]}static optionalNonEmptyString(e){return e==null||e.length>0}static nonEmptyString(e){return e!=null&&e.length>0}static formatValuesShouldNotBeEmpty(e){var n,s,i,o,a,u;let r=!0;return(e==null?void 0:e.jwt)!=null&&(r=r&&((n=e.jwt.alg)==null?void 0:n.length)>0),(e==null?void 0:e.jwt_vc)!=null&&(r=r&&((s=e.jwt_vc.alg)==null?void 0:s.length)>0),(e==null?void 0:e.jwt_vp)!=null&&(r=r&&((i=e.jwt_vp.alg)==null?void 0:i.length)>0),(e==null?void 0:e.ldp)!=null&&(r=r&&((o=e.ldp.proof_type)==null?void 0:o.length)>0),(e==null?void 0:e.ldp_vc)!=null&&(r=r&&((a=e.ldp_vc.proof_type)==null?void 0:a.length)>0),(e==null?void 0:e.ldp_vp)!=null&&(r=r&&((u=e.ldp_vp.proof_type)==null?void 0:u.length)>0),r}static formatValuesShouldBeAmongKnownValues(e){let r=[];if(e){const n=W7.getJwtAlgos(),s=G7.getLdpTypes();r=[];for(const[i,o]of Object.entries(e))i.startsWith("jwt")?r.push(...Sa.isJWTAlgoKnown(o,n)):r.push(...Sa.isLDPProofKnown(o,s))}return r.length===0}static isJWTAlgoKnown(e,r){const n=[];if(e!=null&&e.alg!=null)for(const s of e.alg)r.includes(s)||n.push(s);return n}static isLDPProofKnown(e,r){const n=[];if(e!=null&&e.proof_type!=null)for(const s of e.proof_type)r.includes(s)||n.push(s);return n}static groupShouldMatchSubmissionRequirements(e){if(e.submission_requirements!=null&&e.submission_requirements.length>0){const r=[];e.input_descriptors.forEach(a=>{a.group&&r.push(...a.group)});const n=new Set(r),s=[];Sa.flatten(e.submission_requirements).forEach(a=>{a.from&&s.push(...a.from)});const i=new Set(s);return new Set([...i].filter(a=>a!=null&&a.length>0&&!n.has(a))).size===0}return!0}static flatten(e){return e==null?void 0:e.reduce((r,n)=>r.concat(Array.isArray(n.from_nested)?this.flatten(n.from_nested):n),[])}shouldBeAsPerJsonSchema(){return e=>uV({presentation_definition:e})}}class Is extends Il{constructor(e){super(e,"presentation_submission")}getValidations(e){return[{tag:this.getTag(),target:e,predicate:r=>r!=null,message:"presentation_submission should be non null."},{tag:this.getTag(),target:e,predicate:r=>Is.nonEmptyString(r==null?void 0:r.id),message:"id should not be empty"},{tag:this.getTag(),target:e,predicate:r=>Is.nonEmptyString(r==null?void 0:r.definition_id),message:"presentation_definition_id should not be empty"},{tag:this.getTag(),target:e,predicate:r=>Is.descriptorMapMustBePresent(r==null?void 0:r.descriptor_map),message:"descriptor_map should be a non-empty list"},{tag:this.getTag(),target:e,predicate:r=>Is.idMustBeSameForEachLevelOfNesting(r==null?void 0:r.descriptor_map),message:"each descriptor should have a one id in it, on all levels"},{tag:this.getTag(),target:e,predicate:r=>Is.formatsShouldBeKnown(r==null?void 0:r.descriptor_map),message:"each format should be one of the known format"},{tag:this.getTag(),target:e,predicate:r=>Is.pathsShouldBeValidJsonPaths(r==null?void 0:r.descriptor_map),message:"each path should be a valid jsonPath"}]}static nonEmptyString(e){return e!=null&&e.length>0}static descriptorMapMustBePresent(e){return e!=null&&e.length>0}static idMustBeSameForEachLevelOfNesting(e){let r=!0;if(e!=null)for(let n=0;n<e.length;n++)r=r&&Is.isIdSameForEachLevelOfNesting(e[n],e[n].id);return r}static isIdSameForEachLevelOfNesting(e,r){let n=!0;return e!=null&&e.path_nested!=null&&(e.path_nested.id==r?n=n&&Is.isIdSameForEachLevelOfNesting(e.path_nested,r):n=!1),n}static formatsShouldBeKnown(e){let r=!0;if(e!=null){const n=["jwt","jwt_vc","jwt_vp","ldp","ldp_vc","ldp_vp"];for(let s=0;s<e.length;s++)r=Is.formatShouldBeKnown(e[s],n)}return r}static formatShouldBeKnown(e,r){let n=!0;return e!=null&&(n=r.includes(e.format)),e.path_nested!=null&&(n=n&&Is.formatShouldBeKnown(e.path_nested,r)),n}static pathsShouldBeValidJsonPaths(e){let r=!0;if(e!=null)for(let n=0;n<e.length;n++)r=Is.pathShouldBeValid(e[n],[]);return r}static pathShouldBeValid(e,r){if(e!=null){try{vr.parse(e.path)}catch{r.push(e.path)}e.path_nested!=null&&Is.pathShouldBeValid(e.path_nested,r)}if(r.length>0)throw new FE("",Be.ERROR,"These were not parsable json paths: "+JSON.stringify(r));return!0}}const mbe=t=>{const e=t.map(a=>s(a));function r(a){return new FE(a.tag,Be.ERROR,a.message)}function n(a){return new FE(a,Be.INFO,"ok")}function s(a){let u;try{a.predicate(a.target)?u=n(a.tag):u=r(a)}catch{u=r(a)}return u}const i=(a,u)=>(u.status!==Be.INFO&&a.push(u),a),o=e.reduce(i,[]);return rme(o)?o:[n("root")]};class L6{validate(e){let r=[];for(const n of e)r=r.concat(n.bundler.getValidations(n.target));return mbe(r)}}class Ud{constructor(){Se(this,"_evaluationClientWrapper");this._evaluationClientWrapper=new a0}evaluatePresentation(e,r,n){const s=(n==null?void 0:n.generatePresentationSubmission)!==void 0?n.generatePresentationSubmission:(n==null?void 0:n.presentationSubmission)!==void 0,i=cs.toInternalPresentationDefinition(e),o=JSON.parse(JSON.stringify(r)),a=cs.mapExternalVerifiablePresentationToWrappedVP(o),u=(n==null?void 0:n.presentationSubmission)||a.presentation.presentation_submission;if(!u&&!s)throw Error("Either a presentation submission as part of the VP or provided separately was expected");const l=a.presentation.holder?[a.presentation.holder]:[],c={...n,holderDIDs:l,presentationSubmission:u,generatePresentationSubmission:s},d=this._evaluationClientWrapper.evaluate(i,a.vcs,c);return d.value&&d.value.descriptor_map.length&&new a0().selectFrom(i,a.vcs,c).areRequiredCredentialsPresent!==Be.ERROR&&(d.errors=[]),d}evaluateCredentials(e,r,n){const s=cs.mapExternalVerifiableCredentialsToWrappedVcs(r);this._evaluationClientWrapper=new a0;const i=cs.toInternalPresentationDefinition(e),o=this._evaluationClientWrapper.evaluate(i,s,n);if(o.value&&o.value.descriptor_map.length){const u=new a0().selectFrom(i,s,n);o.areRequiredCredentialsPresent=u.areRequiredCredentialsPresent,o.errors=u.errors}else o.areRequiredCredentialsPresent=Be.ERROR;return o}selectFrom(e,r,n){const s=JSON.parse(JSON.stringify(r)),i=cs.toInternalPresentationDefinition(e);return this._evaluationClientWrapper=new a0,this._evaluationClientWrapper.selectFrom(i,cs.mapExternalVerifiableCredentialsToWrappedVcs(s),n)}presentationSubmissionFrom(e,r){const n=cs.toInternalPresentationDefinition(e);return this._evaluationClientWrapper.submissionFrom(n,cs.mapExternalVerifiableCredentialsToWrappedVcs(r))}presentationFrom(e,r,n){const s=(n==null?void 0:n.presentationSubmissionLocation)??fv.PRESENTATION,i=this.presentationSubmissionFrom(e,r);return{presentation:Ud.constructPresentation(r,{...n,presentationSubmission:s===fv.PRESENTATION?i:void 0}),presentationSubmissionLocation:s,presentationSubmission:i}}static constructPresentation(e,r){var o,a,u,l;const n=r==null?void 0:r.holderDID,s=Array.isArray((o=r==null?void 0:r.basePresentationPayload)==null?void 0:o.type)?((a=r==null?void 0:r.basePresentationPayload)==null?void 0:a.type)||[]:(u=r==null?void 0:r.basePresentationPayload)!=null&&u.type?[r.basePresentationPayload.type]:[],i=(l=r==null?void 0:r.basePresentationPayload)!=null&&l["@context"]?Array.isArray(r.basePresentationPayload["@context"])?r.basePresentationPayload["@context"]:[r.basePresentationPayload["@context"]]:[];return i.includes("https://www.w3.org/2018/credentials/v1")||i.push("https://www.w3.org/2018/credentials/v1"),s.includes("VerifiablePresentation")||s.push("VerifiablePresentation"),r!=null&&r.presentationSubmission&&(s.includes("PresentationSubmission")||s.push("PresentationSubmission"),i.includes("https://identity.foundation/presentation-exchange/submission/v1")||i.push("https://identity.foundation/presentation-exchange/submission/v1")),{...r==null?void 0:r.basePresentationPayload,"@context":i,type:s,holder:n,...!!(r!=null&&r.presentationSubmission)&&{presentation_submission:r.presentationSubmission},verifiableCredential:Array.isArray(e)?e:[e]}}static validateDefinition(e){const r=pP(e);if(r.error)throw r.error;const n=[];return r.version===Ma.v1?n.push({bundler:new Mo("root"),target:cs.modelEntityToInternalPresentationDefinitionV1(e)}):n.push({bundler:new Sa("root"),target:cs.modelEntityInternalPresentationDefinitionV2(e)}),new L6().validate(n)}static validateSubmission(e){return new L6().validate([{bundler:new Is("root"),target:e}])}async verifiablePresentationFrom(e,r,n,s){const{holderDID:i,signatureOptions:o,proofOptions:a}=s,u=s.presentationSubmissionLocation??fv.PRESENTATION;function l(){let _=[];if(a!=null&&a.typeSupportsSelectiveDisclosure){if(!(a!=null&&a.type))throw Error("Please provide a proof type if you enable selective disclosure");_=[a.type]}return _}const c=i?[i]:[],d=l(),h=this.evaluateCredentials(e,r,{holderDIDs:c,limitDisclosureSignatureSuites:d}),f=this.presentationFrom(e,h.verifiableCredential,{...s,presentationSubmissionLocation:u}),p=this.evaluatePresentation(e,f.presentation,{limitDisclosureSignatureSuites:d});if(!p.value)throw new Error("Could not get evaluation results from presentationResult");const m={type:a==null?void 0:a.type,verificationMethod:o==null?void 0:o.verificationMethod,created:a!=null&&a.created?a.created:new Date().toISOString(),proofPurpose:a==null?void 0:a.proofPurpose,proofValue:o==null?void 0:o.proofValue,jws:o==null?void 0:o.jws,challenge:a==null?void 0:a.challenge,nonce:a==null?void 0:a.nonce,domain:a==null?void 0:a.domain},E={options:s,presentation:f.presentation,presentationDefinition:e,selectedCredentials:r,proof:m,presentationSubmission:p.value,evaluationResults:p};return{verifiablePresentation:await n(E),presentationSubmissionLocation:u,presentationSubmission:p.value}}static definitionVersionDiscovery(e){return pP(e)}}class GE{static selectCredentials({vcJwts:e,presentationDefinition:r}){var n,s;this.resetPex();const i=this.pex.selectFrom(r,e);return((n=i.errors)===null||n===void 0?void 0:n.length)!==0?[]:Array.from(new Set((s=i.verifiableCredential)!==null&&s!==void 0?s:[]))}static satisfiesPresentationDefinition({vcJwts:e,presentationDefinition:r}){var n,s,i;this.resetPex();const o=this.pex.evaluateCredentials(r,e);if(!((n=o.warnings)===null||n===void 0)&&n.length&&console.warn("Warnings were generated during the evaluation process: "+JSON.stringify(o.warnings)),o.areRequiredCredentialsPresent.toString()!=="info"||!((s=o.errors)===null||s===void 0)&&s.length){let a="Failed to create Verifiable Presentation JWT due to: ";throw o.areRequiredCredentialsPresent&&(a+="Required Credentials Not Present: "+JSON.stringify(o.areRequiredCredentialsPresent)),!((i=o.errors)===null||i===void 0)&&i.length&&(a+="Errors: "+JSON.stringify(o.errors)),new Error(a)}}static createPresentationFromCredentials({vcJwts:e,presentationDefinition:r}){var n,s,i;this.resetPex();const o=Ud.validateDefinition(r);K6(o);const a=this.pex.evaluateCredentials(r,e);if(!((n=a.warnings)===null||n===void 0)&&n.length&&console.warn("Warnings were generated during the evaluation process: "+JSON.stringify(a.warnings)),a.areRequiredCredentialsPresent.toString()!=="info"||!((s=a.errors)===null||s===void 0)&&s.length){let c="Failed to create Verifiable Presentation JWT due to: ";throw a.areRequiredCredentialsPresent&&(c+="Required Credentials Not Present: "+JSON.stringify(a.areRequiredCredentialsPresent)),!((i=a.errors)===null||i===void 0)&&i.length&&(c+="Errors: "+JSON.stringify(a.errors)),new Error(c)}const u=this.pex.presentationFrom(r,e),l=Ud.validateSubmission(u.presentationSubmission);return K6(l),u}static validateDefinition({presentationDefinition:e}){return Ud.validateDefinition(e)}static validateSubmission({presentationSubmission:e}){return Ud.validateSubmission(e)}static evaluatePresentation({presentationDefinition:e,presentation:r}){return this.resetPex(),this.pex.evaluatePresentation(e,r)}static resetPex(){this.pex=new Ud}}GE.pex=new Ud;function K6(t){let e="Failed to pass validation check due to: ";if(Array.isArray(t)){if(!t.every(r=>r.status==="info"))throw e+="Validation Errors: "+JSON.stringify(t),new Error(e)}else if(t.status!=="info")throw e+="Validation Errors: "+JSON.stringify(t),new Error(e)}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const ybe=4,V6=0,q6=1,gbe=2;function Yy(t){let e=t.length;for(;--e>=0;)t[e]=0}const vbe=0,J7=1,wbe=2,_be=3,bbe=258,Yk=29,Xw=256,Qv=Xw+1+Yk,ty=30,Zk=19,X7=2*Qv+1,Mh=15,eD=16,Ebe=7,Qk=256,Y7=16,Z7=17,Q7=18,DP=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),V1=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Abe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),eq=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Sbe=512,zc=new Array((Qv+2)*2);Yy(zc);const hv=new Array(ty*2);Yy(hv);const ew=new Array(Sbe);Yy(ew);const tw=new Array(bbe-_be+1);Yy(tw);const e$=new Array(Yk);Yy(e$);const JE=new Array(ty);Yy(JE);function tD(t,e,r,n,s){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=s,this.has_stree=t&&t.length}let tq,rq,nq;function rD(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}const iq=t=>t<256?ew[t]:ew[256+(t>>>7)],rw=(t,e)=>{t.pending_buf[t.pending++]=e&255,t.pending_buf[t.pending++]=e>>>8&255},Ls=(t,e,r)=>{t.bi_valid>eD-r?(t.bi_buf|=e<<t.bi_valid&65535,rw(t,t.bi_buf),t.bi_buf=e>>eD-t.bi_valid,t.bi_valid+=r-eD):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)},Pu=(t,e,r)=>{Ls(t,r[e*2],r[e*2+1])},sq=(t,e)=>{let r=0;do r|=t&1,t>>>=1,r<<=1;while(--e>0);return r>>>1},Tbe=t=>{t.bi_valid===16?(rw(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)},Dbe=(t,e)=>{const r=e.dyn_tree,n=e.max_code,s=e.stat_desc.static_tree,i=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,u=e.stat_desc.max_length;let l,c,d,h,f,p,m=0;for(h=0;h<=Mh;h++)t.bl_count[h]=0;for(r[t.heap[t.heap_max]*2+1]=0,l=t.heap_max+1;l<X7;l++)c=t.heap[l],h=r[r[c*2+1]*2+1]+1,h>u&&(h=u,m++),r[c*2+1]=h,!(c>n)&&(t.bl_count[h]++,f=0,c>=a&&(f=o[c-a]),p=r[c*2],t.opt_len+=p*(h+f),i&&(t.static_len+=p*(s[c*2+1]+f)));if(m!==0){do{for(h=u-1;t.bl_count[h]===0;)h--;t.bl_count[h]--,t.bl_count[h+1]+=2,t.bl_count[u]--,m-=2}while(m>0);for(h=u;h!==0;h--)for(c=t.bl_count[h];c!==0;)d=t.heap[--l],!(d>n)&&(r[d*2+1]!==h&&(t.opt_len+=(h-r[d*2+1])*r[d*2],r[d*2+1]=h),c--)}},oq=(t,e,r)=>{const n=new Array(Mh+1);let s=0,i,o;for(i=1;i<=Mh;i++)s=s+r[i-1]<<1,n[i]=s;for(o=0;o<=e;o++){let a=t[o*2+1];a!==0&&(t[o*2]=sq(n[a]++,a))}},xbe=()=>{let t,e,r,n,s;const i=new Array(Mh+1);for(r=0,n=0;n<Yk-1;n++)for(e$[n]=r,t=0;t<1<<DP[n];t++)tw[r++]=n;for(tw[r-1]=n,s=0,n=0;n<16;n++)for(JE[n]=s,t=0;t<1<<V1[n];t++)ew[s++]=n;for(s>>=7;n<ty;n++)for(JE[n]=s<<7,t=0;t<1<<V1[n]-7;t++)ew[256+s++]=n;for(e=0;e<=Mh;e++)i[e]=0;for(t=0;t<=143;)zc[t*2+1]=8,t++,i[8]++;for(;t<=255;)zc[t*2+1]=9,t++,i[9]++;for(;t<=279;)zc[t*2+1]=7,t++,i[7]++;for(;t<=287;)zc[t*2+1]=8,t++,i[8]++;for(oq(zc,Qv+1,i),t=0;t<ty;t++)hv[t*2+1]=5,hv[t*2]=sq(t,5);tq=new tD(zc,DP,Xw+1,Qv,Mh),rq=new tD(hv,V1,0,ty,Mh),nq=new tD(new Array(0),Abe,0,Zk,Ebe)},aq=t=>{let e;for(e=0;e<Qv;e++)t.dyn_ltree[e*2]=0;for(e=0;e<ty;e++)t.dyn_dtree[e*2]=0;for(e=0;e<Zk;e++)t.bl_tree[e*2]=0;t.dyn_ltree[Qk*2]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},uq=t=>{t.bi_valid>8?rw(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},H6=(t,e,r,n)=>{const s=e*2,i=r*2;return t[s]<t[i]||t[s]===t[i]&&n[e]<=n[r]},nD=(t,e,r)=>{const n=t.heap[r];let s=r<<1;for(;s<=t.heap_len&&(s<t.heap_len&&H6(e,t.heap[s+1],t.heap[s],t.depth)&&s++,!H6(e,n,t.heap[s],t.depth));)t.heap[r]=t.heap[s],r=s,s<<=1;t.heap[r]=n},z6=(t,e,r)=>{let n,s,i=0,o,a;if(t.sym_next!==0)do n=t.pending_buf[t.sym_buf+i++]&255,n+=(t.pending_buf[t.sym_buf+i++]&255)<<8,s=t.pending_buf[t.sym_buf+i++],n===0?Pu(t,s,e):(o=tw[s],Pu(t,o+Xw+1,e),a=DP[o],a!==0&&(s-=e$[o],Ls(t,s,a)),n--,o=iq(n),Pu(t,o,r),a=V1[o],a!==0&&(n-=JE[o],Ls(t,n,a)));while(i<t.sym_next);Pu(t,Qk,e)},xP=(t,e)=>{const r=e.dyn_tree,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,i=e.stat_desc.elems;let o,a,u=-1,l;for(t.heap_len=0,t.heap_max=X7,o=0;o<i;o++)r[o*2]!==0?(t.heap[++t.heap_len]=u=o,t.depth[o]=0):r[o*2+1]=0;for(;t.heap_len<2;)l=t.heap[++t.heap_len]=u<2?++u:0,r[l*2]=1,t.depth[l]=0,t.opt_len--,s&&(t.static_len-=n[l*2+1]);for(e.max_code=u,o=t.heap_len>>1;o>=1;o--)nD(t,r,o);l=i;do o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],nD(t,r,1),a=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=a,r[l*2]=r[o*2]+r[a*2],t.depth[l]=(t.depth[o]>=t.depth[a]?t.depth[o]:t.depth[a])+1,r[o*2+1]=r[a*2+1]=l,t.heap[1]=l++,nD(t,r,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],Dbe(t,e),oq(r,u,t.bl_count)},W6=(t,e,r)=>{let n,s=-1,i,o=e[0*2+1],a=0,u=7,l=4;for(o===0&&(u=138,l=3),e[(r+1)*2+1]=65535,n=0;n<=r;n++)i=o,o=e[(n+1)*2+1],!(++a<u&&i===o)&&(a<l?t.bl_tree[i*2]+=a:i!==0?(i!==s&&t.bl_tree[i*2]++,t.bl_tree[Y7*2]++):a<=10?t.bl_tree[Z7*2]++:t.bl_tree[Q7*2]++,a=0,s=i,o===0?(u=138,l=3):i===o?(u=6,l=3):(u=7,l=4))},G6=(t,e,r)=>{let n,s=-1,i,o=e[0*2+1],a=0,u=7,l=4;for(o===0&&(u=138,l=3),n=0;n<=r;n++)if(i=o,o=e[(n+1)*2+1],!(++a<u&&i===o)){if(a<l)do Pu(t,i,t.bl_tree);while(--a!==0);else i!==0?(i!==s&&(Pu(t,i,t.bl_tree),a--),Pu(t,Y7,t.bl_tree),Ls(t,a-3,2)):a<=10?(Pu(t,Z7,t.bl_tree),Ls(t,a-3,3)):(Pu(t,Q7,t.bl_tree),Ls(t,a-11,7));a=0,s=i,o===0?(u=138,l=3):i===o?(u=6,l=3):(u=7,l=4)}},Pbe=t=>{let e;for(W6(t,t.dyn_ltree,t.l_desc.max_code),W6(t,t.dyn_dtree,t.d_desc.max_code),xP(t,t.bl_desc),e=Zk-1;e>=3&&t.bl_tree[eq[e]*2+1]===0;e--);return t.opt_len+=3*(e+1)+5+5+4,e},Cbe=(t,e,r,n)=>{let s;for(Ls(t,e-257,5),Ls(t,r-1,5),Ls(t,n-4,4),s=0;s<n;s++)Ls(t,t.bl_tree[eq[s]*2+1],3);G6(t,t.dyn_ltree,e-1),G6(t,t.dyn_dtree,r-1)},Ibe=t=>{let e=4093624447,r;for(r=0;r<=31;r++,e>>>=1)if(e&1&&t.dyn_ltree[r*2]!==0)return V6;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return q6;for(r=32;r<Xw;r++)if(t.dyn_ltree[r*2]!==0)return q6;return V6};let J6=!1;const kbe=t=>{J6||(xbe(),J6=!0),t.l_desc=new rD(t.dyn_ltree,tq),t.d_desc=new rD(t.dyn_dtree,rq),t.bl_desc=new rD(t.bl_tree,nq),t.bi_buf=0,t.bi_valid=0,aq(t)},cq=(t,e,r,n)=>{Ls(t,(vbe<<1)+(n?1:0),3),uq(t),rw(t,r),rw(t,~r),r&&t.pending_buf.set(t.window.subarray(e,e+r),t.pending),t.pending+=r},$be=t=>{Ls(t,J7<<1,3),Pu(t,Qk,zc),Tbe(t)},Obe=(t,e,r,n)=>{let s,i,o=0;t.level>0?(t.strm.data_type===gbe&&(t.strm.data_type=Ibe(t)),xP(t,t.l_desc),xP(t,t.d_desc),o=Pbe(t),s=t.opt_len+3+7>>>3,i=t.static_len+3+7>>>3,i<=s&&(s=i)):s=i=r+5,r+4<=s&&e!==-1?cq(t,e,r,n):t.strategy===ybe||i===s?(Ls(t,(J7<<1)+(n?1:0),3),z6(t,zc,hv)):(Ls(t,(wbe<<1)+(n?1:0),3),Cbe(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),z6(t,t.dyn_ltree,t.dyn_dtree)),aq(t),n&&uq(t)},Rbe=(t,e,r)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=r,e===0?t.dyn_ltree[r*2]++:(t.matches++,e--,t.dyn_ltree[(tw[r]+Xw+1)*2]++,t.dyn_dtree[iq(e)*2]++),t.sym_next===t.sym_end);var Nbe=kbe,Bbe=cq,Fbe=Obe,Mbe=Rbe,jbe=$be,Ube={_tr_init:Nbe,_tr_stored_block:Bbe,_tr_flush_block:Fbe,_tr_tally:Mbe,_tr_align:jbe};const Lbe=(t,e,r,n)=>{let s=t&65535|0,i=t>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do s=s+e[n++]|0,i=i+s|0;while(--o);s%=65521,i%=65521}return s|i<<16|0};var nw=Lbe;const Kbe=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},Vbe=new Uint32Array(Kbe()),qbe=(t,e,r,n)=>{const s=Vbe,i=n+r;t^=-1;for(let o=n;o<i;o++)t=t>>>8^s[(t^e[o])&255];return t^-1};var Qn=qbe,iw={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},IS={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Hbe,_tr_stored_block:PP,_tr_flush_block:zbe,_tr_tally:rf,_tr_align:Wbe}=Ube,{Z_NO_FLUSH:nf,Z_PARTIAL_FLUSH:Gbe,Z_FULL_FLUSH:Jbe,Z_FINISH:Zo,Z_BLOCK:X6,Z_OK:Di,Z_STREAM_END:Y6,Z_STREAM_ERROR:Lu,Z_DATA_ERROR:Xbe,Z_BUF_ERROR:iD,Z_DEFAULT_COMPRESSION:Ybe,Z_FILTERED:Zbe,Z_HUFFMAN_ONLY:Mb,Z_RLE:Qbe,Z_FIXED:e1e,Z_DEFAULT_STRATEGY:t1e,Z_UNKNOWN:r1e,Z_DEFLATED:kS}=IS,n1e=9,i1e=15,s1e=8,o1e=29,a1e=256,CP=a1e+1+o1e,u1e=30,c1e=19,l1e=2*CP+1,d1e=15,or=3,Jd=258,Ku=Jd+or+1,f1e=32,Ty=42,t$=57,IP=69,kP=73,$P=91,OP=103,jh=113,j0=666,gs=1,Zy=2,Ep=3,Qy=4,h1e=3,Uh=(t,e)=>(t.msg=iw[e],e),Z6=t=>t*2-(t>4?9:0),Ld=t=>{let e=t.length;for(;--e>=0;)t[e]=0},p1e=t=>{let e,r,n,s=t.w_size;e=t.hash_size,n=e;do r=t.head[--n],t.head[n]=r>=s?r-s:0;while(--e);e=s,n=e;do r=t.prev[--n],t.prev[n]=r>=s?r-s:0;while(--e)};let m1e=(t,e,r)=>(e<<t.hash_shift^r)&t.hash_mask,sf=m1e;const to=t=>{const e=t.state;let r=e.pending;r>t.avail_out&&(r=t.avail_out),r!==0&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+r),t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,e.pending===0&&(e.pending_out=0))},po=(t,e)=>{zbe(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,to(t.strm)},pr=(t,e)=>{t.pending_buf[t.pending++]=e},u0=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=e&255},RP=(t,e,r,n)=>{let s=t.avail_in;return s>n&&(s=n),s===0?0:(t.avail_in-=s,e.set(t.input.subarray(t.next_in,t.next_in+s),r),t.state.wrap===1?t.adler=nw(t.adler,e,s,r):t.state.wrap===2&&(t.adler=Qn(t.adler,e,s,r)),t.next_in+=s,t.total_in+=s,s)},lq=(t,e)=>{let r=t.max_chain_length,n=t.strstart,s,i,o=t.prev_length,a=t.nice_match;const u=t.strstart>t.w_size-Ku?t.strstart-(t.w_size-Ku):0,l=t.window,c=t.w_mask,d=t.prev,h=t.strstart+Jd;let f=l[n+o-1],p=l[n+o];t.prev_length>=t.good_match&&(r>>=2),a>t.lookahead&&(a=t.lookahead);do if(s=e,!(l[s+o]!==p||l[s+o-1]!==f||l[s]!==l[n]||l[++s]!==l[n+1])){n+=2,s++;do;while(l[++n]===l[++s]&&l[++n]===l[++s]&&l[++n]===l[++s]&&l[++n]===l[++s]&&l[++n]===l[++s]&&l[++n]===l[++s]&&l[++n]===l[++s]&&l[++n]===l[++s]&&n<h);if(i=Jd-(h-n),n=h-Jd,i>o){if(t.match_start=e,o=i,i>=a)break;f=l[n+o-1],p=l[n+o]}}while((e=d[e&c])>u&&--r!==0);return o<=t.lookahead?o:t.lookahead},Dy=t=>{const e=t.w_size;let r,n,s;do{if(n=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-Ku)&&(t.window.set(t.window.subarray(e,e+e-n),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),p1e(t),n+=e),t.strm.avail_in===0)break;if(r=RP(t.strm,t.window,t.strstart+t.lookahead,n),t.lookahead+=r,t.lookahead+t.insert>=or)for(s=t.strstart-t.insert,t.ins_h=t.window[s],t.ins_h=sf(t,t.ins_h,t.window[s+1]);t.insert&&(t.ins_h=sf(t,t.ins_h,t.window[s+or-1]),t.prev[s&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=s,s++,t.insert--,!(t.lookahead+t.insert<or)););}while(t.lookahead<Ku&&t.strm.avail_in!==0)},dq=(t,e)=>{let r=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,n,s,i,o=0,a=t.strm.avail_in;do{if(n=65535,i=t.bi_valid+42>>3,t.strm.avail_out<i||(i=t.strm.avail_out-i,s=t.strstart-t.block_start,n>s+t.strm.avail_in&&(n=s+t.strm.avail_in),n>i&&(n=i),n<r&&(n===0&&e!==Zo||e===nf||n!==s+t.strm.avail_in)))break;o=e===Zo&&n===s+t.strm.avail_in?1:0,PP(t,0,0,o),t.pending_buf[t.pending-4]=n,t.pending_buf[t.pending-3]=n>>8,t.pending_buf[t.pending-2]=~n,t.pending_buf[t.pending-1]=~n>>8,to(t.strm),s&&(s>n&&(s=n),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+s),t.strm.next_out),t.strm.next_out+=s,t.strm.avail_out-=s,t.strm.total_out+=s,t.block_start+=s,n-=s),n&&(RP(t.strm,t.strm.output,t.strm.next_out,n),t.strm.next_out+=n,t.strm.avail_out-=n,t.strm.total_out+=n)}while(o===0);return a-=t.strm.avail_in,a&&(a>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=a&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-a,t.strm.next_in),t.strstart),t.strstart+=a,t.insert+=a>t.w_size-t.insert?t.w_size-t.insert:a),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),o?Qy:e!==nf&&e!==Zo&&t.strm.avail_in===0&&t.strstart===t.block_start?Zy:(i=t.window_size-t.strstart,t.strm.avail_in>i&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,i+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),i>t.strm.avail_in&&(i=t.strm.avail_in),i&&(RP(t.strm,t.window,t.strstart,i),t.strstart+=i,t.insert+=i>t.w_size-t.insert?t.w_size-t.insert:i),t.high_water<t.strstart&&(t.high_water=t.strstart),i=t.bi_valid+42>>3,i=t.pending_buf_size-i>65535?65535:t.pending_buf_size-i,r=i>t.w_size?t.w_size:i,s=t.strstart-t.block_start,(s>=r||(s||e===Zo)&&e!==nf&&t.strm.avail_in===0&&s<=i)&&(n=s>i?i:s,o=e===Zo&&t.strm.avail_in===0&&n===s?1:0,PP(t,t.block_start,n,o),t.block_start+=n,to(t.strm)),o?Ep:gs)},sD=(t,e)=>{let r,n;for(;;){if(t.lookahead<Ku){if(Dy(t),t.lookahead<Ku&&e===nf)return gs;if(t.lookahead===0)break}if(r=0,t.lookahead>=or&&(t.ins_h=sf(t,t.ins_h,t.window[t.strstart+or-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),r!==0&&t.strstart-r<=t.w_size-Ku&&(t.match_length=lq(t,r)),t.match_length>=or)if(n=rf(t,t.strstart-t.match_start,t.match_length-or),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=or){t.match_length--;do t.strstart++,t.ins_h=sf(t,t.ins_h,t.window[t.strstart+or-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!==0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=sf(t,t.ins_h,t.window[t.strstart+1]);else n=rf(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(po(t,!1),t.strm.avail_out===0))return gs}return t.insert=t.strstart<or-1?t.strstart:or-1,e===Zo?(po(t,!0),t.strm.avail_out===0?Ep:Qy):t.sym_next&&(po(t,!1),t.strm.avail_out===0)?gs:Zy},fm=(t,e)=>{let r,n,s;for(;;){if(t.lookahead<Ku){if(Dy(t),t.lookahead<Ku&&e===nf)return gs;if(t.lookahead===0)break}if(r=0,t.lookahead>=or&&(t.ins_h=sf(t,t.ins_h,t.window[t.strstart+or-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=or-1,r!==0&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-Ku&&(t.match_length=lq(t,r),t.match_length<=5&&(t.strategy===Zbe||t.match_length===or&&t.strstart-t.match_start>4096)&&(t.match_length=or-1)),t.prev_length>=or&&t.match_length<=t.prev_length){s=t.strstart+t.lookahead-or,n=rf(t,t.strstart-1-t.prev_match,t.prev_length-or),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=s&&(t.ins_h=sf(t,t.ins_h,t.window[t.strstart+or-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!==0);if(t.match_available=0,t.match_length=or-1,t.strstart++,n&&(po(t,!1),t.strm.avail_out===0))return gs}else if(t.match_available){if(n=rf(t,0,t.window[t.strstart-1]),n&&po(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return gs}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=rf(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<or-1?t.strstart:or-1,e===Zo?(po(t,!0),t.strm.avail_out===0?Ep:Qy):t.sym_next&&(po(t,!1),t.strm.avail_out===0)?gs:Zy},y1e=(t,e)=>{let r,n,s,i;const o=t.window;for(;;){if(t.lookahead<=Jd){if(Dy(t),t.lookahead<=Jd&&e===nf)return gs;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=or&&t.strstart>0&&(s=t.strstart-1,n=o[s],n===o[++s]&&n===o[++s]&&n===o[++s])){i=t.strstart+Jd;do;while(n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&s<i);t.match_length=Jd-(i-s),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=or?(r=rf(t,1,t.match_length-or),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=rf(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(po(t,!1),t.strm.avail_out===0))return gs}return t.insert=0,e===Zo?(po(t,!0),t.strm.avail_out===0?Ep:Qy):t.sym_next&&(po(t,!1),t.strm.avail_out===0)?gs:Zy},g1e=(t,e)=>{let r;for(;;){if(t.lookahead===0&&(Dy(t),t.lookahead===0)){if(e===nf)return gs;break}if(t.match_length=0,r=rf(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(po(t,!1),t.strm.avail_out===0))return gs}return t.insert=0,e===Zo?(po(t,!0),t.strm.avail_out===0?Ep:Qy):t.sym_next&&(po(t,!1),t.strm.avail_out===0)?gs:Zy};function iu(t,e,r,n,s){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=s}const U0=[new iu(0,0,0,0,dq),new iu(4,4,8,4,sD),new iu(4,5,16,8,sD),new iu(4,6,32,32,sD),new iu(4,4,16,16,fm),new iu(8,16,32,32,fm),new iu(8,16,128,128,fm),new iu(8,32,128,256,fm),new iu(32,128,258,1024,fm),new iu(32,258,258,4096,fm)],v1e=t=>{t.window_size=2*t.w_size,Ld(t.head),t.max_lazy_match=U0[t.level].max_lazy,t.good_match=U0[t.level].good_length,t.nice_match=U0[t.level].nice_length,t.max_chain_length=U0[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=or-1,t.match_available=0,t.ins_h=0};function w1e(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=kS,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(l1e*2),this.dyn_dtree=new Uint16Array((2*u1e+1)*2),this.bl_tree=new Uint16Array((2*c1e+1)*2),Ld(this.dyn_ltree),Ld(this.dyn_dtree),Ld(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(d1e+1),this.heap=new Uint16Array(2*CP+1),Ld(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*CP+1),Ld(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Yw=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.status!==Ty&&e.status!==t$&&e.status!==IP&&e.status!==kP&&e.status!==$P&&e.status!==OP&&e.status!==jh&&e.status!==j0?1:0},fq=t=>{if(Yw(t))return Uh(t,Lu);t.total_in=t.total_out=0,t.data_type=r1e;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap===2?t$:e.wrap?Ty:jh,t.adler=e.wrap===2?0:1,e.last_flush=-2,Hbe(e),Di},hq=t=>{const e=fq(t);return e===Di&&v1e(t.state),e},_1e=(t,e)=>Yw(t)||t.state.wrap!==2?Lu:(t.state.gzhead=e,Di),pq=(t,e,r,n,s,i)=>{if(!t)return Lu;let o=1;if(e===Ybe&&(e=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),s<1||s>n1e||r!==kS||n<8||n>15||e<0||e>9||i<0||i>e1e||n===8&&o!==1)return Uh(t,Lu);n===8&&(n=9);const a=new w1e;return t.state=a,a.strm=t,a.status=Ty,a.wrap=o,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=s+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+or-1)/or),a.window=new Uint8Array(a.w_size*2),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<s+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=(a.lit_bufsize-1)*3,a.level=e,a.strategy=i,a.method=r,hq(t)},b1e=(t,e)=>pq(t,e,kS,i1e,s1e,t1e),E1e=(t,e)=>{if(Yw(t)||e>X6||e<0)return t?Uh(t,Lu):Lu;const r=t.state;if(!t.output||t.avail_in!==0&&!t.input||r.status===j0&&e!==Zo)return Uh(t,t.avail_out===0?iD:Lu);const n=r.last_flush;if(r.last_flush=e,r.pending!==0){if(to(t),t.avail_out===0)return r.last_flush=-1,Di}else if(t.avail_in===0&&Z6(e)<=Z6(n)&&e!==Zo)return Uh(t,iD);if(r.status===j0&&t.avail_in!==0)return Uh(t,iD);if(r.status===Ty&&r.wrap===0&&(r.status=jh),r.status===Ty){let s=kS+(r.w_bits-8<<4)<<8,i=-1;if(r.strategy>=Mb||r.level<2?i=0:r.level<6?i=1:r.level===6?i=2:i=3,s|=i<<6,r.strstart!==0&&(s|=f1e),s+=31-s%31,u0(r,s),r.strstart!==0&&(u0(r,t.adler>>>16),u0(r,t.adler&65535)),t.adler=1,r.status=jh,to(t),r.pending!==0)return r.last_flush=-1,Di}if(r.status===t$){if(t.adler=0,pr(r,31),pr(r,139),pr(r,8),r.gzhead)pr(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),pr(r,r.gzhead.time&255),pr(r,r.gzhead.time>>8&255),pr(r,r.gzhead.time>>16&255),pr(r,r.gzhead.time>>24&255),pr(r,r.level===9?2:r.strategy>=Mb||r.level<2?4:0),pr(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(pr(r,r.gzhead.extra.length&255),pr(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=Qn(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=IP;else if(pr(r,0),pr(r,0),pr(r,0),pr(r,0),pr(r,0),pr(r,r.level===9?2:r.strategy>=Mb||r.level<2?4:0),pr(r,h1e),r.status=jh,to(t),r.pending!==0)return r.last_flush=-1,Di}if(r.status===IP){if(r.gzhead.extra){let s=r.pending,i=(r.gzhead.extra.length&65535)-r.gzindex;for(;r.pending+i>r.pending_buf_size;){let a=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+a),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>s&&(t.adler=Qn(t.adler,r.pending_buf,r.pending-s,s)),r.gzindex+=a,to(t),r.pending!==0)return r.last_flush=-1,Di;s=0,i-=a}let o=new Uint8Array(r.gzhead.extra);r.pending_buf.set(o.subarray(r.gzindex,r.gzindex+i),r.pending),r.pending+=i,r.gzhead.hcrc&&r.pending>s&&(t.adler=Qn(t.adler,r.pending_buf,r.pending-s,s)),r.gzindex=0}r.status=kP}if(r.status===kP){if(r.gzhead.name){let s=r.pending,i;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>s&&(t.adler=Qn(t.adler,r.pending_buf,r.pending-s,s)),to(t),r.pending!==0)return r.last_flush=-1,Di;s=0}r.gzindex<r.gzhead.name.length?i=r.gzhead.name.charCodeAt(r.gzindex++)&255:i=0,pr(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>s&&(t.adler=Qn(t.adler,r.pending_buf,r.pending-s,s)),r.gzindex=0}r.status=$P}if(r.status===$P){if(r.gzhead.comment){let s=r.pending,i;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>s&&(t.adler=Qn(t.adler,r.pending_buf,r.pending-s,s)),to(t),r.pending!==0)return r.last_flush=-1,Di;s=0}r.gzindex<r.gzhead.comment.length?i=r.gzhead.comment.charCodeAt(r.gzindex++)&255:i=0,pr(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>s&&(t.adler=Qn(t.adler,r.pending_buf,r.pending-s,s))}r.status=OP}if(r.status===OP){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(to(t),r.pending!==0))return r.last_flush=-1,Di;pr(r,t.adler&255),pr(r,t.adler>>8&255),t.adler=0}if(r.status=jh,to(t),r.pending!==0)return r.last_flush=-1,Di}if(t.avail_in!==0||r.lookahead!==0||e!==nf&&r.status!==j0){let s=r.level===0?dq(r,e):r.strategy===Mb?g1e(r,e):r.strategy===Qbe?y1e(r,e):U0[r.level].func(r,e);if((s===Ep||s===Qy)&&(r.status=j0),s===gs||s===Ep)return t.avail_out===0&&(r.last_flush=-1),Di;if(s===Zy&&(e===Gbe?Wbe(r):e!==X6&&(PP(r,0,0,!1),e===Jbe&&(Ld(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),to(t),t.avail_out===0))return r.last_flush=-1,Di}return e!==Zo?Di:r.wrap<=0?Y6:(r.wrap===2?(pr(r,t.adler&255),pr(r,t.adler>>8&255),pr(r,t.adler>>16&255),pr(r,t.adler>>24&255),pr(r,t.total_in&255),pr(r,t.total_in>>8&255),pr(r,t.total_in>>16&255),pr(r,t.total_in>>24&255)):(u0(r,t.adler>>>16),u0(r,t.adler&65535)),to(t),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?Di:Y6)},A1e=t=>{if(Yw(t))return Lu;const e=t.state.status;return t.state=null,e===jh?Uh(t,Xbe):Di},S1e=(t,e)=>{let r=e.length;if(Yw(t))return Lu;const n=t.state,s=n.wrap;if(s===2||s===1&&n.status!==Ty||n.lookahead)return Lu;if(s===1&&(t.adler=nw(t.adler,e,r,0)),n.wrap=0,r>=n.w_size){s===0&&(Ld(n.head),n.strstart=0,n.block_start=0,n.insert=0);let u=new Uint8Array(n.w_size);u.set(e.subarray(r-n.w_size,r),0),e=u,r=n.w_size}const i=t.avail_in,o=t.next_in,a=t.input;for(t.avail_in=r,t.next_in=0,t.input=e,Dy(n);n.lookahead>=or;){let u=n.strstart,l=n.lookahead-(or-1);do n.ins_h=sf(n,n.ins_h,n.window[u+or-1]),n.prev[u&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=u,u++;while(--l);n.strstart=u,n.lookahead=or-1,Dy(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=or-1,n.match_available=0,t.next_in=o,t.input=a,t.avail_in=i,n.wrap=s,Di};var T1e=b1e,D1e=pq,x1e=hq,P1e=fq,C1e=_1e,I1e=E1e,k1e=A1e,$1e=S1e,O1e="pako deflate (from Nodeca project)",pv={deflateInit:T1e,deflateInit2:D1e,deflateReset:x1e,deflateResetKeep:P1e,deflateSetHeader:C1e,deflate:I1e,deflateEnd:k1e,deflateSetDictionary:$1e,deflateInfo:O1e};const R1e=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var N1e=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)R1e(r,n)&&(t[n]=r[n])}}return t},B1e=t=>{let e=0;for(let n=0,s=t.length;n<s;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,s=0,i=t.length;n<i;n++){let o=t[n];r.set(o,s),s+=o.length}return r},$S={assign:N1e,flattenChunks:B1e};let mq=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{mq=!1}const sw=new Uint8Array(256);for(let t=0;t<256;t++)sw[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;sw[254]=sw[254]=1;var F1e=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,s,i,o=t.length,a=0;for(s=0;s<o;s++)r=t.charCodeAt(s),(r&64512)===55296&&s+1<o&&(n=t.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),a+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(a),i=0,s=0;i<a;s++)r=t.charCodeAt(s),(r&64512)===55296&&s+1<o&&(n=t.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),r<128?e[i++]=r:r<2048?(e[i++]=192|r>>>6,e[i++]=128|r&63):r<65536?(e[i++]=224|r>>>12,e[i++]=128|r>>>6&63,e[i++]=128|r&63):(e[i++]=240|r>>>18,e[i++]=128|r>>>12&63,e[i++]=128|r>>>6&63,e[i++]=128|r&63);return e};const M1e=(t,e)=>{if(e<65534&&t.subarray&&mq)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r};var j1e=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,s;const i=new Array(r*2);for(s=0,n=0;n<r;){let o=t[n++];if(o<128){i[s++]=o;continue}let a=sw[o];if(a>4){i[s++]=65533,n+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&n<r;)o=o<<6|t[n++]&63,a--;if(a>1){i[s++]=65533;continue}o<65536?i[s++]=o:(o-=65536,i[s++]=55296|o>>10&1023,i[s++]=56320|o&1023)}return M1e(i,s)},U1e=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+sw[t[r]]>e?r:e},ow={string2buf:F1e,buf2string:j1e,utf8border:U1e};function L1e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var yq=L1e;const gq=Object.prototype.toString,{Z_NO_FLUSH:K1e,Z_SYNC_FLUSH:V1e,Z_FULL_FLUSH:q1e,Z_FINISH:H1e,Z_OK:XE,Z_STREAM_END:z1e,Z_DEFAULT_COMPRESSION:W1e,Z_DEFAULT_STRATEGY:G1e,Z_DEFLATED:J1e}=IS;function r$(t){this.options=$S.assign({level:W1e,method:J1e,chunkSize:16384,windowBits:15,memLevel:8,strategy:G1e},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new yq,this.strm.avail_out=0;let r=pv.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==XE)throw new Error(iw[r]);if(e.header&&pv.deflateSetHeader(this.strm,e.header),e.dictionary){let n;if(typeof e.dictionary=="string"?n=ow.string2buf(e.dictionary):gq.call(e.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(e.dictionary):n=e.dictionary,r=pv.deflateSetDictionary(this.strm,n),r!==XE)throw new Error(iw[r]);this._dict_set=!0}}r$.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize;let s,i;if(this.ended)return!1;for(e===~~e?i=e:i=e===!0?H1e:K1e,typeof t=="string"?r.input=ow.string2buf(t):gq.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(i===V1e||i===q1e)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(s=pv.deflate(r,i),s===z1e)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),s=pv.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===XE;if(r.avail_out===0){this.onData(r.output);continue}if(i>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0};r$.prototype.onData=function(t){this.chunks.push(t)};r$.prototype.onEnd=function(t){t===XE&&(this.result=$S.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};const jb=16209,X1e=16191;var Y1e=function(e,r){let n,s,i,o,a,u,l,c,d,h,f,p,m,E,A,_,g,v,S,x,D,w,b,T;const P=e.state;n=e.next_in,b=e.input,s=n+(e.avail_in-5),i=e.next_out,T=e.output,o=i-(r-e.avail_out),a=i+(e.avail_out-257),u=P.dmax,l=P.wsize,c=P.whave,d=P.wnext,h=P.window,f=P.hold,p=P.bits,m=P.lencode,E=P.distcode,A=(1<<P.lenbits)-1,_=(1<<P.distbits)-1;e:do{p<15&&(f+=b[n++]<<p,p+=8,f+=b[n++]<<p,p+=8),g=m[f&A];t:for(;;){if(v=g>>>24,f>>>=v,p-=v,v=g>>>16&255,v===0)T[i++]=g&65535;else if(v&16){S=g&65535,v&=15,v&&(p<v&&(f+=b[n++]<<p,p+=8),S+=f&(1<<v)-1,f>>>=v,p-=v),p<15&&(f+=b[n++]<<p,p+=8,f+=b[n++]<<p,p+=8),g=E[f&_];r:for(;;){if(v=g>>>24,f>>>=v,p-=v,v=g>>>16&255,v&16){if(x=g&65535,v&=15,p<v&&(f+=b[n++]<<p,p+=8,p<v&&(f+=b[n++]<<p,p+=8)),x+=f&(1<<v)-1,x>u){e.msg="invalid distance too far back",P.mode=jb;break e}if(f>>>=v,p-=v,v=i-o,x>v){if(v=x-v,v>c&&P.sane){e.msg="invalid distance too far back",P.mode=jb;break e}if(D=0,w=h,d===0){if(D+=l-v,v<S){S-=v;do T[i++]=h[D++];while(--v);D=i-x,w=T}}else if(d<v){if(D+=l+d-v,v-=d,v<S){S-=v;do T[i++]=h[D++];while(--v);if(D=0,d<S){v=d,S-=v;do T[i++]=h[D++];while(--v);D=i-x,w=T}}}else if(D+=d-v,v<S){S-=v;do T[i++]=h[D++];while(--v);D=i-x,w=T}for(;S>2;)T[i++]=w[D++],T[i++]=w[D++],T[i++]=w[D++],S-=3;S&&(T[i++]=w[D++],S>1&&(T[i++]=w[D++]))}else{D=i-x;do T[i++]=T[D++],T[i++]=T[D++],T[i++]=T[D++],S-=3;while(S>2);S&&(T[i++]=T[D++],S>1&&(T[i++]=T[D++]))}}else if(v&64){e.msg="invalid distance code",P.mode=jb;break e}else{g=E[(g&65535)+(f&(1<<v)-1)];continue r}break}}else if(v&64)if(v&32){P.mode=X1e;break e}else{e.msg="invalid literal/length code",P.mode=jb;break e}else{g=m[(g&65535)+(f&(1<<v)-1)];continue t}break}}while(n<s&&i<a);S=p>>3,n-=S,p-=S<<3,f&=(1<<p)-1,e.next_in=n,e.next_out=i,e.avail_in=n<s?5+(s-n):5-(n-s),e.avail_out=i<a?257+(a-i):257-(i-a),P.hold=f,P.bits=p};const hm=15,Q6=852,eM=592,tM=0,oD=1,rM=2,Z1e=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Q1e=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),eEe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),tEe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),rEe=(t,e,r,n,s,i,o,a)=>{const u=a.bits;let l=0,c=0,d=0,h=0,f=0,p=0,m=0,E=0,A=0,_=0,g,v,S,x,D,w=null,b;const T=new Uint16Array(hm+1),P=new Uint16Array(hm+1);let C=null,k,K,L;for(l=0;l<=hm;l++)T[l]=0;for(c=0;c<n;c++)T[e[r+c]]++;for(f=u,h=hm;h>=1&&T[h]===0;h--);if(f>h&&(f=h),h===0)return s[i++]=1<<24|64<<16|0,s[i++]=1<<24|64<<16|0,a.bits=1,0;for(d=1;d<h&&T[d]===0;d++);for(f<d&&(f=d),E=1,l=1;l<=hm;l++)if(E<<=1,E-=T[l],E<0)return-1;if(E>0&&(t===tM||h!==1))return-1;for(P[1]=0,l=1;l<hm;l++)P[l+1]=P[l]+T[l];for(c=0;c<n;c++)e[r+c]!==0&&(o[P[e[r+c]]++]=c);if(t===tM?(w=C=o,b=20):t===oD?(w=Z1e,C=Q1e,b=257):(w=eEe,C=tEe,b=0),_=0,c=0,l=d,D=i,p=f,m=0,S=-1,A=1<<f,x=A-1,t===oD&&A>Q6||t===rM&&A>eM)return 1;for(;;){k=l-m,o[c]+1<b?(K=0,L=o[c]):o[c]>=b?(K=C[o[c]-b],L=w[o[c]-b]):(K=96,L=0),g=1<<l-m,v=1<<p,d=v;do v-=g,s[D+(_>>m)+v]=k<<24|K<<16|L|0;while(v!==0);for(g=1<<l-1;_&g;)g>>=1;if(g!==0?(_&=g-1,_+=g):_=0,c++,--T[l]===0){if(l===h)break;l=e[r+o[c]]}if(l>f&&(_&x)!==S){for(m===0&&(m=f),D+=d,p=l-m,E=1<<p;p+m<h&&(E-=T[p+m],!(E<=0));)p++,E<<=1;if(A+=1<<p,t===oD&&A>Q6||t===rM&&A>eM)return 1;S=_&x,s[S]=f<<24|p<<16|D-i|0}}return _!==0&&(s[D+_]=l-m<<24|64<<16|0),a.bits=f,0};var mv=rEe;const nEe=0,vq=1,wq=2,{Z_FINISH:nM,Z_BLOCK:iEe,Z_TREES:Ub,Z_OK:Ap,Z_STREAM_END:sEe,Z_NEED_DICT:oEe,Z_STREAM_ERROR:la,Z_DATA_ERROR:_q,Z_MEM_ERROR:bq,Z_BUF_ERROR:aEe,Z_DEFLATED:iM}=IS,OS=16180,sM=16181,oM=16182,aM=16183,uM=16184,cM=16185,lM=16186,dM=16187,fM=16188,hM=16189,YE=16190,kc=16191,aD=16192,pM=16193,uD=16194,mM=16195,yM=16196,gM=16197,vM=16198,Lb=16199,Kb=16200,wM=16201,_M=16202,bM=16203,EM=16204,AM=16205,cD=16206,SM=16207,TM=16208,sn=16209,Eq=16210,Aq=16211,uEe=852,cEe=592,lEe=15,dEe=lEe,DM=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function fEe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const jp=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<OS||e.mode>Aq?1:0},Sq=t=>{if(jp(t))return la;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=OS,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(uEe),e.distcode=e.distdyn=new Int32Array(cEe),e.sane=1,e.back=-1,Ap},Tq=t=>{if(jp(t))return la;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Sq(t)},Dq=(t,e)=>{let r;if(jp(t))return la;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?la:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,Tq(t))},xq=(t,e)=>{if(!t)return la;const r=new fEe;t.state=r,r.strm=t,r.window=null,r.mode=OS;const n=Dq(t,e);return n!==Ap&&(t.state=null),n},hEe=t=>xq(t,dEe);let xM=!0,lD,dD;const pEe=t=>{if(xM){lD=new Int32Array(512),dD=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(mv(vq,t.lens,0,288,lD,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;mv(wq,t.lens,0,32,dD,0,t.work,{bits:5}),xM=!1}t.lencode=lD,t.lenbits=9,t.distcode=dD,t.distbits=5},Pq=(t,e,r,n)=>{let s;const i=t.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(e.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):(s=i.wsize-i.wnext,s>n&&(s=n),i.window.set(e.subarray(r-n,r-n+s),i.wnext),n-=s,n?(i.window.set(e.subarray(r-n,r),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=s,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=s))),0},mEe=(t,e)=>{let r,n,s,i,o,a,u,l,c,d,h,f,p,m,E=0,A,_,g,v,S,x,D,w;const b=new Uint8Array(4);let T,P;const C=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(jp(t)||!t.output||!t.input&&t.avail_in!==0)return la;r=t.state,r.mode===kc&&(r.mode=aD),o=t.next_out,s=t.output,u=t.avail_out,i=t.next_in,n=t.input,a=t.avail_in,l=r.hold,c=r.bits,d=a,h=u,w=Ap;e:for(;;)switch(r.mode){case OS:if(r.wrap===0){r.mode=aD;break}for(;c<16;){if(a===0)break e;a--,l+=n[i++]<<c,c+=8}if(r.wrap&2&&l===35615){r.wbits===0&&(r.wbits=15),r.check=0,b[0]=l&255,b[1]=l>>>8&255,r.check=Qn(r.check,b,2,0),l=0,c=0,r.mode=sM;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((l&255)<<8)+(l>>8))%31){t.msg="incorrect header check",r.mode=sn;break}if((l&15)!==iM){t.msg="unknown compression method",r.mode=sn;break}if(l>>>=4,c-=4,D=(l&15)+8,r.wbits===0&&(r.wbits=D),D>15||D>r.wbits){t.msg="invalid window size",r.mode=sn;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=l&512?hM:kc,l=0,c=0;break;case sM:for(;c<16;){if(a===0)break e;a--,l+=n[i++]<<c,c+=8}if(r.flags=l,(r.flags&255)!==iM){t.msg="unknown compression method",r.mode=sn;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=sn;break}r.head&&(r.head.text=l>>8&1),r.flags&512&&r.wrap&4&&(b[0]=l&255,b[1]=l>>>8&255,r.check=Qn(r.check,b,2,0)),l=0,c=0,r.mode=oM;case oM:for(;c<32;){if(a===0)break e;a--,l+=n[i++]<<c,c+=8}r.head&&(r.head.time=l),r.flags&512&&r.wrap&4&&(b[0]=l&255,b[1]=l>>>8&255,b[2]=l>>>16&255,b[3]=l>>>24&255,r.check=Qn(r.check,b,4,0)),l=0,c=0,r.mode=aM;case aM:for(;c<16;){if(a===0)break e;a--,l+=n[i++]<<c,c+=8}r.head&&(r.head.xflags=l&255,r.head.os=l>>8),r.flags&512&&r.wrap&4&&(b[0]=l&255,b[1]=l>>>8&255,r.check=Qn(r.check,b,2,0)),l=0,c=0,r.mode=uM;case uM:if(r.flags&1024){for(;c<16;){if(a===0)break e;a--,l+=n[i++]<<c,c+=8}r.length=l,r.head&&(r.head.extra_len=l),r.flags&512&&r.wrap&4&&(b[0]=l&255,b[1]=l>>>8&255,r.check=Qn(r.check,b,2,0)),l=0,c=0}else r.head&&(r.head.extra=null);r.mode=cM;case cM:if(r.flags&1024&&(f=r.length,f>a&&(f=a),f&&(r.head&&(D=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(i,i+f),D)),r.flags&512&&r.wrap&4&&(r.check=Qn(r.check,n,f,i)),a-=f,i+=f,r.length-=f),r.length))break e;r.length=0,r.mode=lM;case lM:if(r.flags&2048){if(a===0)break e;f=0;do D=n[i+f++],r.head&&D&&r.length<65536&&(r.head.name+=String.fromCharCode(D));while(D&&f<a);if(r.flags&512&&r.wrap&4&&(r.check=Qn(r.check,n,f,i)),a-=f,i+=f,D)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=dM;case dM:if(r.flags&4096){if(a===0)break e;f=0;do D=n[i+f++],r.head&&D&&r.length<65536&&(r.head.comment+=String.fromCharCode(D));while(D&&f<a);if(r.flags&512&&r.wrap&4&&(r.check=Qn(r.check,n,f,i)),a-=f,i+=f,D)break e}else r.head&&(r.head.comment=null);r.mode=fM;case fM:if(r.flags&512){for(;c<16;){if(a===0)break e;a--,l+=n[i++]<<c,c+=8}if(r.wrap&4&&l!==(r.check&65535)){t.msg="header crc mismatch",r.mode=sn;break}l=0,c=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=kc;break;case hM:for(;c<32;){if(a===0)break e;a--,l+=n[i++]<<c,c+=8}t.adler=r.check=DM(l),l=0,c=0,r.mode=YE;case YE:if(r.havedict===0)return t.next_out=o,t.avail_out=u,t.next_in=i,t.avail_in=a,r.hold=l,r.bits=c,oEe;t.adler=r.check=1,r.mode=kc;case kc:if(e===iEe||e===Ub)break e;case aD:if(r.last){l>>>=c&7,c-=c&7,r.mode=cD;break}for(;c<3;){if(a===0)break e;a--,l+=n[i++]<<c,c+=8}switch(r.last=l&1,l>>>=1,c-=1,l&3){case 0:r.mode=pM;break;case 1:if(pEe(r),r.mode=Lb,e===Ub){l>>>=2,c-=2;break e}break;case 2:r.mode=yM;break;case 3:t.msg="invalid block type",r.mode=sn}l>>>=2,c-=2;break;case pM:for(l>>>=c&7,c-=c&7;c<32;){if(a===0)break e;a--,l+=n[i++]<<c,c+=8}if((l&65535)!==(l>>>16^65535)){t.msg="invalid stored block lengths",r.mode=sn;break}if(r.length=l&65535,l=0,c=0,r.mode=uD,e===Ub)break e;case uD:r.mode=mM;case mM:if(f=r.length,f){if(f>a&&(f=a),f>u&&(f=u),f===0)break e;s.set(n.subarray(i,i+f),o),a-=f,i+=f,u-=f,o+=f,r.length-=f;break}r.mode=kc;break;case yM:for(;c<14;){if(a===0)break e;a--,l+=n[i++]<<c,c+=8}if(r.nlen=(l&31)+257,l>>>=5,c-=5,r.ndist=(l&31)+1,l>>>=5,c-=5,r.ncode=(l&15)+4,l>>>=4,c-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=sn;break}r.have=0,r.mode=gM;case gM:for(;r.have<r.ncode;){for(;c<3;){if(a===0)break e;a--,l+=n[i++]<<c,c+=8}r.lens[C[r.have++]]=l&7,l>>>=3,c-=3}for(;r.have<19;)r.lens[C[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,T={bits:r.lenbits},w=mv(nEe,r.lens,0,19,r.lencode,0,r.work,T),r.lenbits=T.bits,w){t.msg="invalid code lengths set",r.mode=sn;break}r.have=0,r.mode=vM;case vM:for(;r.have<r.nlen+r.ndist;){for(;E=r.lencode[l&(1<<r.lenbits)-1],A=E>>>24,_=E>>>16&255,g=E&65535,!(A<=c);){if(a===0)break e;a--,l+=n[i++]<<c,c+=8}if(g<16)l>>>=A,c-=A,r.lens[r.have++]=g;else{if(g===16){for(P=A+2;c<P;){if(a===0)break e;a--,l+=n[i++]<<c,c+=8}if(l>>>=A,c-=A,r.have===0){t.msg="invalid bit length repeat",r.mode=sn;break}D=r.lens[r.have-1],f=3+(l&3),l>>>=2,c-=2}else if(g===17){for(P=A+3;c<P;){if(a===0)break e;a--,l+=n[i++]<<c,c+=8}l>>>=A,c-=A,D=0,f=3+(l&7),l>>>=3,c-=3}else{for(P=A+7;c<P;){if(a===0)break e;a--,l+=n[i++]<<c,c+=8}l>>>=A,c-=A,D=0,f=11+(l&127),l>>>=7,c-=7}if(r.have+f>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=sn;break}for(;f--;)r.lens[r.have++]=D}}if(r.mode===sn)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=sn;break}if(r.lenbits=9,T={bits:r.lenbits},w=mv(vq,r.lens,0,r.nlen,r.lencode,0,r.work,T),r.lenbits=T.bits,w){t.msg="invalid literal/lengths set",r.mode=sn;break}if(r.distbits=6,r.distcode=r.distdyn,T={bits:r.distbits},w=mv(wq,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,T),r.distbits=T.bits,w){t.msg="invalid distances set",r.mode=sn;break}if(r.mode=Lb,e===Ub)break e;case Lb:r.mode=Kb;case Kb:if(a>=6&&u>=258){t.next_out=o,t.avail_out=u,t.next_in=i,t.avail_in=a,r.hold=l,r.bits=c,Y1e(t,h),o=t.next_out,s=t.output,u=t.avail_out,i=t.next_in,n=t.input,a=t.avail_in,l=r.hold,c=r.bits,r.mode===kc&&(r.back=-1);break}for(r.back=0;E=r.lencode[l&(1<<r.lenbits)-1],A=E>>>24,_=E>>>16&255,g=E&65535,!(A<=c);){if(a===0)break e;a--,l+=n[i++]<<c,c+=8}if(_&&!(_&240)){for(v=A,S=_,x=g;E=r.lencode[x+((l&(1<<v+S)-1)>>v)],A=E>>>24,_=E>>>16&255,g=E&65535,!(v+A<=c);){if(a===0)break e;a--,l+=n[i++]<<c,c+=8}l>>>=v,c-=v,r.back+=v}if(l>>>=A,c-=A,r.back+=A,r.length=g,_===0){r.mode=AM;break}if(_&32){r.back=-1,r.mode=kc;break}if(_&64){t.msg="invalid literal/length code",r.mode=sn;break}r.extra=_&15,r.mode=wM;case wM:if(r.extra){for(P=r.extra;c<P;){if(a===0)break e;a--,l+=n[i++]<<c,c+=8}r.length+=l&(1<<r.extra)-1,l>>>=r.extra,c-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=_M;case _M:for(;E=r.distcode[l&(1<<r.distbits)-1],A=E>>>24,_=E>>>16&255,g=E&65535,!(A<=c);){if(a===0)break e;a--,l+=n[i++]<<c,c+=8}if(!(_&240)){for(v=A,S=_,x=g;E=r.distcode[x+((l&(1<<v+S)-1)>>v)],A=E>>>24,_=E>>>16&255,g=E&65535,!(v+A<=c);){if(a===0)break e;a--,l+=n[i++]<<c,c+=8}l>>>=v,c-=v,r.back+=v}if(l>>>=A,c-=A,r.back+=A,_&64){t.msg="invalid distance code",r.mode=sn;break}r.offset=g,r.extra=_&15,r.mode=bM;case bM:if(r.extra){for(P=r.extra;c<P;){if(a===0)break e;a--,l+=n[i++]<<c,c+=8}r.offset+=l&(1<<r.extra)-1,l>>>=r.extra,c-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=sn;break}r.mode=EM;case EM:if(u===0)break e;if(f=h-u,r.offset>f){if(f=r.offset-f,f>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=sn;break}f>r.wnext?(f-=r.wnext,p=r.wsize-f):p=r.wnext-f,f>r.length&&(f=r.length),m=r.window}else m=s,p=o-r.offset,f=r.length;f>u&&(f=u),u-=f,r.length-=f;do s[o++]=m[p++];while(--f);r.length===0&&(r.mode=Kb);break;case AM:if(u===0)break e;s[o++]=r.length,u--,r.mode=Kb;break;case cD:if(r.wrap){for(;c<32;){if(a===0)break e;a--,l|=n[i++]<<c,c+=8}if(h-=u,t.total_out+=h,r.total+=h,r.wrap&4&&h&&(t.adler=r.check=r.flags?Qn(r.check,s,h,o-h):nw(r.check,s,h,o-h)),h=u,r.wrap&4&&(r.flags?l:DM(l))!==r.check){t.msg="incorrect data check",r.mode=sn;break}l=0,c=0}r.mode=SM;case SM:if(r.wrap&&r.flags){for(;c<32;){if(a===0)break e;a--,l+=n[i++]<<c,c+=8}if(r.wrap&4&&l!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=sn;break}l=0,c=0}r.mode=TM;case TM:w=sEe;break e;case sn:w=_q;break e;case Eq:return bq;case Aq:default:return la}return t.next_out=o,t.avail_out=u,t.next_in=i,t.avail_in=a,r.hold=l,r.bits=c,(r.wsize||h!==t.avail_out&&r.mode<sn&&(r.mode<cD||e!==nM))&&Pq(t,t.output,t.next_out,h-t.avail_out),d-=t.avail_in,h-=t.avail_out,t.total_in+=d,t.total_out+=h,r.total+=h,r.wrap&4&&h&&(t.adler=r.check=r.flags?Qn(r.check,s,h,t.next_out-h):nw(r.check,s,h,t.next_out-h)),t.data_type=r.bits+(r.last?64:0)+(r.mode===kc?128:0)+(r.mode===Lb||r.mode===uD?256:0),(d===0&&h===0||e===nM)&&w===Ap&&(w=aEe),w},yEe=t=>{if(jp(t))return la;let e=t.state;return e.window&&(e.window=null),t.state=null,Ap},gEe=(t,e)=>{if(jp(t))return la;const r=t.state;return r.wrap&2?(r.head=e,e.done=!1,Ap):la},vEe=(t,e)=>{const r=e.length;let n,s,i;return jp(t)||(n=t.state,n.wrap!==0&&n.mode!==YE)?la:n.mode===YE&&(s=1,s=nw(s,e,r,0),s!==n.check)?_q:(i=Pq(t,e,r,r),i?(n.mode=Eq,bq):(n.havedict=1,Ap))};var wEe=Tq,_Ee=Dq,bEe=Sq,EEe=hEe,AEe=xq,SEe=mEe,TEe=yEe,DEe=gEe,xEe=vEe,PEe="pako inflate (from Nodeca project)",Wc={inflateReset:wEe,inflateReset2:_Ee,inflateResetKeep:bEe,inflateInit:EEe,inflateInit2:AEe,inflate:SEe,inflateEnd:TEe,inflateGetHeader:DEe,inflateSetDictionary:xEe,inflateInfo:PEe};function CEe(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var IEe=CEe;const Cq=Object.prototype.toString,{Z_NO_FLUSH:kEe,Z_FINISH:$Ee,Z_OK:aw,Z_STREAM_END:fD,Z_NEED_DICT:hD,Z_STREAM_ERROR:OEe,Z_DATA_ERROR:PM,Z_MEM_ERROR:REe}=IS;function n$(t){this.options=$S.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new yq,this.strm.avail_out=0;let r=Wc.inflateInit2(this.strm,e.windowBits);if(r!==aw)throw new Error(iw[r]);if(this.header=new IEe,Wc.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=ow.string2buf(e.dictionary):Cq.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Wc.inflateSetDictionary(this.strm,e.dictionary),r!==aw)))throw new Error(iw[r])}n$.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let i,o,a;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?$Ee:kEe,Cq.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),i=Wc.inflate(r,o),i===hD&&s&&(i=Wc.inflateSetDictionary(r,s),i===aw?i=Wc.inflate(r,o):i===PM&&(i=hD));r.avail_in>0&&i===fD&&r.state.wrap>0&&t[r.next_in]!==0;)Wc.inflateReset(r),i=Wc.inflate(r,o);switch(i){case OEe:case PM:case hD:case REe:return this.onEnd(i),this.ended=!0,!1}if(a=r.avail_out,r.next_out&&(r.avail_out===0||i===fD))if(this.options.to==="string"){let u=ow.utf8border(r.output,r.next_out),l=r.next_out-u,c=ow.buf2string(r.output,u);r.next_out=l,r.avail_out=n-l,l&&r.output.set(r.output.subarray(u,u+l),0),this.onData(c)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(i===aw&&a===0)){if(i===fD)return i=Wc.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};n$.prototype.onData=function(t){this.chunks.push(t)};n$.prototype.onEnd=function(t){t===aw&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=$S.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function NEe(){return new Date().toISOString().replace(/\.\d+Z$/,"Z")}function CM(t){return new Date(t*1e3).toISOString().replace(/\.\d{3}/,"")}function BEe(t){if(!/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$/.test(t))return!1;const r=new Date(t);return!isNaN(r.getTime())}function FEe(t){if(!/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d+)?(Z|[+-]\d{2}:\d{2})$/.test(t))return!1;const r=new Date(t);return!isNaN(r.getTime())}const IM="VerifiablePresentation";class c0{static validateCredentialPayload(e){this.validateContext(e.vcDataModel["@context"]),this.validateVcType(e.type),this.validateCredentialSubject(e.vcDataModel.credentialSubject),e.vcDataModel.issuanceDate&&this.validateTimestamp(e.vcDataModel.issuanceDate),e.vcDataModel.expirationDate&&this.validateTimestamp(e.vcDataModel.expirationDate)}static validateContext(e){const r=this.asArray(e);if(r.length<1||r.indexOf(NP)===-1)throw new Error(`@context is missing default context "${NP}"`)}static validateVcType(e){const r=this.asArray(e);if(r.length<1||r.indexOf(yv)===-1)throw new Error(`type is missing default "${yv}"`)}static validateVpType(e){const r=this.asArray(e);if(r.length<1||r.indexOf(IM)===-1)throw new Error(`type is missing default "${IM}"`)}static validateCredentialSubject(e){if(Object.keys(e).length===0)throw new Error("credentialSubject must not be empty")}static validateTimestamp(e){if(!BEe(e)&&!FEe(e))throw new Error("timestamp is not valid xml schema 112 timestamp")}static asArray(e){return Array.isArray(e)?e:[e]}}var pD=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};const NP="https://www.w3.org/2018/credentials/v1",yv="VerifiableCredential";class ZE{constructor(e){this.vcDataModel=e}get type(){return this.vcDataModel.type[this.vcDataModel.type.length-1]}get issuer(){return this.vcDataModel.issuer.toString()}get subject(){return Array.isArray(this.vcDataModel.credentialSubject)?this.vcDataModel.credentialSubject[0].id:this.vcDataModel.credentialSubject.id}sign(e){return pD(this,void 0,void 0,function*(){return yield Uu.sign({signerDid:e.did,payload:Object.assign({vc:this.vcDataModel,nbf:Math.floor(new Date(this.vcDataModel.issuanceDate).getTime()/1e3),jti:this.vcDataModel.id,iss:e.did.uri,sub:this.subject,iat:Math.floor(Date.now()/1e3)},this.vcDataModel.expirationDate&&{exp:Math.floor(new Date(this.vcDataModel.expirationDate).getTime()/1e3)})})})}toString(){return JSON.stringify(this.vcDataModel)}static create(e){return pD(this,void 0,void 0,function*(){const{type:r,issuer:n,subject:s,data:i,issuanceDate:o,expirationDate:a,credentialStatus:u,credentialSchema:l,evidence:c}=e,d=JSON.parse(JSON.stringify(i));if(typeof d!="object")throw new Error("Expected data to be parseable into a JSON object");if(!n||!s)throw new Error("Issuer and subject must be defined");if(typeof n!="string"||typeof s!="string")throw new Error("Issuer and subject must be of type string");const h=Object.assign({id:s},d),f=[NP];u!==null&&f.push(MEe);const p=Object.assign(Object.assign(Object.assign(Object.assign({"@context":f,type:Array.isArray(r)?[yv,...r]:r?[yv,r]:[yv],id:`urn:uuid:${Khe()}`,issuer:n,issuanceDate:o||NEe(),credentialSubject:h},a&&{expirationDate:a}),u&&{credentialStatus:u}),l&&{credentialSchema:l}),c&&{evidence:c});return mD(p),new ZE(p)})}static verify(e){return pD(this,arguments,void 0,function*({vcJwt:r}){const{payload:n}=yield Uu.verify({jwt:r}),{exp:s,iss:i,nbf:o,jti:a,sub:u,vc:l}=n;if(!l)throw new Error("vc property missing.");const c=n.vc;if(s&&c.expirationDate&&s!==Math.floor(new Date(c.expirationDate).getTime()/1e3))throw new Error("Verification failed: exp claim does not match expirationDate");if(s&&(c.expirationDate=CM(s)),!i)throw new Error("Verification failed: iss claim is required");if(i!==c.issuer)throw new Error("Verification failed: iss claim does not match expected issuer");if(o&&o>Math.floor(Date.now()/1e3))throw new Error("Verification failed: nbf claim is in the future");if(o&&c.issuanceDate&&o!==Math.floor(new Date(c.issuanceDate).getTime()/1e3))throw new Error("Verification failed: nbf claim does not match issuanceDate");if(o&&(c.issuanceDate=CM(o)),u&&!Array.isArray(c.credentialSubject)&&u!==c.credentialSubject.id)throw new Error("Verification failed: sub claim does not match credentialSubject.id");if(u&&!Array.isArray(c.credentialSubject)&&(c.credentialSubject.id=u),a&&a!==c.id)throw new Error("Verification failed: jti claim does not match id");return a&&(c.id=a),mD(c),{issuer:n.iss,subject:n.sub,vc:c}})}static parseJwt({vcJwt:e}){const n=Uu.parse({jwt:e}).decoded.payload.vc;if(!n)throw Error("Jwt payload missing vc property");return mD(n),new ZE(n)}}function mD(t){c0.validateContext(t["@context"]),c0.validateVcType(t.type),c0.validateCredentialSubject(t.credentialSubject),t.issuanceDate&&c0.validateTimestamp(t.issuanceDate),t.expirationDate&&c0.validateTimestamp(t.expirationDate)}const MEe="https://w3id.org/vc/status-list/2021/v1";var kM;(function(t){t.revocation="revocation",t.suspension="suspension"})(kM||(kM={}));var BP={exports:{}},Iq={},Ua={},xy={},Zw={},rr={},uw={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.regexpCode=t.getEsmExportName=t.getProperty=t.safeStringify=t.stringify=t.strConcat=t.addCodeArg=t.str=t._=t.nil=t._Code=t.Name=t.IDENTIFIER=t._CodeOrName=void 0;class e{}t._CodeOrName=e,t.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class r extends e{constructor(_){if(super(),!t.IDENTIFIER.test(_))throw new Error("CodeGen: name must be a valid identifier");this.str=_}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}t.Name=r;class n extends e{constructor(_){super(),this._items=typeof _=="string"?[_]:_}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const _=this._items[0];return _===""||_==='""'}get str(){var _;return(_=this._str)!==null&&_!==void 0?_:this._str=this._items.reduce((g,v)=>`${g}${v}`,"")}get names(){var _;return(_=this._names)!==null&&_!==void 0?_:this._names=this._items.reduce((g,v)=>(v instanceof r&&(g[v.str]=(g[v.str]||0)+1),g),{})}}t._Code=n,t.nil=new n("");function s(A,..._){const g=[A[0]];let v=0;for(;v<_.length;)a(g,_[v]),g.push(A[++v]);return new n(g)}t._=s;const i=new n("+");function o(A,..._){const g=[f(A[0])];let v=0;for(;v<_.length;)g.push(i),a(g,_[v]),g.push(i,f(A[++v]));return u(g),new n(g)}t.str=o;function a(A,_){_ instanceof n?A.push(..._._items):_ instanceof r?A.push(_):A.push(d(_))}t.addCodeArg=a;function u(A){let _=1;for(;_<A.length-1;){if(A[_]===i){const g=l(A[_-1],A[_+1]);if(g!==void 0){A.splice(_-1,3,g);continue}A[_++]="+"}_++}}function l(A,_){if(_==='""')return A;if(A==='""')return _;if(typeof A=="string")return _ instanceof r||A[A.length-1]!=='"'?void 0:typeof _!="string"?`${A.slice(0,-1)}${_}"`:_[0]==='"'?A.slice(0,-1)+_.slice(1):void 0;if(typeof _=="string"&&_[0]==='"'&&!(A instanceof r))return`"${A}${_.slice(1)}`}function c(A,_){return _.emptyStr()?A:A.emptyStr()?_:o`${A}${_}`}t.strConcat=c;function d(A){return typeof A=="number"||typeof A=="boolean"||A===null?A:f(Array.isArray(A)?A.join(","):A)}function h(A){return new n(f(A))}t.stringify=h;function f(A){return JSON.stringify(A).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}t.safeStringify=f;function p(A){return typeof A=="string"&&t.IDENTIFIER.test(A)?new n(`.${A}`):s`[${A}]`}t.getProperty=p;function m(A){if(typeof A=="string"&&t.IDENTIFIER.test(A))return new n(`${A}`);throw new Error(`CodeGen: invalid export name: ${A}, use explicit $id name mapping`)}t.getEsmExportName=m;function E(A){return new n(A.toString())}t.regexpCode=E})(uw);var FP={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ValueScope=t.ValueScopeName=t.Scope=t.varKinds=t.UsedValueState=void 0;const e=uw;class r extends Error{constructor(l){super(`CodeGen: "code" for ${l} not defined`),this.value=l.value}}var n;(function(u){u[u.Started=0]="Started",u[u.Completed=1]="Completed"})(n=t.UsedValueState||(t.UsedValueState={})),t.varKinds={const:new e.Name("const"),let:new e.Name("let"),var:new e.Name("var")};class s{constructor({prefixes:l,parent:c}={}){this._names={},this._prefixes=l,this._parent=c}toName(l){return l instanceof e.Name?l:this.name(l)}name(l){return new e.Name(this._newName(l))}_newName(l){const c=this._names[l]||this._nameGroup(l);return`${l}${c.index++}`}_nameGroup(l){var c,d;if(!((d=(c=this._parent)===null||c===void 0?void 0:c._prefixes)===null||d===void 0)&&d.has(l)||this._prefixes&&!this._prefixes.has(l))throw new Error(`CodeGen: prefix "${l}" is not allowed in this scope`);return this._names[l]={prefix:l,index:0}}}t.Scope=s;class i extends e.Name{constructor(l,c){super(c),this.prefix=l}setValue(l,{property:c,itemIndex:d}){this.value=l,this.scopePath=(0,e._)`.${new e.Name(c)}[${d}]`}}t.ValueScopeName=i;const o=(0,e._)`\n`;class a extends s{constructor(l){super(l),this._values={},this._scope=l.scope,this.opts={...l,_n:l.lines?o:e.nil}}get(){return this._scope}name(l){return new i(l,this._newName(l))}value(l,c){var d;if(c.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const h=this.toName(l),{prefix:f}=h,p=(d=c.key)!==null&&d!==void 0?d:c.ref;let m=this._values[f];if(m){const _=m.get(p);if(_)return _}else m=this._values[f]=new Map;m.set(p,h);const E=this._scope[f]||(this._scope[f]=[]),A=E.length;return E[A]=c.ref,h.setValue(c,{property:f,itemIndex:A}),h}getValue(l,c){const d=this._values[l];if(d)return d.get(c)}scopeRefs(l,c=this._values){return this._reduceValues(c,d=>{if(d.scopePath===void 0)throw new Error(`CodeGen: name "${d}" has no value`);return(0,e._)`${l}${d.scopePath}`})}scopeCode(l=this._values,c,d){return this._reduceValues(l,h=>{if(h.value===void 0)throw new Error(`CodeGen: name "${h}" has no value`);return h.value.code},c,d)}_reduceValues(l,c,d={},h){let f=e.nil;for(const p in l){const m=l[p];if(!m)continue;const E=d[p]=d[p]||new Map;m.forEach(A=>{if(E.has(A))return;E.set(A,n.Started);let _=c(A);if(_){const g=this.opts.es5?t.varKinds.var:t.varKinds.const;f=(0,e._)`${f}${g} ${A} = ${_};${this.opts._n}`}else if(_=h==null?void 0:h(A))f=(0,e._)`${f}${_}${this.opts._n}`;else throw new r(A);E.set(A,n.Completed)})}return f}}t.ValueScope=a})(FP);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.or=t.and=t.not=t.CodeGen=t.operators=t.varKinds=t.ValueScopeName=t.ValueScope=t.Scope=t.Name=t.regexpCode=t.stringify=t.getProperty=t.nil=t.strConcat=t.str=t._=void 0;const e=uw,r=FP;var n=uw;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(t,"strConcat",{enumerable:!0,get:function(){return n.strConcat}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(t,"getProperty",{enumerable:!0,get:function(){return n.getProperty}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(t,"regexpCode",{enumerable:!0,get:function(){return n.regexpCode}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return n.Name}});var s=FP;Object.defineProperty(t,"Scope",{enumerable:!0,get:function(){return s.Scope}}),Object.defineProperty(t,"ValueScope",{enumerable:!0,get:function(){return s.ValueScope}}),Object.defineProperty(t,"ValueScopeName",{enumerable:!0,get:function(){return s.ValueScopeName}}),Object.defineProperty(t,"varKinds",{enumerable:!0,get:function(){return s.varKinds}}),t.operators={GT:new e._Code(">"),GTE:new e._Code(">="),LT:new e._Code("<"),LTE:new e._Code("<="),EQ:new e._Code("==="),NEQ:new e._Code("!=="),NOT:new e._Code("!"),OR:new e._Code("||"),AND:new e._Code("&&"),ADD:new e._Code("+")};class i{optimizeNodes(){return this}optimizeNames($,F){return this}}class o extends i{constructor($,F,ee){super(),this.varKind=$,this.name=F,this.rhs=ee}render({es5:$,_n:F}){const ee=$?r.varKinds.var:this.varKind,ne=this.rhs===void 0?"":` = ${this.rhs}`;return`${ee} ${this.name}${ne};`+F}optimizeNames($,F){if($[this.name.str])return this.rhs&&(this.rhs=K(this.rhs,$,F)),this}get names(){return this.rhs instanceof e._CodeOrName?this.rhs.names:{}}}class a extends i{constructor($,F,ee){super(),this.lhs=$,this.rhs=F,this.sideEffects=ee}render({_n:$}){return`${this.lhs} = ${this.rhs};`+$}optimizeNames($,F){if(!(this.lhs instanceof e.Name&&!$[this.lhs.str]&&!this.sideEffects))return this.rhs=K(this.rhs,$,F),this}get names(){const $=this.lhs instanceof e.Name?{}:{...this.lhs.names};return k($,this.rhs)}}class u extends a{constructor($,F,ee,ne){super($,ee,ne),this.op=F}render({_n:$}){return`${this.lhs} ${this.op}= ${this.rhs};`+$}}class l extends i{constructor($){super(),this.label=$,this.names={}}render({_n:$}){return`${this.label}:`+$}}class c extends i{constructor($){super(),this.label=$,this.names={}}render({_n:$}){return`break${this.label?` ${this.label}`:""};`+$}}class d extends i{constructor($){super(),this.error=$}render({_n:$}){return`throw ${this.error};`+$}get names(){return this.error.names}}class h extends i{constructor($){super(),this.code=$}render({_n:$}){return`${this.code};`+$}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames($,F){return this.code=K(this.code,$,F),this}get names(){return this.code instanceof e._CodeOrName?this.code.names:{}}}class f extends i{constructor($=[]){super(),this.nodes=$}render($){return this.nodes.reduce((F,ee)=>F+ee.render($),"")}optimizeNodes(){const{nodes:$}=this;let F=$.length;for(;F--;){const ee=$[F].optimizeNodes();Array.isArray(ee)?$.splice(F,1,...ee):ee?$[F]=ee:$.splice(F,1)}return $.length>0?this:void 0}optimizeNames($,F){const{nodes:ee}=this;let ne=ee.length;for(;ne--;){const le=ee[ne];le.optimizeNames($,F)||(L($,le.names),ee.splice(ne,1))}return ee.length>0?this:void 0}get names(){return this.nodes.reduce(($,F)=>C($,F.names),{})}}class p extends f{render($){return"{"+$._n+super.render($)+"}"+$._n}}class m extends f{}class E extends p{}E.kind="else";class A extends p{constructor($,F){super(F),this.condition=$}render($){let F=`if(${this.condition})`+super.render($);return this.else&&(F+="else "+this.else.render($)),F}optimizeNodes(){super.optimizeNodes();const $=this.condition;if($===!0)return this.nodes;let F=this.else;if(F){const ee=F.optimizeNodes();F=this.else=Array.isArray(ee)?new E(ee):ee}if(F)return $===!1?F instanceof A?F:F.nodes:this.nodes.length?this:new A(q($),F instanceof A?[F]:F.nodes);if(!($===!1||!this.nodes.length))return this}optimizeNames($,F){var ee;if(this.else=(ee=this.else)===null||ee===void 0?void 0:ee.optimizeNames($,F),!!(super.optimizeNames($,F)||this.else))return this.condition=K(this.condition,$,F),this}get names(){const $=super.names;return k($,this.condition),this.else&&C($,this.else.names),$}}A.kind="if";class _ extends p{}_.kind="for";class g extends _{constructor($){super(),this.iteration=$}render($){return`for(${this.iteration})`+super.render($)}optimizeNames($,F){if(super.optimizeNames($,F))return this.iteration=K(this.iteration,$,F),this}get names(){return C(super.names,this.iteration.names)}}class v extends _{constructor($,F,ee,ne){super(),this.varKind=$,this.name=F,this.from=ee,this.to=ne}render($){const F=$.es5?r.varKinds.var:this.varKind,{name:ee,from:ne,to:le}=this;return`for(${F} ${ee}=${ne}; ${ee}<${le}; ${ee}++)`+super.render($)}get names(){const $=k(super.names,this.from);return k($,this.to)}}class S extends _{constructor($,F,ee,ne){super(),this.loop=$,this.varKind=F,this.name=ee,this.iterable=ne}render($){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render($)}optimizeNames($,F){if(super.optimizeNames($,F))return this.iterable=K(this.iterable,$,F),this}get names(){return C(super.names,this.iterable.names)}}class x extends p{constructor($,F,ee){super(),this.name=$,this.args=F,this.async=ee}render($){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render($)}}x.kind="func";class D extends f{render($){return"return "+super.render($)}}D.kind="return";class w extends p{render($){let F="try"+super.render($);return this.catch&&(F+=this.catch.render($)),this.finally&&(F+=this.finally.render($)),F}optimizeNodes(){var $,F;return super.optimizeNodes(),($=this.catch)===null||$===void 0||$.optimizeNodes(),(F=this.finally)===null||F===void 0||F.optimizeNodes(),this}optimizeNames($,F){var ee,ne;return super.optimizeNames($,F),(ee=this.catch)===null||ee===void 0||ee.optimizeNames($,F),(ne=this.finally)===null||ne===void 0||ne.optimizeNames($,F),this}get names(){const $=super.names;return this.catch&&C($,this.catch.names),this.finally&&C($,this.finally.names),$}}class b extends p{constructor($){super(),this.error=$}render($){return`catch(${this.error})`+super.render($)}}b.kind="catch";class T extends p{render($){return"finally"+super.render($)}}T.kind="finally";class P{constructor($,F={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...F,_n:F.lines?`
`:""},this._extScope=$,this._scope=new r.Scope({parent:$}),this._nodes=[new m]}toString(){return this._root.render(this.opts)}name($){return this._scope.name($)}scopeName($){return this._extScope.name($)}scopeValue($,F){const ee=this._extScope.value($,F);return(this._values[ee.prefix]||(this._values[ee.prefix]=new Set)).add(ee),ee}getScopeValue($,F){return this._extScope.getValue($,F)}scopeRefs($){return this._extScope.scopeRefs($,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def($,F,ee,ne){const le=this._scope.toName(F);return ee!==void 0&&ne&&(this._constants[le.str]=ee),this._leafNode(new o($,le,ee)),le}const($,F,ee){return this._def(r.varKinds.const,$,F,ee)}let($,F,ee){return this._def(r.varKinds.let,$,F,ee)}var($,F,ee){return this._def(r.varKinds.var,$,F,ee)}assign($,F,ee){return this._leafNode(new a($,F,ee))}add($,F){return this._leafNode(new u($,t.operators.ADD,F))}code($){return typeof $=="function"?$():$!==e.nil&&this._leafNode(new h($)),this}object(...$){const F=["{"];for(const[ee,ne]of $)F.length>1&&F.push(","),F.push(ee),(ee!==ne||this.opts.es5)&&(F.push(":"),(0,e.addCodeArg)(F,ne));return F.push("}"),new e._Code(F)}if($,F,ee){if(this._blockNode(new A($)),F&&ee)this.code(F).else().code(ee).endIf();else if(F)this.code(F).endIf();else if(ee)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf($){return this._elseNode(new A($))}else(){return this._elseNode(new E)}endIf(){return this._endBlockNode(A,E)}_for($,F){return this._blockNode($),F&&this.code(F).endFor(),this}for($,F){return this._for(new g($),F)}forRange($,F,ee,ne,le=this.opts.es5?r.varKinds.var:r.varKinds.let){const me=this._scope.toName($);return this._for(new v(le,me,F,ee),()=>ne(me))}forOf($,F,ee,ne=r.varKinds.const){const le=this._scope.toName($);if(this.opts.es5){const me=F instanceof e.Name?F:this.var("_arr",F);return this.forRange("_i",0,(0,e._)`${me}.length`,ve=>{this.var(le,(0,e._)`${me}[${ve}]`),ee(le)})}return this._for(new S("of",ne,le,F),()=>ee(le))}forIn($,F,ee,ne=this.opts.es5?r.varKinds.var:r.varKinds.const){if(this.opts.ownProperties)return this.forOf($,(0,e._)`Object.keys(${F})`,ee);const le=this._scope.toName($);return this._for(new S("in",ne,le,F),()=>ee(le))}endFor(){return this._endBlockNode(_)}label($){return this._leafNode(new l($))}break($){return this._leafNode(new c($))}return($){const F=new D;if(this._blockNode(F),this.code($),F.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(D)}try($,F,ee){if(!F&&!ee)throw new Error('CodeGen: "try" without "catch" and "finally"');const ne=new w;if(this._blockNode(ne),this.code($),F){const le=this.name("e");this._currNode=ne.catch=new b(le),F(le)}return ee&&(this._currNode=ne.finally=new T,this.code(ee)),this._endBlockNode(b,T)}throw($){return this._leafNode(new d($))}block($,F){return this._blockStarts.push(this._nodes.length),$&&this.code($).endBlock(F),this}endBlock($){const F=this._blockStarts.pop();if(F===void 0)throw new Error("CodeGen: not in self-balancing block");const ee=this._nodes.length-F;if(ee<0||$!==void 0&&ee!==$)throw new Error(`CodeGen: wrong number of nodes: ${ee} vs ${$} expected`);return this._nodes.length=F,this}func($,F=e.nil,ee,ne){return this._blockNode(new x($,F,ee)),ne&&this.code(ne).endFunc(),this}endFunc(){return this._endBlockNode(x)}optimize($=1){for(;$-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode($){return this._currNode.nodes.push($),this}_blockNode($){this._currNode.nodes.push($),this._nodes.push($)}_endBlockNode($,F){const ee=this._currNode;if(ee instanceof $||F&&ee instanceof F)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${F?`${$.kind}/${F.kind}`:$.kind}"`)}_elseNode($){const F=this._currNode;if(!(F instanceof A))throw new Error('CodeGen: "else" without "if"');return this._currNode=F.else=$,this}get _root(){return this._nodes[0]}get _currNode(){const $=this._nodes;return $[$.length-1]}set _currNode($){const F=this._nodes;F[F.length-1]=$}}t.CodeGen=P;function C(z,$){for(const F in $)z[F]=(z[F]||0)+($[F]||0);return z}function k(z,$){return $ instanceof e._CodeOrName?C(z,$.names):z}function K(z,$,F){if(z instanceof e.Name)return ee(z);if(!ne(z))return z;return new e._Code(z._items.reduce((le,me)=>(me instanceof e.Name&&(me=ee(me)),me instanceof e._Code?le.push(...me._items):le.push(me),le),[]));function ee(le){const me=F[le.str];return me===void 0||$[le.str]!==1?le:(delete $[le.str],me)}function ne(le){return le instanceof e._Code&&le._items.some(me=>me instanceof e.Name&&$[me.str]===1&&F[me.str]!==void 0)}}function L(z,$){for(const F in $)z[F]=(z[F]||0)-($[F]||0)}function q(z){return typeof z=="boolean"||typeof z=="number"||z===null?!z:(0,e._)`!${te(z)}`}t.not=q;const se=B(t.operators.AND);function X(...z){return z.reduce(se)}t.and=X;const re=B(t.operators.OR);function W(...z){return z.reduce(re)}t.or=W;function B(z){return($,F)=>$===e.nil?F:F===e.nil?$:(0,e._)`${te($)} ${z} ${te(F)}`}function te(z){return z instanceof e.Name?z:(0,e._)`(${z})`}})(rr);var lr={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.checkStrictMode=t.getErrorPath=t.Type=t.useFunc=t.setEvaluated=t.evaluatedPropsToName=t.mergeEvaluated=t.eachItem=t.unescapeJsonPointer=t.escapeJsonPointer=t.escapeFragment=t.unescapeFragment=t.schemaRefOrVal=t.schemaHasRulesButRef=t.schemaHasRules=t.checkUnknownRules=t.alwaysValidSchema=t.toHash=void 0;const e=rr,r=uw;function n(x){const D={};for(const w of x)D[w]=!0;return D}t.toHash=n;function s(x,D){return typeof D=="boolean"?D:Object.keys(D).length===0?!0:(i(x,D),!o(D,x.self.RULES.all))}t.alwaysValidSchema=s;function i(x,D=x.schema){const{opts:w,self:b}=x;if(!w.strictSchema||typeof D=="boolean")return;const T=b.RULES.keywords;for(const P in D)T[P]||S(x,`unknown keyword: "${P}"`)}t.checkUnknownRules=i;function o(x,D){if(typeof x=="boolean")return!x;for(const w in x)if(D[w])return!0;return!1}t.schemaHasRules=o;function a(x,D){if(typeof x=="boolean")return!x;for(const w in x)if(w!=="$ref"&&D.all[w])return!0;return!1}t.schemaHasRulesButRef=a;function u({topSchemaRef:x,schemaPath:D},w,b,T){if(!T){if(typeof w=="number"||typeof w=="boolean")return w;if(typeof w=="string")return(0,e._)`${w}`}return(0,e._)`${x}${D}${(0,e.getProperty)(b)}`}t.schemaRefOrVal=u;function l(x){return h(decodeURIComponent(x))}t.unescapeFragment=l;function c(x){return encodeURIComponent(d(x))}t.escapeFragment=c;function d(x){return typeof x=="number"?`${x}`:x.replace(/~/g,"~0").replace(/\//g,"~1")}t.escapeJsonPointer=d;function h(x){return x.replace(/~1/g,"/").replace(/~0/g,"~")}t.unescapeJsonPointer=h;function f(x,D){if(Array.isArray(x))for(const w of x)D(w);else D(x)}t.eachItem=f;function p({mergeNames:x,mergeToName:D,mergeValues:w,resultToName:b}){return(T,P,C,k)=>{const K=C===void 0?P:C instanceof e.Name?(P instanceof e.Name?x(T,P,C):D(T,P,C),C):P instanceof e.Name?(D(T,C,P),P):w(P,C);return k===e.Name&&!(K instanceof e.Name)?b(T,K):K}}t.mergeEvaluated={props:p({mergeNames:(x,D,w)=>x.if((0,e._)`${w} !== true && ${D} !== undefined`,()=>{x.if((0,e._)`${D} === true`,()=>x.assign(w,!0),()=>x.assign(w,(0,e._)`${w} || {}`).code((0,e._)`Object.assign(${w}, ${D})`))}),mergeToName:(x,D,w)=>x.if((0,e._)`${w} !== true`,()=>{D===!0?x.assign(w,!0):(x.assign(w,(0,e._)`${w} || {}`),E(x,w,D))}),mergeValues:(x,D)=>x===!0?!0:{...x,...D},resultToName:m}),items:p({mergeNames:(x,D,w)=>x.if((0,e._)`${w} !== true && ${D} !== undefined`,()=>x.assign(w,(0,e._)`${D} === true ? true : ${w} > ${D} ? ${w} : ${D}`)),mergeToName:(x,D,w)=>x.if((0,e._)`${w} !== true`,()=>x.assign(w,D===!0?!0:(0,e._)`${w} > ${D} ? ${w} : ${D}`)),mergeValues:(x,D)=>x===!0?!0:Math.max(x,D),resultToName:(x,D)=>x.var("items",D)})};function m(x,D){if(D===!0)return x.var("props",!0);const w=x.var("props",(0,e._)`{}`);return D!==void 0&&E(x,w,D),w}t.evaluatedPropsToName=m;function E(x,D,w){Object.keys(w).forEach(b=>x.assign((0,e._)`${D}${(0,e.getProperty)(b)}`,!0))}t.setEvaluated=E;const A={};function _(x,D){return x.scopeValue("func",{ref:D,code:A[D.code]||(A[D.code]=new r._Code(D.code))})}t.useFunc=_;var g;(function(x){x[x.Num=0]="Num",x[x.Str=1]="Str"})(g=t.Type||(t.Type={}));function v(x,D,w){if(x instanceof e.Name){const b=D===g.Num;return w?b?(0,e._)`"[" + ${x} + "]"`:(0,e._)`"['" + ${x} + "']"`:b?(0,e._)`"/" + ${x}`:(0,e._)`"/" + ${x}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return w?(0,e.getProperty)(x).toString():"/"+d(x)}t.getErrorPath=v;function S(x,D,w=x.opts.strictSchema){if(w){if(D=`strict mode: ${D}`,w===!0)throw new Error(D);x.self.logger.warn(D)}}t.checkStrictMode=S})(lr);var cc={};Object.defineProperty(cc,"__esModule",{value:!0});const Hi=rr,jEe={data:new Hi.Name("data"),valCxt:new Hi.Name("valCxt"),instancePath:new Hi.Name("instancePath"),parentData:new Hi.Name("parentData"),parentDataProperty:new Hi.Name("parentDataProperty"),rootData:new Hi.Name("rootData"),dynamicAnchors:new Hi.Name("dynamicAnchors"),vErrors:new Hi.Name("vErrors"),errors:new Hi.Name("errors"),this:new Hi.Name("this"),self:new Hi.Name("self"),scope:new Hi.Name("scope"),json:new Hi.Name("json"),jsonPos:new Hi.Name("jsonPos"),jsonLen:new Hi.Name("jsonLen"),jsonPart:new Hi.Name("jsonPart")};cc.default=jEe;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.extendErrors=t.resetErrorsCount=t.reportExtraError=t.reportError=t.keyword$DataError=t.keywordError=void 0;const e=rr,r=lr,n=cc;t.keywordError={message:({keyword:E})=>(0,e.str)`must pass "${E}" keyword validation`},t.keyword$DataError={message:({keyword:E,schemaType:A})=>A?(0,e.str)`"${E}" keyword must be ${A} ($data)`:(0,e.str)`"${E}" keyword is invalid ($data)`};function s(E,A=t.keywordError,_,g){const{it:v}=E,{gen:S,compositeRule:x,allErrors:D}=v,w=d(E,A,_);g??(x||D)?u(S,w):l(v,(0,e._)`[${w}]`)}t.reportError=s;function i(E,A=t.keywordError,_){const{it:g}=E,{gen:v,compositeRule:S,allErrors:x}=g,D=d(E,A,_);u(v,D),S||x||l(g,n.default.vErrors)}t.reportExtraError=i;function o(E,A){E.assign(n.default.errors,A),E.if((0,e._)`${n.default.vErrors} !== null`,()=>E.if(A,()=>E.assign((0,e._)`${n.default.vErrors}.length`,A),()=>E.assign(n.default.vErrors,null)))}t.resetErrorsCount=o;function a({gen:E,keyword:A,schemaValue:_,data:g,errsCount:v,it:S}){if(v===void 0)throw new Error("ajv implementation error");const x=E.name("err");E.forRange("i",v,n.default.errors,D=>{E.const(x,(0,e._)`${n.default.vErrors}[${D}]`),E.if((0,e._)`${x}.instancePath === undefined`,()=>E.assign((0,e._)`${x}.instancePath`,(0,e.strConcat)(n.default.instancePath,S.errorPath))),E.assign((0,e._)`${x}.schemaPath`,(0,e.str)`${S.errSchemaPath}/${A}`),S.opts.verbose&&(E.assign((0,e._)`${x}.schema`,_),E.assign((0,e._)`${x}.data`,g))})}t.extendErrors=a;function u(E,A){const _=E.const("err",A);E.if((0,e._)`${n.default.vErrors} === null`,()=>E.assign(n.default.vErrors,(0,e._)`[${_}]`),(0,e._)`${n.default.vErrors}.push(${_})`),E.code((0,e._)`${n.default.errors}++`)}function l(E,A){const{gen:_,validateName:g,schemaEnv:v}=E;v.$async?_.throw((0,e._)`new ${E.ValidationError}(${A})`):(_.assign((0,e._)`${g}.errors`,A),_.return(!1))}const c={keyword:new e.Name("keyword"),schemaPath:new e.Name("schemaPath"),params:new e.Name("params"),propertyName:new e.Name("propertyName"),message:new e.Name("message"),schema:new e.Name("schema"),parentSchema:new e.Name("parentSchema")};function d(E,A,_){const{createErrors:g}=E.it;return g===!1?(0,e._)`{}`:h(E,A,_)}function h(E,A,_={}){const{gen:g,it:v}=E,S=[f(v,_),p(E,_)];return m(E,A,S),g.object(...S)}function f({errorPath:E},{instancePath:A}){const _=A?(0,e.str)`${E}${(0,r.getErrorPath)(A,r.Type.Str)}`:E;return[n.default.instancePath,(0,e.strConcat)(n.default.instancePath,_)]}function p({keyword:E,it:{errSchemaPath:A}},{schemaPath:_,parentSchema:g}){let v=g?A:(0,e.str)`${A}/${E}`;return _&&(v=(0,e.str)`${v}${(0,r.getErrorPath)(_,r.Type.Str)}`),[c.schemaPath,v]}function m(E,{params:A,message:_},g){const{keyword:v,data:S,schemaValue:x,it:D}=E,{opts:w,propertyName:b,topSchemaRef:T,schemaPath:P}=D;g.push([c.keyword,v],[c.params,typeof A=="function"?A(E):A||(0,e._)`{}`]),w.messages&&g.push([c.message,typeof _=="function"?_(E):_]),w.verbose&&g.push([c.schema,x],[c.parentSchema,(0,e._)`${T}${P}`],[n.default.data,S]),b&&g.push([c.propertyName,b])}})(Zw);Object.defineProperty(xy,"__esModule",{value:!0});xy.boolOrEmptySchema=xy.topBoolOrEmptySchema=void 0;const UEe=Zw,LEe=rr,KEe=cc,VEe={message:"boolean schema is false"};function qEe(t){const{gen:e,schema:r,validateName:n}=t;r===!1?kq(t,!1):typeof r=="object"&&r.$async===!0?e.return(KEe.default.data):(e.assign((0,LEe._)`${n}.errors`,null),e.return(!0))}xy.topBoolOrEmptySchema=qEe;function HEe(t,e){const{gen:r,schema:n}=t;n===!1?(r.var(e,!1),kq(t)):r.var(e,!0)}xy.boolOrEmptySchema=HEe;function kq(t,e){const{gen:r,data:n}=t,s={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,UEe.reportError)(s,VEe,void 0,e)}var Qw={},Sp={};Object.defineProperty(Sp,"__esModule",{value:!0});Sp.getRules=Sp.isJSONType=void 0;const zEe=["string","number","integer","boolean","null","object","array"],WEe=new Set(zEe);function GEe(t){return typeof t=="string"&&WEe.has(t)}Sp.isJSONType=GEe;function JEe(){const t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...t,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}Sp.getRules=JEe;var cl={};Object.defineProperty(cl,"__esModule",{value:!0});cl.shouldUseRule=cl.shouldUseGroup=cl.schemaHasRulesForType=void 0;function XEe({schema:t,self:e},r){const n=e.RULES.types[r];return n&&n!==!0&&$q(t,n)}cl.schemaHasRulesForType=XEe;function $q(t,e){return e.rules.some(r=>Oq(t,r))}cl.shouldUseGroup=$q;function Oq(t,e){var r;return t[e.keyword]!==void 0||((r=e.definition.implements)===null||r===void 0?void 0:r.some(n=>t[n]!==void 0))}cl.shouldUseRule=Oq;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.reportTypeError=t.checkDataTypes=t.checkDataType=t.coerceAndCheckDataType=t.getJSONTypes=t.getSchemaTypes=t.DataType=void 0;const e=Sp,r=cl,n=Zw,s=rr,i=lr;var o;(function(g){g[g.Correct=0]="Correct",g[g.Wrong=1]="Wrong"})(o=t.DataType||(t.DataType={}));function a(g){const v=u(g.type);if(v.includes("null")){if(g.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!v.length&&g.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');g.nullable===!0&&v.push("null")}return v}t.getSchemaTypes=a;function u(g){const v=Array.isArray(g)?g:g?[g]:[];if(v.every(e.isJSONType))return v;throw new Error("type must be JSONType or JSONType[]: "+v.join(","))}t.getJSONTypes=u;function l(g,v){const{gen:S,data:x,opts:D}=g,w=d(v,D.coerceTypes),b=v.length>0&&!(w.length===0&&v.length===1&&(0,r.schemaHasRulesForType)(g,v[0]));if(b){const T=m(v,x,D.strictNumbers,o.Wrong);S.if(T,()=>{w.length?h(g,v,w):A(g)})}return b}t.coerceAndCheckDataType=l;const c=new Set(["string","number","integer","boolean","null"]);function d(g,v){return v?g.filter(S=>c.has(S)||v==="array"&&S==="array"):[]}function h(g,v,S){const{gen:x,data:D,opts:w}=g,b=x.let("dataType",(0,s._)`typeof ${D}`),T=x.let("coerced",(0,s._)`undefined`);w.coerceTypes==="array"&&x.if((0,s._)`${b} == 'object' && Array.isArray(${D}) && ${D}.length == 1`,()=>x.assign(D,(0,s._)`${D}[0]`).assign(b,(0,s._)`typeof ${D}`).if(m(v,D,w.strictNumbers),()=>x.assign(T,D))),x.if((0,s._)`${T} !== undefined`);for(const C of S)(c.has(C)||C==="array"&&w.coerceTypes==="array")&&P(C);x.else(),A(g),x.endIf(),x.if((0,s._)`${T} !== undefined`,()=>{x.assign(D,T),f(g,T)});function P(C){switch(C){case"string":x.elseIf((0,s._)`${b} == "number" || ${b} == "boolean"`).assign(T,(0,s._)`"" + ${D}`).elseIf((0,s._)`${D} === null`).assign(T,(0,s._)`""`);return;case"number":x.elseIf((0,s._)`${b} == "boolean" || ${D} === null
              || (${b} == "string" && ${D} && ${D} == +${D})`).assign(T,(0,s._)`+${D}`);return;case"integer":x.elseIf((0,s._)`${b} === "boolean" || ${D} === null
              || (${b} === "string" && ${D} && ${D} == +${D} && !(${D} % 1))`).assign(T,(0,s._)`+${D}`);return;case"boolean":x.elseIf((0,s._)`${D} === "false" || ${D} === 0 || ${D} === null`).assign(T,!1).elseIf((0,s._)`${D} === "true" || ${D} === 1`).assign(T,!0);return;case"null":x.elseIf((0,s._)`${D} === "" || ${D} === 0 || ${D} === false`),x.assign(T,null);return;case"array":x.elseIf((0,s._)`${b} === "string" || ${b} === "number"
              || ${b} === "boolean" || ${D} === null`).assign(T,(0,s._)`[${D}]`)}}}function f({gen:g,parentData:v,parentDataProperty:S},x){g.if((0,s._)`${v} !== undefined`,()=>g.assign((0,s._)`${v}[${S}]`,x))}function p(g,v,S,x=o.Correct){const D=x===o.Correct?s.operators.EQ:s.operators.NEQ;let w;switch(g){case"null":return(0,s._)`${v} ${D} null`;case"array":w=(0,s._)`Array.isArray(${v})`;break;case"object":w=(0,s._)`${v} && typeof ${v} == "object" && !Array.isArray(${v})`;break;case"integer":w=b((0,s._)`!(${v} % 1) && !isNaN(${v})`);break;case"number":w=b();break;default:return(0,s._)`typeof ${v} ${D} ${g}`}return x===o.Correct?w:(0,s.not)(w);function b(T=s.nil){return(0,s.and)((0,s._)`typeof ${v} == "number"`,T,S?(0,s._)`isFinite(${v})`:s.nil)}}t.checkDataType=p;function m(g,v,S,x){if(g.length===1)return p(g[0],v,S,x);let D;const w=(0,i.toHash)(g);if(w.array&&w.object){const b=(0,s._)`typeof ${v} != "object"`;D=w.null?b:(0,s._)`!${v} || ${b}`,delete w.null,delete w.array,delete w.object}else D=s.nil;w.number&&delete w.integer;for(const b in w)D=(0,s.and)(D,p(b,v,S,x));return D}t.checkDataTypes=m;const E={message:({schema:g})=>`must be ${g}`,params:({schema:g,schemaValue:v})=>typeof g=="string"?(0,s._)`{type: ${g}}`:(0,s._)`{type: ${v}}`};function A(g){const v=_(g);(0,n.reportError)(v,E)}t.reportTypeError=A;function _(g){const{gen:v,data:S,schema:x}=g,D=(0,i.schemaRefOrVal)(g,x,"type");return{gen:v,keyword:"type",data:S,schema:x.type,schemaCode:D,schemaValue:D,parentSchema:x,params:{},it:g}}})(Qw);var RS={};Object.defineProperty(RS,"__esModule",{value:!0});RS.assignDefaults=void 0;const pm=rr,YEe=lr;function ZEe(t,e){const{properties:r,items:n}=t.schema;if(e==="object"&&r)for(const s in r)$M(t,s,r[s].default);else e==="array"&&Array.isArray(n)&&n.forEach((s,i)=>$M(t,i,s.default))}RS.assignDefaults=ZEe;function $M(t,e,r){const{gen:n,compositeRule:s,data:i,opts:o}=t;if(r===void 0)return;const a=(0,pm._)`${i}${(0,pm.getProperty)(e)}`;if(s){(0,YEe.checkStrictMode)(t,`default is ignored for: ${a}`);return}let u=(0,pm._)`${a} === undefined`;o.useDefaults==="empty"&&(u=(0,pm._)`${u} || ${a} === null || ${a} === ""`),n.if(u,(0,pm._)`${a} = ${(0,pm.stringify)(r)}`)}var Ou={},Qt={};Object.defineProperty(Qt,"__esModule",{value:!0});Qt.validateUnion=Qt.validateArray=Qt.usePattern=Qt.callValidateCode=Qt.schemaProperties=Qt.allSchemaProperties=Qt.noPropertyInData=Qt.propertyInData=Qt.isOwnProperty=Qt.hasPropFunc=Qt.reportMissingProp=Qt.checkMissingProp=Qt.checkReportMissingProp=void 0;const tn=rr,i$=lr,od=cc,QEe=lr;function eAe(t,e){const{gen:r,data:n,it:s}=t;r.if(o$(r,n,e,s.opts.ownProperties),()=>{t.setParams({missingProperty:(0,tn._)`${e}`},!0),t.error()})}Qt.checkReportMissingProp=eAe;function tAe({gen:t,data:e,it:{opts:r}},n,s){return(0,tn.or)(...n.map(i=>(0,tn.and)(o$(t,e,i,r.ownProperties),(0,tn._)`${s} = ${i}`)))}Qt.checkMissingProp=tAe;function rAe(t,e){t.setParams({missingProperty:e},!0),t.error()}Qt.reportMissingProp=rAe;function Rq(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,tn._)`Object.prototype.hasOwnProperty`})}Qt.hasPropFunc=Rq;function s$(t,e,r){return(0,tn._)`${Rq(t)}.call(${e}, ${r})`}Qt.isOwnProperty=s$;function nAe(t,e,r,n){const s=(0,tn._)`${e}${(0,tn.getProperty)(r)} !== undefined`;return n?(0,tn._)`${s} && ${s$(t,e,r)}`:s}Qt.propertyInData=nAe;function o$(t,e,r,n){const s=(0,tn._)`${e}${(0,tn.getProperty)(r)} === undefined`;return n?(0,tn.or)(s,(0,tn.not)(s$(t,e,r))):s}Qt.noPropertyInData=o$;function Nq(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}Qt.allSchemaProperties=Nq;function iAe(t,e){return Nq(e).filter(r=>!(0,i$.alwaysValidSchema)(t,e[r]))}Qt.schemaProperties=iAe;function sAe({schemaCode:t,data:e,it:{gen:r,topSchemaRef:n,schemaPath:s,errorPath:i},it:o},a,u,l){const c=l?(0,tn._)`${t}, ${e}, ${n}${s}`:e,d=[[od.default.instancePath,(0,tn.strConcat)(od.default.instancePath,i)],[od.default.parentData,o.parentData],[od.default.parentDataProperty,o.parentDataProperty],[od.default.rootData,od.default.rootData]];o.opts.dynamicRef&&d.push([od.default.dynamicAnchors,od.default.dynamicAnchors]);const h=(0,tn._)`${c}, ${r.object(...d)}`;return u!==tn.nil?(0,tn._)`${a}.call(${u}, ${h})`:(0,tn._)`${a}(${h})`}Qt.callValidateCode=sAe;const oAe=(0,tn._)`new RegExp`;function aAe({gen:t,it:{opts:e}},r){const n=e.unicodeRegExp?"u":"",{regExp:s}=e.code,i=s(r,n);return t.scopeValue("pattern",{key:i.toString(),ref:i,code:(0,tn._)`${s.code==="new RegExp"?oAe:(0,QEe.useFunc)(t,s)}(${r}, ${n})`})}Qt.usePattern=aAe;function uAe(t){const{gen:e,data:r,keyword:n,it:s}=t,i=e.name("valid");if(s.allErrors){const a=e.let("valid",!0);return o(()=>e.assign(a,!1)),a}return e.var(i,!0),o(()=>e.break()),i;function o(a){const u=e.const("len",(0,tn._)`${r}.length`);e.forRange("i",0,u,l=>{t.subschema({keyword:n,dataProp:l,dataPropType:i$.Type.Num},i),e.if((0,tn.not)(i),a)})}}Qt.validateArray=uAe;function cAe(t){const{gen:e,schema:r,keyword:n,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(u=>(0,i$.alwaysValidSchema)(s,u))&&!s.opts.unevaluated)return;const o=e.let("valid",!1),a=e.name("_valid");e.block(()=>r.forEach((u,l)=>{const c=t.subschema({keyword:n,schemaProp:l,compositeRule:!0},a);e.assign(o,(0,tn._)`${o} || ${a}`),t.mergeValidEvaluated(c,a)||e.if((0,tn.not)(o))})),t.result(o,()=>t.reset(),()=>t.error(!0))}Qt.validateUnion=cAe;Object.defineProperty(Ou,"__esModule",{value:!0});Ou.validateKeywordUsage=Ou.validSchemaType=Ou.funcKeywordCode=Ou.macroKeywordCode=void 0;const ds=rr,$h=cc,lAe=Qt,dAe=Zw;function fAe(t,e){const{gen:r,keyword:n,schema:s,parentSchema:i,it:o}=t,a=e.macro.call(o.self,s,i,o),u=Bq(r,n,a);o.opts.validateSchema!==!1&&o.self.validateSchema(a,!0);const l=r.name("valid");t.subschema({schema:a,schemaPath:ds.nil,errSchemaPath:`${o.errSchemaPath}/${n}`,topSchemaRef:u,compositeRule:!0},l),t.pass(l,()=>t.error(!0))}Ou.macroKeywordCode=fAe;function hAe(t,e){var r;const{gen:n,keyword:s,schema:i,parentSchema:o,$data:a,it:u}=t;mAe(u,e);const l=!a&&e.compile?e.compile.call(u.self,i,o,u):e.validate,c=Bq(n,s,l),d=n.let("valid");t.block$data(d,h),t.ok((r=e.valid)!==null&&r!==void 0?r:d);function h(){if(e.errors===!1)m(),e.modifying&&OM(t),E(()=>t.error());else{const A=e.async?f():p();e.modifying&&OM(t),E(()=>pAe(t,A))}}function f(){const A=n.let("ruleErrs",null);return n.try(()=>m((0,ds._)`await `),_=>n.assign(d,!1).if((0,ds._)`${_} instanceof ${u.ValidationError}`,()=>n.assign(A,(0,ds._)`${_}.errors`),()=>n.throw(_))),A}function p(){const A=(0,ds._)`${c}.errors`;return n.assign(A,null),m(ds.nil),A}function m(A=e.async?(0,ds._)`await `:ds.nil){const _=u.opts.passContext?$h.default.this:$h.default.self,g=!("compile"in e&&!a||e.schema===!1);n.assign(d,(0,ds._)`${A}${(0,lAe.callValidateCode)(t,c,_,g)}`,e.modifying)}function E(A){var _;n.if((0,ds.not)((_=e.valid)!==null&&_!==void 0?_:d),A)}}Ou.funcKeywordCode=hAe;function OM(t){const{gen:e,data:r,it:n}=t;e.if(n.parentData,()=>e.assign(r,(0,ds._)`${n.parentData}[${n.parentDataProperty}]`))}function pAe(t,e){const{gen:r}=t;r.if((0,ds._)`Array.isArray(${e})`,()=>{r.assign($h.default.vErrors,(0,ds._)`${$h.default.vErrors} === null ? ${e} : ${$h.default.vErrors}.concat(${e})`).assign($h.default.errors,(0,ds._)`${$h.default.vErrors}.length`),(0,dAe.extendErrors)(t)},()=>t.error())}function mAe({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function Bq(t,e,r){if(r===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,ds.stringify)(r)})}function yAe(t,e,r=!1){return!e.length||e.some(n=>n==="array"?Array.isArray(t):n==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==n||r&&typeof t>"u")}Ou.validSchemaType=yAe;function gAe({schema:t,opts:e,self:r,errSchemaPath:n},s,i){if(Array.isArray(s.keyword)?!s.keyword.includes(i):s.keyword!==i)throw new Error("ajv implementation error");const o=s.dependencies;if(o!=null&&o.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${i}: ${o.join(",")}`);if(s.validateSchema&&!s.validateSchema(t[i])){const u=`keyword "${i}" value is invalid at path "${n}": `+r.errorsText(s.validateSchema.errors);if(e.validateSchema==="log")r.logger.error(u);else throw new Error(u)}}Ou.validateKeywordUsage=gAe;var of={};Object.defineProperty(of,"__esModule",{value:!0});of.extendSubschemaMode=of.extendSubschemaData=of.getSubschema=void 0;const Cu=rr,Fq=lr;function vAe(t,{keyword:e,schemaProp:r,schema:n,schemaPath:s,errSchemaPath:i,topSchemaRef:o}){if(e!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){const a=t.schema[e];return r===void 0?{schema:a,schemaPath:(0,Cu._)`${t.schemaPath}${(0,Cu.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[r],schemaPath:(0,Cu._)`${t.schemaPath}${(0,Cu.getProperty)(e)}${(0,Cu.getProperty)(r)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,Fq.escapeFragment)(r)}`}}if(n!==void 0){if(s===void 0||i===void 0||o===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:s,topSchemaRef:o,errSchemaPath:i}}throw new Error('either "keyword" or "schema" must be passed')}of.getSubschema=vAe;function wAe(t,e,{dataProp:r,dataPropType:n,data:s,dataTypes:i,propertyName:o}){if(s!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:a}=e;if(r!==void 0){const{errorPath:l,dataPathArr:c,opts:d}=e,h=a.let("data",(0,Cu._)`${e.data}${(0,Cu.getProperty)(r)}`,!0);u(h),t.errorPath=(0,Cu.str)`${l}${(0,Fq.getErrorPath)(r,n,d.jsPropertySyntax)}`,t.parentDataProperty=(0,Cu._)`${r}`,t.dataPathArr=[...c,t.parentDataProperty]}if(s!==void 0){const l=s instanceof Cu.Name?s:a.let("data",s,!0);u(l),o!==void 0&&(t.propertyName=o)}i&&(t.dataTypes=i);function u(l){t.data=l,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,l]}}of.extendSubschemaData=wAe;function _Ae(t,{jtdDiscriminator:e,jtdMetadata:r,compositeRule:n,createErrors:s,allErrors:i}){n!==void 0&&(t.compositeRule=n),s!==void 0&&(t.createErrors=s),i!==void 0&&(t.allErrors=i),t.jtdDiscriminator=e,t.jtdMetadata=r}of.extendSubschemaMode=_Ae;var ki={};Object.defineProperty(ki,"__esModule",{value:!0});ki.getSchemaRefs=ki.resolveUrl=ki.normalizeId=ki._getFullPath=ki.getFullPath=ki.inlineRef=void 0;const bAe=lr,EAe=mS,AAe=DV,SAe=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function TAe(t,e=!0){return typeof t=="boolean"?!0:e===!0?!MP(t):e?Mq(t)<=e:!1}ki.inlineRef=TAe;const DAe=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function MP(t){for(const e in t){if(DAe.has(e))return!0;const r=t[e];if(Array.isArray(r)&&r.some(MP)||typeof r=="object"&&MP(r))return!0}return!1}function Mq(t){let e=0;for(const r in t){if(r==="$ref")return 1/0;if(e++,!SAe.has(r)&&(typeof t[r]=="object"&&(0,bAe.eachItem)(t[r],n=>e+=Mq(n)),e===1/0))return 1/0}return e}function jq(t,e="",r){r!==!1&&(e=ry(e));const n=t.parse(e);return Uq(t,n)}ki.getFullPath=jq;function Uq(t,e){return t.serialize(e).split("#")[0]+"#"}ki._getFullPath=Uq;const xAe=/#\/?$/;function ry(t){return t?t.replace(xAe,""):""}ki.normalizeId=ry;function PAe(t,e,r){return r=ry(r),t.resolve(e,r)}ki.resolveUrl=PAe;const CAe=/^[a-z_][-a-z0-9._]*$/i;function IAe(t,e){if(typeof t=="boolean")return{};const{schemaId:r,uriResolver:n}=this.opts,s=ry(t[r]||e),i={"":s},o=jq(n,s,!1),a={},u=new Set;return AAe(t,{allKeys:!0},(d,h,f,p)=>{if(p===void 0)return;const m=o+h;let E=i[p];typeof d[r]=="string"&&(E=A.call(this,d[r])),_.call(this,d.$anchor),_.call(this,d.$dynamicAnchor),i[h]=E;function A(g){const v=this.opts.uriResolver.resolve;if(g=ry(E?v(E,g):g),u.has(g))throw c(g);u.add(g);let S=this.refs[g];return typeof S=="string"&&(S=this.refs[S]),typeof S=="object"?l(d,S.schema,g):g!==ry(m)&&(g[0]==="#"?(l(d,a[g],g),a[g]=d):this.refs[g]=m),g}function _(g){if(typeof g=="string"){if(!CAe.test(g))throw new Error(`invalid anchor "${g}"`);A.call(this,`#${g}`)}}}),a;function l(d,h,f){if(h!==void 0&&!EAe(d,h))throw c(f)}function c(d){return new Error(`reference "${d}" resolves to more than one schema`)}}ki.getSchemaRefs=IAe;Object.defineProperty(Ua,"__esModule",{value:!0});Ua.getData=Ua.KeywordCxt=Ua.validateFunctionCode=void 0;const Lq=xy,RM=Qw,a$=cl,QE=Qw,kAe=RS,gv=Ou,yD=of,nt=rr,Ot=cc,$Ae=ki,ll=lr,l0=Zw;function OAe(t){if(qq(t)&&(Hq(t),Vq(t))){BAe(t);return}Kq(t,()=>(0,Lq.topBoolOrEmptySchema)(t))}Ua.validateFunctionCode=OAe;function Kq({gen:t,validateName:e,schema:r,schemaEnv:n,opts:s},i){s.code.es5?t.func(e,(0,nt._)`${Ot.default.data}, ${Ot.default.valCxt}`,n.$async,()=>{t.code((0,nt._)`"use strict"; ${NM(r,s)}`),NAe(t,s),t.code(i)}):t.func(e,(0,nt._)`${Ot.default.data}, ${RAe(s)}`,n.$async,()=>t.code(NM(r,s)).code(i))}function RAe(t){return(0,nt._)`{${Ot.default.instancePath}="", ${Ot.default.parentData}, ${Ot.default.parentDataProperty}, ${Ot.default.rootData}=${Ot.default.data}${t.dynamicRef?(0,nt._)`, ${Ot.default.dynamicAnchors}={}`:nt.nil}}={}`}function NAe(t,e){t.if(Ot.default.valCxt,()=>{t.var(Ot.default.instancePath,(0,nt._)`${Ot.default.valCxt}.${Ot.default.instancePath}`),t.var(Ot.default.parentData,(0,nt._)`${Ot.default.valCxt}.${Ot.default.parentData}`),t.var(Ot.default.parentDataProperty,(0,nt._)`${Ot.default.valCxt}.${Ot.default.parentDataProperty}`),t.var(Ot.default.rootData,(0,nt._)`${Ot.default.valCxt}.${Ot.default.rootData}`),e.dynamicRef&&t.var(Ot.default.dynamicAnchors,(0,nt._)`${Ot.default.valCxt}.${Ot.default.dynamicAnchors}`)},()=>{t.var(Ot.default.instancePath,(0,nt._)`""`),t.var(Ot.default.parentData,(0,nt._)`undefined`),t.var(Ot.default.parentDataProperty,(0,nt._)`undefined`),t.var(Ot.default.rootData,Ot.default.data),e.dynamicRef&&t.var(Ot.default.dynamicAnchors,(0,nt._)`{}`)})}function BAe(t){const{schema:e,opts:r,gen:n}=t;Kq(t,()=>{r.$comment&&e.$comment&&Wq(t),LAe(t),n.let(Ot.default.vErrors,null),n.let(Ot.default.errors,0),r.unevaluated&&FAe(t),zq(t),qAe(t)})}function FAe(t){const{gen:e,validateName:r}=t;t.evaluated=e.const("evaluated",(0,nt._)`${r}.evaluated`),e.if((0,nt._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,nt._)`${t.evaluated}.props`,(0,nt._)`undefined`)),e.if((0,nt._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,nt._)`${t.evaluated}.items`,(0,nt._)`undefined`))}function NM(t,e){const r=typeof t=="object"&&t[e.schemaId];return r&&(e.code.source||e.code.process)?(0,nt._)`/*# sourceURL=${r} */`:nt.nil}function MAe(t,e){if(qq(t)&&(Hq(t),Vq(t))){jAe(t,e);return}(0,Lq.boolOrEmptySchema)(t,e)}function Vq({schema:t,self:e}){if(typeof t=="boolean")return!t;for(const r in t)if(e.RULES.all[r])return!0;return!1}function qq(t){return typeof t.schema!="boolean"}function jAe(t,e){const{schema:r,gen:n,opts:s}=t;s.$comment&&r.$comment&&Wq(t),KAe(t),VAe(t);const i=n.const("_errs",Ot.default.errors);zq(t,i),n.var(e,(0,nt._)`${i} === ${Ot.default.errors}`)}function Hq(t){(0,ll.checkUnknownRules)(t),UAe(t)}function zq(t,e){if(t.opts.jtd)return BM(t,[],!1,e);const r=(0,RM.getSchemaTypes)(t.schema),n=(0,RM.coerceAndCheckDataType)(t,r);BM(t,r,!n,e)}function UAe(t){const{schema:e,errSchemaPath:r,opts:n,self:s}=t;e.$ref&&n.ignoreKeywordsWithRef&&(0,ll.schemaHasRulesButRef)(e,s.RULES)&&s.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function LAe(t){const{schema:e,opts:r}=t;e.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,ll.checkStrictMode)(t,"default is ignored in the schema root")}function KAe(t){const e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,$Ae.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function VAe(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function Wq({gen:t,schemaEnv:e,schema:r,errSchemaPath:n,opts:s}){const i=r.$comment;if(s.$comment===!0)t.code((0,nt._)`${Ot.default.self}.logger.log(${i})`);else if(typeof s.$comment=="function"){const o=(0,nt.str)`${n}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,nt._)`${Ot.default.self}.opts.$comment(${i}, ${o}, ${a}.schema)`)}}function qAe(t){const{gen:e,schemaEnv:r,validateName:n,ValidationError:s,opts:i}=t;r.$async?e.if((0,nt._)`${Ot.default.errors} === 0`,()=>e.return(Ot.default.data),()=>e.throw((0,nt._)`new ${s}(${Ot.default.vErrors})`)):(e.assign((0,nt._)`${n}.errors`,Ot.default.vErrors),i.unevaluated&&HAe(t),e.return((0,nt._)`${Ot.default.errors} === 0`))}function HAe({gen:t,evaluated:e,props:r,items:n}){r instanceof nt.Name&&t.assign((0,nt._)`${e}.props`,r),n instanceof nt.Name&&t.assign((0,nt._)`${e}.items`,n)}function BM(t,e,r,n){const{gen:s,schema:i,data:o,allErrors:a,opts:u,self:l}=t,{RULES:c}=l;if(i.$ref&&(u.ignoreKeywordsWithRef||!(0,ll.schemaHasRulesButRef)(i,c))){s.block(()=>Xq(t,"$ref",c.all.$ref.definition));return}u.jtd||zAe(t,e),s.block(()=>{for(const h of c.rules)d(h);d(c.post)});function d(h){(0,a$.shouldUseGroup)(i,h)&&(h.type?(s.if((0,QE.checkDataType)(h.type,o,u.strictNumbers)),FM(t,h),e.length===1&&e[0]===h.type&&r&&(s.else(),(0,QE.reportTypeError)(t)),s.endIf()):FM(t,h),a||s.if((0,nt._)`${Ot.default.errors} === ${n||0}`))}}function FM(t,e){const{gen:r,schema:n,opts:{useDefaults:s}}=t;s&&(0,kAe.assignDefaults)(t,e.type),r.block(()=>{for(const i of e.rules)(0,a$.shouldUseRule)(n,i)&&Xq(t,i.keyword,i.definition,e.type)})}function zAe(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(WAe(t,e),t.opts.allowUnionTypes||GAe(t,e),JAe(t,t.dataTypes))}function WAe(t,e){if(e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(r=>{Gq(t.dataTypes,r)||u$(t,`type "${r}" not allowed by context "${t.dataTypes.join(",")}"`)}),YAe(t,e)}}function GAe(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&u$(t,"use allowUnionTypes to allow union type keyword")}function JAe(t,e){const r=t.self.RULES.all;for(const n in r){const s=r[n];if(typeof s=="object"&&(0,a$.shouldUseRule)(t.schema,s)){const{type:i}=s.definition;i.length&&!i.some(o=>XAe(e,o))&&u$(t,`missing type "${i.join(",")}" for keyword "${n}"`)}}}function XAe(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function Gq(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function YAe(t,e){const r=[];for(const n of t.dataTypes)Gq(e,n)?r.push(n):e.includes("integer")&&n==="number"&&r.push("integer");t.dataTypes=r}function u$(t,e){const r=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${r}" (strictTypes)`,(0,ll.checkStrictMode)(t,e,t.opts.strictTypes)}class Jq{constructor(e,r,n){if((0,gv.validateKeywordUsage)(e,r,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=r.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,ll.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=r,this.$data)this.schemaCode=e.gen.const("vSchema",Yq(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,gv.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=e.gen.const("_errs",Ot.default.errors))}result(e,r,n){this.failResult((0,nt.not)(e),r,n)}failResult(e,r,n){this.gen.if(e),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,r){this.failResult((0,nt.not)(e),void 0,r)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);const{schemaCode:r}=this;this.fail((0,nt._)`${r} !== undefined && (${(0,nt.or)(this.invalid$data(),e)})`)}error(e,r,n){if(r){this.setParams(r),this._error(e,n),this.setParams({});return}this._error(e,n)}_error(e,r){(e?l0.reportExtraError:l0.reportError)(this,this.def.error,r)}$dataError(){(0,l0.reportError)(this,this.def.$dataError||l0.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,l0.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,r){r?Object.assign(this.params,e):this.params=e}block$data(e,r,n=nt.nil){this.gen.block(()=>{this.check$data(e,n),r()})}check$data(e=nt.nil,r=nt.nil){if(!this.$data)return;const{gen:n,schemaCode:s,schemaType:i,def:o}=this;n.if((0,nt.or)((0,nt._)`${s} === undefined`,r)),e!==nt.nil&&n.assign(e,!0),(i.length||o.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==nt.nil&&n.assign(e,!1)),n.else()}invalid$data(){const{gen:e,schemaCode:r,schemaType:n,def:s,it:i}=this;return(0,nt.or)(o(),a());function o(){if(n.length){if(!(r instanceof nt.Name))throw new Error("ajv implementation error");const u=Array.isArray(n)?n:[n];return(0,nt._)`${(0,QE.checkDataTypes)(u,r,i.opts.strictNumbers,QE.DataType.Wrong)}`}return nt.nil}function a(){if(s.validateSchema){const u=e.scopeValue("validate$data",{ref:s.validateSchema});return(0,nt._)`!${u}(${r})`}return nt.nil}}subschema(e,r){const n=(0,yD.getSubschema)(this.it,e);(0,yD.extendSubschemaData)(n,this.it,e),(0,yD.extendSubschemaMode)(n,e);const s={...this.it,...n,items:void 0,props:void 0};return MAe(s,r),s}mergeEvaluated(e,r){const{it:n,gen:s}=this;n.opts.unevaluated&&(n.props!==!0&&e.props!==void 0&&(n.props=ll.mergeEvaluated.props(s,e.props,n.props,r)),n.items!==!0&&e.items!==void 0&&(n.items=ll.mergeEvaluated.items(s,e.items,n.items,r)))}mergeValidEvaluated(e,r){const{it:n,gen:s}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return s.if(r,()=>this.mergeEvaluated(e,nt.Name)),!0}}Ua.KeywordCxt=Jq;function Xq(t,e,r,n){const s=new Jq(t,r,e);"code"in r?r.code(s,n):s.$data&&r.validate?(0,gv.funcKeywordCode)(s,r):"macro"in r?(0,gv.macroKeywordCode)(s,r):(r.compile||r.validate)&&(0,gv.funcKeywordCode)(s,r)}const ZAe=/^\/(?:[^~]|~0|~1)*$/,QAe=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function Yq(t,{dataLevel:e,dataNames:r,dataPathArr:n}){let s,i;if(t==="")return Ot.default.rootData;if(t[0]==="/"){if(!ZAe.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);s=t,i=Ot.default.rootData}else{const l=QAe.exec(t);if(!l)throw new Error(`Invalid JSON-pointer: ${t}`);const c=+l[1];if(s=l[2],s==="#"){if(c>=e)throw new Error(u("property/index",c));return n[e-c]}if(c>e)throw new Error(u("data",c));if(i=r[e-c],!s)return i}let o=i;const a=s.split("/");for(const l of a)l&&(i=(0,nt._)`${i}${(0,nt.getProperty)((0,ll.unescapeJsonPointer)(l))}`,o=(0,nt._)`${o} && ${i}`);return o;function u(l,c){return`Cannot access ${l} ${c} levels up, current level is ${e}`}}Ua.getData=Yq;var e_={};Object.defineProperty(e_,"__esModule",{value:!0});let eSe=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};e_.default=eSe;var t_={};Object.defineProperty(t_,"__esModule",{value:!0});const gD=ki;class tSe extends Error{constructor(e,r,n,s){super(s||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,gD.resolveUrl)(e,r,n),this.missingSchema=(0,gD.normalizeId)((0,gD.getFullPath)(e,this.missingRef))}}t_.default=tSe;var js={};Object.defineProperty(js,"__esModule",{value:!0});js.resolveSchema=js.getCompilingSchema=js.resolveRef=js.compileSchema=js.SchemaEnv=void 0;const wa=rr,rSe=e_,lh=cc,$a=ki,MM=lr,nSe=Ua;class NS{constructor(e){var r;this.refs={},this.dynamicAnchors={};let n;typeof e.schema=="object"&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(r=e.baseId)!==null&&r!==void 0?r:(0,$a.normalizeId)(n==null?void 0:n[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=n==null?void 0:n.$async,this.refs={}}}js.SchemaEnv=NS;function c$(t){const e=Zq.call(this,t);if(e)return e;const r=(0,$a.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:n,lines:s}=this.opts.code,{ownProperties:i}=this.opts,o=new wa.CodeGen(this.scope,{es5:n,lines:s,ownProperties:i});let a;t.$async&&(a=o.scopeValue("Error",{ref:rSe.default,code:(0,wa._)`require("ajv/dist/runtime/validation_error").default`}));const u=o.scopeName("validate");t.validateName=u;const l={gen:o,allErrors:this.opts.allErrors,data:lh.default.data,parentData:lh.default.parentData,parentDataProperty:lh.default.parentDataProperty,dataNames:[lh.default.data],dataPathArr:[wa.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:o.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,wa.stringify)(t.schema)}:{ref:t.schema}),validateName:u,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:r,baseId:t.baseId||r,schemaPath:wa.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,wa._)`""`,opts:this.opts,self:this};let c;try{this._compilations.add(t),(0,nSe.validateFunctionCode)(l),o.optimize(this.opts.code.optimize);const d=o.toString();c=`${o.scopeRefs(lh.default.scope)}return ${d}`,this.opts.code.process&&(c=this.opts.code.process(c,t));const f=new Function(`${lh.default.self}`,`${lh.default.scope}`,c)(this,this.scope.get());if(this.scope.value(u,{ref:f}),f.errors=null,f.schema=t.schema,f.schemaEnv=t,t.$async&&(f.$async=!0),this.opts.code.source===!0&&(f.source={validateName:u,validateCode:d,scopeValues:o._values}),this.opts.unevaluated){const{props:p,items:m}=l;f.evaluated={props:p instanceof wa.Name?void 0:p,items:m instanceof wa.Name?void 0:m,dynamicProps:p instanceof wa.Name,dynamicItems:m instanceof wa.Name},f.source&&(f.source.evaluated=(0,wa.stringify)(f.evaluated))}return t.validate=f,t}catch(d){throw delete t.validate,delete t.validateName,c&&this.logger.error("Error compiling schema, function code:",c),d}finally{this._compilations.delete(t)}}js.compileSchema=c$;function iSe(t,e,r){var n;r=(0,$a.resolveUrl)(this.opts.uriResolver,e,r);const s=t.refs[r];if(s)return s;let i=aSe.call(this,t,r);if(i===void 0){const o=(n=t.localRefs)===null||n===void 0?void 0:n[r],{schemaId:a}=this.opts;o&&(i=new NS({schema:o,schemaId:a,root:t,baseId:e}))}if(i!==void 0)return t.refs[r]=sSe.call(this,i)}js.resolveRef=iSe;function sSe(t){return(0,$a.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:c$.call(this,t)}function Zq(t){for(const e of this._compilations)if(oSe(e,t))return e}js.getCompilingSchema=Zq;function oSe(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function aSe(t,e){let r;for(;typeof(r=this.refs[e])=="string";)e=r;return r||this.schemas[e]||BS.call(this,t,e)}function BS(t,e){const r=this.opts.uriResolver.parse(e),n=(0,$a._getFullPath)(this.opts.uriResolver,r);let s=(0,$a.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&n===s)return vD.call(this,r,t);const i=(0,$a.normalizeId)(n),o=this.refs[i]||this.schemas[i];if(typeof o=="string"){const a=BS.call(this,t,o);return typeof(a==null?void 0:a.schema)!="object"?void 0:vD.call(this,r,a)}if(typeof(o==null?void 0:o.schema)=="object"){if(o.validate||c$.call(this,o),i===(0,$a.normalizeId)(e)){const{schema:a}=o,{schemaId:u}=this.opts,l=a[u];return l&&(s=(0,$a.resolveUrl)(this.opts.uriResolver,s,l)),new NS({schema:a,schemaId:u,root:t,baseId:s})}return vD.call(this,r,o)}}js.resolveSchema=BS;const uSe=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function vD(t,{baseId:e,schema:r,root:n}){var s;if(((s=t.fragment)===null||s===void 0?void 0:s[0])!=="/")return;for(const a of t.fragment.slice(1).split("/")){if(typeof r=="boolean")return;const u=r[(0,MM.unescapeFragment)(a)];if(u===void 0)return;r=u;const l=typeof r=="object"&&r[this.opts.schemaId];!uSe.has(a)&&l&&(e=(0,$a.resolveUrl)(this.opts.uriResolver,e,l))}let i;if(typeof r!="boolean"&&r.$ref&&!(0,MM.schemaHasRulesButRef)(r,this.RULES)){const a=(0,$a.resolveUrl)(this.opts.uriResolver,e,r.$ref);i=BS.call(this,n,a)}const{schemaId:o}=this.opts;if(i=i||new NS({schema:r,schemaId:o,root:n,baseId:e}),i.schema!==i.root.schema)return i}const cSe="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",lSe="Meta-schema for $data reference (JSON AnySchema extension proposal)",dSe="object",fSe=["$data"],hSe={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},pSe=!1,mSe={$id:cSe,description:lSe,type:dSe,required:fSe,properties:hSe,additionalProperties:pSe};var l$={};Object.defineProperty(l$,"__esModule",{value:!0});const Qq=LL;Qq.code='require("ajv/dist/runtime/uri").default';l$.default=Qq;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;var e=Ua;Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return e.KeywordCxt}});var r=rr;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return r.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return r.CodeGen}});const n=e_,s=t_,i=Sp,o=js,a=rr,u=ki,l=Qw,c=lr,d=mSe,h=l$,f=(W,B)=>new RegExp(W,B);f.code="new RegExp";const p=["removeAdditional","useDefaults","coerceTypes"],m=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),E={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},A={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},_=200;function g(W){var B,te,z,$,F,ee,ne,le,me,ve,Pe,Ue,M,V,oe,j,I,N,Q,ce,pe,he,Ce,_e,G;const J=W.strict,ge=(B=W.code)===null||B===void 0?void 0:B.optimize,be=ge===!0||ge===void 0?1:ge||0,ke=(z=(te=W.code)===null||te===void 0?void 0:te.regExp)!==null&&z!==void 0?z:f,At=($=W.uriResolver)!==null&&$!==void 0?$:h.default;return{strictSchema:(ee=(F=W.strictSchema)!==null&&F!==void 0?F:J)!==null&&ee!==void 0?ee:!0,strictNumbers:(le=(ne=W.strictNumbers)!==null&&ne!==void 0?ne:J)!==null&&le!==void 0?le:!0,strictTypes:(ve=(me=W.strictTypes)!==null&&me!==void 0?me:J)!==null&&ve!==void 0?ve:"log",strictTuples:(Ue=(Pe=W.strictTuples)!==null&&Pe!==void 0?Pe:J)!==null&&Ue!==void 0?Ue:"log",strictRequired:(V=(M=W.strictRequired)!==null&&M!==void 0?M:J)!==null&&V!==void 0?V:!1,code:W.code?{...W.code,optimize:be,regExp:ke}:{optimize:be,regExp:ke},loopRequired:(oe=W.loopRequired)!==null&&oe!==void 0?oe:_,loopEnum:(j=W.loopEnum)!==null&&j!==void 0?j:_,meta:(I=W.meta)!==null&&I!==void 0?I:!0,messages:(N=W.messages)!==null&&N!==void 0?N:!0,inlineRefs:(Q=W.inlineRefs)!==null&&Q!==void 0?Q:!0,schemaId:(ce=W.schemaId)!==null&&ce!==void 0?ce:"$id",addUsedSchema:(pe=W.addUsedSchema)!==null&&pe!==void 0?pe:!0,validateSchema:(he=W.validateSchema)!==null&&he!==void 0?he:!0,validateFormats:(Ce=W.validateFormats)!==null&&Ce!==void 0?Ce:!0,unicodeRegExp:(_e=W.unicodeRegExp)!==null&&_e!==void 0?_e:!0,int32range:(G=W.int32range)!==null&&G!==void 0?G:!0,uriResolver:At}}class v{constructor(B={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,B=this.opts={...B,...g(B)};const{es5:te,lines:z}=this.opts.code;this.scope=new a.ValueScope({scope:{},prefixes:m,es5:te,lines:z}),this.logger=C(B.logger);const $=B.validateFormats;B.validateFormats=!1,this.RULES=(0,i.getRules)(),S.call(this,E,B,"NOT SUPPORTED"),S.call(this,A,B,"DEPRECATED","warn"),this._metaOpts=T.call(this),B.formats&&w.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),B.keywords&&b.call(this,B.keywords),typeof B.meta=="object"&&this.addMetaSchema(B.meta),D.call(this),B.validateFormats=$}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:B,meta:te,schemaId:z}=this.opts;let $=d;z==="id"&&($={...d},$.id=$.$id,delete $.$id),te&&B&&this.addMetaSchema($,$[z],!1)}defaultMeta(){const{meta:B,schemaId:te}=this.opts;return this.opts.defaultMeta=typeof B=="object"?B[te]||B:void 0}validate(B,te){let z;if(typeof B=="string"){if(z=this.getSchema(B),!z)throw new Error(`no schema with key or ref "${B}"`)}else z=this.compile(B);const $=z(te);return"$async"in z||(this.errors=z.errors),$}compile(B,te){const z=this._addSchema(B,te);return z.validate||this._compileSchemaEnv(z)}compileAsync(B,te){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:z}=this.opts;return $.call(this,B,te);async function $(ve,Pe){await F.call(this,ve.$schema);const Ue=this._addSchema(ve,Pe);return Ue.validate||ee.call(this,Ue)}async function F(ve){ve&&!this.getSchema(ve)&&await $.call(this,{$ref:ve},!0)}async function ee(ve){try{return this._compileSchemaEnv(ve)}catch(Pe){if(!(Pe instanceof s.default))throw Pe;return ne.call(this,Pe),await le.call(this,Pe.missingSchema),ee.call(this,ve)}}function ne({missingSchema:ve,missingRef:Pe}){if(this.refs[ve])throw new Error(`AnySchema ${ve} is loaded but ${Pe} cannot be resolved`)}async function le(ve){const Pe=await me.call(this,ve);this.refs[ve]||await F.call(this,Pe.$schema),this.refs[ve]||this.addSchema(Pe,ve,te)}async function me(ve){const Pe=this._loading[ve];if(Pe)return Pe;try{return await(this._loading[ve]=z(ve))}finally{delete this._loading[ve]}}}addSchema(B,te,z,$=this.opts.validateSchema){if(Array.isArray(B)){for(const ee of B)this.addSchema(ee,void 0,z,$);return this}let F;if(typeof B=="object"){const{schemaId:ee}=this.opts;if(F=B[ee],F!==void 0&&typeof F!="string")throw new Error(`schema ${ee} must be string`)}return te=(0,u.normalizeId)(te||F),this._checkUnique(te),this.schemas[te]=this._addSchema(B,z,te,$,!0),this}addMetaSchema(B,te,z=this.opts.validateSchema){return this.addSchema(B,te,!0,z),this}validateSchema(B,te){if(typeof B=="boolean")return!0;let z;if(z=B.$schema,z!==void 0&&typeof z!="string")throw new Error("$schema must be a string");if(z=z||this.opts.defaultMeta||this.defaultMeta(),!z)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const $=this.validate(z,B);if(!$&&te){const F="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(F);else throw new Error(F)}return $}getSchema(B){let te;for(;typeof(te=x.call(this,B))=="string";)B=te;if(te===void 0){const{schemaId:z}=this.opts,$=new o.SchemaEnv({schema:{},schemaId:z});if(te=o.resolveSchema.call(this,$,B),!te)return;this.refs[B]=te}return te.validate||this._compileSchemaEnv(te)}removeSchema(B){if(B instanceof RegExp)return this._removeAllSchemas(this.schemas,B),this._removeAllSchemas(this.refs,B),this;switch(typeof B){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const te=x.call(this,B);return typeof te=="object"&&this._cache.delete(te.schema),delete this.schemas[B],delete this.refs[B],this}case"object":{const te=B;this._cache.delete(te);let z=B[this.opts.schemaId];return z&&(z=(0,u.normalizeId)(z),delete this.schemas[z],delete this.refs[z]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(B){for(const te of B)this.addKeyword(te);return this}addKeyword(B,te){let z;if(typeof B=="string")z=B,typeof te=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),te.keyword=z);else if(typeof B=="object"&&te===void 0){if(te=B,z=te.keyword,Array.isArray(z)&&!z.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(K.call(this,z,te),!te)return(0,c.eachItem)(z,F=>L.call(this,F)),this;se.call(this,te);const $={...te,type:(0,l.getJSONTypes)(te.type),schemaType:(0,l.getJSONTypes)(te.schemaType)};return(0,c.eachItem)(z,$.type.length===0?F=>L.call(this,F,$):F=>$.type.forEach(ee=>L.call(this,F,$,ee))),this}getKeyword(B){const te=this.RULES.all[B];return typeof te=="object"?te.definition:!!te}removeKeyword(B){const{RULES:te}=this;delete te.keywords[B],delete te.all[B];for(const z of te.rules){const $=z.rules.findIndex(F=>F.keyword===B);$>=0&&z.rules.splice($,1)}return this}addFormat(B,te){return typeof te=="string"&&(te=new RegExp(te)),this.formats[B]=te,this}errorsText(B=this.errors,{separator:te=", ",dataVar:z="data"}={}){return!B||B.length===0?"No errors":B.map($=>`${z}${$.instancePath} ${$.message}`).reduce(($,F)=>$+te+F)}$dataMetaSchema(B,te){const z=this.RULES.all;B=JSON.parse(JSON.stringify(B));for(const $ of te){const F=$.split("/").slice(1);let ee=B;for(const ne of F)ee=ee[ne];for(const ne in z){const le=z[ne];if(typeof le!="object")continue;const{$data:me}=le.definition,ve=ee[ne];me&&ve&&(ee[ne]=re(ve))}}return B}_removeAllSchemas(B,te){for(const z in B){const $=B[z];(!te||te.test(z))&&(typeof $=="string"?delete B[z]:$&&!$.meta&&(this._cache.delete($.schema),delete B[z]))}}_addSchema(B,te,z,$=this.opts.validateSchema,F=this.opts.addUsedSchema){let ee;const{schemaId:ne}=this.opts;if(typeof B=="object")ee=B[ne];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof B!="boolean")throw new Error("schema must be object or boolean")}let le=this._cache.get(B);if(le!==void 0)return le;z=(0,u.normalizeId)(ee||z);const me=u.getSchemaRefs.call(this,B,z);return le=new o.SchemaEnv({schema:B,schemaId:ne,meta:te,baseId:z,localRefs:me}),this._cache.set(le.schema,le),F&&!z.startsWith("#")&&(z&&this._checkUnique(z),this.refs[z]=le),$&&this.validateSchema(B,!0),le}_checkUnique(B){if(this.schemas[B]||this.refs[B])throw new Error(`schema with key or id "${B}" already exists`)}_compileSchemaEnv(B){if(B.meta?this._compileMetaSchema(B):o.compileSchema.call(this,B),!B.validate)throw new Error("ajv implementation error");return B.validate}_compileMetaSchema(B){const te=this.opts;this.opts=this._metaOpts;try{o.compileSchema.call(this,B)}finally{this.opts=te}}}t.default=v,v.ValidationError=n.default,v.MissingRefError=s.default;function S(W,B,te,z="error"){for(const $ in W){const F=$;F in B&&this.logger[z](`${te}: option ${$}. ${W[F]}`)}}function x(W){return W=(0,u.normalizeId)(W),this.schemas[W]||this.refs[W]}function D(){const W=this.opts.schemas;if(W)if(Array.isArray(W))this.addSchema(W);else for(const B in W)this.addSchema(W[B],B)}function w(){for(const W in this.opts.formats){const B=this.opts.formats[W];B&&this.addFormat(W,B)}}function b(W){if(Array.isArray(W)){this.addVocabulary(W);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const B in W){const te=W[B];te.keyword||(te.keyword=B),this.addKeyword(te)}}function T(){const W={...this.opts};for(const B of p)delete W[B];return W}const P={log(){},warn(){},error(){}};function C(W){if(W===!1)return P;if(W===void 0)return console;if(W.log&&W.warn&&W.error)return W;throw new Error("logger must implement log, warn and error methods")}const k=/^[a-z_$][a-z0-9_$:-]*$/i;function K(W,B){const{RULES:te}=this;if((0,c.eachItem)(W,z=>{if(te.keywords[z])throw new Error(`Keyword ${z} is already defined`);if(!k.test(z))throw new Error(`Keyword ${z} has invalid name`)}),!!B&&B.$data&&!("code"in B||"validate"in B))throw new Error('$data keyword must have "code" or "validate" function')}function L(W,B,te){var z;const $=B==null?void 0:B.post;if(te&&$)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:F}=this;let ee=$?F.post:F.rules.find(({type:le})=>le===te);if(ee||(ee={type:te,rules:[]},F.rules.push(ee)),F.keywords[W]=!0,!B)return;const ne={keyword:W,definition:{...B,type:(0,l.getJSONTypes)(B.type),schemaType:(0,l.getJSONTypes)(B.schemaType)}};B.before?q.call(this,ee,ne,B.before):ee.rules.push(ne),F.all[W]=ne,(z=B.implements)===null||z===void 0||z.forEach(le=>this.addKeyword(le))}function q(W,B,te){const z=W.rules.findIndex($=>$.keyword===te);z>=0?W.rules.splice(z,0,B):(W.rules.push(B),this.logger.warn(`rule ${te} is not defined`))}function se(W){let{metaSchema:B}=W;B!==void 0&&(W.$data&&this.opts.$data&&(B=re(B)),W.validateSchema=this.compile(B,!0))}const X={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function re(W){return{anyOf:[W,X]}}})(Iq);var d$={},f$={},h$={};Object.defineProperty(h$,"__esModule",{value:!0});const ySe={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};h$.default=ySe;var Tp={};Object.defineProperty(Tp,"__esModule",{value:!0});Tp.callRef=Tp.getValidate=void 0;const gSe=t_,jM=Qt,Ns=rr,mm=cc,UM=js,Vb=lr,vSe={keyword:"$ref",schemaType:"string",code(t){const{gen:e,schema:r,it:n}=t,{baseId:s,schemaEnv:i,validateName:o,opts:a,self:u}=n,{root:l}=i;if((r==="#"||r==="#/")&&s===l.baseId)return d();const c=UM.resolveRef.call(u,l,s,r);if(c===void 0)throw new gSe.default(n.opts.uriResolver,s,r);if(c instanceof UM.SchemaEnv)return h(c);return f(c);function d(){if(i===l)return q1(t,o,i,i.$async);const p=e.scopeValue("root",{ref:l});return q1(t,(0,Ns._)`${p}.validate`,l,l.$async)}function h(p){const m=eH(t,p);q1(t,m,p,p.$async)}function f(p){const m=e.scopeValue("schema",a.code.source===!0?{ref:p,code:(0,Ns.stringify)(p)}:{ref:p}),E=e.name("valid"),A=t.subschema({schema:p,dataTypes:[],schemaPath:Ns.nil,topSchemaRef:m,errSchemaPath:r},E);t.mergeEvaluated(A),t.ok(E)}}};function eH(t,e){const{gen:r}=t;return e.validate?r.scopeValue("validate",{ref:e.validate}):(0,Ns._)`${r.scopeValue("wrapper",{ref:e})}.validate`}Tp.getValidate=eH;function q1(t,e,r,n){const{gen:s,it:i}=t,{allErrors:o,schemaEnv:a,opts:u}=i,l=u.passContext?mm.default.this:Ns.nil;n?c():d();function c(){if(!a.$async)throw new Error("async schema referenced by sync schema");const p=s.let("valid");s.try(()=>{s.code((0,Ns._)`await ${(0,jM.callValidateCode)(t,e,l)}`),f(e),o||s.assign(p,!0)},m=>{s.if((0,Ns._)`!(${m} instanceof ${i.ValidationError})`,()=>s.throw(m)),h(m),o||s.assign(p,!1)}),t.ok(p)}function d(){t.result((0,jM.callValidateCode)(t,e,l),()=>f(e),()=>h(e))}function h(p){const m=(0,Ns._)`${p}.errors`;s.assign(mm.default.vErrors,(0,Ns._)`${mm.default.vErrors} === null ? ${m} : ${mm.default.vErrors}.concat(${m})`),s.assign(mm.default.errors,(0,Ns._)`${mm.default.vErrors}.length`)}function f(p){var m;if(!i.opts.unevaluated)return;const E=(m=r==null?void 0:r.validate)===null||m===void 0?void 0:m.evaluated;if(i.props!==!0)if(E&&!E.dynamicProps)E.props!==void 0&&(i.props=Vb.mergeEvaluated.props(s,E.props,i.props));else{const A=s.var("props",(0,Ns._)`${p}.evaluated.props`);i.props=Vb.mergeEvaluated.props(s,A,i.props,Ns.Name)}if(i.items!==!0)if(E&&!E.dynamicItems)E.items!==void 0&&(i.items=Vb.mergeEvaluated.items(s,E.items,i.items));else{const A=s.var("items",(0,Ns._)`${p}.evaluated.items`);i.items=Vb.mergeEvaluated.items(s,A,i.items,Ns.Name)}}}Tp.callRef=q1;Tp.default=vSe;Object.defineProperty(f$,"__esModule",{value:!0});const wSe=h$,_Se=Tp,bSe=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",wSe.default,_Se.default];f$.default=bSe;var p$={},m$={};Object.defineProperty(m$,"__esModule",{value:!0});const eA=rr,ad=eA.operators,tA={maximum:{okStr:"<=",ok:ad.LTE,fail:ad.GT},minimum:{okStr:">=",ok:ad.GTE,fail:ad.LT},exclusiveMaximum:{okStr:"<",ok:ad.LT,fail:ad.GTE},exclusiveMinimum:{okStr:">",ok:ad.GT,fail:ad.LTE}},ESe={message:({keyword:t,schemaCode:e})=>(0,eA.str)`must be ${tA[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,eA._)`{comparison: ${tA[t].okStr}, limit: ${e}}`},ASe={keyword:Object.keys(tA),type:"number",schemaType:"number",$data:!0,error:ESe,code(t){const{keyword:e,data:r,schemaCode:n}=t;t.fail$data((0,eA._)`${r} ${tA[e].fail} ${n} || isNaN(${r})`)}};m$.default=ASe;var y$={};Object.defineProperty(y$,"__esModule",{value:!0});const vv=rr,SSe={message:({schemaCode:t})=>(0,vv.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,vv._)`{multipleOf: ${t}}`},TSe={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:SSe,code(t){const{gen:e,data:r,schemaCode:n,it:s}=t,i=s.opts.multipleOfPrecision,o=e.let("res"),a=i?(0,vv._)`Math.abs(Math.round(${o}) - ${o}) > 1e-${i}`:(0,vv._)`${o} !== parseInt(${o})`;t.fail$data((0,vv._)`(${n} === 0 || (${o} = ${r}/${n}, ${a}))`)}};y$.default=TSe;var g$={},v$={};Object.defineProperty(v$,"__esModule",{value:!0});function tH(t){const e=t.length;let r=0,n=0,s;for(;n<e;)r++,s=t.charCodeAt(n++),s>=55296&&s<=56319&&n<e&&(s=t.charCodeAt(n),(s&64512)===56320&&n++);return r}v$.default=tH;tH.code='require("ajv/dist/runtime/ucs2length").default';Object.defineProperty(g$,"__esModule",{value:!0});const Oh=rr,DSe=lr,xSe=v$,PSe={message({keyword:t,schemaCode:e}){const r=t==="maxLength"?"more":"fewer";return(0,Oh.str)`must NOT have ${r} than ${e} characters`},params:({schemaCode:t})=>(0,Oh._)`{limit: ${t}}`},CSe={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:PSe,code(t){const{keyword:e,data:r,schemaCode:n,it:s}=t,i=e==="maxLength"?Oh.operators.GT:Oh.operators.LT,o=s.opts.unicode===!1?(0,Oh._)`${r}.length`:(0,Oh._)`${(0,DSe.useFunc)(t.gen,xSe.default)}(${r})`;t.fail$data((0,Oh._)`${o} ${i} ${n}`)}};g$.default=CSe;var w$={};Object.defineProperty(w$,"__esModule",{value:!0});const ISe=Qt,rA=rr,kSe={message:({schemaCode:t})=>(0,rA.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,rA._)`{pattern: ${t}}`},$Se={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:kSe,code(t){const{data:e,$data:r,schema:n,schemaCode:s,it:i}=t,o=i.opts.unicodeRegExp?"u":"",a=r?(0,rA._)`(new RegExp(${s}, ${o}))`:(0,ISe.usePattern)(t,n);t.fail$data((0,rA._)`!${a}.test(${e})`)}};w$.default=$Se;var _$={};Object.defineProperty(_$,"__esModule",{value:!0});const wv=rr,OSe={message({keyword:t,schemaCode:e}){const r=t==="maxProperties"?"more":"fewer";return(0,wv.str)`must NOT have ${r} than ${e} properties`},params:({schemaCode:t})=>(0,wv._)`{limit: ${t}}`},RSe={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:OSe,code(t){const{keyword:e,data:r,schemaCode:n}=t,s=e==="maxProperties"?wv.operators.GT:wv.operators.LT;t.fail$data((0,wv._)`Object.keys(${r}).length ${s} ${n}`)}};_$.default=RSe;var b$={};Object.defineProperty(b$,"__esModule",{value:!0});const d0=Qt,_v=rr,NSe=lr,BSe={message:({params:{missingProperty:t}})=>(0,_v.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,_v._)`{missingProperty: ${t}}`},FSe={keyword:"required",type:"object",schemaType:"array",$data:!0,error:BSe,code(t){const{gen:e,schema:r,schemaCode:n,data:s,$data:i,it:o}=t,{opts:a}=o;if(!i&&r.length===0)return;const u=r.length>=a.loopRequired;if(o.allErrors?l():c(),a.strictRequired){const f=t.parentSchema.properties,{definedProperties:p}=t.it;for(const m of r)if((f==null?void 0:f[m])===void 0&&!p.has(m)){const E=o.schemaEnv.baseId+o.errSchemaPath,A=`required property "${m}" is not defined at "${E}" (strictRequired)`;(0,NSe.checkStrictMode)(o,A,o.opts.strictRequired)}}function l(){if(u||i)t.block$data(_v.nil,d);else for(const f of r)(0,d0.checkReportMissingProp)(t,f)}function c(){const f=e.let("missing");if(u||i){const p=e.let("valid",!0);t.block$data(p,()=>h(f,p)),t.ok(p)}else e.if((0,d0.checkMissingProp)(t,r,f)),(0,d0.reportMissingProp)(t,f),e.else()}function d(){e.forOf("prop",n,f=>{t.setParams({missingProperty:f}),e.if((0,d0.noPropertyInData)(e,s,f,a.ownProperties),()=>t.error())})}function h(f,p){t.setParams({missingProperty:f}),e.forOf(f,n,()=>{e.assign(p,(0,d0.propertyInData)(e,s,f,a.ownProperties)),e.if((0,_v.not)(p),()=>{t.error(),e.break()})},_v.nil)}}};b$.default=FSe;var E$={};Object.defineProperty(E$,"__esModule",{value:!0});const bv=rr,MSe={message({keyword:t,schemaCode:e}){const r=t==="maxItems"?"more":"fewer";return(0,bv.str)`must NOT have ${r} than ${e} items`},params:({schemaCode:t})=>(0,bv._)`{limit: ${t}}`},jSe={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:MSe,code(t){const{keyword:e,data:r,schemaCode:n}=t,s=e==="maxItems"?bv.operators.GT:bv.operators.LT;t.fail$data((0,bv._)`${r}.length ${s} ${n}`)}};E$.default=jSe;var A$={};Object.defineProperty(A$,"__esModule",{value:!0});const wD=Qw,Ti=rr,USe=lr,LSe=Kw,KSe={message:({params:{i:t,j:e}})=>(0,Ti.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,Ti._)`{i: ${t}, j: ${e}}`},VSe={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:KSe,code(t){const{gen:e,data:r,$data:n,schema:s,parentSchema:i,schemaCode:o,it:a}=t;if(!n&&!s)return;const u=e.let("valid"),l=i.items?(0,wD.getSchemaTypes)(i.items):[];t.block$data(u,c,(0,Ti._)`${o} === false`),t.ok(u);function c(){const p=e.let("i",(0,Ti._)`${r}.length`),m=e.let("j");t.setParams({i:p,j:m}),e.assign(u,!0),e.if((0,Ti._)`${p} > 1`,()=>(d()?h:f)(p,m))}function d(){return l.length>0&&!l.some(p=>p==="object"||p==="array")}function h(p,m){const E=e.name("item"),A=(0,wD.checkDataTypes)(l,E,a.opts.strictNumbers,wD.DataType.Wrong),_=e.const("indices",(0,Ti._)`{}`);e.for((0,Ti._)`;${p}--;`,()=>{e.let(E,(0,Ti._)`${r}[${p}]`),e.if(A,(0,Ti._)`continue`),l.length>1&&e.if((0,Ti._)`typeof ${E} == "string"`,(0,Ti._)`${E} += "_"`),e.if((0,Ti._)`typeof ${_}[${E}] == "number"`,()=>{e.assign(m,(0,Ti._)`${_}[${E}]`),t.error(),e.assign(u,!1).break()}).code((0,Ti._)`${_}[${E}] = ${p}`)})}function f(p,m){const E=(0,USe.useFunc)(e,LSe.default),A=e.name("outer");e.label(A).for((0,Ti._)`;${p}--;`,()=>e.for((0,Ti._)`${m} = ${p}; ${m}--;`,()=>e.if((0,Ti._)`${E}(${r}[${p}], ${r}[${m}])`,()=>{t.error(),e.assign(u,!1).break(A)})))}}};A$.default=VSe;var S$={};Object.defineProperty(S$,"__esModule",{value:!0});const jP=rr,qSe=lr,HSe=Kw,zSe={message:"must be equal to constant",params:({schemaCode:t})=>(0,jP._)`{allowedValue: ${t}}`},WSe={keyword:"const",$data:!0,error:zSe,code(t){const{gen:e,data:r,$data:n,schemaCode:s,schema:i}=t;n||i&&typeof i=="object"?t.fail$data((0,jP._)`!${(0,qSe.useFunc)(e,HSe.default)}(${r}, ${s})`):t.fail((0,jP._)`${i} !== ${r}`)}};S$.default=WSe;var T$={};Object.defineProperty(T$,"__esModule",{value:!0});const L0=rr,GSe=lr,JSe=Kw,XSe={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,L0._)`{allowedValues: ${t}}`},YSe={keyword:"enum",schemaType:"array",$data:!0,error:XSe,code(t){const{gen:e,data:r,$data:n,schema:s,schemaCode:i,it:o}=t;if(!n&&s.length===0)throw new Error("enum must have non-empty array");const a=s.length>=o.opts.loopEnum;let u;const l=()=>u??(u=(0,GSe.useFunc)(e,JSe.default));let c;if(a||n)c=e.let("valid"),t.block$data(c,d);else{if(!Array.isArray(s))throw new Error("ajv implementation error");const f=e.const("vSchema",i);c=(0,L0.or)(...s.map((p,m)=>h(f,m)))}t.pass(c);function d(){e.assign(c,!1),e.forOf("v",i,f=>e.if((0,L0._)`${l()}(${r}, ${f})`,()=>e.assign(c,!0).break()))}function h(f,p){const m=s[p];return typeof m=="object"&&m!==null?(0,L0._)`${l()}(${r}, ${f}[${p}])`:(0,L0._)`${r} === ${m}`}}};T$.default=YSe;Object.defineProperty(p$,"__esModule",{value:!0});const ZSe=m$,QSe=y$,e2e=g$,t2e=w$,r2e=_$,n2e=b$,i2e=E$,s2e=A$,o2e=S$,a2e=T$,u2e=[ZSe.default,QSe.default,e2e.default,t2e.default,r2e.default,n2e.default,i2e.default,s2e.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},o2e.default,a2e.default];p$.default=u2e;var D$={},eg={};Object.defineProperty(eg,"__esModule",{value:!0});eg.validateAdditionalItems=void 0;const Rh=rr,UP=lr,c2e={message:({params:{len:t}})=>(0,Rh.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Rh._)`{limit: ${t}}`},l2e={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:c2e,code(t){const{parentSchema:e,it:r}=t,{items:n}=e;if(!Array.isArray(n)){(0,UP.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}rH(t,n)}};function rH(t,e){const{gen:r,schema:n,data:s,keyword:i,it:o}=t;o.items=!0;const a=r.const("len",(0,Rh._)`${s}.length`);if(n===!1)t.setParams({len:e.length}),t.pass((0,Rh._)`${a} <= ${e.length}`);else if(typeof n=="object"&&!(0,UP.alwaysValidSchema)(o,n)){const l=r.var("valid",(0,Rh._)`${a} <= ${e.length}`);r.if((0,Rh.not)(l),()=>u(l)),t.ok(l)}function u(l){r.forRange("i",e.length,a,c=>{t.subschema({keyword:i,dataProp:c,dataPropType:UP.Type.Num},l),o.allErrors||r.if((0,Rh.not)(l),()=>r.break())})}}eg.validateAdditionalItems=rH;eg.default=l2e;var x$={},tg={};Object.defineProperty(tg,"__esModule",{value:!0});tg.validateTuple=void 0;const LM=rr,H1=lr,d2e=Qt,f2e={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){const{schema:e,it:r}=t;if(Array.isArray(e))return nH(t,"additionalItems",e);r.items=!0,!(0,H1.alwaysValidSchema)(r,e)&&t.ok((0,d2e.validateArray)(t))}};function nH(t,e,r=t.schema){const{gen:n,parentSchema:s,data:i,keyword:o,it:a}=t;c(s),a.opts.unevaluated&&r.length&&a.items!==!0&&(a.items=H1.mergeEvaluated.items(n,r.length,a.items));const u=n.name("valid"),l=n.const("len",(0,LM._)`${i}.length`);r.forEach((d,h)=>{(0,H1.alwaysValidSchema)(a,d)||(n.if((0,LM._)`${l} > ${h}`,()=>t.subschema({keyword:o,schemaProp:h,dataProp:h},u)),t.ok(u))});function c(d){const{opts:h,errSchemaPath:f}=a,p=r.length,m=p===d.minItems&&(p===d.maxItems||d[e]===!1);if(h.strictTuples&&!m){const E=`"${o}" is ${p}-tuple, but minItems or maxItems/${e} are not specified or different at path "${f}"`;(0,H1.checkStrictMode)(a,E,h.strictTuples)}}}tg.validateTuple=nH;tg.default=f2e;Object.defineProperty(x$,"__esModule",{value:!0});const h2e=tg,p2e={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,h2e.validateTuple)(t,"items")};x$.default=p2e;var P$={};Object.defineProperty(P$,"__esModule",{value:!0});const KM=rr,m2e=lr,y2e=Qt,g2e=eg,v2e={message:({params:{len:t}})=>(0,KM.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,KM._)`{limit: ${t}}`},w2e={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:v2e,code(t){const{schema:e,parentSchema:r,it:n}=t,{prefixItems:s}=r;n.items=!0,!(0,m2e.alwaysValidSchema)(n,e)&&(s?(0,g2e.validateAdditionalItems)(t,s):t.ok((0,y2e.validateArray)(t)))}};P$.default=w2e;var C$={};Object.defineProperty(C$,"__esModule",{value:!0});const Wo=rr,qb=lr,_2e={message:({params:{min:t,max:e}})=>e===void 0?(0,Wo.str)`must contain at least ${t} valid item(s)`:(0,Wo.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,Wo._)`{minContains: ${t}}`:(0,Wo._)`{minContains: ${t}, maxContains: ${e}}`},b2e={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:_2e,code(t){const{gen:e,schema:r,parentSchema:n,data:s,it:i}=t;let o,a;const{minContains:u,maxContains:l}=n;i.opts.next?(o=u===void 0?1:u,a=l):o=1;const c=e.const("len",(0,Wo._)`${s}.length`);if(t.setParams({min:o,max:a}),a===void 0&&o===0){(0,qb.checkStrictMode)(i,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&o>a){(0,qb.checkStrictMode)(i,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,qb.alwaysValidSchema)(i,r)){let m=(0,Wo._)`${c} >= ${o}`;a!==void 0&&(m=(0,Wo._)`${m} && ${c} <= ${a}`),t.pass(m);return}i.items=!0;const d=e.name("valid");a===void 0&&o===1?f(d,()=>e.if(d,()=>e.break())):o===0?(e.let(d,!0),a!==void 0&&e.if((0,Wo._)`${s}.length > 0`,h)):(e.let(d,!1),h()),t.result(d,()=>t.reset());function h(){const m=e.name("_valid"),E=e.let("count",0);f(m,()=>e.if(m,()=>p(E)))}function f(m,E){e.forRange("i",0,c,A=>{t.subschema({keyword:"contains",dataProp:A,dataPropType:qb.Type.Num,compositeRule:!0},m),E()})}function p(m){e.code((0,Wo._)`${m}++`),a===void 0?e.if((0,Wo._)`${m} >= ${o}`,()=>e.assign(d,!0).break()):(e.if((0,Wo._)`${m} > ${a}`,()=>e.assign(d,!1).break()),o===1?e.assign(d,!0):e.if((0,Wo._)`${m} >= ${o}`,()=>e.assign(d,!0)))}}};C$.default=b2e;var iH={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.validateSchemaDeps=t.validatePropertyDeps=t.error=void 0;const e=rr,r=lr,n=Qt;t.error={message:({params:{property:u,depsCount:l,deps:c}})=>{const d=l===1?"property":"properties";return(0,e.str)`must have ${d} ${c} when property ${u} is present`},params:({params:{property:u,depsCount:l,deps:c,missingProperty:d}})=>(0,e._)`{property: ${u},
    missingProperty: ${d},
    depsCount: ${l},
    deps: ${c}}`};const s={keyword:"dependencies",type:"object",schemaType:"object",error:t.error,code(u){const[l,c]=i(u);o(u,l),a(u,c)}};function i({schema:u}){const l={},c={};for(const d in u){if(d==="__proto__")continue;const h=Array.isArray(u[d])?l:c;h[d]=u[d]}return[l,c]}function o(u,l=u.schema){const{gen:c,data:d,it:h}=u;if(Object.keys(l).length===0)return;const f=c.let("missing");for(const p in l){const m=l[p];if(m.length===0)continue;const E=(0,n.propertyInData)(c,d,p,h.opts.ownProperties);u.setParams({property:p,depsCount:m.length,deps:m.join(", ")}),h.allErrors?c.if(E,()=>{for(const A of m)(0,n.checkReportMissingProp)(u,A)}):(c.if((0,e._)`${E} && (${(0,n.checkMissingProp)(u,m,f)})`),(0,n.reportMissingProp)(u,f),c.else())}}t.validatePropertyDeps=o;function a(u,l=u.schema){const{gen:c,data:d,keyword:h,it:f}=u,p=c.name("valid");for(const m in l)(0,r.alwaysValidSchema)(f,l[m])||(c.if((0,n.propertyInData)(c,d,m,f.opts.ownProperties),()=>{const E=u.subschema({keyword:h,schemaProp:m},p);u.mergeValidEvaluated(E,p)},()=>c.var(p,!0)),u.ok(p))}t.validateSchemaDeps=a,t.default=s})(iH);var I$={};Object.defineProperty(I$,"__esModule",{value:!0});const sH=rr,E2e=lr,A2e={message:"property name must be valid",params:({params:t})=>(0,sH._)`{propertyName: ${t.propertyName}}`},S2e={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:A2e,code(t){const{gen:e,schema:r,data:n,it:s}=t;if((0,E2e.alwaysValidSchema)(s,r))return;const i=e.name("valid");e.forIn("key",n,o=>{t.setParams({propertyName:o}),t.subschema({keyword:"propertyNames",data:o,dataTypes:["string"],propertyName:o,compositeRule:!0},i),e.if((0,sH.not)(i),()=>{t.error(!0),s.allErrors||e.break()})}),t.ok(i)}};I$.default=S2e;var FS={};Object.defineProperty(FS,"__esModule",{value:!0});const Hb=Qt,Ea=rr,T2e=cc,zb=lr,D2e={message:"must NOT have additional properties",params:({params:t})=>(0,Ea._)`{additionalProperty: ${t.additionalProperty}}`},x2e={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:D2e,code(t){const{gen:e,schema:r,parentSchema:n,data:s,errsCount:i,it:o}=t;if(!i)throw new Error("ajv implementation error");const{allErrors:a,opts:u}=o;if(o.props=!0,u.removeAdditional!=="all"&&(0,zb.alwaysValidSchema)(o,r))return;const l=(0,Hb.allSchemaProperties)(n.properties),c=(0,Hb.allSchemaProperties)(n.patternProperties);d(),t.ok((0,Ea._)`${i} === ${T2e.default.errors}`);function d(){e.forIn("key",s,E=>{!l.length&&!c.length?p(E):e.if(h(E),()=>p(E))})}function h(E){let A;if(l.length>8){const _=(0,zb.schemaRefOrVal)(o,n.properties,"properties");A=(0,Hb.isOwnProperty)(e,_,E)}else l.length?A=(0,Ea.or)(...l.map(_=>(0,Ea._)`${E} === ${_}`)):A=Ea.nil;return c.length&&(A=(0,Ea.or)(A,...c.map(_=>(0,Ea._)`${(0,Hb.usePattern)(t,_)}.test(${E})`))),(0,Ea.not)(A)}function f(E){e.code((0,Ea._)`delete ${s}[${E}]`)}function p(E){if(u.removeAdditional==="all"||u.removeAdditional&&r===!1){f(E);return}if(r===!1){t.setParams({additionalProperty:E}),t.error(),a||e.break();return}if(typeof r=="object"&&!(0,zb.alwaysValidSchema)(o,r)){const A=e.name("valid");u.removeAdditional==="failing"?(m(E,A,!1),e.if((0,Ea.not)(A),()=>{t.reset(),f(E)})):(m(E,A),a||e.if((0,Ea.not)(A),()=>e.break()))}}function m(E,A,_){const g={keyword:"additionalProperties",dataProp:E,dataPropType:zb.Type.Str};_===!1&&Object.assign(g,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema(g,A)}}};FS.default=x2e;var k$={};Object.defineProperty(k$,"__esModule",{value:!0});const P2e=Ua,VM=Qt,_D=lr,qM=FS,C2e={keyword:"properties",type:"object",schemaType:"object",code(t){const{gen:e,schema:r,parentSchema:n,data:s,it:i}=t;i.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&qM.default.code(new P2e.KeywordCxt(i,qM.default,"additionalProperties"));const o=(0,VM.allSchemaProperties)(r);for(const d of o)i.definedProperties.add(d);i.opts.unevaluated&&o.length&&i.props!==!0&&(i.props=_D.mergeEvaluated.props(e,(0,_D.toHash)(o),i.props));const a=o.filter(d=>!(0,_D.alwaysValidSchema)(i,r[d]));if(a.length===0)return;const u=e.name("valid");for(const d of a)l(d)?c(d):(e.if((0,VM.propertyInData)(e,s,d,i.opts.ownProperties)),c(d),i.allErrors||e.else().var(u,!0),e.endIf()),t.it.definedProperties.add(d),t.ok(u);function l(d){return i.opts.useDefaults&&!i.compositeRule&&r[d].default!==void 0}function c(d){t.subschema({keyword:"properties",schemaProp:d,dataProp:d},u)}}};k$.default=C2e;var $$={};Object.defineProperty($$,"__esModule",{value:!0});const HM=Qt,Wb=rr,zM=lr,WM=lr,I2e={keyword:"patternProperties",type:"object",schemaType:"object",code(t){const{gen:e,schema:r,data:n,parentSchema:s,it:i}=t,{opts:o}=i,a=(0,HM.allSchemaProperties)(r),u=a.filter(m=>(0,zM.alwaysValidSchema)(i,r[m]));if(a.length===0||u.length===a.length&&(!i.opts.unevaluated||i.props===!0))return;const l=o.strictSchema&&!o.allowMatchingProperties&&s.properties,c=e.name("valid");i.props!==!0&&!(i.props instanceof Wb.Name)&&(i.props=(0,WM.evaluatedPropsToName)(e,i.props));const{props:d}=i;h();function h(){for(const m of a)l&&f(m),i.allErrors?p(m):(e.var(c,!0),p(m),e.if(c))}function f(m){for(const E in l)new RegExp(m).test(E)&&(0,zM.checkStrictMode)(i,`property ${E} matches pattern ${m} (use allowMatchingProperties)`)}function p(m){e.forIn("key",n,E=>{e.if((0,Wb._)`${(0,HM.usePattern)(t,m)}.test(${E})`,()=>{const A=u.includes(m);A||t.subschema({keyword:"patternProperties",schemaProp:m,dataProp:E,dataPropType:WM.Type.Str},c),i.opts.unevaluated&&d!==!0?e.assign((0,Wb._)`${d}[${E}]`,!0):!A&&!i.allErrors&&e.if((0,Wb.not)(c),()=>e.break())})})}}};$$.default=I2e;var O$={};Object.defineProperty(O$,"__esModule",{value:!0});const k2e=lr,$2e={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){const{gen:e,schema:r,it:n}=t;if((0,k2e.alwaysValidSchema)(n,r)){t.fail();return}const s=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},s),t.failResult(s,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};O$.default=$2e;var R$={};Object.defineProperty(R$,"__esModule",{value:!0});const O2e=Qt,R2e={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:O2e.validateUnion,error:{message:"must match a schema in anyOf"}};R$.default=R2e;var N$={};Object.defineProperty(N$,"__esModule",{value:!0});const z1=rr,N2e=lr,B2e={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,z1._)`{passingSchemas: ${t.passing}}`},F2e={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:B2e,code(t){const{gen:e,schema:r,parentSchema:n,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(s.opts.discriminator&&n.discriminator)return;const i=r,o=e.let("valid",!1),a=e.let("passing",null),u=e.name("_valid");t.setParams({passing:a}),e.block(l),t.result(o,()=>t.reset(),()=>t.error(!0));function l(){i.forEach((c,d)=>{let h;(0,N2e.alwaysValidSchema)(s,c)?e.var(u,!0):h=t.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},u),d>0&&e.if((0,z1._)`${u} && ${o}`).assign(o,!1).assign(a,(0,z1._)`[${a}, ${d}]`).else(),e.if(u,()=>{e.assign(o,!0),e.assign(a,d),h&&t.mergeEvaluated(h,z1.Name)})})}}};N$.default=F2e;var B$={};Object.defineProperty(B$,"__esModule",{value:!0});const M2e=lr,j2e={keyword:"allOf",schemaType:"array",code(t){const{gen:e,schema:r,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");const s=e.name("valid");r.forEach((i,o)=>{if((0,M2e.alwaysValidSchema)(n,i))return;const a=t.subschema({keyword:"allOf",schemaProp:o},s);t.ok(s),t.mergeEvaluated(a)})}};B$.default=j2e;var F$={};Object.defineProperty(F$,"__esModule",{value:!0});const nA=rr,oH=lr,U2e={message:({params:t})=>(0,nA.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,nA._)`{failingKeyword: ${t.ifClause}}`},L2e={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:U2e,code(t){const{gen:e,parentSchema:r,it:n}=t;r.then===void 0&&r.else===void 0&&(0,oH.checkStrictMode)(n,'"if" without "then" and "else" is ignored');const s=GM(n,"then"),i=GM(n,"else");if(!s&&!i)return;const o=e.let("valid",!0),a=e.name("_valid");if(u(),t.reset(),s&&i){const c=e.let("ifClause");t.setParams({ifClause:c}),e.if(a,l("then",c),l("else",c))}else s?e.if(a,l("then")):e.if((0,nA.not)(a),l("else"));t.pass(o,()=>t.error(!0));function u(){const c=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(c)}function l(c,d){return()=>{const h=t.subschema({keyword:c},a);e.assign(o,a),t.mergeValidEvaluated(h,o),d?e.assign(d,(0,nA._)`${c}`):t.setParams({ifClause:c})}}}};function GM(t,e){const r=t.schema[e];return r!==void 0&&!(0,oH.alwaysValidSchema)(t,r)}F$.default=L2e;var M$={};Object.defineProperty(M$,"__esModule",{value:!0});const K2e=lr,V2e={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:r}){e.if===void 0&&(0,K2e.checkStrictMode)(r,`"${t}" without "if" is ignored`)}};M$.default=V2e;Object.defineProperty(D$,"__esModule",{value:!0});const q2e=eg,H2e=x$,z2e=tg,W2e=P$,G2e=C$,J2e=iH,X2e=I$,Y2e=FS,Z2e=k$,Q2e=$$,eTe=O$,tTe=R$,rTe=N$,nTe=B$,iTe=F$,sTe=M$;function oTe(t=!1){const e=[eTe.default,tTe.default,rTe.default,nTe.default,iTe.default,sTe.default,X2e.default,Y2e.default,J2e.default,Z2e.default,Q2e.default];return t?e.push(H2e.default,W2e.default):e.push(q2e.default,z2e.default),e.push(G2e.default),e}D$.default=oTe;var j$={},U$={};Object.defineProperty(U$,"__esModule",{value:!0});const En=rr,aTe={message:({schemaCode:t})=>(0,En.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,En._)`{format: ${t}}`},uTe={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:aTe,code(t,e){const{gen:r,data:n,$data:s,schema:i,schemaCode:o,it:a}=t,{opts:u,errSchemaPath:l,schemaEnv:c,self:d}=a;if(!u.validateFormats)return;s?h():f();function h(){const p=r.scopeValue("formats",{ref:d.formats,code:u.code.formats}),m=r.const("fDef",(0,En._)`${p}[${o}]`),E=r.let("fType"),A=r.let("format");r.if((0,En._)`typeof ${m} == "object" && !(${m} instanceof RegExp)`,()=>r.assign(E,(0,En._)`${m}.type || "string"`).assign(A,(0,En._)`${m}.validate`),()=>r.assign(E,(0,En._)`"string"`).assign(A,m)),t.fail$data((0,En.or)(_(),g()));function _(){return u.strictSchema===!1?En.nil:(0,En._)`${o} && !${A}`}function g(){const v=c.$async?(0,En._)`(${m}.async ? await ${A}(${n}) : ${A}(${n}))`:(0,En._)`${A}(${n})`,S=(0,En._)`(typeof ${A} == "function" ? ${v} : ${A}.test(${n}))`;return(0,En._)`${A} && ${A} !== true && ${E} === ${e} && !${S}`}}function f(){const p=d.formats[i];if(!p){_();return}if(p===!0)return;const[m,E,A]=g(p);m===e&&t.pass(v());function _(){if(u.strictSchema===!1){d.logger.warn(S());return}throw new Error(S());function S(){return`unknown format "${i}" ignored in schema at path "${l}"`}}function g(S){const x=S instanceof RegExp?(0,En.regexpCode)(S):u.code.formats?(0,En._)`${u.code.formats}${(0,En.getProperty)(i)}`:void 0,D=r.scopeValue("formats",{key:i,ref:S,code:x});return typeof S=="object"&&!(S instanceof RegExp)?[S.type||"string",S.validate,(0,En._)`${D}.validate`]:["string",S,D]}function v(){if(typeof p=="object"&&!(p instanceof RegExp)&&p.async){if(!c.$async)throw new Error("async format in sync schema");return(0,En._)`await ${A}(${n})`}return typeof E=="function"?(0,En._)`${A}(${n})`:(0,En._)`${A}.test(${n})`}}}};U$.default=uTe;Object.defineProperty(j$,"__esModule",{value:!0});const cTe=U$,lTe=[cTe.default];j$.default=lTe;var Py={};Object.defineProperty(Py,"__esModule",{value:!0});Py.contentVocabulary=Py.metadataVocabulary=void 0;Py.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];Py.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"];Object.defineProperty(d$,"__esModule",{value:!0});const dTe=f$,fTe=p$,hTe=D$,pTe=j$,JM=Py,mTe=[dTe.default,fTe.default,(0,hTe.default)(),pTe.default,JM.metadataVocabulary,JM.contentVocabulary];d$.default=mTe;var L$={},aH={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DiscrError=void 0,function(e){e.Tag="tag",e.Mapping="mapping"}(t.DiscrError||(t.DiscrError={}))})(aH);Object.defineProperty(L$,"__esModule",{value:!0});const Pm=rr,LP=aH,XM=js,yTe=lr,gTe={message:({params:{discrError:t,tagName:e}})=>t===LP.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:r}})=>(0,Pm._)`{error: ${t}, tag: ${r}, tagValue: ${e}}`},vTe={keyword:"discriminator",type:"object",schemaType:"object",error:gTe,code(t){const{gen:e,data:r,schema:n,parentSchema:s,it:i}=t,{oneOf:o}=s;if(!i.opts.discriminator)throw new Error("discriminator: requires discriminator option");const a=n.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!o)throw new Error("discriminator: requires oneOf keyword");const u=e.let("valid",!1),l=e.const("tag",(0,Pm._)`${r}${(0,Pm.getProperty)(a)}`);e.if((0,Pm._)`typeof ${l} == "string"`,()=>c(),()=>t.error(!1,{discrError:LP.DiscrError.Tag,tag:l,tagName:a})),t.ok(u);function c(){const f=h();e.if(!1);for(const p in f)e.elseIf((0,Pm._)`${l} === ${p}`),e.assign(u,d(f[p]));e.else(),t.error(!1,{discrError:LP.DiscrError.Mapping,tag:l,tagName:a}),e.endIf()}function d(f){const p=e.name("valid"),m=t.subschema({keyword:"oneOf",schemaProp:f},p);return t.mergeEvaluated(m,Pm.Name),p}function h(){var f;const p={},m=A(s);let E=!0;for(let v=0;v<o.length;v++){let S=o[v];S!=null&&S.$ref&&!(0,yTe.schemaHasRulesButRef)(S,i.self.RULES)&&(S=XM.resolveRef.call(i.self,i.schemaEnv.root,i.baseId,S==null?void 0:S.$ref),S instanceof XM.SchemaEnv&&(S=S.schema));const x=(f=S==null?void 0:S.properties)===null||f===void 0?void 0:f[a];if(typeof x!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);E=E&&(m||A(S)),_(x,v)}if(!E)throw new Error(`discriminator: "${a}" must be required`);return p;function A({required:v}){return Array.isArray(v)&&v.includes(a)}function _(v,S){if(v.const)g(v.const,S);else if(v.enum)for(const x of v.enum)g(x,S);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function g(v,S){if(typeof v!="string"||v in p)throw new Error(`discriminator: "${a}" values must be unique strings`);p[v]=S}}}};L$.default=vTe;const wTe="http://json-schema.org/draft-07/schema#",_Te="http://json-schema.org/draft-07/schema#",bTe="Core schema meta-schema",ETe={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},ATe=["object","boolean"],STe={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},TTe={$schema:wTe,$id:_Te,title:bTe,definitions:ETe,type:ATe,properties:STe,default:!0};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.MissingRefError=e.ValidationError=e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;const r=Iq,n=d$,s=L$,i=TTe,o=["/properties"],a="http://json-schema.org/draft-07/schema";class u extends r.default{_addVocabularies(){super._addVocabularies(),n.default.forEach(p=>this.addVocabulary(p)),this.opts.discriminator&&this.addKeyword(s.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const p=this.opts.$data?this.$dataMetaSchema(i,o):i;this.addMetaSchema(p,a,!1),this.refs["http://json-schema.org/schema"]=a}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(a)?a:void 0)}}t.exports=e=u,Object.defineProperty(e,"__esModule",{value:!0}),e.default=u;var l=Ua;Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return l.KeywordCxt}});var c=rr;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return c._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return c.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return c.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return c.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return c.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return c.CodeGen}});var d=e_;Object.defineProperty(e,"ValidationError",{enumerable:!0,get:function(){return d.default}});var h=t_;Object.defineProperty(e,"MissingRefError",{enumerable:!0,get:function(){return h.default}})})(BP,BP.exports);var DTe=BP.exports;const xTe=nc(DTe);class qo extends Ju{constructor(r,n,s,i){super(r,n,s);Se(this,"validNext",new Set(["quote","close"]));Se(this,"kind","rfq");Se(this,"metadata");Se(this,"data");Se(this,"privateData");this.metadata=r,this.data=n,this.privateData=i}static async parse(r,n){const s=da.rawToMessageModel(r),i=new qo(s.metadata,s.data,s.signature,s.privateData);return await i.verify(),n!=null&&n.requireAllPrivateData?i.verifyAllPrivateData():i.verifyPresentPrivateData(),i}validate(){super.validate(),this.privateData!==void 0&&zv(this.privateData,"rfqPrivate")}static create(r){const n=Ju.generateId("rfq"),s={...r.metadata,kind:"rfq",id:n,exchangeId:n,createdAt:new Date().toISOString(),protocol:r.metadata.protocol??"1.0"},{data:i,privateData:o}=qo.hashPrivateData(r.data),a=new qo(s,i,void 0,o);return a.validateData(),a}static hashPrivateData(r){const n=Aa.uint8Array(mce(16)).toBase64Url(),{claims:s,payin:i,payout:o,...a}=r,{paymentDetails:u,...l}=i,{paymentDetails:c,...d}=o,h={...a,payin:l,payout:d};return u!==void 0&&(h.payin.paymentDetailsHash=qo.digestPrivateData(n,u)),c!==void 0&&(h.payout.paymentDetailsHash=qo.digestPrivateData(n,c)),s!==void 0&&(s==null?void 0:s.length)>0&&(h.claimsHash=qo.digestPrivateData(n,s)),{data:h,privateData:{salt:n,payin:{paymentDetails:u},payout:{paymentDetails:c},claims:s}}}verifyAllPrivateData(){if(this.privateData===void 0)throw new Error("Could not verify all privateData because privateData property is missing");this.data.payin.paymentDetailsHash!==void 0&&this.verifyPayinDetailsHash(),this.data.payout.paymentDetailsHash!==void 0&&this.verifyPayoutDetailsHash(),this.data.claimsHash!==void 0&&this.verifyClaimsHash()}verifyPresentPrivateData(){var r,n,s,i,o;this.data.payin.paymentDetailsHash!==void 0&&((n=(r=this.privateData)==null?void 0:r.payin)==null?void 0:n.paymentDetails)!==void 0&&this.verifyPayinDetailsHash(),this.data.payout.paymentDetailsHash!==void 0&&((i=(s=this.privateData)==null?void 0:s.payout)==null?void 0:i.paymentDetails)!==void 0&&this.verifyPayoutDetailsHash(),this.data.claimsHash!==void 0&&((o=this.privateData)==null?void 0:o.claims)!==void 0&&this.verifyClaimsHash()}verifyPayinDetailsHash(){var n,s;if(qo.digestPrivateData(this.privateData.salt,(s=(n=this.privateData)==null?void 0:n.payin)==null?void 0:s.paymentDetails)!==this.data.payin.paymentDetailsHash)throw new Error("Private data integrity check failed: data.payin.paymentDetailsHash does not match digest of privateData.payin.paymentDetails")}verifyPayoutDetailsHash(){var n,s;if(qo.digestPrivateData(this.privateData.salt,(s=(n=this.privateData)==null?void 0:n.payout)==null?void 0:s.paymentDetails)!==this.data.payout.paymentDetailsHash)throw new Error("Private data integrity check failed: data.payout.paymentDetailsHash does not match digest of privateData.payout.paymentDetails")}verifyClaimsHash(){var i;const r=this.data.claimsHash,n=(i=this.privateData)==null?void 0:i.claims;if(qo.digestPrivateData(this.privateData.salt,n)!==r)throw new Error("Private data integrity check failed: data.claimsHash does not match digest of privateData.claims")}static digestPrivateData(r,n){const s=[r,n],i=np.digest(s);return Aa.uint8Array(i).toBase64Url()}async verifyOfferingRequirements(r){var s,i,o,a;if(r.metadata.protocol!==this.metadata.protocol)throw new Error(`protocol version mismatch. (rfq) ${this.metadata.protocol} !== ${r.metadata.protocol} (offering)`);if(r.metadata.id!==this.data.offeringId)throw new Error(`offering id mismatch. (rfq) ${this.data.offeringId} !== ${r.metadata.id} (offering)`);let n;if(r.data.payin.max){n=yb(this.data.payin.amount);const u=yb(r.data.payin.max);if(n.isGreaterThan(u))throw new Error(`rfq payinAmount exceeds offering's maxAmount. (rfq) ${this.data.payin.amount} > ${r.data.payin.max} (offering)`)}if(r.data.payin.min){n??(n=yb(this.data.payin.amount));const u=yb(r.data.payin.min);if(n.isLessThan(u))throw new Error(`rfq payinAmount is below offering's minAmount. (rfq) ${this.data.payin.amount} > ${r.data.payin.min} (offering)`)}this.verifyPaymentMethod(this.data.payin.kind,this.data.payin.paymentDetailsHash,(i=(s=this.privateData)==null?void 0:s.payin)==null?void 0:i.paymentDetails,r.data.payin.methods,"payin"),this.verifyPaymentMethod(this.data.payout.kind,this.data.payout.paymentDetailsHash,(a=(o=this.privateData)==null?void 0:o.payout)==null?void 0:a.paymentDetails,r.data.payout.methods,"payout"),await this.verifyClaims(r)}verifyPaymentMethod(r,n,s,i,o){const a=i.filter(c=>c.kind===r);if(!a.length){const c=i.map(d=>d.kind).join(", ");throw new Error(`offering does not support rfq's ${o}Method kind. (rfq) ${r} was not found in: [${c}] (offering)`)}const u=new xTe.default,l=new Set;for(const c of a)if(c.requiredPaymentDetails){const d=u.compile(c.requiredPaymentDetails);if(d(s))return;l.add(d.errors)}else{if(n===void 0)return;l.add(new Error("paymentDetails must be omitted when requiredPaymentDetails is omitted"))}throw new Error(`rfq ${o}Method paymentDetails could not be validated against offering requiredPaymentDetails. Schema validation errors: ${Array.from(l).join()}`)}async verifyClaims(r){var s;if(!r.data.requiredClaims)return;const n=GE.selectCredentials({vcJwts:((s=this.privateData)==null?void 0:s.claims)??[],presentationDefinition:r.data.requiredClaims});if(n.length===0)throw new Error("claims do not fulfill the offering's requirements");for(let i of n)await ZE.verify({vcJwt:i})}toJSON(){const r=super.toJSON();return this.privateData!==void 0&&(r.privateData=this.privateData),r}}class iA extends Ju{constructor(r,n,s){super(r,n,s);Se(this,"validNext",new Set(["order","close"]));Se(this,"kind","quote");Se(this,"metadata");Se(this,"data");this.metadata=r,this.data=n}static async parse(r){const n=da.rawToMessageModel(r),s=new iA(n.metadata,n.data,n.signature);return await s.verify(),s}static create(r){const n={...r.metadata,kind:"quote",id:Ju.generateId("quote"),createdAt:new Date().toISOString(),protocol:r.metadata.protocol??"1.0"},s=new iA(n,r.data);return s.validateData(),s}}class cw extends Ju{constructor(r,n,s){super(r,n,s);Se(this,"validNext",new Set(["orderstatus"]));Se(this,"kind","order");Se(this,"metadata");Se(this,"data");this.metadata=r,this.data=n}static async parse(r){const n=da.rawToMessageModel(r),s=new cw(n.metadata,n.data,n.signature);return await s.verify(),s}static create(r){const n={...r.metadata,kind:"order",id:Ju.generateId("order"),createdAt:new Date().toISOString(),protocol:r.metadata.protocol??"1.0"},s=new cw(n,{});return s.validateData(),s}}class sA extends Ju{constructor(r,n,s){super(r,n,s);Se(this,"validNext",new Set(["orderstatus","close"]));Se(this,"kind","orderstatus");Se(this,"metadata");Se(this,"data");this.metadata=r,this.data=n}static async parse(r){const n=da.rawToMessageModel(r),s=new sA(n.metadata,n.data,n.signature);return await s.verify(),s}static create(r){const n={...r.metadata,kind:"orderstatus",id:Ju.generateId("orderstatus"),createdAt:new Date().toISOString(),protocol:r.metadata.protocol??"1.0"},s=new sA(n,r.data);return s.validateData(),s}get orderStatus(){return this.data.orderStatus}}class Cy extends Ju{constructor(r,n,s){super(r,n,s);Se(this,"validNext",new Set([]));Se(this,"kind","close");Se(this,"metadata");Se(this,"data");this.metadata=r,this.data=n}static async parse(r){const n=da.rawToMessageModel(r),s=new Cy(n.metadata,n.data,n.signature);return await s.verify(),s}static create(r){const n={...r.metadata,kind:"close",id:Ju.generateId("close"),createdAt:new Date().toISOString(),protocol:r.metadata.protocol??"1.0"},s=new Cy(n,r.data);return s.validateData(),s}get reason(){return this.data.reason}}class da{constructor(){}static async parseMessage(e){const r=da.rawToMessageModel(e);let n;switch(r.metadata.kind){case"rfq":n=new qo(r.metadata,r.data,r.signature,r.privateData);break;case"quote":n=new iA(r.metadata,r.data,r.signature);break;case"order":n=new cw(r.metadata,r.data,r.signature);break;case"orderstatus":n=new sA(r.metadata,r.data,r.signature);break;case"close":n=new Cy(r.metadata,r.data,r.signature);break;default:throw new Error(`Unrecognized message kind (${r.metadata.kind})`)}return await n.verify(),n}static async parseResource(e){const r=da.rawToResourceModel(e);let n;switch(r.metadata.kind){case"offering":n=new lw(r.metadata,r.data,r.signature);break;case"balance":n=new oA(r.metadata,r.data,r.signature);break;default:throw new Error(`Unrecognized resource kind (${r.metadata.kind})`)}return await n.verify(),n}static rawToMessageModel(e){try{return typeof e=="string"?JSON.parse(e):e}catch(r){const n=r instanceof Error?r.message:r;throw new Error(`parse: Failed to parse message. Error: ${n}`)}}static rawToResourceModel(e){try{return typeof e=="string"?JSON.parse(e):e}catch(r){const n=r instanceof Error?r.message:r;throw new Error(`parse: Failed to parse resource. Error: ${n}`)}}}class lw extends kE{constructor(r,n,s){super(r,n,s);Se(this,"kind","offering");Se(this,"metadata");Se(this,"data");this.metadata=r,this.data=n}static async parse(r){const n=da.rawToResourceModel(r),s=new lw(n.metadata,n.data,n.signature);return await s.verify(),s}static create(r){const n={...r.metadata,kind:"offering",id:kE.generateId("offering"),createdAt:new Date().toISOString(),protocol:r.metadata.protocol??"1.0"},s=new lw(n,r.data);return s.validateData(),s}}class oA extends kE{constructor(r,n,s){super(r,n,s);Se(this,"kind","balance");Se(this,"metadata");Se(this,"data");this.metadata=r,this.data=n}static async parse(r){const n=da.rawToResourceModel(r),s=new oA(n.metadata,n.data,n.signature);return await s.verify(),s}static create(r){const n={...r.metadata,kind:"balance",id:kE.generateId("balance"),createdAt:new Date().toISOString(),protocol:r.metadata.protocol??"1.0"},s=new oA(n,r.data);return s.validateData(),s}}class f0 extends Error{constructor(r){super(r.message,{cause:r.cause});Se(this,"recipientDid");Se(this,"url");this.name=this.constructor.name,this.recipientDid=r.recipientDid,this.url=r.url}}class h0 extends Error{constructor(r){super();Se(this,"statusCode");Se(this,"details");Se(this,"recipientDid");Se(this,"url");this.name=this.constructor.name,this.statusCode=r.statusCode,this.details=r.details,this.recipientDid=r.recipientDid,this.url=r.url}}class uH extends Error{constructor(e){super(e),this.name=this.constructor.name}}class PTe extends uH{}class CTe extends uH{}class r_ extends Error{constructor(e){super(e.message,{cause:e.cause}),this.name=this.constructor.name}}class ITe extends r_{}class kTe extends r_{}class $Te extends r_{}class OTe extends r_{}class RTe extends r_{}var YM;(function(t){t.authentication="authentication",t.assertionMethod="assertionMethod",t.keyAgreement="keyAgreement",t.capabilityInvocation="capabilityInvocation",t.capabilityDelegation="capabilityDelegation"})(YM||(YM={}));var ZM;(function(t){t.InvalidDid="invalidDid",t.MethodNotSupported="methodNotSupported",t.InternalError="internalError",t.InvalidDidDocument="invalidDidDocument",t.InvalidDidDocumentLength="invalidDidDocumentLength",t.InvalidDidUrl="invalidDidUrl",t.InvalidPreviousDidProof="invalidPreviousDidProof",t.InvalidPublicKey="invalidPublicKey",t.InvalidPublicKeyLength="invalidPublicKeyLength",t.InvalidPublicKeyType="invalidPublicKeyType",t.InvalidSignature="invalidSignature",t.NotFound="notFound",t.RepresentationNotSupported="representationNotSupported",t.UnsupportedPublicKeyType="unsupportedPublicKeyType"})(ZM||(ZM={}));function NTe(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,u=t.charAt(0),l=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var m=0,E=0,A=0,_=p.length;A!==_&&p[A]===0;)A++,m++;for(var g=(_-A)*c+1>>>0,v=new Uint8Array(g);A!==_;){for(var S=p[A],x=0,D=g-1;(S!==0||x<E)&&D!==-1;D--,x++)S+=256*v[D]>>>0,v[D]=S%a>>>0,S=S/a>>>0;if(S!==0)throw new Error("Non-zero carry");E=x,A++}for(var w=g-E;w!==g&&v[w]===0;)w++;for(var b=u.repeat(m);w<g;++w)b+=t.charAt(v[w]);return b}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var m=0;if(p[m]!==" "){for(var E=0,A=0;p[m]===u;)E++,m++;for(var _=(p.length-m)*l+1>>>0,g=new Uint8Array(_);p[m];){var v=r[p.charCodeAt(m)];if(v===255)return;for(var S=0,x=_-1;(v!==0||S<A)&&x!==-1;x--,S++)v+=a*g[x]>>>0,g[x]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");A=S,m++}if(p[m]!==" "){for(var D=_-A;D!==_&&g[D]===0;)D++;for(var w=new Uint8Array(E+(_-D)),b=E;D!==_;)w[b++]=g[D++];return w}}}function f(p){var m=h(p);if(m)return m;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var BTe=NTe,FTe=BTe;const MTe=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};let jTe=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},UTe=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return cH(this,e)}},LTe=class{constructor(e){this.decoders=e}or(e){return cH(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const cH=(t,e)=>new LTe({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let KTe=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new jTe(e,r,n),this.decoder=new UTe(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const lH=({name:t,prefix:e,encode:r,decode:n})=>new KTe(t,e,r,n),dH=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:s}=FTe(r,e);return lH({prefix:t,name:e,encode:n,decode:i=>MTe(s(i))})},VTe=(t,e,r,n)=>{const s={};for(let c=0;c<e.length;++c)s[e[c]]=c;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,u=0,l=0;for(let c=0;c<i;++c){const d=s[t[c]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);u=u<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&u>>a)}if(a>=r||255&u<<8-a)throw new SyntaxError("Unexpected end of data");return o},qTe=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let u=0;u<t.length;++u)for(a=a<<8|t[u],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},Eo=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>lH({prefix:e,name:t,encode(s){return qTe(s,n,r)},decode(s){return VTe(s,n,r,t)}});Eo({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});Eo({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});Eo({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});Eo({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});Eo({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});Eo({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});Eo({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});Eo({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});Eo({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});dH({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});dH({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});Eo({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});Eo({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});Eo({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});Eo({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});new TextEncoder;new TextDecoder;var HTe=fH,QM=128,zTe=127,WTe=~zTe,GTe=Math.pow(2,31);function fH(t,e,r){e=e||[],r=r||0;for(var n=r;t>=GTe;)e[r++]=t&255|QM,t/=128;for(;t&WTe;)e[r++]=t&255|QM,t>>>=7;return e[r]=t|0,fH.bytes=r-n+1,e}var JTe=KP,XTe=128,e8=127;function KP(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw KP.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&e8)<<s:(o&e8)*Math.pow(2,s),s+=7}while(o>=XTe);return KP.bytes=i-n,r}var YTe=Math.pow(2,7),ZTe=Math.pow(2,14),QTe=Math.pow(2,21),eDe=Math.pow(2,28),tDe=Math.pow(2,35),rDe=Math.pow(2,42),nDe=Math.pow(2,49),iDe=Math.pow(2,56),sDe=Math.pow(2,63),oDe=function(t){return t<YTe?1:t<ZTe?2:t<QTe?3:t<eDe?4:t<tDe?5:t<rDe?6:t<nDe?7:t<iDe?8:t<sDe?9:10},aDe={encode:HTe,decode:JTe,encodingLength:oDe},aA=aDe;const t8=(t,e=0)=>[aA.decode(t,e),aA.decode.bytes],uDe=(t,e,r=0)=>(aA.encode(t,e,r),e),cDe=t=>aA.encodingLength(t);let Rf=class Dd{static addPrefix(e){var r;let{code:n,data:s,name:i}=e;if(!(i?!n:n))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(n=Dd.codeToName.has(n)?n:Dd.nameToCode.get(i),n===void 0)throw new Error(`Unsupported multicodec: ${(r=e.name)!==null&&r!==void 0?r:e.code}`);const o=cDe(n),a=new Uint8Array(o+s.byteLength);return a.set(s,o),uDe(n,a),a}static getCodeFromData(e){const{prefixedData:r}=e,[n,s]=t8(r);return n}static getCodeFromName(e){const{name:r}=e,n=Dd.nameToCode.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static getNameFromCode(e){const{code:r}=e,n=Dd.codeToName.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static registerCodec(e){Dd.codeToName.set(e.code,e.name),Dd.nameToCode.set(e.name,e.code)}static removePrefix(e){const{prefixedData:r}=e,[n,s]=t8(r),i=Dd.codeToName.get(n);if(i===void 0)throw new Error(`Unsupported multicodec: ${n}`);return{code:n,data:r.slice(s),name:i}}};Rf.codeToName=new Map;Rf.nameToCode=new Map;Rf.registerCodec({code:237,name:"ed25519-pub"});Rf.registerCodec({code:4864,name:"ed25519-priv"});Rf.registerCodec({code:236,name:"x25519-pub"});Rf.registerCodec({code:4866,name:"x25519-priv"});Rf.registerCodec({code:231,name:"secp256k1-pub"});Rf.registerCodec({code:4865,name:"secp256k1-priv"});function lDe({didDocument:t,id:e,type:r}){var n,s;return(s=(n=t==null?void 0:t.service)===null||n===void 0?void 0:n.filter(i=>!(e&&i.id!==e||r&&i.type!==r)))!==null&&s!==void 0?s:[]}var r8;(function(t){t[t.Discoverable=0]="Discoverable",t[t.Organization=1]="Organization",t[t.Government=2]="Government",t[t.Corporation=3]="Corporation",t[t.LocalBusiness=4]="LocalBusiness",t[t.SoftwarePackage=5]="SoftwarePackage",t[t.WebApp=6]="WebApp",t[t.FinancialInstitution=7]="FinancialInstitution"})(r8||(r8={}));var oo;(function(t){t[t.Ed25519=0]="Ed25519",t[t.secp256k1=1]="secp256k1",t[t.secp256r1=2]="secp256r1",t[t.X25519=3]="X25519"})(oo||(oo={}));var n8;(function(t){t.authentication="auth",t.assertionMethod="asm",t.capabilityDelegation="del",t.capabilityInvocation="inv",t.keyAgreement="agm"})(n8||(n8={}));oo.Ed25519,oo.secp256k1,oo.secp256r1,oo.secp256r1,oo.secp256k1,oo.secp256r1,oo.X25519;oo.Ed25519+"",oo.secp256k1+"",oo.secp256r1+"",oo.X25519+"";var Rd;(function(t){t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.secp256r1="secp256r1",t.X25519="X25519"})(Rd||(Rd={}));Rd.Ed25519,Rd.secp256k1,Rd.secp256r1,Rd.secp256r1,Rd.secp256k1,Rd.secp256r1;var jc;(function(t){t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.secp256r1="secp256r1",t.X25519="X25519"})(jc||(jc={}));jc.Ed25519,jc.secp256k1,jc.secp256r1,jc.secp256r1,jc.secp256k1,jc.secp256r1,jc.X25519;const hH="%[a-f0-9]{2}",i8=new RegExp("("+hH+")|([^%]+?)","gi"),s8=new RegExp("("+hH+")+","gi");function VP(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;const r=t.slice(0,e),n=t.slice(e);return Array.prototype.concat.call([],VP(r),VP(n))}function dDe(t){try{return decodeURIComponent(t)}catch{let e=t.match(i8)||[];for(let r=1;r<e.length;r++)t=VP(e,r).join(""),e=t.match(i8)||[];return t}}function fDe(t){const e={"%FE%FF":"��","%FF%FE":"��"};let r=s8.exec(t);for(;r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{const s=dDe(r[0]);s!==r[0]&&(e[r[0]]=s)}r=s8.exec(t)}e["%C2"]="�";const n=Object.keys(e);for(const s of n)t=t.replace(new RegExp(s,"g"),e[s]);return t}function hDe(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return decodeURIComponent(t)}catch{return fDe(t)}}function pH(t,e){if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t===""||e==="")return[];const r=t.indexOf(e);return r===-1?[]:[t.slice(0,r),t.slice(r+e.length)]}function pDe(t,e){const r={};if(Array.isArray(e))for(const n of e){const s=Object.getOwnPropertyDescriptor(t,n);s!=null&&s.enumerable&&Object.defineProperty(r,n,s)}else for(const n of Reflect.ownKeys(t)){const s=Object.getOwnPropertyDescriptor(t,n);if(s.enumerable){const i=t[n];e(n,i,t)&&Object.defineProperty(r,n,s)}}return r}const mDe=t=>t==null,yDe=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),qP=Symbol("encodeFragmentIdentifier");function gDe(t){switch(t.arrayFormat){case"index":return e=>(r,n)=>{const s=r.length;return n===void 0||t.skipNull&&n===null||t.skipEmptyString&&n===""?r:n===null?[...r,[In(e,t),"[",s,"]"].join("")]:[...r,[In(e,t),"[",In(s,t),"]=",In(n,t)].join("")]};case"bracket":return e=>(r,n)=>n===void 0||t.skipNull&&n===null||t.skipEmptyString&&n===""?r:n===null?[...r,[In(e,t),"[]"].join("")]:[...r,[In(e,t),"[]=",In(n,t)].join("")];case"colon-list-separator":return e=>(r,n)=>n===void 0||t.skipNull&&n===null||t.skipEmptyString&&n===""?r:n===null?[...r,[In(e,t),":list="].join("")]:[...r,[In(e,t),":list=",In(n,t)].join("")];case"comma":case"separator":case"bracket-separator":{const e=t.arrayFormat==="bracket-separator"?"[]=":"=";return r=>(n,s)=>s===void 0||t.skipNull&&s===null||t.skipEmptyString&&s===""?n:(s=s===null?"":s,n.length===0?[[In(r,t),e,In(s,t)].join("")]:[[n,In(s,t)].join(t.arrayFormatSeparator)])}default:return e=>(r,n)=>n===void 0||t.skipNull&&n===null||t.skipEmptyString&&n===""?r:n===null?[...r,In(e,t)]:[...r,[In(e,t),"=",In(n,t)].join("")]}}function vDe(t){let e;switch(t.arrayFormat){case"index":return(r,n,s)=>{if(e=/\[(\d*)]$/.exec(r),r=r.replace(/\[\d*]$/,""),!e){s[r]=n;return}s[r]===void 0&&(s[r]={}),s[r][e[1]]=n};case"bracket":return(r,n,s)=>{if(e=/(\[])$/.exec(r),r=r.replace(/\[]$/,""),!e){s[r]=n;return}if(s[r]===void 0){s[r]=[n];return}s[r]=[...s[r],n]};case"colon-list-separator":return(r,n,s)=>{if(e=/(:list)$/.exec(r),r=r.replace(/:list$/,""),!e){s[r]=n;return}if(s[r]===void 0){s[r]=[n];return}s[r]=[...s[r],n]};case"comma":case"separator":return(r,n,s)=>{const i=typeof n=="string"&&n.includes(t.arrayFormatSeparator),o=typeof n=="string"&&!i&&Gc(n,t).includes(t.arrayFormatSeparator);n=o?Gc(n,t):n;const a=i||o?n.split(t.arrayFormatSeparator).map(u=>Gc(u,t)):n===null?n:Gc(n,t);s[r]=a};case"bracket-separator":return(r,n,s)=>{const i=/(\[])$/.test(r);if(r=r.replace(/\[]$/,""),!i){s[r]=n&&Gc(n,t);return}const o=n===null?[]:n.split(t.arrayFormatSeparator).map(a=>Gc(a,t));if(s[r]===void 0){s[r]=o;return}s[r]=[...s[r],...o]};default:return(r,n,s)=>{if(s[r]===void 0){s[r]=n;return}s[r]=[...[s[r]].flat(),n]}}}function mH(t){if(typeof t!="string"||t.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function In(t,e){return e.encode?e.strict?yDe(t):encodeURIComponent(t):t}function Gc(t,e){return e.decode?hDe(t):t}function yH(t){return Array.isArray(t)?t.sort():typeof t=="object"?yH(Object.keys(t)).sort((e,r)=>Number(e)-Number(r)).map(e=>t[e]):t}function gH(t){const e=t.indexOf("#");return e!==-1&&(t=t.slice(0,e)),t}function wDe(t){let e="";const r=t.indexOf("#");return r!==-1&&(e=t.slice(r)),e}function o8(t,e){return e.parseNumbers&&!Number.isNaN(Number(t))&&typeof t=="string"&&t.trim()!==""?t=Number(t):e.parseBooleans&&t!==null&&(t.toLowerCase()==="true"||t.toLowerCase()==="false")&&(t=t.toLowerCase()==="true"),t}function K$(t){t=gH(t);const e=t.indexOf("?");return e===-1?"":t.slice(e+1)}function V$(t,e){e={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,...e},mH(e.arrayFormatSeparator);const r=vDe(e),n=Object.create(null);if(typeof t!="string"||(t=t.trim().replace(/^[?#&]/,""),!t))return n;for(const s of t.split("&")){if(s==="")continue;const i=e.decode?s.replace(/\+/g," "):s;let[o,a]=pH(i,"=");o===void 0&&(o=i),a=a===void 0?null:["comma","separator","bracket-separator"].includes(e.arrayFormat)?a:Gc(a,e),r(Gc(o,e),a,n)}for(const[s,i]of Object.entries(n))if(typeof i=="object"&&i!==null)for(const[o,a]of Object.entries(i))i[o]=o8(a,e);else n[s]=o8(i,e);return e.sort===!1?n:(e.sort===!0?Object.keys(n).sort():Object.keys(n).sort(e.sort)).reduce((s,i)=>{const o=n[i];return s[i]=o&&typeof o=="object"&&!Array.isArray(o)?yH(o):o,s},Object.create(null))}function vH(t,e){if(!t)return"";e={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...e},mH(e.arrayFormatSeparator);const r=o=>e.skipNull&&mDe(t[o])||e.skipEmptyString&&t[o]==="",n=gDe(e),s={};for(const[o,a]of Object.entries(t))r(o)||(s[o]=a);const i=Object.keys(s);return e.sort!==!1&&i.sort(e.sort),i.map(o=>{const a=t[o];return a===void 0?"":a===null?In(o,e):Array.isArray(a)?a.length===0&&e.arrayFormat==="bracket-separator"?In(o,e)+"[]":a.reduce(n(o),[]).join("&"):In(o,e)+"="+In(a,e)}).filter(o=>o.length>0).join("&")}function wH(t,e){var s;e={decode:!0,...e};let[r,n]=pH(t,"#");return r===void 0&&(r=t),{url:((s=r==null?void 0:r.split("?"))==null?void 0:s[0])??"",query:V$(K$(t),e),...e&&e.parseFragmentIdentifier&&n?{fragmentIdentifier:Gc(n,e)}:{}}}function _H(t,e){e={encode:!0,strict:!0,[qP]:!0,...e};const r=gH(t.url).split("?")[0]||"",n=K$(t.url),s={...V$(n,{sort:!1}),...t.query};let i=vH(s,e);i&&(i=`?${i}`);let o=wDe(t.url);if(t.fragmentIdentifier){const a=new URL(r);a.hash=t.fragmentIdentifier,o=e[qP]?a.hash:`#${t.fragmentIdentifier}`}return`${r}${i}${o}`}function bH(t,e,r){r={parseFragmentIdentifier:!0,[qP]:!1,...r};const{url:n,query:s,fragmentIdentifier:i}=wH(t,r);return _H({url:n,query:pDe(s,e),fragmentIdentifier:i},r)}function _De(t,e,r){const n=Array.isArray(e)?s=>!e.includes(s):(s,i)=>!e(s,i);return bH(t,n,r)}const bDe=Object.freeze(Object.defineProperty({__proto__:null,exclude:_De,extract:K$,parse:V$,parseUrl:wH,pick:bH,stringify:vH,stringifyUrl:_H},Symbol.toStringTag,{value:"Module"})),a8=["aud","iss","exp","iat","jti"];class Pi{static async createExchange(e,r){await e.verify();const{to:n}=e.metadata,s=JSON.stringify({rfq:e,replyTo:r==null?void 0:r.replyTo});await Pi.sendMessage(n,"POST","/exchanges",s)}static async submitOrder(e){await e.verify();const{to:r,exchangeId:n}=e.metadata,s=JSON.stringify(e);await Pi.sendMessage(r,"PUT",`/exchanges/${n}`,s)}static async submitClose(e){await e.verify();const{to:r,exchangeId:n}=e.metadata,s=JSON.stringify(e);await Pi.sendMessage(r,"PUT",`/exchanges/${n}`,s)}static async sendMessage(e,r,n,s){const o=`${await Pi.getPfiServiceEndpoint(e)}${n}`;let a;try{a=await fetch(o,{method:r,headers:{"content-type":"application/json"},body:s})}catch(u){throw new f0({message:`Failed to send message to ${e}`,recipientDid:e,url:o,cause:u})}if(!a.ok){const u=await a.json();throw new h0({statusCode:a.status,details:u,recipientDid:e,url:o})}}static async getOfferings(e){const{pfiDid:r}=e,s=`${await Pi.getPfiServiceEndpoint(r)}/offerings`;let i;try{i=await fetch(s)}catch(l){throw new f0({message:`Failed to get offerings from ${r}`,recipientDid:r,url:s,cause:l})}const o=[];if(!i.ok){const l=await i.json();throw new h0({statusCode:i.status,details:l,recipientDid:r,url:s})}const u=(await i.json()).data;for(let l of u){const c=await lw.parse(l);o.push(c)}return o}static async getBalances(e){const{pfiDid:r,did:n}=e,i=`${await Pi.getPfiServiceEndpoint(r)}/balances`,o=await Pi.generateRequestToken({requesterDid:n,pfiDid:r});let a;try{a=await fetch(i,{headers:{authorization:`Bearer ${o}`}})}catch(c){throw new f0({message:`Failed to get balances from ${r}`,recipientDid:r,url:i,cause:c})}if(!a.ok){const c=await a.json();throw new h0({statusCode:a.status,details:c,recipientDid:r,url:i})}return(await a.json()).data}static async getExchange(e){const{pfiDid:r,exchangeId:n,did:s}=e,o=`${await Pi.getPfiServiceEndpoint(r)}/exchanges/${n}`,a=await Pi.generateRequestToken({requesterDid:s,pfiDid:r});let u;try{u=await fetch(o,{headers:{authorization:`Bearer ${a}`}})}catch(d){throw new f0({message:`Failed to get exchange from ${r}`,recipientDid:r,url:o,cause:d})}const l=[];if(!u.ok){const d=await u.json();throw new h0({statusCode:u.status,details:d,recipientDid:r,url:o})}const c=await u.json();for(let d of c.data){const h=await da.parseMessage(d);l.push(h)}return l}static async getExchanges(e){const{pfiDid:r,filter:n,did:s}=e,i=await Pi.getPfiServiceEndpoint(r),o=n?`?${bDe.stringify(n)}`:"",a=`${i}/exchanges${o}`,u=await Pi.generateRequestToken({requesterDid:s,pfiDid:r});let l;try{l=await fetch(a,{headers:{authorization:`Bearer ${u}`}})}catch(h){throw new f0({message:`Failed to get exchanges from ${r}`,recipientDid:r,url:a,cause:h})}const c=[];if(!l.ok){const h=await l.json();throw new h0({statusCode:l.status,details:h,recipientDid:r,url:a})}const d=await l.json();for(let h of d.data){const f=[];for(let p of h){const m=await da.parseMessage(p);f.push(m)}c.push(f)}return c}static async getPfiServiceEndpoint(e){let r;try{r=await Kde(e)}catch(s){throw new PTe(s.message)}const[n]=lDe({didDocument:r,type:"PFI"});if(!(n!=null&&n.serviceEndpoint))throw new CTe(`${e} has no PFI service entry`);return n.serviceEndpoint}static async generateRequestToken(e){const{pfiDid:r,requesterDid:n}=e,s=Date.now(),i=s+jde("1m"),o={aud:r,iss:n.uri,exp:Math.floor(i/1e3),iat:Math.floor(s/1e3),jti:GC().getSuffix()};try{return await Uu.sign({signerDid:n,payload:o})}catch(a){throw new ITe({message:a.message,cause:a})}}static async verifyRequestToken(e){let r;try{r=await Uu.verify({jwt:e.requestToken})}catch(a){throw new kTe({message:a.message,cause:a})}const{header:n,payload:s}=r;for(let a of a8)if(!s[a])throw new $Te({message:`Request token missing ${a} claim. Expected ${a8}.`});if(s.aud!==e.pfiDid)throw new OTe({message:"Request token contains invalid audience. Expected aud property to be PFI DID."});const i=n.kid,o=s.iss;if(!i.includes(o))throw new RTe({message:"Request token issuer does not match signer"});return o}}var dw;(function(t){t.authentication="authentication",t.assertionMethod="assertionMethod",t.keyAgreement="keyAgreement",t.capabilityInvocation="capabilityInvocation",t.capabilityDelegation="capabilityDelegation"})(dw||(dw={}));const vs={"@context":"https://w3id.org/did-resolution/v1",didResolutionMetadata:{},didDocument:null,didDocumentMetadata:{}};class Er{constructor({method:e,id:r,path:n,query:s,fragment:i,params:o}){this.uri=`did:${e}:${r}`,this.method=e,this.id=r,this.path=n,this.query=s,this.fragment=i,this.params=o}static parse(e){if(!e)return null;const r=Er.DID_URI_PATTERN.exec(e);if(!r||!r.groups)return null;const{method:n,id:s,path:i,query:o,fragment:a}=r.groups,u={uri:`did:${n}:${s}`,method:n,id:s};if(i&&(u.path=i),o&&(u.query=o.slice(1)),a&&(u.fragment=a.slice(1)),o){const l={},c=o.slice(1).split("&");for(const d of c){const[h,f]=d.split("=");l[h]=f}u.params=l}return u}}Er.METHOD_PATTERN="([a-z0-9]+)";Er.PCT_ENCODED_PATTERN="(?:%[0-9a-fA-F]{2})";Er.ID_CHAR_PATTERN=`(?:[a-zA-Z0-9._-]|${Er.PCT_ENCODED_PATTERN})`;Er.METHOD_ID_PATTERN=`((?:${Er.ID_CHAR_PATTERN}*:)*(${Er.ID_CHAR_PATTERN}+))`;Er.PATH_PATTERN="(/[^#?]*)?";Er.QUERY_PATTERN="([?][^#]*)?";Er.FRAGMENT_PATTERN="(#.*)?";Er.DID_URI_PATTERN=new RegExp(`^did:(?<method>${Er.METHOD_PATTERN}):(?<id>${Er.METHOD_ID_PATTERN})(?<path>${Er.PATH_PATTERN})(?<query>${Er.QUERY_PATTERN})(?<fragment>${Er.FRAGMENT_PATTERN})$`);class at extends Error{constructor(e,r){super(`${e}: ${r}`),this.code=e,this.name="DidError",Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,at)}}var mt;(function(t){t.InvalidDid="invalidDid",t.MethodNotSupported="methodNotSupported",t.InternalError="internalError",t.InvalidDidDocument="invalidDidDocument",t.InvalidDidDocumentLength="invalidDidDocumentLength",t.InvalidDidUrl="invalidDidUrl",t.InvalidPreviousDidProof="invalidPreviousDidProof",t.InvalidPublicKey="invalidPublicKey",t.InvalidPublicKeyLength="invalidPublicKeyLength",t.InvalidPublicKeyType="invalidPublicKeyType",t.InvalidSignature="invalidSignature",t.NotFound="notFound",t.RepresentationNotSupported="representationNotSupported",t.UnsupportedPublicKeyType="unsupportedPublicKeyType"})(mt||(mt={}));function EDe(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,u=t.charAt(0),l=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var m=0,E=0,A=0,_=p.length;A!==_&&p[A]===0;)A++,m++;for(var g=(_-A)*c+1>>>0,v=new Uint8Array(g);A!==_;){for(var S=p[A],x=0,D=g-1;(S!==0||x<E)&&D!==-1;D--,x++)S+=256*v[D]>>>0,v[D]=S%a>>>0,S=S/a>>>0;if(S!==0)throw new Error("Non-zero carry");E=x,A++}for(var w=g-E;w!==g&&v[w]===0;)w++;for(var b=u.repeat(m);w<g;++w)b+=t.charAt(v[w]);return b}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var m=0;if(p[m]!==" "){for(var E=0,A=0;p[m]===u;)E++,m++;for(var _=(p.length-m)*l+1>>>0,g=new Uint8Array(_);p[m];){var v=r[p.charCodeAt(m)];if(v===255)return;for(var S=0,x=_-1;(v!==0||S<A)&&x!==-1;x--,S++)v+=a*g[x]>>>0,g[x]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");A=S,m++}if(p[m]!==" "){for(var D=_-A;D!==_&&g[D]===0;)D++;for(var w=new Uint8Array(E+(_-D)),b=E;D!==_;)w[b++]=g[D++];return w}}}function f(p){var m=h(p);if(m)return m;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var ADe=EDe,SDe=ADe;const TDe=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};class DDe{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class xDe{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return EH(this,e)}}class PDe{constructor(e){this.decoders=e}or(e){return EH(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const EH=(t,e)=>new PDe({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class CDe{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new DDe(e,r,n),this.decoder=new xDe(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const AH=({name:t,prefix:e,encode:r,decode:n})=>new CDe(t,e,r,n),SH=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:s}=SDe(r,e);return AH({prefix:t,name:e,encode:n,decode:i=>TDe(s(i))})},IDe=(t,e,r,n)=>{const s={};for(let c=0;c<e.length;++c)s[e[c]]=c;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,u=0,l=0;for(let c=0;c<i;++c){const d=s[t[c]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);u=u<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&u>>a)}if(a>=r||255&u<<8-a)throw new SyntaxError("Unexpected end of data");return o},kDe=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let u=0;u<t.length;++u)for(a=a<<8|t[u],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},Ao=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>AH({prefix:e,name:t,encode(s){return kDe(s,n,r)},decode(s){return IDe(s,n,r,t)}});Ao({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});Ao({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});Ao({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});Ao({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});Ao({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});Ao({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});Ao({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});Ao({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});const u8=Ao({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Gb=SH({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});SH({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});Ao({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});Ao({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const $c=Ao({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});Ao({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function $De(t){return t.byteOffset!==0||t.byteLength!==t.buffer.byteLength}function ODe(t){return typeof t!="object"||t===null?!1:typeof t[Symbol.asyncIterator]=="function"}function HP(t){const r=Object.prototype.toString.call(t).match(/\s([a-zA-Z0-9]+)/),[n,s]=r;return s}var p0=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},c8=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(o){return new Promise(function(a,u){o=t[i](o),s(a,u,o.done,o.value)})}}function s(i,o,a,u){Promise.resolve(u).then(function(l){i({value:l,done:a})},o)}};const Jb=new TextEncoder,dh=new TextDecoder;class Je{constructor(e,r){this.data=e,this.format=r}static arrayBuffer(e){return new Je(e,"ArrayBuffer")}static asyncIterable(e){if(!ODe(e))throw new TypeError("Input must be of type AsyncIterable.");return new Je(e,"AsyncIterable")}static base32Z(e){return new Je(e,"Base32Z")}static base58Btc(e){return new Je(e,"Base58Btc")}static base64Url(e){return new Je(e,"Base64Url")}static bufferSource(e){return new Je(e,"BufferSource")}static hex(e){if(typeof e!="string")throw new TypeError("Hex input must be a string.");if(e.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new Je(e,"Hex")}static multibase(e){return new Je(e,"Multibase")}static object(e){return new Je(e,"Object")}static string(e){return new Je(e,"String")}static uint8Array(e){return new Je(e,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return Gb.baseDecode(this.data).buffer;case"Base64Url":return $c.baseDecode(this.data).buffer;case"BufferSource":{if(HP(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return $De(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return p0(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return u8.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return Gb.baseEncode(e)}case"Multibase":return this.data.substring(1);case"Uint8Array":return Gb.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return $c.baseEncode(e)}case"BufferSource":{const e=this.toUint8Array();return $c.baseEncode(e)}case"Object":{const e=JSON.stringify(this.data),r=Jb.encode(e);return $c.baseEncode(r)}case"String":{const e=Jb.encode(this.data);return $c.baseEncode(e)}case"Uint8Array":return $c.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){var e,r,n,s;return p0(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const u=[];try{for(var i=!0,o=c8(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const c=s;u.push(c)}}catch(c){r={error:c}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return new Blob(u)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){const e=Array.from({length:256},(r,n)=>n.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{const r=this.toUint8Array();return Je.uint8Array(r).toHex()}case"Base64Url":{const r=this.toUint8Array();return Je.uint8Array(r).toHex()}case"Uint8Array":{let r="";for(let n=0;n<this.data.length;n++)r+=e[this.data[n]];return r}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{const e=$c.baseDecode(this.data),r=dh.decode(e);return JSON.parse(r)}case"String":return JSON.parse(this.data);case"Uint8Array":{const e=dh.decode(this.data);return JSON.parse(e)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return p0(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toStringAsync();return JSON.parse(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return dh.decode(this.data);case"Base64Url":{const e=$c.baseDecode(this.data);return dh.decode(e)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return dh.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){var e,r,n,s;return p0(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let u="";try{for(var i=!0,o=c8(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const l=s;typeof l=="string"?u+=l:u+=dh.decode(l,{stream:!0})}}catch(l){r={error:l}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return u+=dh.decode(void 0,{stream:!1}),u}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return u8.baseDecode(this.data);case"Base58Btc":return Gb.baseDecode(this.data);case"Base64Url":return $c.baseDecode(this.data);case"BufferSource":{const e=HP(this.data);if(e==="Uint8Array")return this.data;if(e==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{const e=new Uint8Array(this.data.length/2);for(let r=0;r<this.data.length;r+=2){const n=parseInt(this.data.substring(r,r+2),16);if(isNaN(n))throw new TypeError("Input is not a valid hexadecimal string.");e[r/2]=n}return e}case"Object":{const e=JSON.stringify(this.data);return Jb.encode(e)}case"String":return Jb.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return p0(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toArrayBufferAsync();return new Uint8Array(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}}var RDe=TH,l8=128,NDe=127,BDe=~NDe,FDe=Math.pow(2,31);function TH(t,e,r){e=e||[],r=r||0;for(var n=r;t>=FDe;)e[r++]=t&255|l8,t/=128;for(;t&BDe;)e[r++]=t&255|l8,t>>>=7;return e[r]=t|0,TH.bytes=r-n+1,e}var MDe=zP,jDe=128,d8=127;function zP(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw zP.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&d8)<<s:(o&d8)*Math.pow(2,s),s+=7}while(o>=jDe);return zP.bytes=i-n,r}var UDe=Math.pow(2,7),LDe=Math.pow(2,14),KDe=Math.pow(2,21),VDe=Math.pow(2,28),qDe=Math.pow(2,35),HDe=Math.pow(2,42),zDe=Math.pow(2,49),WDe=Math.pow(2,56),GDe=Math.pow(2,63),JDe=function(t){return t<UDe?1:t<LDe?2:t<KDe?3:t<VDe?4:t<qDe?5:t<HDe?6:t<zDe?7:t<WDe?8:t<GDe?9:10},XDe={encode:RDe,decode:MDe,encodingLength:JDe},uA=XDe;const f8=(t,e=0)=>[uA.decode(t,e),uA.decode.bytes],YDe=(t,e,r=0)=>(uA.encode(t,e,r),e),ZDe=t=>uA.encodingLength(t);class $n{static addPrefix(e){var r;let{code:n,data:s,name:i}=e;if(!(i?!n:n))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(n=$n.codeToName.has(n)?n:$n.nameToCode.get(i),n===void 0)throw new Error(`Unsupported multicodec: ${(r=e.name)!==null&&r!==void 0?r:e.code}`);const o=ZDe(n),a=new Uint8Array(o+s.byteLength);return a.set(s,o),YDe(n,a),a}static getCodeFromData(e){const{prefixedData:r}=e,[n,s]=f8(r);return n}static getCodeFromName(e){const{name:r}=e,n=$n.nameToCode.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static getNameFromCode(e){const{code:r}=e,n=$n.codeToName.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static registerCodec(e){$n.codeToName.set(e.code,e.name),$n.nameToCode.set(e.name,e.code)}static removePrefix(e){const{prefixedData:r}=e,[n,s]=f8(r),i=$n.codeToName.get(n);if(i===void 0)throw new Error(`Unsupported multicodec: ${n}`);return{code:n,data:r.slice(s),name:i}}}$n.codeToName=new Map;$n.nameToCode=new Map;$n.registerCodec({code:237,name:"ed25519-pub"});$n.registerCodec({code:4864,name:"ed25519-priv"});$n.registerCodec({code:236,name:"x25519-pub"});$n.registerCodec({code:4866,name:"x25519-priv"});$n.registerCodec({code:231,name:"secp256k1-pub"});$n.registerCodec({code:4865,name:"secp256k1-priv"});function DH(t){Object.keys(t).forEach(e=>{t[e]===void 0?delete t[e]:typeof t[e]=="object"&&DH(t[e])})}var fh=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};class QDe{constructor(){this.store=new Map}clear(){return fh(this,void 0,void 0,function*(){this.store.clear()})}close(){return fh(this,void 0,void 0,function*(){})}delete(e){return fh(this,void 0,void 0,function*(){return this.store.delete(e)})}get(e){return fh(this,void 0,void 0,function*(){return this.store.get(e)})}has(e){return fh(this,void 0,void 0,function*(){return this.store.has(e)})}list(){return fh(this,void 0,void 0,function*(){return Array.from(this.store.values())})}set(e,r){return fh(this,void 0,void 0,function*(){this.store.set(e,r)})}}function exe(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function xH(t,...e){if(!exe(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function h8(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function txe(t,e){xH(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const bD=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),su=(t,e)=>t<<32-e|t>>>e;new Uint8Array(new Uint32Array([287454020]).buffer)[0];function rxe(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function PH(t){return typeof t=="string"&&(t=rxe(t)),xH(t),t}class nxe{clone(){return this._cloneInto()}}function ixe(t){const e=n=>t().update(PH(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function sxe(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),u=n?4:0,l=n?0:4;t.setUint32(e+u,o,n),t.setUint32(e+l,a,n)}const oxe=(t,e,r)=>t&e^~t&r,axe=(t,e,r)=>t&e^t&r^e&r;class uxe extends nxe{constructor(e,r,n,s){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=bD(this.buffer)}update(e){h8(this);const{view:r,buffer:n,blockLen:s}=this;e=PH(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const u=bD(e);for(;s<=i-o;o+=s)this.process(u,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){h8(this),txe(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)r[d]=0;sxe(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=bD(e),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=u/4,c=this.get();if(l>c.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,c[d],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%r&&e.buffer.set(n),e}}const cxe=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ud=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),cd=new Uint32Array(64);class lxe extends uxe{constructor(){super(64,32,8,!1),this.A=ud[0]|0,this.B=ud[1]|0,this.C=ud[2]|0,this.D=ud[3]|0,this.E=ud[4]|0,this.F=ud[5]|0,this.G=ud[6]|0,this.H=ud[7]|0}get(){const{A:e,B:r,C:n,D:s,E:i,F:o,G:a,H:u}=this;return[e,r,n,s,i,o,a,u]}set(e,r,n,s,i,o,a,u){this.A=e|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=u|0}process(e,r){for(let d=0;d<16;d++,r+=4)cd[d]=e.getUint32(r,!1);for(let d=16;d<64;d++){const h=cd[d-15],f=cd[d-2],p=su(h,7)^su(h,18)^h>>>3,m=su(f,17)^su(f,19)^f>>>10;cd[d]=m+cd[d-7]+p+cd[d-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:u,G:l,H:c}=this;for(let d=0;d<64;d++){const h=su(a,6)^su(a,11)^su(a,25),f=c+h+oxe(a,u,l)+cxe[d]+cd[d]|0,m=(su(n,2)^su(n,13)^su(n,22))+axe(n,s,i)|0;c=l,l=u,u=a,a=o+f|0,o=i,i=s,s=n,n=f+m|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,u=u+this.F|0,l=l+this.G|0,c=c+this.H|0,this.set(n,s,i,o,a,u,l,c)}roundClean(){cd.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const fw=ixe(()=>new lxe);var dxe=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};class CH{static digest(e){return dxe(this,arguments,void 0,function*({data:r}){return fw(r)})}}class q${}var fxe=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};class hxe extends q${digest(e){return fxe(this,arguments,void 0,function*({algorithm:r,data:n}){switch(r){case"SHA-256":return yield CH.digest({data:n})}})}}function pxe(t){const e=n=>{if(n!==null&&typeof n=="object"&&!Array.isArray(n)){const s=Object.keys(n).sort(),i={};for(const o of s)i[o]=e(n[o]);return i}return n},r=e(t);return JSON.stringify(r)}var mxe=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};const p8="urn:jwk:";function Br(t){return mxe(this,arguments,void 0,function*({jwk:e}){const r=e.kty;let n;if(r==="EC")n={crv:e.crv,kty:e.kty,x:e.x,y:e.y};else if(r==="oct")n={k:e.k,kty:e.kty};else if(r==="OKP")n={crv:e.crv,kty:e.kty,x:e.x};else if(r==="RSA")n={e:e.e,kty:e.kty,n:e.n};else throw new Error(`Unsupported key type: ${r}`);DH(n);const s=pxe(n),i=Je.string(s).toUint8Array(),o=yield CH.digest({data:i});return Je.uint8Array(o).toBase64Url()})}function up(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="EC"||typeof t.d!="string"||typeof t.x!="string")}function H$(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t)||"d"in t||t.kty!=="EC"||typeof t.x!="string")}function cp(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="OKP"||typeof t.d!="string"||typeof t.x!="string")}function z$(t){return!(!t||typeof t!="object"||"d"in t||!("kty"in t&&"crv"in t&&"x"in t)||t.kty!=="OKP"||typeof t.x!="string")}function yxe(t){if(!t||typeof t!="object")return!1;switch(t.kty){case"EC":case"OKP":case"RSA":return"d"in t;case"oct":return"k"in t;default:return!1}}var _i=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},gxe=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};class fn{static adjustSignatureToLowS(e){return _i(this,arguments,void 0,function*({signature:r}){const n=et.Signature.fromCompact(r);return n.hasHighS()?n.normalizeS().toCompactRawBytes():r})}static bytesToPrivateKey(e){return _i(this,arguments,void 0,function*({privateKeyBytes:r}){const n=yield fn.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"secp256k1",d:Je.uint8Array(r).toBase64Url(),x:Je.uint8Array(n.x).toBase64Url(),y:Je.uint8Array(n.y).toBase64Url()};return s.kid=yield Br({jwk:s}),s})}static bytesToPublicKey(e){return _i(this,arguments,void 0,function*({publicKeyBytes:r}){const n=yield fn.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"secp256k1",x:Je.uint8Array(n.x).toBase64Url(),y:Je.uint8Array(n.y).toBase64Url()};return s.kid=yield Br({jwk:s}),s})}static compressPublicKey(e){return _i(this,arguments,void 0,function*({publicKeyBytes:r}){return et.ProjectivePoint.fromHex(r).toRawBytes(!0)})}static computePublicKey(e){return _i(this,arguments,void 0,function*({key:r}){const n=yield fn.privateKeyToBytes({privateKey:r}),s=yield fn.getCurvePoint({keyBytes:n}),i={kty:"EC",crv:"secp256k1",x:Je.uint8Array(s.x).toBase64Url(),y:Je.uint8Array(s.y).toBase64Url()};return i.kid=yield Br({jwk:i}),i})}static convertDerToCompactSignature(e){return _i(this,arguments,void 0,function*({derSignature:r}){return et.Signature.fromDER(r).toCompactRawBytes()})}static decompressPublicKey(e){return _i(this,arguments,void 0,function*({publicKeyBytes:r}){return et.ProjectivePoint.fromHex(r).toRawBytes(!1)})}static generateKey(){return _i(this,void 0,void 0,function*(){const e=et.utils.randomPrivateKey(),r=yield fn.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Br({jwk:r}),r})}static getPublicKey(e){return _i(this,arguments,void 0,function*({key:r}){var n;if(!(up(r)&&r.crv==="secp256k1"))throw new Error("Secp256k1: The provided key is not a secp256k1 private JWK.");let s=gxe(r,["d"]);return(n=s.kid)!==null&&n!==void 0||(s.kid=yield Br({jwk:s})),s})}static privateKeyToBytes(e){return _i(this,arguments,void 0,function*({privateKey:r}){if(!up(r))throw new Error("Secp256k1: The provided key is not a valid EC private key.");return Je.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return _i(this,arguments,void 0,function*({publicKey:r}){if(!(H$(r)&&r.y))throw new Error("Secp256k1: The provided key is not a valid EC public key.");const n=new Uint8Array([4]),s=Je.base64Url(r.x).toUint8Array(),i=Je.base64Url(r.y).toUint8Array();return new Uint8Array([...n,...s,...i])})}static sharedSecret(e){return _i(this,arguments,void 0,function*({privateKeyA:r,publicKeyB:n}){if("x"in r&&"x"in n&&r.x===n.x)throw new Error("Secp256k1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const s=yield fn.privateKeyToBytes({privateKey:r}),i=yield fn.publicKeyToBytes({publicKey:n});return et.getSharedSecret(s,i,!0).slice(1)})}static sign(e){return _i(this,arguments,void 0,function*({data:r,key:n}){const s=yield fn.privateKeyToBytes({privateKey:n}),i=fw(r);return et.sign(i,s).toCompactRawBytes()})}static validatePrivateKey(e){return _i(this,arguments,void 0,function*({privateKeyBytes:r}){return et.utils.isValidPrivateKey(r)})}static validatePublicKey(e){return _i(this,arguments,void 0,function*({publicKeyBytes:r}){try{et.ProjectivePoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return _i(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=yield fn.publicKeyToBytes({publicKey:r}),o=fw(s);return et.verify(n,o,i,{lowS:!1})})}static getCurvePoint(e){return _i(this,arguments,void 0,function*({keyBytes:r}){r.byteLength===32&&(r=et.getPublicKey(r));const n=et.ProjectivePoint.fromHex(r),s=Yr(n.x,32),i=Yr(n.y,32);return{x:s,y:i}})}}var bi=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},vxe=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};class yn{static adjustSignatureToLowS(e){return bi(this,arguments,void 0,function*({signature:r}){const n=tt.Signature.fromCompact(r);return n.hasHighS()?n.normalizeS().toCompactRawBytes():r})}static bytesToPrivateKey(e){return bi(this,arguments,void 0,function*({privateKeyBytes:r}){const n=yield yn.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"P-256",d:Je.uint8Array(r).toBase64Url(),x:Je.uint8Array(n.x).toBase64Url(),y:Je.uint8Array(n.y).toBase64Url()};return s.kid=yield Br({jwk:s}),s})}static bytesToPublicKey(e){return bi(this,arguments,void 0,function*({publicKeyBytes:r}){const n=yield yn.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"P-256",x:Je.uint8Array(n.x).toBase64Url(),y:Je.uint8Array(n.y).toBase64Url()};return s.kid=yield Br({jwk:s}),s})}static compressPublicKey(e){return bi(this,arguments,void 0,function*({publicKeyBytes:r}){return tt.ProjectivePoint.fromHex(r).toRawBytes(!0)})}static computePublicKey(e){return bi(this,arguments,void 0,function*({key:r}){const n=yield yn.privateKeyToBytes({privateKey:r}),s=yield yn.getCurvePoint({keyBytes:n}),i={kty:"EC",crv:"P-256",x:Je.uint8Array(s.x).toBase64Url(),y:Je.uint8Array(s.y).toBase64Url()};return i.kid=yield Br({jwk:i}),i})}static convertDerToCompactSignature(e){return bi(this,arguments,void 0,function*({derSignature:r}){return tt.Signature.fromDER(r).toCompactRawBytes()})}static decompressPublicKey(e){return bi(this,arguments,void 0,function*({publicKeyBytes:r}){return tt.ProjectivePoint.fromHex(r).toRawBytes(!1)})}static generateKey(){return bi(this,void 0,void 0,function*(){const e=tt.utils.randomPrivateKey(),r=yield yn.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Br({jwk:r}),r})}static getPublicKey(e){return bi(this,arguments,void 0,function*({key:r}){var n;if(!(up(r)&&r.crv==="P-256"))throw new Error("Secp256r1: The provided key is not a 'P-256' private JWK.");let s=vxe(r,["d"]);return(n=s.kid)!==null&&n!==void 0||(s.kid=yield Br({jwk:s})),s})}static privateKeyToBytes(e){return bi(this,arguments,void 0,function*({privateKey:r}){if(!up(r))throw new Error("Secp256r1: The provided key is not a valid EC private key.");return Je.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return bi(this,arguments,void 0,function*({publicKey:r}){if(!(H$(r)&&r.y))throw new Error("Secp256r1: The provided key is not a valid EC public key.");const n=new Uint8Array([4]),s=Je.base64Url(r.x).toUint8Array(),i=Je.base64Url(r.y).toUint8Array();return new Uint8Array([...n,...s,...i])})}static sharedSecret(e){return bi(this,arguments,void 0,function*({privateKeyA:r,publicKeyB:n}){if("x"in r&&"x"in n&&r.x===n.x)throw new Error("Secp256r1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const s=yield yn.privateKeyToBytes({privateKey:r}),i=yield yn.publicKeyToBytes({publicKey:n});return tt.getSharedSecret(s,i,!0).slice(1)})}static sign(e){return bi(this,arguments,void 0,function*({data:r,key:n}){const s=yield yn.privateKeyToBytes({privateKey:n}),i=fw(r);return tt.sign(i,s).toCompactRawBytes()})}static validatePrivateKey(e){return bi(this,arguments,void 0,function*({privateKeyBytes:r}){return tt.utils.isValidPrivateKey(r)})}static validatePublicKey(e){return bi(this,arguments,void 0,function*({publicKeyBytes:r}){try{tt.ProjectivePoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return bi(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=yield yn.publicKeyToBytes({publicKey:r}),o=fw(s);return tt.verify(n,o,i,{lowS:!1})})}static getCurvePoint(e){return bi(this,arguments,void 0,function*({keyBytes:r}){r.byteLength===32&&(r=tt.getPublicKey(r));const n=tt.ProjectivePoint.fromHex(r),s=Yr(n.x,32),i=Yr(n.y,32);return{x:s,y:i}})}}var m0=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};class m8 extends q${computePublicKey(e){return m0(this,arguments,void 0,function*({key:r}){if(!up(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":{const n=yield fn.computePublicKey({key:r});return n.alg="ES256K",n}case"P-256":{const n=yield yn.computePublicKey({key:r});return n.alg="ES256",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}generateKey(e){return m0(this,arguments,void 0,function*({algorithm:r}){switch(r){case"ES256K":case"secp256k1":{const n=yield fn.generateKey();return n.alg="ES256K",n}case"ES256":case"secp256r1":{const n=yield yn.generateKey();return n.alg="ES256",n}}})}getPublicKey(e){return m0(this,arguments,void 0,function*({key:r}){if(!up(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":{const n=yield fn.getPublicKey({key:r});return n.alg="ES256K",n}case"P-256":{const n=yield yn.getPublicKey({key:r});return n.alg="ES256",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}sign(e){return m0(this,arguments,void 0,function*({key:r,data:n}){if(!up(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":return yield fn.sign({key:r,data:n});case"P-256":return yield yn.sign({key:r,data:n});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}verify(e){return m0(this,arguments,void 0,function*({key:r,signature:n,data:s}){if(!H$(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) public key.");switch(r.crv){case"secp256k1":return yield fn.verify({key:r,signature:n,data:s});case"P-256":return yield yn.verify({key:r,signature:n,data:s});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}}var No=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},wxe=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};class gn{static bytesToPrivateKey(e){return No(this,arguments,void 0,function*({privateKeyBytes:r}){const n=wr.getPublicKey(r),s={crv:"Ed25519",d:Je.uint8Array(r).toBase64Url(),kty:"OKP",x:Je.uint8Array(n).toBase64Url()};return s.kid=yield Br({jwk:s}),s})}static bytesToPublicKey(e){return No(this,arguments,void 0,function*({publicKeyBytes:r}){const n={kty:"OKP",crv:"Ed25519",x:Je.uint8Array(r).toBase64Url()};return n.kid=yield Br({jwk:n}),n})}static computePublicKey(e){return No(this,arguments,void 0,function*({key:r}){const n=yield gn.privateKeyToBytes({privateKey:r}),s=wr.getPublicKey(n),i={kty:"OKP",crv:"Ed25519",x:Je.uint8Array(s).toBase64Url()};return i.kid=yield Br({jwk:i}),i})}static convertPrivateKeyToX25519(e){return No(this,arguments,void 0,function*({privateKey:r}){const n=yield gn.privateKeyToBytes({privateKey:r}),s=Bw(n),i=Oi.getPublicKey(s),o={kty:"OKP",crv:"X25519",d:Je.uint8Array(s).toBase64Url(),x:Je.uint8Array(i).toBase64Url()};return o.kid=yield Br({jwk:o}),o})}static convertPublicKeyToX25519(e){return No(this,arguments,void 0,function*({publicKey:r}){const n=yield gn.publicKeyToBytes({publicKey:r});if(!(yield gn.validatePublicKey({publicKeyBytes:n})))throw new Error("Ed25519: Invalid public key.");const i=Nw(n),o={kty:"OKP",crv:"X25519",x:Je.uint8Array(i).toBase64Url()};return o.kid=yield Br({jwk:o}),o})}static generateKey(){return No(this,void 0,void 0,function*(){const e=wr.utils.randomPrivateKey(),r=yield gn.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Br({jwk:r}),r})}static getPublicKey(e){return No(this,arguments,void 0,function*({key:r}){var n;if(!(cp(r)&&r.crv==="Ed25519"))throw new Error("Ed25519: The provided key is not an Ed25519 private JWK.");let s=wxe(r,["d"]);return(n=s.kid)!==null&&n!==void 0||(s.kid=yield Br({jwk:s})),s})}static privateKeyToBytes(e){return No(this,arguments,void 0,function*({privateKey:r}){if(!cp(r))throw new Error("Ed25519: The provided key is not a valid OKP private key.");return Je.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return No(this,arguments,void 0,function*({publicKey:r}){if(!z$(r))throw new Error("Ed25519: The provided key is not a valid OKP public key.");return Je.base64Url(r.x).toUint8Array()})}static sign(e){return No(this,arguments,void 0,function*({key:r,data:n}){const s=yield gn.privateKeyToBytes({privateKey:r});return wr.sign(n,s)})}static validatePublicKey(e){return No(this,arguments,void 0,function*({publicKeyBytes:r}){try{wr.ExtendedPoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return No(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=yield gn.publicKeyToBytes({publicKey:r});return wr.verify(n,s,i)})}}var y0=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};class _xe extends q${computePublicKey(e){return y0(this,arguments,void 0,function*({key:r}){if(!cp(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":{const n=yield gn.computePublicKey({key:r});return n.alg="EdDSA",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}generateKey(e){return y0(this,arguments,void 0,function*({algorithm:r}){switch(r){case"Ed25519":{const n=yield gn.generateKey();return n.alg="EdDSA",n}}})}getPublicKey(e){return y0(this,arguments,void 0,function*({key:r}){if(!cp(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":{const n=yield gn.getPublicKey({key:r});return n.alg="EdDSA",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}sign(e){return y0(this,arguments,void 0,function*({key:r,data:n}){if(!cp(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":return yield gn.sign({key:r,data:n});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}verify(e){return y0(this,arguments,void 0,function*({key:r,signature:n,data:s}){if(!z$(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) public key.");switch(r.crv){case"Ed25519":return yield gn.verify({key:r,signature:n,data:s});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}}var Oc=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};const ED={Ed25519:{implementation:_xe,names:["Ed25519"]},secp256k1:{implementation:m8,names:["ES256K","secp256k1"]},secp256r1:{implementation:m8,names:["ES256","secp256r1"]},"SHA-256":{implementation:hxe,names:["SHA-256"]}};class wl{constructor(e){var r;this._algorithmInstances=new Map,this._keyStore=(r=e==null?void 0:e.keyStore)!==null&&r!==void 0?r:new QDe}digest(e){return Oc(this,arguments,void 0,function*({algorithm:r,data:n}){return yield this.getAlgorithm({algorithm:r}).digest({algorithm:r,data:n})})}exportKey(e){return Oc(this,arguments,void 0,function*({keyUri:r}){return yield this.getPrivateKey({keyUri:r})})}generateKey(e){return Oc(this,arguments,void 0,function*({algorithm:r}){const s=yield this.getAlgorithm({algorithm:r}).generateKey({algorithm:r});if((s==null?void 0:s.kid)===void 0)throw new Error("Generated key is missing a required property: kid");const i=`${p8}${s.kid}`;return yield this._keyStore.set(i,s),i})}getKeyUri(e){return Oc(this,arguments,void 0,function*({key:r}){const n=yield Br({jwk:r});return`${p8}${n}`})}getPublicKey(e){return Oc(this,arguments,void 0,function*({keyUri:r}){const n=yield this.getPrivateKey({keyUri:r}),s=this.getAlgorithmName({key:n});return yield this.getAlgorithm({algorithm:s}).getPublicKey({key:n})})}importKey(e){return Oc(this,arguments,void 0,function*({key:r}){var n;if(!yxe(r))throw new TypeError("Invalid key provided. Must be a private key in JWK format.");const s=structuredClone(r);(n=s.kid)!==null&&n!==void 0||(s.kid=yield Br({jwk:s}));const i=yield this.getKeyUri({key:s});return yield this._keyStore.set(i,s),i})}sign(e){return Oc(this,arguments,void 0,function*({keyUri:r,data:n}){const s=yield this.getPrivateKey({keyUri:r}),i=this.getAlgorithmName({key:s});return this.getAlgorithm({algorithm:i}).sign({data:n,key:s})})}verify(e){return Oc(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=this.getAlgorithmName({key:r});return this.getAlgorithm({algorithm:i}).verify({key:r,signature:n,data:s})})}getAlgorithm({algorithm:e}){var r;const n=(r=ED[e])===null||r===void 0?void 0:r.implementation;if(!n)throw new Error(`Algorithm not supported: ${e}`);return this._algorithmInstances.has(n)||this._algorithmInstances.set(n,new n),this._algorithmInstances.get(n)}getAlgorithmName({key:e}){const r=e.alg,n=e.crv;for(const s in ED){const i=ED[s];if(r&&i.names.includes(r))return s;if(n&&i.names.includes(n))return s}throw new Error(`Unable to determine algorithm based on provided input: alg=${r}, crv=${n}`)}getPrivateKey(e){return Oc(this,arguments,void 0,function*({keyUri:r}){const n=yield this._keyStore.get(r);if(!n)throw new Error(`Key not found: ${r}`);return n})}}function bxe(t){const e={Ed25519:"EdDSA","P-256":"ES256","P-384":"ES384","P-521":"ES512",secp256k1:"ES256K"};if(t.alg&&Object.values(e).includes(t.alg))return t.alg;if(t.crv&&Object.keys(e).includes(t.crv))return e[t.crv];throw new Error(`Unable to determine algorithm based on provided input: alg=${t.alg}, crv=${t.crv}. Supported 'alg' values: ${Object.values(e).join(", ")}. Supported 'crv' values: ${Object.keys(e).join(", ")}.`)}var ld=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},Exe=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};class Lh{static bytesToPrivateKey(e){return ld(this,arguments,void 0,function*({privateKeyBytes:r}){const n=Oi.getPublicKey(r),s={kty:"OKP",crv:"X25519",d:Je.uint8Array(r).toBase64Url(),x:Je.uint8Array(n).toBase64Url()};return s.kid=yield Br({jwk:s}),s})}static bytesToPublicKey(e){return ld(this,arguments,void 0,function*({publicKeyBytes:r}){const n={kty:"OKP",crv:"X25519",x:Je.uint8Array(r).toBase64Url()};return n.kid=yield Br({jwk:n}),n})}static computePublicKey(e){return ld(this,arguments,void 0,function*({key:r}){const n=yield Lh.privateKeyToBytes({privateKey:r}),s=Oi.getPublicKey(n),i={kty:"OKP",crv:"X25519",x:Je.uint8Array(s).toBase64Url()};return i.kid=yield Br({jwk:i}),i})}static generateKey(){return ld(this,void 0,void 0,function*(){const e=Oi.utils.randomPrivateKey(),r=yield Lh.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Br({jwk:r}),r})}static getPublicKey(e){return ld(this,arguments,void 0,function*({key:r}){var n;if(!(cp(r)&&r.crv==="X25519"))throw new Error("X25519: The provided key is not an X25519 private JWK.");let s=Exe(r,["d"]);return(n=s.kid)!==null&&n!==void 0||(s.kid=yield Br({jwk:s})),s})}static privateKeyToBytes(e){return ld(this,arguments,void 0,function*({privateKey:r}){if(!cp(r))throw new Error("X25519: The provided key is not a valid OKP private key.");return Je.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return ld(this,arguments,void 0,function*({publicKey:r}){if(!z$(r))throw new Error("X25519: The provided key is not a valid OKP public key.");return Je.base64Url(r.x).toUint8Array()})}static sharedSecret(e){return ld(this,arguments,void 0,function*({privateKeyA:r,publicKeyB:n}){if("x"in r&&"x"in n&&r.x===n.x)throw new Error("X25519: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const s=yield Lh.privateKeyToBytes({privateKey:r}),i=yield Lh.publicKeyToBytes({publicKey:n});return Oi.getSharedSecret(s,i)})}}function Na(t){if(typeof t=="string"&&t.length!==0)return t.split("#").pop()}function IH({didDocument:t}){var e,r;if(!t)throw new TypeError("Required parameter missing: 'didDocument'");const n=[];return n.push(...(r=(e=t.verificationMethod)===null||e===void 0?void 0:e.filter(WP))!==null&&r!==void 0?r:[]),Object.keys(dw).forEach(s=>{var i,o;n.push(...(o=(i=t[s])===null||i===void 0?void 0:i.filter(WP))!==null&&o!==void 0?o:[])}),n}function Axe({didDocument:t}){const r=IH({didDocument:t}).map(n=>n.type);return[...new Set(r)]}function Sxe({didDocument:t,methodId:e}){const r=[];return Object.keys(dw).forEach(n=>{if(Array.isArray(t[n])){const s=t[n],i=Na(e);s.some(a=>{const u=Na(a)===i,l=WP(a)&&Na(a.id)===i;return u||l})&&r.push(n)}}),r}function WP(t){return!(!t||typeof t!="object"||t===null||!("id"in t&&"type"in t&&"controller"in t)||typeof t.id!="string"||typeof t.type!="string"||typeof t.controller!="string")}function kH({keyBytes:t,multicodecCode:e,multicodecName:r}){const n=$n.addPrefix({code:e,data:t,name:r}),s=Je.uint8Array(n).toBase58Btc();return Je.base58Btc(s).toMultibase()}function y8({multibaseKeyId:t}){try{const e=Je.multibase(t).toBase58Btc(),r=Je.base58Btc(e).toUint8Array(),{code:n,data:s,name:i}=$n.removePrefix({prefixedData:r});return{keyBytes:s,multicodecCode:n,multicodecName:i}}catch{throw new at(mt.InvalidDid,`Invalid multibase identifier: ${t}`)}}var g0=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};class Qu{constructor({uri:e,document:r,metadata:n,keyManager:s}){this.uri=e,this.document=r,this.metadata=n,this.keyManager=s}export(){return g0(this,void 0,void 0,function*(){if(!(Array.isArray(this.document.verificationMethod)&&this.document.verificationMethod.length>0))throw new Error(`DID document for '${this.uri}' is missing verification methods`);let e={uri:this.uri,document:this.document,metadata:this.metadata};if("exportKey"in this.keyManager&&typeof this.keyManager.exportKey=="function"){const r=[];for(let n of this.document.verificationMethod){if(!n.publicKeyJwk)throw new Error(`Verification method '${n.id}' does not contain a public key in JWK format`);const s=yield this.keyManager.getKeyUri({key:n.publicKeyJwk}),i=yield this.keyManager.exportKey({keyUri:s});r.push(Object.assign({},i))}e.privateKeys=r}return e})}getSigner(e){return g0(this,void 0,void 0,function*(){var r;const n=(r=this.document.verificationMethod)===null||r===void 0?void 0:r.find(u=>{var l,c;return Na(u.id)===((l=Na(e==null?void 0:e.methodId))!==null&&l!==void 0?l:Na((c=this.document.assertionMethod)===null||c===void 0?void 0:c[0]))});if(!(n&&n.publicKeyJwk))throw new at(mt.InternalError,"A verification method intended for signing could not be determined from the DID Document");const s=yield this.keyManager.getKeyUri({key:n.publicKeyJwk}),i=yield this.keyManager.getPublicKey({keyUri:s}),o=this.keyManager;return{algorithm:bxe(i),keyId:n.id,sign(u){return g0(this,arguments,void 0,function*({data:l}){return yield o.sign({data:l,keyUri:s})})},verify(u){return g0(this,arguments,void 0,function*({data:l,signature:c}){return yield o.verify({data:l,key:i,signature:c})})}}})}static import(e){return g0(this,arguments,void 0,function*({portableDid:r,keyManager:n=new wl}){var s;const i=IH({didDocument:r.document});if(i.length===0)throw new at(mt.InvalidDidDocument,"At least one verification method is required but 0 were given");for(let a of(s=r.privateKeys)!==null&&s!==void 0?s:[])yield n.importKey({key:a});for(let a of i){if(!a.publicKeyJwk)throw new Error(`Verification method '${a.id}' does not contain a public key in JWK format`);const u=yield n.getKeyUri({key:a.publicKeyJwk});yield n.getPublicKey({keyUri:u})}return new Qu({uri:r.uri,document:r.document,metadata:r.metadata,keyManager:n})})}}var g8=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};class n_{static getSigningMethod(e){return g8(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement getSigningMethod()")})}static resolve(e,r){return g8(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement resolve()")})}}var ii=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},v8=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};const w8="https://diddht.tbddev.org",Txe=0,dd=7200,W1=";",os=",";var GP;(function(t){t[t.Discoverable=0]="Discoverable",t[t.Organization=1]="Organization",t[t.Government=2]="Government",t[t.Corporation=3]="Corporation",t[t.LocalBusiness=4]="LocalBusiness",t[t.SoftwarePackage=5]="SoftwarePackage",t[t.WebApp=6]="WebApp",t[t.FinancialInstitution=7]="FinancialInstitution"})(GP||(GP={}));var ps;(function(t){t[t.Ed25519=0]="Ed25519",t[t.secp256k1=1]="secp256k1",t[t.secp256r1=2]="secp256r1",t[t.X25519=3]="X25519"})(ps||(ps={}));var JP;(function(t){t.authentication="auth",t.assertionMethod="asm",t.capabilityDelegation="del",t.capabilityInvocation="inv",t.keyAgreement="agm"})(JP||(JP={}));const $H={Ed25519:ps.Ed25519,ES256K:ps.secp256k1,ES256:ps.secp256r1,"P-256":ps.secp256r1,secp256k1:ps.secp256k1,secp256r1:ps.secp256r1,X25519:ps.X25519},_8={[ps.Ed25519]:"EdDSA",[ps.secp256k1]:"ES256K",[ps.secp256r1]:"ES256",[ps.X25519]:"ECDH-ES+A256KW"};class wf extends n_{static create(){return ii(this,arguments,void 0,function*({keyManager:e=new wl,options:r={}}={}){var n,s,i,o,a,u,l,c,d,h,f;if(!((n=r.verificationMethods)===null||n===void 0)&&n.some(S=>!(S.algorithm in $H)))throw new Error("One or more verification method algorithms are not supported");const p=(s=r.verificationMethods)===null||s===void 0?void 0:s.filter(S=>"id"in S).map(S=>S.id);if(p&&p.length!==new Set(p).size)throw new Error("One or more verification method IDs are not unique");if(!((i=r.services)===null||i===void 0)&&i.some(S=>!S.id||!S.type||!S.serviceEndpoint))throw new Error("One or more services are missing required properties");const m=yield e.generateKey({algorithm:"Ed25519"}),E=yield e.getPublicKey({keyUri:m}),A=yield kn.identityKeyToIdentifier({identityKey:E}),_=Object.assign(Object.assign({id:A},r.alsoKnownAs&&{alsoKnownAs:r.alsoKnownAs}),r.controllers&&{controller:r.controllers}),g=[...(o=r.verificationMethods)!==null&&o!==void 0?o:[]];g!=null&&g.some(S=>{var x;return((x=S.id)===null||x===void 0?void 0:x.split("#").pop())==="0"})||g.unshift({algorithm:"Ed25519",id:"0",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]});for(const S of g){const x=S.id&&S.id.split("#").pop()==="0"?m:yield e.generateKey({algorithm:S.algorithm}),D=yield e.getPublicKey({keyUri:x});let w=(u=(a=S.id)!==null&&a!==void 0?a:D.kid)!==null&&u!==void 0?u:yield Br({jwk:D});w=`${A}#${Na(w)}`,(l=_.verificationMethod)!==null&&l!==void 0||(_.verificationMethod=[]),_.verificationMethod.push({id:w,type:"JsonWebKey",controller:(c=S.controller)!==null&&c!==void 0?c:A,publicKeyJwk:D});for(const b of(d=S.purposes)!==null&&d!==void 0?d:[])_[b]||(_[b]=[]),_[b].push(w)}(h=r.services)===null||h===void 0||h.forEach(S=>{var x;(x=_.service)!==null&&x!==void 0||(_.service=[]),S.id=`${A}#${S.id.split("#").pop()}`,_.service.push(S)});const v=new Qu({uri:A,document:_,metadata:Object.assign({published:!1},r.types&&{types:r.types}),keyManager:e});if(!((f=r.publish)!==null&&f!==void 0)||f){const S=yield wf.publish({did:v,gatewayUri:r.gatewayUri});v.metadata=S.didDocumentMetadata}return v})}static import(e){return ii(this,arguments,void 0,function*({portableDid:r,keyManager:n=new wl}){var s;const i=Er.parse(r.uri);if((i==null?void 0:i.method)!==wf.methodName)throw new at(mt.MethodNotSupported,"Method not supported");const o=yield Qu.import({portableDid:r,keyManager:n});if(!(!((s=o.document.verificationMethod)===null||s===void 0)&&s.some(a=>{var u;return((u=a.id)===null||u===void 0?void 0:u.split("#").pop())==="0"})))throw new at(mt.InvalidDidDocument,"DID document must contain an Identity Key");return o})}static getSigningMethod(e){return ii(this,arguments,void 0,function*({didDocument:r,methodId:n="#0"}){var s;const i=Er.parse(r.id);if(i&&i.method!==this.methodName)throw new at(mt.MethodNotSupported,`Method not supported: ${i.method}`);const o=(s=r.verificationMethod)===null||s===void 0?void 0:s.find(a=>{var u,l;return Na(a.id)===((u=Na(n))!==null&&u!==void 0?u:Na((l=r.assertionMethod)===null||l===void 0?void 0:l[0]))});if(!(o&&o.publicKeyJwk))throw new at(mt.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static publish(e){return ii(this,arguments,void 0,function*({did:r,gatewayUri:n=w8}){return yield Jc.put({did:r,gatewayUri:n})})}static resolve(e){return ii(this,arguments,void 0,function*(r,n={}){var s;const i=(s=n==null?void 0:n.gatewayUri)!==null&&s!==void 0?s:w8;try{yield kn.identifierToIdentityKey({didUri:r});const{didDocument:o,didDocumentMetadata:a}=yield Jc.get({didUri:r,gatewayUri:i});return Object.assign(Object.assign({},vs),{didDocument:o,didDocumentMetadata:a})}catch(o){if(!(o instanceof at))throw new Error(o);return Object.assign(Object.assign({},vs),{didResolutionMetadata:Object.assign({error:o.code},o.message&&{errorMessage:o.message})})}})}}wf.methodName="dht";class Jc{static get(e){return ii(this,arguments,void 0,function*({didUri:r,gatewayUri:n}){const s=kn.identifierToIdentityKeyBytes({didUri:r}),i=yield Jc.pkarrGet({gatewayUri:n,publicKeyBytes:s}),o=yield kn.parseBep44GetMessage({bep44Message:i}),a=yield Jc.fromDnsPacket({didUri:r,dnsPacket:o});return a.didDocumentMetadata.versionId=i.seq.toString(),a})}static put(e){return ii(this,arguments,void 0,function*({did:r,gatewayUri:n}){const s=yield Jc.toDnsPacket({didDocument:r.document,didMetadata:r.metadata,authoritativeGatewayUris:[n]}),i=yield kn.createBep44PutMessage({dnsPacket:s,publicKeyBytes:kn.identifierToIdentityKeyBytes({didUri:r.uri}),signer:yield r.getSigner({methodId:"0"})}),o=yield Jc.pkarrPut({gatewayUri:n,bep44Message:i});return{didDocument:r.document,didDocumentMetadata:Object.assign(Object.assign({},r.metadata),{published:o,versionId:i.seq.toString()}),didRegistrationMetadata:{}}})}static pkarrGet(e){return ii(this,arguments,void 0,function*({gatewayUri:r,publicKeyBytes:n}){const s=Je.uint8Array(n).toBase32Z(),i=new URL(s,r).href;let o;try{if(o=yield fetch(i,{method:"GET"}),!o.ok)throw new at(mt.NotFound,`Pkarr record not found for: ${s}`)}catch(l){throw l instanceof at?l:new at(mt.InternalError,`Failed to fetch Pkarr record: ${l.message}`)}const a=yield o.arrayBuffer();if(!a)throw new at(mt.NotFound,`Pkarr record not found for: ${s}`);if(a.byteLength<72)throw new at(mt.InvalidDidDocumentLength,`Pkarr response must be at least 72 bytes but got: ${a.byteLength}`);if(a.byteLength>1072)throw new at(mt.InvalidDidDocumentLength,`Pkarr response exceeds 1000 byte limit: ${a.byteLength}`);return{k:n,seq:Number(new DataView(a).getBigUint64(64)),sig:new Uint8Array(a,0,64),v:new Uint8Array(a,72)}})}static pkarrPut(e){return ii(this,arguments,void 0,function*({gatewayUri:r,bep44Message:n}){const s=Je.uint8Array(n.k).toBase32Z(),i=new URL(s,r).href,o=new Uint8Array(n.v.length+72);o.set(n.sig,0),new DataView(o.buffer).setBigUint64(n.sig.length,BigInt(n.seq)),o.set(n.v,n.sig.length+8);let a;try{a=yield fetch(i,{method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:o})}catch(u){throw new at(mt.InternalError,`Failed to put Pkarr record for identifier ${s}: ${u.message}`)}return a.ok})}static fromDnsPacket(e){return ii(this,arguments,void 0,function*({didUri:r,dnsPacket:n}){var s,i,o;const a={id:r},u={published:!0},l=new Map;for(const c of(s=n==null?void 0:n.answers)!==null&&s!==void 0?s:[]){if(c.type!=="TXT")continue;const d=c.name.split(".")[0].substring(1);switch(!0){case d.startsWith("aka"):{const h=kn.parseTxtDataToString(c.data);a.alsoKnownAs=h.split(os);break}case d.startsWith("cnt"):{const h=kn.parseTxtDataToString(c.data);a.controller=h.includes(os)?h.split(os):h;break}case d.startsWith("k"):{const{id:h,t:f,k:p,c:m,a:E}=kn.parseTxtDataToObject(c.data),A=Je.base64Url(p).toUint8Array(),_=ps[Number(f)];let g=yield kn.keyConverter(_).bytesToPublicKey({publicKeyBytes:A});g.alg=E||_8[Number(f)];const v=d==="k0"?"0":h!==void 0?h:yield Br({jwk:g});(i=a.verificationMethod)!==null&&i!==void 0||(a.verificationMethod=[]);const S=`${r}#${v}`;a.verificationMethod.push({id:S,type:"JsonWebKey",controller:m??r,publicKeyJwk:g}),l.set(d,S);break}case d.startsWith("s"):{const h=kn.parseTxtDataToObject(c.data),{id:f,t:p,se:m}=h,E=v8(h,["id","t","se"]),A=m.includes(os)?m.split(os):[m],_=Object.fromEntries(Object.entries(E).map(([g,v])=>[g,v.includes(os)?v.split(os):v]));(o=a.service)!==null&&o!==void 0||(a.service=[]),a.service.push(Object.assign(Object.assign({},_),{id:`${r}#${f}`,type:p,serviceEndpoint:A}));break}case d.startsWith("typ"):{const{id:h}=kn.parseTxtDataToObject(c.data);u.types=h.split(os).map(f=>Number(f));break}case d.startsWith("did"):{const h=_=>_.split(os).map(g=>l.get(g)).filter(g=>typeof g=="string"),{auth:f,asm:p,del:m,inv:E,agm:A}=kn.parseTxtDataToObject(c.data);f&&(a.authentication=h(f)),p&&(a.assertionMethod=h(p)),m&&(a.capabilityDelegation=h(m)),E&&(a.capabilityInvocation=h(E)),A&&(a.keyAgreement=h(A));break}}}return{didDocument:a,didDocumentMetadata:u,didResolutionMetadata:{}}})}static toDnsPacket(e){return ii(this,arguments,void 0,function*({didDocument:r,didMetadata:n,authoritativeGatewayUris:s,previousDidProof:i}){var o,a,u,l,c;const d=[],h=[],f=new Map,p=[],m=[];if(i!==void 0){const{signature:_,previousDid:g}=i;yield kn.validatePreviousDidProof({newDid:r.id,previousDidProof:i}),d.push({type:"TXT",name:"_prv._did.",ttl:dd,data:`id=${g};s=${_}`})}if(r.alsoKnownAs&&d.push({type:"TXT",name:"_aka._did.",ttl:dd,data:r.alsoKnownAs.join(os)}),r.controller){const _=Array.isArray(r.controller)?r.controller.join(os):r.controller;d.push({type:"TXT",name:"_cnt._did.",ttl:dd,data:_})}for(const[_,g]of(a=(o=r.verificationMethod)===null||o===void 0?void 0:o.entries())!==null&&a!==void 0?a:[]){const v=`k${_}`;m.push(v);let S=g.id.split("#").pop();f.set(S,v);const x=g.publicKeyJwk;if(!(x!=null&&x.crv&&x.crv in $H))throw new at(mt.InvalidPublicKeyType,`Verification method '${g.id}' contains an unsupported key type: ${(u=x==null?void 0:x.crv)!==null&&u!==void 0?u:"undefined"}`);const D=ps[x.crv],w=yield kn.keyConverter(x.crv).publicKeyToBytes({publicKey:x}),b=Je.uint8Array(w).toBase64Url(),T=[`t=${D}`,`k=${b}`];S!=="0"&&(yield Br({jwk:x}))!==S&&T.unshift(`id=${S}`),x.alg!==_8[D]&&T.push(`a=${x.alg}`),g.controller!==r.id&&T.push(`c=${g.controller}`),d.push({type:"TXT",name:`_${v}._did.`,ttl:dd,data:T.join(W1)})}(l=r.service)===null||l===void 0||l.forEach((_,g)=>{const v=`s${g}`;p.push(v);let{id:S,type:x,serviceEndpoint:D}=_,w=v8(_,["id","type","serviceEndpoint"]);S=Na(S),D=Array.isArray(D)?D.join(","):D;const T=Object.entries(Object.assign({id:S,t:x,se:D},w)).map(([C,k])=>`${C}=${k}`).join(W1),P=kn.chunkDataIfNeeded(T);d.push({type:"TXT",name:`_${v}._did.`,ttl:dd,data:P})});const E=[`v=${Txe}`];if(m.length&&E.push(`vm=${m.join(os)}`),Object.keys(dw).forEach(_=>{var g;const v=(g=r[_])===null||g===void 0?void 0:g.map(S=>f.get(S.split("#").pop()));if(v){const S=JP[_];E.push(`${S}=${v.join(os)}`)}}),p.length&&E.push(`svc=${p.join(os)}`),!((c=n.types)===null||c===void 0)&&c.length){const g=n.types.map(v=>typeof v=="string"?GP[v]:v);d.push({type:"TXT",name:"_typ._did.",ttl:dd,data:`id=${g.join(os)}`})}d.push({type:"TXT",name:"_did."+Jc.getUniqueDidSuffix(r.id)+".",ttl:dd,data:E.join(W1)});for(const _ of s||[])h.push({type:"NS",name:"_did."+Jc.getUniqueDidSuffix(r.id)+".",ttl:dd,data:_+"."});return{id:0,type:"response",flags:MI,answers:[...d,...h]}})}static getUniqueDidSuffix(e){return e.split(":")[2]}}class kn{static createBep44PutMessage(e){return ii(this,arguments,void 0,function*({dnsPacket:r,publicKeyBytes:n,signer:s}){const i=Math.ceil(Date.now()/1e3),o=Hv(r),a=gy.encode({seq:i,v:o}).subarray(1,-1);if(a.length>1e3)throw new at(mt.InvalidDidDocumentLength,`DNS packet exceeds the 1000 byte maximum size: ${a.length} bytes`);const u=yield s.sign({data:a});return{k:n,seq:i,sig:u,v:o}})}static identifierToIdentityKey(e){return ii(this,arguments,void 0,function*({didUri:r}){let n=kn.identifierToIdentityKeyBytes({didUri:r});return yield gn.bytesToPublicKey({publicKeyBytes:n})})}static identifierToIdentityKeyBytes({didUri:e}){const r=Er.parse(e);if(!r)throw new at(mt.InvalidDid,`Invalid DID URI: ${e}`);if(r.method!==wf.methodName)throw new at(mt.MethodNotSupported,`Method not supported: ${r.method}`);let n;try{n=Je.base32Z(r.id).toUint8Array()}catch{throw new at(mt.InvalidPublicKey,"Failed to decode method-specific identifier")}if(n.length!==32)throw new at(mt.InvalidPublicKeyLength,`Invalid public key length: ${n.length}`);return n}static identityKeyToIdentifier(e){return ii(this,arguments,void 0,function*({identityKey:r}){const n=yield gn.publicKeyToBytes({publicKey:r}),s=Je.uint8Array(n).toBase32Z();return`did:${wf.methodName}:${s}`})}static keyConverter(e){const n={Ed25519:gn,"P-256":{publicKeyToBytes:s=>ii(this,[s],void 0,function*({publicKey:i}){const o=yield yn.publicKeyToBytes({publicKey:i});return yield yn.compressPublicKey({publicKeyBytes:o})}),bytesToPublicKey:yn.bytesToPublicKey,privateKeyToBytes:yn.privateKeyToBytes,bytesToPrivateKey:yn.bytesToPrivateKey},secp256k1:{publicKeyToBytes:s=>ii(this,[s],void 0,function*({publicKey:i}){const o=yield fn.publicKeyToBytes({publicKey:i});return yield fn.compressPublicKey({publicKeyBytes:o})}),bytesToPublicKey:fn.bytesToPublicKey,privateKeyToBytes:fn.privateKeyToBytes,bytesToPrivateKey:fn.bytesToPrivateKey},X25519:Lh}[e];if(!n)throw new at(mt.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static parseBep44GetMessage(e){return ii(this,arguments,void 0,function*({bep44Message:r}){const n=yield gn.bytesToPublicKey({publicKeyBytes:r.k}),s=gy.encode({seq:r.seq,v:r.v}).subarray(1,-1);if(!(yield gn.verify({key:n,signature:r.sig,data:s})))throw new at(mt.InvalidSignature,"Invalid signature for DHT BEP44 message");return jI(r.v)})}static parseTxtDataToObject(e){return this.parseTxtDataToString(e).split(W1).reduce((r,n)=>{const[s,i]=n.split("=");return r[s]=i,r},{})}static parseTxtDataToString(e){if(typeof e=="string")return e;if(e instanceof Uint8Array)return Je.uint8Array(e).toString();if(Array.isArray(e))return e.map(r=>this.parseTxtDataToString(r)).join("");throw new at(mt.InternalError,"Pkarr returned DNS TXT record with invalid data type")}static validatePreviousDidProof(e){return ii(this,arguments,void 0,function*({newDid:r,previousDidProof:n}){const s=yield kn.identifierToIdentityKey({didUri:n.previousDid}),i=kn.identifierToIdentityKeyBytes({didUri:r}),o=Je.base64Url(n.signature).toUint8Array();if(!(yield gn.verify({key:s,data:i,signature:o})))throw new at(mt.InvalidPreviousDidProof,"The previous DID proof is invalid.")})}static chunkDataIfNeeded(e){if(e.length<=255)return e;const r=[];for(let n=0;n<e.length;n+=255)r.push(e.slice(n,n+255));return r}}var Kd=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},Tu;(function(t){t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.secp256r1="secp256r1",t.X25519="X25519"})(Tu||(Tu={}));const Dxe={Ed25519:Tu.Ed25519,ES256K:Tu.secp256k1,ES256:Tu.secp256r1,"P-256":Tu.secp256r1,secp256k1:Tu.secp256k1,secp256r1:Tu.secp256r1},b8="https://ion.tbd.engineering";class Mm extends n_{static create(){return Kd(this,arguments,void 0,function*({keyManager:e=new wl,options:r={}}={}){var n,s,i,o,a,u,l;if(!((n=r.verificationMethods)===null||n===void 0)&&n.some(S=>!(S.algorithm in Dxe)))throw new Error("One or more verification method algorithms are not supported");const c=(s=r.verificationMethods)===null||s===void 0?void 0:s.filter(S=>"id"in S).map(S=>S.id);if(c&&c.length!==new Set(c).size)throw new Error("One or more verification method IDs are not unique");if(!((i=r.services)===null||i===void 0)&&i.some(S=>!S.id||!S.type||!S.serviceEndpoint))throw new Error("One or more services are missing required properties");const d={algorithm:"Ed25519",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]},h=[];for(const S of(o=r.verificationMethods)!==null&&o!==void 0?o:[d]){const x=yield e.generateKey({algorithm:S.algorithm}),D=yield e.getPublicKey({keyUri:x});h.push({id:S.id,publicKeyJwk:D,purposes:(a=S.purposes)!==null&&a!==void 0?a:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]})}const f=yield e.generateKey({algorithm:Tu.secp256k1}),p=yield e.getPublicKey({keyUri:f}),m=yield e.generateKey({algorithm:Tu.secp256k1}),E=yield e.getPublicKey({keyUri:m}),A=yield Jo.computeLongFormDidUri({recoveryKey:p,updateKey:E,services:(u=r.services)!==null&&u!==void 0?u:[],verificationMethods:h}),{didDocument:_,didResolutionMetadata:g}=yield Mm.resolve(A,{gatewayUri:r.gatewayUri});if(_===null)throw new Error(`Unable to resolve DID during creation: ${g==null?void 0:g.error}`);const v=new Qu({uri:A,document:_,metadata:{published:!1,canonicalId:A.split(":",3).join(":"),recoveryKey:p,updateKey:E},keyManager:e});if(!((l=r.publish)!==null&&l!==void 0)||l){const S=yield Mm.publish({did:v,gatewayUri:r.gatewayUri});v.metadata=S.didDocumentMetadata}return v})}static getSigningMethod(e){return Kd(this,arguments,void 0,function*({didDocument:r,methodId:n}){var s;const i=Er.parse(r.id);if(i&&i.method!==this.methodName)throw new at(mt.MethodNotSupported,`Method not supported: ${i.method}`);const o=(s=r.verificationMethod)===null||s===void 0?void 0:s.find(a=>{var u;return a.id===(n??((u=r.assertionMethod)===null||u===void 0?void 0:u[0]))});if(!(o&&o.publicKeyJwk))throw new at(mt.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static import(e){return Kd(this,arguments,void 0,function*({portableDid:r,keyManager:n=new wl}){const s=Er.parse(r.uri);if((s==null?void 0:s.method)!==Mm.methodName)throw new at(mt.MethodNotSupported,"Method not supported");return yield Qu.import({portableDid:r,keyManager:n})})}static publish(e){return Kd(this,arguments,void 0,function*({did:r,gatewayUri:n=b8}){var s,i,o;const a=(i=(s=r.document.verificationMethod)===null||s===void 0?void 0:s.map(c=>({id:c.id,publicKeyJwk:c.publicKeyJwk,purposes:Sxe({didDocument:r.document,methodId:c.id})})))!==null&&i!==void 0?i:[],u=yield Jo.createIonDocument({services:(o=r.document.service)!==null&&o!==void 0?o:[],verificationMethods:a}),l=yield Jo.constructCreateRequest({ionDocument:u,recoveryKey:r.metadata.recoveryKey,updateKey:r.metadata.updateKey});try{const c=Jo.appendPathToUrl({baseUrl:n,path:"/operations"}),d=yield fetch(c,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});return{didDocument:r.document,didDocumentMetadata:Object.assign(Object.assign({},r.metadata),{published:d.ok}),didRegistrationMetadata:{}}}catch{return{didDocument:null,didDocumentMetadata:{published:!1},didRegistrationMetadata:{error:mt.InternalError,errorMessage:`Failed to publish DID document for: ${r.uri}`}}}})}static resolve(e){return Kd(this,arguments,void 0,function*(r,n={}){var s,i;const o=Er.parse(r);if(!o)return Object.assign(Object.assign({},vs),{didResolutionMetadata:{error:"invalidDid"}});if(o.method!==Mm.methodName)return Object.assign(Object.assign({},vs),{didResolutionMetadata:{error:"methodNotSupported"}});const a=(s=n==null?void 0:n.gatewayUri)!==null&&s!==void 0?s:b8;try{const u=Jo.appendPathToUrl({baseUrl:a,path:`/identifiers/${r}`}),l=yield fetch(u);if(!l.ok)throw new at(mt.NotFound,`Unable to find DID document for: ${r}`);const{didDocument:c,didDocumentMetadata:d}=yield l.json();return Object.assign(Object.assign(Object.assign({},vs),c&&{didDocument:c}),{didDocumentMetadata:Object.assign({published:(i=d==null?void 0:d.method)===null||i===void 0?void 0:i.published},d)})}catch(u){if(!(u instanceof at))throw new Error(u);return Object.assign(Object.assign({},vs),{didResolutionMetadata:Object.assign({error:u.code},u.message&&{errorMessage:u.message})})}})}}Mm.methodName="ion";class Jo{static appendPathToUrl({baseUrl:e,path:r}){const n=new URL(e);return n.pathname=n.pathname.endsWith("/")?n.pathname:n.pathname+"/",n.pathname+=r.startsWith("/")?r.substring(1):r,n.toString()}static computeLongFormDidUri(e){return Kd(this,arguments,void 0,function*({recoveryKey:r,updateKey:n,services:s,verificationMethods:i}){const o=yield Jo.createIonDocument({services:s,verificationMethods:i}),a=Jo.normalizeJwk(r),u=Jo.normalizeJwk(n);return yield Lw.createLongFormDid({document:o,recoveryKey:a,updateKey:u})})}static constructCreateRequest(e){return Kd(this,arguments,void 0,function*({ionDocument:r,recoveryKey:n,updateKey:s}){return yield Ji.createCreateRequest({document:r,recoveryKey:Jo.normalizeJwk(n),updateKey:Jo.normalizeJwk(s)})})}static createIonDocument(e){return Kd(this,arguments,void 0,function*({services:r,verificationMethods:n}){var s,i;const o=[];for(const l of n){let c=(i=(s=l.id)!==null&&s!==void 0?s:l.publicKeyJwk.kid)!==null&&i!==void 0?i:yield Br({jwk:l.publicKeyJwk});c=`${c.split("#").pop()}`;const d={id:c,publicKeyJwk:Jo.normalizeJwk(l.publicKeyJwk),purposes:l.purposes,type:"JsonWebKey2020"};o.push(d)}const a=r.map(l=>Object.assign(Object.assign({},l),{id:`${l.id.split("#").pop()}`}));return{publicKeys:o,services:a}})}static normalizeJwk(e){const r=e.kty;let n;if(r==="EC")n={crv:e.crv,kty:e.kty,x:e.x,y:e.y};else if(r==="oct")n={k:e.k,kty:e.kty};else if(r==="OKP")n={crv:e.crv,kty:e.kty,x:e.x};else if(r==="RSA")n={e:e.e,kty:e.kty,n:e.n};else throw new Error(`Unsupported key type: ${r}`);return n}}var Xb=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};class jm extends n_{static create(){return Xb(this,arguments,void 0,function*({keyManager:e=new wl,options:r={}}={}){var n,s,i,o;if(r.algorithm&&r.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(r.verificationMethods&&r.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");const a=(o=(n=r.algorithm)!==null&&n!==void 0?n:(i=(s=r.verificationMethods)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.algorithm)!==null&&o!==void 0?o:"Ed25519",u=yield e.generateKey({algorithm:a}),l=yield e.getPublicKey({keyUri:u}),c=Je.object(l).toBase64Url(),d=`did:${jm.methodName}:${c}`,f=(yield jm.resolve(d)).didDocument;return new Qu({uri:d,document:f,metadata:{},keyManager:e})})}static getSigningMethod(e){return Xb(this,arguments,void 0,function*({didDocument:r}){var n;const s=Er.parse(r.id);if(s&&s.method!==this.methodName)throw new at(mt.MethodNotSupported,`Method not supported: ${s.method}`);const[i]=(n=r.verificationMethod)!==null&&n!==void 0?n:[];if(!(i&&i.publicKeyJwk))throw new at(mt.InternalError,"A verification method intended for signing could not be determined from the DID Document");return i})}static import(e){return Xb(this,arguments,void 0,function*({portableDid:r,keyManager:n=new wl}){const s=Er.parse(r.uri);if((s==null?void 0:s.method)!==jm.methodName)throw new at(mt.MethodNotSupported,"Method not supported");const i=yield Qu.import({portableDid:r,keyManager:n});if(i.document.verificationMethod.length!==1)throw new at(mt.InvalidDidDocument,"DID document must contain exactly one verification method");return i})}static resolve(e,r){return Xb(this,void 0,void 0,function*(){const n=Er.parse(e);let s;try{s=Je.base64Url(n.id).toObject()}catch{}if(!n||!s)return Object.assign(Object.assign({},vs),{didResolutionMetadata:{error:"invalidDid"}});if(n.method!==jm.methodName)return Object.assign(Object.assign({},vs),{didResolutionMetadata:{error:"methodNotSupported"}});const i={"@context":["https://www.w3.org/ns/did/v1"],id:n.uri},o=`${i.id}#0`;switch(i.verificationMethod=[{id:o,type:"JsonWebKey",controller:i.id,publicKeyJwk:s}],i.authentication=[o],i.assertionMethod=[o],i.capabilityInvocation=[o],i.capabilityDelegation=[o],i.keyAgreement=[o],s.use){case"sig":{delete i.keyAgreement;break}case"enc":{delete i.authentication,delete i.assertionMethod,delete i.capabilityInvocation,delete i.capabilityDelegation;break}}return Object.assign(Object.assign({},vs),{didDocument:i})})}}jm.methodName="jwk";var Pa=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})},Uc;(function(t){t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.secp256r1="secp256r1",t.X25519="X25519"})(Uc||(Uc={}));const AD={Ed25519VerificationKey2020:"https://w3id.org/security/suites/ed25519-2020/v1",JsonWebKey2020:"https://w3id.org/security/suites/jws-2020/v1",X25519KeyAgreementKey2020:"https://w3id.org/security/suites/x25519-2020/v1"},xxe={Ed25519:Uc.Ed25519,ES256K:Uc.secp256k1,ES256:Uc.secp256r1,"P-256":Uc.secp256r1,secp256k1:Uc.secp256k1,secp256r1:Uc.secp256r1,X25519:Uc.X25519};class gu extends n_{static create(){return Pa(this,arguments,void 0,function*({keyManager:e=new wl,options:r={}}={}){var n,s,i,o;if(r.algorithm&&r.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(r.verificationMethods&&r.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");const a=(o=(n=r.algorithm)!==null&&n!==void 0?n:(i=(s=r.verificationMethods)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.algorithm)!==null&&o!==void 0?o:"Ed25519",u=yield e.generateKey({algorithm:a}),l=yield e.getPublicKey({keyUri:u}),c=yield ei.publicKeyToMultibaseId({publicKey:l}),d=`did:${gu.methodName}:${c}`,f=(yield gu.resolve(d,r)).didDocument;return new Qu({uri:d,document:f,metadata:{},keyManager:e})})}static getSigningMethod(e){return Pa(this,arguments,void 0,function*({didDocument:r}){var n;const s=Er.parse(r.id);if(s&&s.method!==this.methodName)throw new at(mt.MethodNotSupported,`Method not supported: ${s.method}`);const[i]=r.assertionMethod||[],o=(n=r.verificationMethod)===null||n===void 0?void 0:n.find(a=>a.id===i);if(!(o&&o.publicKeyJwk))throw new at(mt.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static import(e){return Pa(this,arguments,void 0,function*({portableDid:r,keyManager:n=new wl}){const s=Er.parse(r.uri);if((s==null?void 0:s.method)!==gu.methodName)throw new at(mt.MethodNotSupported,"Method not supported");const i=yield Qu.import({portableDid:r,keyManager:n});if(i.document.verificationMethod.length!==1)throw new at(mt.InvalidDidDocument,"DID document must contain exactly one verification method");return i})}static resolve(e,r){return Pa(this,void 0,void 0,function*(){try{const n=yield gu.createDocument({didUri:e,options:r});return Object.assign(Object.assign({},vs),{didDocument:n})}catch(n){if(!(n instanceof at))throw new Error(n);return Object.assign(Object.assign({},vs),{didResolutionMetadata:Object.assign({error:n.code},n.message&&{errorMessage:n.message})})}})}static createDocument(e){return Pa(this,arguments,void 0,function*({didUri:r,options:n={}}){const{defaultContext:s="https://www.w3.org/ns/did/v1",enableEncryptionKeyDerivation:i=!1,enableExperimentalPublicKeyTypes:o=!1,publicKeyFormat:a="JsonWebKey2020"}=n,u={id:""},l=Er.parse(r);if(!l)throw new at(mt.InvalidDid,`Invalid DID URI: ${r}`);const c=l.id;if(l.method!==gu.methodName)throw new at(mt.MethodNotSupported,`Method not supported: ${l.method}`);if(!gu.validateIdentifier(l))throw new at(mt.InvalidDid,`Invalid DID URI: ${r}`);const d=yield gu.createSignatureMethod({didUri:r,multibaseValue:c,options:{enableExperimentalPublicKeyTypes:o,publicKeyFormat:a}});if(u.id=l.uri,u.verificationMethod=[d],u.authentication=[d.id],u.assertionMethod=[d.id],u.capabilityInvocation=[d.id],u.capabilityDelegation=[d.id],i===!0){const p=a==="Ed25519VerificationKey2020"?"X25519KeyAgreementKey2020":"JsonWebKey2020",m=yield this.createEncryptionMethod({didUri:r,multibaseValue:c,options:{enableExperimentalPublicKeyTypes:o,publicKeyFormat:p}});u.verificationMethod.push(m),u.keyAgreement=[m.id]}const h=[s];return Axe({didDocument:u}).forEach(p=>{const m=AD[p];h.push(m)}),u["@context"]=h,u})}static createEncryptionMethod(e){return Pa(this,arguments,void 0,function*({didUri:r,multibaseValue:n,options:s}){const{enableExperimentalPublicKeyTypes:i,publicKeyFormat:o}=s,a={id:"",type:"",controller:""},{keyBytes:u,multicodecCode:l}=yield gu.deriveEncryptionKey({multibaseValue:n}),c=u.byteLength,d=ei.MULTICODEC_PUBLIC_KEY_LENGTH[l];if(c!==d)throw new at(mt.InvalidPublicKeyLength,`Expected ${c} bytes. Actual: ${d}`);const h=kH({keyBytes:u,multicodecCode:l});a.id=`${r}#${h}`;try{new URL(a.id)}catch{throw new at(mt.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(o in AD))throw new at(mt.UnsupportedPublicKeyType,`Unsupported format: ${o}`);if(i===!1&&!["Multikey","JsonWebKey2020","X25519KeyAgreementKey2020"].includes(o))throw new at(mt.InvalidPublicKeyType,`Specified '${o}' without setting enableExperimentalPublicKeyTypes to true.`);if(a.type=o,a.controller=r,o==="X25519KeyAgreementKey2020"&&(a.publicKeyMultibase=h),o==="JsonWebKey2020"){const{crv:p}=yield ei.multicodecToJwk({code:l});a.publicKeyJwk=yield ei.keyConverter(p).bytesToPublicKey({publicKeyBytes:u})}return a})}static createSignatureMethod(e){return Pa(this,arguments,void 0,function*({didUri:r,multibaseValue:n,options:s}){const{enableExperimentalPublicKeyTypes:i,publicKeyFormat:o}=s,a={id:"",type:"",controller:""},{keyBytes:u,multicodecCode:l,multicodecName:c}=y8({multibaseKeyId:n}),d=u.byteLength,h=ei.MULTICODEC_PUBLIC_KEY_LENGTH[l];if(d!==h)throw new at(mt.InvalidPublicKeyLength,`Expected ${d} bytes. Actual: ${h}`);let f=!1;switch(c){case"secp256k1-pub":f=yield fn.validatePublicKey({publicKeyBytes:u});break;case"ed25519-pub":f=yield gn.validatePublicKey({publicKeyBytes:u});break;case"x25519-pub":f=!0;break}if(!f)throw new at(mt.InvalidPublicKey,"Invalid public key detected.");a.id=`${r}#${n}`;try{new URL(a.id)}catch{throw new at(mt.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(o in AD))throw new at(mt.UnsupportedPublicKeyType,`Unsupported format: ${o}`);if(i===!1&&!["Multikey","JsonWebKey2020","Ed25519VerificationKey2020"].includes(o))throw new at(mt.InvalidPublicKeyType,`Specified '${o}' without setting enableExperimentalPublicKeyTypes to true.`);if(a.type=o,a.controller=r,o==="Ed25519VerificationKey2020"&&(a.publicKeyMultibase=n),o==="JsonWebKey2020"){const{crv:m}=yield ei.multicodecToJwk({code:l});a.publicKeyJwk=yield ei.keyConverter(m).bytesToPublicKey({publicKeyBytes:u})}return a})}static deriveEncryptionKey(e){return Pa(this,arguments,void 0,function*({multibaseValue:r}){let n={keyBytes:new Uint8Array,multicodecCode:0};const{keyBytes:s,multicodecCode:i}=y8({multibaseKeyId:r});if(i===237){const o=yield ei.keyConverter("Ed25519").bytesToPublicKey({publicKeyBytes:s}),a=yield gn.convertPublicKeyToX25519({publicKey:o});n={keyBytes:yield ei.keyConverter("Ed25519").publicKeyToBytes({publicKey:a}),multicodecCode:236}}return n})}static validateIdentifier(e){const{method:r,id:n}=e,[s]=e.uri.split(":",1);return s==="did"&&r==="key"&&Number("1")>0&&HP(n)==="String"&&n.startsWith("z")}}gu.methodName="key";class ei{static jwkToMulticodec(e){return Pa(this,arguments,void 0,function*({jwk:r}){const n=[];r.crv&&(n.push(r.crv),r.d?n.push("private"):n.push("public"));const s=n.join(":"),i=ei.JWK_TO_MULTICODEC[s];if(i===void 0)throw new Error(`Unsupported JWK to Multicodec conversion: '${s}'`);return{code:$n.getCodeFromName({name:i}),name:i}})}static keyCompressor(e){const n={"P-256":yn.compressPublicKey,secp256k1:fn.compressPublicKey}[e];if(!n)throw new at(mt.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static keyConverter(e){const n={Ed25519:gn,"P-256":yn,secp256k1:fn,X25519:Lh}[e];if(!n)throw new at(mt.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static multicodecToJwk(e){return Pa(this,arguments,void 0,function*({code:r,name:n}){if(!(n?!r:r))throw new Error("Either 'name' or 'code' must be defined, but not both.");n=n===void 0?$n.getNameFromCode({code:r}):n;const s=n,i=ei.MULTICODEC_TO_JWK[s];if(i===void 0)throw new Error("Unsupported Multicodec to JWK conversion");return Object.assign({},i)})}static publicKeyToMultibaseId(e){return Pa(this,arguments,void 0,function*({publicKey:r}){var n;if(!(r!=null&&r.crv&&r.crv in xxe))throw new at(mt.InvalidPublicKeyType,`Public key contains an unsupported key type: ${(n=r==null?void 0:r.crv)!==null&&n!==void 0?n:"undefined"}`);let s=yield ei.keyConverter(r.crv).publicKeyToBytes({publicKey:r});/^(secp256k1|P-256|P-384|P-521)$/.test(r.crv)&&(s=yield ei.keyCompressor(r.crv)({publicKeyBytes:s}));const{name:i}=yield ei.jwkToMulticodec({jwk:r});return kH({keyBytes:s,multicodecName:i})})}}ei.JWK_TO_MULTICODEC={"Ed25519:public":"ed25519-pub","Ed25519:private":"ed25519-priv","secp256k1:public":"secp256k1-pub","secp256k1:private":"secp256k1-priv","X25519:public":"x25519-pub","X25519:private":"x25519-priv"};ei.MULTICODEC_PUBLIC_KEY_LENGTH={231:33,236:32,237:32};ei.MULTICODEC_TO_JWK={"ed25519-pub":{crv:"Ed25519",kty:"OKP",x:""},"ed25519-priv":{crv:"Ed25519",kty:"OKP",x:"",d:""},"secp256k1-pub":{crv:"secp256k1",kty:"EC",x:"",y:""},"secp256k1-priv":{crv:"secp256k1",kty:"EC",x:"",y:"",d:""},"x25519-pub":{crv:"X25519",kty:"OKP",x:""},"x25519-priv":{crv:"X25519",kty:"OKP",x:"",d:""}};var Pxe=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(c){try{l(n.next(c))}catch(d){o(d)}}function u(c){try{l(n.throw(c))}catch(d){o(d)}}function l(c){c.done?i(c.value):s(c.value).then(a,u)}l((n=n.apply(t,e||[])).next())})};class W$ extends n_{static resolve(e,r){return Pxe(this,void 0,void 0,function*(){const n=Er.parse(e);if(!n)return Object.assign(Object.assign({},vs),{didResolutionMetadata:{error:"invalidDid"}});if(n.method!==W$.methodName)return Object.assign(Object.assign({},vs),{didResolutionMetadata:{error:"methodNotSupported"}});let s=`https://${n.id.replace(/:/g,"/")}`;s=decodeURIComponent(s);const i=n.id.includes(":")?`${s}/did.json`:`${s}/.well-known/did.json`;try{const o=yield fetch(i);if(!o.ok)throw new Error("HTTP error status code returned");const a=yield o.json();return Object.assign(Object.assign({},vs),{didDocument:a})}catch{return Object.assign(Object.assign({},vs),{didResolutionMetadata:{error:"notFound"}})}})}}W$.methodName="web";var E8={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OH=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},Cxe=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],o=t[r++],a=t[r++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const i=t[r++],o=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},RH={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,u=s+2<t.length,l=u?t[s+2]:0,c=i>>2,d=(i&3)<<4|a>>4;let h=(a&15)<<2|l>>6,f=l&63;u||(f=64,o||(h=64)),n.push(r[c],r[d],r[h],r[f])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(OH(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Cxe(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],a=s<t.length?r[t.charAt(s)]:0;++s;const l=s<t.length?r[t.charAt(s)]:64;++s;const d=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||a==null||l==null||d==null)throw new Ixe;const h=i<<2|a>>4;if(n.push(h),l!==64){const f=a<<4&240|l>>2;if(n.push(f),d!==64){const p=l<<6&192|d;n.push(p)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Ixe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const kxe=function(t){const e=OH(t);return RH.encodeByteArray(e,!0)},cA=function(t){return kxe(t).replace(/\./g,"")},NH=function(t){try{return RH.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $xe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oxe=()=>$xe().__FIREBASE_DEFAULTS__,Rxe=()=>{if(typeof process>"u"||typeof E8>"u")return;const t=E8.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Nxe=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&NH(t[1]);return e&&JSON.parse(e)},MS=()=>{try{return Oxe()||Rxe()||Nxe()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},BH=t=>{var e,r;return(r=(e=MS())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},Bxe=t=>{const e=BH(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},FH=()=>{var t;return(t=MS())===null||t===void 0?void 0:t.config},MH=t=>{var e;return(e=MS())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fxe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mxe(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[cA(JSON.stringify(r)),cA(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ts(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function jxe(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ts())}function Uxe(){var t;const e=(t=MS())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(globalThis.process)==="[object process]"}catch{return!1}}function jH(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Lxe(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Kxe(){const t=ts();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Vxe(){return!Uxe()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function UH(){try{return typeof indexedDB=="object"}catch{return!1}}function LH(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(r){e(r)}})}function qxe(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hxe="FirebaseError";class Ja extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=Hxe,Object.setPrototypeOf(this,Ja.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Up.prototype.create)}}class Up{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?zxe(i,n):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Ja(s,a,n)}}function zxe(t,e){return t.replace(Wxe,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const Wxe=/\{\$([^}]+)}/g;function Gxe(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function hw(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],o=e[s];if(A8(i)&&A8(o)){if(!hw(i,o))return!1}else if(i!==o)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function A8(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i_(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function K0(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,i]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function V0(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function Jxe(t,e){const r=new Xxe(t,e);return r.subscribe.bind(r)}class Xxe{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");Yxe(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=SD),s.error===void 0&&(s.error=SD),s.complete===void 0&&(s.complete=SD);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Yxe(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function SD(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zxe=1e3,Qxe=2,ePe=4*60*60*1e3,tPe=.5;function S8(t,e=Zxe,r=Qxe){const n=e*Math.pow(r,t),s=Math.round(tPe*n*(Math.random()-.5)*2);return Math.min(ePe,n+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qs(t){return t&&t._delegate?t._delegate:t}class Wa{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sh="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rPe{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new Fxe;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(iPe(e))try{this.getOrInitializeService({instanceIdentifier:Sh})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=Sh){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Sh){return this.instances.has(e)}getOptions(e=Sh){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);n===a&&o.resolve(s)}return s}onInit(e,r){var n;const s=this.normalizeInstanceIdentifier(r),i=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:nPe(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Sh){return this.component?this.component.multipleInstances?e:Sh:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function nPe(t){return t===Sh?void 0:t}function iPe(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sPe{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new rPe(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ar;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ar||(ar={}));const oPe={debug:ar.DEBUG,verbose:ar.VERBOSE,info:ar.INFO,warn:ar.WARN,error:ar.ERROR,silent:ar.SILENT},aPe=ar.INFO,uPe={[ar.DEBUG]:"log",[ar.VERBOSE]:"log",[ar.INFO]:"info",[ar.WARN]:"warn",[ar.ERROR]:"error"},cPe=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=uPe[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class jS{constructor(e){this.name=e,this._logLevel=aPe,this._logHandler=cPe,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ar))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?oPe[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ar.DEBUG,...e),this._logHandler(this,ar.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ar.VERBOSE,...e),this._logHandler(this,ar.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ar.INFO,...e),this._logHandler(this,ar.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ar.WARN,...e),this._logHandler(this,ar.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ar.ERROR,...e),this._logHandler(this,ar.ERROR,...e)}}const lPe=(t,e)=>e.some(r=>t instanceof r);let T8,D8;function dPe(){return T8||(T8=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function fPe(){return D8||(D8=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const KH=new WeakMap,XP=new WeakMap,VH=new WeakMap,TD=new WeakMap,G$=new WeakMap;function hPe(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{r(af(t.result)),s()},o=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&KH.set(r,t)}).catch(()=>{}),G$.set(e,t),e}function pPe(t){if(XP.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{r(),s()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});XP.set(t,e)}let YP={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return XP.get(t);if(e==="objectStoreNames")return t.objectStoreNames||VH.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return af(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function mPe(t){YP=t(YP)}function yPe(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(DD(this),e,...r);return VH.set(n,e.sort?e.sort():[e]),af(n)}:fPe().includes(t)?function(...e){return t.apply(DD(this),e),af(KH.get(this))}:function(...e){return af(t.apply(DD(this),e))}}function gPe(t){return typeof t=="function"?yPe(t):(t instanceof IDBTransaction&&pPe(t),lPe(t,dPe())?new Proxy(t,YP):t)}function af(t){if(t instanceof IDBRequest)return hPe(t);if(TD.has(t))return TD.get(t);const e=gPe(t);return e!==t&&(TD.set(t,e),G$.set(e,t)),e}const DD=t=>G$.get(t);function qH(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=af(o);return n&&o.addEventListener("upgradeneeded",u=>{n(af(o.result),u.oldVersion,u.newVersion,af(o.transaction),u)}),r&&o.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),a.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",l=>s(l.oldVersion,l.newVersion,l))}).catch(()=>{}),a}const vPe=["get","getKey","getAll","getAllKeys","count"],wPe=["put","add","delete","clear"],xD=new Map;function x8(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(xD.get(e))return xD.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=wPe.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||vPe.includes(r)))return;const i=async function(o,...a){const u=this.transaction(o,s?"readwrite":"readonly");let l=u.store;return n&&(l=l.index(a.shift())),(await Promise.all([l[r](...a),s&&u.done]))[0]};return xD.set(e,i),i}mPe(t=>({...t,get:(e,r,n)=>x8(e,r)||t.get(e,r,n),has:(e,r)=>!!x8(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _Pe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(bPe(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function bPe(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const ZP="@firebase/app",P8="0.10.10";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _l=new jS("@firebase/app"),EPe="@firebase/app-compat",APe="@firebase/analytics-compat",SPe="@firebase/analytics",TPe="@firebase/app-check-compat",DPe="@firebase/app-check",xPe="@firebase/auth",PPe="@firebase/auth-compat",CPe="@firebase/database",IPe="@firebase/database-compat",kPe="@firebase/functions",$Pe="@firebase/functions-compat",OPe="@firebase/installations",RPe="@firebase/installations-compat",NPe="@firebase/messaging",BPe="@firebase/messaging-compat",FPe="@firebase/performance",MPe="@firebase/performance-compat",jPe="@firebase/remote-config",UPe="@firebase/remote-config-compat",LPe="@firebase/storage",KPe="@firebase/storage-compat",VPe="@firebase/firestore",qPe="@firebase/vertexai-preview",HPe="@firebase/firestore-compat",zPe="firebase",WPe="10.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QP="[DEFAULT]",GPe={[ZP]:"fire-core",[EPe]:"fire-core-compat",[SPe]:"fire-analytics",[APe]:"fire-analytics-compat",[DPe]:"fire-app-check",[TPe]:"fire-app-check-compat",[xPe]:"fire-auth",[PPe]:"fire-auth-compat",[CPe]:"fire-rtdb",[IPe]:"fire-rtdb-compat",[kPe]:"fire-fn",[$Pe]:"fire-fn-compat",[OPe]:"fire-iid",[RPe]:"fire-iid-compat",[NPe]:"fire-fcm",[BPe]:"fire-fcm-compat",[FPe]:"fire-perf",[MPe]:"fire-perf-compat",[jPe]:"fire-rc",[UPe]:"fire-rc-compat",[LPe]:"fire-gcs",[KPe]:"fire-gcs-compat",[VPe]:"fire-fst",[HPe]:"fire-fst-compat",[qPe]:"fire-vertex","fire-js":"fire-js",[zPe]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lA=new Map,JPe=new Map,eC=new Map;function C8(t,e){try{t.container.addComponent(e)}catch(r){_l.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function ec(t){const e=t.name;if(eC.has(e))return _l.debug(`There were multiple attempts to register component ${e}.`),!1;eC.set(e,t);for(const r of lA.values())C8(r,t);for(const r of JPe.values())C8(r,t);return!0}function Lp(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Ru(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XPe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},uf=new Up("app","Firebase",XPe);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YPe{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Wa("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw uf.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rg=WPe;function HH(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:QP,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw uf.create("bad-app-name",{appName:String(s)});if(r||(r=FH()),!r)throw uf.create("no-options");const i=lA.get(s);if(i){if(hw(r,i.options)&&hw(n,i.config))return i;throw uf.create("duplicate-app",{appName:s})}const o=new sPe(s);for(const u of eC.values())o.addComponent(u);const a=new YPe(r,n,o);return lA.set(s,a),a}function J$(t=QP){const e=lA.get(t);if(!e&&t===QP&&FH())return HH();if(!e)throw uf.create("no-app",{appName:t});return e}function sa(t,e,r){var n;let s=(n=GPe[t])!==null&&n!==void 0?n:t;r&&(s+=`-${r}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),_l.warn(a.join(" "));return}ec(new Wa(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZPe="firebase-heartbeat-database",QPe=1,pw="firebase-heartbeat-store";let PD=null;function zH(){return PD||(PD=qH(ZPe,QPe,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(pw)}catch(r){console.warn(r)}}}}).catch(t=>{throw uf.create("idb-open",{originalErrorMessage:t.message})})),PD}async function eCe(t){try{const r=(await zH()).transaction(pw),n=await r.objectStore(pw).get(WH(t));return await r.done,n}catch(e){if(e instanceof Ja)_l.warn(e.message);else{const r=uf.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});_l.warn(r.message)}}}async function I8(t,e){try{const n=(await zH()).transaction(pw,"readwrite");await n.objectStore(pw).put(e,WH(t)),await n.done}catch(r){if(r instanceof Ja)_l.warn(r.message);else{const n=uf.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});_l.warn(n.message)}}}function WH(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tCe=1024,rCe=30*24*60*60*1e3;class nCe{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new sCe(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=k8();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=rCe}),this._storage.overwrite(this._heartbeatsCache))}catch(n){_l.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=k8(),{heartbeatsToSend:n,unsentEntries:s}=iCe(this._heartbeatsCache.heartbeats),i=cA(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return _l.warn(r),""}}}function k8(){return new Date().toISOString().substring(0,10)}function iCe(t,e=tCe){const r=[];let n=t.slice();for(const s of t){const i=r.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),$8(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),$8(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class sCe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return UH()?LH().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await eCe(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return I8(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return I8(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function $8(t){return cA(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oCe(t){ec(new Wa("platform-logger",e=>new _Pe(e),"PRIVATE")),ec(new Wa("heartbeat",e=>new nCe(e),"PRIVATE")),sa(ZP,P8,t),sa(ZP,P8,"esm2017"),sa("fire-js","")}oCe("");function X$(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function GH(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const aCe=GH,JH=new Up("auth","Firebase",GH());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dA=new jS("@firebase/auth");function uCe(t,...e){dA.logLevel<=ar.WARN&&dA.warn(`Auth (${rg}): ${t}`,...e)}function G1(t,...e){dA.logLevel<=ar.ERROR&&dA.error(`Auth (${rg}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fa(t,...e){throw Z$(t,...e)}function La(t,...e){return Z$(t,...e)}function Y$(t,e,r){const n=Object.assign(Object.assign({},aCe()),{[e]:r});return new Up("auth","Firebase",n).create(e,{appName:t.name})}function cf(t){return Y$(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function cCe(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&fa(t,"argument-error"),Y$(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Z$(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return JH.create(t,...e)}function xt(t,e,...r){if(!t)throw Z$(e,...r)}function nl(t){const e="INTERNAL ASSERTION FAILED: "+t;throw G1(e),new Error(e)}function bl(t,e){t||nl(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tC(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function lCe(){return O8()==="http:"||O8()==="https:"}function O8(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dCe(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(lCe()||jH()||"connection"in navigator)?navigator.onLine:!0}function fCe(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_{constructor(e,r){this.shortDelay=e,this.longDelay=r,bl(r>e,"Short delay should be less than long delay!"),this.isMobile=jxe()||Lxe()}get(){return dCe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q$(t,e){bl(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XH{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;nl("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;nl("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;nl("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hCe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pCe=new s_(3e4,6e4);function Kp(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Nf(t,e,r,n,s={}){return YH(t,s,async()=>{let i={},o={};n&&(e==="GET"?o=n:i={body:JSON.stringify(n)});const a=i_(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();return u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode),XH.fetch()(ZH(t,t.config.apiHost,r,a),Object.assign({method:e,headers:u,referrerPolicy:"no-referrer"},i))})}async function YH(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},hCe),e);try{const s=new yCe(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Yb(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[u,l]=a.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Yb(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Yb(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw Yb(t,"user-disabled",o);const c=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw Y$(t,c,l);fa(t,c)}}catch(s){if(s instanceof Ja)throw s;fa(t,"network-request-failed",{message:String(s)})}}async function US(t,e,r,n,s={}){const i=await Nf(t,e,r,n,s);return"mfaPendingCredential"in i&&fa(t,"multi-factor-auth-required",{_serverResponse:i}),i}function ZH(t,e,r,n){const s=`${e}${r}?${n}`;return t.config.emulator?Q$(t.config,s):`${t.config.apiScheme}://${s}`}function mCe(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class yCe{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(La(this.auth,"network-request-failed")),pCe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Yb(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=La(t,e,n);return s.customData._tokenResponse=r,s}function R8(t){return t!==void 0&&t.enterprise!==void 0}class gCe{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return mCe(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function vCe(t,e){return Nf(t,"GET","/v2/recaptchaConfig",Kp(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wCe(t,e){return Nf(t,"POST","/v1/accounts:delete",e)}async function QH(t,e){return Nf(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ev(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function _Ce(t,e=!1){const r=qs(t),n=await r.getIdToken(e),s=eO(n);xt(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:Ev(CD(s.auth_time)),issuedAtTime:Ev(CD(s.iat)),expirationTime:Ev(CD(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function CD(t){return Number(t)*1e3}function eO(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return G1("JWT malformed, contained fewer than 3 sections"),null;try{const s=NH(r);return s?JSON.parse(s):(G1("Failed to decode base64 JWT payload"),null)}catch(s){return G1("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function N8(t){const e=eO(t);return xt(e,"internal-error"),xt(typeof e.exp<"u","internal-error"),xt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mw(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Ja&&bCe(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function bCe({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ECe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ev(this.lastLoginAt),this.creationTime=Ev(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fA(t){var e;const r=t.auth,n=await t.getIdToken(),s=await mw(t,QH(r,{idToken:n}));xt(s==null?void 0:s.users.length,r,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?ez(i.providerUserInfo):[],a=SCe(t.providerData,o),u=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),c=u?l:!1,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new rC(i.createdAt,i.lastLoginAt),isAnonymous:c};Object.assign(t,d)}async function ACe(t){const e=qs(t);await fA(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function SCe(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function ez(t){return t.map(e=>{var{providerId:r}=e,n=X$(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TCe(t,e){const r=await YH(t,{},async()=>{const n=i_({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=ZH(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",XH.fetch()(o,{method:"POST",headers:a,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function DCe(t,e){return Nf(t,"POST","/v2/accounts:revokeToken",Kp(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){xt(e.idToken,"internal-error"),xt(typeof e.idToken<"u","internal-error"),xt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):N8(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){xt(e.length!==0,"internal-error");const r=N8(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(xt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await TCe(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,o=new ny;return n&&(xt(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),s&&(xt(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(xt(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ny,this.toJSON())}_performRefresh(){return nl("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fd(t,e){xt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class il{constructor(e){var{uid:r,auth:n,stsTokenManager:s}=e,i=X$(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ECe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new rC(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await mw(this,this.stsTokenManager.getToken(this.auth,e));return xt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return _Ce(this,e)}reload(){return ACe(this)}_assign(e){this!==e&&(xt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new il(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){xt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await fA(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ru(this.auth.app))return Promise.reject(cf(this.auth));const e=await this.getIdToken();return await mw(this,wCe(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,s,i,o,a,u,l,c;const d=(n=r.displayName)!==null&&n!==void 0?n:void 0,h=(s=r.email)!==null&&s!==void 0?s:void 0,f=(i=r.phoneNumber)!==null&&i!==void 0?i:void 0,p=(o=r.photoURL)!==null&&o!==void 0?o:void 0,m=(a=r.tenantId)!==null&&a!==void 0?a:void 0,E=(u=r._redirectEventId)!==null&&u!==void 0?u:void 0,A=(l=r.createdAt)!==null&&l!==void 0?l:void 0,_=(c=r.lastLoginAt)!==null&&c!==void 0?c:void 0,{uid:g,emailVerified:v,isAnonymous:S,providerData:x,stsTokenManager:D}=r;xt(g&&D,e,"internal-error");const w=ny.fromJSON(this.name,D);xt(typeof g=="string",e,"internal-error"),fd(d,e.name),fd(h,e.name),xt(typeof v=="boolean",e,"internal-error"),xt(typeof S=="boolean",e,"internal-error"),fd(f,e.name),fd(p,e.name),fd(m,e.name),fd(E,e.name),fd(A,e.name),fd(_,e.name);const b=new il({uid:g,auth:e,email:h,emailVerified:v,displayName:d,isAnonymous:S,photoURL:p,phoneNumber:f,tenantId:m,stsTokenManager:w,createdAt:A,lastLoginAt:_});return x&&Array.isArray(x)&&(b.providerData=x.map(T=>Object.assign({},T))),E&&(b._redirectEventId=E),b}static async _fromIdTokenResponse(e,r,n=!1){const s=new ny;s.updateFromServerResponse(r);const i=new il({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await fA(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];xt(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?ez(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new ny;a.updateFromIdToken(n);const u=new il({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),l={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new rC(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,l),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B8=new Map;function sl(t){bl(t instanceof Function,"Expected a class definition");let e=B8.get(t);return e?(bl(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,B8.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tz{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}tz.type="NONE";const F8=tz;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J1(t,e,r){return`firebase:${t}:${e}:${r}`}class iy{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=J1(this.userKey,s.apiKey,i),this.fullPersistenceKey=J1("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?il._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new iy(sl(F8),e,n);const s=(await Promise.all(r.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let i=s[0]||sl(F8);const o=J1(n,e.config.apiKey,e.name);let a=null;for(const l of r)try{const c=await l._get(o);if(c){const d=il._fromJSON(e,c);l!==i&&(a=d),i=l;break}}catch{}const u=s.filter(l=>l._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new iy(i,e,n):(i=u[0],a&&await i._set(o,a.toJSON()),await Promise.all(r.map(async l=>{if(l!==i)try{await l._remove(o)}catch{}})),new iy(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M8(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(sz(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(rz(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(az(e))return"Blackberry";if(uz(e))return"Webos";if(nz(e))return"Safari";if((e.includes("chrome/")||iz(e))&&!e.includes("edge/"))return"Chrome";if(oz(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function rz(t=ts()){return/firefox\//i.test(t)}function nz(t=ts()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function iz(t=ts()){return/crios\//i.test(t)}function sz(t=ts()){return/iemobile/i.test(t)}function oz(t=ts()){return/android/i.test(t)}function az(t=ts()){return/blackberry/i.test(t)}function uz(t=ts()){return/webos/i.test(t)}function tO(t=ts()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function xCe(t=ts()){var e;return tO(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function PCe(){return Kxe()&&document.documentMode===10}function cz(t=ts()){return tO(t)||oz(t)||uz(t)||az(t)||/windows phone/i.test(t)||sz(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lz(t,e=[]){let r;switch(t){case"Browser":r=M8(ts());break;case"Worker":r=`${M8(ts())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${rg}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CCe{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((o,a)=>{try{const u=e(i);o(u)}catch(u){a(u)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ICe(t,e={}){return Nf(t,"GET","/v2/passwordPolicy",Kp(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kCe=6;class $Ce{constructor(e){var r,n,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=o.minPasswordLength)!==null&&r!==void 0?r:kCe,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,s,i,o,a;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(r=u.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(n=u.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(a=u.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),u}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OCe{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new j8(this),this.idTokenSubscription=new j8(this),this.beforeStateQueue=new CCe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=JH,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=sl(r)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await iy.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await QH(this,{idToken:e}),n=await il._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Ru(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,a=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===a)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return xt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await fA(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=fCe()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ru(this.app))return Promise.reject(cf(this));const r=e?qs(e):null;return r&&xt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&xt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ru(this.app)?Promise.reject(cf(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ru(this.app)?Promise.reject(cf(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(sl(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await ICe(this),r=new $Ce(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Up("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await DCe(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&sl(e)||this._popupRedirectResolver;xt(r,this,"argument-error"),this.redirectPersistenceManager=await iy.create(this,[sl(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(xt(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof r=="function"){const u=e.addObserver(r,n,s);return()=>{o=!0,u()}}else{const u=e.addObserver(r);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return xt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=lz(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&uCe(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Vp(t){return qs(t)}class j8{constructor(e){this.auth=e,this.observer=null,this.addObserver=Jxe(r=>this.observer=r)}get next(){return xt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let LS={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function RCe(t){LS=t}function dz(t){return LS.loadJS(t)}function NCe(){return LS.recaptchaEnterpriseScript}function BCe(){return LS.gapiScript}function FCe(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const MCe="recaptcha-enterprise",jCe="NO_RECAPTCHA";class UCe{constructor(e){this.type=MCe,this.auth=Vp(e)}async verify(e="verify",r=!1){async function n(i){if(!r){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{vCe(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const l=new gCe(u);return i.tenantId==null?i._agentRecaptchaConfig=l:i._tenantRecaptchaConfigs[i.tenantId]=l,o(l.siteKey)}}).catch(u=>{a(u)})})}function s(i,o,a){const u=window.grecaptcha;R8(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(l=>{o(l)}).catch(()=>{o(jCe)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{n(this.auth).then(a=>{if(!r&&R8(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=NCe();u.length!==0&&(u+=a),dz(u).then(()=>{s(a,i,o)}).catch(l=>{o(l)})}}).catch(a=>{o(a)})})}}async function U8(t,e,r,n=!1){const s=new UCe(t);let i;try{i=await s.verify(r)}catch{i=await s.verify(r,!0)}const o=Object.assign({},e);return n?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function L8(t,e,r,n){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await U8(t,e,r,r==="getOobCode");return n(t,i)}else return n(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await U8(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LCe(t,e){const r=Lp(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(hw(i,e??{}))return s;fa(s,"already-initialized")}return r.initialize({options:e})}function KCe(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(sl);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function VCe(t,e,r){const n=Vp(t);xt(n._canInitEmulator,n,"emulator-config-failed"),xt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,i=fz(e),{host:o,port:a}=qCe(e),u=a===null?"":`:${a}`;n.config.emulator={url:`${i}//${o}${u}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),HCe()}function fz(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function qCe(t){const e=fz(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:K8(n.substr(i.length+1))}}else{const[i,o]=n.split(":");return{host:i,port:K8(o)}}}function K8(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function HCe(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return nl("not implemented")}_getIdTokenResponse(e){return nl("not implemented")}_linkToIdToken(e,r){return nl("not implemented")}_getReauthenticationResolver(e){return nl("not implemented")}}async function zCe(t,e){return Nf(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WCe(t,e){return US(t,"POST","/v1/accounts:signInWithPassword",Kp(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GCe(t,e){return US(t,"POST","/v1/accounts:signInWithEmailLink",Kp(t,e))}async function JCe(t,e){return US(t,"POST","/v1/accounts:signInWithEmailLink",Kp(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw extends rO{constructor(e,r,n,s=null){super("password",n),this._email=e,this._password=r,this._tenantId=s}static _fromEmailAndPassword(e,r){return new yw(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new yw(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return L8(e,r,"signInWithPassword",WCe);case"emailLink":return GCe(e,{email:this._email,oobCode:this._password});default:fa(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return L8(e,n,"signUpPassword",zCe);case"emailLink":return JCe(e,{idToken:r,email:this._email,oobCode:this._password});default:fa(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sy(t,e){return US(t,"POST","/v1/accounts:signInWithIdp",Kp(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XCe="http://localhost";class Dp extends rO{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Dp(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):fa("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s}=r,i=X$(r,["providerId","signInMethod"]);if(!n||!s)return null;const o=new Dp(n,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return sy(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,sy(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,sy(e,r)}buildRequest(){const e={requestUri:XCe,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=i_(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YCe(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function ZCe(t){const e=K0(V0(t)).link,r=e?K0(V0(e)).deep_link_id:null,n=K0(V0(t)).deep_link_id;return(n?K0(V0(n)).link:null)||n||r||e||t}class nO{constructor(e){var r,n,s,i,o,a;const u=K0(V0(e)),l=(r=u.apiKey)!==null&&r!==void 0?r:null,c=(n=u.oobCode)!==null&&n!==void 0?n:null,d=YCe((s=u.mode)!==null&&s!==void 0?s:null);xt(l&&c&&d,"argument-error"),this.apiKey=l,this.operation=d,this.code=c,this.continueUrl=(i=u.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=u.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=u.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const r=ZCe(e);try{return new nO(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(){this.providerId=ng.PROVIDER_ID}static credential(e,r){return yw._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=nO.parseLink(r);return xt(n,"argument-error"),yw._fromEmailAndCode(e,n.code,n.tenantId)}}ng.PROVIDER_ID="password";ng.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ng.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iO{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o_ extends iO{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vd extends o_{constructor(){super("facebook.com")}static credential(e){return Dp._fromParams({providerId:Vd.PROVIDER_ID,signInMethod:Vd.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Vd.credentialFromTaggedObject(e)}static credentialFromError(e){return Vd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Vd.credential(e.oauthAccessToken)}catch{return null}}}Vd.FACEBOOK_SIGN_IN_METHOD="facebook.com";Vd.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qd extends o_{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Dp._fromParams({providerId:qd.PROVIDER_ID,signInMethod:qd.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return qd.credentialFromTaggedObject(e)}static credentialFromError(e){return qd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return qd.credential(r,n)}catch{return null}}}qd.GOOGLE_SIGN_IN_METHOD="google.com";qd.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hd extends o_{constructor(){super("github.com")}static credential(e){return Dp._fromParams({providerId:Hd.PROVIDER_ID,signInMethod:Hd.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Hd.credentialFromTaggedObject(e)}static credentialFromError(e){return Hd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Hd.credential(e.oauthAccessToken)}catch{return null}}}Hd.GITHUB_SIGN_IN_METHOD="github.com";Hd.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd extends o_{constructor(){super("twitter.com")}static credential(e,r){return Dp._fromParams({providerId:zd.PROVIDER_ID,signInMethod:zd.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return zd.credentialFromTaggedObject(e)}static credentialFromError(e){return zd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return zd.credential(r,n)}catch{return null}}}zd.TWITTER_SIGN_IN_METHOD="twitter.com";zd.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iy{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await il._fromIdTokenResponse(e,n,s),o=V8(n);return new Iy({user:i,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=V8(n);return new Iy({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function V8(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hA extends Ja{constructor(e,r,n,s){var i;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,hA.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new hA(e,r,n,s)}}function hz(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?hA._fromErrorAndOperation(t,i,e,n):i})}async function QCe(t,e,r=!1){const n=await mw(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Iy._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eIe(t,e,r=!1){const{auth:n}=t;if(Ru(n.app))return Promise.reject(cf(n));const s="reauthenticate";try{const i=await mw(t,hz(n,s,e,t),r);xt(i.idToken,n,"internal-error");const o=eO(i.idToken);xt(o,n,"internal-error");const{sub:a}=o;return xt(t.uid===a,n,"user-mismatch"),Iy._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&fa(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pz(t,e,r=!1){if(Ru(t.app))return Promise.reject(cf(t));const n="signIn",s=await hz(t,n,e),i=await Iy._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}async function tIe(t,e){return pz(Vp(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rIe(t){const e=Vp(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function tFe(t,e,r){return Ru(t.app)?Promise.reject(cf(t)):tIe(qs(t),ng.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&rIe(t),n})}function nIe(t,e,r,n){return qs(t).onIdTokenChanged(e,r,n)}function iIe(t,e,r){return qs(t).beforeAuthStateChanged(e,r)}function sIe(t,e,r,n){return qs(t).onAuthStateChanged(e,r,n)}const pA="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mz{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(pA,"1"),this.storage.removeItem(pA),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oIe=1e3,aIe=10;class yz extends mz{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=cz(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,a,u)=>{this.notifyListeners(o,u)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},i=this.storage.getItem(n);PCe()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,aIe):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},oIe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}yz.type="LOCAL";const uIe=yz;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gz extends mz{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}gz.type="SESSION";const vz=gz;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cIe(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new KS(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const a=Array.from(o).map(async l=>l(r.origin,i)),u=await cIe(a);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:u})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}KS.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sO(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lIe{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,u)=>{const l=sO("",20);s.port1.start();const c=setTimeout(()=>{u(new Error("unsupported_event"))},n);o={messageChannel:s,onMessage(d){const h=d;if(h.data.eventId===l)switch(h.data.status){case"ack":clearTimeout(c),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(h.data.response);break;default:clearTimeout(c),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:r},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vu(){return window}function dIe(t){Vu().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wz(){return typeof Vu().WorkerGlobalScope<"u"&&typeof Vu().importScripts=="function"}async function fIe(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function hIe(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function pIe(){return wz()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _z="firebaseLocalStorageDb",mIe=1,mA="firebaseLocalStorage",bz="fbase_key";class a_{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function VS(t,e){return t.transaction([mA],e?"readwrite":"readonly").objectStore(mA)}function yIe(){const t=indexedDB.deleteDatabase(_z);return new a_(t).toPromise()}function nC(){const t=indexedDB.open(_z,mIe);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(mA,{keyPath:bz})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(mA)?e(n):(n.close(),await yIe(),e(await nC()))})})}async function q8(t,e,r){const n=VS(t,!0).put({[bz]:e,value:r});return new a_(n).toPromise()}async function gIe(t,e){const r=VS(t,!1).get(e),n=await new a_(r).toPromise();return n===void 0?null:n.value}function H8(t,e){const r=VS(t,!0).delete(e);return new a_(r).toPromise()}const vIe=800,wIe=3;class Ez{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await nC(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>wIe)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return wz()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=KS._getInstance(pIe()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await fIe(),!this.activeServiceWorker)return;this.sender=new lIe(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||hIe()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await nC();return await q8(e,pA,"1"),await H8(e,pA),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>q8(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>gIe(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>H8(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=VS(s,!1).getAll();return new a_(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),vIe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Ez.type="LOCAL";const _Ie=Ez;new s_(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Az(t,e){return e?sl(e):(xt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oO extends rO{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return sy(e,this._buildIdpRequest())}_linkToIdToken(e,r){return sy(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return sy(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function bIe(t){return pz(t.auth,new oO(t),t.bypassAuthState)}function EIe(t){const{auth:e,user:r}=t;return xt(r,e,"internal-error"),eIe(r,new oO(t),t.bypassAuthState)}async function AIe(t){const{auth:e,user:r}=t;return xt(r,e,"internal-error"),QCe(r,new oO(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sz{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(u))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return bIe;case"linkViaPopup":case"linkViaRedirect":return AIe;case"reauthViaPopup":case"reauthViaRedirect":return EIe;default:fa(this.auth,"internal-error")}}resolve(e){bl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){bl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SIe=new s_(2e3,1e4);async function rFe(t,e,r){if(Ru(t.app))return Promise.reject(La(t,"operation-not-supported-in-this-environment"));const n=Vp(t);cCe(t,e,iO);const s=Az(n,r);return new Kh(n,"signInViaPopup",e,s).executeNotNull()}class Kh extends Sz{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,Kh.currentPopupAction&&Kh.currentPopupAction.cancel(),Kh.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return xt(e,this.auth,"internal-error"),e}async onExecution(){bl(this.filter.length===1,"Popup operations only handle one event");const e=sO();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(La(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(La(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Kh.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(La(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,SIe.get())};e()}}Kh.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TIe="pendingRedirect",X1=new Map;class DIe extends Sz{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=X1.get(this.auth._key());if(!e){try{const n=await xIe(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}X1.set(this.auth._key(),e)}return this.bypassAuthState||X1.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function xIe(t,e){const r=IIe(e),n=CIe(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function PIe(t,e){X1.set(t._key(),e)}function CIe(t){return sl(t._redirectPersistence)}function IIe(t){return J1(TIe,t.config.apiKey,t.name)}async function kIe(t,e,r=!1){if(Ru(t.app))return Promise.reject(cf(t));const n=Vp(t),s=Az(n,e),o=await new DIe(n,s,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $Ie=10*60*1e3;class OIe{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!RIe(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!Tz(e)){const s=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(La(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=$Ie&&this.cachedEventUids.clear(),this.cachedEventUids.has(z8(e))}saveEventToCache(e){this.cachedEventUids.add(z8(e)),this.lastProcessedEventTime=Date.now()}}function z8(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Tz({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function RIe(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Tz(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NIe(t,e={}){return Nf(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BIe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,FIe=/^https?/;async function MIe(t){if(t.config.emulator)return;const{authorizedDomains:e}=await NIe(t);for(const r of e)try{if(jIe(r))return}catch{}fa(t,"unauthorized-domain")}function jIe(t){const e=tC(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!FIe.test(r))return!1;if(BIe.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UIe=new s_(3e4,6e4);function W8(){const t=Vu().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function LIe(t){return new Promise((e,r)=>{var n,s,i;function o(){W8(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{W8(),r(La(t,"network-request-failed"))},timeout:UIe.get()})}if(!((s=(n=Vu().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Vu().gapi)===null||i===void 0)&&i.load)o();else{const a=FCe("iframefcb");return Vu()[a]=()=>{gapi.load?o():r(La(t,"network-request-failed"))},dz(`${BCe()}?onload=${a}`).catch(u=>r(u))}}).catch(e=>{throw Y1=null,e})}let Y1=null;function KIe(t){return Y1=Y1||LIe(t),Y1}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VIe=new s_(5e3,15e3),qIe="__/auth/iframe",HIe="emulator/auth/iframe",zIe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},WIe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function GIe(t){const e=t.config;xt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Q$(e,HIe):`https://${t.config.authDomain}/${qIe}`,n={apiKey:e.apiKey,appName:t.name,v:rg},s=WIe.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${i_(n).slice(1)}`}async function JIe(t){const e=await KIe(t),r=Vu().gapi;return xt(r,t,"internal-error"),e.open({where:document.body,url:GIe(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:zIe,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const o=La(t,"network-request-failed"),a=Vu().setTimeout(()=>{i(o)},VIe.get());function u(){Vu().clearTimeout(a),s(n)}n.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XIe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},YIe=500,ZIe=600,QIe="_blank",eke="http://localhost";class G8{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function tke(t,e,r,n=YIe,s=ZIe){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let a="";const u=Object.assign(Object.assign({},XIe),{width:n.toString(),height:s.toString(),top:i,left:o}),l=ts().toLowerCase();r&&(a=iz(l)?QIe:r),rz(l)&&(e=e||eke,u.scrollbars="yes");const c=Object.entries(u).reduce((h,[f,p])=>`${h}${f}=${p},`,"");if(xCe(l)&&a!=="_self")return rke(e||"",a),new G8(null);const d=window.open(e||"",a,c);xt(d,t,"popup-blocked");try{d.focus()}catch{}return new G8(d)}function rke(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nke="__/auth/handler",ike="emulator/auth/handler",ske=encodeURIComponent("fac");async function J8(t,e,r,n,s,i){xt(t.config.authDomain,t,"auth-domain-config-required"),xt(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:rg,eventId:s};if(e instanceof iO){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Gxe(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[c,d]of Object.entries({}))o[c]=d}if(e instanceof o_){const c=e.getScopes().filter(d=>d!=="");c.length>0&&(o.scopes=c.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const c of Object.keys(a))a[c]===void 0&&delete a[c];const u=await t._getAppCheckToken(),l=u?`#${ske}=${encodeURIComponent(u)}`:"";return`${oke(t)}?${i_(a).slice(1)}${l}`}function oke({config:t}){return t.emulator?Q$(t,ike):`https://${t.authDomain}/${nke}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ID="webStorageSupport";class ake{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vz,this._completeRedirectFn=kIe,this._overrideRedirectResult=PIe}async _openPopup(e,r,n,s){var i;bl((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await J8(e,r,n,tC(),s);return tke(e,o,sO())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await J8(e,r,n,tC(),s);return dIe(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(bl(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await JIe(e),n=new OIe(e);return r.register("authEvent",s=>(xt(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(ID,{type:ID},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[ID];o!==void 0&&r(!!o),fa(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=MIe(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return cz()||nz()||tO()}}const uke=ake;var X8="@firebase/auth",Y8="1.7.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cke{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){xt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lke(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function dke(t){ec(new Wa("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=n.options;xt(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:lz(t)},l=new OCe(n,s,i,u);return KCe(l,r),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),ec(new Wa("auth-internal",e=>{const r=Vp(e.getProvider("auth").getImmediate());return(n=>new cke(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),sa(X8,Y8,lke(t)),sa(X8,Y8,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fke=5*60,hke=MH("authIdTokenMaxAge")||fke;let Z8=null;const pke=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>hke)return;const s=r==null?void 0:r.token;Z8!==s&&(Z8=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Cm(t=J$()){const e=Lp(t,"auth");if(e.isInitialized())return e.getImmediate();const r=LCe(t,{popupRedirectResolver:uke,persistence:[_Ie,uIe,vz]}),n=MH("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const o=pke(i.toString());iIe(r,o,()=>o(r.currentUser)),nIe(r,a=>o(a))}}const s=BH("auth");return s&&VCe(r,`http://${s}`),r}function mke(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}RCe({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=La("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",mke().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});dke("Browser");var Q8=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var lp,Dz;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(D,w){function b(){}b.prototype=w.prototype,D.D=w.prototype,D.prototype=new b,D.prototype.constructor=D,D.C=function(T,P,C){for(var k=Array(arguments.length-2),K=2;K<arguments.length;K++)k[K-2]=arguments[K];return w.prototype[P].apply(T,k)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(D,w,b){b||(b=0);var T=Array(16);if(typeof w=="string")for(var P=0;16>P;++P)T[P]=w.charCodeAt(b++)|w.charCodeAt(b++)<<8|w.charCodeAt(b++)<<16|w.charCodeAt(b++)<<24;else for(P=0;16>P;++P)T[P]=w[b++]|w[b++]<<8|w[b++]<<16|w[b++]<<24;w=D.g[0],b=D.g[1],P=D.g[2];var C=D.g[3],k=w+(C^b&(P^C))+T[0]+3614090360&4294967295;w=b+(k<<7&4294967295|k>>>25),k=C+(P^w&(b^P))+T[1]+3905402710&4294967295,C=w+(k<<12&4294967295|k>>>20),k=P+(b^C&(w^b))+T[2]+606105819&4294967295,P=C+(k<<17&4294967295|k>>>15),k=b+(w^P&(C^w))+T[3]+3250441966&4294967295,b=P+(k<<22&4294967295|k>>>10),k=w+(C^b&(P^C))+T[4]+4118548399&4294967295,w=b+(k<<7&4294967295|k>>>25),k=C+(P^w&(b^P))+T[5]+1200080426&4294967295,C=w+(k<<12&4294967295|k>>>20),k=P+(b^C&(w^b))+T[6]+2821735955&4294967295,P=C+(k<<17&4294967295|k>>>15),k=b+(w^P&(C^w))+T[7]+4249261313&4294967295,b=P+(k<<22&4294967295|k>>>10),k=w+(C^b&(P^C))+T[8]+1770035416&4294967295,w=b+(k<<7&4294967295|k>>>25),k=C+(P^w&(b^P))+T[9]+2336552879&4294967295,C=w+(k<<12&4294967295|k>>>20),k=P+(b^C&(w^b))+T[10]+4294925233&4294967295,P=C+(k<<17&4294967295|k>>>15),k=b+(w^P&(C^w))+T[11]+2304563134&4294967295,b=P+(k<<22&4294967295|k>>>10),k=w+(C^b&(P^C))+T[12]+1804603682&4294967295,w=b+(k<<7&4294967295|k>>>25),k=C+(P^w&(b^P))+T[13]+4254626195&4294967295,C=w+(k<<12&4294967295|k>>>20),k=P+(b^C&(w^b))+T[14]+2792965006&4294967295,P=C+(k<<17&4294967295|k>>>15),k=b+(w^P&(C^w))+T[15]+1236535329&4294967295,b=P+(k<<22&4294967295|k>>>10),k=w+(P^C&(b^P))+T[1]+4129170786&4294967295,w=b+(k<<5&4294967295|k>>>27),k=C+(b^P&(w^b))+T[6]+3225465664&4294967295,C=w+(k<<9&4294967295|k>>>23),k=P+(w^b&(C^w))+T[11]+643717713&4294967295,P=C+(k<<14&4294967295|k>>>18),k=b+(C^w&(P^C))+T[0]+3921069994&4294967295,b=P+(k<<20&4294967295|k>>>12),k=w+(P^C&(b^P))+T[5]+3593408605&4294967295,w=b+(k<<5&4294967295|k>>>27),k=C+(b^P&(w^b))+T[10]+38016083&4294967295,C=w+(k<<9&4294967295|k>>>23),k=P+(w^b&(C^w))+T[15]+3634488961&4294967295,P=C+(k<<14&4294967295|k>>>18),k=b+(C^w&(P^C))+T[4]+3889429448&4294967295,b=P+(k<<20&4294967295|k>>>12),k=w+(P^C&(b^P))+T[9]+568446438&4294967295,w=b+(k<<5&4294967295|k>>>27),k=C+(b^P&(w^b))+T[14]+3275163606&4294967295,C=w+(k<<9&4294967295|k>>>23),k=P+(w^b&(C^w))+T[3]+4107603335&4294967295,P=C+(k<<14&4294967295|k>>>18),k=b+(C^w&(P^C))+T[8]+1163531501&4294967295,b=P+(k<<20&4294967295|k>>>12),k=w+(P^C&(b^P))+T[13]+2850285829&4294967295,w=b+(k<<5&4294967295|k>>>27),k=C+(b^P&(w^b))+T[2]+4243563512&4294967295,C=w+(k<<9&4294967295|k>>>23),k=P+(w^b&(C^w))+T[7]+1735328473&4294967295,P=C+(k<<14&4294967295|k>>>18),k=b+(C^w&(P^C))+T[12]+2368359562&4294967295,b=P+(k<<20&4294967295|k>>>12),k=w+(b^P^C)+T[5]+4294588738&4294967295,w=b+(k<<4&4294967295|k>>>28),k=C+(w^b^P)+T[8]+2272392833&4294967295,C=w+(k<<11&4294967295|k>>>21),k=P+(C^w^b)+T[11]+1839030562&4294967295,P=C+(k<<16&4294967295|k>>>16),k=b+(P^C^w)+T[14]+4259657740&4294967295,b=P+(k<<23&4294967295|k>>>9),k=w+(b^P^C)+T[1]+2763975236&4294967295,w=b+(k<<4&4294967295|k>>>28),k=C+(w^b^P)+T[4]+1272893353&4294967295,C=w+(k<<11&4294967295|k>>>21),k=P+(C^w^b)+T[7]+4139469664&4294967295,P=C+(k<<16&4294967295|k>>>16),k=b+(P^C^w)+T[10]+3200236656&4294967295,b=P+(k<<23&4294967295|k>>>9),k=w+(b^P^C)+T[13]+681279174&4294967295,w=b+(k<<4&4294967295|k>>>28),k=C+(w^b^P)+T[0]+3936430074&4294967295,C=w+(k<<11&4294967295|k>>>21),k=P+(C^w^b)+T[3]+3572445317&4294967295,P=C+(k<<16&4294967295|k>>>16),k=b+(P^C^w)+T[6]+76029189&4294967295,b=P+(k<<23&4294967295|k>>>9),k=w+(b^P^C)+T[9]+3654602809&4294967295,w=b+(k<<4&4294967295|k>>>28),k=C+(w^b^P)+T[12]+3873151461&4294967295,C=w+(k<<11&4294967295|k>>>21),k=P+(C^w^b)+T[15]+530742520&4294967295,P=C+(k<<16&4294967295|k>>>16),k=b+(P^C^w)+T[2]+3299628645&4294967295,b=P+(k<<23&4294967295|k>>>9),k=w+(P^(b|~C))+T[0]+4096336452&4294967295,w=b+(k<<6&4294967295|k>>>26),k=C+(b^(w|~P))+T[7]+1126891415&4294967295,C=w+(k<<10&4294967295|k>>>22),k=P+(w^(C|~b))+T[14]+2878612391&4294967295,P=C+(k<<15&4294967295|k>>>17),k=b+(C^(P|~w))+T[5]+4237533241&4294967295,b=P+(k<<21&4294967295|k>>>11),k=w+(P^(b|~C))+T[12]+1700485571&4294967295,w=b+(k<<6&4294967295|k>>>26),k=C+(b^(w|~P))+T[3]+2399980690&4294967295,C=w+(k<<10&4294967295|k>>>22),k=P+(w^(C|~b))+T[10]+4293915773&4294967295,P=C+(k<<15&4294967295|k>>>17),k=b+(C^(P|~w))+T[1]+2240044497&4294967295,b=P+(k<<21&4294967295|k>>>11),k=w+(P^(b|~C))+T[8]+1873313359&4294967295,w=b+(k<<6&4294967295|k>>>26),k=C+(b^(w|~P))+T[15]+4264355552&4294967295,C=w+(k<<10&4294967295|k>>>22),k=P+(w^(C|~b))+T[6]+2734768916&4294967295,P=C+(k<<15&4294967295|k>>>17),k=b+(C^(P|~w))+T[13]+1309151649&4294967295,b=P+(k<<21&4294967295|k>>>11),k=w+(P^(b|~C))+T[4]+4149444226&4294967295,w=b+(k<<6&4294967295|k>>>26),k=C+(b^(w|~P))+T[11]+3174756917&4294967295,C=w+(k<<10&4294967295|k>>>22),k=P+(w^(C|~b))+T[2]+718787259&4294967295,P=C+(k<<15&4294967295|k>>>17),k=b+(C^(P|~w))+T[9]+3951481745&4294967295,D.g[0]=D.g[0]+w&4294967295,D.g[1]=D.g[1]+(P+(k<<21&4294967295|k>>>11))&4294967295,D.g[2]=D.g[2]+P&4294967295,D.g[3]=D.g[3]+C&4294967295}n.prototype.u=function(D,w){w===void 0&&(w=D.length);for(var b=w-this.blockSize,T=this.B,P=this.h,C=0;C<w;){if(P==0)for(;C<=b;)s(this,D,C),C+=this.blockSize;if(typeof D=="string"){for(;C<w;)if(T[P++]=D.charCodeAt(C++),P==this.blockSize){s(this,T),P=0;break}}else for(;C<w;)if(T[P++]=D[C++],P==this.blockSize){s(this,T),P=0;break}}this.h=P,this.o+=w},n.prototype.v=function(){var D=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);D[0]=128;for(var w=1;w<D.length-8;++w)D[w]=0;var b=8*this.o;for(w=D.length-8;w<D.length;++w)D[w]=b&255,b/=256;for(this.u(D),D=Array(16),w=b=0;4>w;++w)for(var T=0;32>T;T+=8)D[b++]=this.g[w]>>>T&255;return D};function i(D,w){var b=a;return Object.prototype.hasOwnProperty.call(b,D)?b[D]:b[D]=w(D)}function o(D,w){this.h=w;for(var b=[],T=!0,P=D.length-1;0<=P;P--){var C=D[P]|0;T&&C==w||(b[P]=C,T=!1)}this.g=b}var a={};function u(D){return-128<=D&&128>D?i(D,function(w){return new o([w|0],0>w?-1:0)}):new o([D|0],0>D?-1:0)}function l(D){if(isNaN(D)||!isFinite(D))return d;if(0>D)return E(l(-D));for(var w=[],b=1,T=0;D>=b;T++)w[T]=D/b|0,b*=4294967296;return new o(w,0)}function c(D,w){if(D.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(D.charAt(0)=="-")return E(c(D.substring(1),w));if(0<=D.indexOf("-"))throw Error('number format error: interior "-" character');for(var b=l(Math.pow(w,8)),T=d,P=0;P<D.length;P+=8){var C=Math.min(8,D.length-P),k=parseInt(D.substring(P,P+C),w);8>C?(C=l(Math.pow(w,C)),T=T.j(C).add(l(k))):(T=T.j(b),T=T.add(l(k)))}return T}var d=u(0),h=u(1),f=u(16777216);t=o.prototype,t.m=function(){if(m(this))return-E(this).m();for(var D=0,w=1,b=0;b<this.g.length;b++){var T=this.i(b);D+=(0<=T?T:4294967296+T)*w,w*=4294967296}return D},t.toString=function(D){if(D=D||10,2>D||36<D)throw Error("radix out of range: "+D);if(p(this))return"0";if(m(this))return"-"+E(this).toString(D);for(var w=l(Math.pow(D,6)),b=this,T="";;){var P=v(b,w).g;b=A(b,P.j(w));var C=((0<b.g.length?b.g[0]:b.h)>>>0).toString(D);if(b=P,p(b))return C+T;for(;6>C.length;)C="0"+C;T=C+T}},t.i=function(D){return 0>D?0:D<this.g.length?this.g[D]:this.h};function p(D){if(D.h!=0)return!1;for(var w=0;w<D.g.length;w++)if(D.g[w]!=0)return!1;return!0}function m(D){return D.h==-1}t.l=function(D){return D=A(this,D),m(D)?-1:p(D)?0:1};function E(D){for(var w=D.g.length,b=[],T=0;T<w;T++)b[T]=~D.g[T];return new o(b,~D.h).add(h)}t.abs=function(){return m(this)?E(this):this},t.add=function(D){for(var w=Math.max(this.g.length,D.g.length),b=[],T=0,P=0;P<=w;P++){var C=T+(this.i(P)&65535)+(D.i(P)&65535),k=(C>>>16)+(this.i(P)>>>16)+(D.i(P)>>>16);T=k>>>16,C&=65535,k&=65535,b[P]=k<<16|C}return new o(b,b[b.length-1]&-2147483648?-1:0)};function A(D,w){return D.add(E(w))}t.j=function(D){if(p(this)||p(D))return d;if(m(this))return m(D)?E(this).j(E(D)):E(E(this).j(D));if(m(D))return E(this.j(E(D)));if(0>this.l(f)&&0>D.l(f))return l(this.m()*D.m());for(var w=this.g.length+D.g.length,b=[],T=0;T<2*w;T++)b[T]=0;for(T=0;T<this.g.length;T++)for(var P=0;P<D.g.length;P++){var C=this.i(T)>>>16,k=this.i(T)&65535,K=D.i(P)>>>16,L=D.i(P)&65535;b[2*T+2*P]+=k*L,_(b,2*T+2*P),b[2*T+2*P+1]+=C*L,_(b,2*T+2*P+1),b[2*T+2*P+1]+=k*K,_(b,2*T+2*P+1),b[2*T+2*P+2]+=C*K,_(b,2*T+2*P+2)}for(T=0;T<w;T++)b[T]=b[2*T+1]<<16|b[2*T];for(T=w;T<2*w;T++)b[T]=0;return new o(b,0)};function _(D,w){for(;(D[w]&65535)!=D[w];)D[w+1]+=D[w]>>>16,D[w]&=65535,w++}function g(D,w){this.g=D,this.h=w}function v(D,w){if(p(w))throw Error("division by zero");if(p(D))return new g(d,d);if(m(D))return w=v(E(D),w),new g(E(w.g),E(w.h));if(m(w))return w=v(D,E(w)),new g(E(w.g),w.h);if(30<D.g.length){if(m(D)||m(w))throw Error("slowDivide_ only works with positive integers.");for(var b=h,T=w;0>=T.l(D);)b=S(b),T=S(T);var P=x(b,1),C=x(T,1);for(T=x(T,2),b=x(b,2);!p(T);){var k=C.add(T);0>=k.l(D)&&(P=P.add(b),C=k),T=x(T,1),b=x(b,1)}return w=A(D,P.j(w)),new g(P,w)}for(P=d;0<=D.l(w);){for(b=Math.max(1,Math.floor(D.m()/w.m())),T=Math.ceil(Math.log(b)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),C=l(b),k=C.j(w);m(k)||0<k.l(D);)b-=T,C=l(b),k=C.j(w);p(C)&&(C=h),P=P.add(C),D=A(D,k)}return new g(P,D)}t.A=function(D){return v(this,D).h},t.and=function(D){for(var w=Math.max(this.g.length,D.g.length),b=[],T=0;T<w;T++)b[T]=this.i(T)&D.i(T);return new o(b,this.h&D.h)},t.or=function(D){for(var w=Math.max(this.g.length,D.g.length),b=[],T=0;T<w;T++)b[T]=this.i(T)|D.i(T);return new o(b,this.h|D.h)},t.xor=function(D){for(var w=Math.max(this.g.length,D.g.length),b=[],T=0;T<w;T++)b[T]=this.i(T)^D.i(T);return new o(b,this.h^D.h)};function S(D){for(var w=D.g.length+1,b=[],T=0;T<w;T++)b[T]=D.i(T)<<1|D.i(T-1)>>>31;return new o(b,D.h)}function x(D,w){var b=w>>5;w%=32;for(var T=D.g.length-b,P=[],C=0;C<T;C++)P[C]=0<w?D.i(C+b)>>>w|D.i(C+b+1)<<32-w:D.i(C+b);return new o(P,D.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Dz=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=c,lp=o}).apply(typeof Q8<"u"?Q8:typeof self<"u"?self:typeof window<"u"?window:{});var Zb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var xz,Pz,q0,Cz,Z1,iC,Iz,kz,$z;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(y,R,U){return y==Array.prototype||y==Object.prototype||(y[R]=U.value),y};function r(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof Zb=="object"&&Zb];for(var R=0;R<y.length;++R){var U=y[R];if(U&&U.Math==Math)return U}throw Error("Cannot find global object")}var n=r(this);function s(y,R){if(R)e:{var U=n;y=y.split(".");for(var ie=0;ie<y.length-1;ie++){var we=y[ie];if(!(we in U))break e;U=U[we]}y=y[y.length-1],ie=U[y],R=R(ie),R!=ie&&R!=null&&e(U,y,{configurable:!0,writable:!0,value:R})}}function i(y,R){y instanceof String&&(y+="");var U=0,ie=!1,we={next:function(){if(!ie&&U<y.length){var De=U++;return{value:R(De,y[De]),done:!1}}return ie=!0,{done:!0,value:void 0}}};return we[Symbol.iterator]=function(){return we},we}s("Array.prototype.values",function(y){return y||function(){return i(this,function(R,U){return U})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function u(y){var R=typeof y;return R=R!="object"?R:y?Array.isArray(y)?"array":R:"null",R=="array"||R=="object"&&typeof y.length=="number"}function l(y){var R=typeof y;return R=="object"&&y!=null||R=="function"}function c(y,R,U){return y.call.apply(y.bind,arguments)}function d(y,R,U){if(!y)throw Error();if(2<arguments.length){var ie=Array.prototype.slice.call(arguments,2);return function(){var we=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(we,ie),y.apply(R,we)}}return function(){return y.apply(R,arguments)}}function h(y,R,U){return h=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?c:d,h.apply(null,arguments)}function f(y,R){var U=Array.prototype.slice.call(arguments,1);return function(){var ie=U.slice();return ie.push.apply(ie,arguments),y.apply(this,ie)}}function p(y,R){function U(){}U.prototype=R.prototype,y.aa=R.prototype,y.prototype=new U,y.prototype.constructor=y,y.Qb=function(ie,we,De){for(var Ke=Array(arguments.length-2),Lr=2;Lr<arguments.length;Lr++)Ke[Lr-2]=arguments[Lr];return R.prototype[we].apply(ie,Ke)}}function m(y){const R=y.length;if(0<R){const U=Array(R);for(let ie=0;ie<R;ie++)U[ie]=y[ie];return U}return[]}function E(y,R){for(let U=1;U<arguments.length;U++){const ie=arguments[U];if(u(ie)){const we=y.length||0,De=ie.length||0;y.length=we+De;for(let Ke=0;Ke<De;Ke++)y[we+Ke]=ie[Ke]}else y.push(ie)}}class A{constructor(R,U){this.i=R,this.j=U,this.h=0,this.g=null}get(){let R;return 0<this.h?(this.h--,R=this.g,this.g=R.next,R.next=null):R=this.i(),R}}function _(y){return/^[\s\xa0]*$/.test(y)}function g(){var y=a.navigator;return y&&(y=y.userAgent)?y:""}function v(y){return v[" "](y),y}v[" "]=function(){};var S=g().indexOf("Gecko")!=-1&&!(g().toLowerCase().indexOf("webkit")!=-1&&g().indexOf("Edge")==-1)&&!(g().indexOf("Trident")!=-1||g().indexOf("MSIE")!=-1)&&g().indexOf("Edge")==-1;function x(y,R,U){for(const ie in y)R.call(U,y[ie],ie,y)}function D(y,R){for(const U in y)R.call(void 0,y[U],U,y)}function w(y){const R={};for(const U in y)R[U]=y[U];return R}const b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(y,R){let U,ie;for(let we=1;we<arguments.length;we++){ie=arguments[we];for(U in ie)y[U]=ie[U];for(let De=0;De<b.length;De++)U=b[De],Object.prototype.hasOwnProperty.call(ie,U)&&(y[U]=ie[U])}}function P(y){var R=1;y=y.split(":");const U=[];for(;0<R&&y.length;)U.push(y.shift()),R--;return y.length&&U.push(y.join(":")),U}function C(y){a.setTimeout(()=>{throw y},0)}function k(){var y=re;let R=null;return y.g&&(R=y.g,y.g=y.g.next,y.g||(y.h=null),R.next=null),R}class K{constructor(){this.h=this.g=null}add(R,U){const ie=L.get();ie.set(R,U),this.h?this.h.next=ie:this.g=ie,this.h=ie}}var L=new A(()=>new q,y=>y.reset());class q{constructor(){this.next=this.g=this.h=null}set(R,U){this.h=R,this.g=U,this.next=null}reset(){this.next=this.g=this.h=null}}let se,X=!1,re=new K,W=()=>{const y=a.Promise.resolve(void 0);se=()=>{y.then(B)}};var B=()=>{for(var y;y=k();){try{y.h.call(y.g)}catch(U){C(U)}var R=L;R.j(y),100>R.h&&(R.h++,y.next=R.g,R.g=y)}X=!1};function te(){this.s=this.s,this.C=this.C}te.prototype.s=!1,te.prototype.ma=function(){this.s||(this.s=!0,this.N())},te.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function z(y,R){this.type=y,this.g=this.target=R,this.defaultPrevented=!1}z.prototype.h=function(){this.defaultPrevented=!0};var $=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var y=!1,R=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const U=()=>{};a.addEventListener("test",U,R),a.removeEventListener("test",U,R)}catch{}return y}();function F(y,R){if(z.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y){var U=this.type=y.type,ie=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;if(this.target=y.target||y.srcElement,this.g=R,R=y.relatedTarget){if(S){e:{try{v(R.nodeName);var we=!0;break e}catch{}we=!1}we||(R=null)}}else U=="mouseover"?R=y.fromElement:U=="mouseout"&&(R=y.toElement);this.relatedTarget=R,ie?(this.clientX=ie.clientX!==void 0?ie.clientX:ie.pageX,this.clientY=ie.clientY!==void 0?ie.clientY:ie.pageY,this.screenX=ie.screenX||0,this.screenY=ie.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=typeof y.pointerType=="string"?y.pointerType:ee[y.pointerType]||"",this.state=y.state,this.i=y,y.defaultPrevented&&F.aa.h.call(this)}}p(F,z);var ee={2:"touch",3:"pen",4:"mouse"};F.prototype.h=function(){F.aa.h.call(this);var y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var ne="closure_listenable_"+(1e6*Math.random()|0),le=0;function me(y,R,U,ie,we){this.listener=y,this.proxy=null,this.src=R,this.type=U,this.capture=!!ie,this.ha=we,this.key=++le,this.da=this.fa=!1}function ve(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function Pe(y){this.src=y,this.g={},this.h=0}Pe.prototype.add=function(y,R,U,ie,we){var De=y.toString();y=this.g[De],y||(y=this.g[De]=[],this.h++);var Ke=M(y,R,ie,we);return-1<Ke?(R=y[Ke],U||(R.fa=!1)):(R=new me(R,this.src,De,!!ie,we),R.fa=U,y.push(R)),R};function Ue(y,R){var U=R.type;if(U in y.g){var ie=y.g[U],we=Array.prototype.indexOf.call(ie,R,void 0),De;(De=0<=we)&&Array.prototype.splice.call(ie,we,1),De&&(ve(R),y.g[U].length==0&&(delete y.g[U],y.h--))}}function M(y,R,U,ie){for(var we=0;we<y.length;++we){var De=y[we];if(!De.da&&De.listener==R&&De.capture==!!U&&De.ha==ie)return we}return-1}var V="closure_lm_"+(1e6*Math.random()|0),oe={};function j(y,R,U,ie,we){if(Array.isArray(R)){for(var De=0;De<R.length;De++)j(y,R[De],U,ie,we);return null}return U=G(U),y&&y[ne]?y.K(R,U,l(ie)?!!ie.capture:!!ie,we):I(y,R,U,!1,ie,we)}function I(y,R,U,ie,we,De){if(!R)throw Error("Invalid event type");var Ke=l(we)?!!we.capture:!!we,Lr=Ce(y);if(Lr||(y[V]=Lr=new Pe(y)),U=Lr.add(R,U,ie,Ke,De),U.proxy)return U;if(ie=N(),U.proxy=ie,ie.src=y,ie.listener=U,y.addEventListener)$||(we=Ke),we===void 0&&(we=!1),y.addEventListener(R.toString(),ie,we);else if(y.attachEvent)y.attachEvent(pe(R.toString()),ie);else if(y.addListener&&y.removeListener)y.addListener(ie);else throw Error("addEventListener and attachEvent are unavailable.");return U}function N(){function y(U){return R.call(y.src,y.listener,U)}const R=he;return y}function Q(y,R,U,ie,we){if(Array.isArray(R))for(var De=0;De<R.length;De++)Q(y,R[De],U,ie,we);else ie=l(ie)?!!ie.capture:!!ie,U=G(U),y&&y[ne]?(y=y.i,R=String(R).toString(),R in y.g&&(De=y.g[R],U=M(De,U,ie,we),-1<U&&(ve(De[U]),Array.prototype.splice.call(De,U,1),De.length==0&&(delete y.g[R],y.h--)))):y&&(y=Ce(y))&&(R=y.g[R.toString()],y=-1,R&&(y=M(R,U,ie,we)),(U=-1<y?R[y]:null)&&ce(U))}function ce(y){if(typeof y!="number"&&y&&!y.da){var R=y.src;if(R&&R[ne])Ue(R.i,y);else{var U=y.type,ie=y.proxy;R.removeEventListener?R.removeEventListener(U,ie,y.capture):R.detachEvent?R.detachEvent(pe(U),ie):R.addListener&&R.removeListener&&R.removeListener(ie),(U=Ce(R))?(Ue(U,y),U.h==0&&(U.src=null,R[V]=null)):ve(y)}}}function pe(y){return y in oe?oe[y]:oe[y]="on"+y}function he(y,R){if(y.da)y=!0;else{R=new F(R,this);var U=y.listener,ie=y.ha||y.src;y.fa&&ce(y),y=U.call(ie,R)}return y}function Ce(y){return y=y[V],y instanceof Pe?y:null}var _e="__closure_events_fn_"+(1e9*Math.random()>>>0);function G(y){return typeof y=="function"?y:(y[_e]||(y[_e]=function(R){return y.handleEvent(R)}),y[_e])}function J(){te.call(this),this.i=new Pe(this),this.M=this,this.F=null}p(J,te),J.prototype[ne]=!0,J.prototype.removeEventListener=function(y,R,U,ie){Q(this,y,R,U,ie)};function ge(y,R){var U,ie=y.F;if(ie)for(U=[];ie;ie=ie.F)U.push(ie);if(y=y.M,ie=R.type||R,typeof R=="string")R=new z(R,y);else if(R instanceof z)R.target=R.target||y;else{var we=R;R=new z(ie,y),T(R,we)}if(we=!0,U)for(var De=U.length-1;0<=De;De--){var Ke=R.g=U[De];we=be(Ke,ie,!0,R)&&we}if(Ke=R.g=y,we=be(Ke,ie,!0,R)&&we,we=be(Ke,ie,!1,R)&&we,U)for(De=0;De<U.length;De++)Ke=R.g=U[De],we=be(Ke,ie,!1,R)&&we}J.prototype.N=function(){if(J.aa.N.call(this),this.i){var y=this.i,R;for(R in y.g){for(var U=y.g[R],ie=0;ie<U.length;ie++)ve(U[ie]);delete y.g[R],y.h--}}this.F=null},J.prototype.K=function(y,R,U,ie){return this.i.add(String(y),R,!1,U,ie)},J.prototype.L=function(y,R,U,ie){return this.i.add(String(y),R,!0,U,ie)};function be(y,R,U,ie){if(R=y.i.g[String(R)],!R)return!0;R=R.concat();for(var we=!0,De=0;De<R.length;++De){var Ke=R[De];if(Ke&&!Ke.da&&Ke.capture==U){var Lr=Ke.listener,li=Ke.ha||Ke.src;Ke.fa&&Ue(y.i,Ke),we=Lr.call(li,ie)!==!1&&we}}return we&&!ie.defaultPrevented}function ke(y,R,U){if(typeof y=="function")U&&(y=h(y,U));else if(y&&typeof y.handleEvent=="function")y=h(y.handleEvent,y);else throw Error("Invalid listener argument");return 2147483647<Number(R)?-1:a.setTimeout(y,R||0)}function At(y){y.g=ke(()=>{y.g=null,y.i&&(y.i=!1,At(y))},y.l);const R=y.h;y.h=null,y.m.apply(null,R)}class kt extends te{constructor(R,U){super(),this.m=R,this.l=U,this.h=null,this.i=!1,this.g=null}j(R){this.h=arguments,this.g?this.i=!0:At(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $r(y){te.call(this),this.h=y,this.g={}}p($r,te);var Wt=[];function cr(y){x(y.g,function(R,U){this.g.hasOwnProperty(U)&&ce(R)},y),y.g={}}$r.prototype.N=function(){$r.aa.N.call(this),cr(this)},$r.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var zs=a.JSON.stringify,un=a.JSON.parse,Ct=class{stringify(y){return a.JSON.stringify(y,void 0)}parse(y){return a.JSON.parse(y,void 0)}};function Wr(){}Wr.prototype.h=null;function _s(y){return y.h||(y.h=y.i())}function Ws(){}var Ui={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function rs(){z.call(this,"d")}p(rs,z);function ci(){z.call(this,"c")}p(ci,z);var O={},Y=null;function H(){return Y=Y||new J}O.La="serverreachability";function Z(y){z.call(this,O.La,y)}p(Z,z);function ae(y){const R=H();ge(R,new Z(R))}O.STAT_EVENT="statevent";function Te(y,R){z.call(this,O.STAT_EVENT,y),this.stat=R}p(Te,z);function xe(y){const R=H();ge(R,new Te(R,y))}O.Ma="timingevent";function $e(y,R){z.call(this,O.Ma,y),this.size=R}p($e,z);function qe(y,R){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){y()},R)}function Nt(){this.g=!0}Nt.prototype.xa=function(){this.g=!1};function de(y,R,U,ie,we,De){y.info(function(){if(y.g)if(De)for(var Ke="",Lr=De.split("&"),li=0;li<Lr.length;li++){var dr=Lr[li].split("=");if(1<dr.length){var Ki=dr[0];dr=dr[1];var Vi=Ki.split("_");Ke=2<=Vi.length&&Vi[1]=="type"?Ke+(Ki+"="+dr+"&"):Ke+(Ki+"=redacted&")}}else Ke=null;else Ke=De;return"XMLHTTP REQ ("+ie+") [attempt "+we+"]: "+R+`
`+U+`
`+Ke})}function ue(y,R,U,ie,we,De,Ke){y.info(function(){return"XMLHTTP RESP ("+ie+") [ attempt "+we+"]: "+R+`
`+U+`
`+De+" "+Ke})}function fe(y,R,U,ie){y.info(function(){return"XMLHTTP TEXT ("+R+"): "+Ee(y,U)+(ie?" "+ie:"")})}function Ae(y,R){y.info(function(){return"TIMEOUT: "+R})}Nt.prototype.info=function(){};function Ee(y,R){if(!y.g)return R;if(!R)return null;try{var U=JSON.parse(R);if(U){for(y=0;y<U.length;y++)if(Array.isArray(U[y])){var ie=U[y];if(!(2>ie.length)){var we=ie[1];if(Array.isArray(we)&&!(1>we.length)){var De=we[0];if(De!="noop"&&De!="stop"&&De!="close")for(var Ke=1;Ke<we.length;Ke++)we[Ke]=""}}}}return zs(U)}catch{return R}}var We={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},it={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Yt;function Sr(){}p(Sr,Wr),Sr.prototype.g=function(){return new XMLHttpRequest},Sr.prototype.i=function(){return{}},Yt=new Sr;function Tr(y,R,U,ie){this.j=y,this.i=R,this.l=U,this.R=ie||1,this.U=new $r(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Gt}function Gt(){this.i=null,this.g="",this.h=!1}var Pr={},Zr={};function Dt(y,R,U){y.L=1,y.v=g_(lc(R)),y.m=U,y.P=!0,Ur(y,null)}function Ur(y,R){y.F=Date.now(),Gs(y),y.A=lc(y.v);var U=y.A,ie=y.R;Array.isArray(ie)||(ie=[String(ie)]),WO(U.i,"t",ie),y.C=0,U=y.j.J,y.h=new Gt,y.g=d5(y.j,U?R:null,!y.m),0<y.O&&(y.M=new kt(h(y.Y,y,y.g),y.O)),R=y.U,U=y.g,ie=y.ca;var we="readystatechange";Array.isArray(we)||(we&&(Wt[0]=we.toString()),we=Wt);for(var De=0;De<we.length;De++){var Ke=j(U,we[De],ie||R.handleEvent,!1,R.h||R);if(!Ke)break;R.g[Ke.key]=Ke}R=y.H?w(y.H):{},y.m?(y.u||(y.u="POST"),R["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.A,y.u,y.m,R)):(y.u="GET",y.g.ea(y.A,y.u,null,R)),ae(),de(y.i,y.u,y.A,y.l,y.R,y.m)}Tr.prototype.ca=function(y){y=y.target;const R=this.M;R&&dc(y)==3?R.j():this.Y(y)},Tr.prototype.Y=function(y){try{if(y==this.g)e:{const Vi=dc(this.g);var R=this.g.Ba();const Yp=this.g.Z();if(!(3>Vi)&&(Vi!=3||this.g&&(this.h.h||this.g.oa()||e5(this.g)))){this.J||Vi!=4||R==7||(R==8||0>=Yp?ae(3):ae(2)),bs(this);var U=this.g.Z();this.X=U;t:if(cn(this)){var ie=e5(this.g);y="";var we=ie.length,De=dc(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ns(this),So(this);var Ke="";break t}this.h.i=new a.TextDecoder}for(R=0;R<we;R++)this.h.h=!0,y+=this.h.i.decode(ie[R],{stream:!(De&&R==we-1)});ie.length=0,this.h.g+=y,this.C=0,Ke=this.h.g}else Ke=this.g.oa();if(this.o=U==200,ue(this.i,this.u,this.A,this.l,this.R,Vi,U),this.o){if(this.T&&!this.K){t:{if(this.g){var Lr,li=this.g;if((Lr=li.g?li.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(Lr)){var dr=Lr;break t}}dr=null}if(U=dr)fe(this.i,this.l,U,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Li(this,U);else{this.o=!1,this.s=3,xe(12),ns(this),So(this);break e}}if(this.P){U=!0;let ma;for(;!this.J&&this.C<Ke.length;)if(ma=Gr(this,Ke),ma==Zr){Vi==4&&(this.s=4,xe(14),U=!1),fe(this.i,this.l,null,"[Incomplete Response]");break}else if(ma==Pr){this.s=4,xe(15),fe(this.i,this.l,Ke,"[Invalid Chunk]"),U=!1;break}else fe(this.i,this.l,ma,null),Li(this,ma);if(cn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Vi!=4||Ke.length!=0||this.h.h||(this.s=1,xe(16),U=!1),this.o=this.o&&U,!U)fe(this.i,this.l,Ke,"[Invalid Chunked Response]"),ns(this),So(this);else if(0<Ke.length&&!this.W){this.W=!0;var Ki=this.j;Ki.g==this&&Ki.ba&&!Ki.M&&(Ki.j.info("Great, no buffering proxy detected. Bytes received: "+Ke.length),o2(Ki),Ki.M=!0,xe(11))}}else fe(this.i,this.l,Ke,null),Li(this,Ke);Vi==4&&ns(this),this.o&&!this.J&&(Vi==4?a5(this.j,this):(this.o=!1,Gs(this)))}else DG(this.g),U==400&&0<Ke.indexOf("Unknown SID")?(this.s=3,xe(12)):(this.s=0,xe(13)),ns(this),So(this)}}}catch{}finally{}};function cn(y){return y.g?y.u=="GET"&&y.L!=2&&y.j.Ca:!1}function Gr(y,R){var U=y.C,ie=R.indexOf(`
`,U);return ie==-1?Zr:(U=Number(R.substring(U,ie)),isNaN(U)?Pr:(ie+=1,ie+U>R.length?Zr:(R=R.slice(ie,ie+U),y.C=ie+U,R)))}Tr.prototype.cancel=function(){this.J=!0,ns(this)};function Gs(y){y.S=Date.now()+y.I,Js(y,y.I)}function Js(y,R){if(y.B!=null)throw Error("WatchDog timer not null");y.B=qe(h(y.ba,y),R)}function bs(y){y.B&&(a.clearTimeout(y.B),y.B=null)}Tr.prototype.ba=function(){this.B=null;const y=Date.now();0<=y-this.S?(Ae(this.i,this.A),this.L!=2&&(ae(),xe(17)),ns(this),this.s=2,So(this)):Js(this,this.S-y)};function So(y){y.j.G==0||y.J||a5(y.j,y)}function ns(y){bs(y);var R=y.M;R&&typeof R.ma=="function"&&R.ma(),y.M=null,cr(y.U),y.g&&(R=y.g,y.g=null,R.abort(),R.ma())}function Li(y,R){try{var U=y.j;if(U.G!=0&&(U.g==y||zp(U.h,y))){if(!y.K&&zp(U.h,y)&&U.G==3){try{var ie=U.Da.g.parse(R)}catch{ie=null}if(Array.isArray(ie)&&ie.length==3){var we=ie;if(we[0]==0){e:if(!U.u){if(U.g)if(U.g.F+3e3<y.F)E_(U),__(U);else break e;s2(U),xe(18)}}else U.za=we[1],0<U.za-U.T&&37500>we[2]&&U.F&&U.v==0&&!U.C&&(U.C=qe(h(U.Za,U),6e3));if(1>=kl(U.h)&&U.ca){try{U.ca()}catch{}U.ca=void 0}}else jf(U,11)}else if((y.K||U.g==y)&&E_(U),!_(R))for(we=U.Da.g.parse(R),R=0;R<we.length;R++){let dr=we[R];if(U.T=dr[0],dr=dr[1],U.G==2)if(dr[0]=="c"){U.K=dr[1],U.ia=dr[2];const Ki=dr[3];Ki!=null&&(U.la=Ki,U.j.info("VER="+U.la));const Vi=dr[4];Vi!=null&&(U.Aa=Vi,U.j.info("SVER="+U.Aa));const Yp=dr[5];Yp!=null&&typeof Yp=="number"&&0<Yp&&(ie=1.5*Yp,U.L=ie,U.j.info("backChannelRequestTimeoutMs_="+ie)),ie=U;const ma=y.g;if(ma){const S_=ma.g?ma.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(S_){var De=ie.h;De.g||S_.indexOf("spdy")==-1&&S_.indexOf("quic")==-1&&S_.indexOf("h2")==-1||(De.j=De.l,De.g=new Set,De.h&&(Wp(De,De.h),De.h=null))}if(ie.D){const a2=ma.g?ma.g.getResponseHeader("X-HTTP-Session-Id"):null;a2&&(ie.ya=a2,Qr(ie.I,ie.D,a2))}}U.G=3,U.l&&U.l.ua(),U.ba&&(U.R=Date.now()-y.F,U.j.info("Handshake RTT: "+U.R+"ms")),ie=U;var Ke=y;if(ie.qa=l5(ie,ie.J?ie.ia:null,ie.W),Ke.K){Bf(ie.h,Ke);var Lr=Ke,li=ie.L;li&&(Lr.I=li),Lr.B&&(bs(Lr),Gs(Lr)),ie.g=Ke}else s5(ie);0<U.i.length&&b_(U)}else dr[0]!="stop"&&dr[0]!="close"||jf(U,7);else U.G==3&&(dr[0]=="stop"||dr[0]=="close"?dr[0]=="stop"?jf(U,7):i2(U):dr[0]!="noop"&&U.l&&U.l.ta(dr),U.v=0)}}ae(4)}catch{}}var To=class{constructor(y,R){this.g=y,this.map=R}};function Xa(y){this.l=y||10,a.PerformanceNavigationTiming?(y=a.performance.getEntriesByType("navigation"),y=0<y.length&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Do(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function kl(y){return y.h?1:y.g?y.g.size:0}function zp(y,R){return y.h?y.h==R:y.g?y.g.has(R):!1}function Wp(y,R){y.g?y.g.add(R):y.h=R}function Bf(y,R){y.h&&y.h==R?y.h=null:y.g&&y.g.has(R)&&y.g.delete(R)}Xa.prototype.cancel=function(){if(this.i=Ff(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function Ff(y){if(y.h!=null)return y.i.concat(y.h.D);if(y.g!=null&&y.g.size!==0){let R=y.i;for(const U of y.g.values())R=R.concat(U.D);return R}return m(y.i)}function Gp(y){if(y.V&&typeof y.V=="function")return y.V();if(typeof Map<"u"&&y instanceof Map||typeof Set<"u"&&y instanceof Set)return Array.from(y.values());if(typeof y=="string")return y.split("");if(u(y)){for(var R=[],U=y.length,ie=0;ie<U;ie++)R.push(y[ie]);return R}R=[],U=0;for(ie in y)R[U++]=y[ie];return R}function p_(y){if(y.na&&typeof y.na=="function")return y.na();if(!y.V||typeof y.V!="function"){if(typeof Map<"u"&&y instanceof Map)return Array.from(y.keys());if(!(typeof Set<"u"&&y instanceof Set)){if(u(y)||typeof y=="string"){var R=[];y=y.length;for(var U=0;U<y;U++)R.push(U);return R}R=[],U=0;for(const ie in y)R[U++]=ie;return R}}}function ug(y,R){if(y.forEach&&typeof y.forEach=="function")y.forEach(R,void 0);else if(u(y)||typeof y=="string")Array.prototype.forEach.call(y,R,void 0);else for(var U=p_(y),ie=Gp(y),we=ie.length,De=0;De<we;De++)R.call(void 0,ie[De],U&&U[De],y)}var $l=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hG(y,R){if(y){y=y.split("&");for(var U=0;U<y.length;U++){var ie=y[U].indexOf("="),we=null;if(0<=ie){var De=y[U].substring(0,ie);we=y[U].substring(ie+1)}else De=y[U];R(De,we?decodeURIComponent(we.replace(/\+/g," ")):"")}}}function Mf(y){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,y instanceof Mf){this.h=y.h,m_(this,y.j),this.o=y.o,this.g=y.g,y_(this,y.s),this.l=y.l;var R=y.i,U=new dg;U.i=R.i,R.g&&(U.g=new Map(R.g),U.h=R.h),VO(this,U),this.m=y.m}else y&&(R=String(y).match($l))?(this.h=!1,m_(this,R[1]||"",!0),this.o=cg(R[2]||""),this.g=cg(R[3]||"",!0),y_(this,R[4]),this.l=cg(R[5]||"",!0),VO(this,R[6]||"",!0),this.m=cg(R[7]||"")):(this.h=!1,this.i=new dg(null,this.h))}Mf.prototype.toString=function(){var y=[],R=this.j;R&&y.push(lg(R,qO,!0),":");var U=this.g;return(U||R=="file")&&(y.push("//"),(R=this.o)&&y.push(lg(R,qO,!0),"@"),y.push(encodeURIComponent(String(U)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),U=this.s,U!=null&&y.push(":",String(U))),(U=this.l)&&(this.g&&U.charAt(0)!="/"&&y.push("/"),y.push(lg(U,U.charAt(0)=="/"?yG:mG,!0))),(U=this.i.toString())&&y.push("?",U),(U=this.m)&&y.push("#",lg(U,vG)),y.join("")};function lc(y){return new Mf(y)}function m_(y,R,U){y.j=U?cg(R,!0):R,y.j&&(y.j=y.j.replace(/:$/,""))}function y_(y,R){if(R){if(R=Number(R),isNaN(R)||0>R)throw Error("Bad port number "+R);y.s=R}else y.s=null}function VO(y,R,U){R instanceof dg?(y.i=R,wG(y.i,y.h)):(U||(R=lg(R,gG)),y.i=new dg(R,y.h))}function Qr(y,R,U){y.i.set(R,U)}function g_(y){return Qr(y,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),y}function cg(y,R){return y?R?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function lg(y,R,U){return typeof y=="string"?(y=encodeURI(y).replace(R,pG),U&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function pG(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var qO=/[#\/\?@]/g,mG=/[#\?:]/g,yG=/[#\?]/g,gG=/[#\?@]/g,vG=/#/g;function dg(y,R){this.h=this.g=null,this.i=y||null,this.j=!!R}function Ol(y){y.g||(y.g=new Map,y.h=0,y.i&&hG(y.i,function(R,U){y.add(decodeURIComponent(R.replace(/\+/g," ")),U)}))}t=dg.prototype,t.add=function(y,R){Ol(this),this.i=null,y=Jp(this,y);var U=this.g.get(y);return U||this.g.set(y,U=[]),U.push(R),this.h+=1,this};function HO(y,R){Ol(y),R=Jp(y,R),y.g.has(R)&&(y.i=null,y.h-=y.g.get(R).length,y.g.delete(R))}function zO(y,R){return Ol(y),R=Jp(y,R),y.g.has(R)}t.forEach=function(y,R){Ol(this),this.g.forEach(function(U,ie){U.forEach(function(we){y.call(R,we,ie,this)},this)},this)},t.na=function(){Ol(this);const y=Array.from(this.g.values()),R=Array.from(this.g.keys()),U=[];for(let ie=0;ie<R.length;ie++){const we=y[ie];for(let De=0;De<we.length;De++)U.push(R[ie])}return U},t.V=function(y){Ol(this);let R=[];if(typeof y=="string")zO(this,y)&&(R=R.concat(this.g.get(Jp(this,y))));else{y=Array.from(this.g.values());for(let U=0;U<y.length;U++)R=R.concat(y[U])}return R},t.set=function(y,R){return Ol(this),this.i=null,y=Jp(this,y),zO(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[R]),this.h+=1,this},t.get=function(y,R){return y?(y=this.V(y),0<y.length?String(y[0]):R):R};function WO(y,R,U){HO(y,R),0<U.length&&(y.i=null,y.g.set(Jp(y,R),m(U)),y.h+=U.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],R=Array.from(this.g.keys());for(var U=0;U<R.length;U++){var ie=R[U];const De=encodeURIComponent(String(ie)),Ke=this.V(ie);for(ie=0;ie<Ke.length;ie++){var we=De;Ke[ie]!==""&&(we+="="+encodeURIComponent(String(Ke[ie]))),y.push(we)}}return this.i=y.join("&")};function Jp(y,R){return R=String(R),y.j&&(R=R.toLowerCase()),R}function wG(y,R){R&&!y.j&&(Ol(y),y.i=null,y.g.forEach(function(U,ie){var we=ie.toLowerCase();ie!=we&&(HO(this,ie),WO(this,we,U))},y)),y.j=R}function _G(y,R){const U=new Nt;if(a.Image){const ie=new Image;ie.onload=f(Rl,U,"TestLoadImage: loaded",!0,R,ie),ie.onerror=f(Rl,U,"TestLoadImage: error",!1,R,ie),ie.onabort=f(Rl,U,"TestLoadImage: abort",!1,R,ie),ie.ontimeout=f(Rl,U,"TestLoadImage: timeout",!1,R,ie),a.setTimeout(function(){ie.ontimeout&&ie.ontimeout()},1e4),ie.src=y}else R(!1)}function bG(y,R){const U=new Nt,ie=new AbortController,we=setTimeout(()=>{ie.abort(),Rl(U,"TestPingServer: timeout",!1,R)},1e4);fetch(y,{signal:ie.signal}).then(De=>{clearTimeout(we),De.ok?Rl(U,"TestPingServer: ok",!0,R):Rl(U,"TestPingServer: server error",!1,R)}).catch(()=>{clearTimeout(we),Rl(U,"TestPingServer: error",!1,R)})}function Rl(y,R,U,ie,we){try{we&&(we.onload=null,we.onerror=null,we.onabort=null,we.ontimeout=null),ie(U)}catch{}}function EG(){this.g=new Ct}function AG(y,R,U){const ie=U||"";try{ug(y,function(we,De){let Ke=we;l(we)&&(Ke=zs(we)),R.push(ie+De+"="+encodeURIComponent(Ke))})}catch(we){throw R.push(ie+"type="+encodeURIComponent("_badmap")),we}}function fg(y){this.l=y.Ub||null,this.j=y.eb||!1}p(fg,Wr),fg.prototype.g=function(){return new v_(this.l,this.j)},fg.prototype.i=function(y){return function(){return y}}({});function v_(y,R){J.call(this),this.D=y,this.o=R,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}p(v_,J),t=v_.prototype,t.open=function(y,R){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=y,this.A=R,this.readyState=1,pg(this)},t.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const R={headers:this.u,method:this.B,credentials:this.m,cache:void 0};y&&(R.body=y),(this.D||a).fetch(new Request(this.A,R)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,hg(this)),this.readyState=0},t.Sa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,pg(this)),this.g&&(this.readyState=3,pg(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;GO(this)}else y.text().then(this.Ra.bind(this),this.ga.bind(this))};function GO(y){y.j.read().then(y.Pa.bind(y)).catch(y.ga.bind(y))}t.Pa=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var R=y.value?y.value:new Uint8Array(0);(R=this.v.decode(R,{stream:!y.done}))&&(this.response=this.responseText+=R)}y.done?hg(this):pg(this),this.readyState==3&&GO(this)}},t.Ra=function(y){this.g&&(this.response=this.responseText=y,hg(this))},t.Qa=function(y){this.g&&(this.response=y,hg(this))},t.ga=function(){this.g&&hg(this)};function hg(y){y.readyState=4,y.l=null,y.j=null,y.v=null,pg(y)}t.setRequestHeader=function(y,R){this.u.append(y,R)},t.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],R=this.h.entries();for(var U=R.next();!U.done;)U=U.value,y.push(U[0]+": "+U[1]),U=R.next();return y.join(`\r
`)};function pg(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(v_.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function JO(y){let R="";return x(y,function(U,ie){R+=ie,R+=":",R+=U,R+=`\r
`}),R}function n2(y,R,U){e:{for(ie in U){var ie=!1;break e}ie=!0}ie||(U=JO(U),typeof y=="string"?U!=null&&encodeURIComponent(String(U)):Qr(y,R,U))}function mn(y){J.call(this),this.headers=new Map,this.o=y||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}p(mn,J);var SG=/^https?$/i,TG=["POST","PUT"];t=mn.prototype,t.Ha=function(y){this.J=y},t.ea=function(y,R,U,ie){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);R=R?R.toUpperCase():"GET",this.D=y,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Yt.g(),this.v=this.o?_s(this.o):_s(Yt),this.g.onreadystatechange=h(this.Ea,this);try{this.B=!0,this.g.open(R,String(y),!0),this.B=!1}catch(De){XO(this,De);return}if(y=U||"",U=new Map(this.headers),ie)if(Object.getPrototypeOf(ie)===Object.prototype)for(var we in ie)U.set(we,ie[we]);else if(typeof ie.keys=="function"&&typeof ie.get=="function")for(const De of ie.keys())U.set(De,ie.get(De));else throw Error("Unknown input type for opt_headers: "+String(ie));ie=Array.from(U.keys()).find(De=>De.toLowerCase()=="content-type"),we=a.FormData&&y instanceof a.FormData,!(0<=Array.prototype.indexOf.call(TG,R,void 0))||ie||we||U.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[De,Ke]of U)this.g.setRequestHeader(De,Ke);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{QO(this),this.u=!0,this.g.send(y),this.u=!1}catch(De){XO(this,De)}};function XO(y,R){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=R,y.m=5,YO(y),w_(y)}function YO(y){y.A||(y.A=!0,ge(y,"complete"),ge(y,"error"))}t.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=y||7,ge(this,"complete"),ge(this,"abort"),w_(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),w_(this,!0)),mn.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?ZO(this):this.bb())},t.bb=function(){ZO(this)};function ZO(y){if(y.h&&typeof o<"u"&&(!y.v[1]||dc(y)!=4||y.Z()!=2)){if(y.u&&dc(y)==4)ke(y.Ea,0,y);else if(ge(y,"readystatechange"),dc(y)==4){y.h=!1;try{const Ke=y.Z();e:switch(Ke){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var R=!0;break e;default:R=!1}var U;if(!(U=R)){var ie;if(ie=Ke===0){var we=String(y.D).match($l)[1]||null;!we&&a.self&&a.self.location&&(we=a.self.location.protocol.slice(0,-1)),ie=!SG.test(we?we.toLowerCase():"")}U=ie}if(U)ge(y,"complete"),ge(y,"success");else{y.m=6;try{var De=2<dc(y)?y.g.statusText:""}catch{De=""}y.l=De+" ["+y.Z()+"]",YO(y)}}finally{w_(y)}}}}function w_(y,R){if(y.g){QO(y);const U=y.g,ie=y.v[0]?()=>{}:null;y.g=null,y.v=null,R||ge(y,"ready");try{U.onreadystatechange=ie}catch{}}}function QO(y){y.I&&(a.clearTimeout(y.I),y.I=null)}t.isActive=function(){return!!this.g};function dc(y){return y.g?y.g.readyState:0}t.Z=function(){try{return 2<dc(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(y){if(this.g){var R=this.g.responseText;return y&&R.indexOf(y)==0&&(R=R.substring(y.length)),un(R)}};function e5(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.H){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function DG(y){const R={};y=(y.g&&2<=dc(y)&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let ie=0;ie<y.length;ie++){if(_(y[ie]))continue;var U=P(y[ie]);const we=U[0];if(U=U[1],typeof U!="string")continue;U=U.trim();const De=R[we]||[];R[we]=De,De.push(U)}D(R,function(ie){return ie.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function mg(y,R,U){return U&&U.internalChannelParams&&U.internalChannelParams[y]||R}function t5(y){this.Aa=0,this.i=[],this.j=new Nt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=mg("failFast",!1,y),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=mg("baseRetryDelayMs",5e3,y),this.cb=mg("retryDelaySeedMs",1e4,y),this.Wa=mg("forwardChannelMaxRetries",2,y),this.wa=mg("forwardChannelRequestTimeoutMs",2e4,y),this.pa=y&&y.xmlHttpFactory||void 0,this.Xa=y&&y.Tb||void 0,this.Ca=y&&y.useFetchStreams||!1,this.L=void 0,this.J=y&&y.supportsCrossDomainXhr||!1,this.K="",this.h=new Xa(y&&y.concurrentRequestLimit),this.Da=new EG,this.P=y&&y.fastHandshake||!1,this.O=y&&y.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=y&&y.Rb||!1,y&&y.xa&&this.j.xa(),y&&y.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&y&&y.detectBufferingProxy||!1,this.ja=void 0,y&&y.longPollingTimeout&&0<y.longPollingTimeout&&(this.ja=y.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=t5.prototype,t.la=8,t.G=1,t.connect=function(y,R,U,ie){xe(0),this.W=y,this.H=R||{},U&&ie!==void 0&&(this.H.OSID=U,this.H.OAID=ie),this.F=this.X,this.I=l5(this,null,this.W),b_(this)};function i2(y){if(r5(y),y.G==3){var R=y.U++,U=lc(y.I);if(Qr(U,"SID",y.K),Qr(U,"RID",R),Qr(U,"TYPE","terminate"),yg(y,U),R=new Tr(y,y.j,R),R.L=2,R.v=g_(lc(U)),U=!1,a.navigator&&a.navigator.sendBeacon)try{U=a.navigator.sendBeacon(R.v.toString(),"")}catch{}!U&&a.Image&&(new Image().src=R.v,U=!0),U||(R.g=d5(R.j,null),R.g.ea(R.v)),R.F=Date.now(),Gs(R)}c5(y)}function __(y){y.g&&(o2(y),y.g.cancel(),y.g=null)}function r5(y){__(y),y.u&&(a.clearTimeout(y.u),y.u=null),E_(y),y.h.cancel(),y.s&&(typeof y.s=="number"&&a.clearTimeout(y.s),y.s=null)}function b_(y){if(!Do(y.h)&&!y.s){y.s=!0;var R=y.Ga;se||W(),X||(se(),X=!0),re.add(R,y),y.B=0}}function xG(y,R){return kl(y.h)>=y.h.j-(y.s?1:0)?!1:y.s?(y.i=R.D.concat(y.i),!0):y.G==1||y.G==2||y.B>=(y.Va?0:y.Wa)?!1:(y.s=qe(h(y.Ga,y,R),u5(y,y.B)),y.B++,!0)}t.Ga=function(y){if(this.s)if(this.s=null,this.G==1){if(!y){this.U=Math.floor(1e5*Math.random()),y=this.U++;const we=new Tr(this,this.j,y);let De=this.o;if(this.S&&(De?(De=w(De),T(De,this.S)):De=this.S),this.m!==null||this.O||(we.H=De,De=null),this.P)e:{for(var R=0,U=0;U<this.i.length;U++){t:{var ie=this.i[U];if("__data__"in ie.map&&(ie=ie.map.__data__,typeof ie=="string")){ie=ie.length;break t}ie=void 0}if(ie===void 0)break;if(R+=ie,4096<R){R=U;break e}if(R===4096||U===this.i.length-1){R=U+1;break e}}R=1e3}else R=1e3;R=i5(this,we,R),U=lc(this.I),Qr(U,"RID",y),Qr(U,"CVER",22),this.D&&Qr(U,"X-HTTP-Session-Id",this.D),yg(this,U),De&&(this.O?R="headers="+encodeURIComponent(String(JO(De)))+"&"+R:this.m&&n2(U,this.m,De)),Wp(this.h,we),this.Ua&&Qr(U,"TYPE","init"),this.P?(Qr(U,"$req",R),Qr(U,"SID","null"),we.T=!0,Dt(we,U,null)):Dt(we,U,R),this.G=2}}else this.G==3&&(y?n5(this,y):this.i.length==0||Do(this.h)||n5(this))};function n5(y,R){var U;R?U=R.l:U=y.U++;const ie=lc(y.I);Qr(ie,"SID",y.K),Qr(ie,"RID",U),Qr(ie,"AID",y.T),yg(y,ie),y.m&&y.o&&n2(ie,y.m,y.o),U=new Tr(y,y.j,U,y.B+1),y.m===null&&(U.H=y.o),R&&(y.i=R.D.concat(y.i)),R=i5(y,U,1e3),U.I=Math.round(.5*y.wa)+Math.round(.5*y.wa*Math.random()),Wp(y.h,U),Dt(U,ie,R)}function yg(y,R){y.H&&x(y.H,function(U,ie){Qr(R,ie,U)}),y.l&&ug({},function(U,ie){Qr(R,ie,U)})}function i5(y,R,U){U=Math.min(y.i.length,U);var ie=y.l?h(y.l.Na,y.l,y):null;e:{var we=y.i;let De=-1;for(;;){const Ke=["count="+U];De==-1?0<U?(De=we[0].g,Ke.push("ofs="+De)):De=0:Ke.push("ofs="+De);let Lr=!0;for(let li=0;li<U;li++){let dr=we[li].g;const Ki=we[li].map;if(dr-=De,0>dr)De=Math.max(0,we[li].g-100),Lr=!1;else try{AG(Ki,Ke,"req"+dr+"_")}catch{ie&&ie(Ki)}}if(Lr){ie=Ke.join("&");break e}}}return y=y.i.splice(0,U),R.D=y,ie}function s5(y){if(!y.g&&!y.u){y.Y=1;var R=y.Fa;se||W(),X||(se(),X=!0),re.add(R,y),y.v=0}}function s2(y){return y.g||y.u||3<=y.v?!1:(y.Y++,y.u=qe(h(y.Fa,y),u5(y,y.v)),y.v++,!0)}t.Fa=function(){if(this.u=null,o5(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var y=2*this.R;this.j.info("BP detection timer enabled: "+y),this.A=qe(h(this.ab,this),y)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,xe(10),__(this),o5(this))};function o2(y){y.A!=null&&(a.clearTimeout(y.A),y.A=null)}function o5(y){y.g=new Tr(y,y.j,"rpc",y.Y),y.m===null&&(y.g.H=y.o),y.g.O=0;var R=lc(y.qa);Qr(R,"RID","rpc"),Qr(R,"SID",y.K),Qr(R,"AID",y.T),Qr(R,"CI",y.F?"0":"1"),!y.F&&y.ja&&Qr(R,"TO",y.ja),Qr(R,"TYPE","xmlhttp"),yg(y,R),y.m&&y.o&&n2(R,y.m,y.o),y.L&&(y.g.I=y.L);var U=y.g;y=y.ia,U.L=1,U.v=g_(lc(R)),U.m=null,U.P=!0,Ur(U,y)}t.Za=function(){this.C!=null&&(this.C=null,__(this),s2(this),xe(19))};function E_(y){y.C!=null&&(a.clearTimeout(y.C),y.C=null)}function a5(y,R){var U=null;if(y.g==R){E_(y),o2(y),y.g=null;var ie=2}else if(zp(y.h,R))U=R.D,Bf(y.h,R),ie=1;else return;if(y.G!=0){if(R.o)if(ie==1){U=R.m?R.m.length:0,R=Date.now()-R.F;var we=y.B;ie=H(),ge(ie,new $e(ie,U)),b_(y)}else s5(y);else if(we=R.s,we==3||we==0&&0<R.X||!(ie==1&&xG(y,R)||ie==2&&s2(y)))switch(U&&0<U.length&&(R=y.h,R.i=R.i.concat(U)),we){case 1:jf(y,5);break;case 4:jf(y,10);break;case 3:jf(y,6);break;default:jf(y,2)}}}function u5(y,R){let U=y.Ta+Math.floor(Math.random()*y.cb);return y.isActive()||(U*=2),U*R}function jf(y,R){if(y.j.info("Error code "+R),R==2){var U=h(y.fb,y),ie=y.Xa;const we=!ie;ie=new Mf(ie||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||m_(ie,"https"),g_(ie),we?_G(ie.toString(),U):bG(ie.toString(),U)}else xe(2);y.G=0,y.l&&y.l.sa(R),c5(y),r5(y)}t.fb=function(y){y?(this.j.info("Successfully pinged google.com"),xe(2)):(this.j.info("Failed to ping google.com"),xe(1))};function c5(y){if(y.G=0,y.ka=[],y.l){const R=Ff(y.h);(R.length!=0||y.i.length!=0)&&(E(y.ka,R),E(y.ka,y.i),y.h.i.length=0,m(y.i),y.i.length=0),y.l.ra()}}function l5(y,R,U){var ie=U instanceof Mf?lc(U):new Mf(U);if(ie.g!="")R&&(ie.g=R+"."+ie.g),y_(ie,ie.s);else{var we=a.location;ie=we.protocol,R=R?R+"."+we.hostname:we.hostname,we=+we.port;var De=new Mf(null);ie&&m_(De,ie),R&&(De.g=R),we&&y_(De,we),U&&(De.l=U),ie=De}return U=y.D,R=y.ya,U&&R&&Qr(ie,U,R),Qr(ie,"VER",y.la),yg(y,ie),ie}function d5(y,R,U){if(R&&!y.J)throw Error("Can't create secondary domain capable XhrIo object.");return R=y.Ca&&!y.pa?new mn(new fg({eb:U})):new mn(y.pa),R.Ha(y.J),R}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function f5(){}t=f5.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function A_(){}A_.prototype.g=function(y,R){return new Xs(y,R)};function Xs(y,R){J.call(this),this.g=new t5(R),this.l=y,this.h=R&&R.messageUrlParams||null,y=R&&R.messageHeaders||null,R&&R.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=R&&R.initMessageHeaders||null,R&&R.messageContentType&&(y?y["X-WebChannel-Content-Type"]=R.messageContentType:y={"X-WebChannel-Content-Type":R.messageContentType}),R&&R.va&&(y?y["X-WebChannel-Client-Profile"]=R.va:y={"X-WebChannel-Client-Profile":R.va}),this.g.S=y,(y=R&&R.Sb)&&!_(y)&&(this.g.m=y),this.v=R&&R.supportsCrossDomainXhr||!1,this.u=R&&R.sendRawJson||!1,(R=R&&R.httpSessionIdParam)&&!_(R)&&(this.g.D=R,y=this.h,y!==null&&R in y&&(y=this.h,R in y&&delete y[R])),this.j=new Xp(this)}p(Xs,J),Xs.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Xs.prototype.close=function(){i2(this.g)},Xs.prototype.o=function(y){var R=this.g;if(typeof y=="string"){var U={};U.__data__=y,y=U}else this.u&&(U={},U.__data__=zs(y),y=U);R.i.push(new To(R.Ya++,y)),R.G==3&&b_(R)},Xs.prototype.N=function(){this.g.l=null,delete this.j,i2(this.g),delete this.g,Xs.aa.N.call(this)};function h5(y){rs.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var R=y.__sm__;if(R){e:{for(const U in R){y=U;break e}y=void 0}(this.i=y)&&(y=this.i,R=R!==null&&y in R?R[y]:void 0),this.data=R}else this.data=y}p(h5,rs);function p5(){ci.call(this),this.status=1}p(p5,ci);function Xp(y){this.g=y}p(Xp,f5),Xp.prototype.ua=function(){ge(this.g,"a")},Xp.prototype.ta=function(y){ge(this.g,new h5(y))},Xp.prototype.sa=function(y){ge(this.g,new p5)},Xp.prototype.ra=function(){ge(this.g,"b")},A_.prototype.createWebChannel=A_.prototype.g,Xs.prototype.send=Xs.prototype.o,Xs.prototype.open=Xs.prototype.m,Xs.prototype.close=Xs.prototype.close,$z=function(){return new A_},kz=function(){return H()},Iz=O,iC={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},We.NO_ERROR=0,We.TIMEOUT=8,We.HTTP_ERROR=6,Z1=We,it.COMPLETE="complete",Cz=it,Ws.EventType=Ui,Ui.OPEN="a",Ui.CLOSE="b",Ui.ERROR="c",Ui.MESSAGE="d",J.prototype.listen=J.prototype.K,q0=Ws,Pz=fg,mn.prototype.listenOnce=mn.prototype.L,mn.prototype.getLastError=mn.prototype.Ka,mn.prototype.getLastErrorCode=mn.prototype.Ba,mn.prototype.getStatus=mn.prototype.Z,mn.prototype.getResponseJson=mn.prototype.Oa,mn.prototype.getResponseText=mn.prototype.oa,mn.prototype.send=mn.prototype.ea,mn.prototype.setWithCredentials=mn.prototype.Ha,xz=mn}).apply(typeof Zb<"u"?Zb:typeof self<"u"?self:typeof window<"u"?window:{});const e3="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Xi.UNAUTHENTICATED=new Xi(null),Xi.GOOGLE_CREDENTIALS=new Xi("google-credentials-uid"),Xi.FIRST_PARTY=new Xi("first-party-uid"),Xi.MOCK_USER=new Xi("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ig="10.13.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xp=new jS("@firebase/firestore");function v0(){return xp.logLevel}function Qe(t,...e){if(xp.logLevel<=ar.DEBUG){const r=e.map(aO);xp.debug(`Firestore (${ig}): ${t}`,...r)}}function El(t,...e){if(xp.logLevel<=ar.ERROR){const r=e.map(aO);xp.error(`Firestore (${ig}): ${t}`,...r)}}function ky(t,...e){if(xp.logLevel<=ar.WARN){const r=e.map(aO);xp.warn(`Firestore (${ig}): ${t}`,...r)}}function aO(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rt(t="Unexpected state"){const e=`FIRESTORE (${ig}) INTERNAL ASSERTION FAILED: `+t;throw El(e),new Error(e)}function Hr(t,e){t||Rt()}function Mt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class bt extends Ja{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oz{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class yke{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Xi.UNAUTHENTICATED))}shutdown(){}}class gke{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class vke{constructor(e){this.t=e,this.currentUser=Xi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){let n=this.i;const s=u=>this.i!==n?(n=this.i,r(u)):Promise.resolve();let i=new lf;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new lf,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},a=u=>{Qe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?a(u):(Qe("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new lf)}},0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Qe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Hr(typeof n.accessToken=="string"),new Oz(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Hr(e===null||typeof e=="string"),new Xi(e)}}class wke{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Xi.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class _ke{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new wke(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Xi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class bke{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Eke{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){const n=i=>{i.error!=null&&Qe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,Qe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const s=i=>{Qe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):Qe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(Hr(typeof r.token=="string"),this.R=r.token,new bke(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ake(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rz{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const s=Ake(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%e.length))}return n}}function fr(t,e){return t<e?-1:t>e?1:0}function $y(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new bt(Ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new bt(Ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new bt(Ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new bt(Ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return zn.fromMillis(Date.now())}static fromDate(e){return zn.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new zn(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?fr(this.nanoseconds,e.nanoseconds):fr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ft(e)}static min(){return new Ft(new zn(0,0))}static max(){return new Ft(new zn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{constructor(e,r,n){r===void 0?r=0:r>e.length&&Rt(),n===void 0?n=e.length-r:n>e.length-r&&Rt(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return gw.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof gw?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=e.get(s),o=r.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class vn extends gw{construct(e,r,n){return new vn(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new bt(Ne.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new vn(r)}static emptyPath(){return new vn([])}}const Ske=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class $i extends gw{construct(e,r,n){return new $i(e,r,n)}static isValidIdentifier(e){return Ske.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),$i.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new $i(["__name__"])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new bt(Ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new bt(Ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new bt(Ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(n+=a,s++):(i(),s++)}if(i(),o)throw new bt(Ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new $i(r)}static emptyPath(){return new $i([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.path=e}static fromPath(e){return new Et(vn.fromString(e))}static fromName(e){return new Et(vn.fromString(e).popFirst(5))}static empty(){return new Et(vn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&vn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return vn.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Et(new vn(e.slice()))}}function Tke(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=Ft.fromTimestamp(n===1e9?new zn(r+1,0):new zn(r,n));return new _f(s,Et.empty(),e)}function Dke(t){return new _f(t.readTime,t.key,-1)}class _f{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new _f(Ft.min(),Et.empty(),-1)}static max(){return new _f(Ft.max(),Et.empty(),-1)}}function xke(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Et.comparator(t.documentKey,e.documentKey),r!==0?r:fr(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pke="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Cke{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u_(t){if(t.code!==Ne.FAILED_PRECONDITION||t.message!==Pke)throw t;Qe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Rt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Oe((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Oe?r:Oe.resolve(r)}catch(r){return Oe.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Oe.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Oe.reject(r)}static resolve(e){return new Oe((r,n)=>{r(e)})}static reject(e){return new Oe((r,n)=>{n(e)})}static waitFor(e){return new Oe((r,n)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&r()},u=>n(u))}),o=!0,i===s&&r()})}static or(e){let r=Oe.resolve(!1);for(const n of e)r=r.next(s=>s?Oe.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,i)=>{n.push(r.call(this,s,i))}),this.waitFor(n)}static mapArray(e,r){return new Oe((n,s)=>{const i=e.length,o=new Array(i);let a=0;for(let u=0;u<i;u++){const l=u;r(e[l]).next(c=>{o[l]=c,++a,a===i&&n(o)},c=>s(c))}})}static doWhile(e,r){return new Oe((n,s)=>{const i=()=>{e()===!0?r().next(()=>{i()},s):n()};i()})}}function Ike(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function c_(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uO{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}uO.oe=-1;function qS(t){return t==null}function yA(t){return t===0&&1/t==-1/0}function kke(t){return typeof t=="number"&&Number.isInteger(t)&&!yA(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t3(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function sg(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function Nz(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e,r){this.comparator=e,this.root=r||Ci.EMPTY}insert(e,r){return new pn(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Ci.BLACK,null,null))}remove(e){return new pn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ci.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Qb(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Qb(this.root,e,this.comparator,!1)}getReverseIterator(){return new Qb(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Qb(this.root,e,this.comparator,!0)}}class Qb{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ci{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??Ci.RED,this.left=s??Ci.EMPTY,this.right=i??Ci.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new Ci(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Ci.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return Ci.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ci.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ci.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Rt();const e=this.left.check();if(e!==this.right.check())throw Rt();return e+(this.isRed()?0:1)}}Ci.EMPTY=null,Ci.RED=!0,Ci.BLACK=!1;Ci.EMPTY=new class{constructor(){this.size=0}get key(){throw Rt()}get value(){throw Rt()}get color(){throw Rt()}get left(){throw Rt()}get right(){throw Rt()}copy(e,r,n,s,i){return this}insert(e,r,n){return new Ci(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi{constructor(e){this.comparator=e,this.data=new pn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new r3(this.data.getIterator())}getIteratorFrom(e){return new r3(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Fi)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Fi(this.comparator);return r.data=e,r}}class r3{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba{constructor(e){this.fields=e,e.sort($i.comparator)}static empty(){return new Ba([])}unionWith(e){let r=new Fi($i.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Ba(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return $y(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bz extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Bz("Invalid base64 string: "+i):i}}(e);return new Mi(r)}static fromUint8Array(e){const r=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Mi(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return fr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Mi.EMPTY_BYTE_STRING=new Mi("");const $ke=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function bf(t){if(Hr(!!t),typeof t=="string"){let e=0;const r=$ke.exec(t);if(Hr(!!r),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Dn(t.seconds),nanos:Dn(t.nanos)}}function Dn(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Pp(t){return typeof t=="string"?Mi.fromBase64String(t):Mi.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cO(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function lO(t){const e=t.mapValue.fields.__previous_value__;return cO(e)?lO(e):e}function vw(t){const e=bf(t.mapValue.fields.__local_write_time__.timestampValue);return new zn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oke{constructor(e,r,n,s,i,o,a,u,l){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=l}}class ww{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new ww("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof ww&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e1={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Cp(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?cO(t)?4:Nke(t)?9007199254740991:Rke(t)?10:11:Rt()}function tc(t,e){if(t===e)return!0;const r=Cp(t);if(r!==Cp(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return vw(t).isEqual(vw(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=bf(s.timestampValue),a=bf(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Pp(s.bytesValue).isEqual(Pp(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Dn(s.geoPointValue.latitude)===Dn(i.geoPointValue.latitude)&&Dn(s.geoPointValue.longitude)===Dn(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Dn(s.integerValue)===Dn(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=Dn(s.doubleValue),a=Dn(i.doubleValue);return o===a?yA(o)===yA(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return $y(t.arrayValue.values||[],e.arrayValue.values||[],tc);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(t3(o)!==t3(a))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!tc(o[u],a[u])))return!1;return!0}(t,e);default:return Rt()}}function _w(t,e){return(t.values||[]).find(r=>tc(r,e))!==void 0}function Oy(t,e){if(t===e)return 0;const r=Cp(t),n=Cp(e);if(r!==n)return fr(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return fr(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=Dn(i.integerValue||i.doubleValue),u=Dn(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(t,e);case 3:return n3(t.timestampValue,e.timestampValue);case 4:return n3(vw(t),vw(e));case 5:return fr(t.stringValue,e.stringValue);case 6:return function(i,o){const a=Pp(i),u=Pp(o);return a.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),u=o.split("/");for(let l=0;l<a.length&&l<u.length;l++){const c=fr(a[l],u[l]);if(c!==0)return c}return fr(a.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=fr(Dn(i.latitude),Dn(o.latitude));return a!==0?a:fr(Dn(i.longitude),Dn(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return i3(t.arrayValue,e.arrayValue);case 10:return function(i,o){var a,u,l,c;const d=i.fields||{},h=o.fields||{},f=(a=d.value)===null||a===void 0?void 0:a.arrayValue,p=(u=h.value)===null||u===void 0?void 0:u.arrayValue,m=fr(((l=f==null?void 0:f.values)===null||l===void 0?void 0:l.length)||0,((c=p==null?void 0:p.values)===null||c===void 0?void 0:c.length)||0);return m!==0?m:i3(f,p)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===e1.mapValue&&o===e1.mapValue)return 0;if(i===e1.mapValue)return 1;if(o===e1.mapValue)return-1;const a=i.fields||{},u=Object.keys(a),l=o.fields||{},c=Object.keys(l);u.sort(),c.sort();for(let d=0;d<u.length&&d<c.length;++d){const h=fr(u[d],c[d]);if(h!==0)return h;const f=Oy(a[u[d]],l[c[d]]);if(f!==0)return f}return fr(u.length,c.length)}(t.mapValue,e.mapValue);default:throw Rt()}}function n3(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return fr(t,e);const r=bf(t),n=bf(e),s=fr(r.seconds,n.seconds);return s!==0?s:fr(r.nanos,n.nanos)}function i3(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=Oy(r[s],n[s]);if(i)return i}return fr(r.length,n.length)}function Ry(t){return sC(t)}function sC(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=bf(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Pp(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Et.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=sC(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const o of n)i?i=!1:s+=",",s+=`${o}:${sC(r.fields[o])}`;return s+"}"}(t.mapValue):Rt()}function oC(t){return!!t&&"integerValue"in t}function dO(t){return!!t&&"arrayValue"in t}function s3(t){return!!t&&"nullValue"in t}function o3(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Q1(t){return!!t&&"mapValue"in t}function Rke(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Av(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return sg(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Av(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Av(t.arrayValue.values[r]);return e}return Object.assign({},t)}function Nke(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(e){this.value=e}static empty(){return new Qo({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Q1(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Av(r)}setAll(e){let r=$i.emptyPath(),n={},s=[];e.forEach((o,a)=>{if(!r.isImmediateParentOf(a)){const u=this.getFieldsMap(r);this.applyChanges(u,n,s),n={},s=[],r=a.popLast()}o?n[a.lastSegment()]=Av(o):s.push(a.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());Q1(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return tc(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];Q1(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){sg(r,(s,i)=>e[s]=i);for(const s of n)delete e[s]}clone(){return new Qo(Av(this.value))}}function Fz(t){const e=[];return sg(t.fields,(r,n)=>{const s=new $i([r]);if(Q1(n)){const i=Fz(n.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Ba(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{constructor(e,r,n,s,i,o,a){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Zi(e,0,Ft.min(),Ft.min(),Ft.min(),Qo.empty(),0)}static newFoundDocument(e,r,n,s){return new Zi(e,1,r,Ft.min(),n,s,0)}static newNoDocument(e,r){return new Zi(e,2,r,Ft.min(),Ft.min(),Qo.empty(),0)}static newUnknownDocument(e,r){return new Zi(e,3,r,Ft.min(),Ft.min(),Qo.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Ft.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Qo.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Qo.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ft.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Zi&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Zi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gA{constructor(e,r){this.position=e,this.inclusive=r}}function a3(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?n=Et.comparator(Et.fromName(o.referenceValue),r.key):n=Oy(o,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function u3(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!tc(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vA{constructor(e,r="asc"){this.field=e,this.dir=r}}function Bke(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mz{}class Hn extends Mz{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new Mke(e,r,n):r==="array-contains"?new Lke(e,n):r==="in"?new Kke(e,n):r==="not-in"?new Vke(e,n):r==="array-contains-any"?new qke(e,n):new Hn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new jke(e,n):new Uke(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Oy(r,this.value)):r!==null&&Cp(this.value)===Cp(r)&&this.matchesComparison(Oy(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Rt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class rc extends Mz{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new rc(e,r)}matches(e){return jz(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function jz(t){return t.op==="and"}function Uz(t){return Fke(t)&&jz(t)}function Fke(t){for(const e of t.filters)if(e instanceof rc)return!1;return!0}function aC(t){if(t instanceof Hn)return t.field.canonicalString()+t.op.toString()+Ry(t.value);if(Uz(t))return t.filters.map(e=>aC(e)).join(",");{const e=t.filters.map(r=>aC(r)).join(",");return`${t.op}(${e})`}}function Lz(t,e){return t instanceof Hn?function(n,s){return s instanceof Hn&&n.op===s.op&&n.field.isEqual(s.field)&&tc(n.value,s.value)}(t,e):t instanceof rc?function(n,s){return s instanceof rc&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((i,o,a)=>i&&Lz(o,s.filters[a]),!0):!1}(t,e):void Rt()}function Kz(t){return t instanceof Hn?function(r){return`${r.field.canonicalString()} ${r.op} ${Ry(r.value)}`}(t):t instanceof rc?function(r){return r.op.toString()+" {"+r.getFilters().map(Kz).join(" ,")+"}"}(t):"Filter"}class Mke extends Hn{constructor(e,r,n){super(e,r,n),this.key=Et.fromName(n.referenceValue)}matches(e){const r=Et.comparator(e.key,this.key);return this.matchesComparison(r)}}class jke extends Hn{constructor(e,r){super(e,"in",r),this.keys=Vz("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class Uke extends Hn{constructor(e,r){super(e,"not-in",r),this.keys=Vz("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function Vz(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Et.fromName(n.referenceValue))}class Lke extends Hn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return dO(r)&&_w(r.arrayValue,this.value)}}class Kke extends Hn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&_w(this.value.arrayValue,r)}}class Vke extends Hn{constructor(e,r){super(e,"not-in",r)}matches(e){if(_w(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!_w(this.value.arrayValue,r)}}class qke extends Hn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!dO(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>_w(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hke{constructor(e,r=null,n=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ue=null}}function c3(t,e=null,r=[],n=[],s=null,i=null,o=null){return new Hke(t,e,r,n,s,i,o)}function fO(t){const e=Mt(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>aC(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),qS(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Ry(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Ry(n)).join(",")),e.ue=r}return e.ue}function hO(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!Bke(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!Lz(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!u3(t.startAt,e.startAt)&&u3(t.endAt,e.endAt)}function uC(t){return Et.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS{constructor(e,r=null,n=[],s=[],i=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function zke(t,e,r,n,s,i,o,a){return new HS(t,e,r,n,s,i,o,a)}function pO(t){return new HS(t)}function l3(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Wke(t){return t.collectionGroup!==null}function Sv(t){const e=Mt(t);if(e.ce===null){e.ce=[];const r=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Fi($i.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.ce.push(new vA(i,n))}),r.has($i.keyField().canonicalString())||e.ce.push(new vA($i.keyField(),n))}return e.ce}function qu(t){const e=Mt(t);return e.le||(e.le=Gke(e,Sv(t))),e.le}function Gke(t,e){if(t.limitType==="F")return c3(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new vA(s.field,i)});const r=t.endAt?new gA(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new gA(t.startAt.position,t.startAt.inclusive):null;return c3(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function cC(t,e,r){return new HS(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function zS(t,e){return hO(qu(t),qu(e))&&t.limitType===e.limitType}function qz(t){return`${fO(qu(t))}|lt:${t.limitType}`}function Im(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>Kz(s)).join(", ")}]`),qS(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>Ry(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>Ry(s)).join(",")),`Target(${n})`}(qu(t))}; limitType=${t.limitType})`}function WS(t,e){return e.isFoundDocument()&&function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):Et.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,s){for(const i of Sv(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(o,a,u){const l=a3(o,a,u);return o.inclusive?l<=0:l<0}(n.startAt,Sv(n),s)||n.endAt&&!function(o,a,u){const l=a3(o,a,u);return o.inclusive?l>=0:l>0}(n.endAt,Sv(n),s))}(t,e)}function Jke(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Hz(t){return(e,r)=>{let n=!1;for(const s of Sv(t)){const i=Xke(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function Xke(t,e,r){const n=t.field.isKeyField()?Et.comparator(e.key,r.key):function(i,o,a){const u=o.data.field(i),l=a.data.field(i);return u!==null&&l!==null?Oy(u,l):Rt()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Rt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class og{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){sg(this.inner,(r,n)=>{for(const[s,i]of n)e(s,i)})}isEmpty(){return Nz(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yke=new pn(Et.comparator);function Al(){return Yke}const zz=new pn(Et.comparator);function H0(...t){let e=zz;for(const r of t)e=e.insert(r.key,r);return e}function Wz(t){let e=zz;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Vh(){return Tv()}function Gz(){return Tv()}function Tv(){return new og(t=>t.toString(),(t,e)=>t.isEqual(e))}const Zke=new pn(Et.comparator),Qke=new Fi(Et.comparator);function ir(...t){let e=Qke;for(const r of t)e=e.add(r);return e}const e$e=new Fi(fr);function t$e(){return e$e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mO(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yA(e)?"-0":e}}function Jz(t){return{integerValue:""+t}}function r$e(t,e){return kke(e)?Jz(e):mO(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(){this._=void 0}}function n$e(t,e,r){return t instanceof wA?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&cO(i)&&(i=lO(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(r,e):t instanceof bw?Yz(t,e):t instanceof Ew?Zz(t,e):function(s,i){const o=Xz(s,i),a=d3(o)+d3(s.Pe);return oC(o)&&oC(s.Pe)?Jz(a):mO(s.serializer,a)}(t,e)}function i$e(t,e,r){return t instanceof bw?Yz(t,e):t instanceof Ew?Zz(t,e):r}function Xz(t,e){return t instanceof _A?function(n){return oC(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class wA extends GS{}class bw extends GS{constructor(e){super(),this.elements=e}}function Yz(t,e){const r=Qz(e);for(const n of t.elements)r.some(s=>tc(s,n))||r.push(n);return{arrayValue:{values:r}}}class Ew extends GS{constructor(e){super(),this.elements=e}}function Zz(t,e){let r=Qz(e);for(const n of t.elements)r=r.filter(s=>!tc(s,n));return{arrayValue:{values:r}}}class _A extends GS{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function d3(t){return Dn(t.integerValue||t.doubleValue)}function Qz(t){return dO(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function s$e(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof bw&&s instanceof bw||n instanceof Ew&&s instanceof Ew?$y(n.elements,s.elements,tc):n instanceof _A&&s instanceof _A?tc(n.Pe,s.Pe):n instanceof wA&&s instanceof wA}(t.transform,e.transform)}class o$e{constructor(e,r){this.version=e,this.transformResults=r}}class dl{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new dl}static exists(e){return new dl(void 0,e)}static updateTime(e){return new dl(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function eE(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class JS{}function eW(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new rW(t.key,dl.none()):new l_(t.key,t.data,dl.none());{const r=t.data,n=Qo.empty();let s=new Fi($i.comparator);for(let i of e.fields)if(!s.has(i)){let o=r.field(i);o===null&&i.length>1&&(i=i.popLast(),o=r.field(i)),o===null?n.delete(i):n.set(i,o),s=s.add(i)}return new qp(t.key,n,new Ba(s.toArray()),dl.none())}}function a$e(t,e,r){t instanceof l_?function(s,i,o){const a=s.value.clone(),u=h3(s.fieldTransforms,i,o.transformResults);a.setAll(u),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,r):t instanceof qp?function(s,i,o){if(!eE(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=h3(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(tW(s)),u.setAll(a),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,r):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,r)}function Dv(t,e,r,n){return t instanceof l_?function(i,o,a,u){if(!eE(i.precondition,o))return a;const l=i.value.clone(),c=p3(i.fieldTransforms,u,o);return l.setAll(c),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(t,e,r,n):t instanceof qp?function(i,o,a,u){if(!eE(i.precondition,o))return a;const l=p3(i.fieldTransforms,u,o),c=o.data;return c.setAll(tW(i)),c.setAll(l),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(d=>d.field))}(t,e,r,n):function(i,o,a){return eE(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,r)}function u$e(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=Xz(n.transform,s||null);i!=null&&(r===null&&(r=Qo.empty()),r.set(n.field,i))}return r||null}function f3(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&$y(n,s,(i,o)=>s$e(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class l_ extends JS{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class qp extends JS{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function tW(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function h3(t,e,r){const n=new Map;Hr(t.length===r.length);for(let s=0;s<r.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);n.set(i.field,i$e(o,a,r[s]))}return n}function p3(t,e,r){const n=new Map;for(const s of t){const i=s.transform,o=r.data.field(s.field);n.set(s.field,n$e(i,o,e))}return n}class rW extends JS{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class c$e extends JS{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l$e{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&a$e(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Dv(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Dv(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=Gz();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=r.has(s.key)?null:a;const u=eW(o,a);u!==null&&n.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(Ft.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),ir())}isEqual(e){return this.batchId===e.batchId&&$y(this.mutations,e.mutations,(r,n)=>f3(r,n))&&$y(this.baseMutations,e.baseMutations,(r,n)=>f3(r,n))}}class yO{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){Hr(e.mutations.length===n.length);let s=function(){return Zke}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,n[o].version);return new yO(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d$e{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f$e{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Cn,ur;function h$e(t){switch(t){default:return Rt();case Ne.CANCELLED:case Ne.UNKNOWN:case Ne.DEADLINE_EXCEEDED:case Ne.RESOURCE_EXHAUSTED:case Ne.INTERNAL:case Ne.UNAVAILABLE:case Ne.UNAUTHENTICATED:return!1;case Ne.INVALID_ARGUMENT:case Ne.NOT_FOUND:case Ne.ALREADY_EXISTS:case Ne.PERMISSION_DENIED:case Ne.FAILED_PRECONDITION:case Ne.ABORTED:case Ne.OUT_OF_RANGE:case Ne.UNIMPLEMENTED:case Ne.DATA_LOSS:return!0}}function nW(t){if(t===void 0)return El("GRPC error has no .code"),Ne.UNKNOWN;switch(t){case Cn.OK:return Ne.OK;case Cn.CANCELLED:return Ne.CANCELLED;case Cn.UNKNOWN:return Ne.UNKNOWN;case Cn.DEADLINE_EXCEEDED:return Ne.DEADLINE_EXCEEDED;case Cn.RESOURCE_EXHAUSTED:return Ne.RESOURCE_EXHAUSTED;case Cn.INTERNAL:return Ne.INTERNAL;case Cn.UNAVAILABLE:return Ne.UNAVAILABLE;case Cn.UNAUTHENTICATED:return Ne.UNAUTHENTICATED;case Cn.INVALID_ARGUMENT:return Ne.INVALID_ARGUMENT;case Cn.NOT_FOUND:return Ne.NOT_FOUND;case Cn.ALREADY_EXISTS:return Ne.ALREADY_EXISTS;case Cn.PERMISSION_DENIED:return Ne.PERMISSION_DENIED;case Cn.FAILED_PRECONDITION:return Ne.FAILED_PRECONDITION;case Cn.ABORTED:return Ne.ABORTED;case Cn.OUT_OF_RANGE:return Ne.OUT_OF_RANGE;case Cn.UNIMPLEMENTED:return Ne.UNIMPLEMENTED;case Cn.DATA_LOSS:return Ne.DATA_LOSS;default:return Rt()}}(ur=Cn||(Cn={}))[ur.OK=0]="OK",ur[ur.CANCELLED=1]="CANCELLED",ur[ur.UNKNOWN=2]="UNKNOWN",ur[ur.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ur[ur.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ur[ur.NOT_FOUND=5]="NOT_FOUND",ur[ur.ALREADY_EXISTS=6]="ALREADY_EXISTS",ur[ur.PERMISSION_DENIED=7]="PERMISSION_DENIED",ur[ur.UNAUTHENTICATED=16]="UNAUTHENTICATED",ur[ur.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ur[ur.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ur[ur.ABORTED=10]="ABORTED",ur[ur.OUT_OF_RANGE=11]="OUT_OF_RANGE",ur[ur.UNIMPLEMENTED=12]="UNIMPLEMENTED",ur[ur.INTERNAL=13]="INTERNAL",ur[ur.UNAVAILABLE=14]="UNAVAILABLE",ur[ur.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p$e(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m$e=new lp([4294967295,4294967295],0);function m3(t){const e=p$e().encode(t),r=new Dz;return r.update(e),new Uint8Array(r.digest())}function y3(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new lp([r,n],0),new lp([s,i],0)]}class gO{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new z0(`Invalid padding: ${r}`);if(n<0)throw new z0(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new z0(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new z0(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=lp.fromNumber(this.Ie)}Ee(e,r,n){let s=e.add(r.multiply(lp.fromNumber(n)));return s.compare(m$e)===1&&(s=new lp([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=m3(e),[n,s]=y3(r);for(let i=0;i<this.hashCount;i++){const o=this.Ee(n,s,i);if(!this.de(o))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new gO(i,s,r);return n.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const r=m3(e),[n,s]=y3(r);for(let i=0;i<this.hashCount;i++){const o=this.Ee(n,s,i);this.Ae(o)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class z0 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,d_.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new XS(Ft.min(),s,new pn(fr),Al(),ir())}}class d_{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new d_(n,r,ir(),ir(),ir())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tE{constructor(e,r,n,s){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=s}}class iW{constructor(e,r){this.targetId=e,this.me=r}}class sW{constructor(e,r,n=Mi.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class g3{constructor(){this.fe=0,this.ge=w3(),this.pe=Mi.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ir(),r=ir(),n=ir();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:Rt()}}),new d_(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=w3()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Hr(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class y$e{constructor(e){this.Le=e,this.Be=new Map,this.ke=Al(),this.qe=v3(),this.Qe=new pn(fr)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:Rt()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,s)=>{this.ze(s)&&r(s)})}He(e){const r=e.targetId,n=e.me.count,s=this.Je(r);if(s){const i=s.target;if(uC(i))if(n===0){const o=new Et(i.path);this.Ue(r,o,Zi.newNoDocument(o,Ft.min()))}else Hr(n===1);else{const o=this.Ye(r);if(o!==n){const a=this.Ze(e),u=a?this.Xe(a,e,o):1;if(u!==0){this.je(r);const l=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,l)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let o,a;try{o=Pp(n).toUint8Array()}catch(u){if(u instanceof Bz)return ky("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new gO(o,s,i)}catch(u){return ky(u instanceof z0?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Ie===0?null:a}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let s=0;return n.forEach(i=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.Ue(r,i,null),s++)}),s}rt(e){const r=new Map;this.Be.forEach((i,o)=>{const a=this.Je(o);if(a){if(i.current&&uC(a.target)){const u=new Et(a.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,Zi.newNoDocument(u,e))}i.be&&(r.set(o,i.ve()),i.Ce())}});let n=ir();this.qe.forEach((i,o)=>{let a=!0;o.forEachWhile(u=>{const l=this.Je(u);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(n=n.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new XS(e,r,this.Qe,this.ke,n);return this.ke=Al(),this.qe=v3(),this.Qe=new pn(fr),s}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,r)?s.Fe(r,1):s.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new g3,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new Fi(fr),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||Qe("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new g3),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function v3(){return new pn(Et.comparator)}function w3(){return new pn(Et.comparator)}const g$e={asc:"ASCENDING",desc:"DESCENDING"},v$e={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},w$e={and:"AND",or:"OR"};class _$e{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function lC(t,e){return t.useProto3Json||qS(e)?e:{value:e}}function bA(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function oW(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function b$e(t,e){return bA(t,e.toTimestamp())}function Hu(t){return Hr(!!t),Ft.fromTimestamp(function(r){const n=bf(r);return new zn(n.seconds,n.nanos)}(t))}function vO(t,e){return dC(t,e).canonicalString()}function dC(t,e){const r=function(s){return new vn(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function aW(t){const e=vn.fromString(t);return Hr(fW(e)),e}function fC(t,e){return vO(t.databaseId,e.path)}function kD(t,e){const r=aW(e);if(r.get(1)!==t.databaseId.projectId)throw new bt(Ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new bt(Ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Et(cW(r))}function uW(t,e){return vO(t.databaseId,e)}function E$e(t){const e=aW(t);return e.length===4?vn.emptyPath():cW(e)}function hC(t){return new vn(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function cW(t){return Hr(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function _3(t,e,r){return{name:fC(t,e),fields:r.value.mapValue.fields}}function A$e(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:Rt()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(l,c){return l.useProto3Json?(Hr(c===void 0||typeof c=="string"),Mi.fromBase64String(c||"")):(Hr(c===void 0||c instanceof Buffer||c instanceof Uint8Array),Mi.fromUint8Array(c||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){const c=l.code===void 0?Ne.UNKNOWN:nW(l.code);return new bt(c,l.message||"")}(o);r=new sW(n,s,i,a||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=kD(t,n.document.name),i=Hu(n.document.updateTime),o=n.document.createTime?Hu(n.document.createTime):Ft.min(),a=new Qo({mapValue:{fields:n.document.fields}}),u=Zi.newFoundDocument(s,i,o,a),l=n.targetIds||[],c=n.removedTargetIds||[];r=new tE(l,c,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=kD(t,n.document),i=n.readTime?Hu(n.readTime):Ft.min(),o=Zi.newNoDocument(s,i),a=n.removedTargetIds||[];r=new tE([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=kD(t,n.document),i=n.removedTargetIds||[];r=new tE([],i,s,null)}else{if(!("filter"in e))return Rt();{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,o=new f$e(s,i),a=n.targetId;r=new iW(a,o)}}return r}function S$e(t,e){let r;if(e instanceof l_)r={update:_3(t,e.key,e.value)};else if(e instanceof rW)r={delete:fC(t,e.key)};else if(e instanceof qp)r={update:_3(t,e.key,e.data),updateMask:O$e(e.fieldMask)};else{if(!(e instanceof c$e))return Rt();r={verify:fC(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(i,o){const a=o.transform;if(a instanceof wA)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof bw)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ew)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof _A)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw Rt()}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:b$e(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Rt()}(t,e.precondition)),r}function T$e(t,e){return t&&t.length>0?(Hr(e!==void 0),t.map(r=>function(s,i){let o=s.updateTime?Hu(s.updateTime):Hu(i);return o.isEqual(Ft.min())&&(o=Hu(i)),new o$e(o,s.transformResults||[])}(r,e))):[]}function D$e(t,e){return{documents:[uW(t,e.path)]}}function x$e(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=uW(t,s);const i=function(l){if(l.length!==0)return dW(rc.create(l,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const o=function(l){if(l.length!==0)return l.map(c=>function(h){return{field:km(h.field),direction:I$e(h.dir)}}(c))}(e.orderBy);o&&(r.structuredQuery.orderBy=o);const a=lC(t,e.limit);return a!==null&&(r.structuredQuery.limit=a),e.startAt&&(r.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:r,parent:s}}function P$e(t){let e=E$e(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){Hr(n===1);const c=r.from[0];c.allDescendants?s=c.collectionId:e=e.child(c.collectionId)}let i=[];r.where&&(i=function(d){const h=lW(d);return h instanceof rc&&Uz(h)?h.getFilters():[h]}(r.where));let o=[];r.orderBy&&(o=function(d){return d.map(h=>function(p){return new vA($m(p.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(r.orderBy));let a=null;r.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,qS(h)?null:h}(r.limit));let u=null;r.startAt&&(u=function(d){const h=!!d.before,f=d.values||[];return new gA(f,h)}(r.startAt));let l=null;return r.endAt&&(l=function(d){const h=!d.before,f=d.values||[];return new gA(f,h)}(r.endAt)),zke(e,s,o,i,a,"F",u,l)}function C$e(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Rt()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function lW(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=$m(r.unaryFilter.field);return Hn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=$m(r.unaryFilter.field);return Hn.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=$m(r.unaryFilter.field);return Hn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=$m(r.unaryFilter.field);return Hn.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Rt()}}(t):t.fieldFilter!==void 0?function(r){return Hn.create($m(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Rt()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return rc.create(r.compositeFilter.filters.map(n=>lW(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Rt()}}(r.compositeFilter.op))}(t):Rt()}function I$e(t){return g$e[t]}function k$e(t){return v$e[t]}function $$e(t){return w$e[t]}function km(t){return{fieldPath:t.canonicalString()}}function $m(t){return $i.fromServerFormat(t.fieldPath)}function dW(t){return t instanceof Hn?function(r){if(r.op==="=="){if(o3(r.value))return{unaryFilter:{field:km(r.field),op:"IS_NAN"}};if(s3(r.value))return{unaryFilter:{field:km(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(o3(r.value))return{unaryFilter:{field:km(r.field),op:"IS_NOT_NAN"}};if(s3(r.value))return{unaryFilter:{field:km(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:km(r.field),op:k$e(r.op),value:r.value}}}(t):t instanceof rc?function(r){const n=r.getFilters().map(s=>dW(s));return n.length===1?n[0]:{compositeFilter:{op:$$e(r.op),filters:n}}}(t):Rt()}function O$e(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function fW(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xd{constructor(e,r,n,s,i=Ft.min(),o=Ft.min(),a=Mi.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new Xd(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Xd(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Xd(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Xd(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R$e{constructor(e){this.ct=e}}function N$e(t){const e=P$e({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?cC(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B$e{constructor(){this.un=new F$e}addToCollectionParentIndex(e,r){return this.un.add(r),Oe.resolve()}getCollectionParents(e,r){return Oe.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Oe.resolve()}deleteFieldIndex(e,r){return Oe.resolve()}deleteAllFieldIndexes(e){return Oe.resolve()}createTargetIndexes(e,r){return Oe.resolve()}getDocumentsMatchingTarget(e,r){return Oe.resolve(null)}getIndexType(e,r){return Oe.resolve(0)}getFieldIndexes(e,r){return Oe.resolve([])}getNextCollectionGroupToUpdate(e){return Oe.resolve(null)}getMinOffset(e,r){return Oe.resolve(_f.min())}getMinOffsetFromCollectionGroup(e,r){return Oe.resolve(_f.min())}updateCollectionGroup(e,r,n){return Oe.resolve()}updateIndexEntries(e,r){return Oe.resolve()}}class F$e{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new Fi(vn.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Fi(vn.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Ny(0)}static kn(){return new Ny(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M$e{constructor(){this.changes=new og(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Zi.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Oe.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j$e{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U$e{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&Dv(n.mutation,s,Ba.empty(),zn.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,ir()).next(()=>n))}getLocalViewOfDocuments(e,r,n=ir()){const s=Vh();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(i=>{let o=H0();return i.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,r){const n=Vh();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,ir()))}populateOverlays(e,r,n){const s=[];return n.forEach(i=>{r.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{r.set(o,a)})})}computeViews(e,r,n,s){let i=Al();const o=Tv(),a=function(){return Tv()}();return r.forEach((u,l)=>{const c=n.get(l.key);s.has(l.key)&&(c===void 0||c.mutation instanceof qp)?i=i.insert(l.key,l):c!==void 0?(o.set(l.key,c.mutation.getFieldMask()),Dv(c.mutation,l,c.mutation.getFieldMask(),zn.now())):o.set(l.key,Ba.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((l,c)=>o.set(l,c)),r.forEach((l,c)=>{var d;return a.set(l,new j$e(c,(d=o.get(l))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,r){const n=Tv();let s=new pn((o,a)=>o-a),i=ir();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(o=>{for(const a of o)a.keys().forEach(u=>{const l=r.get(u);if(l===null)return;let c=n.get(u)||Ba.empty();c=a.applyToLocalView(l,c),n.set(u,c);const d=(s.get(a.batchId)||ir()).add(u);s=s.insert(a.batchId,d)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const u=a.getNext(),l=u.key,c=u.value,d=Gz();c.forEach(h=>{if(!i.has(h)){const f=eW(r.get(h),n.get(h));f!==null&&d.set(h,f),i=i.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,d))}return Oe.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(o){return Et.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):Wke(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):Oe.resolve(Vh());let a=-1,u=i;return o.next(l=>Oe.forEach(l,(c,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),i.get(c)?Oe.resolve():this.remoteDocumentCache.getEntry(e,c).next(h=>{u=u.insert(c,h)}))).next(()=>this.populateOverlays(e,l,i)).next(()=>this.computeViews(e,u,l,ir())).next(c=>({batchId:a,changes:Wz(c)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Et(r)).next(n=>{let s=H0();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let o=H0();return this.indexManager.getCollectionParents(e,i).next(a=>Oe.forEach(a,u=>{const l=function(d,h){return new HS(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(r,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,l,n,s).next(c=>{c.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s))).next(o=>{i.forEach((u,l)=>{const c=l.getKey();o.get(c)===null&&(o=o.insert(c,Zi.newInvalidDocument(c)))});let a=H0();return o.forEach((u,l)=>{const c=i.get(u);c!==void 0&&Dv(c.mutation,l,Ba.empty(),zn.now()),WS(r,l)&&(a=a.insert(u,l))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L$e{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Oe.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:Hu(s.createTime)}}(r)),Oe.resolve()}getNamedQuery(e,r){return Oe.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(s){return{name:s.name,query:N$e(s.bundledQuery),readTime:Hu(s.readTime)}}(r)),Oe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K$e{constructor(){this.overlays=new pn(Et.comparator),this.Ir=new Map}getOverlay(e,r){return Oe.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Vh();return Oe.forEach(r,s=>this.getOverlay(e,s).next(i=>{i!==null&&n.set(s,i)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,i)=>{this.ht(e,r,i)}),Oe.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.Ir.get(n);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(n)),Oe.resolve()}getOverlaysForCollection(e,r,n){const s=Vh(),i=r.length+1,o=new Et(r.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const u=a.getNext().value,l=u.getKey();if(!r.isPrefixOf(l.path))break;l.path.length===i&&u.largestBatchId>n&&s.set(u.getKey(),u)}return Oe.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new pn((l,c)=>l-c);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===r&&l.largestBatchId>n){let c=i.get(l.largestBatchId);c===null&&(c=Vh(),i=i.insert(l.largestBatchId,c)),c.set(l.getKey(),l)}}const a=Vh(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((l,c)=>a.set(l,c)),!(a.size()>=s)););return Oe.resolve(a)}ht(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(n.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new d$e(r,n));let i=this.Ir.get(r);i===void 0&&(i=ir(),this.Ir.set(r,i)),this.Ir.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V$e{constructor(){this.sessionToken=Mi.EMPTY_BYTE_STRING}getSessionToken(e){return Oe.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Oe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wO{constructor(){this.Tr=new Fi(ti.Er),this.dr=new Fi(ti.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new ti(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new ti(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new Et(new vn([])),n=new ti(r,e),s=new ti(r,e+1),i=[];return this.dr.forEachInRange([n,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new Et(new vn([])),n=new ti(r,e),s=new ti(r,e+1);let i=ir();return this.dr.forEachInRange([n,s],o=>{i=i.add(o.key)}),i}containsKey(e){const r=new ti(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class ti{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return Et.comparator(e.key,r.key)||fr(e.wr,r.wr)}static Ar(e,r){return fr(e.wr,r.wr)||Et.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q$e{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new Fi(ti.Er)}checkEmpty(e){return Oe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new l$e(i,r,n,s);this.mutationQueue.push(o);for(const a of s)this.br=this.br.add(new ti(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return Oe.resolve(o)}lookupMutationBatch(e,r){return Oe.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.vr(n),i=s<0?0:s;return Oe.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Oe.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new ti(r,0),s=new ti(r,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,s],o=>{const a=this.Dr(o.wr);i.push(a)}),Oe.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Fi(fr);return r.forEach(s=>{const i=new ti(s,0),o=new ti(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],a=>{n=n.add(a.wr)})}),Oe.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;Et.isDocumentKey(i)||(i=i.child(""));const o=new ti(new Et(i),0);let a=new Fi(fr);return this.br.forEachWhile(u=>{const l=u.key.path;return!!n.isPrefixOf(l)&&(l.length===s&&(a=a.add(u.wr)),!0)},o),Oe.resolve(this.Cr(a))}Cr(e){const r=[];return e.forEach(n=>{const s=this.Dr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){Hr(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Oe.forEach(r.mutations,s=>{const i=new ti(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new ti(r,0),s=this.br.firstAfterOrEqual(n);return Oe.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Oe.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H$e{constructor(e){this.Mr=e,this.docs=function(){return new pn(Et.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,o=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Oe.resolve(n?n.document.mutableCopy():Zi.newInvalidDocument(r))}getEntries(e,r){let n=Al();return r.forEach(s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():Zi.newInvalidDocument(s))}),Oe.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=Al();const o=r.path,a=new Et(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){const{key:l,value:{document:c}}=u.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||xke(Dke(c),n)<=0||(s.has(c.key)||WS(r,c))&&(i=i.insert(c.key,c.mutableCopy()))}return Oe.resolve(i)}getAllFromCollectionGroup(e,r,n,s){Rt()}Or(e,r){return Oe.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new z$e(this)}getSize(e){return Oe.resolve(this.size)}}class z$e extends M$e{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.cr.addEntry(e,s)):this.cr.removeEntry(n)}),Oe.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W$e{constructor(e){this.persistence=e,this.Nr=new og(r=>fO(r),hO),this.lastRemoteSnapshotVersion=Ft.min(),this.highestTargetId=0,this.Lr=0,this.Br=new wO,this.targetCount=0,this.kr=Ny.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,s)=>r(s)),Oe.resolve()}getLastRemoteSnapshotVersion(e){return Oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Oe.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Oe.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Oe.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new Ny(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Oe.resolve()}updateTargetData(e,r){return this.Kn(r),Oe.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Oe.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=r&&n.get(a.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),Oe.waitFor(i).next(()=>s)}getTargetCount(e){return Oe.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Oe.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Oe.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),Oe.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Oe.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Oe.resolve(n)}containsKey(e,r){return Oe.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G$e{constructor(e,r){this.qr={},this.overlays={},this.Qr=new uO(0),this.Kr=!1,this.Kr=!0,this.$r=new V$e,this.referenceDelegate=e(this),this.Ur=new W$e(this),this.indexManager=new B$e,this.remoteDocumentCache=function(s){return new H$e(s)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new R$e(r),this.Gr=new L$e(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new K$e,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new q$e(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){Qe("MemoryPersistence","Starting transaction:",e);const s=new J$e(this.Qr.next());return this.referenceDelegate.zr(),n(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,r){return Oe.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class J$e extends Cke{constructor(e){super(),this.currentSequenceNumber=e}}class _O{constructor(e){this.persistence=e,this.Jr=new wO,this.Yr=null}static Zr(e){return new _O(e)}get Xr(){if(this.Yr)return this.Yr;throw Rt()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Oe.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Oe.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Oe.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(s=>this.Xr.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Oe.forEach(this.Xr,n=>{const s=Et.fromPath(n);return this.ei(e,s).next(i=>{i||r.removeEntry(s,Ft.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Oe.or([()=>Oe.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bO{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=s}static Wi(e,r){let n=ir(),s=ir();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new bO(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X$e{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y$e{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Vxe()?8:Ike(ts())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.Yi(e,r).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,r,s,n).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new X$e;return this.Xi(e,r,o).next(a=>{if(i.result=a,this.zi)return this.es(e,r,o,a.size)})}).next(()=>i.result)}es(e,r,n,s){return n.documentReadCount<this.ji?(v0()<=ar.DEBUG&&Qe("QueryEngine","SDK will not create cache indexes for query:",Im(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Oe.resolve()):(v0()<=ar.DEBUG&&Qe("QueryEngine","Query:",Im(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Hi*s?(v0()<=ar.DEBUG&&Qe("QueryEngine","The SDK decides to create cache indexes for query:",Im(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,qu(r))):Oe.resolve())}Yi(e,r){if(l3(r))return Oe.resolve(null);let n=qu(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=cC(r,null,"F"),n=qu(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const o=ir(...i);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,n).next(u=>{const l=this.ts(r,a);return this.ns(r,l,o,u.readTime)?this.Yi(e,cC(r,null,"F")):this.rs(e,l,r,u)}))})))}Zi(e,r,n,s){return l3(r)||s.isEqual(Ft.min())?Oe.resolve(null):this.Ji.getDocuments(e,n).next(i=>{const o=this.ts(r,i);return this.ns(r,o,n,s)?Oe.resolve(null):(v0()<=ar.DEBUG&&Qe("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Im(r)),this.rs(e,o,r,Tke(s,-1)).next(a=>a))})}ts(e,r){let n=new Fi(Hz(e));return r.forEach((s,i)=>{WS(e,i)&&(n=n.add(i))}),n}ns(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,r,n){return v0()<=ar.DEBUG&&Qe("QueryEngine","Using full collection scan to execute query:",Im(r)),this.Ji.getDocumentsMatchingQuery(e,r,_f.min(),n)}rs(e,r,n,s){return this.Ji.getDocumentsMatchingQuery(e,n,s).next(i=>(r.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z$e{constructor(e,r,n,s){this.persistence=e,this.ss=r,this.serializer=s,this.os=new pn(fr),this._s=new og(i=>fO(i),hO),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new U$e(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function Q$e(t,e,r,n){return new Z$e(t,e,r,n)}async function hW(t,e){const r=Mt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(i=>(s=i,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(i=>{const o=[],a=[];let u=ir();for(const l of s){o.push(l.batchId);for(const c of l.mutations)u=u.add(c.key)}for(const l of i){a.push(l.batchId);for(const c of l.mutations)u=u.add(c.key)}return r.localDocuments.getDocuments(n,u).next(l=>({hs:l,removedBatchIds:o,addedBatchIds:a}))})})}function eOe(t,e){const r=Mt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),i=r.cs.newChangeBuffer({trackRemovals:!0});return function(a,u,l,c){const d=l.batch,h=d.keys();let f=Oe.resolve();return h.forEach(p=>{f=f.next(()=>c.getEntry(u,p)).next(m=>{const E=l.docVersions.get(p);Hr(E!==null),m.version.compareTo(E)<0&&(d.applyToRemoteDocument(m,l),m.isValidDocument()&&(m.setReadTime(l.commitVersion),c.addEntry(m)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(u,d))}(r,n,e,i).next(()=>i.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(a){let u=ir();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(u=u.add(a.batch.mutations[l].key));return u}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function pW(t){const e=Mt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function tOe(t,e){const r=Mt(t),n=e.snapshotVersion;let s=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=r.cs.newChangeBuffer({trackRemovals:!0});s=r.os;const a=[];e.targetChanges.forEach((c,d)=>{const h=s.get(d);if(!h)return;a.push(r.Ur.removeMatchingKeys(i,c.removedDocuments,d).next(()=>r.Ur.addMatchingKeys(i,c.addedDocuments,d)));let f=h.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(d)!==null?f=f.withResumeToken(Mi.EMPTY_BYTE_STRING,Ft.min()).withLastLimboFreeSnapshotVersion(Ft.min()):c.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(c.resumeToken,n)),s=s.insert(d,f),function(m,E,A){return m.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-m.snapshotVersion.toMicroseconds()>=3e8?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(h,f,c)&&a.push(r.Ur.updateTargetData(i,f))});let u=Al(),l=ir();if(e.documentUpdates.forEach(c=>{e.resolvedLimboDocuments.has(c)&&a.push(r.persistence.referenceDelegate.updateLimboDocument(i,c))}),a.push(rOe(i,o,e.documentUpdates).next(c=>{u=c.Ps,l=c.Is})),!n.isEqual(Ft.min())){const c=r.Ur.getLastRemoteSnapshotVersion(i).next(d=>r.Ur.setTargetsMetadata(i,i.currentSequenceNumber,n));a.push(c)}return Oe.waitFor(a).next(()=>o.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,u,l)).next(()=>u)}).then(i=>(r.os=s,i))}function rOe(t,e,r){let n=ir(),s=ir();return r.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let o=Al();return r.forEach((a,u)=>{const l=i.get(a);u.isFoundDocument()!==l.isFoundDocument()&&(s=s.add(a)),u.isNoDocument()&&u.version.isEqual(Ft.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!l.isValidDocument()||u.version.compareTo(l.version)>0||u.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):Qe("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",u.version)}),{Ps:o,Is:s}})}function nOe(t,e){const r=Mt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function iOe(t,e){const r=Mt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ur.getTargetData(n,e).next(i=>i?(s=i,Oe.resolve(s)):r.Ur.allocateTargetId(n).next(o=>(s=new Xd(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.os.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function pC(t,e,r){const n=Mt(t),s=n.os.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,o=>n.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!c_(o))throw o;Qe("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.os=n.os.remove(e),n._s.delete(s.target)}function b3(t,e,r){const n=Mt(t);let s=Ft.min(),i=ir();return n.persistence.runTransaction("Execute query","readwrite",o=>function(u,l,c){const d=Mt(u),h=d._s.get(c);return h!==void 0?Oe.resolve(d.os.get(h)):d.Ur.getTargetData(l,c)}(n,o,qu(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(o,a.targetId).next(u=>{i=u})}).next(()=>n.ss.getDocumentsMatchingQuery(o,e,r?s:Ft.min(),r?i:ir())).next(a=>(sOe(n,Jke(e),a),{documents:a,Ts:i})))}function sOe(t,e,r){let n=t.us.get(e)||Ft.min();r.forEach((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.us.set(e,n)}class E3{constructor(){this.activeTargetIds=t$e()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class oOe{constructor(){this.so=new E3,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e){return this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new E3,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aOe{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A3{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Qe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Qe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let t1=null;function $D(){return t1===null?t1=function(){return 268435456+Math.round(2147483648*Math.random())}():t1++,"0x"+t1.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uOe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cOe{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zi="WebChannelConnection";class lOe extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(r,n,s,i,o){const a=$D(),u=this.xo(r,n.toUriEncodedString());Qe("RestConnection",`Sending RPC '${r}' ${a}:`,u,s);const l={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(l,i,o),this.No(r,u,l,s).then(c=>(Qe("RestConnection",`Received RPC '${r}' ${a}: `,c),c),c=>{throw ky("RestConnection",`RPC '${r}' ${a} failed with error: `,c,"url: ",u,"request:",s),c})}Lo(r,n,s,i,o,a){return this.Mo(r,n,s,i,o)}Oo(r,n,s){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ig}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,o)=>r[o]=i),s&&s.headers.forEach((i,o)=>r[o]=i)}xo(r,n){const s=uOe[r];return`${this.Do}/v1/${n}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,s){const i=$D();return new Promise((o,a)=>{const u=new xz;u.setWithCredentials(!0),u.listenOnce(Cz.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Z1.NO_ERROR:const c=u.getResponseJson();Qe(zi,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(c)),o(c);break;case Z1.TIMEOUT:Qe(zi,`RPC '${e}' ${i} timed out`),a(new bt(Ne.DEADLINE_EXCEEDED,"Request time out"));break;case Z1.HTTP_ERROR:const d=u.getStatus();if(Qe(zi,`RPC '${e}' ${i} failed with status:`,d,"response text:",u.getResponseText()),d>0){let h=u.getResponseJson();Array.isArray(h)&&(h=h[0]);const f=h==null?void 0:h.error;if(f&&f.status&&f.message){const p=function(E){const A=E.toLowerCase().replace(/_/g,"-");return Object.values(Ne).indexOf(A)>=0?A:Ne.UNKNOWN}(f.status);a(new bt(p,f.message))}else a(new bt(Ne.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new bt(Ne.UNAVAILABLE,"Connection failed."));break;default:Rt()}}finally{Qe(zi,`RPC '${e}' ${i} completed.`)}});const l=JSON.stringify(s);Qe(zi,`RPC '${e}' ${i} sending request:`,s),u.send(r,"POST",l,n,15)})}Bo(e,r,n){const s=$D(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=$z(),a=kz(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.xmlHttpFactory=new Pz({})),this.Oo(u.initMessageHeaders,r,n),u.encodeInitMessageHeaders=!0;const c=i.join("");Qe(zi,`Creating RPC '${e}' stream ${s}: ${c}`,u);const d=o.createWebChannel(c,u);let h=!1,f=!1;const p=new cOe({Io:E=>{f?Qe(zi,`Not sending because RPC '${e}' stream ${s} is closed:`,E):(h||(Qe(zi,`Opening RPC '${e}' stream ${s} transport.`),d.open(),h=!0),Qe(zi,`RPC '${e}' stream ${s} sending:`,E),d.send(E))},To:()=>d.close()}),m=(E,A,_)=>{E.listen(A,g=>{try{_(g)}catch(v){setTimeout(()=>{throw v},0)}})};return m(d,q0.EventType.OPEN,()=>{f||(Qe(zi,`RPC '${e}' stream ${s} transport opened.`),p.yo())}),m(d,q0.EventType.CLOSE,()=>{f||(f=!0,Qe(zi,`RPC '${e}' stream ${s} transport closed`),p.So())}),m(d,q0.EventType.ERROR,E=>{f||(f=!0,ky(zi,`RPC '${e}' stream ${s} transport errored:`,E),p.So(new bt(Ne.UNAVAILABLE,"The operation could not be completed")))}),m(d,q0.EventType.MESSAGE,E=>{var A;if(!f){const _=E.data[0];Hr(!!_);const g=_,v=g.error||((A=g[0])===null||A===void 0?void 0:A.error);if(v){Qe(zi,`RPC '${e}' stream ${s} received error:`,v);const S=v.status;let x=function(b){const T=Cn[b];if(T!==void 0)return nW(T)}(S),D=v.message;x===void 0&&(x=Ne.INTERNAL,D="Unknown error status: "+S+" with message "+v.message),f=!0,p.So(new bt(x,D)),d.close()}else Qe(zi,`RPC '${e}' stream ${s} received:`,_),p.bo(_)}}),m(a,Iz.STAT_EVENT,E=>{E.stat===iC.PROXY?Qe(zi,`RPC '${e}' stream ${s} detected buffering proxy`):E.stat===iC.NOPROXY&&Qe(zi,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{p.wo()},0),p}}function OD(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YS(t){return new _$e(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mW{constructor(e,r,n=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),s=Math.max(0,r-n);s>0&&Qe("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yW{constructor(e,r,n,s,i,o,a,u){this.ui=e,this.Ho=n,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new mW(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===Ne.RESOURCE_EXHAUSTED?(El(r.toString()),El("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===Ne.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Yo===r&&this.P_(n,s)},n=>{e(()=>{const s=new bt(Ne.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(s)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{n(()=>this.I_(s))}),this.stream.onMessage(s=>{n(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Qe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(Qe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class dOe extends yW{constructor(e,r,n,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,o),this.serializer=i}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=A$e(this.serializer,e),n=function(i){if(!("targetChange"in i))return Ft.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Ft.min():o.readTime?Hu(o.readTime):Ft.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=hC(this.serializer),r.addTarget=function(i,o){let a;const u=o.target;if(a=uC(u)?{documents:D$e(i,u)}:{query:x$e(i,u)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=oW(i,o.resumeToken);const l=lC(i,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(Ft.min())>0){a.readTime=bA(i,o.snapshotVersion.toTimestamp());const l=lC(i,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);const n=C$e(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=hC(this.serializer),r.removeTarget=e,this.a_(r)}}class fOe extends yW{constructor(e,r,n,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return Hr(!!e.streamToken),this.lastStreamToken=e.streamToken,Hr(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Hr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=T$e(e.writeResults,e.commitTime),n=Hu(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=hC(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>S$e(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hOe extends class{}{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new bt(Ne.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,dC(r,n),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new bt(Ne.UNKNOWN,i.toString())})}Lo(e,r,n,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,dC(r,n),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new bt(Ne.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class pOe{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(El(r),this.D_=!1):Qe("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mOe{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{n.enqueueAndForget(async()=>{Hp(this)&&(Qe("RemoteStore","Restarting streams for network reachability change."),await async function(u){const l=Mt(u);l.L_.add(4),await f_(l),l.q_.set("Unknown"),l.L_.delete(4),await ZS(l)}(this))})}),this.q_=new pOe(n,s)}}async function ZS(t){if(Hp(t))for(const e of t.B_)await e(!0)}async function f_(t){for(const e of t.B_)await e(!1)}function gW(t,e){const r=Mt(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),TO(r)?SO(r):ag(r).r_()&&AO(r,e))}function EO(t,e){const r=Mt(t),n=ag(r);r.N_.delete(e),n.r_()&&vW(r,e),r.N_.size===0&&(n.r_()?n.o_():Hp(r)&&r.q_.set("Unknown"))}function AO(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ft.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}ag(t).A_(e)}function vW(t,e){t.Q_.xe(e),ag(t).R_(e)}function SO(t){t.Q_=new y$e({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),ag(t).start(),t.q_.v_()}function TO(t){return Hp(t)&&!ag(t).n_()&&t.N_.size>0}function Hp(t){return Mt(t).L_.size===0}function wW(t){t.Q_=void 0}async function yOe(t){t.q_.set("Online")}async function gOe(t){t.N_.forEach((e,r)=>{AO(t,e)})}async function vOe(t,e){wW(t),TO(t)?(t.q_.M_(e),SO(t)):t.q_.set("Unknown")}async function wOe(t,e,r){if(t.q_.set("Online"),e instanceof sW&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.N_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.N_.delete(a),s.Q_.removeTarget(a))}(t,e)}catch(n){Qe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await EA(t,n)}else if(e instanceof tE?t.Q_.Ke(e):e instanceof iW?t.Q_.He(e):t.Q_.We(e),!r.isEqual(Ft.min()))try{const n=await pW(t.localStore);r.compareTo(n)>=0&&await function(i,o){const a=i.Q_.rt(o);return a.targetChanges.forEach((u,l)=>{if(u.resumeToken.approximateByteSize()>0){const c=i.N_.get(l);c&&i.N_.set(l,c.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,l)=>{const c=i.N_.get(u);if(!c)return;i.N_.set(u,c.withResumeToken(Mi.EMPTY_BYTE_STRING,c.snapshotVersion)),vW(i,u);const d=new Xd(c.target,u,l,c.sequenceNumber);AO(i,d)}),i.remoteSyncer.applyRemoteEvent(a)}(t,r)}catch(n){Qe("RemoteStore","Failed to raise snapshot:",n),await EA(t,n)}}async function EA(t,e,r){if(!c_(e))throw e;t.L_.add(1),await f_(t),t.q_.set("Offline"),r||(r=()=>pW(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Qe("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await ZS(t)})}function _W(t,e){return e().catch(r=>EA(t,r,e))}async function QS(t){const e=Mt(t),r=Ef(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;_Oe(e);)try{const s=await nOe(e.localStore,n);if(s===null){e.O_.length===0&&r.o_();break}n=s.batchId,bOe(e,s)}catch(s){await EA(e,s)}bW(e)&&EW(e)}function _Oe(t){return Hp(t)&&t.O_.length<10}function bOe(t,e){t.O_.push(e);const r=Ef(t);r.r_()&&r.V_&&r.m_(e.mutations)}function bW(t){return Hp(t)&&!Ef(t).n_()&&t.O_.length>0}function EW(t){Ef(t).start()}async function EOe(t){Ef(t).p_()}async function AOe(t){const e=Ef(t);for(const r of t.O_)e.m_(r.mutations)}async function SOe(t,e,r){const n=t.O_.shift(),s=yO.from(n,e,r);await _W(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await QS(t)}async function TOe(t,e){e&&Ef(t).V_&&await async function(n,s){if(function(o){return h$e(o)&&o!==Ne.ABORTED}(s.code)){const i=n.O_.shift();Ef(n).s_(),await _W(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await QS(n)}}(t,e),bW(t)&&EW(t)}async function S3(t,e){const r=Mt(t);r.asyncQueue.verifyOperationInProgress(),Qe("RemoteStore","RemoteStore received new credentials");const n=Hp(r);r.L_.add(3),await f_(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await ZS(r)}async function DOe(t,e){const r=Mt(t);e?(r.L_.delete(2),await ZS(r)):e||(r.L_.add(2),await f_(r),r.q_.set("Unknown"))}function ag(t){return t.K_||(t.K_=function(r,n,s){const i=Mt(r);return i.w_(),new dOe(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:yOe.bind(null,t),Ro:gOe.bind(null,t),mo:vOe.bind(null,t),d_:wOe.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),TO(t)?SO(t):t.q_.set("Unknown")):(await t.K_.stop(),wW(t))})),t.K_}function Ef(t){return t.U_||(t.U_=function(r,n,s){const i=Mt(r);return i.w_(),new fOe(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:EOe.bind(null,t),mo:TOe.bind(null,t),f_:AOe.bind(null,t),g_:SOe.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await QS(t)):(await t.U_.stop(),t.O_.length>0&&(Qe("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DO{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new lf,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const o=Date.now()+n,a=new DO(e,r,o,s,i);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new bt(Ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function xO(t,e){if(El("AsyncQueue",`${e}: ${t}`),c_(t))return new bt(Ne.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(e){this.comparator=e?(r,n)=>e(r,n)||Et.comparator(r.key,n.key):(r,n)=>Et.comparator(r.key,n.key),this.keyedMap=H0(),this.sortedSet=new pn(this.comparator)}static emptySet(e){return new oy(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof oy)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new oy;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T3{constructor(){this.W_=new pn(Et.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):Rt():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class By{constructor(e,r,n,s,i,o,a,u,l){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=l}static fromInitialDocuments(e,r,n,s,i){const o=[];return r.forEach(a=>{o.push({type:0,doc:a})}),new By(e,r,oy.emptySet(r),o,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&zS(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xOe{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class POe{constructor(){this.queries=D3(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const s=Mt(r),i=s.queries;s.queries=D3(),i.forEach((o,a)=>{for(const u of a.j_)u.onError(n)})})(this,new bt(Ne.ABORTED,"Firestore shutting down"))}}function D3(){return new og(t=>qz(t),zS)}async function COe(t,e){const r=Mt(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.H_()&&e.J_()&&(n=2):(i=new xOe,n=e.J_()?0:1);try{switch(n){case 0:i.z_=await r.onListen(s,!0);break;case 1:i.z_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(o){const a=xO(o,`Initialization of query '${Im(e.query)}' failed`);return void e.onError(a)}r.queries.set(s,i),i.j_.push(e),e.Z_(r.onlineState),i.z_&&e.X_(i.z_)&&PO(r)}async function IOe(t,e){const r=Mt(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function kOe(t,e){const r=Mt(t);let n=!1;for(const s of e){const i=s.query,o=r.queries.get(i);if(o){for(const a of o.j_)a.X_(s)&&(n=!0);o.z_=s}}n&&PO(r)}function $Oe(t,e,r){const n=Mt(t),s=n.queries.get(e);if(s)for(const i of s.j_)i.onError(r);n.queries.delete(e)}function PO(t){t.Y_.forEach(e=>{e.next()})}var mC,x3;(x3=mC||(mC={})).ea="default",x3.Cache="cache";class OOe{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new By(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=By.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==mC.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AW{constructor(e){this.key=e}}class SW{constructor(e){this.key=e}}class ROe{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ir(),this.mutatedKeys=ir(),this.Aa=Hz(e),this.Ra=new oy(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new T3,s=r?r.Ra:this.Ra;let i=r?r.mutatedKeys:this.mutatedKeys,o=s,a=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,l=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((c,d)=>{const h=s.get(c),f=WS(this.query,d)?d:null,p=!!h&&this.mutatedKeys.has(h.key),m=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let E=!1;h&&f?h.data.isEqual(f.data)?p!==m&&(n.track({type:3,doc:f}),E=!0):this.ga(h,f)||(n.track({type:2,doc:f}),E=!0,(u&&this.Aa(f,u)>0||l&&this.Aa(f,l)<0)&&(a=!0)):!h&&f?(n.track({type:0,doc:f}),E=!0):h&&!f&&(n.track({type:1,doc:h}),E=!0,(u||l)&&(a=!0)),E&&(f?(o=o.add(f),i=m?i.add(c):i.delete(c)):(o=o.delete(c),i=i.delete(c)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const c=this.query.limitType==="F"?o.last():o.first();o=o.delete(c.key),i=i.delete(c.key),n.track({type:1,doc:c})}return{Ra:o,fa:n,ns:a,mutatedKeys:i}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((c,d)=>function(f,p){const m=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Rt()}};return m(f)-m(p)}(c.type,d.type)||this.Aa(c.doc,d.doc)),this.pa(n),s=s!=null&&s;const a=r&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,l=u!==this.Ea;return this.Ea=u,o.length!==0||l?{snapshot:new By(this.query,e.Ra,i,o,e.mutatedKeys,u===0,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new T3,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ir(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new SW(n))}),this.da.forEach(n=>{e.has(n)||r.push(new AW(n))}),r}ba(e){this.Ta=e.Ts,this.da=ir();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return By.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class NOe{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class BOe{constructor(e){this.key=e,this.va=!1}}class FOe{constructor(e,r,n,s,i,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new og(a=>qz(a),zS),this.Ma=new Map,this.xa=new Set,this.Oa=new pn(Et.comparator),this.Na=new Map,this.La=new wO,this.Ba={},this.ka=new Map,this.qa=Ny.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function MOe(t,e,r=!0){const n=IW(t);let s;const i=n.Fa.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await TW(n,e,r,!0),s}async function jOe(t,e){const r=IW(t);await TW(r,e,!0,!1)}async function TW(t,e,r,n){const s=await iOe(t.localStore,qu(e)),i=s.targetId,o=r?t.sharedClientState.addLocalQueryTarget(i):"not-current";let a;return n&&(a=await UOe(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&r&&gW(t.remoteStore,s),a}async function UOe(t,e,r,n,s){t.Ka=(d,h,f)=>async function(m,E,A,_){let g=E.view.ma(A);g.ns&&(g=await b3(m.localStore,E.query,!1).then(({documents:D})=>E.view.ma(D,g)));const v=_&&_.targetChanges.get(E.targetId),S=_&&_.targetMismatches.get(E.targetId)!=null,x=E.view.applyChanges(g,m.isPrimaryClient,v,S);return C3(m,E.targetId,x.wa),x.snapshot}(t,d,h,f);const i=await b3(t.localStore,e,!0),o=new ROe(e,i.Ts),a=o.ma(i.documents),u=d_.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),l=o.applyChanges(a,t.isPrimaryClient,u);C3(t,r,l.wa);const c=new NOe(e,r,o);return t.Fa.set(e,c),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),l.snapshot}async function LOe(t,e,r){const n=Mt(t),s=n.Fa.get(e),i=n.Ma.get(s.targetId);if(i.length>1)return n.Ma.set(s.targetId,i.filter(o=>!zS(o,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await pC(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&EO(n.remoteStore,s.targetId),yC(n,s.targetId)}).catch(u_)):(yC(n,s.targetId),await pC(n.localStore,s.targetId,!0))}async function KOe(t,e){const r=Mt(t),n=r.Fa.get(e),s=r.Ma.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),EO(r.remoteStore,n.targetId))}async function VOe(t,e,r){const n=XOe(t);try{const s=await function(o,a){const u=Mt(o),l=zn.now(),c=a.reduce((f,p)=>f.add(p.key),ir());let d,h;return u.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=Al(),m=ir();return u.cs.getEntries(f,c).next(E=>{p=E,p.forEach((A,_)=>{_.isValidDocument()||(m=m.add(A))})}).next(()=>u.localDocuments.getOverlayedDocuments(f,p)).next(E=>{d=E;const A=[];for(const _ of a){const g=u$e(_,d.get(_.key).overlayedDocument);g!=null&&A.push(new qp(_.key,g,Fz(g.value.mapValue),dl.exists(!0)))}return u.mutationQueue.addMutationBatch(f,l,A,a)}).next(E=>{h=E;const A=E.applyToLocalDocumentSet(d,m);return u.documentOverlayCache.saveOverlays(f,E.batchId,A)})}).then(()=>({batchId:h.batchId,changes:Wz(d)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(o,a,u){let l=o.Ba[o.currentUser.toKey()];l||(l=new pn(fr)),l=l.insert(a,u),o.Ba[o.currentUser.toKey()]=l}(n,s.batchId,r),await h_(n,s.changes),await QS(n.remoteStore)}catch(s){const i=xO(s,"Failed to persist write");r.reject(i)}}async function DW(t,e){const r=Mt(t);try{const n=await tOe(r.localStore,e);e.targetChanges.forEach((s,i)=>{const o=r.Na.get(i);o&&(Hr(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Hr(o.va):s.removedDocuments.size>0&&(Hr(o.va),o.va=!1))}),await h_(r,n,e)}catch(n){await u_(n)}}function P3(t,e,r){const n=Mt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Fa.forEach((i,o)=>{const a=o.view.Z_(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const u=Mt(o);u.onlineState=a;let l=!1;u.queries.forEach((c,d)=>{for(const h of d.j_)h.Z_(a)&&(l=!0)}),l&&PO(u)}(n.eventManager,e),s.length&&n.Ca.d_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function qOe(t,e,r){const n=Mt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Na.get(e),i=s&&s.key;if(i){let o=new pn(Et.comparator);o=o.insert(i,Zi.newNoDocument(i,Ft.min()));const a=ir().add(i),u=new XS(Ft.min(),new Map,new pn(fr),o,a);await DW(n,u),n.Oa=n.Oa.remove(i),n.Na.delete(e),CO(n)}else await pC(n.localStore,e,!1).then(()=>yC(n,e,r)).catch(u_)}async function HOe(t,e){const r=Mt(t),n=e.batch.batchId;try{const s=await eOe(r.localStore,e);PW(r,n,null),xW(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await h_(r,s)}catch(s){await u_(s)}}async function zOe(t,e,r){const n=Mt(t);try{const s=await function(o,a){const u=Mt(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let c;return u.mutationQueue.lookupMutationBatch(l,a).next(d=>(Hr(d!==null),c=d.keys(),u.mutationQueue.removeMutationBatch(l,d))).next(()=>u.mutationQueue.performConsistencyCheck(l)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(l,c,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,c)).next(()=>u.localDocuments.getDocuments(l,c))})}(n.localStore,e);PW(n,e,r),xW(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await h_(n,s)}catch(s){await u_(s)}}function xW(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function PW(t,e,r){const n=Mt(t);let s=n.Ba[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Ba[n.currentUser.toKey()]=s}}function yC(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||CW(t,n)})}function CW(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(EO(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),CO(t))}function C3(t,e,r){for(const n of r)n instanceof AW?(t.La.addReference(n.key,e),WOe(t,n)):n instanceof SW?(Qe("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||CW(t,n.key)):Rt()}function WOe(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(Qe("SyncEngine","New document in limbo: "+r),t.xa.add(n),CO(t))}function CO(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new Et(vn.fromString(e)),n=t.qa.next();t.Na.set(n,new BOe(r)),t.Oa=t.Oa.insert(r,n),gW(t.remoteStore,new Xd(qu(pO(r.path)),n,"TargetPurposeLimboResolution",uO.oe))}}async function h_(t,e,r){const n=Mt(t),s=[],i=[],o=[];n.Fa.isEmpty()||(n.Fa.forEach((a,u)=>{o.push(n.Ka(u,e,r).then(l=>{var c;if((l||r)&&n.isPrimaryClient){const d=l?!l.fromCache:(c=r==null?void 0:r.targetChanges.get(u.targetId))===null||c===void 0?void 0:c.current;n.sharedClientState.updateQueryState(u.targetId,d?"current":"not-current")}if(l){s.push(l);const d=bO.Wi(u.targetId,l);i.push(d)}}))}),await Promise.all(o),n.Ca.d_(s),await async function(u,l){const c=Mt(u);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>Oe.forEach(l,h=>Oe.forEach(h.$i,f=>c.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>Oe.forEach(h.Ui,f=>c.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!c_(d))throw d;Qe("LocalStore","Failed to update sequence numbers: "+d)}for(const d of l){const h=d.targetId;if(!d.fromCache){const f=c.os.get(h),p=f.snapshotVersion,m=f.withLastLimboFreeSnapshotVersion(p);c.os=c.os.insert(h,m)}}}(n.localStore,i))}async function GOe(t,e){const r=Mt(t);if(!r.currentUser.isEqual(e)){Qe("SyncEngine","User change. New user:",e.toKey());const n=await hW(r.localStore,e);r.currentUser=e,function(i,o){i.ka.forEach(a=>{a.forEach(u=>{u.reject(new bt(Ne.CANCELLED,o))})}),i.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await h_(r,n.hs)}}function JOe(t,e){const r=Mt(t),n=r.Na.get(e);if(n&&n.va)return ir().add(n.key);{let s=ir();const i=r.Ma.get(e);if(!i)return s;for(const o of i){const a=r.Fa.get(o);s=s.unionWith(a.view.Va)}return s}}function IW(t){const e=Mt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=DW.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=JOe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=qOe.bind(null,e),e.Ca.d_=kOe.bind(null,e.eventManager),e.Ca.$a=$Oe.bind(null,e.eventManager),e}function XOe(t){const e=Mt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=HOe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=zOe.bind(null,e),e}class I3{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=YS(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,r){return null}createIndexBackfillerScheduler(e,r){return null}createLocalStore(e){return Q$e(this.persistence,new Y$e,e.initialUser,this.serializer)}createPersistence(e){return new G$e(_O.Zr,this.serializer)}createSharedClientState(e){return new oOe}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class YOe{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>P3(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=GOe.bind(null,this.syncEngine),await DOe(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new POe}()}createDatastore(e){const r=YS(e.databaseInfo.databaseId),n=function(i){return new lOe(i)}(e.databaseInfo);return function(i,o,a,u){return new hOe(i,o,a,u)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,i,o,a){return new mOe(n,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,r=>P3(this.syncEngine,r,0),function(){return A3.D()?new A3:new aOe}())}createSyncEngine(e,r){return function(s,i,o,a,u,l,c){const d=new FOe(s,i,o,a,u,l);return c&&(d.Qa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const i=Mt(s);Qe("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await f_(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZOe{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ga(this.observer.next,e)}error(e){this.observer.error?this.Ga(this.observer.error,e):El("Uncaught Error in snapshot listener:",e.toString())}za(){this.muted=!0}Ga(e,r){this.muted||setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QOe{constructor(e,r,n,s){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Xi.UNAUTHENTICATED,this.clientId=Rz.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,async i=>{Qe("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(n,i=>(Qe("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new bt(Ne.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new lf;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=xO(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function RD(t,e){t.asyncQueue.verifyOperationInProgress(),Qe("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await hW(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function k3(t,e){t.asyncQueue.verifyOperationInProgress();const r=await t5e(t);Qe("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>S3(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>S3(e.remoteStore,s)),t._onlineComponents=e}function e5e(t){return t.name==="FirebaseError"?t.code===Ne.FAILED_PRECONDITION||t.code===Ne.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function t5e(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Qe("FirestoreClient","Using user provided OfflineComponentProvider");try{await RD(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!e5e(r))throw r;ky("Error using user provided cache. Falling back to memory cache: "+r),await RD(t,new I3)}}else Qe("FirestoreClient","Using default OfflineComponentProvider"),await RD(t,new I3);return t._offlineComponents}async function kW(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Qe("FirestoreClient","Using user provided OnlineComponentProvider"),await k3(t,t._uninitializedComponentsProvider._online)):(Qe("FirestoreClient","Using default OnlineComponentProvider"),await k3(t,new YOe))),t._onlineComponents}function r5e(t){return kW(t).then(e=>e.syncEngine)}async function n5e(t){const e=await kW(t),r=e.eventManager;return r.onListen=MOe.bind(null,e.syncEngine),r.onUnlisten=LOe.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=jOe.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=KOe.bind(null,e.syncEngine),r}function i5e(t,e,r={}){const n=new lf;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,u,l){const c=new ZOe({next:h=>{o.enqueueAndForget(()=>IOe(i,d));const f=h.docs.has(a);!f&&h.fromCache?l.reject(new bt(Ne.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&u&&u.source==="server"?l.reject(new bt(Ne.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(h)},error:h=>l.reject(h)}),d=new OOe(pO(a.path),c,{includeMetadataChanges:!0,_a:!0});return COe(i,d)}(await n5e(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $W(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $3=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s5e(t,e,r){if(!r)throw new bt(Ne.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function o5e(t,e,r,n){if(e===!0&&n===!0)throw new bt(Ne.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function O3(t){if(!Et.isDocumentKey(t))throw new bt(Ne.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function IO(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Rt()}function Aw(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new bt(Ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=IO(t);throw new bt(Ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R3{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new bt(Ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new bt(Ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}o5e("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=$W((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new bt(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new bt(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new bt(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class kO{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new R3({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new bt(Ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new bt(Ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new R3(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new yke;switch(n.type){case"firstParty":return new _ke(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new bt(Ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=$3.get(r);n&&(Qe("ComponentProvider","Removing Datastore"),$3.delete(r),n.terminate())}(this),Promise.resolve()}}function a5e(t,e,r,n={}){var s;const i=(t=Aw(t,kO))._getSettings(),o=`${e}:${r}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&ky("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),n.mockUserToken){let a,u;if(typeof n.mockUserToken=="string")a=n.mockUserToken,u=Xi.MOCK_USER;else{a=Mxe(n.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const l=n.mockUserToken.sub||n.mockUserToken.user_id;if(!l)throw new bt(Ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Xi(l)}t._authCredentials=new gke(new Oz(a,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $O{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new $O(this.firestore,e,this._query)}}class oa{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Sw(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new oa(this.firestore,e,this._key)}}class Sw extends $O{constructor(e,r,n){super(e,r,pO(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new oa(this.firestore,null,new Et(e))}withConverter(e){return new Sw(this.firestore,e,this._path)}}function ym(t,e,...r){if(t=qs(t),arguments.length===1&&(e=Rz.newId()),s5e("doc","path",e),t instanceof kO){const n=vn.fromString(e,...r);return O3(n),new oa(t,null,new Et(n))}{if(!(t instanceof oa||t instanceof Sw))throw new bt(Ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(vn.fromString(e,...r));return O3(n),new oa(t.firestore,t instanceof Sw?t.converter:null,new Et(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u5e{constructor(){this.au=Promise.resolve(),this.uu=[],this.cu=!1,this.lu=[],this.hu=null,this.Pu=!1,this.Iu=!1,this.Tu=[],this.t_=new mW(this,"async_queue_retry"),this.Eu=()=>{const r=OD();r&&Qe("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()};const e=OD();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Eu)}get isShuttingDown(){return this.cu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.du(),this.Au(e)}enterRestrictedMode(e){if(!this.cu){this.cu=!0,this.Iu=e||!1;const r=OD();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Eu)}}enqueue(e){if(this.du(),this.cu)return new Promise(()=>{});const r=new lf;return this.Au(()=>this.cu&&this.Iu?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.uu.push(e),this.Ru()))}async Ru(){if(this.uu.length!==0){try{await this.uu[0](),this.uu.shift(),this.t_.reset()}catch(e){if(!c_(e))throw e;Qe("AsyncQueue","Operation failed with retryable error: "+e)}this.uu.length>0&&this.t_.Go(()=>this.Ru())}}Au(e){const r=this.au.then(()=>(this.Pu=!0,e().catch(n=>{this.hu=n,this.Pu=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(n);throw El("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.Pu=!1,n))));return this.au=r,r}enqueueAfterDelay(e,r,n){this.du(),this.Tu.indexOf(e)>-1&&(r=0);const s=DO.createAndSchedule(this,e,r,n,i=>this.Vu(i));return this.lu.push(s),s}du(){this.hu&&Rt()}verifyOperationInProgress(){}async mu(){let e;do e=this.au,await e;while(e!==this.au)}fu(e){for(const r of this.lu)if(r.timerId===e)return!0;return!1}gu(e){return this.mu().then(()=>{this.lu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.lu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.mu()})}pu(e){this.Tu.push(e)}Vu(e){const r=this.lu.indexOf(e);this.lu.splice(r,1)}}class OO extends kO{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=function(){return new u5e}(),this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||RW(this),this._firestoreClient.terminate()}}function c5e(t,e){const r=typeof t=="object"?t:J$(),n=typeof t=="string"?t:"(default)",s=Lp(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=Bxe("firestore");i&&a5e(s,...i)}return s}function OW(t){return t._firestoreClient||RW(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function RW(t){var e,r,n;const s=t._freezeSettings(),i=function(a,u,l,c){return new Oke(a,u,l,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,$W(c.experimentalLongPollingOptions),c.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._firestoreClient=new QOe(t._authCredentials,t._appCheckCredentials,t._queue,i),!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.localCache.kind,_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Fy(Mi.fromBase64String(e))}catch(r){throw new bt(Ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Fy(Mi.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RO{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new bt(Ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new $i(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NW{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NO{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new bt(Ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new bt(Ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return fr(this._lat,e._lat)||fr(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BO{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l5e=/^__.*__$/;class d5e{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new qp(e,this.data,this.fieldMask,r,this.fieldTransforms):new l_(e,this.data,r,this.fieldTransforms)}}function BW(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Rt()}}class FO{constructor(e,r,n,s,i,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.yu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get wu(){return this.settings.wu}Su(e){return new FO(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}bu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Su({path:n,Du:!1});return s.vu(e),s}Cu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Su({path:n,Du:!1});return s.yu(),s}Fu(e){return this.Su({path:void 0,Du:!0})}Mu(e){return AA(e,this.settings.methodName,this.settings.xu||!1,this.path,this.settings.Ou)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}yu(){if(this.path)for(let e=0;e<this.path.length;e++)this.vu(this.path.get(e))}vu(e){if(e.length===0)throw this.Mu("Document fields must not be empty");if(BW(this.wu)&&l5e.test(e))throw this.Mu('Document fields cannot begin and end with "__"')}}class f5e{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||YS(e)}Nu(e,r,n,s=!1){return new FO({wu:e,methodName:r,Ou:n,path:$i.emptyPath(),Du:!1,xu:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function h5e(t){const e=t._freezeSettings(),r=YS(t._databaseId);return new f5e(t._databaseId,!!e.ignoreUndefinedProperties,r)}function p5e(t,e,r,n,s,i={}){const o=t.Nu(i.merge||i.mergeFields?2:0,e,r,s);UW("Data must be an object, but it was:",o,n);const a=MW(n,o);let u,l;if(i.merge)u=new Ba(o.fieldMask),l=o.fieldTransforms;else if(i.mergeFields){const c=[];for(const d of i.mergeFields){const h=m5e(e,d,r);if(!o.contains(h))throw new bt(Ne.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);g5e(c,h)||c.push(h)}u=new Ba(c),l=o.fieldTransforms.filter(d=>u.covers(d.field))}else u=null,l=o.fieldTransforms;return new d5e(new Qo(a),u,l)}function FW(t,e){if(jW(t=qs(t)))return UW("Unsupported field value:",e,t),MW(t,e);if(t instanceof NW)return function(n,s){if(!BW(s.wu))throw s.Mu(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Mu(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Du&&e.wu!==4)throw e.Mu("Nested arrays are not supported");return function(n,s){const i=[];let o=0;for(const a of n){let u=FW(a,s.Fu(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(n,s){if((n=qs(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return r$e(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=zn.fromDate(n);return{timestampValue:bA(s.serializer,i)}}if(n instanceof zn){const i=new zn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:bA(s.serializer,i)}}if(n instanceof NO)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Fy)return{bytesValue:oW(s.serializer,n._byteString)};if(n instanceof oa){const i=s.databaseId,o=n.firestore._databaseId;if(!o.isEqual(i))throw s.Mu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:vO(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof BO)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw a.Mu("VectorValues must only contain numeric values.");return mO(a.serializer,u)})}}}}}}(n,s);throw s.Mu(`Unsupported field value: ${IO(n)}`)}(t,e)}function MW(t,e){const r={};return Nz(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):sg(t,(n,s)=>{const i=FW(s,e.bu(n));i!=null&&(r[n]=i)}),{mapValue:{fields:r}}}function jW(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof zn||t instanceof NO||t instanceof Fy||t instanceof oa||t instanceof NW||t instanceof BO)}function UW(t,e,r){if(!jW(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=IO(r);throw n==="an object"?e.Mu(t+" a custom object"):e.Mu(t+" "+n)}}function m5e(t,e,r){if((e=qs(e))instanceof RO)return e._internalPath;if(typeof e=="string")return LW(t,e);throw AA("Field path arguments must be of type string or ",t,!1,void 0,r)}const y5e=new RegExp("[~\\*/\\[\\]]");function LW(t,e,r){if(e.search(y5e)>=0)throw AA(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new RO(...e.split("."))._internalPath}catch{throw AA(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function AA(t,e,r,n,s){const i=n&&!n.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;r&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${n}`),o&&(u+=` in document ${s}`),u+=")"),new bt(Ne.INVALID_ARGUMENT,a+t+u)}function g5e(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KW{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new oa(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new v5e(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(VW("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class v5e extends KW{data(){return super.data()}}function VW(t,e){return typeof e=="string"?LW(t,e):e instanceof RO?e._internalPath:e._delegate._internalPath}class w5e{convertValue(e,r="none"){switch(Cp(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Dn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Pp(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Rt()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return sg(e,(s,i)=>{n[s]=this.convertValue(i,r)}),n}convertVectorValue(e){var r,n,s;const i=(s=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(o=>Dn(o.doubleValue));return new BO(i)}convertGeoPoint(e){return new NO(Dn(e.latitude),Dn(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=lO(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(vw(e));default:return null}}convertTimestamp(e){const r=bf(e);return new zn(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=vn.fromString(e);Hr(fW(n));const s=new ww(n.get(1),n.get(3)),i=new Et(n.popFirst(5));return s.isEqual(r)||El(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _5e(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b5e{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class qW extends KW{constructor(e,r,n,s,i,o){super(e,r,n,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new E5e(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(VW("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class E5e extends qW{data(e={}){return super.data(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ND(t){t=Aw(t,oa);const e=Aw(t.firestore,OO);return i5e(OW(e),t._key).then(r=>T5e(e,t,r))}class A5e extends w5e{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fy(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new oa(this.firestore,null,r)}}function w0(t,e,r){t=Aw(t,oa);const n=Aw(t.firestore,OO),s=_5e(t.converter,e,r);return S5e(n,[p5e(h5e(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,dl.none())])}function S5e(t,e){return function(n,s){const i=new lf;return n.asyncQueue.enqueueAndForget(async()=>VOe(await r5e(n),s,i)),i.promise}(OW(t),e)}function T5e(t,e,r){const n=r.docs.get(e._key),s=new A5e(t);return new qW(t,s,e._key,n,new b5e(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(s){ig=s})(rg),ec(new Wa("firestore",(n,{instanceIdentifier:s,options:i})=>{const o=n.getProvider("app").getImmediate(),a=new OO(new vke(n.getProvider("auth-internal")),new Eke(n.getProvider("app-check-internal")),function(l,c){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new bt(Ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ww(l.options.projectId,c)}(o,s),o);return i=Object.assign({useFetchStreams:r},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),sa(e3,"4.7.1",e),sa(e3,"4.7.1","esm2017")})();var D5e="firebase",x5e="10.13.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */sa(D5e,x5e,"app");const HW="@firebase/installations",MO="0.6.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zW=1e4,WW=`w:${MO}`,GW="FIS_v2",P5e="https://firebaseinstallations.googleapis.com/v1",C5e=60*60*1e3,I5e="installations",k5e="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $5e={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Ip=new Up(I5e,k5e,$5e);function JW(t){return t instanceof Ja&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XW({projectId:t}){return`${P5e}/projects/${t}/installations`}function YW(t){return{token:t.token,requestStatus:2,expiresIn:R5e(t.expiresIn),creationTime:Date.now()}}async function ZW(t,e){const n=(await e.json()).error;return Ip.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function QW({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function O5e(t,{refreshToken:e}){const r=QW(t);return r.append("Authorization",N5e(e)),r}async function eG(t){const e=await t();return e.status>=500&&e.status<600?t():e}function R5e(t){return Number(t.replace("s","000"))}function N5e(t){return`${GW} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B5e({appConfig:t,heartbeatServiceProvider:e},{fid:r}){const n=XW(t),s=QW(t),i=e.getImmediate({optional:!0});if(i){const l=await i.getHeartbeatsHeader();l&&s.append("x-firebase-client",l)}const o={fid:r,authVersion:GW,appId:t.appId,sdkVersion:WW},a={method:"POST",headers:s,body:JSON.stringify(o)},u=await eG(()=>fetch(n,a));if(u.ok){const l=await u.json();return{fid:l.fid||r,registrationStatus:2,refreshToken:l.refreshToken,authToken:YW(l.authToken)}}else throw await ZW("Create Installation",u)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tG(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F5e(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M5e=/^[cdef][\w-]{21}$/,gC="";function j5e(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const r=U5e(t);return M5e.test(r)?r:gC}catch{return gC}}function U5e(t){return F5e(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e2(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rG=new Map;function nG(t,e){const r=e2(t);iG(r,e),L5e(r,e)}function iG(t,e){const r=rG.get(t);if(r)for(const n of r)n(e)}function L5e(t,e){const r=K5e();r&&r.postMessage({key:t,fid:e}),V5e()}let qh=null;function K5e(){return!qh&&"BroadcastChannel"in self&&(qh=new BroadcastChannel("[Firebase] FID Change"),qh.onmessage=t=>{iG(t.data.key,t.data.fid)}),qh}function V5e(){rG.size===0&&qh&&(qh.close(),qh=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q5e="firebase-installations-database",H5e=1,kp="firebase-installations-store";let BD=null;function jO(){return BD||(BD=qH(q5e,H5e,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(kp)}}})),BD}async function SA(t,e){const r=e2(t),s=(await jO()).transaction(kp,"readwrite"),i=s.objectStore(kp),o=await i.get(r);return await i.put(e,r),await s.done,(!o||o.fid!==e.fid)&&nG(t,e.fid),e}async function sG(t){const e=e2(t),n=(await jO()).transaction(kp,"readwrite");await n.objectStore(kp).delete(e),await n.done}async function t2(t,e){const r=e2(t),s=(await jO()).transaction(kp,"readwrite"),i=s.objectStore(kp),o=await i.get(r),a=e(o);return a===void 0?await i.delete(r):await i.put(a,r),await s.done,a&&(!o||o.fid!==a.fid)&&nG(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UO(t){let e;const r=await t2(t.appConfig,n=>{const s=z5e(n),i=W5e(t,s);return e=i.registrationPromise,i.installationEntry});return r.fid===gC?{installationEntry:await e}:{installationEntry:r,registrationPromise:e}}function z5e(t){const e=t||{fid:j5e(),registrationStatus:0};return oG(e)}function W5e(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(Ip.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const r={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=G5e(t,r);return{installationEntry:r,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:J5e(t)}:{installationEntry:e}}async function G5e(t,e){try{const r=await B5e(t,e);return SA(t.appConfig,r)}catch(r){throw JW(r)&&r.customData.serverCode===409?await sG(t.appConfig):await SA(t.appConfig,{fid:e.fid,registrationStatus:0}),r}}async function J5e(t){let e=await N3(t.appConfig);for(;e.registrationStatus===1;)await tG(100),e=await N3(t.appConfig);if(e.registrationStatus===0){const{installationEntry:r,registrationPromise:n}=await UO(t);return n||r}return e}function N3(t){return t2(t,e=>{if(!e)throw Ip.create("installation-not-found");return oG(e)})}function oG(t){return X5e(t)?{fid:t.fid,registrationStatus:0}:t}function X5e(t){return t.registrationStatus===1&&t.registrationTime+zW<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y5e({appConfig:t,heartbeatServiceProvider:e},r){const n=Z5e(t,r),s=O5e(t,r),i=e.getImmediate({optional:!0});if(i){const l=await i.getHeartbeatsHeader();l&&s.append("x-firebase-client",l)}const o={installation:{sdkVersion:WW,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},u=await eG(()=>fetch(n,a));if(u.ok){const l=await u.json();return YW(l)}else throw await ZW("Generate Auth Token",u)}function Z5e(t,{fid:e}){return`${XW(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LO(t,e=!1){let r;const n=await t2(t.appConfig,i=>{if(!aG(i))throw Ip.create("not-registered");const o=i.authToken;if(!e&&tRe(o))return i;if(o.requestStatus===1)return r=Q5e(t,e),i;{if(!navigator.onLine)throw Ip.create("app-offline");const a=nRe(i);return r=eRe(t,a),a}});return r?await r:n.authToken}async function Q5e(t,e){let r=await B3(t.appConfig);for(;r.authToken.requestStatus===1;)await tG(100),r=await B3(t.appConfig);const n=r.authToken;return n.requestStatus===0?LO(t,e):n}function B3(t){return t2(t,e=>{if(!aG(e))throw Ip.create("not-registered");const r=e.authToken;return iRe(r)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function eRe(t,e){try{const r=await Y5e(t,e),n=Object.assign(Object.assign({},e),{authToken:r});return await SA(t.appConfig,n),r}catch(r){if(JW(r)&&(r.customData.serverCode===401||r.customData.serverCode===404))await sG(t.appConfig);else{const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await SA(t.appConfig,n)}throw r}}function aG(t){return t!==void 0&&t.registrationStatus===2}function tRe(t){return t.requestStatus===2&&!rRe(t)}function rRe(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+C5e}function nRe(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function iRe(t){return t.requestStatus===1&&t.requestTime+zW<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sRe(t){const e=t,{installationEntry:r,registrationPromise:n}=await UO(e);return n?n.catch(console.error):LO(e).catch(console.error),r.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oRe(t,e=!1){const r=t;return await aRe(r),(await LO(r,e)).token}async function aRe(t){const{registrationPromise:e}=await UO(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uRe(t){if(!t||!t.options)throw FD("App Configuration");if(!t.name)throw FD("App Name");const e=["projectId","apiKey","appId"];for(const r of e)if(!t.options[r])throw FD(r);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function FD(t){return Ip.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uG="installations",cRe="installations-internal",lRe=t=>{const e=t.getProvider("app").getImmediate(),r=uRe(e),n=Lp(e,"heartbeat");return{app:e,appConfig:r,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},dRe=t=>{const e=t.getProvider("app").getImmediate(),r=Lp(e,uG).getImmediate();return{getId:()=>sRe(r),getToken:s=>oRe(r,s)}};function fRe(){ec(new Wa(uG,lRe,"PUBLIC")),ec(new Wa(cRe,dRe,"PRIVATE"))}fRe();sa(HW,MO);sa(HW,MO,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TA="analytics",hRe="firebase_id",pRe="origin",mRe=60*1e3,yRe="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",KO="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vs=new jS("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gRe={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},mo=new Up("analytics","Analytics",gRe);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vRe(t){if(!t.startsWith(KO)){const e=mo.create("invalid-gtag-resource",{gtagURL:t});return Vs.warn(e.message),""}return t}function cG(t){return Promise.all(t.map(e=>e.catch(r=>r)))}function wRe(t,e){let r;return window.trustedTypes&&(r=window.trustedTypes.createPolicy(t,e)),r}function _Re(t,e){const r=wRe("firebase-js-sdk-policy",{createScriptURL:vRe}),n=document.createElement("script"),s=`${KO}?l=${t}&id=${e}`;n.src=r?r==null?void 0:r.createScriptURL(s):s,n.async=!0,document.head.appendChild(n)}function bRe(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function ERe(t,e,r,n,s,i){const o=n[s];try{if(o)await e[o];else{const u=(await cG(r)).find(l=>l.measurementId===s);u&&await e[u.appId]}}catch(a){Vs.error(a)}t("config",s,i)}async function ARe(t,e,r,n,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const a=await cG(r);for(const u of o){const l=a.find(d=>d.measurementId===u),c=l&&e[l.appId];if(c)i.push(c);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",n,s||{})}catch(i){Vs.error(i)}}function SRe(t,e,r,n){async function s(i,...o){try{if(i==="event"){const[a,u]=o;await ARe(t,e,r,a,u)}else if(i==="config"){const[a,u]=o;await ERe(t,e,r,n,a,u)}else if(i==="consent"){const[a,u]=o;t("consent",a,u)}else if(i==="get"){const[a,u,l]=o;t("get",a,u,l)}else if(i==="set"){const[a]=o;t("set",a)}else t(i,...o)}catch(a){Vs.error(a)}}return s}function TRe(t,e,r,n,s){let i=function(...o){window[n].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=SRe(i,t,e,r),{gtagCore:i,wrappedGtag:window[s]}}function DRe(t){const e=window.document.getElementsByTagName("script");for(const r of Object.values(e))if(r.src&&r.src.includes(KO)&&r.src.includes(t))return r;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xRe=30,PRe=1e3;class CRe{constructor(e={},r=PRe){this.throttleMetadata=e,this.intervalMillis=r}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,r){this.throttleMetadata[e]=r}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const lG=new CRe;function IRe(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function kRe(t){var e;const{appId:r,apiKey:n}=t,s={method:"GET",headers:IRe(n)},i=yRe.replace("{app-id}",r),o=await fetch(i,s);if(o.status!==200&&o.status!==304){let a="";try{const u=await o.json();!((e=u.error)===null||e===void 0)&&e.message&&(a=u.error.message)}catch{}throw mo.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function $Re(t,e=lG,r){const{appId:n,apiKey:s,measurementId:i}=t.options;if(!n)throw mo.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:n};throw mo.create("no-api-key")}const o=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new NRe;return setTimeout(async()=>{a.abort()},mRe),dG({appId:n,apiKey:s,measurementId:i},o,a,e)}async function dG(t,{throttleEndTimeMillis:e,backoffCount:r},n,s=lG){var i;const{appId:o,measurementId:a}=t;try{await ORe(n,e)}catch(u){if(a)return Vs.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:o,measurementId:a};throw u}try{const u=await kRe(t);return s.deleteThrottleMetadata(o),u}catch(u){const l=u;if(!RRe(l)){if(s.deleteThrottleMetadata(o),a)return Vs.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:o,measurementId:a};throw u}const c=Number((i=l==null?void 0:l.customData)===null||i===void 0?void 0:i.httpStatus)===503?S8(r,s.intervalMillis,xRe):S8(r,s.intervalMillis),d={throttleEndTimeMillis:Date.now()+c,backoffCount:r+1};return s.setThrottleMetadata(o,d),Vs.debug(`Calling attemptFetch again in ${c} millis`),dG(t,d,n,s)}}function ORe(t,e){return new Promise((r,n)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(r,s);t.addEventListener(()=>{clearTimeout(i),n(mo.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function RRe(t){if(!(t instanceof Ja)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class NRe{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function BRe(t,e,r,n,s){if(s&&s.global){t("event",r,n);return}else{const i=await e,o=Object.assign(Object.assign({},n),{send_to:i});t("event",r,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FRe(){if(UH())try{await LH()}catch(t){return Vs.warn(mo.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return Vs.warn(mo.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function MRe(t,e,r,n,s,i,o){var a;const u=$Re(t);u.then(f=>{r[f.measurementId]=f.appId,t.options.measurementId&&f.measurementId!==t.options.measurementId&&Vs.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${f.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(f=>Vs.error(f)),e.push(u);const l=FRe().then(f=>{if(f)return n.getId()}),[c,d]=await Promise.all([u,l]);DRe(i)||_Re(i,c.measurementId),s("js",new Date);const h=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return h[pRe]="firebase",h.update=!0,d!=null&&(h[hRe]=d),s("config",c.measurementId,h),c.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jRe{constructor(e){this.app=e}_delete(){return delete xv[this.app.options.appId],Promise.resolve()}}let xv={},F3=[];const M3={};let MD="dataLayer",URe="gtag",j3,fG,U3=!1;function LRe(){const t=[];if(jH()&&t.push("This is a browser extension environment."),qxe()||t.push("Cookies are not available."),t.length>0){const e=t.map((n,s)=>`(${s+1}) ${n}`).join(" "),r=mo.create("invalid-analytics-context",{errorInfo:e});Vs.warn(r.message)}}function KRe(t,e,r){LRe();const n=t.options.appId;if(!n)throw mo.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)Vs.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw mo.create("no-api-key");if(xv[n]!=null)throw mo.create("already-exists",{id:n});if(!U3){bRe(MD);const{wrappedGtag:i,gtagCore:o}=TRe(xv,F3,M3,MD,URe);fG=i,j3=o,U3=!0}return xv[n]=MRe(t,F3,M3,e,j3,MD,r),new jRe(t)}function VRe(t=J$()){t=qs(t);const e=Lp(t,TA);return e.isInitialized()?e.getImmediate():qRe(t)}function qRe(t,e={}){const r=Lp(t,TA);if(r.isInitialized()){const s=r.getImmediate();if(hw(e,r.getOptions()))return s;throw mo.create("already-initialized")}return r.initialize({options:e})}function HRe(t,e,r,n){t=qs(t),BRe(fG,xv[t.app.options.appId],e,r,n).catch(s=>Vs.error(s))}const L3="@firebase/analytics",K3="0.10.7";function zRe(){ec(new Wa(TA,(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return KRe(n,s,r)},"PUBLIC")),ec(new Wa("analytics-internal",t,"PRIVATE")),sa(L3,K3),sa(L3,K3,"esm2017");function t(e){try{const r=e.getProvider(TA).getImmediate();return{logEvent:(n,s,i)=>HRe(r,n,s,i)}}catch(r){throw mo.create("interop-component-reg-failed",{reason:r})}}}zRe();const WRe={apiKey:"AIzaSyDT2vb-sMcMnDH92HpYe0zFZkB9KeWg0J4",authDomain:"care-cove.firebaseapp.com",projectId:"care-cove",storageBucket:"care-cove.appspot.com",messagingSenderId:"206987749536",appId:"1:206987749536:web:cf0625e1d6a41cb108c1c5",measurementId:"G-7CY3YDPWCV"},r2=HH(WRe);Cm(r2);const gm=c5e(r2);VRe(r2);const r1={aquafinance_capital:{uri:"did:dht:3fkz5ssfxbriwks3iy5nwys3q5kyx64ettp9wfn1yfekfkiguj1y",name:"AquaFinance Capital",description:"Provides exchanges with the Ghanaian Cedis: GHS to USDC, GHS to KES"},flowback_financial:{uri:"did:dht:zkp5gbsqgzn69b3y5dtt5nnpjtdq6sxyukpzo68npsf79bmtb9zy",name:"Flowback Financial",description:"Offers international rates with various currencies - USD to GBP, GBP to CAD."},vertex_liquid_assets:{uri:"did:dht:enwguxo8uzqexq14xupe4o9ymxw3nzeb9uug5ijkj9rhfbf1oy5y",name:"Vertex Liquid Assets",description:"Offers currency exchanges between African currencies - MAD to EGP, GHS to NGN."},titanium_trust:{uri:"did:dht:ozn5c51ruo7z63u1h748ug7rw5p1mq3853ytrd5gatu9a8mm8f1o",name:"Titanium Trust",description:"Provides offerings to exchange USD to African currencies - USD to GHS, USD to KES."}},GRe=()=>{const t=Sl({balance:100,transactions:[],transactionsLoading:!0,pfiAllowlist:Object.keys(r1).map(T=>({pfiUri:r1[T].uri,pfiName:r1[T].name,pfiDescription:r1[T].description})),selectedTransaction:null,offering:null,payinCurrencies:[],payoutCurrencies:[],offerings:[],customerDid:null,customerCredentials:[]});if(typeof window<"u"){const T=localStorage.getItem("walletBalance");t.balance=parseFloat(T)||1e4}const e=async()=>{try{const P=Cm().currentUser;if(!P){console.log("User is not authenticated, redirecting to login..."),n.push("/login");return}const C=ym(gm,"donors",P.email),k=await ND(C);if(k.exists()){const K=k.data();K.balance?(t.balance=K.balance,console.log("Balance loaded from Firestore:",t.balance),localStorage.setItem("walletBalance",t.balance.toString())):(t.balance=1e4,console.log("No balance found, setting to default (1000)"))}else console.log("User document does not exist in Firestore."),t.balance=1e4,await w0(C,{balance:t.balance})}catch(T){console.error("Error loading balance from Firestore:",T)}},r=Cm(),n=Wee();sIe(r,T=>{T||n.push("/login")});const s=async()=>{try{const T=[];for(const P of t.pfiAllowlist){const C=P.pfiUri,k=await Pi.getOfferings({pfiDid:C});T.push(...k)}t.offerings=T,x()}catch(T){console.error("Failed to fetch offerings:",T)}},i=async(T,P,C)=>{const k=GE.selectCredentials({vcJwts:t.customerCredentials,presentationDefinition:T.data.requiredClaims}),K=qo.create({metadata:{from:t.customerDid.uri,to:T.metadata.from,protocol:"1.0"},data:{offeringId:T.id,payin:{amount:P.toString(),kind:T.data.payin.methods[0].kind,paymentDetails:{}},payout:{kind:T.data.payout.methods[0].kind,paymentDetails:C},claims:k}});try{K.verifyOfferingRequirements(T)}catch(L){console.log("Offering requirements not met",L)}await K.sign(t.customerDid),console.log("RFQ:",K);try{await Pi.createExchange(K)}catch(L){console.error("Failed to create exchange:",L)}},o=async T=>{try{const P=await Pi.getExchanges({pfiDid:T,did:t.customerDid});return d(P)}catch(P){console.error("Failed to fetch exchanges:",P)}},a=async(T,P,C)=>{const k=Cy.create({metadata:{from:t.customerDid.uri,to:P,exchangeId:T},data:{reason:C}});await k.sign(t.customerDid);try{await Pi.submitClose(k)}catch(K){console.error("Failed to close exchange:",K)}},u=async(T,P)=>{const C=cw.create({metadata:{from:t.customerDid.uri,to:P,exchangeId:T}});await C.sign(t.customerDid);try{return await Pi.submitOrder(C)}catch(k){console.error("Failed to submit order:",k)}},l=()=>{const T=async()=>{if(console.log("Polling exchanges again..."),!t.customerDid)return;const P=[];try{for(const C of t.pfiAllowlist){const k=await o(C.pfiUri);P.push(...k)}console.log("All exchanges:",P),b(P.reverse()),t.transactionsLoading=!1}catch(C){console.error("Failed to fetch exchanges:",C)}};T(),bte(T,5e3)},c=async()=>{try{const T=r.currentUser;if(!T){console.error("No user is logged in"),n.push("/login");return}const P=T.email,C=ym(gm,"donors",P),k=await ND(C);if(k.exists()){const K=k.data().did;t.customerDid=await wf.import({portableDid:JSON.parse(K)});const L=k.data().credentials;L&&(t.customerCredentials=JSON.parse(L),localStorage.setItem("customerCredentials",JSON.stringify(t.customerCredentials)))}else{t.customerDid=await wf.create({options:{publish:!0}});const K=await t.customerDid.export();await w0(C,{email:P,did:JSON.stringify(K),credentials:JSON.stringify(t.customerCredentials),createdAt:new Date}),localStorage.setItem("customerDid",JSON.stringify(K))}}catch(T){console.error("Failed to initialize DID:",T)}},d=T=>T.map(C=>{var W,B,te,z,$,F;const k=C[C.length-1],K=C.find(ee=>ee.kind==="rfq"),L=C.find(ee=>ee.kind==="quote"),q=m(k),se=(W=L==null?void 0:L.data.payin)==null?void 0:W.fee,X=(B=L==null?void 0:L.data.payin)==null?void 0:B.amount,re=(te=K.privateData)==null?void 0:te.payout.paymentDetails;return{id:k.metadata.exchangeId,payinAmount:(se?Number(X)+Number(se):Number(X)).toString()||K.data.payinAmount,payinCurrency:((z=L.data.payin)==null?void 0:z.currencyCode)??null,payoutAmount:(($=L==null?void 0:L.data.payout)==null?void 0:$.amount)??null,payoutCurrency:(F=L.data.payout)==null?void 0:F.currencyCode,status:q,createdTime:K.createdAt,...k.kind==="quote"&&{expirationTime:L.data.expiresAt??null},from:"You",to:(re==null?void 0:re.address)||(re==null?void 0:re.accountNumber)+", "+(re==null?void 0:re.bankName)||(re==null?void 0:re.phoneNumber)+", "+(re==null?void 0:re.networkProvider)||"Unknown",pfiDid:K.metadata.to}}),h=async()=>{try{const P=Cm().currentUser;if(!P){console.error("No user is logged in"),n.push("/login");return}const C=ym(gm,"users",P.uid),k=await ND(C);if(k.exists()){const K=k.data();K.credentials?(t.customerCredentials=K.credentials,console.log("Credentials loaded from Firestore:",t.customerCredentials),localStorage.setItem("customerCredentials",JSON.stringify(t.customerCredentials))):console.log("No credentials found in Firestore.")}else console.log("User document does not exist in Firestore.")}catch(T){console.error("Error loading credentials from Firestore:",T)}},f=async T=>{t.customerCredentials.push(T),localStorage.setItem("customerCredentials",JSON.stringify(t.customerCredentials));const P=r.currentUser;if(P){const C=ym(gm,"donors",P.email);await w0(C,{credentials:JSON.stringify(t.customerCredentials)},{merge:!0})}},p=T=>{const P=Uu.parse({jwt:T}).decoded.payload.vc;return{title:P.type[P.type.length-1].replace(new RegExp("(?<!^)(?<![A-Z])[A-Z](?=[a-z])","g")," $&"),name:P.credentialSubject.name,countryCode:P.credentialSubject.countryOfResidence,issuanceDate:new Date(P.issuanceDate).toLocaleDateString(void 0,{dateStyle:"medium"})}};Yd(()=>t.balance,async T=>{try{const C=Cm().currentUser;if(!C){console.log("User is not authenticated, redirecting to login..."),n.push("/login");return}const k=ym(gm,"users",C.uid);await w0(k,{balance:T},{merge:!0}),console.log("Balance updated in Firestore:",T),typeof window<"u"&&localStorage.setItem("walletBalance",T.toString())}catch(P){console.error("Error updating balance in Firestore:",P)}});const m=T=>T instanceof Cy?T.data.reason.toLowerCase().includes("complete")||T.data.reason.toLowerCase().includes("success")?"completed":T.data.reason.toLowerCase().includes("expired")?T.data.reason.toLowerCase():T.data.reason.toLowerCase().includes("cancelled")?"cancelled":"failed":T.kind,E=T=>{const P=m(T);switch(P){case"rfq":return"Requested";case"quote":return"Quoted";case"order":case"orderstatus":return"Pending";case"completed":return"Completed";case"expired":return"Expired";case"cancelled":return"Cancelled";case"failed":return"Failed";default:return P}},A=T=>{t.selectedTransaction=T},_=T=>{t.offering=T},g=async T=>{const P=parseFloat(T);if(!isNaN(P)&&P>0){t.balance-=P;try{const k=Cm().currentUser;if(!k){console.log("User is not authenticated, redirecting to login..."),n.push("/login");return}const K=ym(gm,"donors",k.email);await w0(K,{balance:t.balance},{merge:!0}),console.log("Balance deducted and updated in Firestore:",t.balance),localStorage.setItem("walletBalance",t.balance.toString())}catch(C){console.error("Error deducting balance in Firestore:",C)}}},v=T=>{if(Math.abs(T)>=1)return T.toFixed(2);const P=Math.abs(T)>=.01?4:6;return parseFloat(T.toFixed(P)).toString()},S=T=>{const P=t.offerings.find(C=>C.id===T);return console.log("Selected offering:",P),P},x=()=>{const T=new Set,P=new Set;t.offerings.forEach(C=>{T.add(C.data.payin.currencyCode),P.add(C.data.payout.currencyCode)}),t.payinCurrencies=Array.from(T),t.payoutCurrencies=Array.from(P)},D=(T,P)=>t.offerings.filter(C=>C.data.payin.currencyCode===T&&C.data.payout.currencyCode===P),w=(T,P)=>{if(P.length===0||!T.data.requiredClaims)return!1;try{return GE.satisfiesPresentationDefinition({vcJwts:P,presentationDefinition:T.data.requiredClaims}),!0}catch{return!1}},b=T=>{t.transactions.map(C=>C.id);const P=[...t.transactions];T.forEach(C=>{const k=P.findIndex(K=>K.id===C.id);k>-1?P[k]=C:P.push(C)}),t.transactions=P};return RA(async()=>{console.log("Fetching offerings..."),s(),console.log("Initializing DID..."),await c(),console.log("Loading credentials..."),h(),console.log("Loading balance..."),await e()}),{state:t,selectTransaction:A,setOffering:_,deductAmount:g,formatAmount:v,fetchOfferings:s,filterOfferings:D,satisfiesOfferingRequirements:w,addCredential:f,renderCredential:p,createExchange:i,fetchExchanges:o,renderOrderStatus:E,addOrder:u,addClose:a,getOfferingById:S,pollExchanges:l}},JRe=Ky({__name:"app",setup(t){const e=GRe();return Jh("store",e),r2.automaticDataCollectionEnabled,NQ({title:"CareCove",meta:[{name:"description",content:"Donation platform using tbDEX SDK"}]}),(r,n)=>{const s=gte;return bu(),aj("div",null,[wn(s)])}}}),XRe={__name:"nuxt-error-page",props:{error:Object},setup(t){const r=t.error;r.stack&&r.stack.split(`
`).splice(1).map(d=>({text:d.replace("webpack:/","").replace(".vue",".js").trim(),internal:d.includes("node_modules")&&!d.includes(".cache")||d.includes("internal")||d.includes("new Promise")})).map(d=>`<span class="stack${d.internal?" internal":""}">${d.text}</span>`).join(`
`);const n=Number(r.statusCode||500),s=n===404,i=r.statusMessage??(s?"Page Not Found":"Internal Server Error"),o=r.message||r.toString(),a=void 0,c=s?x5(()=>Nm(()=>import("./C3M34awQ.js"),__vite__mapDeps([10,4,2,11]),import.meta.url).then(d=>d.default||d)):x5(()=>Nm(()=>import("./Bvm2D7oQ.js"),__vite__mapDeps([12,2,13]),import.meta.url).then(d=>d.default||d));return(d,h)=>(bu(),Th(on(c),UG(lj({statusCode:on(n),statusMessage:on(i),description:on(o),stack:on(a)})),null,16))}},YRe={key:0},V3={__name:"nuxt-root",setup(t){const e=()=>null,r=Rn(),n=r.deferHydration();if(r.isHydrating){const u=r.hooks.hookOnce("app:error",n);qa().beforeEach(u)}const s=!1;Jh(UA,Nj()),r.hooks.callHookWith(u=>u.map(l=>l()),"vue:setup");const i=LA(),o=!1;R4((u,l,c)=>{if(r.hooks.callHook("vue:error",u,l,c).catch(d=>console.error("[nuxt] Error in `vue:error` hook",d)),VZ(u)&&(u.fatal||u.unhandled))return r.runWithContext(()=>Rm(u)),!1});const a=!1;return(u,l)=>(bu(),Th(rj,{onResolve:on(n)},{default:E4(()=>[on(o)?(bu(),aj("div",YRe)):on(i)?(bu(),Th(on(XRe),{key:1,error:on(i)},null,8,["error"])):on(a)?(bu(),Th(on(e),{key:2,context:on(a)},null,8,["context"])):on(s)?(bu(),Th(VJ(on(s)),{key:3})):(bu(),Th(on(JRe),{key:4}))]),_:1},8,["onResolve"]))}};let q3;{let t;q3=async function(){var o,a;if(t)return t;const n=!!(((o=window.__NUXT__)==null?void 0:o.serverRendered)??((a=document.getElementById("__NUXT_DATA__"))==null?void 0:a.dataset.ssr)==="true")?yY(V3):mY(V3),s=DZ({vueApp:n});async function i(u){await s.callHook("app:error",u),s.payload.error=s.payload.error||KA(u)}n.config.errorHandler=i;try{await CZ(s,mte)}catch(u){i(u)}try{await s.hooks.callHook("app:created",n),await s.hooks.callHook("app:beforeMount",n),n.mount(SZ),await s.hooks.callHook("app:mounted",n),await Ly()}catch(u){i(u)}return n.config.errorHandler===i&&(n.config.errorHandler=void 0),n},t=q3().catch(e=>{throw console.error("Error while mounting app:",e),e})}export{UR as A,NA as B,uNe as C,Iu as D,eNe as E,ao as F,OY as G,oNe as H,Op as I,LZ as J,LC as K,aNe as L,jA as M,tx as N,UC as O,Yd as P,CA as Q,iNe as R,Cm as S,r2 as T,qd as U,rFe as V,tFe as W,rNe as X,cj as a,wn as b,aj as c,dj as d,Wee as e,GRe as f,sNe as g,QRe as h,Ia as i,on as j,cY as k,ui as l,tNe as m,nNe as n,bu as o,RA as p,Th as q,Bu as r,qa as s,qG as t,NQ as u,tR as v,E4 as w,Ky as x,Rn as y,WC as z};
