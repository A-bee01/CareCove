import{e as X,f as Y,r as d,i as N,P as S,c as r,b as Z,a,j as u,h as v,k as U,F as h,m as k,q as A,n as p,t as i,v as T,Q as ee,d as te,o,R as ae,L as se}from"./DcH5CDPh.js";import{H as ne}from"./DCcnrwk0.js";import{S as G}from"./CnVEgSMv.js";import"./DlAUqK2U.js";const oe={class:"flex flex-col min-h-screen"},re={class:"flex-1 bg-[ffffff] dark:bg-[ffffff] py-8 px-6 md:px-8"},ie={class:"max-w-3xl mx-auto grid gap-8"},le={key:0,class:"bg-white dark:bg-[#10673b] rounded-lg shadow p-6"},de={key:0},ue={class:"mb-4"},ce=["value"],fe={class:"mb-4"},be=["disabled"],me=["value"],ve={key:2,class:"mt-4 dark:text-white"},pe=["onClick"],ge={class:"font-bold"},ye={class:"text-blue-500"},xe={key:1,class:"bg-white dark:bg-[#10673b] rounded-lg shadow p-6"},he={class:"mb-4"},ke={key:0,class:"text-red-500 mt-2"},Ce={class:"block text-gray-700 dark:text-gray-300 mb-2"},we=["disabled"],_e={class:"mb-4"},Ne={class:"block text-gray-700 dark:text-gray-300 mb-2"},Se={class:"mb-4 text-gray-700 dark:text-gray-300"},Be=["for"],Pe=["onUpdate:modelValue","id","type","pattern"],De={class:"block text-gray-500 dark:text-gray-400"},Oe=["disabled"],Ve={__name:"donate",setup(Ue){const B=X(),{state:c,setOffering:q,createExchange:E,formatAmount:V,deductAmount:Ae,filterOfferings:R,satisfiesOfferingRequirements:F,getOfferingById:I}=Y(),g=d(1),b=d(""),y=d(""),C=d(!1),s=d(null),l=d(""),w=d(""),m=d({}),_=d([]),x=N(()=>!F(s.value,c.customerCredentials)),L=N(()=>c.payinCurrencies.length==0),P=d(!1);S(b,()=>{O()}),S(L,()=>{J()}),S(()=>s.value,()=>{s.value&&M()});const M=()=>{const n=s.value.data.payout.currencyCode,e={GHS:{accountNumber:"1234567890",bankName:"Ghana Commercial Bank",swiftCode:"GCB123GH"},KES:{accountNumber:"0987654321",bankName:"Equity Bank",swiftCode:"EQBK456KE"},USD:{accountNumber:"111122223333",bankName:"Wells Fargo",swiftCode:"WFUS789"},GBP:{accountNumber:"444455556666",bankName:"Barclays",swiftCode:"BARCGB22"},NGN:{accountNumber:"777788889999",bankName:"First Bank Nigeria",swiftCode:"FBNINGLA"},BTC:{address:"1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa"},USDC:{address:"0x4e7b1f7c9d3f3f7f3e1e1e1e1e1e1e1e1e1e1e1e"},AUD:{accountNumber:"1234567890",bankName:"Commonwealth Bank",swiftCode:"CBA123AU"},MXN:{accountNumber:"0987654321",bankName:"Banorte",swiftCode:"BAN456MX"}};e[n]&&(m.value=e[n])},D=N(()=>{if(!s.value||!s.value.data.payin.max||!s.value.data.payin.min)return!0;const n=s.value?.data.payin.min,e=s.value?.data.payin.max;return l.value>=n&&l.value<=e}),O=()=>{if(b.value){const n=c.offerings.filter(t=>t.data.payin.currencyCode===b.value),e=new Set;n.forEach(t=>{e.add(t.data.payout.currencyCode)}),c.payoutCurrencies=Array.from(e),C.value=!0}else c.payoutCurrencies=[],C.value=!1},j=()=>{b.value&&y.value&&(_.value=R(b.value,y.value))},H=n=>{s.value=n,q(n),z(),g.value=2},Q=()=>{l.value&&s.value&&(w.value=V(l.value*s.value.data.payoutUnitsPerPayinUnit))},$=()=>{if(!l.value){alert("Please enter the amount.");return}for(const n in s.value.data.payout.methods[0].requiredPaymentDetails.properties){if(!m.value[n]){alert(`Please enter ${s.value.data.payout.methods[0].requiredPaymentDetails.properties[n].title}.`);return}const e=s.value.data.payout.methods[0].requiredPaymentDetails.properties[n].pattern;if(e&&!m.value[n].match(e)){alert(`Please enter a valid ${s.value.data.payout.methods[0].requiredPaymentDetails.properties[n].title}.`);return}}K()},K=async()=>{P.value=!0,await E(s.value,l.value,m.value),B.push("/dashboard")},z=()=>{x.value&&(localStorage.setItem("selectedOffering",JSON.stringify(s.value)),B.push("/credentials"))},J=()=>{if(localStorage.getItem("selectedOffering")){const n=JSON.parse(localStorage.getItem("selectedOffering"));s.value=I(n.metadata.id),localStorage.removeItem("selectedOffering"),g.value=2}};return(n,e)=>(o(),r("div",oe,[Z(ne),a("main",re,[a("div",ie,[g.value===1?(o(),r("div",le,[e[10]||(e[10]=a("h2",{class:"text-2xl font-bold mb-4 dark:text-white"},"Donate To A Cause",-1)),u(c).payinCurrencies.length?(o(),r("div",de,[a("div",ue,[e[6]||(e[6]=a("label",{class:"block text-gray-700 dark:text-gray-300 mb-2"},"From Currency",-1)),v(a("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>b.value=t),onChange:O,class:"w-full p-2 border rounded"},[e[5]||(e[5]=a("option",{disabled:"",value:""},"Select currency",-1)),(o(!0),r(h,null,k(u(c).payinCurrencies,t=>(o(),r("option",{key:t,value:t},i(t),9,ce))),128))],544),[[U,b.value]])]),a("div",fe,[e[8]||(e[8]=a("label",{class:"block text-gray-700 dark:text-gray-300 mb-2"},"To Currency",-1)),v(a("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>y.value=t),disabled:!C.value,class:"w-full p-2 border rounded"},[e[7]||(e[7]=a("option",{disabled:"",value:""},"Select currency",-1)),(o(!0),r(h,null,k(u(c).payoutCurrencies,t=>(o(),r("option",{key:t,value:t},i(t),9,me))),128))],8,be),[[U,y.value]])]),a("button",{onClick:j,class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 disabled:bg-gray-800 dark:text-white border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"}," Get Offerings ")])):(o(),A(G,{key:1})),_.value.length?(o(),r("div",ve,[e[9]||(e[9]=a("h2",{class:"text-2xl font-bold mb-4"},"Exchange Rate Offerings",-1)),a("ul",null,[(o(!0),r(h,null,k(_.value,t=>(o(),r("li",{key:t.id,onClick:f=>H(t),class:"cursor-pointer p-4 border rounded mb-2 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors"},[a("h3",ge,i(u(c).pfiAllowlist.find(f=>f.pfiUri===t.metadata.from)?.pfiName),1),a("p",null,i(t.data.description),1),a("p",ye,i(t.data.payoutUnitsPerPayinUnit)+" "+i(t.data.payout.currencyCode)+" for 1 "+i(t.data.payin.currencyCode),1)],8,pe))),128))])])):p("",!0)])):p("",!0),g.value===2?(o(),r("div",xe,[e[11]||(e[11]=a("h2",{class:"text-2xl font-bold mb-4 dark:text-white"},"Enter Transaction Details",-1)),a("div",he,[!u(D)&&l.value!==""?(o(),r("p",ke," Amount must be between "+i(s.value?.data?.payin?.min)+" and "+i(s.value?.data?.payin?.max),1)):p("",!0),a("label",Ce,"You Send ("+i(s.value?.data?.payin?.currencyCode)+")",1),v(a("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>l.value=t),onInput:Q,type:"number",required:"",class:ee(["w-full p-2 border rounded disabled:bg-slate-200",{"border-red-500":!u(D)&&l.value!==""}]),disabled:u(x)},null,42,we),[[T,l.value]])]),a("div",_e,[a("label",Ne,"They Get ("+i(s.value?.data?.payout?.currencyCode)+")",1),v(a("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>w.value=t),type:"number",disabled:"",class:"w-full p-2 border rounded disabled:bg-slate-200"},null,512),[[T,w.value]])]),a("div",Se," Exchange Rate: "+i(s.value?.data?.payoutUnitsPerPayinUnit)+" "+i(s.value?.data?.payout?.currencyCode)+" for 1 "+i(s.value?.data?.payin?.currencyCode),1),(o(!0),r(h,null,k(s.value?.data?.payout?.methods[0]?.requiredPaymentDetails?.properties,(t,f)=>(o(),r("div",{key:f,class:"mb-4"},[a("label",{for:f,class:"block text-gray-700 dark:text-gray-300 mb-2"},i(t.title),9,Be),v(a("input",{"onUpdate:modelValue":W=>m.value[f]=W,id:f,type:t.type,pattern:t.pattern,required:"",class:"w-full p-2 border rounded disabled:bg-slate-200",disabled:""},null,8,Pe),[[ae,m.value[f]]]),a("small",De,i(t.description),1)]))),128)),e[12]||(e[12]=a("p",{class:"text-xs text-green-400 mb-2 flex"},[a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"green","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"h-5 w-5"},[a("path",{d:"M20 6 9 17l-5-5"})]),te(" Required credentials available. ")],-1)),u(x)?(o(),r("button",{key:0,class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 disabled:bg-slate-400 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2 mr-2 dark:text-white",onClick:e[4]||(e[4]=t=>("navigateTo"in n?n.navigateTo:u(se))("/credentials"))},"Verify Identity")):p("",!0),P.value?(o(),A(G,{key:2})):(o(),r("button",{key:1,onClick:$,class:"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 disabled:bg-slate-400 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2 dark:text-white",disabled:u(x)}," Request for Quote ",8,Oe))])):p("",!0)])])]))}};export{Ve as default};
