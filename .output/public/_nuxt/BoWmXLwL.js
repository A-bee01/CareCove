var UI=Object.defineProperty;var KI=(t,e,r)=>e in t?UI(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var de=(t,e,r)=>KI(t,typeof e!="symbol"?e+"":e,r);import{R as LI,S as Pf,e as qI,T as VI,O as zI,n as HI,U as ad,V as ud,W as rv,X as Cf}from"./DszPRIJ0.js";const WI=window.setInterval;var lr="0123456789abcdefghjkmnpqrstvwxyz",Ue=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,10,11,12,13,14,15,16,17,255,18,19,255,20,21,255,22,23,24,25,26,255,27,28,29,30,31,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255]);function nv(t){const e=new Array(26).fill("");if(t.length!==16)throw new Error("Invalid length");return e[0]=lr[(t[0]&224)>>5],e[1]=lr[t[0]&31],e[2]=lr[(t[1]&248)>>3],e[3]=lr[(t[1]&7)<<2|(t[2]&192)>>6],e[4]=lr[(t[2]&62)>>1],e[5]=lr[(t[2]&1)<<4|(t[3]&240)>>4],e[6]=lr[(t[3]&15)<<1|(t[4]&128)>>7],e[7]=lr[(t[4]&124)>>2],e[8]=lr[(t[4]&3)<<3|(t[5]&224)>>5],e[9]=lr[t[5]&31],e[10]=lr[(t[6]&248)>>3],e[11]=lr[(t[6]&7)<<2|(t[7]&192)>>6],e[12]=lr[(t[7]&62)>>1],e[13]=lr[(t[7]&1)<<4|(t[8]&240)>>4],e[14]=lr[(t[8]&15)<<1|(t[9]&128)>>7],e[15]=lr[(t[9]&124)>>2],e[16]=lr[(t[9]&3)<<3|(t[10]&224)>>5],e[17]=lr[t[10]&31],e[18]=lr[(t[11]&248)>>3],e[19]=lr[(t[11]&7)<<2|(t[12]&192)>>6],e[20]=lr[(t[12]&62)>>1],e[21]=lr[(t[12]&1)<<4|(t[13]&240)>>4],e[22]=lr[(t[13]&15)<<1|(t[14]&128)>>7],e[23]=lr[(t[14]&124)>>2],e[24]=lr[(t[14]&3)<<3|(t[15]&224)>>5],e[25]=lr[t[15]&31],e.join("")}function F2(t){if(t.length!==26)throw new Error("Invalid length");const r=new TextEncoder().encode(t);if(Ue[r[0]]===255||Ue[r[1]]===255||Ue[r[2]]===255||Ue[r[3]]===255||Ue[r[4]]===255||Ue[r[5]]===255||Ue[r[6]]===255||Ue[r[7]]===255||Ue[r[8]]===255||Ue[r[9]]===255||Ue[r[10]]===255||Ue[r[11]]===255||Ue[r[12]]===255||Ue[r[13]]===255||Ue[r[14]]===255||Ue[r[15]]===255||Ue[r[16]]===255||Ue[r[17]]===255||Ue[r[18]]===255||Ue[r[19]]===255||Ue[r[20]]===255||Ue[r[21]]===255||Ue[r[22]]===255||Ue[r[23]]===255||Ue[r[24]]===255||Ue[r[25]]===255)throw new Error("Invalid base32 character");const n=new Uint8Array(16);return n[0]=Ue[r[0]]<<5|Ue[r[1]],n[1]=Ue[r[2]]<<3|Ue[r[3]]>>2,n[2]=(Ue[r[3]]&3)<<6|Ue[r[4]]<<1|Ue[r[5]]>>4,n[3]=(Ue[r[5]]&15)<<4|Ue[r[6]]>>1,n[4]=(Ue[r[6]]&1)<<7|Ue[r[7]]<<2|Ue[r[8]]>>3,n[5]=(Ue[r[8]]&7)<<5|Ue[r[9]],n[6]=Ue[r[10]]<<3|Ue[r[11]]>>2,n[7]=(Ue[r[11]]&3)<<6|Ue[r[12]]<<1|Ue[r[13]]>>4,n[8]=(Ue[r[13]]&15)<<4|Ue[r[14]]>>1,n[9]=(Ue[r[14]]&1)<<7|Ue[r[15]]<<2|Ue[r[16]]>>3,n[10]=(Ue[r[16]]&7)<<5|Ue[r[17]],n[11]=Ue[r[18]]<<3|Ue[r[19]]>>2,n[12]=(Ue[r[19]]&3)<<6|Ue[r[20]]<<1|Ue[r[21]]>>4,n[13]=(Ue[r[21]]&15)<<4|Ue[r[22]]>>1,n[14]=(Ue[r[22]]&1)<<7|Ue[r[23]]<<2|Ue[r[24]]>>3,n[15]=(Ue[r[24]]&7)<<5|Ue[r[25]],n}function JI(t){let e;const r=new Uint8Array(16);return r[0]=(e=parseInt(t.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=e&255,r[4]=(e=parseInt(t.slice(9,13),16))>>>8,r[5]=e&255,r[6]=(e=parseInt(t.slice(14,18),16))>>>8,r[7]=e&255,r[8]=(e=parseInt(t.slice(19,23),16))>>>8,r[9]=e&255,r[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=e&255,r}var ll=Math.pow,N2="0123456789abcdef",b0=class{constructor(t){if(this.bytes=t,t.length!==16)throw new TypeError("not 128-bit length")}static fromFieldsV7(t,e,r,n){if(!Number.isInteger(t)||!Number.isInteger(e)||!Number.isInteger(r)||!Number.isInteger(n)||t<0||e<0||r<0||n<0||t>0xffffffffffff||e>4095||r>1073741823||n>4294967295)throw new RangeError("invalid field value");const s=new Uint8Array(16);return s[0]=t/ll(2,40),s[1]=t/ll(2,32),s[2]=t/ll(2,24),s[3]=t/ll(2,16),s[4]=t/ll(2,8),s[5]=t,s[6]=112|e>>>8,s[7]=e,s[8]=128|r>>>24,s[9]=r>>>16,s[10]=r>>>8,s[11]=r,s[12]=n>>>24,s[13]=n>>>16,s[14]=n>>>8,s[15]=n,new b0(s)}toString(){let t="";for(let e=0;e<this.bytes.length;e++)t+=N2.charAt(this.bytes[e]>>>4),t+=N2.charAt(this.bytes[e]&15),(e===3||e===5||e===7||e===9)&&(t+="-");return t}clone(){return new b0(this.bytes.slice(0))}equals(t){return this.compareTo(t)===0}compareTo(t){for(let e=0;e<16;e++){const r=this.bytes[e]-t.bytes[e];if(r!==0)return Math.sign(r)}return 0}},GI=class{constructor(){this.timestamp=0,this.counter=0,this.random=new ZI}generate(){const t=this.generateOrAbort();return t!==void 0?t:(this.timestamp=0,this.generateOrAbort())}generateOrAbort(){const r=Date.now();if(r>this.timestamp)this.timestamp=r,this.resetCounter();else if(r+1e4>this.timestamp)this.counter++,this.counter>4398046511103&&(this.timestamp++,this.resetCounter());else return;return b0.fromFieldsV7(this.timestamp,Math.trunc(this.counter/ll(2,30)),this.counter&ll(2,30)-1,this.random.nextUint32())}resetCounter(){this.counter=this.random.nextUint32()*1024+(this.random.nextUint32()&1023)}},m5=t=>{if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(let e=0;e<t.length;e++)t[e]=Math.trunc(Math.random()*65536)*65536+Math.trunc(Math.random()*65536);return t};typeof crypto<"u"&&crypto.getRandomValues&&(m5=t=>crypto.getRandomValues(t));var ZI=class{constructor(){this.buffer=new Uint32Array(8),this.cursor=99}nextUint32(){return this.cursor>=this.buffer.length&&(m5(this.buffer),this.cursor=0),this.buffer[this.cursor++]}},R2,XI=()=>(R2||(R2=new GI)).generate();function YI(t){if(t.length>63)return!1;let e,r,n;for(r=0,n=t.length;r<n;r+=1)if(e=t.charCodeAt(r),!(e>96&&e<123))return!1;return!0}var Pp=class{constructor(t,e=""){if(this.prefix=t,this.suffix=e,!YI(t))throw new Error("Invalid prefix. Must be at most 63 ascii letters [a-z]");if(this.prefix=t,e)this.suffix=e;else{const r=XI();this.suffix=nv(r.bytes)}if(this.suffix.length!==26)throw new Error(`Invalid length. Suffix should have 26 characters, got ${e.length}`);if(this.suffix[0]>"7")throw new Error("Invalid suffix. First character must be in the range [0-7]");F2(this.suffix)}getType(){return this.prefix}getSuffix(){return this.suffix}asType(t){const e=this;if(e.prefix!==t)throw new Error(`Cannot convert TypeID of type ${e.prefix} to type ${t}`);return e}toUUIDBytes(){return F2(this.suffix)}toUUID(){return new b0(this.toUUIDBytes()).toString()}toString(){return this.prefix===""?this.suffix:`${this.prefix}_${this.suffix}`}static fromString(t){const e=t.split("_");if(e.length===1)return new Pp("",e[0]);if(e.length===2){if(e[0]==="")throw new Error(`Invalid TypeID. Prefix cannot be empty when there's a separator: ${t}`);return new Pp(e[0],e[1])}throw new Error(`Invalid TypeID string: ${t}`)}static fromUUIDBytes(t,e){const r=nv(e);return new Pp(t,r)}static fromUUID(t,e){const r=nv(JI(e));return new Pp(t,r)}};function O1(t="",e=""){return new Pp(t,e)}/*! Bundled license information:

uuidv7/dist/index.js:
  (**
   * uuidv7: An experimental implementation of the proposed UUID Version 7
   *
   * @license Apache-2.0
   * @copyright 2021-2023 LiosK
   * @packageDocumentation
   *)
*/function j2(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function QI(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function g5(t,...e){if(!QI(t))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function eB(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");j2(t.outputLen),j2(t.blockLen)}function _0(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function tB(t,e){g5(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const iv=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function v5(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}const sv=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),to=(t,e)=>t<<32-e|t>>>e,rB=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!rB)throw new Error("Non little-endian hardware is not supported");function w5(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function T1(t){if(typeof t=="string"&&(t=w5(t)),!v5(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function b5(...t){let e=0;for(let n=0;n<t.length;n++){const s=t[n];if(!v5(s))throw new Error("Uint8Array expected");e+=s.length}const r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){const i=t[n];r.set(i,s),s+=i.length}return r}let _5=class{clone(){return this._cloneInto()}};function E5(t){const e=n=>t().update(T1(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function I1(t=32){if(iv&&typeof iv.getRandomValues=="function")return iv.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function nB(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),c=n?4:0,l=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+l,a,n)}let A5=class extends _5{constructor(e,r,n,s){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=sv(this.buffer)}update(e){_0(this);const{view:r,buffer:n,blockLen:s}=this;e=T1(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=sv(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){_0(this),tB(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)r[d]=0;nB(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=sv(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%r&&e.buffer.set(n),e}};const iB=(t,e,r)=>t&e^~t&r,sB=(t,e,r)=>t&e^t&r^e&r,oB=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),nu=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),iu=new Uint32Array(64);let aB=class extends A5{constructor(){super(64,32,8,!1),this.A=nu[0]|0,this.B=nu[1]|0,this.C=nu[2]|0,this.D=nu[3]|0,this.E=nu[4]|0,this.F=nu[5]|0,this.G=nu[6]|0,this.H=nu[7]|0}get(){const{A:e,B:r,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,r,n,s,i,o,a,c]}set(e,r,n,s,i,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let d=0;d<16;d++,r+=4)iu[d]=e.getUint32(r,!1);for(let d=16;d<64;d++){const h=iu[d-15],f=iu[d-2],p=to(h,7)^to(h,18)^h>>>3,y=to(f,17)^to(f,19)^f>>>10;iu[d]=y+iu[d-7]+p+iu[d-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=to(a,6)^to(a,11)^to(a,25),f=u+h+iB(a,c,l)+oB[d]+iu[d]|0,y=(to(n,2)^to(n,13)^to(n,22))+sB(n,s,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=s,s=n,n=f+y|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,s,i,o,a,c,l,u)}roundClean(){iu.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const pc=E5(()=>new aB);var Zt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Jo(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function uB(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),r}function cB(t){if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")}function lB(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var y=0,b=0,w=0,g=p.length;w!==g&&p[w]===0;)w++,y++;for(var v=(g-w)*u+1>>>0,m=new Uint8Array(v);w!==g;){for(var _=p[w],x=0,D=v-1;(_!==0||x<b)&&D!==-1;D--,x++)_+=256*m[D]>>>0,m[D]=_%a>>>0,_=_/a>>>0;if(_!==0)throw new Error("Non-zero carry");b=x,w++}for(var E=v-b;E!==v&&m[E]===0;)E++;for(var A=c.repeat(y);E<v;++E)A+=t.charAt(m[E]);return A}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var y=0;if(p[y]!==" "){for(var b=0,w=0;p[y]===c;)b++,y++;for(var g=(p.length-y)*l+1>>>0,v=new Uint8Array(g);p[y];){var m=r[p.charCodeAt(y)];if(m===255)return;for(var _=0,x=g-1;(m!==0||_<w)&&x!==-1;x--,_++)m+=a*v[x]>>>0,v[x]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");w=_,y++}if(p[y]!==" "){for(var D=g-w;D!==g&&v[D]===0;)D++;for(var E=new Uint8Array(b+(g-D)),A=b;D!==g;)E[A++]=v[D++];return E}}}function f(p){var y=h(p);if(y)return y;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var dB=lB,fB=dB;let pB=class{constructor(e,r,n){de(this,"name");de(this,"prefix");de(this,"baseEncode");this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},hB=class{constructor(e,r,n){de(this,"name");de(this,"prefix");de(this,"baseDecode");de(this,"prefixCodePoint");if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return S5(this,e)}},yB=class{constructor(e){de(this,"decoders");this.decoders=e}or(e){return S5(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n!=null)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function S5(t,e){return new yB({...t.decoders??{[t.prefix]:t},...e.decoders??{[e.prefix]:e}})}let mB=class{constructor(e,r,n,s){de(this,"name");de(this,"prefix");de(this,"baseEncode");de(this,"baseDecode");de(this,"encoder");de(this,"decoder");this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new pB(e,r,n),this.decoder=new hB(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};function $5({name:t,prefix:e,encode:r,decode:n}){return new mB(t,e,r,n)}function x5({name:t,prefix:e,alphabet:r}){const{encode:n,decode:s}=fB(r,t);return $5({prefix:e,name:t,encode:n,decode:i=>cB(s(i))})}function gB(t,e,r,n){const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o}function vB(t,e,r){const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o!==0&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i}function Ni({name:t,prefix:e,bitsPerChar:r,alphabet:n}){return $5({prefix:e,name:t,encode(s){return vB(s,n,r)},decode(s){return gB(s,n,r,t)}})}Ni({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});Ni({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});Ni({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});Ni({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});Ni({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});Ni({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});Ni({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});Ni({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});const M2=Ni({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),_y=x5({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});x5({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});Ni({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});Ni({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const ra=Ni({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});Ni({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function wB(t){return t.byteOffset!==0||t.byteLength!==t.buffer.byteLength}function bB(t){return typeof t!="object"||t===null?!1:typeof t[Symbol.asyncIterator]=="function"}function U2(t){const r=Object.prototype.toString.call(t).match(/\s([a-zA-Z0-9]+)/),[n,s]=r;return s}var kf=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},K2=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}};const Ey=new TextEncoder,Tc=new TextDecoder;let Bs=class ri{constructor(e,r){this.data=e,this.format=r}static arrayBuffer(e){return new ri(e,"ArrayBuffer")}static asyncIterable(e){if(!bB(e))throw new TypeError("Input must be of type AsyncIterable.");return new ri(e,"AsyncIterable")}static base32Z(e){return new ri(e,"Base32Z")}static base58Btc(e){return new ri(e,"Base58Btc")}static base64Url(e){return new ri(e,"Base64Url")}static bufferSource(e){return new ri(e,"BufferSource")}static hex(e){if(typeof e!="string")throw new TypeError("Hex input must be a string.");if(e.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new ri(e,"Hex")}static multibase(e){return new ri(e,"Multibase")}static object(e){return new ri(e,"Object")}static string(e){return new ri(e,"String")}static uint8Array(e){return new ri(e,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return _y.baseDecode(this.data).buffer;case"Base64Url":return ra.baseDecode(this.data).buffer;case"BufferSource":{if(U2(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return wB(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return kf(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return M2.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return _y.baseEncode(e)}case"Multibase":return this.data.substring(1);case"Uint8Array":return _y.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return ra.baseEncode(e)}case"BufferSource":{const e=this.toUint8Array();return ra.baseEncode(e)}case"Object":{const e=JSON.stringify(this.data),r=Ey.encode(e);return ra.baseEncode(r)}case"String":{const e=Ey.encode(this.data);return ra.baseEncode(e)}case"Uint8Array":return ra.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){return kf(this,void 0,void 0,function*(){var e,r,n,s;switch(this.format){case"AsyncIterable":{const c=[];try{for(var i=!0,o=K2(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const u=s;c.push(u)}}catch(u){r={error:u}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return new Blob(c)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){const e=Array.from({length:256},(r,n)=>n.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{const r=this.toUint8Array();return ri.uint8Array(r).toHex()}case"Base64Url":{const r=this.toUint8Array();return ri.uint8Array(r).toHex()}case"Uint8Array":{let r="";for(let n=0;n<this.data.length;n++)r+=e[this.data[n]];return r}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{const e=ra.baseDecode(this.data),r=Tc.decode(e);return JSON.parse(r)}case"String":return JSON.parse(this.data);case"Uint8Array":{const e=Tc.decode(this.data);return JSON.parse(e)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return kf(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toStringAsync();return JSON.parse(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return Tc.decode(this.data);case"Base64Url":{const e=ra.baseDecode(this.data);return Tc.decode(e)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return Tc.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){return kf(this,void 0,void 0,function*(){var e,r,n,s;switch(this.format){case"AsyncIterable":{let c="";try{for(var i=!0,o=K2(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const l=s;typeof l=="string"?c+=l:c+=Tc.decode(l,{stream:!0})}}catch(l){r={error:l}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return c+=Tc.decode(void 0,{stream:!1}),c}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return M2.baseDecode(this.data);case"Base58Btc":return _y.baseDecode(this.data);case"Base64Url":return ra.baseDecode(this.data);case"BufferSource":{const e=U2(this.data);if(e==="Uint8Array")return this.data;if(e==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{const e=new Uint8Array(this.data.length/2);for(let r=0;r<this.data.length;r+=2){const n=parseInt(this.data.substring(r,r+2),16);if(isNaN(n))throw new TypeError("Input is not a valid hexadecimal string.");e[r/2]=n}return e}case"Object":{const e=JSON.stringify(this.data);return Ey.encode(e)}case"String":return Ey.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return kf(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toArrayBufferAsync();return new Uint8Array(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}};var _B=D5,L2=128,EB=127,AB=~EB,SB=Math.pow(2,31);function D5(t,e,r){e=e||[],r=r||0;for(var n=r;t>=SB;)e[r++]=t&255|L2,t/=128;for(;t&AB;)e[r++]=t&255|L2,t>>>=7;return e[r]=t|0,D5.bytes=r-n+1,e}var $B=Yw,xB=128,q2=127;function Yw(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw Yw.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&q2)<<s:(o&q2)*Math.pow(2,s),s+=7}while(o>=xB);return Yw.bytes=i-n,r}var DB=Math.pow(2,7),PB=Math.pow(2,14),CB=Math.pow(2,21),kB=Math.pow(2,28),OB=Math.pow(2,35),TB=Math.pow(2,42),IB=Math.pow(2,49),BB=Math.pow(2,56),FB=Math.pow(2,63),NB=function(t){return t<DB?1:t<PB?2:t<CB?3:t<kB?4:t<OB?5:t<TB?6:t<IB?7:t<BB?8:t<FB?9:10},RB={encode:_B,decode:$B,encodingLength:NB},E0=RB;function V2(t,e=0){return[E0.decode(t,e),E0.decode.bytes]}function jB(t,e,r=0){return E0.encode(t,e,r),e}function MB(t){return E0.encodingLength(t)}let wc=class Ou{static addPrefix(e){var r;let{code:n,data:s,name:i}=e;if(!(i?!n:n))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(n=Ou.codeToName.has(n)?n:Ou.nameToCode.get(i),n===void 0)throw new Error(`Unsupported multicodec: ${(r=e.name)!==null&&r!==void 0?r:e.code}`);const o=MB(n),a=new Uint8Array(o+s.byteLength);return a.set(s,o),jB(n,a),a}static getCodeFromData(e){const{prefixedData:r}=e,[n,s]=V2(r);return n}static getCodeFromName(e){const{name:r}=e,n=Ou.nameToCode.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static getNameFromCode(e){const{code:r}=e,n=Ou.codeToName.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static registerCodec(e){Ou.codeToName.set(e.code,e.name),Ou.nameToCode.set(e.name,e.code)}static removePrefix(e){const{prefixedData:r}=e,[n,s]=V2(r),i=Ou.codeToName.get(n);if(i===void 0)throw new Error(`Unsupported multicodec: ${n}`);return{code:n,data:r.slice(s),name:i}}};wc.codeToName=new Map;wc.nameToCode=new Map;wc.registerCodec({code:237,name:"ed25519-pub"});wc.registerCodec({code:4864,name:"ed25519-priv"});wc.registerCodec({code:236,name:"x25519-pub"});wc.registerCodec({code:4866,name:"x25519-priv"});wc.registerCodec({code:231,name:"secp256k1-pub"});wc.registerCodec({code:4865,name:"secp256k1-priv"});var bc={},lg={},P5={};P5.supports=function(...e){const r=e.reduce((n,s)=>Object.assign(n,s),{});return Object.assign(r,{snapshots:r.snapshots||!1,permanence:r.permanence||!1,seek:r.seek||!1,clear:r.clear||!1,getMany:r.getMany||!1,keyIterator:r.keyIterator||!1,valueIterator:r.valueIterator||!1,iteratorNextv:r.iteratorNextv||!1,iteratorAll:r.iteratorAll||!1,status:r.status||!1,createIfMissing:r.createIfMissing||!1,errorIfExists:r.errorIfExists||!1,deferredOpen:r.deferredOpen||!1,promises:r.promises||!1,streams:r.streams||!1,encodings:Object.assign({},r.encodings),events:Object.assign({},r.events),additionalMethods:Object.assign({},r.additionalMethods)})};var C5={},Go=class extends Error{constructor(e,r){super(e||""),typeof r=="object"&&r!==null&&(r.code&&(this.code=String(r.code)),r.expected&&(this.expected=!0),r.transient&&(this.transient=!0),r.cause&&(this.cause=r.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}},Ql={},As={},dg={};dg.byteLength=LB;dg.toByteArray=VB;dg.fromByteArray=WB;var Po=[],ts=[],UB=typeof Uint8Array<"u"?Uint8Array:Array,ov="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var cd=0,KB=ov.length;cd<KB;++cd)Po[cd]=ov[cd],ts[ov.charCodeAt(cd)]=cd;ts[45]=62;ts[95]=63;function k5(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function LB(t){var e=k5(t),r=e[0],n=e[1];return(r+n)*3/4-n}function qB(t,e,r){return(e+r)*3/4-r}function VB(t){var e,r=k5(t),n=r[0],s=r[1],i=new UB(qB(t,n,s)),o=0,a=s>0?n-4:n,c;for(c=0;c<a;c+=4)e=ts[t.charCodeAt(c)]<<18|ts[t.charCodeAt(c+1)]<<12|ts[t.charCodeAt(c+2)]<<6|ts[t.charCodeAt(c+3)],i[o++]=e>>16&255,i[o++]=e>>8&255,i[o++]=e&255;return s===2&&(e=ts[t.charCodeAt(c)]<<2|ts[t.charCodeAt(c+1)]>>4,i[o++]=e&255),s===1&&(e=ts[t.charCodeAt(c)]<<10|ts[t.charCodeAt(c+1)]<<4|ts[t.charCodeAt(c+2)]>>2,i[o++]=e>>8&255,i[o++]=e&255),i}function zB(t){return Po[t>>18&63]+Po[t>>12&63]+Po[t>>6&63]+Po[t&63]}function HB(t,e,r){for(var n,s=[],i=e;i<r;i+=3)n=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(t[i+2]&255),s.push(zB(n));return s.join("")}function WB(t){for(var e,r=t.length,n=r%3,s=[],i=16383,o=0,a=r-n;o<a;o+=i)s.push(HB(t,o,o+i>a?a:o+i));return n===1?(e=t[r-1],s.push(Po[e>>2]+Po[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],s.push(Po[e>>10]+Po[e>>4&63]+Po[e<<2&63]+"=")),s.join("")}var B1={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */B1.read=function(t,e,r,n,s){var i,o,a=s*8-n-1,c=(1<<a)-1,l=c>>1,u=-7,d=r?s-1:0,h=r?-1:1,f=t[e+d];for(d+=h,i=f&(1<<-u)-1,f>>=-u,u+=a;u>0;i=i*256+t[e+d],d+=h,u-=8);for(o=i&(1<<-u)-1,i>>=-u,u+=n;u>0;o=o*256+t[e+d],d+=h,u-=8);if(i===0)i=1-l;else{if(i===c)return o?NaN:(f?-1:1)*(1/0);o=o+Math.pow(2,n),i=i-l}return(f?-1:1)*o*Math.pow(2,i-n)};B1.write=function(t,e,r,n,s,i){var o,a,c,l=i*8-s-1,u=(1<<l)-1,d=u>>1,h=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:i-1,p=n?1:-1,y=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+d>=1?e+=h/c:e+=h*Math.pow(2,1-d),e*c>=2&&(o++,c/=2),o+d>=u?(a=0,o=u):o+d>=1?(a=(e*c-1)*Math.pow(2,s),o=o+d):(a=e*Math.pow(2,d-1)*Math.pow(2,s),o=0));s>=8;t[r+f]=a&255,f+=p,a/=256,s-=8);for(o=o<<s|a,l+=s;l>0;t[r+f]=o&255,f+=p,o/=256,l-=8);t[r+f-p]|=y*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){var e=dg,r=B1,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=g,t.INSPECT_MAX_BYTES=50;var s=2147483647;t.kMaxLength=s,a.TYPED_ARRAY_SUPPORT=i(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{var K=new Uint8Array(1),C={foo:function(){return 42}};return Object.setPrototypeOf(C,Uint8Array.prototype),Object.setPrototypeOf(K,C),K.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function o(K){if(K>s)throw new RangeError('The value "'+K+'" is invalid for option "size"');var C=new Uint8Array(K);return Object.setPrototypeOf(C,a.prototype),C}function a(K,C,B){if(typeof K=="number"){if(typeof C=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(K)}return c(K,C,B)}a.poolSize=8192;function c(K,C,B){if(typeof K=="string")return h(K,C);if(ArrayBuffer.isView(K))return p(K);if(K==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof K);if(te(K,ArrayBuffer)||K&&te(K.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(te(K,SharedArrayBuffer)||K&&te(K.buffer,SharedArrayBuffer)))return y(K,C,B);if(typeof K=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var X=K.valueOf&&K.valueOf();if(X!=null&&X!==K)return a.from(X,C,B);var ae=b(K);if(ae)return ae;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof K[Symbol.toPrimitive]=="function")return a.from(K[Symbol.toPrimitive]("string"),C,B);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof K)}a.from=function(K,C,B){return c(K,C,B)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function l(K){if(typeof K!="number")throw new TypeError('"size" argument must be of type number');if(K<0)throw new RangeError('The value "'+K+'" is invalid for option "size"')}function u(K,C,B){return l(K),K<=0?o(K):C!==void 0?typeof B=="string"?o(K).fill(C,B):o(K).fill(C):o(K)}a.alloc=function(K,C,B){return u(K,C,B)};function d(K){return l(K),o(K<0?0:w(K)|0)}a.allocUnsafe=function(K){return d(K)},a.allocUnsafeSlow=function(K){return d(K)};function h(K,C){if((typeof C!="string"||C==="")&&(C="utf8"),!a.isEncoding(C))throw new TypeError("Unknown encoding: "+C);var B=v(K,C)|0,X=o(B),ae=X.write(K,C);return ae!==B&&(X=X.slice(0,ae)),X}function f(K){for(var C=K.length<0?0:w(K.length)|0,B=o(C),X=0;X<C;X+=1)B[X]=K[X]&255;return B}function p(K){if(te(K,Uint8Array)){var C=new Uint8Array(K);return y(C.buffer,C.byteOffset,C.byteLength)}return f(K)}function y(K,C,B){if(C<0||K.byteLength<C)throw new RangeError('"offset" is outside of buffer bounds');if(K.byteLength<C+(B||0))throw new RangeError('"length" is outside of buffer bounds');var X;return C===void 0&&B===void 0?X=new Uint8Array(K):B===void 0?X=new Uint8Array(K,C):X=new Uint8Array(K,C,B),Object.setPrototypeOf(X,a.prototype),X}function b(K){if(a.isBuffer(K)){var C=w(K.length)|0,B=o(C);return B.length===0||K.copy(B,0,0,C),B}if(K.length!==void 0)return typeof K.length!="number"||se(K.length)?o(0):f(K);if(K.type==="Buffer"&&Array.isArray(K.data))return f(K.data)}function w(K){if(K>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return K|0}function g(K){return+K!=K&&(K=0),a.alloc(+K)}a.isBuffer=function(C){return C!=null&&C._isBuffer===!0&&C!==a.prototype},a.compare=function(C,B){if(te(C,Uint8Array)&&(C=a.from(C,C.offset,C.byteLength)),te(B,Uint8Array)&&(B=a.from(B,B.offset,B.byteLength)),!a.isBuffer(C)||!a.isBuffer(B))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(C===B)return 0;for(var X=C.length,ae=B.length,ge=0,be=Math.min(X,ae);ge<be;++ge)if(C[ge]!==B[ge]){X=C[ge],ae=B[ge];break}return X<ae?-1:ae<X?1:0},a.isEncoding=function(C){switch(String(C).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(C,B){if(!Array.isArray(C))throw new TypeError('"list" argument must be an Array of Buffers');if(C.length===0)return a.alloc(0);var X;if(B===void 0)for(B=0,X=0;X<C.length;++X)B+=C[X].length;var ae=a.allocUnsafe(B),ge=0;for(X=0;X<C.length;++X){var be=C[X];if(te(be,Uint8Array))ge+be.length>ae.length?a.from(be).copy(ae,ge):Uint8Array.prototype.set.call(ae,be,ge);else if(a.isBuffer(be))be.copy(ae,ge);else throw new TypeError('"list" argument must be an Array of Buffers');ge+=be.length}return ae};function v(K,C){if(a.isBuffer(K))return K.length;if(ArrayBuffer.isView(K)||te(K,ArrayBuffer))return K.byteLength;if(typeof K!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof K);var B=K.length,X=arguments.length>2&&arguments[2]===!0;if(!X&&B===0)return 0;for(var ae=!1;;)switch(C){case"ascii":case"latin1":case"binary":return B;case"utf8":case"utf-8":return ue(K).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B*2;case"hex":return B>>>1;case"base64":return Se(K).length;default:if(ae)return X?-1:ue(K).length;C=(""+C).toLowerCase(),ae=!0}}a.byteLength=v;function m(K,C,B){var X=!1;if((C===void 0||C<0)&&(C=0),C>this.length||((B===void 0||B>this.length)&&(B=this.length),B<=0)||(B>>>=0,C>>>=0,B<=C))return"";for(K||(K="utf8");;)switch(K){case"hex":return Z(this,C,B);case"utf8":case"utf-8":return j(this,C,B);case"ascii":return ee(this,C,B);case"latin1":case"binary":return G(this,C,B);case"base64":return N(this,C,B);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,C,B);default:if(X)throw new TypeError("Unknown encoding: "+K);K=(K+"").toLowerCase(),X=!0}}a.prototype._isBuffer=!0;function _(K,C,B){var X=K[C];K[C]=K[B],K[B]=X}a.prototype.swap16=function(){var C=this.length;if(C%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var B=0;B<C;B+=2)_(this,B,B+1);return this},a.prototype.swap32=function(){var C=this.length;if(C%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var B=0;B<C;B+=4)_(this,B,B+3),_(this,B+1,B+2);return this},a.prototype.swap64=function(){var C=this.length;if(C%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var B=0;B<C;B+=8)_(this,B,B+7),_(this,B+1,B+6),_(this,B+2,B+5),_(this,B+3,B+4);return this},a.prototype.toString=function(){var C=this.length;return C===0?"":arguments.length===0?j(this,0,C):m.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(C){if(!a.isBuffer(C))throw new TypeError("Argument must be a Buffer");return this===C?!0:a.compare(this,C)===0},a.prototype.inspect=function(){var C="",B=t.INSPECT_MAX_BYTES;return C=this.toString("hex",0,B).replace(/(.{2})/g,"$1 ").trim(),this.length>B&&(C+=" ... "),"<Buffer "+C+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(C,B,X,ae,ge){if(te(C,Uint8Array)&&(C=a.from(C,C.offset,C.byteLength)),!a.isBuffer(C))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof C);if(B===void 0&&(B=0),X===void 0&&(X=C?C.length:0),ae===void 0&&(ae=0),ge===void 0&&(ge=this.length),B<0||X>C.length||ae<0||ge>this.length)throw new RangeError("out of range index");if(ae>=ge&&B>=X)return 0;if(ae>=ge)return-1;if(B>=X)return 1;if(B>>>=0,X>>>=0,ae>>>=0,ge>>>=0,this===C)return 0;for(var be=ge-ae,Ne=X-B,Oe=Math.min(be,Ne),W=this.slice(ae,ge),J=C.slice(B,X),he=0;he<Oe;++he)if(W[he]!==J[he]){be=W[he],Ne=J[he];break}return be<Ne?-1:Ne<be?1:0};function x(K,C,B,X,ae){if(K.length===0)return-1;if(typeof B=="string"?(X=B,B=0):B>2147483647?B=2147483647:B<-2147483648&&(B=-2147483648),B=+B,se(B)&&(B=ae?0:K.length-1),B<0&&(B=K.length+B),B>=K.length){if(ae)return-1;B=K.length-1}else if(B<0)if(ae)B=0;else return-1;if(typeof C=="string"&&(C=a.from(C,X)),a.isBuffer(C))return C.length===0?-1:D(K,C,B,X,ae);if(typeof C=="number")return C=C&255,typeof Uint8Array.prototype.indexOf=="function"?ae?Uint8Array.prototype.indexOf.call(K,C,B):Uint8Array.prototype.lastIndexOf.call(K,C,B):D(K,[C],B,X,ae);throw new TypeError("val must be string, number or Buffer")}function D(K,C,B,X,ae){var ge=1,be=K.length,Ne=C.length;if(X!==void 0&&(X=String(X).toLowerCase(),X==="ucs2"||X==="ucs-2"||X==="utf16le"||X==="utf-16le")){if(K.length<2||C.length<2)return-1;ge=2,be/=2,Ne/=2,B/=2}function Oe(Ce,Mt){return ge===1?Ce[Mt]:Ce.readUInt16BE(Mt*ge)}var W;if(ae){var J=-1;for(W=B;W<be;W++)if(Oe(K,W)===Oe(C,J===-1?0:W-J)){if(J===-1&&(J=W),W-J+1===Ne)return J*ge}else J!==-1&&(W-=W-J),J=-1}else for(B+Ne>be&&(B=be-Ne),W=B;W>=0;W--){for(var he=!0,we=0;we<Ne;we++)if(Oe(K,W+we)!==Oe(C,we)){he=!1;break}if(he)return W}return-1}a.prototype.includes=function(C,B,X){return this.indexOf(C,B,X)!==-1},a.prototype.indexOf=function(C,B,X){return x(this,C,B,X,!0)},a.prototype.lastIndexOf=function(C,B,X){return x(this,C,B,X,!1)};function E(K,C,B,X){B=Number(B)||0;var ae=K.length-B;X?(X=Number(X),X>ae&&(X=ae)):X=ae;var ge=C.length;X>ge/2&&(X=ge/2);for(var be=0;be<X;++be){var Ne=parseInt(C.substr(be*2,2),16);if(se(Ne))return be;K[B+be]=Ne}return be}function A(K,C,B,X){return We(ue(C,K.length-B),K,B,X)}function S(K,C,B,X){return We(ye(C),K,B,X)}function O(K,C,B,X){return We(Se(C),K,B,X)}function I(K,C,B,X){return We(_e(C,K.length-B),K,B,X)}a.prototype.write=function(C,B,X,ae){if(B===void 0)ae="utf8",X=this.length,B=0;else if(X===void 0&&typeof B=="string")ae=B,X=this.length,B=0;else if(isFinite(B))B=B>>>0,isFinite(X)?(X=X>>>0,ae===void 0&&(ae="utf8")):(ae=X,X=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var ge=this.length-B;if((X===void 0||X>ge)&&(X=ge),C.length>0&&(X<0||B<0)||B>this.length)throw new RangeError("Attempt to write outside buffer bounds");ae||(ae="utf8");for(var be=!1;;)switch(ae){case"hex":return E(this,C,B,X);case"utf8":case"utf-8":return A(this,C,B,X);case"ascii":case"latin1":case"binary":return S(this,C,B,X);case"base64":return O(this,C,B,X);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,C,B,X);default:if(be)throw new TypeError("Unknown encoding: "+ae);ae=(""+ae).toLowerCase(),be=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function N(K,C,B){return C===0&&B===K.length?e.fromByteArray(K):e.fromByteArray(K.slice(C,B))}function j(K,C,B){B=Math.min(K.length,B);for(var X=[],ae=C;ae<B;){var ge=K[ae],be=null,Ne=ge>239?4:ge>223?3:ge>191?2:1;if(ae+Ne<=B){var Oe,W,J,he;switch(Ne){case 1:ge<128&&(be=ge);break;case 2:Oe=K[ae+1],(Oe&192)===128&&(he=(ge&31)<<6|Oe&63,he>127&&(be=he));break;case 3:Oe=K[ae+1],W=K[ae+2],(Oe&192)===128&&(W&192)===128&&(he=(ge&15)<<12|(Oe&63)<<6|W&63,he>2047&&(he<55296||he>57343)&&(be=he));break;case 4:Oe=K[ae+1],W=K[ae+2],J=K[ae+3],(Oe&192)===128&&(W&192)===128&&(J&192)===128&&(he=(ge&15)<<18|(Oe&63)<<12|(W&63)<<6|J&63,he>65535&&he<1114112&&(be=he))}}be===null?(be=65533,Ne=1):be>65535&&(be-=65536,X.push(be>>>10&1023|55296),be=56320|be&1023),X.push(be),ae+=Ne}return V(X)}var F=4096;function V(K){var C=K.length;if(C<=F)return String.fromCharCode.apply(String,K);for(var B="",X=0;X<C;)B+=String.fromCharCode.apply(String,K.slice(X,X+=F));return B}function ee(K,C,B){var X="";B=Math.min(K.length,B);for(var ae=C;ae<B;++ae)X+=String.fromCharCode(K[ae]&127);return X}function G(K,C,B){var X="";B=Math.min(K.length,B);for(var ae=C;ae<B;++ae)X+=String.fromCharCode(K[ae]);return X}function Z(K,C,B){var X=K.length;(!C||C<0)&&(C=0),(!B||B<0||B>X)&&(B=X);for(var ae="",ge=C;ge<B;++ge)ae+=ce[K[ge]];return ae}function M(K,C,B){for(var X=K.slice(C,B),ae="",ge=0;ge<X.length-1;ge+=2)ae+=String.fromCharCode(X[ge]+X[ge+1]*256);return ae}a.prototype.slice=function(C,B){var X=this.length;C=~~C,B=B===void 0?X:~~B,C<0?(C+=X,C<0&&(C=0)):C>X&&(C=X),B<0?(B+=X,B<0&&(B=0)):B>X&&(B=X),B<C&&(B=C);var ae=this.subarray(C,B);return Object.setPrototypeOf(ae,a.prototype),ae};function k(K,C,B){if(K%1!==0||K<0)throw new RangeError("offset is not uint");if(K+C>B)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(C,B,X){C=C>>>0,B=B>>>0,X||k(C,B,this.length);for(var ae=this[C],ge=1,be=0;++be<B&&(ge*=256);)ae+=this[C+be]*ge;return ae},a.prototype.readUintBE=a.prototype.readUIntBE=function(C,B,X){C=C>>>0,B=B>>>0,X||k(C,B,this.length);for(var ae=this[C+--B],ge=1;B>0&&(ge*=256);)ae+=this[C+--B]*ge;return ae},a.prototype.readUint8=a.prototype.readUInt8=function(C,B){return C=C>>>0,B||k(C,1,this.length),this[C]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(C,B){return C=C>>>0,B||k(C,2,this.length),this[C]|this[C+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(C,B){return C=C>>>0,B||k(C,2,this.length),this[C]<<8|this[C+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(C,B){return C=C>>>0,B||k(C,4,this.length),(this[C]|this[C+1]<<8|this[C+2]<<16)+this[C+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(C,B){return C=C>>>0,B||k(C,4,this.length),this[C]*16777216+(this[C+1]<<16|this[C+2]<<8|this[C+3])},a.prototype.readIntLE=function(C,B,X){C=C>>>0,B=B>>>0,X||k(C,B,this.length);for(var ae=this[C],ge=1,be=0;++be<B&&(ge*=256);)ae+=this[C+be]*ge;return ge*=128,ae>=ge&&(ae-=Math.pow(2,8*B)),ae},a.prototype.readIntBE=function(C,B,X){C=C>>>0,B=B>>>0,X||k(C,B,this.length);for(var ae=B,ge=1,be=this[C+--ae];ae>0&&(ge*=256);)be+=this[C+--ae]*ge;return ge*=128,be>=ge&&(be-=Math.pow(2,8*B)),be},a.prototype.readInt8=function(C,B){return C=C>>>0,B||k(C,1,this.length),this[C]&128?(255-this[C]+1)*-1:this[C]},a.prototype.readInt16LE=function(C,B){C=C>>>0,B||k(C,2,this.length);var X=this[C]|this[C+1]<<8;return X&32768?X|4294901760:X},a.prototype.readInt16BE=function(C,B){C=C>>>0,B||k(C,2,this.length);var X=this[C+1]|this[C]<<8;return X&32768?X|4294901760:X},a.prototype.readInt32LE=function(C,B){return C=C>>>0,B||k(C,4,this.length),this[C]|this[C+1]<<8|this[C+2]<<16|this[C+3]<<24},a.prototype.readInt32BE=function(C,B){return C=C>>>0,B||k(C,4,this.length),this[C]<<24|this[C+1]<<16|this[C+2]<<8|this[C+3]},a.prototype.readFloatLE=function(C,B){return C=C>>>0,B||k(C,4,this.length),r.read(this,C,!0,23,4)},a.prototype.readFloatBE=function(C,B){return C=C>>>0,B||k(C,4,this.length),r.read(this,C,!1,23,4)},a.prototype.readDoubleLE=function(C,B){return C=C>>>0,B||k(C,8,this.length),r.read(this,C,!0,52,8)},a.prototype.readDoubleBE=function(C,B){return C=C>>>0,B||k(C,8,this.length),r.read(this,C,!1,52,8)};function H(K,C,B,X,ae,ge){if(!a.isBuffer(K))throw new TypeError('"buffer" argument must be a Buffer instance');if(C>ae||C<ge)throw new RangeError('"value" argument is out of bounds');if(B+X>K.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(C,B,X,ae){if(C=+C,B=B>>>0,X=X>>>0,!ae){var ge=Math.pow(2,8*X)-1;H(this,C,B,X,ge,0)}var be=1,Ne=0;for(this[B]=C&255;++Ne<X&&(be*=256);)this[B+Ne]=C/be&255;return B+X},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(C,B,X,ae){if(C=+C,B=B>>>0,X=X>>>0,!ae){var ge=Math.pow(2,8*X)-1;H(this,C,B,X,ge,0)}var be=X-1,Ne=1;for(this[B+be]=C&255;--be>=0&&(Ne*=256);)this[B+be]=C/Ne&255;return B+X},a.prototype.writeUint8=a.prototype.writeUInt8=function(C,B,X){return C=+C,B=B>>>0,X||H(this,C,B,1,255,0),this[B]=C&255,B+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(C,B,X){return C=+C,B=B>>>0,X||H(this,C,B,2,65535,0),this[B]=C&255,this[B+1]=C>>>8,B+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(C,B,X){return C=+C,B=B>>>0,X||H(this,C,B,2,65535,0),this[B]=C>>>8,this[B+1]=C&255,B+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(C,B,X){return C=+C,B=B>>>0,X||H(this,C,B,4,4294967295,0),this[B+3]=C>>>24,this[B+2]=C>>>16,this[B+1]=C>>>8,this[B]=C&255,B+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(C,B,X){return C=+C,B=B>>>0,X||H(this,C,B,4,4294967295,0),this[B]=C>>>24,this[B+1]=C>>>16,this[B+2]=C>>>8,this[B+3]=C&255,B+4},a.prototype.writeIntLE=function(C,B,X,ae){if(C=+C,B=B>>>0,!ae){var ge=Math.pow(2,8*X-1);H(this,C,B,X,ge-1,-ge)}var be=0,Ne=1,Oe=0;for(this[B]=C&255;++be<X&&(Ne*=256);)C<0&&Oe===0&&this[B+be-1]!==0&&(Oe=1),this[B+be]=(C/Ne>>0)-Oe&255;return B+X},a.prototype.writeIntBE=function(C,B,X,ae){if(C=+C,B=B>>>0,!ae){var ge=Math.pow(2,8*X-1);H(this,C,B,X,ge-1,-ge)}var be=X-1,Ne=1,Oe=0;for(this[B+be]=C&255;--be>=0&&(Ne*=256);)C<0&&Oe===0&&this[B+be+1]!==0&&(Oe=1),this[B+be]=(C/Ne>>0)-Oe&255;return B+X},a.prototype.writeInt8=function(C,B,X){return C=+C,B=B>>>0,X||H(this,C,B,1,127,-128),C<0&&(C=255+C+1),this[B]=C&255,B+1},a.prototype.writeInt16LE=function(C,B,X){return C=+C,B=B>>>0,X||H(this,C,B,2,32767,-32768),this[B]=C&255,this[B+1]=C>>>8,B+2},a.prototype.writeInt16BE=function(C,B,X){return C=+C,B=B>>>0,X||H(this,C,B,2,32767,-32768),this[B]=C>>>8,this[B+1]=C&255,B+2},a.prototype.writeInt32LE=function(C,B,X){return C=+C,B=B>>>0,X||H(this,C,B,4,2147483647,-2147483648),this[B]=C&255,this[B+1]=C>>>8,this[B+2]=C>>>16,this[B+3]=C>>>24,B+4},a.prototype.writeInt32BE=function(C,B,X){return C=+C,B=B>>>0,X||H(this,C,B,4,2147483647,-2147483648),C<0&&(C=4294967295+C+1),this[B]=C>>>24,this[B+1]=C>>>16,this[B+2]=C>>>8,this[B+3]=C&255,B+4};function U(K,C,B,X,ae,ge){if(B+X>K.length)throw new RangeError("Index out of range");if(B<0)throw new RangeError("Index out of range")}function $(K,C,B,X,ae){return C=+C,B=B>>>0,ae||U(K,C,B,4),r.write(K,C,B,X,23,4),B+4}a.prototype.writeFloatLE=function(C,B,X){return $(this,C,B,!0,X)},a.prototype.writeFloatBE=function(C,B,X){return $(this,C,B,!1,X)};function T(K,C,B,X,ae){return C=+C,B=B>>>0,ae||U(K,C,B,8),r.write(K,C,B,X,52,8),B+8}a.prototype.writeDoubleLE=function(C,B,X){return T(this,C,B,!0,X)},a.prototype.writeDoubleBE=function(C,B,X){return T(this,C,B,!1,X)},a.prototype.copy=function(C,B,X,ae){if(!a.isBuffer(C))throw new TypeError("argument should be a Buffer");if(X||(X=0),!ae&&ae!==0&&(ae=this.length),B>=C.length&&(B=C.length),B||(B=0),ae>0&&ae<X&&(ae=X),ae===X||C.length===0||this.length===0)return 0;if(B<0)throw new RangeError("targetStart out of bounds");if(X<0||X>=this.length)throw new RangeError("Index out of range");if(ae<0)throw new RangeError("sourceEnd out of bounds");ae>this.length&&(ae=this.length),C.length-B<ae-X&&(ae=C.length-B+X);var ge=ae-X;return this===C&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(B,X,ae):Uint8Array.prototype.set.call(C,this.subarray(X,ae),B),ge},a.prototype.fill=function(C,B,X,ae){if(typeof C=="string"){if(typeof B=="string"?(ae=B,B=0,X=this.length):typeof X=="string"&&(ae=X,X=this.length),ae!==void 0&&typeof ae!="string")throw new TypeError("encoding must be a string");if(typeof ae=="string"&&!a.isEncoding(ae))throw new TypeError("Unknown encoding: "+ae);if(C.length===1){var ge=C.charCodeAt(0);(ae==="utf8"&&ge<128||ae==="latin1")&&(C=ge)}}else typeof C=="number"?C=C&255:typeof C=="boolean"&&(C=Number(C));if(B<0||this.length<B||this.length<X)throw new RangeError("Out of range index");if(X<=B)return this;B=B>>>0,X=X===void 0?this.length:X>>>0,C||(C=0);var be;if(typeof C=="number")for(be=B;be<X;++be)this[be]=C;else{var Ne=a.isBuffer(C)?C:a.from(C,ae),Oe=Ne.length;if(Oe===0)throw new TypeError('The value "'+C+'" is invalid for argument "value"');for(be=0;be<X-B;++be)this[be+B]=Ne[be%Oe]}return this};var z=/[^+/0-9A-Za-z-_]/g;function ne(K){if(K=K.split("=")[0],K=K.trim().replace(z,""),K.length<2)return"";for(;K.length%4!==0;)K=K+"=";return K}function ue(K,C){C=C||1/0;for(var B,X=K.length,ae=null,ge=[],be=0;be<X;++be){if(B=K.charCodeAt(be),B>55295&&B<57344){if(!ae){if(B>56319){(C-=3)>-1&&ge.push(239,191,189);continue}else if(be+1===X){(C-=3)>-1&&ge.push(239,191,189);continue}ae=B;continue}if(B<56320){(C-=3)>-1&&ge.push(239,191,189),ae=B;continue}B=(ae-55296<<10|B-56320)+65536}else ae&&(C-=3)>-1&&ge.push(239,191,189);if(ae=null,B<128){if((C-=1)<0)break;ge.push(B)}else if(B<2048){if((C-=2)<0)break;ge.push(B>>6|192,B&63|128)}else if(B<65536){if((C-=3)<0)break;ge.push(B>>12|224,B>>6&63|128,B&63|128)}else if(B<1114112){if((C-=4)<0)break;ge.push(B>>18|240,B>>12&63|128,B>>6&63|128,B&63|128)}else throw new Error("Invalid code point")}return ge}function ye(K){for(var C=[],B=0;B<K.length;++B)C.push(K.charCodeAt(B)&255);return C}function _e(K,C){for(var B,X,ae,ge=[],be=0;be<K.length&&!((C-=2)<0);++be)B=K.charCodeAt(be),X=B>>8,ae=B%256,ge.push(ae),ge.push(X);return ge}function Se(K){return e.toByteArray(ne(K))}function We(K,C,B,X){for(var ae=0;ae<X&&!(ae+B>=C.length||ae>=K.length);++ae)C[ae+B]=K[ae];return ae}function te(K,C){return K instanceof C||K!=null&&K.constructor!=null&&K.constructor.name!=null&&K.constructor.name===C.name}function se(K){return K!==K}var ce=function(){for(var K="0123456789abcdef",C=new Array(256),B=0;B<16;++B)for(var X=B*16,ae=0;ae<16;++ae)C[X+ae]=K[B]+K[ae];return C}()})(As);let av=null;var O5=function(){return av===null&&(av={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),av},Vh={},F1={};const uv=Go,JB=new Set(["buffer","view","utf8"]);let GB=class{constructor(e){if(this.encode=e.encode||this.encode,this.decode=e.decode||this.decode,this.name=e.name||this.name,this.format=e.format||this.format,typeof this.encode!="function")throw new TypeError("The 'encode' property must be a function");if(typeof this.decode!="function")throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),typeof this.name!="string"||this.name==="")throw new TypeError("The 'name' property must be a string");if(typeof this.format!="string"||!JB.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");e.createViewTranscoder&&(this.createViewTranscoder=e.createViewTranscoder),e.createBufferTranscoder&&(this.createBufferTranscoder=e.createBufferTranscoder),e.createUTF8Transcoder&&(this.createUTF8Transcoder=e.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new uv(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new uv(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new uv(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}};F1.Encoding=GB;const{Buffer:N1}=As||{},{Encoding:R1}=F1,ZB=O5;let j1=class extends R1{constructor(e){super({...e,format:"buffer"})}createViewTranscoder(){return new M1({encode:this.encode,decode:e=>this.decode(N1.from(e.buffer,e.byteOffset,e.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}},M1=class extends R1{constructor(e){super({...e,format:"view"})}createBufferTranscoder(){return new j1({encode:e=>{const r=this.encode(e);return N1.from(r.buffer,r.byteOffset,r.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}},XB=class extends R1{constructor(e){super({...e,format:"utf8"})}createBufferTranscoder(){return new j1({encode:e=>N1.from(this.encode(e),"utf8"),decode:e=>this.decode(e.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){const{textEncoder:e,textDecoder:r}=ZB();return new M1({encode:n=>e.encode(this.encode(n)),decode:n=>this.decode(r.decode(n)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}};Vh.BufferFormat=j1;Vh.ViewFormat=M1;Vh.UTF8Format=XB;const{Buffer:Ln}=As||{Buffer:{isBuffer:()=>!1}},{textEncoder:T5,textDecoder:z2}=O5(),{BufferFormat:zh,ViewFormat:U1,UTF8Format:I5}=Vh,A0=t=>t;Ql.utf8=new I5({encode:function(t){return Ln.isBuffer(t)?t.toString("utf8"):ArrayBuffer.isView(t)?z2.decode(t):String(t)},decode:A0,name:"utf8",createViewTranscoder(){return new U1({encode:function(t){return ArrayBuffer.isView(t)?t:T5.encode(t)},decode:function(t){return z2.decode(t)},name:`${this.name}+view`})},createBufferTranscoder(){return new zh({encode:function(t){return Ln.isBuffer(t)?t:ArrayBuffer.isView(t)?Ln.from(t.buffer,t.byteOffset,t.byteLength):Ln.from(String(t),"utf8")},decode:function(t){return t.toString("utf8")},name:`${this.name}+buffer`})}});Ql.json=new I5({encode:JSON.stringify,decode:JSON.parse,name:"json"});Ql.buffer=new zh({encode:function(t){return Ln.isBuffer(t)?t:ArrayBuffer.isView(t)?Ln.from(t.buffer,t.byteOffset,t.byteLength):Ln.from(String(t),"utf8")},decode:A0,name:"buffer",createViewTranscoder(){return new U1({encode:function(t){return ArrayBuffer.isView(t)?t:Ln.from(String(t),"utf8")},decode:function(t){return Ln.from(t.buffer,t.byteOffset,t.byteLength)},name:`${this.name}+view`})}});Ql.view=new U1({encode:function(t){return ArrayBuffer.isView(t)?t:T5.encode(t)},decode:A0,name:"view",createBufferTranscoder(){return new zh({encode:function(t){return Ln.isBuffer(t)?t:ArrayBuffer.isView(t)?Ln.from(t.buffer,t.byteOffset,t.byteLength):Ln.from(String(t),"utf8")},decode:A0,name:`${this.name}+buffer`})}});Ql.hex=new zh({encode:function(t){return Ln.isBuffer(t)?t:Ln.from(String(t),"hex")},decode:function(t){return t.toString("hex")},name:"hex"});Ql.base64=new zh({encode:function(t){return Ln.isBuffer(t)?t:Ln.from(String(t),"base64")},decode:function(t){return t.toString("base64")},name:"base64"});const H2=Go,S0=Ql,{Encoding:YB}=F1,{BufferFormat:QB,ViewFormat:e6,UTF8Format:t6}=Vh,Of=Symbol("formats"),Ay=Symbol("encodings"),r6=new Set(["buffer","view","utf8"]);let n6=class{constructor(e){if(Array.isArray(e)){if(!e.every(r=>r6.has(r)))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}else throw new TypeError("The first argument 'formats' must be an array");this[Ay]=new Map,this[Of]=new Set(e);for(const r in S0)try{this.encoding(r)}catch(n){if(n.code!=="LEVEL_ENCODING_NOT_SUPPORTED")throw n}}encodings(){return Array.from(new Set(this[Ay].values()))}encoding(e){let r=this[Ay].get(e);if(r===void 0){if(typeof e=="string"&&e!==""){if(r=a6[e],!r)throw new H2(`Encoding '${e}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if(typeof e!="object"||e===null)throw new TypeError("First argument 'encoding' must be a string or object");r=i6(e)}const{name:n,format:s}=r;if(!this[Of].has(s))if(this[Of].has("view"))r=r.createViewTranscoder();else if(this[Of].has("buffer"))r=r.createBufferTranscoder();else if(this[Of].has("utf8"))r=r.createUTF8Transcoder();else throw new H2(`Encoding '${n}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});for(const i of[e,n,r.name,r.commonName])this[Ay].set(i,r)}return r}};C5.Transcoder=n6;function i6(t){if(t instanceof YB)return t;const e="type"in t&&typeof t.type=="string"?t.type:void 0,r=t.name||e||`anonymous-${u6++}`;switch(s6(t)){case"view":return new e6({...t,name:r});case"utf8":return new t6({...t,name:r});case"buffer":return new QB({...t,name:r});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}function s6(t){return"format"in t&&t.format!==void 0?t.format:"buffer"in t&&typeof t.buffer=="boolean"?t.buffer?"buffer":"utf8":"code"in t&&Number.isInteger(t.code)?"view":"buffer"}const o6={binary:S0.buffer,"utf-8":S0.utf8},a6={...S0,...o6};let u6=0;var K1={exports:{}},Md=typeof Reflect=="object"?Reflect:null,W2=Md&&typeof Md.apply=="function"?Md.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},Bm;Md&&typeof Md.ownKeys=="function"?Bm=Md.ownKeys:Object.getOwnPropertySymbols?Bm=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Bm=function(e){return Object.getOwnPropertyNames(e)};function c6(t){console&&console.warn&&console.warn(t)}var B5=Number.isNaN||function(e){return e!==e};function sr(){sr.init.call(this)}K1.exports=sr;K1.exports.once=p6;sr.EventEmitter=sr;sr.prototype._events=void 0;sr.prototype._eventsCount=0;sr.prototype._maxListeners=void 0;var J2=10;function fg(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(sr,"defaultMaxListeners",{enumerable:!0,get:function(){return J2},set:function(t){if(typeof t!="number"||t<0||B5(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");J2=t}});sr.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};sr.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||B5(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function F5(t){return t._maxListeners===void 0?sr.defaultMaxListeners:t._maxListeners}sr.prototype.getMaxListeners=function(){return F5(this)};sr.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var s=e==="error",i=this._events;if(i!==void 0)s=s&&i.error===void 0;else if(!s)return!1;if(s){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=i[e];if(c===void 0)return!1;if(typeof c=="function")W2(c,this,r);else for(var l=c.length,u=U5(c,l),n=0;n<l;++n)W2(u[n],this,r);return!0};function N5(t,e,r,n){var s,i,o;if(fg(r),i=t._events,i===void 0?(i=t._events=Object.create(null),t._eventsCount=0):(i.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),i=t._events),o=i[e]),o===void 0)o=i[e]=r,++t._eventsCount;else if(typeof o=="function"?o=i[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),s=F5(t),s>0&&o.length>s&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,c6(a)}return t}sr.prototype.addListener=function(e,r){return N5(this,e,r,!1)};sr.prototype.on=sr.prototype.addListener;sr.prototype.prependListener=function(e,r){return N5(this,e,r,!0)};function l6(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function R5(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},s=l6.bind(n);return s.listener=r,n.wrapFn=s,s}sr.prototype.once=function(e,r){return fg(r),this.on(e,R5(this,e,r)),this};sr.prototype.prependOnceListener=function(e,r){return fg(r),this.prependListener(e,R5(this,e,r)),this};sr.prototype.removeListener=function(e,r){var n,s,i,o,a;if(fg(r),s=this._events,s===void 0)return this;if(n=s[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,i=o;break}if(i<0)return this;i===0?n.shift():d6(n,i),n.length===1&&(s[e]=n[0]),s.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this};sr.prototype.off=sr.prototype.removeListener;sr.prototype.removeAllListeners=function(e){var r,n,s;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var i=Object.keys(n),o;for(s=0;s<i.length;++s)o=i[s],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(s=r.length-1;s>=0;s--)this.removeListener(e,r[s]);return this};function j5(t,e,r){var n=t._events;if(n===void 0)return[];var s=n[e];return s===void 0?[]:typeof s=="function"?r?[s.listener||s]:[s]:r?f6(s):U5(s,s.length)}sr.prototype.listeners=function(e){return j5(this,e,!0)};sr.prototype.rawListeners=function(e){return j5(this,e,!1)};sr.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):M5.call(t,e)};sr.prototype.listenerCount=M5;function M5(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}sr.prototype.eventNames=function(){return this._eventsCount>0?Bm(this._events):[]};function U5(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function d6(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function f6(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function p6(t,e){return new Promise(function(r,n){function s(o){t.removeListener(e,i),n(o)}function i(){typeof t.removeListener=="function"&&t.removeListener("error",s),r([].slice.call(arguments))}K5(t,e,i,{once:!0}),e!=="error"&&h6(t,s,{once:!0})})}function h6(t,e,r){typeof t.on=="function"&&K5(t,"error",e,r)}function K5(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function s(i){n.once&&t.removeEventListener(e,s),r(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var pg=K1.exports,pf={},y6=typeof queueMicrotask=="function"?queueMicrotask:t=>Promise.resolve().then(t),G2=y6;pf.fromCallback=function(t,e){if(t===void 0){var r=new Promise(function(n,s){t=function(i,o){i?s(i):n(o)}});t[e!==void 0?e:"promise"]=r}else if(typeof t!="function")throw new TypeError("Callback must be a function");return t};pf.fromPromise=function(t,e){if(e===void 0)return t;t.then(function(r){G2(()=>e(null,r))}).catch(function(r){G2(()=>e(r))})};var Zo={},Hh={};Hh.getCallback=function(t,e){return typeof t=="function"?t:e};Hh.getOptions=function(t,e){return typeof t=="object"&&t!==null?t:e!==void 0?e:{}};const{fromCallback:cv}=pf,Di=Go,{getOptions:lv,getCallback:Z2}=Hh,Ic=Symbol("promise"),ld=Symbol("callback"),ro=Symbol("working"),wl=Symbol("handleOne"),Ca=Symbol("handleMany"),dv=Symbol("autoClose"),hc=Symbol("finishWork"),Fo=Symbol("returnMany"),su=Symbol("closing"),Tf=Symbol("handleClose"),Sy=Symbol("closed"),If=Symbol("closeCallbacks"),sc=Symbol("keyEncoding"),Ml=Symbol("valueEncoding"),fv=Symbol("abortOnClose"),$y=Symbol("legacy"),pv=Symbol("keys"),hv=Symbol("values"),ou=Symbol("limit"),ls=Symbol("count"),xy=Object.freeze({}),m6=()=>{};let X2=!1;class L1{constructor(e,r,n){if(typeof e!="object"||e===null){const s=e===null?"null":typeof e;throw new TypeError(`The first argument must be an abstract-level database, received ${s}`)}if(typeof r!="object"||r===null)throw new TypeError("The second argument must be an options object");this[Sy]=!1,this[If]=[],this[ro]=!1,this[su]=!1,this[dv]=!1,this[ld]=null,this[wl]=this[wl].bind(this),this[Ca]=this[Ca].bind(this),this[Tf]=this[Tf].bind(this),this[sc]=r[sc],this[Ml]=r[Ml],this[$y]=n,this[ou]=Number.isInteger(r.limit)&&r.limit>=0?r.limit:1/0,this[ls]=0,this[fv]=!!r.abortOnClose,this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get count(){return this[ls]}get limit(){return this[ou]}next(e){let r;if(e===void 0)r=new Promise((n,s)=>{e=(i,o,a)=>{i?s(i):this[$y]?o===void 0&&a===void 0?n():n([o,a]):n(o)}});else if(typeof e!="function")throw new TypeError("Callback must be a function");return this[su]?this.nextTick(e,new Di("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[ro]?this.nextTick(e,new Di("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[ro]=!0,this[ld]=e,this[ls]>=this[ou]?this.nextTick(this[wl],null):this._next(this[wl])),r}_next(e){this.nextTick(e)}nextv(e,r,n){return n=Z2(r,n),n=cv(n,Ic),r=lv(r,xy),Number.isInteger(e)?(this[su]?this.nextTick(n,new Di("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[ro]?this.nextTick(n,new Di("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(e<1&&(e=1),this[ou]<1/0&&(e=Math.min(e,this[ou]-this[ls])),this[ro]=!0,this[ld]=n,e<=0?this.nextTick(this[Ca],null,[]):this._nextv(e,r,this[Ca])),n[Ic]):(this.nextTick(n,new TypeError("The first argument 'size' must be an integer")),n[Ic])}_nextv(e,r,n){const s=[],i=(o,a,c)=>{if(o)return n(o);if(this[$y]?a===void 0&&c===void 0:a===void 0)return n(null,s);s.push(this[$y]?[a,c]:a),s.length===e?n(null,s):this._next(i)};this._next(i)}all(e,r){return r=Z2(e,r),r=cv(r,Ic),e=lv(e,xy),this[su]?this.nextTick(r,new Di("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[ro]?this.nextTick(r,new Di("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[ro]=!0,this[ld]=r,this[dv]=!0,this[ls]>=this[ou]?this.nextTick(this[Ca],null,[]):this._all(e,this[Ca])),r[Ic]}_all(e,r){let n=this[ls];const s=[],i=()=>{const a=this[ou]<1/0?Math.min(1e3,this[ou]-n):1e3;a<=0?this.nextTick(r,null,s):this._nextv(a,xy,o)},o=(a,c)=>{a?r(a):c.length===0?r(null,s):(s.push.apply(s,c),n+=c.length,i())};i()}[hc](){const e=this[ld];return this[fv]&&e===null?m6:(this[ro]=!1,this[ld]=null,this[su]&&this._close(this[Tf]),e)}[Fo](e,r,n){this[dv]?this.close(e.bind(null,r,n)):e(r,n)}seek(e,r){if(r=lv(r,xy),!this[su]){if(this[ro])throw new Di("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{const n=this.db.keyEncoding(r.keyEncoding||this[sc]),s=n.format;r.keyEncoding!==s&&(r={...r,keyEncoding:s});const i=this.db.prefixKey(n.encode(e),s);this._seek(i,r)}}}_seek(e,r){throw new Di("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(e){return e=cv(e,Ic),this[Sy]?this.nextTick(e):this[su]?this[If].push(e):(this[su]=!0,this[If].push(e),this[ro]?this[fv]&&this[hc]()(new Di("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this._close(this[Tf])),e[Ic]}_close(e){this.nextTick(e)}[Tf](){this[Sy]=!0,this.db.detachResource(this);const e=this[If];this[If]=[];for(const r of e)r()}async*[Symbol.asyncIterator](){try{let e;for(;(e=await this.next())!==void 0;)yield e}finally{this[Sy]||await this.close()}}}let hg=class extends L1{constructor(e,r){super(e,r,!0),this[pv]=r.keys!==!1,this[hv]=r.values!==!1}[wl](e,r,n){const s=this[hc]();if(e)return s(e);try{r=this[pv]&&r!==void 0?this[sc].decode(r):void 0,n=this[hv]&&n!==void 0?this[Ml].decode(n):void 0}catch(i){return s(new Jd("entry",i))}r===void 0&&n===void 0||this[ls]++,s(null,r,n)}[Ca](e,r){const n=this[hc]();if(e)return this[Fo](n,e);try{for(const s of r){const i=s[0],o=s[1];s[0]=this[pv]&&i!==void 0?this[sc].decode(i):void 0,s[1]=this[hv]&&o!==void 0?this[Ml].decode(o):void 0}}catch(s){return this[Fo](n,new Jd("entries",s))}this[ls]+=r.length,this[Fo](n,null,r)}end(e){return!X2&&typeof console<"u"&&(X2=!0,console.warn(new Di("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(e)}},g6=class extends L1{constructor(e,r){super(e,r,!1)}[wl](e,r){const n=this[hc]();if(e)return n(e);try{r=r!==void 0?this[sc].decode(r):void 0}catch(s){return n(new Jd("key",s))}r!==void 0&&this[ls]++,n(null,r)}[Ca](e,r){const n=this[hc]();if(e)return this[Fo](n,e);try{for(let s=0;s<r.length;s++){const i=r[s];r[s]=i!==void 0?this[sc].decode(i):void 0}}catch(s){return this[Fo](n,new Jd("keys",s))}this[ls]+=r.length,this[Fo](n,null,r)}},v6=class extends L1{constructor(e,r){super(e,r,!1)}[wl](e,r){const n=this[hc]();if(e)return n(e);try{r=r!==void 0?this[Ml].decode(r):void 0}catch(s){return n(new Jd("value",s))}r!==void 0&&this[ls]++,n(null,r)}[Ca](e,r){const n=this[hc]();if(e)return this[Fo](n,e);try{for(let s=0;s<r.length;s++){const i=r[s];r[s]=i!==void 0?this[Ml].decode(i):void 0}}catch(s){return this[Fo](n,new Jd("values",s))}this[ls]+=r.length,this[Fo](n,null,r)}};class Jd extends Di{constructor(e,r){super(`Iterator could not decode ${e}`,{code:"LEVEL_DECODE_ERROR",cause:r})}}for(const t of["_ended property","_nexting property","_end method"])Object.defineProperty(hg.prototype,t.split(" ")[0],{get(){throw new Di(`The ${t} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new Di(`The ${t} has been removed`,{code:"LEVEL_LEGACY"})}});hg.keyEncoding=sc;hg.valueEncoding=Ml;Zo.AbstractIterator=hg;Zo.AbstractKeyIterator=g6;Zo.AbstractValueIterator=v6;var q1={};const{AbstractKeyIterator:w6,AbstractValueIterator:b6}=Zo,dl=Symbol("iterator"),Bf=Symbol("callback"),Gd=Symbol("handleOne"),xl=Symbol("handleMany");let Qw=class extends w6{constructor(e,r){super(e,r),this[dl]=e.iterator({...r,keys:!0,values:!1}),this[Gd]=this[Gd].bind(this),this[xl]=this[xl].bind(this)}},L5=class extends b6{constructor(e,r){super(e,r),this[dl]=e.iterator({...r,keys:!1,values:!0}),this[Gd]=this[Gd].bind(this),this[xl]=this[xl].bind(this)}};for(const t of[Qw,L5]){const e=t===Qw,r=e?n=>n[0]:n=>n[1];t.prototype._next=function(n){this[Bf]=n,this[dl].next(this[Gd])},t.prototype[Gd]=function(n,s,i){const o=this[Bf];n?o(n):o(null,e?s:i)},t.prototype._nextv=function(n,s,i){this[Bf]=i,this[dl].nextv(n,s,this[xl])},t.prototype._all=function(n,s){this[Bf]=s,this[dl].all(n,this[xl])},t.prototype[xl]=function(n,s){const i=this[Bf];n?i(n):i(null,s.map(r))},t.prototype._seek=function(n,s){this[dl].seek(n,s)},t.prototype._close=function(n){this[dl].close(n)}}q1.DefaultKeyIterator=Qw;q1.DefaultValueIterator=L5;var yg={};const{AbstractIterator:_6,AbstractKeyIterator:E6,AbstractValueIterator:A6}=Zo,yv=Go,di=Symbol("nut"),mg=Symbol("undefer"),gg=Symbol("factory");let q5=class extends _6{constructor(e,r){super(e,r),this[di]=null,this[gg]=()=>e.iterator(r),this.db.defer(()=>this[mg]())}},V5=class extends E6{constructor(e,r){super(e,r),this[di]=null,this[gg]=()=>e.keys(r),this.db.defer(()=>this[mg]())}},z5=class extends A6{constructor(e,r){super(e,r),this[di]=null,this[gg]=()=>e.values(r),this.db.defer(()=>this[mg]())}};for(const t of[q5,V5,z5])t.prototype[mg]=function(){this.db.status==="open"&&(this[di]=this[gg]())},t.prototype._next=function(e){this[di]!==null?this[di].next(e):this.db.status==="opening"?this.db.defer(()=>this._next(e)):this.nextTick(e,new yv("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},t.prototype._nextv=function(e,r,n){this[di]!==null?this[di].nextv(e,r,n):this.db.status==="opening"?this.db.defer(()=>this._nextv(e,r,n)):this.nextTick(n,new yv("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},t.prototype._all=function(e,r){this[di]!==null?this[di].all(r):this.db.status==="opening"?this.db.defer(()=>this._all(e,r)):this.nextTick(r,new yv("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},t.prototype._seek=function(e,r){this[di]!==null?this[di]._seek(e,r):this.db.status==="opening"&&this.db.defer(()=>this._seek(e,r))},t.prototype._close=function(e){this[di]!==null?this[di].close(e):this.db.status==="opening"?this.db.defer(()=>this._close(e)):this.nextTick(e)};yg.DeferredIterator=q5;yg.DeferredKeyIterator=V5;yg.DeferredValueIterator=z5;var H5={},V1={};const{fromCallback:Y2}=pf,Dy=Go,{getCallback:S6,getOptions:$6}=Hh,Py=Symbol("promise"),zi=Symbol("status"),dd=Symbol("operations"),Ff=Symbol("finishClose"),fd=Symbol("closeCallbacks");let x6=class{constructor(e){if(typeof e!="object"||e===null){const r=e===null?"null":typeof e;throw new TypeError(`The first argument must be an abstract-level database, received ${r}`)}this[dd]=[],this[fd]=[],this[zi]="open",this[Ff]=this[Ff].bind(this),this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get length(){return this[dd].length}put(e,r,n){if(this[zi]!=="open")throw new Dy("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const s=this.db._checkKey(e)||this.db._checkValue(r);if(s)throw s;const i=n&&n.sublevel!=null?n.sublevel:this.db,o=n,a=i.keyEncoding(n&&n.keyEncoding),c=i.valueEncoding(n&&n.valueEncoding),l=a.format;n={...n,keyEncoding:l,valueEncoding:c.format},i!==this.db&&(n.sublevel=null);const u=i.prefixKey(a.encode(e),l),d=c.encode(r);return this._put(u,d,n),this[dd].push({...o,type:"put",key:e,value:r}),this}_put(e,r,n){}del(e,r){if(this[zi]!=="open")throw new Dy("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const n=this.db._checkKey(e);if(n)throw n;const s=r&&r.sublevel!=null?r.sublevel:this.db,i=r,o=s.keyEncoding(r&&r.keyEncoding),a=o.format;return r={...r,keyEncoding:a},s!==this.db&&(r.sublevel=null),this._del(s.prefixKey(o.encode(e),a),r),this[dd].push({...i,type:"del",key:e}),this}_del(e,r){}clear(){if(this[zi]!=="open")throw new Dy("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[dd]=[],this}_clear(){}write(e,r){return r=S6(e,r),r=Y2(r,Py),e=$6(e),this[zi]!=="open"?this.nextTick(r,new Dy("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):this.length===0?this.close(r):(this[zi]="writing",this._write(e,n=>{this[zi]="closing",this[fd].push(()=>r(n)),n||this.db.emit("batch",this[dd]),this._close(this[Ff])})),r[Py]}_write(e,r){}close(e){return e=Y2(e,Py),this[zi]==="closing"?this[fd].push(e):this[zi]==="closed"?this.nextTick(e):(this[fd].push(e),this[zi]!=="writing"&&(this[zi]="closing",this._close(this[Ff]))),e[Py]}_close(e){this.nextTick(e)}[Ff](){this[zi]="closed",this.db.detachResource(this);const e=this[fd];this[fd]=[];for(const r of e)r()}};V1.AbstractChainedBatch=x6;const{AbstractChainedBatch:D6}=V1,P6=Go,pd=Symbol("encoded");let C6=class extends D6{constructor(e){super(e),this[pd]=[]}_put(e,r,n){this[pd].push({...n,type:"put",key:e,value:r})}_del(e,r){this[pd].push({...r,type:"del",key:e})}_clear(){this[pd]=[]}_write(e,r){this.db.status==="opening"?this.db.defer(()=>this._write(e,r)):this.db.status==="open"?this[pd].length===0?this.nextTick(r):this.db._batch(this[pd],e,r):this.nextTick(r,new P6("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}};H5.DefaultChainedBatch=C6;const Q2=Go,k6=Object.prototype.hasOwnProperty,O6=new Set(["lt","lte","gt","gte"]);var T6=function(t,e){const r={};for(const n in t)if(k6.call(t,n)&&!(n==="keyEncoding"||n==="valueEncoding")){if(n==="start"||n==="end")throw new Q2(`The legacy range option '${n}' has been removed`,{code:"LEVEL_LEGACY"});if(n==="encoding")throw new Q2("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});O6.has(n)?r[n]=e.encode(t[n]):r[n]=t[n]}return r.reverse=!!r.reverse,r.limit=Number.isInteger(r.limit)&&r.limit>=0?r.limit:-1,r};/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let eA;var W5=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:Zt):t=>(eA||(eA=Promise.resolve())).then(t).catch(e=>setTimeout(()=>{throw e},0)),mv,tA;function I6(){if(tA)return mv;tA=1;const t=W5;return mv=function(e,...r){r.length===0?t(e):t(()=>e(...r))},mv}var Nf={},rA;function B6(){if(rA)return Nf;rA=1;const{AbstractIterator:t,AbstractKeyIterator:e,AbstractValueIterator:r}=Zo,n=Symbol("unfix"),s=Symbol("iterator"),i=Symbol("handleOne"),o=Symbol("handleMany"),a=Symbol("callback");class c extends t{constructor(h,f,p,y){super(h,f),this[s]=p,this[n]=y,this[i]=this[i].bind(this),this[o]=this[o].bind(this),this[a]=null}[i](h,f,p){const y=this[a];if(h)return y(h);f!==void 0&&(f=this[n](f)),y(h,f,p)}[o](h,f){const p=this[a];if(h)return p(h);for(const y of f){const b=y[0];b!==void 0&&(y[0]=this[n](b))}p(h,f)}}class l extends e{constructor(h,f,p,y){super(h,f),this[s]=p,this[n]=y,this[i]=this[i].bind(this),this[o]=this[o].bind(this),this[a]=null}[i](h,f){const p=this[a];if(h)return p(h);f!==void 0&&(f=this[n](f)),p(h,f)}[o](h,f){const p=this[a];if(h)return p(h);for(let y=0;y<f.length;y++){const b=f[y];b!==void 0&&(f[y]=this[n](b))}p(h,f)}}class u extends r{constructor(h,f,p){super(h,f),this[s]=p}}for(const d of[c,l])d.prototype._next=function(h){this[a]=h,this[s].next(this[i])},d.prototype._nextv=function(h,f,p){this[a]=p,this[s].nextv(h,f,this[o])},d.prototype._all=function(h,f){this[a]=f,this[s].all(h,this[o])};for(const d of[u])d.prototype._next=function(h){this[s].next(h)},d.prototype._nextv=function(h,f,p){this[s].nextv(h,f,p)},d.prototype._all=function(h,f){this[s].all(h,f)};for(const d of[c,l,u])d.prototype._seek=function(h,f){this[s].seek(h,f)},d.prototype._close=function(h){this[s].close(h)};return Nf.AbstractSublevelIterator=c,Nf.AbstractSublevelKeyIterator=l,Nf.AbstractSublevelValueIterator=u,Nf}var gv,nA;function F6(){if(nA)return gv;nA=1;const t=Go,{Buffer:e}=As||{},{AbstractSublevelIterator:r,AbstractSublevelKeyIterator:n,AbstractSublevelValueIterator:s}=B6(),i=Symbol("prefix"),o=Symbol("upperBound"),a=Symbol("prefixRange"),c=Symbol("parent"),l=Symbol("unfix"),u=new TextEncoder,d={separator:"!"};gv=function({AbstractLevel:w}){class g extends w{static defaults(m){if(typeof m=="string")throw new t("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(m&&m.open)throw new t("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return m==null?d:m.separator?m:{...m,separator:"!"}}constructor(m,_,x){const{separator:D,manifest:E,...A}=g.defaults(x);_=b(_,D);const S=D.charCodeAt(0)+1,O=m[c]||m;if(!u.encode(_).every(j=>j>S&&j<127))throw new t(`Prefix must use bytes > ${S} < 127`,{code:"LEVEL_INVALID_PREFIX"});super(h(O,E),A);const I=(m.prefix||"")+D+_+D,N=I.slice(0,-1)+String.fromCharCode(S);this[c]=O,this[i]=new p(I),this[o]=new p(N),this[l]=new y,this.nextTick=O.nextTick}prefixKey(m,_){if(_==="utf8")return this[i].utf8+m;if(m.byteLength===0)return this[i][_];if(_==="view"){const x=this[i].view,D=new Uint8Array(x.byteLength+m.byteLength);return D.set(x,0),D.set(m,x.byteLength),D}else{const x=this[i].buffer;return e.concat([x,m],x.byteLength+m.byteLength)}}[a](m,_){m.gte!==void 0?m.gte=this.prefixKey(m.gte,_):m.gt!==void 0?m.gt=this.prefixKey(m.gt,_):m.gte=this[i][_],m.lte!==void 0?m.lte=this.prefixKey(m.lte,_):m.lt!==void 0?m.lt=this.prefixKey(m.lt,_):m.lte=this[o][_]}get prefix(){return this[i].utf8}get db(){return this[c]}_open(m,_){this[c].open({passive:!0},_)}_put(m,_,x,D){this[c].put(m,_,x,D)}_get(m,_,x){this[c].get(m,_,x)}_getMany(m,_,x){this[c].getMany(m,_,x)}_del(m,_,x){this[c].del(m,_,x)}_batch(m,_,x){this[c].batch(m,_,x)}_clear(m,_){this[a](m,m.keyEncoding),this[c].clear(m,_)}_iterator(m){this[a](m,m.keyEncoding);const _=this[c].iterator(m),x=this[l].get(this[i].utf8.length,m.keyEncoding);return new r(this,m,_,x)}_keys(m){this[a](m,m.keyEncoding);const _=this[c].keys(m),x=this[l].get(this[i].utf8.length,m.keyEncoding);return new n(this,m,_,x)}_values(m){this[a](m,m.keyEncoding);const _=this[c].values(m);return new s(this,m,_)}}return{AbstractSublevel:g}};const h=function(w,g){return{...w.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...g,encodings:{utf8:f(w,"utf8"),buffer:f(w,"buffer"),view:f(w,"view")}}},f=function(w,g){return w.supports.encodings[g]?w.keyEncoding(g).name===g:!1};class p{constructor(g){this.utf8=g,this.view=u.encode(g),this.buffer=e?e.from(this.view.buffer,0,this.view.byteLength):{}}}class y{constructor(){this.cache=new Map}get(g,v){let m=this.cache.get(v);return m===void 0&&(v==="view"?m=(function(_,x){return x.subarray(_)}).bind(null,g):m=(function(_,x){return x.slice(_)}).bind(null,g),this.cache.set(v,m)),m}}const b=function(w,g){let v=0,m=w.length;for(;v<m&&w[v]===g;)v++;for(;m>v&&w[m-1]===g;)m--;return w.slice(v,m)};return gv}const{supports:N6}=P5,{Transcoder:R6}=C5,{EventEmitter:j6}=pg,{fromCallback:au}=pf,Os=Go,{AbstractIterator:Bc}=Zo,{DefaultKeyIterator:M6,DefaultValueIterator:U6}=q1,{DeferredIterator:K6,DeferredKeyIterator:L6,DeferredValueIterator:q6}=yg,{DefaultChainedBatch:iA}=H5,{getCallback:Fc,getOptions:uu}=Hh,Cy=T6,_t=Symbol("promise"),na=Symbol("landed"),Nc=Symbol("resources"),vv=Symbol("closeResources"),Rf=Symbol("operations"),jf=Symbol("undefer"),ky=Symbol("deferOpen"),sA=Symbol("options"),It=Symbol("status"),Rc=Symbol("defaultOptions"),hd=Symbol("transcoder"),Oy=Symbol("keyEncoding"),wv=Symbol("valueEncoding"),V6=()=>{};let z1=class extends j6{constructor(e,r){if(super(),typeof e!="object"||e===null)throw new TypeError("The first argument 'manifest' must be an object");r=uu(r);const{keyEncoding:n,valueEncoding:s,passive:i,...o}=r;this[Nc]=new Set,this[Rf]=[],this[ky]=!0,this[sA]=o,this[It]="opening",this.supports=N6(e,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:e.snapshots!==!1,permanence:e.permanence!==!1,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:e.encodings||{},events:Object.assign({},e.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[hd]=new R6(z6(this)),this[Oy]=this[hd].encoding(n||"utf8"),this[wv]=this[hd].encoding(s||"utf8");for(const a of this[hd].encodings())this.supports.encodings[a.commonName]||(this.supports.encodings[a.commonName]=!0);this[Rc]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[Oy].commonName,valueEncoding:this[wv].commonName}),key:Object.freeze({keyEncoding:this[Oy].commonName})},this.nextTick(()=>{this[ky]&&this.open({passive:!1},V6)})}get status(){return this[It]}keyEncoding(e){return this[hd].encoding(e??this[Oy])}valueEncoding(e){return this[hd].encoding(e??this[wv])}open(e,r){r=Fc(e,r),r=au(r,_t),e={...this[sA],...uu(e)},e.createIfMissing=e.createIfMissing!==!1,e.errorIfExists=!!e.errorIfExists;const n=s=>{this[It]==="closing"||this[It]==="opening"?this.once(na,s?()=>n(s):n):this[It]!=="open"?r(new Os("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:s})):r()};return e.passive?this[It]==="opening"?this.once(na,n):this.nextTick(n):this[It]==="closed"||this[ky]?(this[ky]=!1,this[It]="opening",this.emit("opening"),this._open(e,s=>{if(s){this[It]="closed",this[vv](()=>{this.emit(na),n(s)}),this[jf]();return}this[It]="open",this[jf](),this.emit(na),this[It]==="open"&&this.emit("open"),this[It]==="open"&&this.emit("ready"),n()})):this[It]==="open"?this.nextTick(n):this.once(na,()=>this.open(e,r)),r[_t]}_open(e,r){this.nextTick(r)}close(e){e=au(e,_t);const r=n=>{this[It]==="opening"||this[It]==="closing"?this.once(na,n?r(n):r):this[It]!=="closed"?e(new Os("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:n})):e()};if(this[It]==="open"){this[It]="closing",this.emit("closing");const n=s=>{this[It]="open",this[jf](),this.emit(na),r(s)};this[vv](()=>{this._close(s=>{if(s)return n(s);this[It]="closed",this[jf](),this.emit(na),this[It]==="closed"&&this.emit("closed"),r()})})}else this[It]==="closed"?this.nextTick(r):this.once(na,()=>this.close(e));return e[_t]}[vv](e){if(this[Nc].size===0)return this.nextTick(e);let r=this[Nc].size,n=!0;const s=()=>{--r===0&&(n?this.nextTick(e):e())};for(const i of this[Nc])i.close(s);n=!1,this[Nc].clear()}_close(e){this.nextTick(e)}get(e,r,n){if(n=Fc(r,n),n=au(n,_t),r=uu(r,this[Rc].entry),this[It]==="opening")return this.defer(()=>this.get(e,r,n)),n[_t];if(yd(this,n))return n[_t];const s=this._checkKey(e);if(s)return this.nextTick(n,s),n[_t];const i=this.keyEncoding(r.keyEncoding),o=this.valueEncoding(r.valueEncoding),a=i.format,c=o.format;return(r.keyEncoding!==a||r.valueEncoding!==c)&&(r=Object.assign({},r,{keyEncoding:a,valueEncoding:c})),this._get(this.prefixKey(i.encode(e),a),r,(l,u)=>{if(l)return(l.code==="LEVEL_NOT_FOUND"||l.notFound||/NotFound/i.test(l))&&(l.code||(l.code="LEVEL_NOT_FOUND"),l.notFound||(l.notFound=!0),l.status||(l.status=404)),n(l);try{u=o.decode(u)}catch(d){return n(new Os("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:d}))}n(null,u)}),n[_t]}_get(e,r,n){this.nextTick(n,new Error("NotFound"))}getMany(e,r,n){if(n=Fc(r,n),n=au(n,_t),r=uu(r,this[Rc].entry),this[It]==="opening")return this.defer(()=>this.getMany(e,r,n)),n[_t];if(yd(this,n))return n[_t];if(!Array.isArray(e))return this.nextTick(n,new TypeError("The first argument 'keys' must be an array")),n[_t];if(e.length===0)return this.nextTick(n,null,[]),n[_t];const s=this.keyEncoding(r.keyEncoding),i=this.valueEncoding(r.valueEncoding),o=s.format,a=i.format;(r.keyEncoding!==o||r.valueEncoding!==a)&&(r=Object.assign({},r,{keyEncoding:o,valueEncoding:a}));const c=new Array(e.length);for(let l=0;l<e.length;l++){const u=e[l],d=this._checkKey(u);if(d)return this.nextTick(n,d),n[_t];c[l]=this.prefixKey(s.encode(u),o)}return this._getMany(c,r,(l,u)=>{if(l)return n(l);try{for(let d=0;d<u.length;d++)u[d]!==void 0&&(u[d]=i.decode(u[d]))}catch(d){return n(new Os(`Could not decode one or more of ${u.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:d}))}n(null,u)}),n[_t]}_getMany(e,r,n){this.nextTick(n,null,new Array(e.length).fill(void 0))}put(e,r,n,s){if(s=Fc(n,s),s=au(s,_t),n=uu(n,this[Rc].entry),this[It]==="opening")return this.defer(()=>this.put(e,r,n,s)),s[_t];if(yd(this,s))return s[_t];const i=this._checkKey(e)||this._checkValue(r);if(i)return this.nextTick(s,i),s[_t];const o=this.keyEncoding(n.keyEncoding),a=this.valueEncoding(n.valueEncoding),c=o.format,l=a.format;(n.keyEncoding!==c||n.valueEncoding!==l)&&(n=Object.assign({},n,{keyEncoding:c,valueEncoding:l}));const u=this.prefixKey(o.encode(e),c),d=a.encode(r);return this._put(u,d,n,h=>{if(h)return s(h);this.emit("put",e,r),s()}),s[_t]}_put(e,r,n,s){this.nextTick(s)}del(e,r,n){if(n=Fc(r,n),n=au(n,_t),r=uu(r,this[Rc].key),this[It]==="opening")return this.defer(()=>this.del(e,r,n)),n[_t];if(yd(this,n))return n[_t];const s=this._checkKey(e);if(s)return this.nextTick(n,s),n[_t];const i=this.keyEncoding(r.keyEncoding),o=i.format;return r.keyEncoding!==o&&(r=Object.assign({},r,{keyEncoding:o})),this._del(this.prefixKey(i.encode(e),o),r,a=>{if(a)return n(a);this.emit("del",e),n()}),n[_t]}_del(e,r,n){this.nextTick(n)}batch(e,r,n){if(!arguments.length){if(this[It]==="opening")return new iA(this);if(this[It]!=="open")throw new Os("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(typeof e=="function"?n=e:n=Fc(r,n),n=au(n,_t),r=uu(r,this[Rc].empty),this[It]==="opening")return this.defer(()=>this.batch(e,r,n)),n[_t];if(yd(this,n))return n[_t];if(!Array.isArray(e))return this.nextTick(n,new TypeError("The first argument 'operations' must be an array")),n[_t];if(e.length===0)return this.nextTick(n),n[_t];const s=new Array(e.length),{keyEncoding:i,valueEncoding:o,...a}=r;for(let c=0;c<e.length;c++){if(typeof e[c]!="object"||e[c]===null)return this.nextTick(n,new TypeError("A batch operation must be an object")),n[_t];const l=Object.assign({},e[c]);if(l.type!=="put"&&l.type!=="del")return this.nextTick(n,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),n[_t];const u=this._checkKey(l.key);if(u)return this.nextTick(n,u),n[_t];const d=l.sublevel!=null?l.sublevel:this,h=d.keyEncoding(l.keyEncoding||i),f=h.format;if(l.key=d.prefixKey(h.encode(l.key),f),l.keyEncoding=f,l.type==="put"){const p=this._checkValue(l.value);if(p)return this.nextTick(n,p),n[_t];const y=d.valueEncoding(l.valueEncoding||o);l.value=y.encode(l.value),l.valueEncoding=y.format}d!==this&&(l.sublevel=null),s[c]=l}return this._batch(s,a,c=>{if(c)return n(c);this.emit("batch",e),n()}),n[_t]}_batch(e,r,n){this.nextTick(n)}sublevel(e,r){return this._sublevel(e,eb.defaults(r))}_sublevel(e,r){return new eb(this,e,r)}prefixKey(e,r){return e}clear(e,r){if(r=Fc(e,r),r=au(r,_t),e=uu(e,this[Rc].empty),this[It]==="opening")return this.defer(()=>this.clear(e,r)),r[_t];if(yd(this,r))return r[_t];const n=e,s=this.keyEncoding(e.keyEncoding);return e=Cy(e,s),e.keyEncoding=s.format,e.limit===0?this.nextTick(r):this._clear(e,i=>{if(i)return r(i);this.emit("clear",n),r()}),r[_t]}_clear(e,r){this.nextTick(r)}iterator(e){const r=this.keyEncoding(e&&e.keyEncoding),n=this.valueEncoding(e&&e.valueEncoding);if(e=Cy(e,r),e.keys=e.keys!==!1,e.values=e.values!==!1,e[Bc.keyEncoding]=r,e[Bc.valueEncoding]=n,e.keyEncoding=r.format,e.valueEncoding=n.format,this[It]==="opening")return new K6(this,e);if(this[It]!=="open")throw new Os("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(e)}_iterator(e){return new Bc(this,e)}keys(e){const r=this.keyEncoding(e&&e.keyEncoding),n=this.valueEncoding(e&&e.valueEncoding);if(e=Cy(e,r),e[Bc.keyEncoding]=r,e[Bc.valueEncoding]=n,e.keyEncoding=r.format,e.valueEncoding=n.format,this[It]==="opening")return new L6(this,e);if(this[It]!=="open")throw new Os("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(e)}_keys(e){return new M6(this,e)}values(e){const r=this.keyEncoding(e&&e.keyEncoding),n=this.valueEncoding(e&&e.valueEncoding);if(e=Cy(e,r),e[Bc.keyEncoding]=r,e[Bc.valueEncoding]=n,e.keyEncoding=r.format,e.valueEncoding=n.format,this[It]==="opening")return new q6(this,e);if(this[It]!=="open")throw new Os("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(e)}_values(e){return new U6(this,e)}defer(e){if(typeof e!="function")throw new TypeError("The first argument must be a function");this[Rf].push(e)}[jf](){if(this[Rf].length===0)return;const e=this[Rf];this[Rf]=[];for(const r of e)r()}attachResource(e){if(typeof e!="object"||e===null||typeof e.close!="function")throw new TypeError("The first argument must be a resource object");this[Nc].add(e)}detachResource(e){this[Nc].delete(e)}_chainedBatch(){return new iA(this)}_checkKey(e){if(e==null)return new Os("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(e){if(e==null)return new Os("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}};z1.prototype.nextTick=I6();const{AbstractSublevel:eb}=F6()({AbstractLevel:z1});lg.AbstractLevel=z1;lg.AbstractSublevel=eb;const yd=function(t,e){return t[It]!=="open"?(t.nextTick(e,new Os("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0):!1},z6=function(t){return Object.keys(t.supports.encodings).filter(e=>!!t.supports.encodings[e])};bc.AbstractLevel=lg.AbstractLevel;bc.AbstractSublevel=lg.AbstractSublevel;bc.AbstractIterator=Zo.AbstractIterator;bc.AbstractKeyIterator=Zo.AbstractKeyIterator;bc.AbstractValueIterator=Zo.AbstractValueIterator;bc.AbstractChainedBatch=V1.AbstractChainedBatch;/*! run-parallel-limit. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var H6=J6;const W6=W5;function J6(t,e,r){if(typeof e!="number")throw new Error("second argument must be a Number");let n,s,i,o,a,c=!0,l;Array.isArray(t)?(n=[],i=s=t.length):(o=Object.keys(t),n={},i=s=o.length);function u(h){function f(){r&&r(h,n),r=null}c?W6(f):f()}function d(h,f,p){if(n[h]=p,f&&(a=!0),--i===0||f)u(f);else if(!a&&l<s){let y;o?(y=o[l],l+=1,t[y](function(b,w){d(y,b,w)})):(y=l,l+=1,t[y](function(b,w){d(y,b,w)}))}}l=e,i?o?o.some(function(h,f){return t[h](function(p,y){d(h,p,y)}),f===e-1}):t.some(function(h,f){return h(function(p,y){d(f,p,y)}),f===e-1}):u(null),c=!1}var J5={},G5=function(e){const r=e.gte!==void 0?e.gte:e.gt!==void 0?e.gt:void 0,n=e.lte!==void 0?e.lte:e.lt!==void 0?e.lt:void 0,s=e.gte===void 0,i=e.lte===void 0;return r!==void 0&&n!==void 0?IDBKeyRange.bound(r,n,s,i):r!==void 0?IDBKeyRange.lowerBound(r,s):n!==void 0?IDBKeyRange.upperBound(n,i):null};const G6=new TextEncoder;var Z5=function(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):G6.encode(t)};const{AbstractIterator:Z6}=bc,oA=G5,Ty=Z5,no=Symbol("cache"),ia=Symbol("finished"),Ei=Symbol("options"),sa=Symbol("currentOptions"),jc=Symbol("position"),bv=Symbol("location"),md=Symbol("first"),aA={};let X6=class extends Z6{constructor(e,r,n){super(e,n),this[no]=[],this[ia]=this.limit===0,this[Ei]=n,this[sa]={...n},this[jc]=void 0,this[bv]=r,this[md]=!0}_nextv(e,r,n){if(this[md]=!1,this[ia])return this.nextTick(n,null,[]);if(this[no].length>0)return e=Math.min(e,this[no].length),this.nextTick(n,null,this[no].splice(0,e));this[jc]!==void 0&&(this[Ei].reverse?(this[sa].lt=this[jc],this[sa].lte=void 0):(this[sa].gt=this[jc],this[sa].gte=void 0));let s;try{s=oA(this[sa])}catch{return this[ia]=!0,this.nextTick(n,null,[])}const i=this.db.db.transaction([this[bv]],"readonly"),o=i.objectStore(this[bv]),a=[];if(this[Ei].reverse){const c=!this[Ei].values&&o.openKeyCursor?"openKeyCursor":"openCursor";o[c](s,"prev").onsuccess=l=>{const u=l.target.result;if(u){const{key:d,value:h}=u;this[jc]=d,a.push([this[Ei].keys&&d!==void 0?Ty(d):void 0,this[Ei].values&&h!==void 0?Ty(h):void 0]),a.length<e?u.continue():uA(i)}else this[ia]=!0}}else{let c,l;const u=()=>{if(c===void 0||l===void 0)return;const d=Math.max(c.length,l.length);d===0||e===1/0?this[ia]=!0:this[jc]=c[d-1],a.length=d;for(let h=0;h<d;h++){const f=c[h],p=l[h];a[h]=[this[Ei].keys&&f!==void 0?Ty(f):void 0,this[Ei].values&&p!==void 0?Ty(p):void 0]}uA(i)};this[Ei].keys||e<1/0?o.getAllKeys(s,e<1/0?e:void 0).onsuccess=d=>{c=d.target.result,u()}:(c=[],this.nextTick(u)),this[Ei].values?o.getAll(s,e<1/0?e:void 0).onsuccess=d=>{l=d.target.result,u()}:(l=[],this.nextTick(u))}i.onabort=()=>{n(i.error||new Error("aborted by user")),n=null},i.oncomplete=()=>{n(null,a),n=null}}_next(e){if(this[no].length>0){const[r,n]=this[no].shift();this.nextTick(e,null,r,n)}else if(this[ia])this.nextTick(e);else{let r=Math.min(100,this.limit-this.count);this[md]&&(this[md]=!1,r=1),this._nextv(r,aA,(n,s)=>{if(n)return e(n);this[no]=s,this._next(e)})}}_all(e,r){this[md]=!1;const n=this[no].splice(0,this[no].length),s=this.limit-this.count-n.length;if(s<=0)return this.nextTick(r,null,n);this._nextv(s,aA,(i,o)=>{if(i)return r(i);n.length>0&&(o=n.concat(o)),r(null,o)})}_seek(e,r){this[md]=!0,this[no]=[],this[ia]=!1,this[jc]=void 0,this[sa]={...this[Ei]};let n;try{n=oA(this[Ei])}catch{this[ia]=!0;return}n!==null&&!n.includes(e)?this[ia]=!0:this[Ei].reverse?this[sa].lte=e:this[sa].gte=e}};J5.Iterator=X6;function uA(t){typeof t.commit=="function"&&t.commit()}var Y6=function(e,r,n,s,i){if(s.limit===0)return e.nextTick(i);const o=e.db.transaction([r],"readwrite"),a=o.objectStore(r);let c=0;o.oncomplete=function(){i()},o.onabort=function(){i(o.error||new Error("aborted by user"))};const l=a.openKeyCursor?"openKeyCursor":"openCursor",u=s.reverse?"prev":"next";a[l](n,u).onsuccess=function(d){const h=d.target.result;h&&(a.delete(h.key).onsuccess=function(){(s.limit<=0||++c<s.limit)&&h.continue()})}};const{AbstractLevel:Q6}=bc,cA=Go,eF=H6,{fromCallback:tF}=pf,{Iterator:rF}=J5,lA=Z5,nF=Y6,iF=G5,X5="level-js-",Mf=Symbol("idb"),_v=Symbol("namePrefix"),oa=Symbol("location"),Ev=Symbol("version"),Mc=Symbol("store"),Uf=Symbol("onComplete"),dA=Symbol("promise");class sF extends Q6{constructor(e,r,n){if(typeof r=="function"||typeof n=="function")throw new cA("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});const{prefix:s,version:i,...o}=r||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},o),typeof e!="string")throw new Error("constructor requires a location string argument");this[oa]=e,this[_v]=s??X5,this[Ev]=parseInt(i||1,10),this[Mf]=null}get location(){return this[oa]}get namePrefix(){return this[_v]}get version(){return this[Ev]}get db(){return this[Mf]}get type(){return"browser-level"}_open(e,r){const n=indexedDB.open(this[_v]+this[oa],this[Ev]);n.onerror=function(){r(n.error||new Error("unknown error"))},n.onsuccess=()=>{this[Mf]=n.result,r()},n.onupgradeneeded=s=>{const i=s.target.result;i.objectStoreNames.contains(this[oa])||i.createObjectStore(this[oa])}}[Mc](e){return this[Mf].transaction([this[oa]],e).objectStore(this[oa])}[Uf](e,r){const n=e.transaction;n.onabort=function(){r(n.error||new Error("aborted by user"))},n.oncomplete=function(){r(null,e.result)}}_get(e,r,n){const s=this[Mc]("readonly");let i;try{i=s.get(e)}catch(o){return this.nextTick(n,o)}this[Uf](i,function(o,a){if(o)return n(o);if(a===void 0)return n(new cA("Entry not found",{code:"LEVEL_NOT_FOUND"}));n(null,lA(a))})}_getMany(e,r,n){const s=this[Mc]("readonly"),i=e.map(o=>a=>{let c;try{c=s.get(o)}catch(l){return a(l)}c.onsuccess=()=>{const l=c.result;a(null,l===void 0?l:lA(l))},c.onerror=l=>{l.stopPropagation(),a(c.error)}});eF(i,16,n)}_del(e,r,n){const s=this[Mc]("readwrite");let i;try{i=s.delete(e)}catch(o){return this.nextTick(n,o)}this[Uf](i,n)}_put(e,r,n,s){const i=this[Mc]("readwrite");let o;try{o=i.put(r,e)}catch(a){return this.nextTick(s,a)}this[Uf](o,s)}_iterator(e){return new rF(this,this[oa],e)}_batch(e,r,n){const s=this[Mc]("readwrite"),i=s.transaction;let o=0,a;i.onabort=function(){n(a||i.error||new Error("aborted by user"))},i.oncomplete=function(){n()};function c(){const l=e[o++],u=l.key;let d;try{d=l.type==="del"?s.delete(u):s.put(l.value,u)}catch(h){a=h,i.abort();return}o<e.length?d.onsuccess=c:typeof i.commit=="function"&&i.commit()}c()}_clear(e,r){let n,s;try{n=iF(e)}catch{return this.nextTick(r)}if(e.limit>=0)return nF(this,this[oa],n,e,r);try{const i=this[Mc]("readwrite");s=n?i.delete(n):i.clear()}catch(i){return this.nextTick(r,i)}this[Uf](s,r)}_close(e){this[Mf].close(),this.nextTick(e)}}sF.destroy=function(t,e,r){typeof e=="function"&&(r=e,e=X5),r=tF(r,dA);const n=indexedDB.deleteDatabase(e+t);return n.onsuccess=function(){r()},n.onerror=function(s){r(s)},r[dA]};var oF={exports:{}},Av={exports:{}},en={ArrayIsArray(t){return Array.isArray(t)},ArrayPrototypeIncludes(t,e){return t.includes(e)},ArrayPrototypeIndexOf(t,e){return t.indexOf(e)},ArrayPrototypeJoin(t,e){return t.join(e)},ArrayPrototypeMap(t,e){return t.map(e)},ArrayPrototypePop(t,e){return t.pop(e)},ArrayPrototypePush(t,e){return t.push(e)},ArrayPrototypeSlice(t,e,r){return t.slice(e,r)},Error,FunctionPrototypeCall(t,e,...r){return t.call(e,...r)},FunctionPrototypeSymbolHasInstance(t,e){return Function.prototype[Symbol.hasInstance].call(t,e)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(t,e){return Object.defineProperties(t,e)},ObjectDefineProperty(t,e,r){return Object.defineProperty(t,e,r)},ObjectGetOwnPropertyDescriptor(t,e){return Object.getOwnPropertyDescriptor(t,e)},ObjectKeys(t){return Object.keys(t)},ObjectSetPrototypeOf(t,e){return Object.setPrototypeOf(t,e)},Promise,PromisePrototypeCatch(t,e){return t.catch(e)},PromisePrototypeThen(t,e,r){return t.then(e,r)},PromiseReject(t){return Promise.reject(t)},ReflectApply:Reflect.apply,RegExpPrototypeTest(t,e){return t.test(e)},SafeSet:Set,String,StringPrototypeSlice(t,e,r){return t.slice(e,r)},StringPrototypeToLowerCase(t){return t.toLowerCase()},StringPrototypeToUpperCase(t){return t.toUpperCase()},StringPrototypeTrim(t){return t.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet(t,e,r){return t.set(e,r)},Uint8Array},Y5={exports:{}};(function(t){const e=As,r=Object.getPrototypeOf(async function(){}).constructor,n=globalThis.Blob||e.Blob,s=typeof n<"u"?function(a){return a instanceof n}:function(a){return!1};class i extends Error{constructor(a){if(!Array.isArray(a))throw new TypeError(`Expected input to be an Array, got ${typeof a}`);let c="";for(let l=0;l<a.length;l++)c+=`    ${a[l].stack}
`;super(c),this.name="AggregateError",this.errors=a}}t.exports={AggregateError:i,kEmptyObject:Object.freeze({}),once(o){let a=!1;return function(...c){a||(a=!0,o.apply(this,c))}},createDeferredPromise:function(){let o,a;return{promise:new Promise((l,u)=>{o=l,a=u}),resolve:o,reject:a}},promisify(o){return new Promise((a,c)=>{o((l,...u)=>l?c(l):a(...u))})},debuglog(){return function(){}},format(o,...a){return o.replace(/%([sdifj])/g,function(...[c,l]){const u=a.shift();return l==="f"?u.toFixed(6):l==="j"?JSON.stringify(u):l==="s"&&typeof u=="object"?`${u.constructor!==Object?u.constructor.name:""} {}`.trim():u.toString()})},inspect(o){switch(typeof o){case"string":if(o.includes("'"))if(o.includes('"')){if(!o.includes("`")&&!o.includes("${"))return`\`${o}\``}else return`"${o}"`;return`'${o}'`;case"number":return isNaN(o)?"NaN":Object.is(o,-0)?String(o):o;case"bigint":return`${String(o)}n`;case"boolean":case"undefined":return String(o);case"object":return"{}"}},types:{isAsyncFunction(o){return o instanceof r},isArrayBufferView(o){return ArrayBuffer.isView(o)}},isBlob:s},t.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")})(Y5);var Ya=Y5.exports,H1={},Fm={exports:{}},aF=Fm.exports,fA;function W1(){return fA||(fA=1,Object.defineProperty(aF,"__esModule",{value:!0}),Fm.exports=Object.freeze(Object.create(null,{__unenv__:{get:()=>!0}}))),Fm.exports}const{format:uF,inspect:$0,AggregateError:cF}=Ya,lF=globalThis.AggregateError||cF,dF=Symbol("kIsNodeError"),fF=["string","function","number","object","Function","Object","boolean","bigint","symbol"],pF=/^([A-Z][a-z0-9]*)+$/,hF="__node_internal_",vg={};function Dl(t,e){if(!t)throw new vg.ERR_INTERNAL_ASSERTION(e)}function pA(t){let e="",r=t.length;const n=t[0]==="-"?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function yF(t,e,r){if(typeof e=="function")return Dl(e.length<=r.length,`Code: ${t}; The provided arguments length (${r.length}) does not match the required ones (${e.length}).`),e(...r);const n=(e.match(/%[dfijoOs]/g)||[]).length;return Dl(n===r.length,`Code: ${t}; The provided arguments length (${r.length}) does not match the required ones (${n}).`),r.length===0?e:uF(e,...r)}function Nn(t,e,r){r||(r=Error);class n extends r{constructor(...i){super(yF(t,e,i))}toString(){return`${this.name} [${t}]: ${this.message}`}}Object.defineProperties(n.prototype,{name:{value:r.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${t}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),n.prototype.code=t,n.prototype[dF]=!0,vg[t]=n}function hA(t){const e=hF+t.name;return Object.defineProperty(t,"name",{value:e}),t}function mF(t,e){if(t&&e&&t!==e){if(Array.isArray(e.errors))return e.errors.push(t),e;const r=new lF([e,t],e.message);return r.code=e.code,r}return t||e}let gF=class extends Error{constructor(e="The operation was aborted",r=void 0){if(r!==void 0&&typeof r!="object")throw new vg.ERR_INVALID_ARG_TYPE("options","Object",r);super(e,r),this.code="ABORT_ERR",this.name="AbortError"}};Nn("ERR_ASSERTION","%s",Error);Nn("ERR_INVALID_ARG_TYPE",(t,e,r)=>{Dl(typeof t=="string","'name' must be a string"),Array.isArray(e)||(e=[e]);let n="The ";t.endsWith(" argument")?n+=`${t} `:n+=`"${t}" ${t.includes(".")?"property":"argument"} `,n+="must be ";const s=[],i=[],o=[];for(const c of e)Dl(typeof c=="string","All expected entries have to be of type string"),fF.includes(c)?s.push(c.toLowerCase()):pF.test(c)?i.push(c):(Dl(c!=="object",'The value "object" should be written as "Object"'),o.push(c));if(i.length>0){const c=s.indexOf("object");c!==-1&&(s.splice(s,c,1),i.push("Object"))}if(s.length>0){switch(s.length){case 1:n+=`of type ${s[0]}`;break;case 2:n+=`one of type ${s[0]} or ${s[1]}`;break;default:{const c=s.pop();n+=`one of type ${s.join(", ")}, or ${c}`}}(i.length>0||o.length>0)&&(n+=" or ")}if(i.length>0){switch(i.length){case 1:n+=`an instance of ${i[0]}`;break;case 2:n+=`an instance of ${i[0]} or ${i[1]}`;break;default:{const c=i.pop();n+=`an instance of ${i.join(", ")}, or ${c}`}}o.length>0&&(n+=" or ")}switch(o.length){case 0:break;case 1:o[0].toLowerCase()!==o[0]&&(n+="an "),n+=`${o[0]}`;break;case 2:n+=`one of ${o[0]} or ${o[1]}`;break;default:{const c=o.pop();n+=`one of ${o.join(", ")}, or ${c}`}}if(r==null)n+=`. Received ${r}`;else if(typeof r=="function"&&r.name)n+=`. Received function ${r.name}`;else if(typeof r=="object"){var a;if((a=r.constructor)!==null&&a!==void 0&&a.name)n+=`. Received an instance of ${r.constructor.name}`;else{const c=$0(r,{depth:-1});n+=`. Received ${c}`}}else{let c=$0(r,{colors:!1});c.length>25&&(c=`${c.slice(0,25)}...`),n+=`. Received type ${typeof r} (${c})`}return n},TypeError);Nn("ERR_INVALID_ARG_VALUE",(t,e,r="is invalid")=>{let n=$0(e);return n.length>128&&(n=n.slice(0,128)+"..."),`The ${t.includes(".")?"property":"argument"} '${t}' ${r}. Received ${n}`},TypeError);Nn("ERR_INVALID_RETURN_VALUE",(t,e,r)=>{var n;const s=r!=null&&(n=r.constructor)!==null&&n!==void 0&&n.name?`instance of ${r.constructor.name}`:`type ${typeof r}`;return`Expected ${t} to be returned from the "${e}" function but got ${s}.`},TypeError);Nn("ERR_MISSING_ARGS",(...t)=>{Dl(t.length>0,"At least one arg needs to be specified");let e;const r=t.length;switch(t=(Array.isArray(t)?t:[t]).map(n=>`"${n}"`).join(" or "),r){case 1:e+=`The ${t[0]} argument`;break;case 2:e+=`The ${t[0]} and ${t[1]} arguments`;break;default:{const n=t.pop();e+=`The ${t.join(", ")}, and ${n} arguments`}break}return`${e} must be specified`},TypeError);Nn("ERR_OUT_OF_RANGE",(t,e,r)=>{Dl(e,'Missing "range" argument');let n;return Number.isInteger(r)&&Math.abs(r)>2**32?n=pA(String(r)):typeof r=="bigint"?(n=String(r),(r>2n**32n||r<-(2n**32n))&&(n=pA(n)),n+="n"):n=$0(r),`The value of "${t}" is out of range. It must be ${e}. Received ${n}`},RangeError);Nn("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error);Nn("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error);Nn("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error);Nn("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error);Nn("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error);Nn("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);Nn("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error);Nn("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error);Nn("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error);Nn("ERR_STREAM_WRITE_AFTER_END","write after end",Error);Nn("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError);var bi={AbortError:gF,aggregateTwoErrors:hA(mF),hideStackFrames:hA,codes:vg};const{ArrayIsArray:J1,ArrayPrototypeIncludes:Q5,ArrayPrototypeJoin:eP,ArrayPrototypeMap:vF,NumberIsInteger:G1,NumberIsNaN:wF,NumberMAX_SAFE_INTEGER:bF,NumberMIN_SAFE_INTEGER:_F,NumberParseInt:EF,ObjectPrototypeHasOwnProperty:AF,RegExpPrototypeExec:tP,String:SF,StringPrototypeToUpperCase:$F,StringPrototypeTrim:xF}=en,{hideStackFrames:Ss,codes:{ERR_SOCKET_BAD_PORT:DF,ERR_INVALID_ARG_TYPE:ti,ERR_INVALID_ARG_VALUE:hf,ERR_OUT_OF_RANGE:Ul,ERR_UNKNOWN_SIGNAL:yA}}=bi,{normalizeEncoding:PF}=Ya,{isAsyncFunction:CF,isArrayBufferView:kF}=Ya.types,mA={};function OF(t){return t===(t|0)}function TF(t){return t===t>>>0}const IF=/^[0-7]+$/,BF="must be a 32-bit unsigned integer or an octal string";function FF(t,e,r){if(typeof t>"u"&&(t=r),typeof t=="string"){if(tP(IF,t)===null)throw new hf(e,t,BF);t=EF(t,8)}return rP(t,e),t}const NF=Ss((t,e,r=_F,n=bF)=>{if(typeof t!="number")throw new ti(e,"number",t);if(!G1(t))throw new Ul(e,"an integer",t);if(t<r||t>n)throw new Ul(e,`>= ${r} && <= ${n}`,t)}),RF=Ss((t,e,r=-2147483648,n=2147483647)=>{if(typeof t!="number")throw new ti(e,"number",t);if(!G1(t))throw new Ul(e,"an integer",t);if(t<r||t>n)throw new Ul(e,`>= ${r} && <= ${n}`,t)}),rP=Ss((t,e,r=!1)=>{if(typeof t!="number")throw new ti(e,"number",t);if(!G1(t))throw new Ul(e,"an integer",t);const n=r?1:0,s=4294967295;if(t<n||t>s)throw new Ul(e,`>= ${n} && <= ${s}`,t)});function Z1(t,e){if(typeof t!="string")throw new ti(e,"string",t)}function jF(t,e,r=void 0,n){if(typeof t!="number")throw new ti(e,"number",t);if(r!=null&&t<r||n!=null&&t>n||(r!=null||n!=null)&&wF(t))throw new Ul(e,`${r!=null?`>= ${r}`:""}${r!=null&&n!=null?" && ":""}${n!=null?`<= ${n}`:""}`,t)}const MF=Ss((t,e,r)=>{if(!Q5(r,t)){const s="must be one of: "+eP(vF(r,i=>typeof i=="string"?`'${i}'`:SF(i)),", ");throw new hf(e,t,s)}});function nP(t,e){if(typeof t!="boolean")throw new ti(e,"boolean",t)}function Sv(t,e,r){return t==null||!AF(t,e)?r:t[e]}const UF=Ss((t,e,r=null)=>{const n=Sv(r,"allowArray",!1),s=Sv(r,"allowFunction",!1);if(!Sv(r,"nullable",!1)&&t===null||!n&&J1(t)||typeof t!="object"&&(!s||typeof t!="function"))throw new ti(e,"Object",t)}),KF=Ss((t,e)=>{if(t!=null&&typeof t!="object"&&typeof t!="function")throw new ti(e,"a dictionary",t)}),X1=Ss((t,e,r=0)=>{if(!J1(t))throw new ti(e,"Array",t);if(t.length<r){const n=`must be longer than ${r}`;throw new hf(e,t,n)}});function LF(t,e){X1(t,e);for(let r=0;r<t.length;r++)Z1(t[r],`${e}[${r}]`)}function qF(t,e){X1(t,e);for(let r=0;r<t.length;r++)nP(t[r],`${e}[${r}]`)}function VF(t,e="signal"){if(Z1(t,e),mA[t]===void 0)throw mA[$F(t)]!==void 0?new yA(t+" (signals must use all capital letters)"):new yA(t)}const zF=Ss((t,e="buffer")=>{if(!kF(t))throw new ti(e,["Buffer","TypedArray","DataView"],t)});function HF(t,e){const r=PF(e),n=t.length;if(r==="hex"&&n%2!==0)throw new hf("encoding",e,`is invalid for data of length ${n}`)}function WF(t,e="Port",r=!0){if(typeof t!="number"&&typeof t!="string"||typeof t=="string"&&xF(t).length===0||+t!==+t>>>0||t>65535||t===0&&!r)throw new DF(e,t,r);return t|0}const JF=Ss((t,e)=>{if(t!==void 0&&(t===null||typeof t!="object"||!("aborted"in t)))throw new ti(e,"AbortSignal",t)}),GF=Ss((t,e)=>{if(typeof t!="function")throw new ti(e,"Function",t)}),ZF=Ss((t,e)=>{if(typeof t!="function"||CF(t))throw new ti(e,"Function",t)}),XF=Ss((t,e)=>{if(t!==void 0)throw new ti(e,"undefined",t)});function YF(t,e,r){if(!Q5(r,t))throw new ti(e,`('${eP(r,"|")}')`,t)}const QF=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function gA(t,e){if(typeof t>"u"||!tP(QF,t))throw new hf(e,t,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function e3(t){if(typeof t=="string")return gA(t,"hints"),t;if(J1(t)){const e=t.length;let r="";if(e===0)return r;for(let n=0;n<e;n++){const s=t[n];gA(s,"hints"),r+=s,n!==e-1&&(r+=", ")}return r}throw new hf("hints",t,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}var wg={isInt32:OF,isUint32:TF,parseFileMode:FF,validateArray:X1,validateStringArray:LF,validateBooleanArray:qF,validateBoolean:nP,validateBuffer:zF,validateDictionary:KF,validateEncoding:HF,validateFunction:GF,validateInt32:RF,validateInteger:NF,validateNumber:jF,validateObject:UF,validateOneOf:MF,validatePlainFunction:ZF,validatePort:WF,validateSignalName:VF,validateString:Z1,validateUint32:rP,validateUndefined:XF,validateUnion:YF,validateAbortSignal:JF,validateLinkHeaderValue:e3},Y1={exports:{}},iP={exports:{}},Rr=iP.exports={},Eo,Ao;function tb(){throw new Error("setTimeout has not been defined")}function rb(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Eo=setTimeout:Eo=tb}catch{Eo=tb}try{typeof clearTimeout=="function"?Ao=clearTimeout:Ao=rb}catch{Ao=rb}})();function sP(t){if(Eo===setTimeout)return setTimeout(t,0);if((Eo===tb||!Eo)&&setTimeout)return Eo=setTimeout,setTimeout(t,0);try{return Eo(t,0)}catch{try{return Eo.call(null,t,0)}catch{return Eo.call(this,t,0)}}}function t3(t){if(Ao===clearTimeout)return clearTimeout(t);if((Ao===rb||!Ao)&&clearTimeout)return Ao=clearTimeout,clearTimeout(t);try{return Ao(t)}catch{try{return Ao.call(null,t)}catch{return Ao.call(this,t)}}}var Ua=[],Ud=!1,bl,Nm=-1;function r3(){!Ud||!bl||(Ud=!1,bl.length?Ua=bl.concat(Ua):Nm=-1,Ua.length&&oP())}function oP(){if(!Ud){var t=sP(r3);Ud=!0;for(var e=Ua.length;e;){for(bl=Ua,Ua=[];++Nm<e;)bl&&bl[Nm].run();Nm=-1,e=Ua.length}bl=null,Ud=!1,t3(t)}}Rr.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];Ua.push(new aP(t,e)),Ua.length===1&&!Ud&&sP(oP)};function aP(t,e){this.fun=t,this.array=e}aP.prototype.run=function(){this.fun.apply(null,this.array)};Rr.title="browser";Rr.browser=!0;Rr.env={};Rr.argv=[];Rr.version="";Rr.versions={};function Qa(){}Rr.on=Qa;Rr.addListener=Qa;Rr.once=Qa;Rr.off=Qa;Rr.removeListener=Qa;Rr.removeAllListeners=Qa;Rr.emit=Qa;Rr.prependListener=Qa;Rr.prependOnceListener=Qa;Rr.listeners=function(t){return[]};Rr.binding=function(t){throw new Error("process.binding is not supported")};Rr.cwd=function(){return"/"};Rr.chdir=function(t){throw new Error("process.chdir is not supported")};Rr.umask=function(){return 0};var ed=iP.exports;const{Symbol:bg,SymbolAsyncIterator:vA,SymbolIterator:wA,SymbolFor:uP}=en,cP=bg("kDestroyed"),lP=bg("kIsErrored"),nb=bg("kIsReadable"),dP=bg("kIsDisturbed"),n3=uP("nodejs.webstream.isClosedPromise"),i3=uP("nodejs.webstream.controllerErrorFunction");function _g(t,e=!1){var r;return!!(t&&typeof t.pipe=="function"&&typeof t.on=="function"&&(!e||typeof t.pause=="function"&&typeof t.resume=="function")&&(!t._writableState||((r=t._readableState)===null||r===void 0?void 0:r.readable)!==!1)&&(!t._writableState||t._readableState))}function Eg(t){var e;return!!(t&&typeof t.write=="function"&&typeof t.on=="function"&&(!t._readableState||((e=t._writableState)===null||e===void 0?void 0:e.writable)!==!1))}function s3(t){return!!(t&&typeof t.pipe=="function"&&t._readableState&&typeof t.on=="function"&&typeof t.write=="function")}function Xo(t){return t&&(t._readableState||t._writableState||typeof t.write=="function"&&typeof t.on=="function"||typeof t.pipe=="function"&&typeof t.on=="function")}function fP(t){return!!(t&&!Xo(t)&&typeof t.pipeThrough=="function"&&typeof t.getReader=="function"&&typeof t.cancel=="function")}function pP(t){return!!(t&&!Xo(t)&&typeof t.getWriter=="function"&&typeof t.abort=="function")}function hP(t){return!!(t&&!Xo(t)&&typeof t.readable=="object"&&typeof t.writable=="object")}function o3(t){return fP(t)||pP(t)||hP(t)}function a3(t,e){return t==null?!1:e===!0?typeof t[vA]=="function":e===!1?typeof t[wA]=="function":typeof t[vA]=="function"||typeof t[wA]=="function"}function Ag(t){if(!Xo(t))return null;const e=t._writableState,r=t._readableState,n=e||r;return!!(t.destroyed||t[cP]||n!=null&&n.destroyed)}function yP(t){if(!Eg(t))return null;if(t.writableEnded===!0)return!0;const e=t._writableState;return e!=null&&e.errored?!1:typeof(e==null?void 0:e.ended)!="boolean"?null:e.ended}function u3(t,e){if(!Eg(t))return null;if(t.writableFinished===!0)return!0;const r=t._writableState;return r!=null&&r.errored?!1:typeof(r==null?void 0:r.finished)!="boolean"?null:!!(r.finished||e===!1&&r.ended===!0&&r.length===0)}function c3(t){if(!_g(t))return null;if(t.readableEnded===!0)return!0;const e=t._readableState;return!e||e.errored?!1:typeof(e==null?void 0:e.ended)!="boolean"?null:e.ended}function mP(t,e){if(!_g(t))return null;const r=t._readableState;return r!=null&&r.errored?!1:typeof(r==null?void 0:r.endEmitted)!="boolean"?null:!!(r.endEmitted||e===!1&&r.ended===!0&&r.length===0)}function gP(t){return t&&t[nb]!=null?t[nb]:typeof(t==null?void 0:t.readable)!="boolean"?null:Ag(t)?!1:_g(t)&&t.readable&&!mP(t)}function vP(t){return typeof(t==null?void 0:t.writable)!="boolean"?null:Ag(t)?!1:Eg(t)&&t.writable&&!yP(t)}function l3(t,e){return Xo(t)?Ag(t)?!0:!((e==null?void 0:e.readable)!==!1&&gP(t)||(e==null?void 0:e.writable)!==!1&&vP(t)):null}function d3(t){var e,r;return Xo(t)?t.writableErrored?t.writableErrored:(e=(r=t._writableState)===null||r===void 0?void 0:r.errored)!==null&&e!==void 0?e:null:null}function f3(t){var e,r;return Xo(t)?t.readableErrored?t.readableErrored:(e=(r=t._readableState)===null||r===void 0?void 0:r.errored)!==null&&e!==void 0?e:null:null}function p3(t){if(!Xo(t))return null;if(typeof t.closed=="boolean")return t.closed;const e=t._writableState,r=t._readableState;return typeof(e==null?void 0:e.closed)=="boolean"||typeof(r==null?void 0:r.closed)=="boolean"?(e==null?void 0:e.closed)||(r==null?void 0:r.closed):typeof t._closed=="boolean"&&wP(t)?t._closed:null}function wP(t){return typeof t._closed=="boolean"&&typeof t._defaultKeepAlive=="boolean"&&typeof t._removedConnection=="boolean"&&typeof t._removedContLen=="boolean"}function bP(t){return typeof t._sent100=="boolean"&&wP(t)}function h3(t){var e;return typeof t._consuming=="boolean"&&typeof t._dumped=="boolean"&&((e=t.req)===null||e===void 0?void 0:e.upgradeOrConnect)===void 0}function y3(t){if(!Xo(t))return null;const e=t._writableState,r=t._readableState,n=e||r;return!n&&bP(t)||!!(n&&n.autoDestroy&&n.emitClose&&n.closed===!1)}function m3(t){var e;return!!(t&&((e=t[dP])!==null&&e!==void 0?e:t.readableDidRead||t.readableAborted))}function g3(t){var e,r,n,s,i,o,a,c,l,u;return!!(t&&((e=(r=(n=(s=(i=(o=t[lP])!==null&&o!==void 0?o:t.readableErrored)!==null&&i!==void 0?i:t.writableErrored)!==null&&s!==void 0?s:(a=t._readableState)===null||a===void 0?void 0:a.errorEmitted)!==null&&n!==void 0?n:(c=t._writableState)===null||c===void 0?void 0:c.errorEmitted)!==null&&r!==void 0?r:(l=t._readableState)===null||l===void 0?void 0:l.errored)!==null&&e!==void 0?e:!((u=t._writableState)===null||u===void 0)&&u.errored))}var eu={kDestroyed:cP,isDisturbed:m3,kIsDisturbed:dP,isErrored:g3,kIsErrored:lP,isReadable:gP,kIsReadable:nb,kIsClosedPromise:n3,kControllerErrorFunction:i3,isClosed:p3,isDestroyed:Ag,isDuplexNodeStream:s3,isFinished:l3,isIterable:a3,isReadableNodeStream:_g,isReadableStream:fP,isReadableEnded:c3,isReadableFinished:mP,isReadableErrored:f3,isNodeStream:Xo,isWebStream:o3,isWritable:vP,isWritableNodeStream:Eg,isWritableStream:pP,isWritableEnded:yP,isWritableFinished:u3,isWritableErrored:d3,isServerRequest:h3,isServerResponse:bP,willEmitClose:y3,isTransformStream:hP};const zu=ed,{AbortError:_P,codes:v3}=bi,{ERR_INVALID_ARG_TYPE:w3,ERR_STREAM_PREMATURE_CLOSE:bA}=v3,{kEmptyObject:ib,once:sb}=Ya,{validateAbortSignal:b3,validateFunction:_3,validateObject:E3,validateBoolean:A3}=wg,{Promise:S3,PromisePrototypeThen:$3}=en,{isClosed:x3,isReadable:_A,isReadableNodeStream:$v,isReadableStream:D3,isReadableFinished:EA,isReadableErrored:AA,isWritable:SA,isWritableNodeStream:$A,isWritableStream:P3,isWritableFinished:xA,isWritableErrored:DA,isNodeStream:C3,willEmitClose:k3,kIsClosedPromise:O3}=eu;function T3(t){return t.setHeader&&typeof t.abort=="function"}const ob=()=>{};function EP(t,e,r){var n,s;if(arguments.length===2?(r=e,e=ib):e==null?e=ib:E3(e,"options"),_3(r,"callback"),b3(e.signal,"options.signal"),r=sb(r),D3(t)||P3(t))return I3(t,e,r);if(!C3(t))throw new w3("stream",["ReadableStream","WritableStream","Stream"],t);const i=(n=e.readable)!==null&&n!==void 0?n:$v(t),o=(s=e.writable)!==null&&s!==void 0?s:$A(t),a=t._writableState,c=t._readableState,l=()=>{t.writable||h()};let u=k3(t)&&$v(t)===i&&$A(t)===o,d=xA(t,!1);const h=()=>{d=!0,t.destroyed&&(u=!1),!(u&&(!t.readable||i))&&(!i||f)&&r.call(t)};let f=EA(t,!1);const p=()=>{f=!0,t.destroyed&&(u=!1),!(u&&(!t.writable||o))&&(!o||d)&&r.call(t)},y=_=>{r.call(t,_)};let b=x3(t);const w=()=>{b=!0;const _=DA(t)||AA(t);if(_&&typeof _!="boolean")return r.call(t,_);if(i&&!f&&$v(t,!0)&&!EA(t,!1))return r.call(t,new bA);if(o&&!d&&!xA(t,!1))return r.call(t,new bA);r.call(t)},g=()=>{b=!0;const _=DA(t)||AA(t);if(_&&typeof _!="boolean")return r.call(t,_);r.call(t)},v=()=>{t.req.on("finish",h)};T3(t)?(t.on("complete",h),u||t.on("abort",w),t.req?v():t.on("request",v)):o&&!a&&(t.on("end",l),t.on("close",l)),!u&&typeof t.aborted=="boolean"&&t.on("aborted",w),t.on("end",p),t.on("finish",h),e.error!==!1&&t.on("error",y),t.on("close",w),b?zu.nextTick(w):a!=null&&a.errorEmitted||c!=null&&c.errorEmitted?u||zu.nextTick(g):(!i&&(!u||_A(t))&&(d||SA(t)===!1)||!o&&(!u||SA(t))&&(f||_A(t)===!1)||c&&t.req&&t.aborted)&&zu.nextTick(g);const m=()=>{r=ob,t.removeListener("aborted",w),t.removeListener("complete",h),t.removeListener("abort",w),t.removeListener("request",v),t.req&&t.req.removeListener("finish",h),t.removeListener("end",l),t.removeListener("close",l),t.removeListener("finish",h),t.removeListener("end",p),t.removeListener("error",y),t.removeListener("close",w)};if(e.signal&&!b){const _=()=>{const x=r;m(),x.call(t,new _P(void 0,{cause:e.signal.reason}))};if(e.signal.aborted)zu.nextTick(_);else{const x=r;r=sb((...D)=>{e.signal.removeEventListener("abort",_),x.apply(t,D)}),e.signal.addEventListener("abort",_)}}return m}function I3(t,e,r){let n=!1,s=ob;if(e.signal)if(s=()=>{n=!0,r.call(t,new _P(void 0,{cause:e.signal.reason}))},e.signal.aborted)zu.nextTick(s);else{const o=r;r=sb((...a)=>{e.signal.removeEventListener("abort",s),o.apply(t,a)}),e.signal.addEventListener("abort",s)}const i=(...o)=>{n||zu.nextTick(()=>r.apply(t,o))};return $3(t[O3].promise,i,i),ob}function B3(t,e){var r;let n=!1;return e===null&&(e=ib),(r=e)!==null&&r!==void 0&&r.cleanup&&(A3(e.cleanup,"cleanup"),n=e.cleanup),new S3((s,i)=>{const o=EP(t,e,a=>{n&&o(),a?i(a):s()})})}Y1.exports=EP;Y1.exports.finished=B3;var _c=Y1.exports;const No=ed,{aggregateTwoErrors:F3,codes:{ERR_MULTIPLE_CALLBACK:N3},AbortError:R3}=bi,{Symbol:AP}=en,{kDestroyed:j3,isDestroyed:M3,isFinished:U3,isServerRequest:K3}=eu,SP=AP("kDestroy"),ab=AP("kConstruct");function $P(t,e,r){t&&(t.stack,e&&!e.errored&&(e.errored=t),r&&!r.errored&&(r.errored=t))}function L3(t,e){const r=this._readableState,n=this._writableState,s=n||r;return n!=null&&n.destroyed||r!=null&&r.destroyed?(typeof e=="function"&&e(),this):($P(t,n,r),n&&(n.destroyed=!0),r&&(r.destroyed=!0),s.constructed?PA(this,t,e):this.once(SP,function(i){PA(this,F3(i,t),e)}),this)}function PA(t,e,r){let n=!1;function s(i){if(n)return;n=!0;const o=t._readableState,a=t._writableState;$P(i,a,o),a&&(a.closed=!0),o&&(o.closed=!0),typeof r=="function"&&r(i),i?No.nextTick(q3,t,i):No.nextTick(xP,t)}try{t._destroy(e||null,s)}catch(i){s(i)}}function q3(t,e){ub(t,e),xP(t)}function xP(t){const e=t._readableState,r=t._writableState;r&&(r.closeEmitted=!0),e&&(e.closeEmitted=!0),(r!=null&&r.emitClose||e!=null&&e.emitClose)&&t.emit("close")}function ub(t,e){const r=t._readableState,n=t._writableState;n!=null&&n.errorEmitted||r!=null&&r.errorEmitted||(n&&(n.errorEmitted=!0),r&&(r.errorEmitted=!0),t.emit("error",e))}function V3(){const t=this._readableState,e=this._writableState;t&&(t.constructed=!0,t.closed=!1,t.closeEmitted=!1,t.destroyed=!1,t.errored=null,t.errorEmitted=!1,t.reading=!1,t.ended=t.readable===!1,t.endEmitted=t.readable===!1),e&&(e.constructed=!0,e.destroyed=!1,e.closed=!1,e.closeEmitted=!1,e.errored=null,e.errorEmitted=!1,e.finalCalled=!1,e.prefinished=!1,e.ended=e.writable===!1,e.ending=e.writable===!1,e.finished=e.writable===!1)}function cb(t,e,r){const n=t._readableState,s=t._writableState;if(s!=null&&s.destroyed||n!=null&&n.destroyed)return this;n!=null&&n.autoDestroy||s!=null&&s.autoDestroy?t.destroy(e):e&&(e.stack,s&&!s.errored&&(s.errored=e),n&&!n.errored&&(n.errored=e),r?No.nextTick(ub,t,e):ub(t,e))}function z3(t,e){if(typeof t._construct!="function")return;const r=t._readableState,n=t._writableState;r&&(r.constructed=!1),n&&(n.constructed=!1),t.once(ab,e),!(t.listenerCount(ab)>1)&&No.nextTick(H3,t)}function H3(t){let e=!1;function r(n){if(e){cb(t,n??new N3);return}e=!0;const s=t._readableState,i=t._writableState,o=i||s;s&&(s.constructed=!0),i&&(i.constructed=!0),o.destroyed?t.emit(SP,n):n?cb(t,n,!0):No.nextTick(W3,t)}try{t._construct(n=>{No.nextTick(r,n)})}catch(n){No.nextTick(r,n)}}function W3(t){t.emit(ab)}function CA(t){return(t==null?void 0:t.setHeader)&&typeof t.abort=="function"}function DP(t){t.emit("close")}function J3(t,e){t.emit("error",e),No.nextTick(DP,t)}function G3(t,e){!t||M3(t)||(!e&&!U3(t)&&(e=new R3),K3(t)?(t.socket=null,t.destroy(e)):CA(t)?t.abort():CA(t.req)?t.req.abort():typeof t.destroy=="function"?t.destroy(e):typeof t.close=="function"?t.close():e?No.nextTick(J3,t,e):No.nextTick(DP,t),t.destroyed||(t[j3]=!0))}var yf={construct:z3,destroyer:G3,destroy:L3,undestroy:V3,errorOrDestroy:cb};const{ArrayIsArray:Z3,ObjectSetPrototypeOf:PP}=en,{EventEmitter:Sg}=pg;function $g(t){Sg.call(this,t)}PP($g.prototype,Sg.prototype);PP($g,Sg);$g.prototype.pipe=function(t,e){const r=this;function n(u){t.writable&&t.write(u)===!1&&r.pause&&r.pause()}r.on("data",n);function s(){r.readable&&r.resume&&r.resume()}t.on("drain",s),!t._isStdio&&(!e||e.end!==!1)&&(r.on("end",o),r.on("close",a));let i=!1;function o(){i||(i=!0,t.end())}function a(){i||(i=!0,typeof t.destroy=="function"&&t.destroy())}function c(u){l(),Sg.listenerCount(this,"error")===0&&this.emit("error",u)}lb(r,"error",c),lb(t,"error",c);function l(){r.removeListener("data",n),t.removeListener("drain",s),r.removeListener("end",o),r.removeListener("close",a),r.removeListener("error",c),t.removeListener("error",c),r.removeListener("end",l),r.removeListener("close",l),t.removeListener("close",l)}return r.on("end",l),r.on("close",l),t.on("close",l),t.emit("pipe",r),t};function lb(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):Z3(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}var Q1={Stream:$g,prependListener:lb},CP={exports:{}};(function(t){const{AbortError:e,codes:r}=bi,{isNodeStream:n,isWebStream:s,kControllerErrorFunction:i}=eu,o=_c,{ERR_INVALID_ARG_TYPE:a}=r,c=(l,u)=>{if(typeof l!="object"||!("aborted"in l))throw new a(u,"AbortSignal",l)};t.exports.addAbortSignal=function(u,d){if(c(u,"signal"),!n(d)&&!s(d))throw new a("stream",["ReadableStream","WritableStream","Stream"],d);return t.exports.addAbortSignalNoValidate(u,d)},t.exports.addAbortSignalNoValidate=function(l,u){if(typeof l!="object"||!("aborted"in l))return u;const d=n(u)?()=>{u.destroy(new e(void 0,{cause:l.reason}))}:()=>{u[i](new e(void 0,{cause:l.reason}))};return l.aborted?d():(l.addEventListener("abort",d),o(u,()=>l.removeEventListener("abort",d))),u}})(CP);var xg=CP.exports;const{StringPrototypeSlice:kA,SymbolIterator:X3,TypedArrayPrototypeSet:Iy,Uint8Array:Y3}=en,{Buffer:xv}=As,{inspect:Q3}=Ya;var eN=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){const r={data:e,next:null};this.length>0?this.tail.next=r:this.head=r,this.tail=r,++this.length}unshift(e){const r={data:e,next:this.head};this.length===0&&(this.tail=r),this.head=r,++this.length}shift(){if(this.length===0)return;const e=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(this.length===0)return"";let r=this.head,n=""+r.data;for(;(r=r.next)!==null;)n+=e+r.data;return n}concat(e){if(this.length===0)return xv.alloc(0);const r=xv.allocUnsafe(e>>>0);let n=this.head,s=0;for(;n;)Iy(r,n.data,s),s+=n.data.length,n=n.next;return r}consume(e,r){const n=this.head.data;if(e<n.length){const s=n.slice(0,e);return this.head.data=n.slice(e),s}return e===n.length?this.shift():r?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[X3](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let r="",n=this.head,s=0;do{const i=n.data;if(e>i.length)r+=i,e-=i.length;else{e===i.length?(r+=i,++s,n.next?this.head=n.next:this.head=this.tail=null):(r+=kA(i,0,e),this.head=n,n.data=kA(i,e));break}++s}while((n=n.next)!==null);return this.length-=s,r}_getBuffer(e){const r=xv.allocUnsafe(e),n=e;let s=this.head,i=0;do{const o=s.data;if(e>o.length)Iy(r,o,n-e),e-=o.length;else{e===o.length?(Iy(r,o,n-e),++i,s.next?this.head=s.next:this.head=this.tail=null):(Iy(r,new Y3(o.buffer,o.byteOffset,e),n-e),this.head=s,s.data=o.slice(e));break}++i}while((s=s.next)!==null);return this.length-=i,r}[Symbol.for("nodejs.util.inspect.custom")](e,r){return Q3(this,{...r,depth:0,customInspect:!1})}};const{MathFloor:tN,NumberIsInteger:rN}=en,{ERR_INVALID_ARG_VALUE:nN}=bi.codes;function iN(t,e,r){return t.highWaterMark!=null?t.highWaterMark:e?t[r]:null}function kP(t){return t?16:16*1024}function sN(t,e,r,n){const s=iN(e,n,r);if(s!=null){if(!rN(s)||s<0){const i=n?`options.${r}`:"options.highWaterMark";throw new nN(i,s)}return tN(s)}return kP(t.objectMode)}var e_={getHighWaterMark:sN,getDefaultHighWaterMark:kP},OP={},db={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(t,e){var r=As,n=r.Buffer;function s(o,a){for(var c in o)a[c]=o[c]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=r:(s(r,e),e.Buffer=i);function i(o,a,c){return n(o,a,c)}i.prototype=Object.create(n.prototype),s(n,i),i.from=function(o,a,c){if(typeof o=="number")throw new TypeError("Argument must not be a number");return n(o,a,c)},i.alloc=function(o,a,c){if(typeof o!="number")throw new TypeError("Argument must be a number");var l=n(o);return a!==void 0?typeof c=="string"?l.fill(a,c):l.fill(a):l.fill(0),l},i.allocUnsafe=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return n(o)},i.allocUnsafeSlow=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(o)}})(db,db.exports);var oN=db.exports,t_=oN.Buffer,OA=t_.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function aN(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function uN(t){var e=aN(t);if(typeof e!="string"&&(t_.isEncoding===OA||!OA(t)))throw new Error("Unknown encoding: "+t);return e||t}OP.StringDecoder=Wh;function Wh(t){this.encoding=uN(t);var e;switch(this.encoding){case"utf16le":this.text=hN,this.end=yN,e=4;break;case"utf8":this.fillLast=dN,e=4;break;case"base64":this.text=mN,this.end=gN,e=3;break;default:this.write=vN,this.end=wN;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=t_.allocUnsafe(e)}Wh.prototype.write=function(t){if(t.length===0)return"";var e,r;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""};Wh.prototype.end=pN;Wh.prototype.text=fN;Wh.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function Dv(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function cN(t,e,r){var n=e.length-1;if(n<r)return 0;var s=Dv(e[n]);return s>=0?(s>0&&(t.lastNeed=s-1),s):--n<r||s===-2?0:(s=Dv(e[n]),s>=0?(s>0&&(t.lastNeed=s-2),s):--n<r||s===-2?0:(s=Dv(e[n]),s>=0?(s>0&&(s===2?s=0:t.lastNeed=s-3),s):0))}function lN(t,e,r){if((e[0]&192)!==128)return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return t.lastNeed=2,"�"}}function dN(t){var e=this.lastTotal-this.lastNeed,r=lN(this,t);if(r!==void 0)return r;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function fN(t,e){var r=cN(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var n=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)}function pN(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e}function hN(t,e){if((t.length-e)%2===0){var r=t.toString("utf16le",e);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function yN(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function mN(t,e){var r=(t.length-e)%3;return r===0?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function gN(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function vN(t){return t.toString(this.encoding)}function wN(t){return t&&t.length?this.write(t):""}const TA=ed,{PromisePrototypeThen:bN,SymbolAsyncIterator:IA,SymbolIterator:BA}=en,{Buffer:_N}=As,{ERR_INVALID_ARG_TYPE:EN,ERR_STREAM_NULL_VALUES:AN}=bi.codes;function SN(t,e,r){let n;if(typeof e=="string"||e instanceof _N)return new t({objectMode:!0,...r,read(){this.push(e),this.push(null)}});let s;if(e&&e[IA])s=!0,n=e[IA]();else if(e&&e[BA])s=!1,n=e[BA]();else throw new EN("iterable",["Iterable"],e);const i=new t({objectMode:!0,highWaterMark:1,...r});let o=!1;i._read=function(){o||(o=!0,c())},i._destroy=function(l,u){bN(a(l),()=>TA.nextTick(u,l),d=>TA.nextTick(u,d||l))};async function a(l){const u=l!=null,d=typeof n.throw=="function";if(u&&d){const{value:h,done:f}=await n.throw(l);if(await h,f)return}if(typeof n.return=="function"){const{value:h}=await n.return();await h}}async function c(){for(;;){try{const{value:l,done:u}=s?await n.next():n.next();if(u)i.push(null);else{const d=l&&typeof l.then=="function"?await l:l;if(d===null)throw o=!1,new AN;if(i.push(d))continue;o=!1}}catch(l){i.destroy(l)}break}}return i}var TP=SN,Pv,FA;function Dg(){if(FA)return Pv;FA=1;const t=ed,{ArrayPrototypeIndexOf:e,NumberIsInteger:r,NumberIsNaN:n,NumberParseInt:s,ObjectDefineProperties:i,ObjectKeys:o,ObjectSetPrototypeOf:a,Promise:c,SafeSet:l,SymbolAsyncIterator:u,Symbol:d}=en;Pv=M,M.ReadableState=Z;const{EventEmitter:h}=pg,{Stream:f,prependListener:p}=Q1,{Buffer:y}=As,{addAbortSignal:b}=xg,w=_c;let g=Ya.debuglog("stream",W=>{g=W});const v=eN,m=yf,{getHighWaterMark:_,getDefaultHighWaterMark:x}=e_,{aggregateTwoErrors:D,codes:{ERR_INVALID_ARG_TYPE:E,ERR_METHOD_NOT_IMPLEMENTED:A,ERR_OUT_OF_RANGE:S,ERR_STREAM_PUSH_AFTER_EOF:O,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:I}}=bi,{validateObject:N}=wg,j=d("kPaused"),{StringDecoder:F}=OP,V=TP;a(M.prototype,f.prototype),a(M,f);const ee=()=>{},{errorOrDestroy:G}=m;function Z(W,J,he){typeof he!="boolean"&&(he=J instanceof za()),this.objectMode=!!(W&&W.objectMode),he&&(this.objectMode=this.objectMode||!!(W&&W.readableObjectMode)),this.highWaterMark=W?_(this,W,"readableHighWaterMark",he):x(!1),this.buffer=new v,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[j]=null,this.errorEmitted=!1,this.emitClose=!W||W.emitClose!==!1,this.autoDestroy=!W||W.autoDestroy!==!1,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=W&&W.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,W&&W.encoding&&(this.decoder=new F(W.encoding),this.encoding=W.encoding)}function M(W){if(!(this instanceof M))return new M(W);const J=this instanceof za();this._readableState=new Z(W,this,J),W&&(typeof W.read=="function"&&(this._read=W.read),typeof W.destroy=="function"&&(this._destroy=W.destroy),typeof W.construct=="function"&&(this._construct=W.construct),W.signal&&!J&&b(W.signal,this)),f.call(this,W),m.construct(this,()=>{this._readableState.needReadable&&ye(this,this._readableState)})}M.prototype.destroy=m.destroy,M.prototype._undestroy=m.undestroy,M.prototype._destroy=function(W,J){J(W)},M.prototype[h.captureRejectionSymbol]=function(W){this.destroy(W)},M.prototype.push=function(W,J){return k(this,W,J,!1)},M.prototype.unshift=function(W,J){return k(this,W,J,!0)};function k(W,J,he,we){g("readableAddChunk",J);const Ce=W._readableState;let Mt;if(Ce.objectMode||(typeof J=="string"?(he=he||Ce.defaultEncoding,Ce.encoding!==he&&(we&&Ce.encoding?J=y.from(J,he).toString(Ce.encoding):(J=y.from(J,he),he=""))):J instanceof y?he="":f._isUint8Array(J)?(J=f._uint8ArrayToBuffer(J),he=""):J!=null&&(Mt=new E("chunk",["string","Buffer","Uint8Array"],J))),Mt)G(W,Mt);else if(J===null)Ce.reading=!1,z(W,Ce);else if(Ce.objectMode||J&&J.length>0)if(we)if(Ce.endEmitted)G(W,new I);else{if(Ce.destroyed||Ce.errored)return!1;H(W,Ce,J,!0)}else if(Ce.ended)G(W,new O);else{if(Ce.destroyed||Ce.errored)return!1;Ce.reading=!1,Ce.decoder&&!he?(J=Ce.decoder.write(J),Ce.objectMode||J.length!==0?H(W,Ce,J,!1):ye(W,Ce)):H(W,Ce,J,!1)}else we||(Ce.reading=!1,ye(W,Ce));return!Ce.ended&&(Ce.length<Ce.highWaterMark||Ce.length===0)}function H(W,J,he,we){J.flowing&&J.length===0&&!J.sync&&W.listenerCount("data")>0?(J.multiAwaitDrain?J.awaitDrainWriters.clear():J.awaitDrainWriters=null,J.dataEmitted=!0,W.emit("data",he)):(J.length+=J.objectMode?1:he.length,we?J.buffer.unshift(he):J.buffer.push(he),J.needReadable&&ne(W)),ye(W,J)}M.prototype.isPaused=function(){const W=this._readableState;return W[j]===!0||W.flowing===!1},M.prototype.setEncoding=function(W){const J=new F(W);this._readableState.decoder=J,this._readableState.encoding=this._readableState.decoder.encoding;const he=this._readableState.buffer;let we="";for(const Ce of he)we+=J.write(Ce);return he.clear(),we!==""&&he.push(we),this._readableState.length=we.length,this};const U=1073741824;function $(W){if(W>U)throw new S("size","<= 1GiB",W);return W--,W|=W>>>1,W|=W>>>2,W|=W>>>4,W|=W>>>8,W|=W>>>16,W++,W}function T(W,J){return W<=0||J.length===0&&J.ended?0:J.objectMode?1:n(W)?J.flowing&&J.length?J.buffer.first().length:J.length:W<=J.length?W:J.ended?J.length:0}M.prototype.read=function(W){g("read",W),W===void 0?W=NaN:r(W)||(W=s(W,10));const J=this._readableState,he=W;if(W>J.highWaterMark&&(J.highWaterMark=$(W)),W!==0&&(J.emittedReadable=!1),W===0&&J.needReadable&&((J.highWaterMark!==0?J.length>=J.highWaterMark:J.length>0)||J.ended))return g("read: emitReadable",J.length,J.ended),J.length===0&&J.ended?ae(this):ne(this),null;if(W=T(W,J),W===0&&J.ended)return J.length===0&&ae(this),null;let we=J.needReadable;if(g("need readable",we),(J.length===0||J.length-W<J.highWaterMark)&&(we=!0,g("length less than watermark",we)),J.ended||J.reading||J.destroyed||J.errored||!J.constructed)we=!1,g("reading, ended or constructing",we);else if(we){g("do read"),J.reading=!0,J.sync=!0,J.length===0&&(J.needReadable=!0);try{this._read(J.highWaterMark)}catch(Mt){G(this,Mt)}J.sync=!1,J.reading||(W=T(he,J))}let Ce;return W>0?Ce=X(W,J):Ce=null,Ce===null?(J.needReadable=J.length<=J.highWaterMark,W=0):(J.length-=W,J.multiAwaitDrain?J.awaitDrainWriters.clear():J.awaitDrainWriters=null),J.length===0&&(J.ended||(J.needReadable=!0),he!==W&&J.ended&&ae(this)),Ce!==null&&!J.errorEmitted&&!J.closeEmitted&&(J.dataEmitted=!0,this.emit("data",Ce)),Ce};function z(W,J){if(g("onEofChunk"),!J.ended){if(J.decoder){const he=J.decoder.end();he&&he.length&&(J.buffer.push(he),J.length+=J.objectMode?1:he.length)}J.ended=!0,J.sync?ne(W):(J.needReadable=!1,J.emittedReadable=!0,ue(W))}}function ne(W){const J=W._readableState;g("emitReadable",J.needReadable,J.emittedReadable),J.needReadable=!1,J.emittedReadable||(g("emitReadable",J.flowing),J.emittedReadable=!0,t.nextTick(ue,W))}function ue(W){const J=W._readableState;g("emitReadable_",J.destroyed,J.length,J.ended),!J.destroyed&&!J.errored&&(J.length||J.ended)&&(W.emit("readable"),J.emittedReadable=!1),J.needReadable=!J.flowing&&!J.ended&&J.length<=J.highWaterMark,K(W)}function ye(W,J){!J.readingMore&&J.constructed&&(J.readingMore=!0,t.nextTick(_e,W,J))}function _e(W,J){for(;!J.reading&&!J.ended&&(J.length<J.highWaterMark||J.flowing&&J.length===0);){const he=J.length;if(g("maybeReadMore read 0"),W.read(0),he===J.length)break}J.readingMore=!1}M.prototype._read=function(W){throw new A("_read()")},M.prototype.pipe=function(W,J){const he=this,we=this._readableState;we.pipes.length===1&&(we.multiAwaitDrain||(we.multiAwaitDrain=!0,we.awaitDrainWriters=new l(we.awaitDrainWriters?[we.awaitDrainWriters]:[]))),we.pipes.push(W),g("pipe count=%d opts=%j",we.pipes.length,J);const Mt=(!J||J.end!==!1)&&W!==t.stdout&&W!==t.stderr?Gs:Xs;we.endEmitted?t.nextTick(Mt):he.once("end",Mt),W.on("unpipe",or);function or(xs,_i){g("onunpipe"),xs===he&&_i&&_i.hasUnpiped===!1&&(_i.hasUnpiped=!0,sd())}function Gs(){g("onend"),W.end()}let xr,mr=!1;function sd(){g("cleanup"),W.removeListener("close",$s),W.removeListener("finish",Zs),xr&&W.removeListener("drain",xr),W.removeListener("error",zr),W.removeListener("unpipe",or),he.removeListener("end",Gs),he.removeListener("end",Xs),he.removeListener("data",Rt),mr=!0,xr&&we.awaitDrainWriters&&(!W._writableState||W._writableState.needDrain)&&xr()}function Cc(){mr||(we.pipes.length===1&&we.pipes[0]===W?(g("false write response, pause",0),we.awaitDrainWriters=W,we.multiAwaitDrain=!1):we.pipes.length>1&&we.pipes.includes(W)&&(g("false write response, pause",we.awaitDrainWriters.size),we.awaitDrainWriters.add(W)),he.pause()),xr||(xr=Se(he,W),W.on("drain",xr))}he.on("data",Rt);function Rt(xs){g("ondata");const _i=W.write(xs);g("dest.write",_i),_i===!1&&Cc()}function zr(xs){if(g("onerror",xs),Xs(),W.removeListener("error",zr),W.listenerCount("error")===0){const _i=W._writableState||W._readableState;_i&&!_i.errorEmitted?G(W,xs):W.emit("error",xs)}}p(W,"error",zr);function $s(){W.removeListener("finish",Zs),Xs()}W.once("close",$s);function Zs(){g("onfinish"),W.removeListener("close",$s),Xs()}W.once("finish",Zs);function Xs(){g("unpipe"),he.unpipe(W)}return W.emit("pipe",he),W.writableNeedDrain===!0?we.flowing&&Cc():we.flowing||(g("pipe resume"),he.resume()),W};function Se(W,J){return function(){const we=W._readableState;we.awaitDrainWriters===J?(g("pipeOnDrain",1),we.awaitDrainWriters=null):we.multiAwaitDrain&&(g("pipeOnDrain",we.awaitDrainWriters.size),we.awaitDrainWriters.delete(J)),(!we.awaitDrainWriters||we.awaitDrainWriters.size===0)&&W.listenerCount("data")&&W.resume()}}M.prototype.unpipe=function(W){const J=this._readableState,he={hasUnpiped:!1};if(J.pipes.length===0)return this;if(!W){const Ce=J.pipes;J.pipes=[],this.pause();for(let Mt=0;Mt<Ce.length;Mt++)Ce[Mt].emit("unpipe",this,{hasUnpiped:!1});return this}const we=e(J.pipes,W);return we===-1?this:(J.pipes.splice(we,1),J.pipes.length===0&&this.pause(),W.emit("unpipe",this,he),this)},M.prototype.on=function(W,J){const he=f.prototype.on.call(this,W,J),we=this._readableState;return W==="data"?(we.readableListening=this.listenerCount("readable")>0,we.flowing!==!1&&this.resume()):W==="readable"&&!we.endEmitted&&!we.readableListening&&(we.readableListening=we.needReadable=!0,we.flowing=!1,we.emittedReadable=!1,g("on readable",we.length,we.reading),we.length?ne(this):we.reading||t.nextTick(te,this)),he},M.prototype.addListener=M.prototype.on,M.prototype.removeListener=function(W,J){const he=f.prototype.removeListener.call(this,W,J);return W==="readable"&&t.nextTick(We,this),he},M.prototype.off=M.prototype.removeListener,M.prototype.removeAllListeners=function(W){const J=f.prototype.removeAllListeners.apply(this,arguments);return(W==="readable"||W===void 0)&&t.nextTick(We,this),J};function We(W){const J=W._readableState;J.readableListening=W.listenerCount("readable")>0,J.resumeScheduled&&J[j]===!1?J.flowing=!0:W.listenerCount("data")>0?W.resume():J.readableListening||(J.flowing=null)}function te(W){g("readable nexttick read 0"),W.read(0)}M.prototype.resume=function(){const W=this._readableState;return W.flowing||(g("resume"),W.flowing=!W.readableListening,se(this,W)),W[j]=!1,this};function se(W,J){J.resumeScheduled||(J.resumeScheduled=!0,t.nextTick(ce,W,J))}function ce(W,J){g("resume",J.reading),J.reading||W.read(0),J.resumeScheduled=!1,W.emit("resume"),K(W),J.flowing&&!J.reading&&W.read(0)}M.prototype.pause=function(){return g("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(g("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[j]=!0,this};function K(W){const J=W._readableState;for(g("flow",J.flowing);J.flowing&&W.read()!==null;);}M.prototype.wrap=function(W){let J=!1;W.on("data",we=>{!this.push(we)&&W.pause&&(J=!0,W.pause())}),W.on("end",()=>{this.push(null)}),W.on("error",we=>{G(this,we)}),W.on("close",()=>{this.destroy()}),W.on("destroy",()=>{this.destroy()}),this._read=()=>{J&&W.resume&&(J=!1,W.resume())};const he=o(W);for(let we=1;we<he.length;we++){const Ce=he[we];this[Ce]===void 0&&typeof W[Ce]=="function"&&(this[Ce]=W[Ce].bind(W))}return this},M.prototype[u]=function(){return C(this)},M.prototype.iterator=function(W){return W!==void 0&&N(W,"options"),C(this,W)};function C(W,J){typeof W.read!="function"&&(W=M.wrap(W,{objectMode:!0}));const he=B(W,J);return he.stream=W,he}async function*B(W,J){let he=ee;function we(or){this===W?(he(),he=ee):he=or}W.on("readable",we);let Ce;const Mt=w(W,{writable:!1},or=>{Ce=or?D(Ce,or):null,he(),he=ee});try{for(;;){const or=W.destroyed?null:W.read();if(or!==null)yield or;else{if(Ce)throw Ce;if(Ce===null)return;await new c(we)}}}catch(or){throw Ce=D(Ce,or),Ce}finally{(Ce||(J==null?void 0:J.destroyOnReturn)!==!1)&&(Ce===void 0||W._readableState.autoDestroy)?m.destroyer(W,null):(W.off("readable",we),Mt())}}i(M.prototype,{readable:{__proto__:null,get(){const W=this._readableState;return!!W&&W.readable!==!1&&!W.destroyed&&!W.errorEmitted&&!W.endEmitted},set(W){this._readableState&&(this._readableState.readable=!!W)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(W){this._readableState&&(this._readableState.flowing=W)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(W){this._readableState&&(this._readableState.destroyed=W)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),i(Z.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[j]!==!1},set(W){this[j]=!!W}}}),M._fromList=X;function X(W,J){if(J.length===0)return null;let he;return J.objectMode?he=J.buffer.shift():!W||W>=J.length?(J.decoder?he=J.buffer.join(""):J.buffer.length===1?he=J.buffer.first():he=J.buffer.concat(J.length),J.buffer.clear()):he=J.buffer.consume(W,J.decoder),he}function ae(W){const J=W._readableState;g("endReadable",J.endEmitted),J.endEmitted||(J.ended=!0,t.nextTick(ge,J,W))}function ge(W,J){if(g("endReadableNT",W.endEmitted,W.length),!W.errored&&!W.closeEmitted&&!W.endEmitted&&W.length===0){if(W.endEmitted=!0,J.emit("end"),J.writable&&J.allowHalfOpen===!1)t.nextTick(be,J);else if(W.autoDestroy){const he=J._writableState;(!he||he.autoDestroy&&(he.finished||he.writable===!1))&&J.destroy()}}}function be(W){W.writable&&!W.writableEnded&&!W.destroyed&&W.end()}M.from=function(W,J){return V(M,W,J)};let Ne;function Oe(){return Ne===void 0&&(Ne={}),Ne}return M.fromWeb=function(W,J){return Oe().newStreamReadableFromReadableStream(W,J)},M.toWeb=function(W,J){return Oe().newReadableStreamFromStreamReadable(W,J)},M.wrap=function(W,J){var he,we;return new M({objectMode:(he=(we=W.readableObjectMode)!==null&&we!==void 0?we:W.objectMode)!==null&&he!==void 0?he:!0,...J,destroy(Ce,Mt){m.destroyer(W,Ce),Mt(Ce)}}).wrap(W)},Pv}var Cv,NA;function IP(){if(NA)return Cv;NA=1;const t=ed,{ArrayPrototypeSlice:e,Error:r,FunctionPrototypeSymbolHasInstance:n,ObjectDefineProperty:s,ObjectDefineProperties:i,ObjectSetPrototypeOf:o,StringPrototypeToLowerCase:a,Symbol:c,SymbolHasInstance:l}=en;Cv=F,F.WritableState=N;const{EventEmitter:u}=pg,d=Q1.Stream,{Buffer:h}=As,f=yf,{addAbortSignal:p}=xg,{getHighWaterMark:y,getDefaultHighWaterMark:b}=e_,{ERR_INVALID_ARG_TYPE:w,ERR_METHOD_NOT_IMPLEMENTED:g,ERR_MULTIPLE_CALLBACK:v,ERR_STREAM_CANNOT_PIPE:m,ERR_STREAM_DESTROYED:_,ERR_STREAM_ALREADY_FINISHED:x,ERR_STREAM_NULL_VALUES:D,ERR_STREAM_WRITE_AFTER_END:E,ERR_UNKNOWN_ENCODING:A}=bi.codes,{errorOrDestroy:S}=f;o(F.prototype,d.prototype),o(F,d);function O(){}const I=c("kOnFinished");function N(te,se,ce){typeof ce!="boolean"&&(ce=se instanceof za()),this.objectMode=!!(te&&te.objectMode),ce&&(this.objectMode=this.objectMode||!!(te&&te.writableObjectMode)),this.highWaterMark=te?y(this,te,"writableHighWaterMark",ce):b(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const K=!!(te&&te.decodeStrings===!1);this.decodeStrings=!K,this.defaultEncoding=te&&te.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=M.bind(void 0,se),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,j(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!te||te.emitClose!==!1,this.autoDestroy=!te||te.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[I]=[]}function j(te){te.buffered=[],te.bufferedIndex=0,te.allBuffers=!0,te.allNoop=!0}N.prototype.getBuffer=function(){return e(this.buffered,this.bufferedIndex)},s(N.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function F(te){const se=this instanceof za();if(!se&&!n(F,this))return new F(te);this._writableState=new N(te,this,se),te&&(typeof te.write=="function"&&(this._write=te.write),typeof te.writev=="function"&&(this._writev=te.writev),typeof te.destroy=="function"&&(this._destroy=te.destroy),typeof te.final=="function"&&(this._final=te.final),typeof te.construct=="function"&&(this._construct=te.construct),te.signal&&p(te.signal,this)),d.call(this,te),f.construct(this,()=>{const ce=this._writableState;ce.writing||$(this,ce),ue(this,ce)})}s(F,l,{__proto__:null,value:function(te){return n(this,te)?!0:this!==F?!1:te&&te._writableState instanceof N}}),F.prototype.pipe=function(){S(this,new m)};function V(te,se,ce,K){const C=te._writableState;if(typeof ce=="function")K=ce,ce=C.defaultEncoding;else{if(!ce)ce=C.defaultEncoding;else if(ce!=="buffer"&&!h.isEncoding(ce))throw new A(ce);typeof K!="function"&&(K=O)}if(se===null)throw new D;if(!C.objectMode)if(typeof se=="string")C.decodeStrings!==!1&&(se=h.from(se,ce),ce="buffer");else if(se instanceof h)ce="buffer";else if(d._isUint8Array(se))se=d._uint8ArrayToBuffer(se),ce="buffer";else throw new w("chunk",["string","Buffer","Uint8Array"],se);let B;return C.ending?B=new E:C.destroyed&&(B=new _("write")),B?(t.nextTick(K,B),S(te,B,!0),B):(C.pendingcb++,ee(te,C,se,ce,K))}F.prototype.write=function(te,se,ce){return V(this,te,se,ce)===!0},F.prototype.cork=function(){this._writableState.corked++},F.prototype.uncork=function(){const te=this._writableState;te.corked&&(te.corked--,te.writing||$(this,te))},F.prototype.setDefaultEncoding=function(se){if(typeof se=="string"&&(se=a(se)),!h.isEncoding(se))throw new A(se);return this._writableState.defaultEncoding=se,this};function ee(te,se,ce,K,C){const B=se.objectMode?1:ce.length;se.length+=B;const X=se.length<se.highWaterMark;return X||(se.needDrain=!0),se.writing||se.corked||se.errored||!se.constructed?(se.buffered.push({chunk:ce,encoding:K,callback:C}),se.allBuffers&&K!=="buffer"&&(se.allBuffers=!1),se.allNoop&&C!==O&&(se.allNoop=!1)):(se.writelen=B,se.writecb=C,se.writing=!0,se.sync=!0,te._write(ce,K,se.onwrite),se.sync=!1),X&&!se.errored&&!se.destroyed}function G(te,se,ce,K,C,B,X){se.writelen=K,se.writecb=X,se.writing=!0,se.sync=!0,se.destroyed?se.onwrite(new _("write")):ce?te._writev(C,se.onwrite):te._write(C,B,se.onwrite),se.sync=!1}function Z(te,se,ce,K){--se.pendingcb,K(ce),U(se),S(te,ce)}function M(te,se){const ce=te._writableState,K=ce.sync,C=ce.writecb;if(typeof C!="function"){S(te,new v);return}ce.writing=!1,ce.writecb=null,ce.length-=ce.writelen,ce.writelen=0,se?(se.stack,ce.errored||(ce.errored=se),te._readableState&&!te._readableState.errored&&(te._readableState.errored=se),K?t.nextTick(Z,te,ce,se,C):Z(te,ce,se,C)):(ce.buffered.length>ce.bufferedIndex&&$(te,ce),K?ce.afterWriteTickInfo!==null&&ce.afterWriteTickInfo.cb===C?ce.afterWriteTickInfo.count++:(ce.afterWriteTickInfo={count:1,cb:C,stream:te,state:ce},t.nextTick(k,ce.afterWriteTickInfo)):H(te,ce,1,C))}function k({stream:te,state:se,count:ce,cb:K}){return se.afterWriteTickInfo=null,H(te,se,ce,K)}function H(te,se,ce,K){for(!se.ending&&!te.destroyed&&se.length===0&&se.needDrain&&(se.needDrain=!1,te.emit("drain"));ce-- >0;)se.pendingcb--,K();se.destroyed&&U(se),ue(te,se)}function U(te){if(te.writing)return;for(let C=te.bufferedIndex;C<te.buffered.length;++C){var se;const{chunk:B,callback:X}=te.buffered[C],ae=te.objectMode?1:B.length;te.length-=ae,X((se=te.errored)!==null&&se!==void 0?se:new _("write"))}const ce=te[I].splice(0);for(let C=0;C<ce.length;C++){var K;ce[C]((K=te.errored)!==null&&K!==void 0?K:new _("end"))}j(te)}function $(te,se){if(se.corked||se.bufferProcessing||se.destroyed||!se.constructed)return;const{buffered:ce,bufferedIndex:K,objectMode:C}=se,B=ce.length-K;if(!B)return;let X=K;if(se.bufferProcessing=!0,B>1&&te._writev){se.pendingcb-=B-1;const ae=se.allNoop?O:be=>{for(let Ne=X;Ne<ce.length;++Ne)ce[Ne].callback(be)},ge=se.allNoop&&X===0?ce:e(ce,X);ge.allBuffers=se.allBuffers,G(te,se,!0,se.length,ge,"",ae),j(se)}else{do{const{chunk:ae,encoding:ge,callback:be}=ce[X];ce[X++]=null;const Ne=C?1:ae.length;G(te,se,!1,Ne,ae,ge,be)}while(X<ce.length&&!se.writing);X===ce.length?j(se):X>256?(ce.splice(0,X),se.bufferedIndex=0):se.bufferedIndex=X}se.bufferProcessing=!1}F.prototype._write=function(te,se,ce){if(this._writev)this._writev([{chunk:te,encoding:se}],ce);else throw new g("_write()")},F.prototype._writev=null,F.prototype.end=function(te,se,ce){const K=this._writableState;typeof te=="function"?(ce=te,te=null,se=null):typeof se=="function"&&(ce=se,se=null);let C;if(te!=null){const B=V(this,te,se);B instanceof r&&(C=B)}return K.corked&&(K.corked=1,this.uncork()),C||(!K.errored&&!K.ending?(K.ending=!0,ue(this,K,!0),K.ended=!0):K.finished?C=new x("end"):K.destroyed&&(C=new _("end"))),typeof ce=="function"&&(C||K.finished?t.nextTick(ce,C):K[I].push(ce)),this};function T(te){return te.ending&&!te.destroyed&&te.constructed&&te.length===0&&!te.errored&&te.buffered.length===0&&!te.finished&&!te.writing&&!te.errorEmitted&&!te.closeEmitted}function z(te,se){let ce=!1;function K(C){if(ce){S(te,C??v());return}if(ce=!0,se.pendingcb--,C){const B=se[I].splice(0);for(let X=0;X<B.length;X++)B[X](C);S(te,C,se.sync)}else T(se)&&(se.prefinished=!0,te.emit("prefinish"),se.pendingcb++,t.nextTick(ye,te,se))}se.sync=!0,se.pendingcb++;try{te._final(K)}catch(C){K(C)}se.sync=!1}function ne(te,se){!se.prefinished&&!se.finalCalled&&(typeof te._final=="function"&&!se.destroyed?(se.finalCalled=!0,z(te,se)):(se.prefinished=!0,te.emit("prefinish")))}function ue(te,se,ce){T(se)&&(ne(te,se),se.pendingcb===0&&(ce?(se.pendingcb++,t.nextTick((K,C)=>{T(C)?ye(K,C):C.pendingcb--},te,se)):T(se)&&(se.pendingcb++,ye(te,se))))}function ye(te,se){se.pendingcb--,se.finished=!0;const ce=se[I].splice(0);for(let K=0;K<ce.length;K++)ce[K]();if(te.emit("finish"),se.autoDestroy){const K=te._readableState;(!K||K.autoDestroy&&(K.endEmitted||K.readable===!1))&&te.destroy()}}i(F.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(te){this._writableState&&(this._writableState.destroyed=te)}},writable:{__proto__:null,get(){const te=this._writableState;return!!te&&te.writable!==!1&&!te.destroyed&&!te.errored&&!te.ending&&!te.ended},set(te){this._writableState&&(this._writableState.writable=!!te)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const te=this._writableState;return te?!te.destroyed&&!te.ending&&te.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const _e=f.destroy;F.prototype.destroy=function(te,se){const ce=this._writableState;return!ce.destroyed&&(ce.bufferedIndex<ce.buffered.length||ce[I].length)&&t.nextTick(U,ce),_e.call(this,te,se),this},F.prototype._undestroy=f.undestroy,F.prototype._destroy=function(te,se){se(te)},F.prototype[u.captureRejectionSymbol]=function(te){this.destroy(te)};let Se;function We(){return Se===void 0&&(Se={}),Se}return F.fromWeb=function(te,se){return We().newStreamWritableFromWritableStream(te,se)},F.toWeb=function(te){return We().newWritableStreamFromStreamWritable(te)},Cv}var kv,RA;function $N(){if(RA)return kv;RA=1;const t=ed,e=As,{isReadable:r,isWritable:n,isIterable:s,isNodeStream:i,isReadableNodeStream:o,isWritableNodeStream:a,isDuplexNodeStream:c}=eu,l=_c,{AbortError:u,codes:{ERR_INVALID_ARG_TYPE:d,ERR_INVALID_RETURN_VALUE:h}}=bi,{destroyer:f}=yf,p=za(),y=Dg(),{createDeferredPromise:b}=Ya,w=TP,g=globalThis.Blob||e.Blob,v=typeof g<"u"?function(S){return S instanceof g}:function(S){return!1},m=globalThis.AbortController||W1().AbortController,{FunctionPrototypeCall:_}=en;class x extends p{constructor(S){super(S),(S==null?void 0:S.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(S==null?void 0:S.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}kv=function A(S,O){if(c(S))return S;if(o(S))return E({readable:S});if(a(S))return E({writable:S});if(i(S))return E({writable:!1,readable:!1});if(typeof S=="function"){const{value:N,write:j,final:F,destroy:V}=D(S);if(s(N))return w(x,N,{objectMode:!0,write:j,final:F,destroy:V});const ee=N==null?void 0:N.then;if(typeof ee=="function"){let G;const Z=_(ee,N,M=>{if(M!=null)throw new h("nully","body",M)},M=>{f(G,M)});return G=new x({objectMode:!0,readable:!1,write:j,final(M){F(async()=>{try{await Z,t.nextTick(M,null)}catch(k){t.nextTick(M,k)}})},destroy:V})}throw new h("Iterable, AsyncIterable or AsyncFunction",O,N)}if(v(S))return A(S.arrayBuffer());if(s(S))return w(x,S,{objectMode:!0,writable:!1});if(typeof(S==null?void 0:S.writable)=="object"||typeof(S==null?void 0:S.readable)=="object"){const N=S!=null&&S.readable?o(S==null?void 0:S.readable)?S==null?void 0:S.readable:A(S.readable):void 0,j=S!=null&&S.writable?a(S==null?void 0:S.writable)?S==null?void 0:S.writable:A(S.writable):void 0;return E({readable:N,writable:j})}const I=S==null?void 0:S.then;if(typeof I=="function"){let N;return _(I,S,j=>{j!=null&&N.push(j),N.push(null)},j=>{f(N,j)}),N=new x({objectMode:!0,writable:!1,read(){}})}throw new d(O,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],S)};function D(A){let{promise:S,resolve:O}=b();const I=new m,N=I.signal;return{value:A(async function*(){for(;;){const F=S;S=null;const{chunk:V,done:ee,cb:G}=await F;if(t.nextTick(G),ee)return;if(N.aborted)throw new u(void 0,{cause:N.reason});({promise:S,resolve:O}=b()),yield V}}(),{signal:N}),write(F,V,ee){const G=O;O=null,G({chunk:F,done:!1,cb:ee})},final(F){const V=O;O=null,V({done:!0,cb:F})},destroy(F,V){I.abort(),V(F)}}}function E(A){const S=A.readable&&typeof A.readable.read!="function"?y.wrap(A.readable):A.readable,O=A.writable;let I=!!r(S),N=!!n(O),j,F,V,ee,G;function Z(M){const k=ee;ee=null,k?k(M):M&&G.destroy(M)}return G=new x({readableObjectMode:!!(S!=null&&S.readableObjectMode),writableObjectMode:!!(O!=null&&O.writableObjectMode),readable:I,writable:N}),N&&(l(O,M=>{N=!1,M&&f(S,M),Z(M)}),G._write=function(M,k,H){O.write(M,k)?H():j=H},G._final=function(M){O.end(),F=M},O.on("drain",function(){if(j){const M=j;j=null,M()}}),O.on("finish",function(){if(F){const M=F;F=null,M()}})),I&&(l(S,M=>{I=!1,M&&f(S,M),Z(M)}),S.on("readable",function(){if(V){const M=V;V=null,M()}}),S.on("end",function(){G.push(null)}),G._read=function(){for(;;){const M=S.read();if(M===null){V=G._read;return}if(!G.push(M))return}}),G._destroy=function(M,k){!M&&ee!==null&&(M=new u),V=null,j=null,F=null,ee===null?k(M):(ee=k,f(O,M),f(S,M))},G}return kv}var Ov,jA;function za(){if(jA)return Ov;jA=1;const{ObjectDefineProperties:t,ObjectGetOwnPropertyDescriptor:e,ObjectKeys:r,ObjectSetPrototypeOf:n}=en;Ov=o;const s=Dg(),i=IP();n(o.prototype,s.prototype),n(o,s);{const u=r(i.prototype);for(let d=0;d<u.length;d++){const h=u[d];o.prototype[h]||(o.prototype[h]=i.prototype[h])}}function o(u){if(!(this instanceof o))return new o(u);s.call(this,u),i.call(this,u),u?(this.allowHalfOpen=u.allowHalfOpen!==!1,u.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),u.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}t(o.prototype,{writable:{__proto__:null,...e(i.prototype,"writable")},writableHighWaterMark:{__proto__:null,...e(i.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...e(i.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...e(i.prototype,"writableBuffer")},writableLength:{__proto__:null,...e(i.prototype,"writableLength")},writableFinished:{__proto__:null,...e(i.prototype,"writableFinished")},writableCorked:{__proto__:null,...e(i.prototype,"writableCorked")},writableEnded:{__proto__:null,...e(i.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...e(i.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(u){this._readableState&&this._writableState&&(this._readableState.destroyed=u,this._writableState.destroyed=u)}}});let a;function c(){return a===void 0&&(a={}),a}o.fromWeb=function(u,d){return c().newStreamDuplexFromReadableWritablePair(u,d)},o.toWeb=function(u){return c().newReadableWritablePairFromDuplex(u)};let l;return o.from=function(u){return l||(l=$N()),l(u,"body")},Ov}const{ObjectSetPrototypeOf:BP,Symbol:xN}=en;var FP=Ha;const{ERR_METHOD_NOT_IMPLEMENTED:DN}=bi.codes,r_=za(),{getHighWaterMark:PN}=e_;BP(Ha.prototype,r_.prototype);BP(Ha,r_);const Jp=xN("kCallback");function Ha(t){if(!(this instanceof Ha))return new Ha(t);const e=t?PN(this,t,"readableHighWaterMark",!0):null;e===0&&(t={...t,highWaterMark:null,readableHighWaterMark:e,writableHighWaterMark:t.writableHighWaterMark||0}),r_.call(this,t),this._readableState.sync=!1,this[Jp]=null,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",CN)}function fb(t){typeof this._flush=="function"&&!this.destroyed?this._flush((e,r)=>{if(e){t?t(e):this.destroy(e);return}r!=null&&this.push(r),this.push(null),t&&t()}):(this.push(null),t&&t())}function CN(){this._final!==fb&&fb.call(this)}Ha.prototype._final=fb;Ha.prototype._transform=function(t,e,r){throw new DN("_transform()")};Ha.prototype._write=function(t,e,r){const n=this._readableState,s=this._writableState,i=n.length;this._transform(t,e,(o,a)=>{if(o){r(o);return}a!=null&&this.push(a),s.ended||i===n.length||n.length<n.highWaterMark?r():this[Jp]=r})};Ha.prototype._read=function(){if(this[Jp]){const t=this[Jp];this[Jp]=null,t()}};const{ObjectSetPrototypeOf:NP}=en;var RP=Zd;const n_=FP;NP(Zd.prototype,n_.prototype);NP(Zd,n_);function Zd(t){if(!(this instanceof Zd))return new Zd(t);n_.call(this,t)}Zd.prototype._transform=function(t,e,r){r(null,t)};const Cp=ed,{ArrayIsArray:kN,Promise:ON,SymbolAsyncIterator:TN}=en,x0=_c,{once:IN}=Ya,BN=yf,MA=za(),{aggregateTwoErrors:FN,codes:{ERR_INVALID_ARG_TYPE:pb,ERR_INVALID_RETURN_VALUE:Tv,ERR_MISSING_ARGS:NN,ERR_STREAM_DESTROYED:RN,ERR_STREAM_PREMATURE_CLOSE:jN},AbortError:MN}=bi,{validateFunction:UN,validateAbortSignal:KN}=wg,{isIterable:tl,isReadable:Iv,isReadableNodeStream:Rm,isNodeStream:UA,isTransformStream:$d,isWebStream:LN,isReadableStream:Bv,isReadableEnded:qN}=eu,VN=globalThis.AbortController||W1().AbortController;let Fv,Nv;function KA(t,e,r){let n=!1;t.on("close",()=>{n=!0});const s=x0(t,{readable:e,writable:r},i=>{n=!i});return{destroy:i=>{n||(n=!0,BN.destroyer(t,i||new RN("pipe")))},cleanup:s}}function zN(t){return UN(t[t.length-1],"streams[stream.length - 1]"),t.pop()}function Rv(t){if(tl(t))return t;if(Rm(t))return HN(t);throw new pb("val",["Readable","Iterable","AsyncIterable"],t)}async function*HN(t){Nv||(Nv=Dg()),yield*Nv.prototype[TN].call(t)}async function By(t,e,r,{end:n}){let s,i=null;const o=l=>{if(l&&(s=l),i){const u=i;i=null,u()}},a=()=>new ON((l,u)=>{s?u(s):i=()=>{s?u(s):l()}});e.on("drain",o);const c=x0(e,{readable:!1},o);try{e.writableNeedDrain&&await a();for await(const l of t)e.write(l)||await a();n&&e.end(),await a(),r()}catch(l){r(s!==l?FN(s,l):l)}finally{c(),e.off("drain",o)}}async function jv(t,e,r,{end:n}){$d(e)&&(e=e.writable);const s=e.getWriter();try{for await(const i of t)await s.ready,s.write(i).catch(()=>{});await s.ready,n&&await s.close(),r()}catch(i){try{await s.abort(i),r(i)}catch(o){r(o)}}}function WN(...t){return jP(t,IN(zN(t)))}function jP(t,e,r){if(t.length===1&&kN(t[0])&&(t=t[0]),t.length<2)throw new NN("streams");const n=new VN,s=n.signal,i=r==null?void 0:r.signal,o=[];KN(i,"options.signal");function a(){f(new MN)}i==null||i.addEventListener("abort",a);let c,l;const u=[];let d=0;function h(w){f(w,--d===0)}function f(w,g){if(w&&(!c||c.code==="ERR_STREAM_PREMATURE_CLOSE")&&(c=w),!(!c&&!g)){for(;u.length;)u.shift()(c);i==null||i.removeEventListener("abort",a),n.abort(),g&&(c||o.forEach(v=>v()),Cp.nextTick(e,c,l))}}let p;for(let w=0;w<t.length;w++){const g=t[w],v=w<t.length-1,m=w>0,_=v||(r==null?void 0:r.end)!==!1,x=w===t.length-1;if(UA(g)){let D=function(E){E&&E.name!=="AbortError"&&E.code!=="ERR_STREAM_PREMATURE_CLOSE"&&h(E)};if(_){const{destroy:E,cleanup:A}=KA(g,v,m);u.push(E),Iv(g)&&x&&o.push(A)}g.on("error",D),Iv(g)&&x&&o.push(()=>{g.removeListener("error",D)})}if(w===0)if(typeof g=="function"){if(p=g({signal:s}),!tl(p))throw new Tv("Iterable, AsyncIterable or Stream","source",p)}else tl(g)||Rm(g)||$d(g)?p=g:p=MA.from(g);else if(typeof g=="function"){if($d(p)){var y;p=Rv((y=p)===null||y===void 0?void 0:y.readable)}else p=Rv(p);if(p=g(p,{signal:s}),v){if(!tl(p,!0))throw new Tv("AsyncIterable",`transform[${w-1}]`,p)}else{var b;Fv||(Fv=RP);const D=new Fv({objectMode:!0}),E=(b=p)===null||b===void 0?void 0:b.then;if(typeof E=="function")d++,E.call(p,O=>{l=O,O!=null&&D.write(O),_&&D.end(),Cp.nextTick(h)},O=>{D.destroy(O),Cp.nextTick(h,O)});else if(tl(p,!0))d++,By(p,D,h,{end:_});else if(Bv(p)||$d(p)){const O=p.readable||p;d++,By(O,D,h,{end:_})}else throw new Tv("AsyncIterable or Promise","destination",p);p=D;const{destroy:A,cleanup:S}=KA(p,!1,!0);u.push(A),x&&o.push(S)}}else if(UA(g)){if(Rm(p)){d+=2;const D=JN(p,g,h,{end:_});Iv(g)&&x&&o.push(D)}else if($d(p)||Bv(p)){const D=p.readable||p;d++,By(D,g,h,{end:_})}else if(tl(p))d++,By(p,g,h,{end:_});else throw new pb("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],p);p=g}else if(LN(g)){if(Rm(p))d++,jv(Rv(p),g,h,{end:_});else if(Bv(p)||tl(p))d++,jv(p,g,h,{end:_});else if($d(p))d++,jv(p.readable,g,h,{end:_});else throw new pb("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],p);p=g}else p=MA.from(g)}return(s!=null&&s.aborted||i!=null&&i.aborted)&&Cp.nextTick(a),p}function JN(t,e,r,{end:n}){let s=!1;if(e.on("close",()=>{s||r(new jN)}),t.pipe(e,{end:!1}),n){let i=function(){s=!0,e.end()};qN(t)?Cp.nextTick(i):t.once("end",i)}else r();return x0(t,{readable:!0,writable:!1},i=>{const o=t._readableState;i&&i.code==="ERR_STREAM_PREMATURE_CLOSE"&&o&&o.ended&&!o.errored&&!o.errorEmitted?t.once("end",r).once("error",r):r(i)}),x0(e,{readable:!1,writable:!0},r)}var i_={pipelineImpl:jP,pipeline:WN};const{pipeline:GN}=i_,Fy=za(),{destroyer:ZN}=yf,{isNodeStream:Ny,isReadable:LA,isWritable:qA,isWebStream:Mv,isTransformStream:Uc,isWritableStream:VA,isReadableStream:zA}=eu,{AbortError:XN,codes:{ERR_INVALID_ARG_VALUE:HA,ERR_MISSING_ARGS:YN}}=bi,QN=_c;var MP=function(...e){if(e.length===0)throw new YN("streams");if(e.length===1)return Fy.from(e[0]);const r=[...e];if(typeof e[0]=="function"&&(e[0]=Fy.from(e[0])),typeof e[e.length-1]=="function"){const f=e.length-1;e[f]=Fy.from(e[f])}for(let f=0;f<e.length;++f)if(!(!Ny(e[f])&&!Mv(e[f]))){if(f<e.length-1&&!(LA(e[f])||zA(e[f])||Uc(e[f])))throw new HA(`streams[${f}]`,r[f],"must be readable");if(f>0&&!(qA(e[f])||VA(e[f])||Uc(e[f])))throw new HA(`streams[${f}]`,r[f],"must be writable")}let n,s,i,o,a;function c(f){const p=o;o=null,p?p(f):f?a.destroy(f):!h&&!d&&a.destroy()}const l=e[0],u=GN(e,c),d=!!(qA(l)||VA(l)||Uc(l)),h=!!(LA(u)||zA(u)||Uc(u));if(a=new Fy({writableObjectMode:!!(l!=null&&l.writableObjectMode),readableObjectMode:!!(u!=null&&u.writableObjectMode),writable:d,readable:h}),d){if(Ny(l))a._write=function(p,y,b){l.write(p,y)?b():n=b},a._final=function(p){l.end(),s=p},l.on("drain",function(){if(n){const p=n;n=null,p()}});else if(Mv(l)){const y=(Uc(l)?l.writable:l).getWriter();a._write=async function(b,w,g){try{await y.ready,y.write(b).catch(()=>{}),g()}catch(v){g(v)}},a._final=async function(b){try{await y.ready,y.close().catch(()=>{}),s=b}catch(w){b(w)}}}const f=Uc(u)?u.readable:u;QN(f,()=>{if(s){const p=s;s=null,p()}})}if(h){if(Ny(u))u.on("readable",function(){if(i){const f=i;i=null,f()}}),u.on("end",function(){a.push(null)}),a._read=function(){for(;;){const f=u.read();if(f===null){i=a._read;return}if(!a.push(f))return}};else if(Mv(u)){const p=(Uc(u)?u.readable:u).getReader();a._read=async function(){for(;;)try{const{value:y,done:b}=await p.read();if(!a.push(y))return;if(b){a.push(null);return}}catch{return}}}}return a._destroy=function(f,p){!f&&o!==null&&(f=new XN),i=null,n=null,s=null,o===null?p(f):(o=p,Ny(u)&&ZN(u,f))},a};const UP=globalThis.AbortController||W1().AbortController,{codes:{ERR_INVALID_ARG_VALUE:e4,ERR_INVALID_ARG_TYPE:Jh,ERR_MISSING_ARGS:t4,ERR_OUT_OF_RANGE:r4},AbortError:Ko}=bi,{validateAbortSignal:td,validateInteger:n4,validateObject:rd}=wg,i4=en.Symbol("kWeak"),{finished:s4}=_c,o4=MP,{addAbortSignalNoValidate:a4}=xg,{isWritable:u4,isNodeStream:c4}=eu,{ArrayPrototypePush:l4,MathFloor:d4,Number:f4,NumberIsNaN:p4,Promise:WA,PromiseReject:JA,PromisePrototypeThen:h4,Symbol:KP}=en,D0=KP("kEmpty"),GA=KP("kEof");function y4(t,e){if(e!=null&&rd(e,"options"),(e==null?void 0:e.signal)!=null&&td(e.signal,"options.signal"),c4(t)&&!u4(t))throw new e4("stream",t,"must be writable");const r=o4(this,t);return e!=null&&e.signal&&a4(e.signal,r),r}function Pg(t,e){if(typeof t!="function")throw new Jh("fn",["Function","AsyncFunction"],t);e!=null&&rd(e,"options"),(e==null?void 0:e.signal)!=null&&td(e.signal,"options.signal");let r=1;return(e==null?void 0:e.concurrency)!=null&&(r=d4(e.concurrency)),n4(r,"concurrency",1),(async function*(){var s,i;const o=new UP,a=this,c=[],l=o.signal,u={signal:l},d=()=>o.abort();e!=null&&(s=e.signal)!==null&&s!==void 0&&s.aborted&&d(),e==null||(i=e.signal)===null||i===void 0||i.addEventListener("abort",d);let h,f,p=!1;function y(){p=!0}async function b(){try{for await(let v of a){var w;if(p)return;if(l.aborted)throw new Ko;try{v=t(v,u)}catch(m){v=JA(m)}v!==D0&&(typeof((w=v)===null||w===void 0?void 0:w.catch)=="function"&&v.catch(y),c.push(v),h&&(h(),h=null),!p&&c.length&&c.length>=r&&await new WA(m=>{f=m}))}c.push(GA)}catch(v){const m=JA(v);h4(m,void 0,y),c.push(m)}finally{var g;p=!0,h&&(h(),h=null),e==null||(g=e.signal)===null||g===void 0||g.removeEventListener("abort",d)}}b();try{for(;;){for(;c.length>0;){const w=await c[0];if(w===GA)return;if(l.aborted)throw new Ko;w!==D0&&(yield w),c.shift(),f&&(f(),f=null)}await new WA(w=>{h=w})}}finally{o.abort(),p=!0,f&&(f(),f=null)}}).call(this)}function m4(t=void 0){return t!=null&&rd(t,"options"),(t==null?void 0:t.signal)!=null&&td(t.signal,"options.signal"),(async function*(){let r=0;for await(const s of this){var n;if(t!=null&&(n=t.signal)!==null&&n!==void 0&&n.aborted)throw new Ko({cause:t.signal.reason});yield[r++,s]}}).call(this)}async function LP(t,e=void 0){for await(const r of s_.call(this,t,e))return!0;return!1}async function g4(t,e=void 0){if(typeof t!="function")throw new Jh("fn",["Function","AsyncFunction"],t);return!await LP.call(this,async(...r)=>!await t(...r),e)}async function v4(t,e){for await(const r of s_.call(this,t,e))return r}async function w4(t,e){if(typeof t!="function")throw new Jh("fn",["Function","AsyncFunction"],t);async function r(n,s){return await t(n,s),D0}for await(const n of Pg.call(this,r,e));}function s_(t,e){if(typeof t!="function")throw new Jh("fn",["Function","AsyncFunction"],t);async function r(n,s){return await t(n,s)?n:D0}return Pg.call(this,r,e)}class b4 extends t4{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function _4(t,e,r){var n;if(typeof t!="function")throw new Jh("reducer",["Function","AsyncFunction"],t);r!=null&&rd(r,"options"),(r==null?void 0:r.signal)!=null&&td(r.signal,"options.signal");let s=arguments.length>1;if(r!=null&&(n=r.signal)!==null&&n!==void 0&&n.aborted){const l=new Ko(void 0,{cause:r.signal.reason});throw this.once("error",()=>{}),await s4(this.destroy(l)),l}const i=new UP,o=i.signal;if(r!=null&&r.signal){const l={once:!0,[i4]:this};r.signal.addEventListener("abort",()=>i.abort(),l)}let a=!1;try{for await(const l of this){var c;if(a=!0,r!=null&&(c=r.signal)!==null&&c!==void 0&&c.aborted)throw new Ko;s?e=await t(e,l,{signal:o}):(e=l,s=!0)}if(!a&&!s)throw new b4}finally{i.abort()}return e}async function E4(t){t!=null&&rd(t,"options"),(t==null?void 0:t.signal)!=null&&td(t.signal,"options.signal");const e=[];for await(const n of this){var r;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted)throw new Ko(void 0,{cause:t.signal.reason});l4(e,n)}return e}function A4(t,e){const r=Pg.call(this,t,e);return(async function*(){for await(const s of r)yield*s}).call(this)}function qP(t){if(t=f4(t),p4(t))return 0;if(t<0)throw new r4("number",">= 0",t);return t}function S4(t,e=void 0){return e!=null&&rd(e,"options"),(e==null?void 0:e.signal)!=null&&td(e.signal,"options.signal"),t=qP(t),(async function*(){var n;if(e!=null&&(n=e.signal)!==null&&n!==void 0&&n.aborted)throw new Ko;for await(const i of this){var s;if(e!=null&&(s=e.signal)!==null&&s!==void 0&&s.aborted)throw new Ko;t--<=0&&(yield i)}}).call(this)}function $4(t,e=void 0){return e!=null&&rd(e,"options"),(e==null?void 0:e.signal)!=null&&td(e.signal,"options.signal"),t=qP(t),(async function*(){var n;if(e!=null&&(n=e.signal)!==null&&n!==void 0&&n.aborted)throw new Ko;for await(const i of this){var s;if(e!=null&&(s=e.signal)!==null&&s!==void 0&&s.aborted)throw new Ko;if(t-- >0)yield i;else return}}).call(this)}H1.streamReturningOperators={asIndexedPairs:m4,drop:S4,filter:s_,flatMap:A4,map:Pg,take:$4,compose:y4};H1.promiseReturningOperators={every:g4,forEach:w4,reduce:_4,toArray:E4,some:LP,find:v4};var Uv,ZA;function VP(){if(ZA)return Uv;ZA=1;const{ArrayPrototypePop:t,Promise:e}=en,{isIterable:r,isNodeStream:n,isWebStream:s}=eu,{pipelineImpl:i}=i_,{finished:o}=_c;zP();function a(...c){return new e((l,u)=>{let d,h;const f=c[c.length-1];if(f&&typeof f=="object"&&!n(f)&&!r(f)&&!s(f)){const p=t(c);d=p.signal,h=p.end}i(c,(p,y)=>{p?u(p):l(y)},{signal:d,end:h})})}return Uv={finished:o,pipeline:a},Uv}var XA;function zP(){if(XA)return Av.exports;XA=1;const{Buffer:t}=As,{ObjectDefineProperty:e,ObjectKeys:r,ReflectApply:n}=en,{promisify:{custom:s}}=Ya,{streamReturningOperators:i,promiseReturningOperators:o}=H1,{codes:{ERR_ILLEGAL_CONSTRUCTOR:a}}=bi,c=MP,{pipeline:l}=i_,{destroyer:u}=yf,d=_c,h=VP(),f=eu,p=Av.exports=Q1.Stream;p.isDisturbed=f.isDisturbed,p.isErrored=f.isErrored,p.isReadable=f.isReadable,p.Readable=Dg();for(const b of r(i)){let g=function(...v){if(new.target)throw a();return p.Readable.from(n(w,this,v))};const w=i[b];e(g,"name",{__proto__:null,value:w.name}),e(g,"length",{__proto__:null,value:w.length}),e(p.Readable.prototype,b,{__proto__:null,value:g,enumerable:!1,configurable:!0,writable:!0})}for(const b of r(o)){let g=function(...v){if(new.target)throw a();return n(w,this,v)};const w=o[b];e(g,"name",{__proto__:null,value:w.name}),e(g,"length",{__proto__:null,value:w.length}),e(p.Readable.prototype,b,{__proto__:null,value:g,enumerable:!1,configurable:!0,writable:!0})}p.Writable=IP(),p.Duplex=za(),p.Transform=FP,p.PassThrough=RP,p.pipeline=l;const{addAbortSignal:y}=xg;return p.addAbortSignal=y,p.finished=d,p.destroy=u,p.compose=c,e(p,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return h}}),e(l,s,{__proto__:null,enumerable:!0,get(){return h.pipeline}}),e(d,s,{__proto__:null,enumerable:!0,get(){return h.finished}}),p.Stream=p,p._isUint8Array=function(w){return w instanceof Uint8Array},p._uint8ArrayToBuffer=function(w){return t.from(w.buffer,w.byteOffset,w.byteLength)},Av.exports}(function(t){const e=zP(),r=VP(),n=e.Readable.destroy;t.exports=e.Readable,t.exports._uint8ArrayToBuffer=e._uint8ArrayToBuffer,t.exports._isUint8Array=e._isUint8Array,t.exports.isDisturbed=e.isDisturbed,t.exports.isErrored=e.isErrored,t.exports.isReadable=e.isReadable,t.exports.Readable=e.Readable,t.exports.Writable=e.Writable,t.exports.Duplex=e.Duplex,t.exports.Transform=e.Transform,t.exports.PassThrough=e.PassThrough,t.exports.addAbortSignal=e.addAbortSignal,t.exports.finished=e.finished,t.exports.destroy=e.destroy,t.exports.destroy=n,t.exports.pipeline=e.pipeline,t.exports.compose=e.compose,Object.defineProperty(e,"promises",{configurable:!0,enumerable:!0,get(){return r}}),t.exports.Stream=e.Stream,t.exports.default=t.exports})(oF);function x4(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var y=0,b=0,w=0,g=p.length;w!==g&&p[w]===0;)w++,y++;for(var v=(g-w)*u+1>>>0,m=new Uint8Array(v);w!==g;){for(var _=p[w],x=0,D=v-1;(_!==0||x<b)&&D!==-1;D--,x++)_+=256*m[D]>>>0,m[D]=_%a>>>0,_=_/a>>>0;if(_!==0)throw new Error("Non-zero carry");b=x,w++}for(var E=v-b;E!==v&&m[E]===0;)E++;for(var A=c.repeat(y);E<v;++E)A+=t.charAt(m[E]);return A}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var y=0;if(p[y]!==" "){for(var b=0,w=0;p[y]===c;)b++,y++;for(var g=(p.length-y)*l+1>>>0,v=new Uint8Array(g);p[y];){var m=r[p.charCodeAt(y)];if(m===255)return;for(var _=0,x=g-1;(m!==0||_<w)&&x!==-1;x--,_++)m+=a*v[x]>>>0,v[x]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");w=_,y++}if(p[y]!==" "){for(var D=g-w;D!==g&&v[D]===0;)D++;for(var E=new Uint8Array(b+(g-D)),A=b;D!==g;)E[A++]=v[D++];return E}}}function f(p){var y=h(p);if(y)return y;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var D4=x4,P4=D4;const C4=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};let k4=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},O4=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return HP(this,e)}},T4=class{constructor(e){this.decoders=e}or(e){return HP(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const HP=(t,e)=>new T4({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let I4=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new k4(e,r,n),this.decoder=new O4(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const WP=({name:t,prefix:e,encode:r,decode:n})=>new I4(t,e,r,n),JP=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:s}=P4(r,e);return WP({prefix:t,name:e,encode:n,decode:i=>C4(s(i))})},B4=(t,e,r,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},F4=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},Ri=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>WP({prefix:e,name:t,encode(s){return F4(s,n,r)},decode(s){return B4(s,n,r,t)}});Ri({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});Ri({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});Ri({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});Ri({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});Ri({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});Ri({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});Ri({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});Ri({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});const YA=Ri({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Ry=JP({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});JP({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});Ri({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});Ri({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const aa=Ri({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});Ri({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function N4(t){return t.byteOffset!==0||t.byteLength!==t.buffer.byteLength}function R4(t){return typeof t!="object"||t===null?!1:typeof t[Symbol.asyncIterator]=="function"}function QA(t){const r=Object.prototype.toString.call(t).match(/\s([a-zA-Z0-9]+)/),[n,s]=r;return s}var Kf=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},eS=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}};const jy=new TextEncoder,Kc=new TextDecoder;let Lt=class ni{constructor(e,r){this.data=e,this.format=r}static arrayBuffer(e){return new ni(e,"ArrayBuffer")}static asyncIterable(e){if(!R4(e))throw new TypeError("Input must be of type AsyncIterable.");return new ni(e,"AsyncIterable")}static base32Z(e){return new ni(e,"Base32Z")}static base58Btc(e){return new ni(e,"Base58Btc")}static base64Url(e){return new ni(e,"Base64Url")}static bufferSource(e){return new ni(e,"BufferSource")}static hex(e){if(typeof e!="string")throw new TypeError("Hex input must be a string.");if(e.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new ni(e,"Hex")}static multibase(e){return new ni(e,"Multibase")}static object(e){return new ni(e,"Object")}static string(e){return new ni(e,"String")}static uint8Array(e){return new ni(e,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return Ry.baseDecode(this.data).buffer;case"Base64Url":return aa.baseDecode(this.data).buffer;case"BufferSource":{if(QA(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return N4(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return Kf(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return YA.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return Ry.baseEncode(e)}case"Multibase":return this.data.substring(1);case"Uint8Array":return Ry.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return aa.baseEncode(e)}case"BufferSource":{const e=this.toUint8Array();return aa.baseEncode(e)}case"Object":{const e=JSON.stringify(this.data),r=jy.encode(e);return aa.baseEncode(r)}case"String":{const e=jy.encode(this.data);return aa.baseEncode(e)}case"Uint8Array":return aa.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){var e,r,n,s;return Kf(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const c=[];try{for(var i=!0,o=eS(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const u=s;c.push(u)}}catch(u){r={error:u}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return new Blob(c)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){const e=Array.from({length:256},(r,n)=>n.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{const r=this.toUint8Array();return ni.uint8Array(r).toHex()}case"Base64Url":{const r=this.toUint8Array();return ni.uint8Array(r).toHex()}case"Uint8Array":{let r="";for(let n=0;n<this.data.length;n++)r+=e[this.data[n]];return r}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{const e=aa.baseDecode(this.data),r=Kc.decode(e);return JSON.parse(r)}case"String":return JSON.parse(this.data);case"Uint8Array":{const e=Kc.decode(this.data);return JSON.parse(e)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return Kf(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toStringAsync();return JSON.parse(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return Kc.decode(this.data);case"Base64Url":{const e=aa.baseDecode(this.data);return Kc.decode(e)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return Kc.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){var e,r,n,s;return Kf(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let c="";try{for(var i=!0,o=eS(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const l=s;typeof l=="string"?c+=l:c+=Kc.decode(l,{stream:!0})}}catch(l){r={error:l}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return c+=Kc.decode(void 0,{stream:!1}),c}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return YA.baseDecode(this.data);case"Base58Btc":return Ry.baseDecode(this.data);case"Base64Url":return aa.baseDecode(this.data);case"BufferSource":{const e=QA(this.data);if(e==="Uint8Array")return this.data;if(e==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{const e=new Uint8Array(this.data.length/2);for(let r=0;r<this.data.length;r+=2){const n=parseInt(this.data.substring(r,r+2),16);if(isNaN(n))throw new TypeError("Input is not a valid hexadecimal string.");e[r/2]=n}return e}case"Object":{const e=JSON.stringify(this.data);return jy.encode(e)}case"String":return jy.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return Kf(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toArrayBufferAsync();return new Uint8Array(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}};var j4=GP,tS=128,M4=127,U4=~M4,K4=Math.pow(2,31);function GP(t,e,r){e=e||[],r=r||0;for(var n=r;t>=K4;)e[r++]=t&255|tS,t/=128;for(;t&U4;)e[r++]=t&255|tS,t>>>=7;return e[r]=t|0,GP.bytes=r-n+1,e}var L4=hb,q4=128,rS=127;function hb(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw hb.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&rS)<<s:(o&rS)*Math.pow(2,s),s+=7}while(o>=q4);return hb.bytes=i-n,r}var V4=Math.pow(2,7),z4=Math.pow(2,14),H4=Math.pow(2,21),W4=Math.pow(2,28),J4=Math.pow(2,35),G4=Math.pow(2,42),Z4=Math.pow(2,49),X4=Math.pow(2,56),Y4=Math.pow(2,63),Q4=function(t){return t<V4?1:t<z4?2:t<H4?3:t<W4?4:t<J4?5:t<G4?6:t<Z4?7:t<X4?8:t<Y4?9:10},eR={encode:j4,decode:L4,encodingLength:Q4},P0=eR;const nS=(t,e=0)=>[P0.decode(t,e),P0.decode.bytes],tR=(t,e,r=0)=>(P0.encode(t,e,r),e),rR=t=>P0.encodingLength(t);let Ec=class Tu{static addPrefix(e){var r;let{code:n,data:s,name:i}=e;if(!(i?!n:n))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(n=Tu.codeToName.has(n)?n:Tu.nameToCode.get(i),n===void 0)throw new Error(`Unsupported multicodec: ${(r=e.name)!==null&&r!==void 0?r:e.code}`);const o=rR(n),a=new Uint8Array(o+s.byteLength);return a.set(s,o),tR(n,a),a}static getCodeFromData(e){const{prefixedData:r}=e,[n,s]=nS(r);return n}static getCodeFromName(e){const{name:r}=e,n=Tu.nameToCode.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static getNameFromCode(e){const{code:r}=e,n=Tu.codeToName.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static registerCodec(e){Tu.codeToName.set(e.code,e.name),Tu.nameToCode.set(e.name,e.code)}static removePrefix(e){const{prefixedData:r}=e,[n,s]=nS(r),i=Tu.codeToName.get(n);if(i===void 0)throw new Error(`Unsupported multicodec: ${n}`);return{code:n,data:r.slice(s),name:i}}};Ec.codeToName=new Map;Ec.nameToCode=new Map;Ec.registerCodec({code:237,name:"ed25519-pub"});Ec.registerCodec({code:4864,name:"ed25519-priv"});Ec.registerCodec({code:236,name:"x25519-pub"});Ec.registerCodec({code:4866,name:"x25519-priv"});Ec.registerCodec({code:231,name:"secp256k1-pub"});Ec.registerCodec({code:4865,name:"secp256k1-priv"});function ZP(t){Object.keys(t).forEach(e=>{t[e]===void 0?delete t[e]:typeof t[e]=="object"&&ZP(t[e])})}var Lc=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let nR=class{constructor(){this.store=new Map}clear(){return Lc(this,void 0,void 0,function*(){this.store.clear()})}close(){return Lc(this,void 0,void 0,function*(){})}delete(e){return Lc(this,void 0,void 0,function*(){return this.store.delete(e)})}get(e){return Lc(this,void 0,void 0,function*(){return this.store.get(e)})}has(e){return Lc(this,void 0,void 0,function*(){return this.store.has(e)})}list(){return Lc(this,void 0,void 0,function*(){return Array.from(this.store.values())})}set(e,r){return Lc(this,void 0,void 0,function*(){this.store.set(e,r)})}};function iR(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function XP(t,...e){if(!iR(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function iS(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function sR(t,e){XP(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const Kv=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Lv=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),io=(t,e)=>t<<32-e|t>>>e;new Uint8Array(new Uint32Array([287454020]).buffer)[0];function oR(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function YP(t){return typeof t=="string"&&(t=oR(t)),XP(t),t}let aR=class{clone(){return this._cloneInto()}};function uR(t){const e=n=>t().update(YP(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function cR(t=32){if(Kv&&typeof Kv.getRandomValues=="function")return Kv.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function lR(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),c=n?4:0,l=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+l,a,n)}const dR=(t,e,r)=>t&e^~t&r,fR=(t,e,r)=>t&e^t&r^e&r;let pR=class extends aR{constructor(e,r,n,s){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Lv(this.buffer)}update(e){iS(this);const{view:r,buffer:n,blockLen:s}=this;e=YP(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Lv(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){iS(this),sR(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)r[d]=0;lR(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=Lv(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%r&&e.buffer.set(n),e}};const hR=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),cu=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),lu=new Uint32Array(64);let yR=class extends pR{constructor(){super(64,32,8,!1),this.A=cu[0]|0,this.B=cu[1]|0,this.C=cu[2]|0,this.D=cu[3]|0,this.E=cu[4]|0,this.F=cu[5]|0,this.G=cu[6]|0,this.H=cu[7]|0}get(){const{A:e,B:r,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,r,n,s,i,o,a,c]}set(e,r,n,s,i,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let d=0;d<16;d++,r+=4)lu[d]=e.getUint32(r,!1);for(let d=16;d<64;d++){const h=lu[d-15],f=lu[d-2],p=io(h,7)^io(h,18)^h>>>3,y=io(f,17)^io(f,19)^f>>>10;lu[d]=y+lu[d-7]+p+lu[d-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=io(a,6)^io(a,11)^io(a,25),f=u+h+dR(a,c,l)+hR[d]+lu[d]|0,y=(io(n,2)^io(n,13)^io(n,22))+fR(n,s,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=s,s=n,n=f+y|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,s,i,o,a,c,l,u)}roundClean(){lu.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const yh=uR(()=>new yR);var mR=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let QP=class{static digest(e){return mR(this,arguments,void 0,function*({data:r}){return yh(r)})}},o_=class{};var gR=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let vR=class extends o_{digest(e){return gR(this,arguments,void 0,function*({algorithm:r,data:n}){switch(r){case"SHA-256":return yield QP.digest({data:n})}})}};/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const eC=BigInt(0),Cg=BigInt(1),wR=BigInt(2);function Lo(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}const bR=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Kl(t){if(!Lo(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=bR[t[r]];return e}function tC(t){const e=t.toString(16);return e.length&1?`0${e}`:e}function a_(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}const ua={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function sS(t){if(t>=ua._0&&t<=ua._9)return t-ua._0;if(t>=ua._A&&t<=ua._F)return t-(ua._A-10);if(t>=ua._a&&t<=ua._f)return t-(ua._a-10)}function Xd(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let s=0,i=0;s<r;s++,i+=2){const o=sS(t.charCodeAt(i)),a=sS(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function Pl(t){return a_(Kl(t))}function oc(t){if(!Lo(t))throw new Error("Uint8Array expected");return a_(Kl(Uint8Array.from(t).reverse()))}function fr(t,e){return Xd(t.toString(16).padStart(e*2,"0"))}function Yd(t,e){return fr(t,e).reverse()}function _R(t){return Xd(tC(t))}function Nr(t,e,r){let n;if(typeof e=="string")try{n=Xd(e)}catch(i){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${i}`)}else if(Lo(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);const s=n.length;if(typeof r=="number"&&s!==r)throw new Error(`${t} expected ${r} bytes, got ${s}`);return n}function Ll(...t){let e=0;for(let s=0;s<t.length;s++){const i=t[s];if(!Lo(i))throw new Error("Uint8Array expected");e+=i.length}let r=new Uint8Array(e),n=0;for(let s=0;s<t.length;s++){const i=t[s];r.set(i,n),n+=i.length}return r}function ER(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}function AR(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function SR(t){let e;for(e=0;t>eC;t>>=Cg,e+=1);return e}function $R(t,e){return t>>BigInt(e)&Cg}const xR=(t,e,r)=>t|(r?Cg:eC)<<BigInt(e),u_=t=>(wR<<BigInt(t-1))-Cg,qv=t=>new Uint8Array(t),oS=t=>Uint8Array.from(t);function rC(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=qv(t),s=qv(t),i=0;const o=()=>{n.fill(1),s.fill(0),i=0},a=(...d)=>r(s,n,...d),c=(d=qv())=>{s=a(oS([0]),d),n=a(),d.length!==0&&(s=a(oS([1]),d),n=a())},l=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let d=0;const h=[];for(;d<e;){n=a();const f=n.slice();h.push(f),d+=n.length}return Ll(...h)};return(d,h)=>{o(),c(d);let f;for(;!(f=h(l()));)c();return o(),f}}const DR={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Lo(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function nd(t,e,r={}){const n=(s,i,o)=>{const a=DR[i];if(typeof a!="function")throw new Error(`Invalid validator "${i}", expected function`);const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error(`Invalid param ${String(s)}=${c} (${typeof c}), expected ${i}`)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(r))n(s,i,!0);return t}const PR=Object.freeze(Object.defineProperty({__proto__:null,bitGet:$R,bitLen:SR,bitMask:u_,bitSet:xR,bytesToHex:Kl,bytesToNumberBE:Pl,bytesToNumberLE:oc,concatBytes:Ll,createHmacDrbg:rC,ensureBytes:Nr,equalBytes:ER,hexToBytes:Xd,hexToNumber:a_,isBytes:Lo,numberToBytesBE:fr,numberToBytesLE:Yd,numberToHexUnpadded:tC,numberToVarBytesBE:_R,utf8ToBytes:AR,validateObject:nd},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const fn=BigInt(0),$r=BigInt(1),fl=BigInt(2),CR=BigInt(3),yb=BigInt(4),aS=BigInt(5),uS=BigInt(8);BigInt(9);BigInt(16);function dr(t,e){const r=t%e;return r>=fn?r:e+r}function nC(t,e,r){if(r<=fn||e<fn)throw new Error("Expected power/modulo > 0");if(r===$r)return fn;let n=$r;for(;e>fn;)e&$r&&(n=n*t%r),t=t*t%r,e>>=$r;return n}function Ar(t,e,r){let n=t;for(;e-- >fn;)n*=n,n%=r;return n}function mb(t,e){if(t===fn||e<=fn)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=dr(t,e),n=e,s=fn,i=$r;for(;r!==fn;){const a=n/r,c=n%r,l=s-i*a;n=r,r=c,s=i,i=l}if(n!==$r)throw new Error("invert: does not exist");return dr(s,e)}function kR(t){const e=(t-$r)/fl;let r,n,s;for(r=t-$r,n=0;r%fl===fn;r/=fl,n++);for(s=fl;s<t&&nC(s,e,t)!==t-$r;s++);if(n===1){const o=(t+$r)/yb;return function(c,l){const u=c.pow(l,o);if(!c.eql(c.sqr(u),l))throw new Error("Cannot find square root");return u}}const i=(r+$r)/fl;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let l=n,u=a.pow(a.mul(a.ONE,s),r),d=a.pow(c,i),h=a.pow(c,r);for(;!a.eql(h,a.ONE);){if(a.eql(h,a.ZERO))return a.ZERO;let f=1;for(let y=a.sqr(h);f<l&&!a.eql(y,a.ONE);f++)y=a.sqr(y);const p=a.pow(u,$r<<BigInt(l-f-1));u=a.sqr(p),d=a.mul(d,p),h=a.mul(h,u),l=f}return d}}function OR(t){if(t%yb===CR){const e=(t+$r)/yb;return function(n,s){const i=n.pow(s,e);if(!n.eql(n.sqr(i),s))throw new Error("Cannot find square root");return i}}if(t%uS===aS){const e=(t-aS)/uS;return function(n,s){const i=n.mul(s,fl),o=n.pow(i,e),a=n.mul(s,o),c=n.mul(n.mul(a,fl),o),l=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(l),s))throw new Error("Cannot find square root");return l}}return kR(t)}const TR=(t,e)=>(dr(t,e)&$r)===$r,IR=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function BR(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=IR.reduce((n,s)=>(n[s]="function",n),e);return nd(t,r)}function FR(t,e,r){if(r<fn)throw new Error("Expected power > 0");if(r===fn)return t.ONE;if(r===$r)return e;let n=t.ONE,s=e;for(;r>fn;)r&$r&&(n=t.mul(n,s)),s=t.sqr(s),r>>=$r;return n}function NR(t,e){const r=new Array(e.length),n=e.reduce((i,o,a)=>t.is0(o)?i:(r[a]=i,t.mul(i,o)),t.ONE),s=t.inv(n);return e.reduceRight((i,o,a)=>t.is0(o)?i:(r[a]=t.mul(i,r[a]),t.mul(i,o)),s),r}function iC(t,e){const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function c_(t,e,r=!1,n={}){if(t<=fn)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:s,nByteLength:i}=iC(t,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const o=OR(t),a=Object.freeze({ORDER:t,BITS:s,BYTES:i,MASK:u_(s),ZERO:fn,ONE:$r,create:c=>dr(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return fn<=c&&c<t},is0:c=>c===fn,isOdd:c=>(c&$r)===$r,neg:c=>dr(-c,t),eql:(c,l)=>c===l,sqr:c=>dr(c*c,t),add:(c,l)=>dr(c+l,t),sub:(c,l)=>dr(c-l,t),mul:(c,l)=>dr(c*l,t),pow:(c,l)=>FR(a,c,l),div:(c,l)=>dr(c*mb(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>mb(c,t),sqrt:n.sqrt||(c=>o(a,c)),invertBatch:c=>NR(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>r?Yd(c,i):fr(c,i),fromBytes:c=>{if(c.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${c.length}`);return r?oc(c):Pl(c)}});return Object.freeze(a)}function RR(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");const r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r}function sC(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function oC(t){const e=sC(t);return e+Math.ceil(e/2)}function jR(t,e,r=!1){const n=t.length,s=sC(e),i=oC(e);if(n<16||n<i||n>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${n}`);const o=r?Pl(t):oc(t),a=dr(o,e-$r)+$r;return r?Yd(a,s):fr(a,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const MR=BigInt(0),Vv=BigInt(1);function aC(t,e){const r=(s,i)=>{const o=i.negate();return s?o:i},n=s=>{const i=Math.ceil(e/s)+1,o=2**(s-1);return{windows:i,windowSize:o}};return{constTimeNegate:r,unsafeLadder(s,i){let o=t.ZERO,a=s;for(;i>MR;)i&Vv&&(o=o.add(a)),a=a.double(),i>>=Vv;return o},precomputeWindow(s,i){const{windows:o,windowSize:a}=n(i),c=[];let l=s,u=l;for(let d=0;d<o;d++){u=l,c.push(u);for(let h=1;h<a;h++)u=u.add(l),c.push(u);l=u.double()}return c},wNAF(s,i,o){const{windows:a,windowSize:c}=n(s);let l=t.ZERO,u=t.BASE;const d=BigInt(2**s-1),h=2**s,f=BigInt(s);for(let p=0;p<a;p++){const y=p*c;let b=Number(o&d);o>>=f,b>c&&(b-=h,o+=Vv);const w=y,g=y+Math.abs(b)-1,v=p%2!==0,m=b<0;b===0?u=u.add(r(v,i[w])):l=l.add(r(m,i[g]))}return{p:l,f:u}},wNAFCached(s,i,o,a){const c=s._WINDOW_SIZE||1;let l=i.get(s);return l||(l=this.precomputeWindow(s,c),c!==1&&i.set(s,a(l))),this.wNAF(c,l,o)}}}function l_(t){return BR(t.Fp),nd(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...iC(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function UR(t){const e=l_(t);nd(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:s}=e;if(r){if(!n.eql(s,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:KR,hexToBytes:LR}=PR,_l={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){const{Err:e}=_l;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");const r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:KR(n),l:t.subarray(r+2)}},toSig(t){const{Err:e}=_l,r=typeof t=="string"?LR(t):t;if(!Lo(r))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");const{d:s,l:i}=_l._parseInt(r.subarray(2)),{d:o,l:a}=_l._parseInt(i);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:s,s:o}},hexFromSig(t){const e=l=>Number.parseInt(l[0],16)&8?"00"+l:l,r=l=>{const u=l.toString(16);return u.length&1?`0${u}`:u},n=e(r(t.s)),s=e(r(t.r)),i=n.length/2,o=s.length/2,a=r(i),c=r(o);return`30${r(o+i+4)}02${c}${s}02${a}${n}`}},Ra=BigInt(0),as=BigInt(1);BigInt(2);const cS=BigInt(3);BigInt(4);function qR(t){const e=UR(t),{Fp:r}=e,n=e.toBytes||((p,y,b)=>{const w=y.toAffine();return Ll(Uint8Array.from([4]),r.toBytes(w.x),r.toBytes(w.y))}),s=e.fromBytes||(p=>{const y=p.subarray(1),b=r.fromBytes(y.subarray(0,r.BYTES)),w=r.fromBytes(y.subarray(r.BYTES,2*r.BYTES));return{x:b,y:w}});function i(p){const{a:y,b}=e,w=r.sqr(p),g=r.mul(w,p);return r.add(r.add(g,r.mul(p,y)),b)}if(!r.eql(r.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function o(p){return typeof p=="bigint"&&Ra<p&&p<e.n}function a(p){if(!o(p))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(p){const{allowedPrivateKeyLengths:y,nByteLength:b,wrapPrivateKey:w,n:g}=e;if(y&&typeof p!="bigint"){if(Lo(p)&&(p=Kl(p)),typeof p!="string"||!y.includes(p.length))throw new Error("Invalid key");p=p.padStart(b*2,"0")}let v;try{v=typeof p=="bigint"?p:Pl(Nr("private key",p,b))}catch{throw new Error(`private key must be ${b} bytes, hex or bigint, not ${typeof p}`)}return w&&(v=dr(v,g)),a(v),v}const l=new Map;function u(p){if(!(p instanceof d))throw new Error("ProjectivePoint expected")}class d{constructor(y,b,w){if(this.px=y,this.py=b,this.pz=w,y==null||!r.isValid(y))throw new Error("x required");if(b==null||!r.isValid(b))throw new Error("y required");if(w==null||!r.isValid(w))throw new Error("z required")}static fromAffine(y){const{x:b,y:w}=y||{};if(!y||!r.isValid(b)||!r.isValid(w))throw new Error("invalid affine point");if(y instanceof d)throw new Error("projective point not allowed");const g=v=>r.eql(v,r.ZERO);return g(b)&&g(w)?d.ZERO:new d(b,w,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(y){const b=r.invertBatch(y.map(w=>w.pz));return y.map((w,g)=>w.toAffine(b[g])).map(d.fromAffine)}static fromHex(y){const b=d.fromAffine(s(Nr("pointHex",y)));return b.assertValidity(),b}static fromPrivateKey(y){return d.BASE.multiply(c(y))}_setWindowSize(y){this._WINDOW_SIZE=y,l.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:y,y:b}=this.toAffine();if(!r.isValid(y)||!r.isValid(b))throw new Error("bad point: x or y not FE");const w=r.sqr(b),g=i(y);if(!r.eql(w,g))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y}=this.toAffine();if(r.isOdd)return!r.isOdd(y);throw new Error("Field doesn't support isOdd")}equals(y){u(y);const{px:b,py:w,pz:g}=this,{px:v,py:m,pz:_}=y,x=r.eql(r.mul(b,_),r.mul(v,g)),D=r.eql(r.mul(w,_),r.mul(m,g));return x&&D}negate(){return new d(this.px,r.neg(this.py),this.pz)}double(){const{a:y,b}=e,w=r.mul(b,cS),{px:g,py:v,pz:m}=this;let _=r.ZERO,x=r.ZERO,D=r.ZERO,E=r.mul(g,g),A=r.mul(v,v),S=r.mul(m,m),O=r.mul(g,v);return O=r.add(O,O),D=r.mul(g,m),D=r.add(D,D),_=r.mul(y,D),x=r.mul(w,S),x=r.add(_,x),_=r.sub(A,x),x=r.add(A,x),x=r.mul(_,x),_=r.mul(O,_),D=r.mul(w,D),S=r.mul(y,S),O=r.sub(E,S),O=r.mul(y,O),O=r.add(O,D),D=r.add(E,E),E=r.add(D,E),E=r.add(E,S),E=r.mul(E,O),x=r.add(x,E),S=r.mul(v,m),S=r.add(S,S),E=r.mul(S,O),_=r.sub(_,E),D=r.mul(S,A),D=r.add(D,D),D=r.add(D,D),new d(_,x,D)}add(y){u(y);const{px:b,py:w,pz:g}=this,{px:v,py:m,pz:_}=y;let x=r.ZERO,D=r.ZERO,E=r.ZERO;const A=e.a,S=r.mul(e.b,cS);let O=r.mul(b,v),I=r.mul(w,m),N=r.mul(g,_),j=r.add(b,w),F=r.add(v,m);j=r.mul(j,F),F=r.add(O,I),j=r.sub(j,F),F=r.add(b,g);let V=r.add(v,_);return F=r.mul(F,V),V=r.add(O,N),F=r.sub(F,V),V=r.add(w,g),x=r.add(m,_),V=r.mul(V,x),x=r.add(I,N),V=r.sub(V,x),E=r.mul(A,F),x=r.mul(S,N),E=r.add(x,E),x=r.sub(I,E),E=r.add(I,E),D=r.mul(x,E),I=r.add(O,O),I=r.add(I,O),N=r.mul(A,N),F=r.mul(S,F),I=r.add(I,N),N=r.sub(O,N),N=r.mul(A,N),F=r.add(F,N),O=r.mul(I,F),D=r.add(D,O),O=r.mul(V,F),x=r.mul(j,x),x=r.sub(x,O),O=r.mul(j,I),E=r.mul(V,E),E=r.add(E,O),new d(x,D,E)}subtract(y){return this.add(y.negate())}is0(){return this.equals(d.ZERO)}wNAF(y){return f.wNAFCached(this,l,y,b=>{const w=r.invertBatch(b.map(g=>g.pz));return b.map((g,v)=>g.toAffine(w[v])).map(d.fromAffine)})}multiplyUnsafe(y){const b=d.ZERO;if(y===Ra)return b;if(a(y),y===as)return this;const{endo:w}=e;if(!w)return f.unsafeLadder(this,y);let{k1neg:g,k1:v,k2neg:m,k2:_}=w.splitScalar(y),x=b,D=b,E=this;for(;v>Ra||_>Ra;)v&as&&(x=x.add(E)),_&as&&(D=D.add(E)),E=E.double(),v>>=as,_>>=as;return g&&(x=x.negate()),m&&(D=D.negate()),D=new d(r.mul(D.px,w.beta),D.py,D.pz),x.add(D)}multiply(y){a(y);let b=y,w,g;const{endo:v}=e;if(v){const{k1neg:m,k1:_,k2neg:x,k2:D}=v.splitScalar(b);let{p:E,f:A}=this.wNAF(_),{p:S,f:O}=this.wNAF(D);E=f.constTimeNegate(m,E),S=f.constTimeNegate(x,S),S=new d(r.mul(S.px,v.beta),S.py,S.pz),w=E.add(S),g=A.add(O)}else{const{p:m,f:_}=this.wNAF(b);w=m,g=_}return d.normalizeZ([w,g])[0]}multiplyAndAddUnsafe(y,b,w){const g=d.BASE,v=(_,x)=>x===Ra||x===as||!_.equals(g)?_.multiplyUnsafe(x):_.multiply(x),m=v(this,b).add(v(y,w));return m.is0()?void 0:m}toAffine(y){const{px:b,py:w,pz:g}=this,v=this.is0();y==null&&(y=v?r.ONE:r.inv(g));const m=r.mul(b,y),_=r.mul(w,y),x=r.mul(g,y);if(v)return{x:r.ZERO,y:r.ZERO};if(!r.eql(x,r.ONE))throw new Error("invZ was invalid");return{x:m,y:_}}isTorsionFree(){const{h:y,isTorsionFree:b}=e;if(y===as)return!0;if(b)return b(d,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:y,clearCofactor:b}=e;return y===as?this:b?b(d,this):this.multiplyUnsafe(e.h)}toRawBytes(y=!0){return this.assertValidity(),n(d,this,y)}toHex(y=!0){return Kl(this.toRawBytes(y))}}d.BASE=new d(e.Gx,e.Gy,r.ONE),d.ZERO=new d(r.ZERO,r.ONE,r.ZERO);const h=e.nBitLength,f=aC(d,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:d,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:o}}function VR(t){const e=l_(t);return nd(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function zR(t){const e=VR(t),{Fp:r,n}=e,s=r.BYTES+1,i=2*r.BYTES+1;function o(F){return Ra<F&&F<r.ORDER}function a(F){return dr(F,n)}function c(F){return mb(F,n)}const{ProjectivePoint:l,normPrivateKeyToScalar:u,weierstrassEquation:d,isWithinCurveOrder:h}=qR({...e,toBytes(F,V,ee){const G=V.toAffine(),Z=r.toBytes(G.x),M=Ll;return ee?M(Uint8Array.from([V.hasEvenY()?2:3]),Z):M(Uint8Array.from([4]),Z,r.toBytes(G.y))},fromBytes(F){const V=F.length,ee=F[0],G=F.subarray(1);if(V===s&&(ee===2||ee===3)){const Z=Pl(G);if(!o(Z))throw new Error("Point is not on curve");const M=d(Z);let k=r.sqrt(M);const H=(k&as)===as;return(ee&1)===1!==H&&(k=r.neg(k)),{x:Z,y:k}}else if(V===i&&ee===4){const Z=r.fromBytes(G.subarray(0,r.BYTES)),M=r.fromBytes(G.subarray(r.BYTES,2*r.BYTES));return{x:Z,y:M}}else throw new Error(`Point of length ${V} was invalid. Expected ${s} compressed bytes or ${i} uncompressed bytes`)}}),f=F=>Kl(fr(F,e.nByteLength));function p(F){const V=n>>as;return F>V}function y(F){return p(F)?a(-F):F}const b=(F,V,ee)=>Pl(F.slice(V,ee));class w{constructor(V,ee,G){this.r=V,this.s=ee,this.recovery=G,this.assertValidity()}static fromCompact(V){const ee=e.nByteLength;return V=Nr("compactSignature",V,ee*2),new w(b(V,0,ee),b(V,ee,2*ee))}static fromDER(V){const{r:ee,s:G}=_l.toSig(Nr("DER",V));return new w(ee,G)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(V){return new w(this.r,this.s,V)}recoverPublicKey(V){const{r:ee,s:G,recovery:Z}=this,M=D(Nr("msgHash",V));if(Z==null||![0,1,2,3].includes(Z))throw new Error("recovery id invalid");const k=Z===2||Z===3?ee+e.n:ee;if(k>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const H=Z&1?"03":"02",U=l.fromHex(H+f(k)),$=c(k),T=a(-M*$),z=a(G*$),ne=l.BASE.multiplyAndAddUnsafe(U,T,z);if(!ne)throw new Error("point at infinify");return ne.assertValidity(),ne}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new w(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Xd(this.toDERHex())}toDERHex(){return _l.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Xd(this.toCompactHex())}toCompactHex(){return f(this.r)+f(this.s)}}const g={isValidPrivateKey(F){try{return u(F),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const F=oC(e.n);return jR(e.randomBytes(F),e.n)},precompute(F=8,V=l.BASE){return V._setWindowSize(F),V.multiply(BigInt(3)),V}};function v(F,V=!0){return l.fromPrivateKey(F).toRawBytes(V)}function m(F){const V=Lo(F),ee=typeof F=="string",G=(V||ee)&&F.length;return V?G===s||G===i:ee?G===2*s||G===2*i:F instanceof l}function _(F,V,ee=!0){if(m(F))throw new Error("first arg must be private key");if(!m(V))throw new Error("second arg must be public key");return l.fromHex(V).multiply(u(F)).toRawBytes(ee)}const x=e.bits2int||function(F){const V=Pl(F),ee=F.length*8-e.nBitLength;return ee>0?V>>BigInt(ee):V},D=e.bits2int_modN||function(F){return a(x(F))},E=u_(e.nBitLength);function A(F){if(typeof F!="bigint")throw new Error("bigint expected");if(!(Ra<=F&&F<E))throw new Error(`bigint expected < 2^${e.nBitLength}`);return fr(F,e.nByteLength)}function S(F,V,ee=O){if(["recovered","canonical"].some(ye=>ye in ee))throw new Error("sign() legacy options not supported");const{hash:G,randomBytes:Z}=e;let{lowS:M,prehash:k,extraEntropy:H}=ee;M==null&&(M=!0),F=Nr("msgHash",F),k&&(F=Nr("prehashed msgHash",G(F)));const U=D(F),$=u(V),T=[A($),A(U)];if(H!=null){const ye=H===!0?Z(r.BYTES):H;T.push(Nr("extraEntropy",ye))}const z=Ll(...T),ne=U;function ue(ye){const _e=x(ye);if(!h(_e))return;const Se=c(_e),We=l.BASE.multiply(_e).toAffine(),te=a(We.x);if(te===Ra)return;const se=a(Se*a(ne+te*$));if(se===Ra)return;let ce=(We.x===te?0:2)|Number(We.y&as),K=se;return M&&p(se)&&(K=y(se),ce^=1),new w(te,K,ce)}return{seed:z,k2sig:ue}}const O={lowS:e.lowS,prehash:!1},I={lowS:e.lowS,prehash:!1};function N(F,V,ee=O){const{seed:G,k2sig:Z}=S(F,V,ee),M=e;return rC(M.hash.outputLen,M.nByteLength,M.hmac)(G,Z)}l.BASE._setWindowSize(8);function j(F,V,ee,G=I){var We;const Z=F;if(V=Nr("msgHash",V),ee=Nr("publicKey",ee),"strict"in G)throw new Error("options.strict was renamed to lowS");const{lowS:M,prehash:k}=G;let H,U;try{if(typeof Z=="string"||Lo(Z))try{H=w.fromDER(Z)}catch(te){if(!(te instanceof _l.Err))throw te;H=w.fromCompact(Z)}else if(typeof Z=="object"&&typeof Z.r=="bigint"&&typeof Z.s=="bigint"){const{r:te,s:se}=Z;H=new w(te,se)}else throw new Error("PARSE");U=l.fromHex(ee)}catch(te){if(te.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(M&&H.hasHighS())return!1;k&&(V=e.hash(V));const{r:$,s:T}=H,z=D(V),ne=c(T),ue=a(z*ne),ye=a($*ne),_e=(We=l.BASE.multiplyAndAddUnsafe(U,ue,ye))==null?void 0:We.toAffine();return _e?a(_e.x)===$:!1}return{CURVE:e,getPublicKey:v,getSharedSecret:_,sign:N,verify:j,ProjectivePoint:l,Signature:w,utils:g}}class uC extends _5{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,eB(e);const n=T1(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return _0(this),this.iHash.update(e),this}digestInto(e){_0(this),g5(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const cC=(t,e,r)=>new uC(t,e).update(r).digest();cC.create=(t,e)=>new uC(t,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function HR(t){return{hash:t,hmac:(e,...r)=>cC(t,e,b5(...r)),randomBytes:I1}}function lC(t,e){const r=n=>zR({...t,...HR(n)});return Object.freeze({...r(e),create:r})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const dC=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),lS=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),WR=BigInt(1),gb=BigInt(2),dS=(t,e)=>(t+e/gb)/e;function JR(t){const e=dC,r=BigInt(3),n=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),l=t*t*t%e,u=l*l*t%e,d=Ar(u,r,e)*u%e,h=Ar(d,r,e)*u%e,f=Ar(h,gb,e)*l%e,p=Ar(f,s,e)*f%e,y=Ar(p,i,e)*p%e,b=Ar(y,a,e)*y%e,w=Ar(b,c,e)*b%e,g=Ar(w,a,e)*y%e,v=Ar(g,r,e)*u%e,m=Ar(v,o,e)*p%e,_=Ar(m,n,e)*l%e,x=Ar(_,gb,e);if(!vb.eql(vb.sqr(x),t))throw new Error("Cannot find square root");return x}const vb=c_(dC,void 0,void 0,{sqrt:JR}),qe=lC({a:BigInt(0),b:BigInt(7),Fp:vb,n:lS,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=lS,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-WR*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=r,o=BigInt("0x100000000000000000000000000000000"),a=dS(i*t,e),c=dS(-n*t,e);let l=dr(t-a*r-c*s,e),u=dr(-a*n-c*i,e);const d=l>o,h=u>o;if(d&&(l=e-l),h&&(u=e-u),l>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:d,k1:l,k2neg:h,k2:u}}}},pc);BigInt(0);qe.ProjectivePoint;function GR(t){const e=n=>{if(n!==null&&typeof n=="object"&&!Array.isArray(n)){const s=Object.keys(n).sort(),i={};for(const o of s)i[o]=e(n[o]);return i}return n},r=e(t);return JSON.stringify(r)}var ZR=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};const fS="urn:jwk:";function Xr(t){return ZR(this,arguments,void 0,function*({jwk:e}){const r=e.kty;let n;if(r==="EC")n={crv:e.crv,kty:e.kty,x:e.x,y:e.y};else if(r==="oct")n={k:e.k,kty:e.kty};else if(r==="OKP")n={crv:e.crv,kty:e.kty,x:e.x};else if(r==="RSA")n={e:e.e,kty:e.kty,n:e.n};else throw new Error(`Unsupported key type: ${r}`);ZP(n);const s=GR(n),i=Lt.string(s).toUint8Array(),o=yield QP.digest({data:i});return Lt.uint8Array(o).toBase64Url()})}function Cl(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="EC"||typeof t.d!="string"||typeof t.x!="string")}function d_(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t)||"d"in t||t.kty!=="EC"||typeof t.x!="string")}function Gp(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="OKP"||typeof t.d!="string"||typeof t.x!="string")}function fC(t){return!(!t||typeof t!="object"||"d"in t||!("kty"in t&&"crv"in t&&"x"in t)||t.kty!=="OKP"||typeof t.x!="string")}function XR(t){if(!t||typeof t!="object")return!1;switch(t.kty){case"EC":case"OKP":case"RSA":return"d"in t;case"oct":return"k"in t;default:return!1}}var pn=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},YR=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let Lf=class lo{static adjustSignatureToLowS(e){return pn(this,arguments,void 0,function*({signature:r}){const n=qe.Signature.fromCompact(r);return n.hasHighS()?n.normalizeS().toCompactRawBytes():r})}static bytesToPrivateKey(e){return pn(this,arguments,void 0,function*({privateKeyBytes:r}){const n=yield lo.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"secp256k1",d:Lt.uint8Array(r).toBase64Url(),x:Lt.uint8Array(n.x).toBase64Url(),y:Lt.uint8Array(n.y).toBase64Url()};return s.kid=yield Xr({jwk:s}),s})}static bytesToPublicKey(e){return pn(this,arguments,void 0,function*({publicKeyBytes:r}){const n=yield lo.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"secp256k1",x:Lt.uint8Array(n.x).toBase64Url(),y:Lt.uint8Array(n.y).toBase64Url()};return s.kid=yield Xr({jwk:s}),s})}static compressPublicKey(e){return pn(this,arguments,void 0,function*({publicKeyBytes:r}){return qe.ProjectivePoint.fromHex(r).toRawBytes(!0)})}static computePublicKey(e){return pn(this,arguments,void 0,function*({key:r}){const n=yield lo.privateKeyToBytes({privateKey:r}),s=yield lo.getCurvePoint({keyBytes:n}),i={kty:"EC",crv:"secp256k1",x:Lt.uint8Array(s.x).toBase64Url(),y:Lt.uint8Array(s.y).toBase64Url()};return i.kid=yield Xr({jwk:i}),i})}static convertDerToCompactSignature(e){return pn(this,arguments,void 0,function*({derSignature:r}){return qe.Signature.fromDER(r).toCompactRawBytes()})}static decompressPublicKey(e){return pn(this,arguments,void 0,function*({publicKeyBytes:r}){return qe.ProjectivePoint.fromHex(r).toRawBytes(!1)})}static generateKey(){return pn(this,void 0,void 0,function*(){const e=qe.utils.randomPrivateKey(),r=yield lo.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Xr({jwk:r}),r})}static getPublicKey(e){return pn(this,arguments,void 0,function*({key:r}){var n;if(!(Cl(r)&&r.crv==="secp256k1"))throw new Error("Secp256k1: The provided key is not a secp256k1 private JWK.");let s=YR(r,["d"]);return(n=s.kid)!==null&&n!==void 0||(s.kid=yield Xr({jwk:s})),s})}static privateKeyToBytes(e){return pn(this,arguments,void 0,function*({privateKey:r}){if(!Cl(r))throw new Error("Secp256k1: The provided key is not a valid EC private key.");return Lt.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return pn(this,arguments,void 0,function*({publicKey:r}){if(!(d_(r)&&r.y))throw new Error("Secp256k1: The provided key is not a valid EC public key.");const n=new Uint8Array([4]),s=Lt.base64Url(r.x).toUint8Array(),i=Lt.base64Url(r.y).toUint8Array();return new Uint8Array([...n,...s,...i])})}static sharedSecret(e){return pn(this,arguments,void 0,function*({privateKeyA:r,publicKeyB:n}){if("x"in r&&"x"in n&&r.x===n.x)throw new Error("Secp256k1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const s=yield lo.privateKeyToBytes({privateKey:r}),i=yield lo.publicKeyToBytes({publicKey:n});return qe.getSharedSecret(s,i,!0).slice(1)})}static sign(e){return pn(this,arguments,void 0,function*({data:r,key:n}){const s=yield lo.privateKeyToBytes({privateKey:n}),i=yh(r);return qe.sign(i,s).toCompactRawBytes()})}static validatePrivateKey(e){return pn(this,arguments,void 0,function*({privateKeyBytes:r}){return qe.utils.isValidPrivateKey(r)})}static validatePublicKey(e){return pn(this,arguments,void 0,function*({publicKeyBytes:r}){try{qe.ProjectivePoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return pn(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=yield lo.publicKeyToBytes({publicKey:r}),o=yh(s);return qe.verify(n,o,i,{lowS:!1})})}static getCurvePoint(e){return pn(this,arguments,void 0,function*({keyBytes:r}){r.byteLength===32&&(r=qe.getPublicKey(r));const n=qe.ProjectivePoint.fromHex(r),s=fr(n.x,32),i=fr(n.y,32);return{x:s,y:i}})}};/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const pC=c_(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),QR=pC.create(BigInt("-3")),ej=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),tj=lC({a:QR,b:ej,Fp:pC,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},pc),Ve=tj;var hn=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},rj=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let qf=class fo{static adjustSignatureToLowS(e){return hn(this,arguments,void 0,function*({signature:r}){const n=Ve.Signature.fromCompact(r);return n.hasHighS()?n.normalizeS().toCompactRawBytes():r})}static bytesToPrivateKey(e){return hn(this,arguments,void 0,function*({privateKeyBytes:r}){const n=yield fo.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"P-256",d:Lt.uint8Array(r).toBase64Url(),x:Lt.uint8Array(n.x).toBase64Url(),y:Lt.uint8Array(n.y).toBase64Url()};return s.kid=yield Xr({jwk:s}),s})}static bytesToPublicKey(e){return hn(this,arguments,void 0,function*({publicKeyBytes:r}){const n=yield fo.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"P-256",x:Lt.uint8Array(n.x).toBase64Url(),y:Lt.uint8Array(n.y).toBase64Url()};return s.kid=yield Xr({jwk:s}),s})}static compressPublicKey(e){return hn(this,arguments,void 0,function*({publicKeyBytes:r}){return Ve.ProjectivePoint.fromHex(r).toRawBytes(!0)})}static computePublicKey(e){return hn(this,arguments,void 0,function*({key:r}){const n=yield fo.privateKeyToBytes({privateKey:r}),s=yield fo.getCurvePoint({keyBytes:n}),i={kty:"EC",crv:"P-256",x:Lt.uint8Array(s.x).toBase64Url(),y:Lt.uint8Array(s.y).toBase64Url()};return i.kid=yield Xr({jwk:i}),i})}static convertDerToCompactSignature(e){return hn(this,arguments,void 0,function*({derSignature:r}){return Ve.Signature.fromDER(r).toCompactRawBytes()})}static decompressPublicKey(e){return hn(this,arguments,void 0,function*({publicKeyBytes:r}){return Ve.ProjectivePoint.fromHex(r).toRawBytes(!1)})}static generateKey(){return hn(this,void 0,void 0,function*(){const e=Ve.utils.randomPrivateKey(),r=yield fo.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Xr({jwk:r}),r})}static getPublicKey(e){return hn(this,arguments,void 0,function*({key:r}){var n;if(!(Cl(r)&&r.crv==="P-256"))throw new Error("Secp256r1: The provided key is not a 'P-256' private JWK.");let s=rj(r,["d"]);return(n=s.kid)!==null&&n!==void 0||(s.kid=yield Xr({jwk:s})),s})}static privateKeyToBytes(e){return hn(this,arguments,void 0,function*({privateKey:r}){if(!Cl(r))throw new Error("Secp256r1: The provided key is not a valid EC private key.");return Lt.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return hn(this,arguments,void 0,function*({publicKey:r}){if(!(d_(r)&&r.y))throw new Error("Secp256r1: The provided key is not a valid EC public key.");const n=new Uint8Array([4]),s=Lt.base64Url(r.x).toUint8Array(),i=Lt.base64Url(r.y).toUint8Array();return new Uint8Array([...n,...s,...i])})}static sharedSecret(e){return hn(this,arguments,void 0,function*({privateKeyA:r,publicKeyB:n}){if("x"in r&&"x"in n&&r.x===n.x)throw new Error("Secp256r1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const s=yield fo.privateKeyToBytes({privateKey:r}),i=yield fo.publicKeyToBytes({publicKey:n});return Ve.getSharedSecret(s,i,!0).slice(1)})}static sign(e){return hn(this,arguments,void 0,function*({data:r,key:n}){const s=yield fo.privateKeyToBytes({privateKey:n}),i=yh(r);return Ve.sign(i,s).toCompactRawBytes()})}static validatePrivateKey(e){return hn(this,arguments,void 0,function*({privateKeyBytes:r}){return Ve.utils.isValidPrivateKey(r)})}static validatePublicKey(e){return hn(this,arguments,void 0,function*({publicKeyBytes:r}){try{Ve.ProjectivePoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return hn(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=yield fo.publicKeyToBytes({publicKey:r}),o=yh(s);return Ve.verify(n,o,i,{lowS:!1})})}static getCurvePoint(e){return hn(this,arguments,void 0,function*({keyBytes:r}){r.byteLength===32&&(r=Ve.getPublicKey(r));const n=Ve.ProjectivePoint.fromHex(r),s=fr(n.x,32),i=fr(n.y,32);return{x:s,y:i}})}};var Vf=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let pS=class extends o_{computePublicKey(e){return Vf(this,arguments,void 0,function*({key:r}){if(!Cl(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":{const n=yield Lf.computePublicKey({key:r});return n.alg="ES256K",n}case"P-256":{const n=yield qf.computePublicKey({key:r});return n.alg="ES256",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}generateKey(e){return Vf(this,arguments,void 0,function*({algorithm:r}){switch(r){case"ES256K":case"secp256k1":{const n=yield Lf.generateKey();return n.alg="ES256K",n}case"ES256":case"secp256r1":{const n=yield qf.generateKey();return n.alg="ES256",n}}})}getPublicKey(e){return Vf(this,arguments,void 0,function*({key:r}){if(!Cl(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":{const n=yield Lf.getPublicKey({key:r});return n.alg="ES256K",n}case"P-256":{const n=yield qf.getPublicKey({key:r});return n.alg="ES256",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}sign(e){return Vf(this,arguments,void 0,function*({key:r,data:n}){if(!Cl(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":return yield Lf.sign({key:r,data:n});case"P-256":return yield qf.sign({key:r,data:n});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}verify(e){return Vf(this,arguments,void 0,function*({key:r,signature:n,data:s}){if(!d_(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) public key.");switch(r.crv){case"secp256k1":return yield Lf.verify({key:r,signature:n,data:s});case"P-256":return yield qf.verify({key:r,signature:n,data:s});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}};const My=BigInt(2**32-1),wb=BigInt(32);function hC(t,e=!1){return e?{h:Number(t&My),l:Number(t>>wb&My)}:{h:Number(t>>wb&My)|0,l:Number(t&My)|0}}function nj(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=hC(t[s],e);[r[s],n[s]]=[i,o]}return[r,n]}const ij=(t,e)=>BigInt(t>>>0)<<wb|BigInt(e>>>0),sj=(t,e,r)=>t>>>r,oj=(t,e,r)=>t<<32-r|e>>>r,aj=(t,e,r)=>t>>>r|e<<32-r,uj=(t,e,r)=>t<<32-r|e>>>r,cj=(t,e,r)=>t<<64-r|e>>>r-32,lj=(t,e,r)=>t>>>r-32|e<<64-r,dj=(t,e)=>e,fj=(t,e)=>t,pj=(t,e,r)=>t<<r|e>>>32-r,hj=(t,e,r)=>e<<r|t>>>32-r,yj=(t,e,r)=>e<<r-32|t>>>64-r,mj=(t,e,r)=>t<<r-32|e>>>64-r;function gj(t,e,r,n){const s=(e>>>0)+(n>>>0);return{h:t+r+(s/2**32|0)|0,l:s|0}}const vj=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),wj=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,bj=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),_j=(t,e,r,n,s)=>e+r+n+s+(t/2**32|0)|0,Ej=(t,e,r,n,s)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(s>>>0),Aj=(t,e,r,n,s,i)=>e+r+n+s+i+(t/2**32|0)|0,Et={fromBig:hC,split:nj,toBig:ij,shrSH:sj,shrSL:oj,rotrSH:aj,rotrSL:uj,rotrBH:cj,rotrBL:lj,rotr32H:dj,rotr32L:fj,rotlSH:pj,rotlSL:hj,rotlBH:yj,rotlBL:mj,add:gj,add3L:vj,add3H:wj,add4L:bj,add4H:_j,add5H:Aj,add5L:Ej},[Sj,$j]=Et.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),du=new Uint32Array(80),fu=new Uint32Array(80);class xj extends A5{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:r,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:f,Gl:p,Hh:y,Hl:b}=this;return[e,r,n,s,i,o,a,c,l,u,d,h,f,p,y,b]}set(e,r,n,s,i,o,a,c,l,u,d,h,f,p,y,b){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=p|0,this.Hh=y|0,this.Hl=b|0}process(e,r){for(let v=0;v<16;v++,r+=4)du[v]=e.getUint32(r),fu[v]=e.getUint32(r+=4);for(let v=16;v<80;v++){const m=du[v-15]|0,_=fu[v-15]|0,x=Et.rotrSH(m,_,1)^Et.rotrSH(m,_,8)^Et.shrSH(m,_,7),D=Et.rotrSL(m,_,1)^Et.rotrSL(m,_,8)^Et.shrSL(m,_,7),E=du[v-2]|0,A=fu[v-2]|0,S=Et.rotrSH(E,A,19)^Et.rotrBH(E,A,61)^Et.shrSH(E,A,6),O=Et.rotrSL(E,A,19)^Et.rotrBL(E,A,61)^Et.shrSL(E,A,6),I=Et.add4L(D,O,fu[v-7],fu[v-16]),N=Et.add4H(I,x,S,du[v-7],du[v-16]);du[v]=N|0,fu[v]=I|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:f,Fl:p,Gh:y,Gl:b,Hh:w,Hl:g}=this;for(let v=0;v<80;v++){const m=Et.rotrSH(d,h,14)^Et.rotrSH(d,h,18)^Et.rotrBH(d,h,41),_=Et.rotrSL(d,h,14)^Et.rotrSL(d,h,18)^Et.rotrBL(d,h,41),x=d&f^~d&y,D=h&p^~h&b,E=Et.add5L(g,_,D,$j[v],fu[v]),A=Et.add5H(E,w,m,x,Sj[v],du[v]),S=E|0,O=Et.rotrSH(n,s,28)^Et.rotrBH(n,s,34)^Et.rotrBH(n,s,39),I=Et.rotrSL(n,s,28)^Et.rotrBL(n,s,34)^Et.rotrBL(n,s,39),N=n&i^n&a^i&a,j=s&o^s&c^o&c;w=y|0,g=b|0,y=f|0,b=p|0,f=d|0,p=h|0,{h:d,l:h}=Et.add(l|0,u|0,A|0,S|0),l=a|0,u=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const F=Et.add3L(S,I,j);n=Et.add3H(F,A,O,N),s=F|0}({h:n,l:s}=Et.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=Et.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Et.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Et.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=Et.add(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:p}=Et.add(this.Fh|0,this.Fl|0,f|0,p|0),{h:y,l:b}=Et.add(this.Gh|0,this.Gl|0,y|0,b|0),{h:w,l:g}=Et.add(this.Hh|0,this.Hl|0,w|0,g|0),this.set(n,s,i,o,a,c,l,u,d,h,f,p,y,b,w,g)}roundClean(){du.fill(0),fu.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const yC=E5(()=>new xj);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ds=BigInt(0),Ai=BigInt(1),Uy=BigInt(2),Dj=BigInt(8),Pj={zip215:!0};function Cj(t){const e=l_(t);return nd(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function f_(t){const e=Cj(t),{Fp:r,n,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=e,l=Uy<<BigInt(a*8)-Ai,u=r.create,d=e.uvRatio||((G,Z)=>{try{return{isValid:!0,value:r.sqrt(G*r.inv(Z))}}catch{return{isValid:!1,value:Ds}}}),h=e.adjustScalarBytes||(G=>G),f=e.domain||((G,Z,M)=>{if(Z.length||M)throw new Error("Contexts/pre-hash are not supported");return G}),p=G=>typeof G=="bigint"&&Ds<G,y=(G,Z)=>p(G)&&p(Z)&&G<Z,b=G=>G===Ds||y(G,l);function w(G,Z){if(y(G,Z))return G;throw new Error(`Expected valid scalar < ${Z}, got ${typeof G} ${G}`)}function g(G){return G===Ds?G:w(G,n)}const v=new Map;function m(G){if(!(G instanceof _))throw new Error("ExtendedPoint expected")}class _{constructor(Z,M,k,H){if(this.ex=Z,this.ey=M,this.ez=k,this.et=H,!b(Z))throw new Error("x required");if(!b(M))throw new Error("y required");if(!b(k))throw new Error("z required");if(!b(H))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(Z){if(Z instanceof _)throw new Error("extended point not allowed");const{x:M,y:k}=Z||{};if(!b(M)||!b(k))throw new Error("invalid affine point");return new _(M,k,Ai,u(M*k))}static normalizeZ(Z){const M=r.invertBatch(Z.map(k=>k.ez));return Z.map((k,H)=>k.toAffine(M[H])).map(_.fromAffine)}_setWindowSize(Z){this._WINDOW_SIZE=Z,v.delete(this)}assertValidity(){const{a:Z,d:M}=e;if(this.is0())throw new Error("bad point: ZERO");const{ex:k,ey:H,ez:U,et:$}=this,T=u(k*k),z=u(H*H),ne=u(U*U),ue=u(ne*ne),ye=u(T*Z),_e=u(ne*u(ye+z)),Se=u(ue+u(M*u(T*z)));if(_e!==Se)throw new Error("bad point: equation left != right (1)");const We=u(k*H),te=u(U*$);if(We!==te)throw new Error("bad point: equation left != right (2)")}equals(Z){m(Z);const{ex:M,ey:k,ez:H}=this,{ex:U,ey:$,ez:T}=Z,z=u(M*T),ne=u(U*H),ue=u(k*T),ye=u($*H);return z===ne&&ue===ye}is0(){return this.equals(_.ZERO)}negate(){return new _(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:Z}=e,{ex:M,ey:k,ez:H}=this,U=u(M*M),$=u(k*k),T=u(Uy*u(H*H)),z=u(Z*U),ne=M+k,ue=u(u(ne*ne)-U-$),ye=z+$,_e=ye-T,Se=z-$,We=u(ue*_e),te=u(ye*Se),se=u(ue*Se),ce=u(_e*ye);return new _(We,te,ce,se)}add(Z){m(Z);const{a:M,d:k}=e,{ex:H,ey:U,ez:$,et:T}=this,{ex:z,ey:ne,ez:ue,et:ye}=Z;if(M===BigInt(-1)){const be=u((U-H)*(ne+z)),Ne=u((U+H)*(ne-z)),Oe=u(Ne-be);if(Oe===Ds)return this.double();const W=u($*Uy*ye),J=u(T*Uy*ue),he=J+W,we=Ne+be,Ce=J-W,Mt=u(he*Oe),or=u(we*Ce),Gs=u(he*Ce),xr=u(Oe*we);return new _(Mt,or,xr,Gs)}const _e=u(H*z),Se=u(U*ne),We=u(T*k*ye),te=u($*ue),se=u((H+U)*(z+ne)-_e-Se),ce=te-We,K=te+We,C=u(Se-M*_e),B=u(se*ce),X=u(K*C),ae=u(se*C),ge=u(ce*K);return new _(B,X,ge,ae)}subtract(Z){return this.add(Z.negate())}wNAF(Z){return E.wNAFCached(this,v,Z,_.normalizeZ)}multiply(Z){const{p:M,f:k}=this.wNAF(w(Z,n));return _.normalizeZ([M,k])[0]}multiplyUnsafe(Z){let M=g(Z);return M===Ds?D:this.equals(D)||M===Ai?this:this.equals(x)?this.wNAF(M).p:E.unsafeLadder(this,M)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return E.unsafeLadder(this,n).is0()}toAffine(Z){const{ex:M,ey:k,ez:H}=this,U=this.is0();Z==null&&(Z=U?Dj:r.inv(H));const $=u(M*Z),T=u(k*Z),z=u(H*Z);if(U)return{x:Ds,y:Ai};if(z!==Ai)throw new Error("invZ was invalid");return{x:$,y:T}}clearCofactor(){const{h:Z}=e;return Z===Ai?this:this.multiplyUnsafe(Z)}static fromHex(Z,M=!1){const{d:k,a:H}=e,U=r.BYTES;Z=Nr("pointHex",Z,U);const $=Z.slice(),T=Z[U-1];$[U-1]=T&-129;const z=oc($);z===Ds||(M?w(z,l):w(z,r.ORDER));const ne=u(z*z),ue=u(ne-Ai),ye=u(k*ne-H);let{isValid:_e,value:Se}=d(ue,ye);if(!_e)throw new Error("Point.fromHex: invalid y coordinate");const We=(Se&Ai)===Ai,te=(T&128)!==0;if(!M&&Se===Ds&&te)throw new Error("Point.fromHex: x=0 and x_0=1");return te!==We&&(Se=u(-Se)),_.fromAffine({x:Se,y:z})}static fromPrivateKey(Z){return O(Z).point}toRawBytes(){const{x:Z,y:M}=this.toAffine(),k=Yd(M,r.BYTES);return k[k.length-1]|=Z&Ai?128:0,k}toHex(){return Kl(this.toRawBytes())}}_.BASE=new _(e.Gx,e.Gy,Ai,u(e.Gx*e.Gy)),_.ZERO=new _(Ds,Ai,Ai,Ds);const{BASE:x,ZERO:D}=_,E=aC(_,a*8);function A(G){return dr(G,n)}function S(G){return A(oc(G))}function O(G){const Z=a;G=Nr("private key",G,Z);const M=Nr("hashed private key",i(G),2*Z),k=h(M.slice(0,Z)),H=M.slice(Z,2*Z),U=S(k),$=x.multiply(U),T=$.toRawBytes();return{head:k,prefix:H,scalar:U,point:$,pointBytes:T}}function I(G){return O(G).pointBytes}function N(G=new Uint8Array,...Z){const M=Ll(...Z);return S(i(f(M,Nr("context",G),!!s)))}function j(G,Z,M={}){G=Nr("message",G),s&&(G=s(G));const{prefix:k,scalar:H,pointBytes:U}=O(Z),$=N(M.context,k,G),T=x.multiply($).toRawBytes(),z=N(M.context,T,U,G),ne=A($+z*H);g(ne);const ue=Ll(T,Yd(ne,r.BYTES));return Nr("result",ue,a*2)}const F=Pj;function V(G,Z,M,k=F){const{context:H,zip215:U}=k,$=r.BYTES;G=Nr("signature",G,2*$),Z=Nr("message",Z),s&&(Z=s(Z));const T=oc(G.slice($,2*$));let z,ne,ue;try{z=_.fromHex(M,U),ne=_.fromHex(G.slice(0,$),U),ue=x.multiplyUnsafe(T)}catch{return!1}if(!U&&z.isSmallOrder())return!1;const ye=N(H,ne.toRawBytes(),z.toRawBytes(),Z);return ne.add(z.multiplyUnsafe(ye)).subtract(ue).clearCofactor().equals(_.ZERO)}return x._setWindowSize(8),{CURVE:e,getPublicKey:I,sign:j,verify:V,ExtendedPoint:_,utils:{getExtendedPublicKey:O,randomPrivateKey:()=>o(r.BYTES),precompute(G=8,Z=_.BASE){return Z._setWindowSize(G),Z.multiply(BigInt(3)),Z}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const zf=BigInt(0),zv=BigInt(1);function kj(t){return nd(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...t})}function Oj(t){const e=kj(t),{P:r}=e,n=v=>dr(v,r),s=e.montgomeryBits,i=Math.ceil(s/8),o=e.nByteLength,a=e.adjustScalarBytes||(v=>v),c=e.powPminus2||(v=>nC(v,r-BigInt(2),r));function l(v,m,_){const x=n(v*(m-_));return m=n(m-x),_=n(_+x),[m,_]}function u(v){if(typeof v=="bigint"&&zf<=v&&v<r)return v;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}const d=(e.a-BigInt(2))/BigInt(4);function h(v,m){const _=u(v),x=u(m),D=_;let E=zv,A=zf,S=_,O=zv,I=zf,N;for(let F=BigInt(s-1);F>=zf;F--){const V=x>>F&zv;I^=V,N=l(I,E,S),E=N[0],S=N[1],N=l(I,A,O),A=N[0],O=N[1],I=V;const ee=E+A,G=n(ee*ee),Z=E-A,M=n(Z*Z),k=G-M,H=S+O,U=S-O,$=n(U*ee),T=n(H*Z),z=$+T,ne=$-T;S=n(z*z),O=n(D*n(ne*ne)),E=n(G*M),A=n(k*(G+n(d*k)))}N=l(I,E,S),E=N[0],S=N[1],N=l(I,A,O),A=N[0],O=N[1];const j=c(A);return n(E*j)}function f(v){return Yd(n(v),i)}function p(v){const m=Nr("u coordinate",v,i);return o===32&&(m[31]&=127),oc(m)}function y(v){const m=Nr("scalar",v),_=m.length;if(_!==i&&_!==o)throw new Error(`Expected ${i} or ${o} bytes, got ${_}`);return oc(a(m))}function b(v,m){const _=p(m),x=y(v),D=h(_,x);if(D===zf)throw new Error("Invalid private or public key received");return f(D)}const w=f(e.Gu);function g(v){return b(v,w)}return{scalarMult:b,scalarMultBase:g,getSharedSecret:(v,m)=>b(v,m),getPublicKey:v=>g(v),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:w}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const mh=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),hS=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const Tj=BigInt(1),bb=BigInt(2),Ij=BigInt(5),yS=BigInt(10),Bj=BigInt(20),Fj=BigInt(40),mS=BigInt(80);function mC(t){const e=mh,n=t*t%e*t%e,s=Ar(n,bb,e)*n%e,i=Ar(s,Tj,e)*t%e,o=Ar(i,Ij,e)*i%e,a=Ar(o,yS,e)*o%e,c=Ar(a,Bj,e)*a%e,l=Ar(c,Fj,e)*c%e,u=Ar(l,mS,e)*l%e,d=Ar(u,mS,e)*l%e,h=Ar(d,yS,e)*o%e;return{pow_p_5_8:Ar(h,bb,e)*t%e,b2:n}}function gC(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Nj(t,e){const r=mh,n=dr(e*e*e,r),s=dr(n*n*e,r),i=mC(t*s).pow_p_5_8;let o=dr(t*n*i,r);const a=dr(e*o*o,r),c=o,l=dr(o*hS,r),u=a===t,d=a===dr(-t,r),h=a===dr(-t*hS,r);return u&&(o=c),(d||h)&&(o=l),TR(o,r)&&(o=dr(-o,r)),{isValid:u||d,value:o}}const ys=c_(mh,void 0,!0),gh={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:ys,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:yC,randomBytes:I1,adjustScalarBytes:gC,uvRatio:Nj},Ht=f_(gh);function vC(t,e,r){if(e.length>255)throw new Error("Context is too big");return b5(w5("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,e.length]),e,t)}({...gh});({...gh});const Tn=Oj({P:mh,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{const e=mh,{pow_p_5_8:r,b2:n}=mC(t);return dr(Ar(r,BigInt(3),e)*n,e)},adjustScalarBytes:gC,randomBytes:I1});function Gh(t){const{y:e}=Ht.ExtendedPoint.fromHex(t),r=BigInt(1);return ys.toBytes(ys.create((r+e)*ys.inv(r-e)))}function Zh(t){const e=gh.hash(t.subarray(0,32));return gh.adjustScalarBytes(e).subarray(0,32)}const Rj=(ys.ORDER+BigInt(3))/BigInt(8);ys.pow(bb,Rj);ys.sqrt(ys.neg(ys.ONE));(ys.ORDER-BigInt(5))/BigInt(8);BigInt(486662);RR(ys,ys.neg(BigInt(486664)));BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235");BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578");BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838");BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var Hi=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},jj=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let Hf=class Iu{static bytesToPrivateKey(e){return Hi(this,arguments,void 0,function*({privateKeyBytes:r}){const n=Ht.getPublicKey(r),s={crv:"Ed25519",d:Lt.uint8Array(r).toBase64Url(),kty:"OKP",x:Lt.uint8Array(n).toBase64Url()};return s.kid=yield Xr({jwk:s}),s})}static bytesToPublicKey(e){return Hi(this,arguments,void 0,function*({publicKeyBytes:r}){const n={kty:"OKP",crv:"Ed25519",x:Lt.uint8Array(r).toBase64Url()};return n.kid=yield Xr({jwk:n}),n})}static computePublicKey(e){return Hi(this,arguments,void 0,function*({key:r}){const n=yield Iu.privateKeyToBytes({privateKey:r}),s=Ht.getPublicKey(n),i={kty:"OKP",crv:"Ed25519",x:Lt.uint8Array(s).toBase64Url()};return i.kid=yield Xr({jwk:i}),i})}static convertPrivateKeyToX25519(e){return Hi(this,arguments,void 0,function*({privateKey:r}){const n=yield Iu.privateKeyToBytes({privateKey:r}),s=Zh(n),i=Tn.getPublicKey(s),o={kty:"OKP",crv:"X25519",d:Lt.uint8Array(s).toBase64Url(),x:Lt.uint8Array(i).toBase64Url()};return o.kid=yield Xr({jwk:o}),o})}static convertPublicKeyToX25519(e){return Hi(this,arguments,void 0,function*({publicKey:r}){const n=yield Iu.publicKeyToBytes({publicKey:r});if(!(yield Iu.validatePublicKey({publicKeyBytes:n})))throw new Error("Ed25519: Invalid public key.");const i=Gh(n),o={kty:"OKP",crv:"X25519",x:Lt.uint8Array(i).toBase64Url()};return o.kid=yield Xr({jwk:o}),o})}static generateKey(){return Hi(this,void 0,void 0,function*(){const e=Ht.utils.randomPrivateKey(),r=yield Iu.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Xr({jwk:r}),r})}static getPublicKey(e){return Hi(this,arguments,void 0,function*({key:r}){var n;if(!(Gp(r)&&r.crv==="Ed25519"))throw new Error("Ed25519: The provided key is not an Ed25519 private JWK.");let s=jj(r,["d"]);return(n=s.kid)!==null&&n!==void 0||(s.kid=yield Xr({jwk:s})),s})}static privateKeyToBytes(e){return Hi(this,arguments,void 0,function*({privateKey:r}){if(!Gp(r))throw new Error("Ed25519: The provided key is not a valid OKP private key.");return Lt.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return Hi(this,arguments,void 0,function*({publicKey:r}){if(!fC(r))throw new Error("Ed25519: The provided key is not a valid OKP public key.");return Lt.base64Url(r.x).toUint8Array()})}static sign(e){return Hi(this,arguments,void 0,function*({key:r,data:n}){const s=yield Iu.privateKeyToBytes({privateKey:r});return Ht.sign(n,s)})}static validatePublicKey(e){return Hi(this,arguments,void 0,function*({publicKeyBytes:r}){try{Ht.ExtendedPoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return Hi(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=yield Iu.publicKeyToBytes({publicKey:r});return Ht.verify(n,s,i)})}};var Wf=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let Mj=class extends o_{computePublicKey(e){return Wf(this,arguments,void 0,function*({key:r}){if(!Gp(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":{const n=yield Hf.computePublicKey({key:r});return n.alg="EdDSA",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}generateKey(e){return Wf(this,arguments,void 0,function*({algorithm:r}){switch(r){case"Ed25519":{const n=yield Hf.generateKey();return n.alg="EdDSA",n}}})}getPublicKey(e){return Wf(this,arguments,void 0,function*({key:r}){if(!Gp(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":{const n=yield Hf.getPublicKey({key:r});return n.alg="EdDSA",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}sign(e){return Wf(this,arguments,void 0,function*({key:r,data:n}){if(!Gp(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":return yield Hf.sign({key:r,data:n});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}verify(e){return Wf(this,arguments,void 0,function*({key:r,signature:n,data:s}){if(!fC(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) public key.");switch(r.crv){case"Ed25519":return yield Hf.verify({key:r,signature:n,data:s});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}};var ca=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};const Hv={Ed25519:{implementation:Mj,names:["Ed25519"]},secp256k1:{implementation:pS,names:["ES256K","secp256k1"]},secp256r1:{implementation:pS,names:["ES256","secp256r1"]},"SHA-256":{implementation:vR,names:["SHA-256"]}};let Uj=class{constructor(e){var r;this._algorithmInstances=new Map,this._keyStore=(r=e==null?void 0:e.keyStore)!==null&&r!==void 0?r:new nR}digest(e){return ca(this,arguments,void 0,function*({algorithm:r,data:n}){return yield this.getAlgorithm({algorithm:r}).digest({algorithm:r,data:n})})}exportKey(e){return ca(this,arguments,void 0,function*({keyUri:r}){return yield this.getPrivateKey({keyUri:r})})}generateKey(e){return ca(this,arguments,void 0,function*({algorithm:r}){const s=yield this.getAlgorithm({algorithm:r}).generateKey({algorithm:r});if((s==null?void 0:s.kid)===void 0)throw new Error("Generated key is missing a required property: kid");const i=`${fS}${s.kid}`;return yield this._keyStore.set(i,s),i})}getKeyUri(e){return ca(this,arguments,void 0,function*({key:r}){const n=yield Xr({jwk:r});return`${fS}${n}`})}getPublicKey(e){return ca(this,arguments,void 0,function*({keyUri:r}){const n=yield this.getPrivateKey({keyUri:r}),s=this.getAlgorithmName({key:n});return yield this.getAlgorithm({algorithm:s}).getPublicKey({key:n})})}importKey(e){return ca(this,arguments,void 0,function*({key:r}){var n;if(!XR(r))throw new TypeError("Invalid key provided. Must be a private key in JWK format.");const s=structuredClone(r);(n=s.kid)!==null&&n!==void 0||(s.kid=yield Xr({jwk:s}));const i=yield this.getKeyUri({key:s});return yield this._keyStore.set(i,s),i})}sign(e){return ca(this,arguments,void 0,function*({keyUri:r,data:n}){const s=yield this.getPrivateKey({keyUri:r}),i=this.getAlgorithmName({key:s});return this.getAlgorithm({algorithm:i}).sign({data:n,key:s})})}verify(e){return ca(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=this.getAlgorithmName({key:r});return this.getAlgorithm({algorithm:i}).verify({key:r,signature:n,data:s})})}getAlgorithm({algorithm:e}){var r;const n=(r=Hv[e])===null||r===void 0?void 0:r.implementation;if(!n)throw new Error(`Algorithm not supported: ${e}`);return this._algorithmInstances.has(n)||this._algorithmInstances.set(n,new n),this._algorithmInstances.get(n)}getAlgorithmName({key:e}){const r=e.alg,n=e.crv;for(const s in Hv){const i=Hv[s];if(r&&i.names.includes(r))return s;if(n&&i.names.includes(n))return s}throw new Error(`Unable to determine algorithm based on provided input: alg=${r}, crv=${n}`)}getPrivateKey(e){return ca(this,arguments,void 0,function*({keyUri:r}){const n=yield this._keyStore.get(r);if(!n)throw new Error(`Key not found: ${r}`);return n})}};function Kj(t){return cR(t)}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const wC=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4));function bC(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}const Lj=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Lj)throw new Error("Non little-endian hardware is not supported");function p_(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function _b(t){if(typeof t=="string")t=p_(t);else if(bC(t))t=t.slice();else throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function qj(t,e){if(!bC(t))throw new Error("Uint8Array expected");if(t.length!==e)throw new Error(`Uint8Array length ${e} expected`)}function Vj(t){return t!=null&&typeof t=="object"&&(t instanceof Uint8Array||t.constructor.name==="Uint8Array")}function zj(t,...e){if(!Vj(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function gS(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Hj(t,e){zj(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const yn=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class Wj{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=_b(e),qj(e,32);const r=yn(e,0),n=yn(e,2),s=yn(e,4),i=yn(e,6),o=yn(e,8),a=yn(e,10),c=yn(e,12),l=yn(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=yn(e,16+2*u)}process(e,r,n=!1){const s=n?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],d=o[4],h=o[5],f=o[6],p=o[7],y=o[8],b=o[9],w=yn(e,r+0),g=yn(e,r+2),v=yn(e,r+4),m=yn(e,r+6),_=yn(e,r+8),x=yn(e,r+10),D=yn(e,r+12),E=yn(e,r+14);let A=i[0]+(w&8191),S=i[1]+((w>>>13|g<<3)&8191),O=i[2]+((g>>>10|v<<6)&8191),I=i[3]+((v>>>7|m<<9)&8191),N=i[4]+((m>>>4|_<<12)&8191),j=i[5]+(_>>>1&8191),F=i[6]+((_>>>14|x<<2)&8191),V=i[7]+((x>>>11|D<<5)&8191),ee=i[8]+((D>>>8|E<<8)&8191),G=i[9]+(E>>>5|s),Z=0,M=Z+A*a+S*(5*b)+O*(5*y)+I*(5*p)+N*(5*f);Z=M>>>13,M&=8191,M+=j*(5*h)+F*(5*d)+V*(5*u)+ee*(5*l)+G*(5*c),Z+=M>>>13,M&=8191;let k=Z+A*c+S*a+O*(5*b)+I*(5*y)+N*(5*p);Z=k>>>13,k&=8191,k+=j*(5*f)+F*(5*h)+V*(5*d)+ee*(5*u)+G*(5*l),Z+=k>>>13,k&=8191;let H=Z+A*l+S*c+O*a+I*(5*b)+N*(5*y);Z=H>>>13,H&=8191,H+=j*(5*p)+F*(5*f)+V*(5*h)+ee*(5*d)+G*(5*u),Z+=H>>>13,H&=8191;let U=Z+A*u+S*l+O*c+I*a+N*(5*b);Z=U>>>13,U&=8191,U+=j*(5*y)+F*(5*p)+V*(5*f)+ee*(5*h)+G*(5*d),Z+=U>>>13,U&=8191;let $=Z+A*d+S*u+O*l+I*c+N*a;Z=$>>>13,$&=8191,$+=j*(5*b)+F*(5*y)+V*(5*p)+ee*(5*f)+G*(5*h),Z+=$>>>13,$&=8191;let T=Z+A*h+S*d+O*u+I*l+N*c;Z=T>>>13,T&=8191,T+=j*a+F*(5*b)+V*(5*y)+ee*(5*p)+G*(5*f),Z+=T>>>13,T&=8191;let z=Z+A*f+S*h+O*d+I*u+N*l;Z=z>>>13,z&=8191,z+=j*c+F*a+V*(5*b)+ee*(5*y)+G*(5*p),Z+=z>>>13,z&=8191;let ne=Z+A*p+S*f+O*h+I*d+N*u;Z=ne>>>13,ne&=8191,ne+=j*l+F*c+V*a+ee*(5*b)+G*(5*y),Z+=ne>>>13,ne&=8191;let ue=Z+A*y+S*p+O*f+I*h+N*d;Z=ue>>>13,ue&=8191,ue+=j*u+F*l+V*c+ee*a+G*(5*b),Z+=ue>>>13,ue&=8191;let ye=Z+A*b+S*y+O*p+I*f+N*h;Z=ye>>>13,ye&=8191,ye+=j*d+F*u+V*l+ee*c+G*a,Z+=ye>>>13,ye&=8191,Z=(Z<<2)+Z|0,Z=Z+M|0,M=Z&8191,Z=Z>>>13,k+=Z,i[0]=M,i[1]=k,i[2]=H,i[3]=U,i[4]=$,i[5]=T,i[6]=z,i[7]=ne,i[8]=ue,i[9]=ye}finalize(){const{h:e,pad:r}=this,n=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,n[0]=e[0]+5,s=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+s,s=n[a]>>>13,n[a]&=8191;n[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)n[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+r[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+r[a]|0)+(o>>>16)|0,e[a]=o&65535}update(e){gS(this);const{buffer:r,blockLen:n}=this;e=_b(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);if(o===n){for(;n<=s-i;i+=n)this.process(e,i);continue}r.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(e){gS(this),Hj(e,this),this.finished=!0;const{buffer:r,h:n}=this;let{pos:s}=this;if(s){for(r[s++]=1;s<16;s++)r[s]=0;this.process(r,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=n[o]>>>0,e[i++]=n[o]>>>8;return e}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}}function Jj(t){const e=(n,s)=>t(s).update(_b(n)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}Jj(t=>new Wj(t));const Gj=p_("expand 16-byte k"),Zj=p_("expand 32-byte k");wC(Gj);wC(Zj);var vh;(function(t){t.authentication="authentication",t.assertionMethod="assertionMethod",t.keyAgreement="keyAgreement",t.capabilityInvocation="capabilityInvocation",t.capabilityDelegation="capabilityDelegation"})(vh||(vh={}));const In={"@context":"https://w3id.org/did-resolution/v1",didResolutionMetadata:{},didDocument:null,didDocumentMetadata:{}};let Wt=class _C{constructor({method:e,id:r,path:n,query:s,fragment:i,params:o}){this.uri=`did:${e}:${r}`,this.method=e,this.id=r,this.path=n,this.query=s,this.fragment=i,this.params=o}static parse(e){if(!e)return null;const r=_C.DID_URI_PATTERN.exec(e);if(!r||!r.groups)return null;const{method:n,id:s,path:i,query:o,fragment:a}=r.groups,c={uri:`did:${n}:${s}`,method:n,id:s};if(i&&(c.path=i),o&&(c.query=o.slice(1)),a&&(c.fragment=a.slice(1)),o){const l={},u=o.slice(1).split("&");for(const d of u){const[h,f]=d.split("=");l[h]=f}c.params=l}return c}};Wt.METHOD_PATTERN="([a-z0-9]+)";Wt.PCT_ENCODED_PATTERN="(?:%[0-9a-fA-F]{2})";Wt.ID_CHAR_PATTERN=`(?:[a-zA-Z0-9._-]|${Wt.PCT_ENCODED_PATTERN})`;Wt.METHOD_ID_PATTERN=`((?:${Wt.ID_CHAR_PATTERN}*:)*(${Wt.ID_CHAR_PATTERN}+))`;Wt.PATH_PATTERN="(/[^#?]*)?";Wt.QUERY_PATTERN="([?][^#]*)?";Wt.FRAGMENT_PATTERN="(#.*)?";Wt.DID_URI_PATTERN=new RegExp(`^did:(?<method>${Wt.METHOD_PATTERN}):(?<id>${Wt.METHOD_ID_PATTERN})(?<path>${Wt.PATH_PATTERN})(?<query>${Wt.QUERY_PATTERN})(?<fragment>${Wt.FRAGMENT_PATTERN})$`);let rt=class EC extends Error{constructor(e,r){super(`${e}: ${r}`),this.code=e,this.name="DidError",Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,EC)}};var Je;(function(t){t.InvalidDid="invalidDid",t.MethodNotSupported="methodNotSupported",t.InternalError="internalError",t.InvalidDidDocument="invalidDidDocument",t.InvalidDidDocumentLength="invalidDidDocumentLength",t.InvalidDidUrl="invalidDidUrl",t.InvalidPreviousDidProof="invalidPreviousDidProof",t.InvalidPublicKey="invalidPublicKey",t.InvalidPublicKeyLength="invalidPublicKeyLength",t.InvalidPublicKeyType="invalidPublicKeyType",t.InvalidSignature="invalidSignature",t.NotFound="notFound",t.RepresentationNotSupported="representationNotSupported",t.UnsupportedPublicKeyType="unsupportedPublicKeyType"})(Je||(Je={}));function Xj(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var y=0,b=0,w=0,g=p.length;w!==g&&p[w]===0;)w++,y++;for(var v=(g-w)*u+1>>>0,m=new Uint8Array(v);w!==g;){for(var _=p[w],x=0,D=v-1;(_!==0||x<b)&&D!==-1;D--,x++)_+=256*m[D]>>>0,m[D]=_%a>>>0,_=_/a>>>0;if(_!==0)throw new Error("Non-zero carry");b=x,w++}for(var E=v-b;E!==v&&m[E]===0;)E++;for(var A=c.repeat(y);E<v;++E)A+=t.charAt(m[E]);return A}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var y=0;if(p[y]!==" "){for(var b=0,w=0;p[y]===c;)b++,y++;for(var g=(p.length-y)*l+1>>>0,v=new Uint8Array(g);p[y];){var m=r[p.charCodeAt(y)];if(m===255)return;for(var _=0,x=g-1;(m!==0||_<w)&&x!==-1;x--,_++)m+=a*v[x]>>>0,v[x]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");w=_,y++}if(p[y]!==" "){for(var D=g-w;D!==g&&v[D]===0;)D++;for(var E=new Uint8Array(b+(g-D)),A=b;D!==g;)E[A++]=v[D++];return E}}}function f(p){var y=h(p);if(y)return y;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var Yj=Xj,Qj=Yj;const eM=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};let tM=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},rM=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return AC(this,e)}},nM=class{constructor(e){this.decoders=e}or(e){return AC(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const AC=(t,e)=>new nM({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let iM=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new tM(e,r,n),this.decoder=new rM(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const SC=({name:t,prefix:e,encode:r,decode:n})=>new iM(t,e,r,n),$C=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:s}=Qj(r,e);return SC({prefix:t,name:e,encode:n,decode:i=>eM(s(i))})},sM=(t,e,r,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},oM=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},ji=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>SC({prefix:e,name:t,encode(s){return oM(s,n,r)},decode(s){return sM(s,n,r,t)}});ji({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});ji({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});ji({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});ji({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});ji({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});ji({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});ji({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});ji({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});const vS=ji({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Ky=$C({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});$C({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});ji({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});ji({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const la=ji({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});ji({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function aM(t){return t.byteOffset!==0||t.byteLength!==t.buffer.byteLength}function uM(t){return typeof t!="object"||t===null?!1:typeof t[Symbol.asyncIterator]=="function"}function Eb(t){const r=Object.prototype.toString.call(t).match(/\s([a-zA-Z0-9]+)/),[n,s]=r;return s}var Jf=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},wS=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}};const Ly=new TextEncoder,qc=new TextDecoder;let at=class ii{constructor(e,r){this.data=e,this.format=r}static arrayBuffer(e){return new ii(e,"ArrayBuffer")}static asyncIterable(e){if(!uM(e))throw new TypeError("Input must be of type AsyncIterable.");return new ii(e,"AsyncIterable")}static base32Z(e){return new ii(e,"Base32Z")}static base58Btc(e){return new ii(e,"Base58Btc")}static base64Url(e){return new ii(e,"Base64Url")}static bufferSource(e){return new ii(e,"BufferSource")}static hex(e){if(typeof e!="string")throw new TypeError("Hex input must be a string.");if(e.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new ii(e,"Hex")}static multibase(e){return new ii(e,"Multibase")}static object(e){return new ii(e,"Object")}static string(e){return new ii(e,"String")}static uint8Array(e){return new ii(e,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return Ky.baseDecode(this.data).buffer;case"Base64Url":return la.baseDecode(this.data).buffer;case"BufferSource":{if(Eb(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return aM(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return Jf(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return vS.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return Ky.baseEncode(e)}case"Multibase":return this.data.substring(1);case"Uint8Array":return Ky.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return la.baseEncode(e)}case"BufferSource":{const e=this.toUint8Array();return la.baseEncode(e)}case"Object":{const e=JSON.stringify(this.data),r=Ly.encode(e);return la.baseEncode(r)}case"String":{const e=Ly.encode(this.data);return la.baseEncode(e)}case"Uint8Array":return la.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){var e,r,n,s;return Jf(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const c=[];try{for(var i=!0,o=wS(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const u=s;c.push(u)}}catch(u){r={error:u}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return new Blob(c)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){const e=Array.from({length:256},(r,n)=>n.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{const r=this.toUint8Array();return ii.uint8Array(r).toHex()}case"Base64Url":{const r=this.toUint8Array();return ii.uint8Array(r).toHex()}case"Uint8Array":{let r="";for(let n=0;n<this.data.length;n++)r+=e[this.data[n]];return r}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{const e=la.baseDecode(this.data),r=qc.decode(e);return JSON.parse(r)}case"String":return JSON.parse(this.data);case"Uint8Array":{const e=qc.decode(this.data);return JSON.parse(e)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return Jf(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toStringAsync();return JSON.parse(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return qc.decode(this.data);case"Base64Url":{const e=la.baseDecode(this.data);return qc.decode(e)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return qc.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){var e,r,n,s;return Jf(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let c="";try{for(var i=!0,o=wS(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const l=s;typeof l=="string"?c+=l:c+=qc.decode(l,{stream:!0})}}catch(l){r={error:l}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return c+=qc.decode(void 0,{stream:!1}),c}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return vS.baseDecode(this.data);case"Base58Btc":return Ky.baseDecode(this.data);case"Base64Url":return la.baseDecode(this.data);case"BufferSource":{const e=Eb(this.data);if(e==="Uint8Array")return this.data;if(e==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{const e=new Uint8Array(this.data.length/2);for(let r=0;r<this.data.length;r+=2){const n=parseInt(this.data.substring(r,r+2),16);if(isNaN(n))throw new TypeError("Input is not a valid hexadecimal string.");e[r/2]=n}return e}case"Object":{const e=JSON.stringify(this.data);return Ly.encode(e)}case"String":return Ly.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return Jf(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toArrayBufferAsync();return new Uint8Array(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}};var cM=xC,bS=128,lM=127,dM=~lM,fM=Math.pow(2,31);function xC(t,e,r){e=e||[],r=r||0;for(var n=r;t>=fM;)e[r++]=t&255|bS,t/=128;for(;t&dM;)e[r++]=t&255|bS,t>>>=7;return e[r]=t|0,xC.bytes=r-n+1,e}var pM=Ab,hM=128,_S=127;function Ab(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw Ab.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&_S)<<s:(o&_S)*Math.pow(2,s),s+=7}while(o>=hM);return Ab.bytes=i-n,r}var yM=Math.pow(2,7),mM=Math.pow(2,14),gM=Math.pow(2,21),vM=Math.pow(2,28),wM=Math.pow(2,35),bM=Math.pow(2,42),_M=Math.pow(2,49),EM=Math.pow(2,56),AM=Math.pow(2,63),SM=function(t){return t<yM?1:t<mM?2:t<gM?3:t<vM?4:t<wM?5:t<bM?6:t<_M?7:t<EM?8:t<AM?9:10},$M={encode:cM,decode:pM,encodingLength:SM},C0=$M;const ES=(t,e=0)=>[C0.decode(t,e),C0.decode.bytes],xM=(t,e,r=0)=>(C0.encode(t,e,r),e),DM=t=>C0.encodingLength(t);let vs=class Bu{static addPrefix(e){var r;let{code:n,data:s,name:i}=e;if(!(i?!n:n))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(n=Bu.codeToName.has(n)?n:Bu.nameToCode.get(i),n===void 0)throw new Error(`Unsupported multicodec: ${(r=e.name)!==null&&r!==void 0?r:e.code}`);const o=DM(n),a=new Uint8Array(o+s.byteLength);return a.set(s,o),xM(n,a),a}static getCodeFromData(e){const{prefixedData:r}=e,[n,s]=ES(r);return n}static getCodeFromName(e){const{name:r}=e,n=Bu.nameToCode.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static getNameFromCode(e){const{code:r}=e,n=Bu.codeToName.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static registerCodec(e){Bu.codeToName.set(e.code,e.name),Bu.nameToCode.set(e.name,e.code)}static removePrefix(e){const{prefixedData:r}=e,[n,s]=ES(r),i=Bu.codeToName.get(n);if(i===void 0)throw new Error(`Unsupported multicodec: ${n}`);return{code:n,data:r.slice(s),name:i}}};vs.codeToName=new Map;vs.nameToCode=new Map;vs.registerCodec({code:237,name:"ed25519-pub"});vs.registerCodec({code:4864,name:"ed25519-priv"});vs.registerCodec({code:236,name:"x25519-pub"});vs.registerCodec({code:4866,name:"x25519-priv"});vs.registerCodec({code:231,name:"secp256k1-pub"});vs.registerCodec({code:4865,name:"secp256k1-priv"});function DC(t){Object.keys(t).forEach(e=>{t[e]===void 0?delete t[e]:typeof t[e]=="object"&&DC(t[e])})}var Vc=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let PM=class{constructor(){this.store=new Map}clear(){return Vc(this,void 0,void 0,function*(){this.store.clear()})}close(){return Vc(this,void 0,void 0,function*(){})}delete(e){return Vc(this,void 0,void 0,function*(){return this.store.delete(e)})}get(e){return Vc(this,void 0,void 0,function*(){return this.store.get(e)})}has(e){return Vc(this,void 0,void 0,function*(){return this.store.has(e)})}list(){return Vc(this,void 0,void 0,function*(){return Array.from(this.store.values())})}set(e,r){return Vc(this,void 0,void 0,function*(){this.store.set(e,r)})}};var CM=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let PC=class{static digest({data:e}){return CM(this,void 0,void 0,function*(){return pc(e)})}},h_=class{};var kM=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let OM=class extends h_{digest({algorithm:e,data:r}){return kM(this,void 0,void 0,function*(){switch(e){case"SHA-256":return yield PC.digest({data:r})}})}};function TM(t){const e=n=>{if(n!==null&&typeof n=="object"&&!Array.isArray(n)){const s=Object.keys(n).sort(),i={};for(const o of s)i[o]=e(n[o]);return i}return n},r=e(t);return JSON.stringify(r)}var IM=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};const AS="urn:jwk:";function tr({jwk:t}){return IM(this,void 0,void 0,function*(){const e=t.kty;let r;if(e==="EC")r={crv:t.crv,kty:t.kty,x:t.x,y:t.y};else if(e==="oct")r={k:t.k,kty:t.kty};else if(e==="OKP")r={crv:t.crv,kty:t.kty,x:t.x};else if(e==="RSA")r={e:t.e,kty:t.kty,n:t.n};else throw new Error(`Unsupported key type: ${e}`);DC(r);const n=TM(r),s=at.string(n).toUint8Array(),i=yield PC.digest({data:s});return at.uint8Array(i).toBase64Url()})}function kl(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="EC"||typeof t.d!="string"||typeof t.x!="string")}function y_(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t)||"d"in t||t.kty!=="EC"||typeof t.x!="string")}function Ol(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="OKP"||typeof t.d!="string"||typeof t.x!="string")}function m_(t){return!(!t||typeof t!="object"||"d"in t||!("kty"in t&&"crv"in t&&"x"in t)||t.kty!=="OKP"||typeof t.x!="string")}function BM(t){if(!t||typeof t!="object")return!1;switch(t.kty){case"EC":case"OKP":case"RSA":return"d"in t;case"oct":return"k"in t;default:return!1}}var mn=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},FM=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let Ti=class po{static adjustSignatureToLowS({signature:e}){return mn(this,void 0,void 0,function*(){const r=qe.Signature.fromCompact(e);return r.hasHighS()?r.normalizeS().toCompactRawBytes():e})}static bytesToPrivateKey({privateKeyBytes:e}){return mn(this,void 0,void 0,function*(){const r=yield po.getCurvePoint({keyBytes:e}),n={kty:"EC",crv:"secp256k1",d:at.uint8Array(e).toBase64Url(),x:at.uint8Array(r.x).toBase64Url(),y:at.uint8Array(r.y).toBase64Url()};return n.kid=yield tr({jwk:n}),n})}static bytesToPublicKey({publicKeyBytes:e}){return mn(this,void 0,void 0,function*(){const r=yield po.getCurvePoint({keyBytes:e}),n={kty:"EC",crv:"secp256k1",x:at.uint8Array(r.x).toBase64Url(),y:at.uint8Array(r.y).toBase64Url()};return n.kid=yield tr({jwk:n}),n})}static compressPublicKey({publicKeyBytes:e}){return mn(this,void 0,void 0,function*(){return qe.ProjectivePoint.fromHex(e).toRawBytes(!0)})}static computePublicKey({key:e}){return mn(this,void 0,void 0,function*(){const r=yield po.privateKeyToBytes({privateKey:e}),n=yield po.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"secp256k1",x:at.uint8Array(n.x).toBase64Url(),y:at.uint8Array(n.y).toBase64Url()};return s.kid=yield tr({jwk:s}),s})}static convertDerToCompactSignature({derSignature:e}){return mn(this,void 0,void 0,function*(){return qe.Signature.fromDER(e).toCompactRawBytes()})}static decompressPublicKey({publicKeyBytes:e}){return mn(this,void 0,void 0,function*(){return qe.ProjectivePoint.fromHex(e).toRawBytes(!1)})}static generateKey(){return mn(this,void 0,void 0,function*(){const e=qe.utils.randomPrivateKey(),r=yield po.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield tr({jwk:r}),r})}static getPublicKey({key:e}){var r;return mn(this,void 0,void 0,function*(){if(!(kl(e)&&e.crv==="secp256k1"))throw new Error("Secp256k1: The provided key is not a secp256k1 private JWK.");let n=FM(e,["d"]);return(r=n.kid)!==null&&r!==void 0||(n.kid=yield tr({jwk:n})),n})}static privateKeyToBytes({privateKey:e}){return mn(this,void 0,void 0,function*(){if(!kl(e))throw new Error("Secp256k1: The provided key is not a valid EC private key.");return at.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return mn(this,void 0,void 0,function*(){if(!(y_(e)&&e.y))throw new Error("Secp256k1: The provided key is not a valid EC public key.");const r=new Uint8Array([4]),n=at.base64Url(e.x).toUint8Array(),s=at.base64Url(e.y).toUint8Array();return new Uint8Array([...r,...n,...s])})}static sharedSecret({privateKeyA:e,publicKeyB:r}){return mn(this,void 0,void 0,function*(){if("x"in e&&"x"in r&&e.x===r.x)throw new Error("Secp256k1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const n=yield po.privateKeyToBytes({privateKey:e}),s=yield po.publicKeyToBytes({publicKey:r});return qe.getSharedSecret(n,s,!0).slice(1)})}static sign({data:e,key:r}){return mn(this,void 0,void 0,function*(){const n=yield po.privateKeyToBytes({privateKey:r}),s=pc(e);return qe.sign(s,n).toCompactRawBytes()})}static validatePrivateKey({privateKeyBytes:e}){return mn(this,void 0,void 0,function*(){return qe.utils.isValidPrivateKey(e)})}static validatePublicKey({publicKeyBytes:e}){return mn(this,void 0,void 0,function*(){try{qe.ProjectivePoint.fromHex(e).assertValidity()}catch{return!1}return!0})}static verify({key:e,signature:r,data:n}){return mn(this,void 0,void 0,function*(){const s=yield po.publicKeyToBytes({publicKey:e}),i=pc(n);return qe.verify(r,i,s,{lowS:!1})})}static getCurvePoint({keyBytes:e}){return mn(this,void 0,void 0,function*(){e.byteLength===32&&(e=qe.getPublicKey(e));const r=qe.ProjectivePoint.fromHex(e),n=fr(r.x,32),s=fr(r.y,32);return{x:n,y:s}})}};var gn=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},NM=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let fs=class ho{static adjustSignatureToLowS({signature:e}){return gn(this,void 0,void 0,function*(){const r=Ve.Signature.fromCompact(e);return r.hasHighS()?r.normalizeS().toCompactRawBytes():e})}static bytesToPrivateKey({privateKeyBytes:e}){return gn(this,void 0,void 0,function*(){const r=yield ho.getCurvePoint({keyBytes:e}),n={kty:"EC",crv:"P-256",d:at.uint8Array(e).toBase64Url(),x:at.uint8Array(r.x).toBase64Url(),y:at.uint8Array(r.y).toBase64Url()};return n.kid=yield tr({jwk:n}),n})}static bytesToPublicKey({publicKeyBytes:e}){return gn(this,void 0,void 0,function*(){const r=yield ho.getCurvePoint({keyBytes:e}),n={kty:"EC",crv:"P-256",x:at.uint8Array(r.x).toBase64Url(),y:at.uint8Array(r.y).toBase64Url()};return n.kid=yield tr({jwk:n}),n})}static compressPublicKey({publicKeyBytes:e}){return gn(this,void 0,void 0,function*(){return Ve.ProjectivePoint.fromHex(e).toRawBytes(!0)})}static computePublicKey({key:e}){return gn(this,void 0,void 0,function*(){const r=yield ho.privateKeyToBytes({privateKey:e}),n=yield ho.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"P-256",x:at.uint8Array(n.x).toBase64Url(),y:at.uint8Array(n.y).toBase64Url()};return s.kid=yield tr({jwk:s}),s})}static convertDerToCompactSignature({derSignature:e}){return gn(this,void 0,void 0,function*(){return Ve.Signature.fromDER(e).toCompactRawBytes()})}static decompressPublicKey({publicKeyBytes:e}){return gn(this,void 0,void 0,function*(){return Ve.ProjectivePoint.fromHex(e).toRawBytes(!1)})}static generateKey(){return gn(this,void 0,void 0,function*(){const e=Ve.utils.randomPrivateKey(),r=yield ho.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield tr({jwk:r}),r})}static getPublicKey({key:e}){var r;return gn(this,void 0,void 0,function*(){if(!(kl(e)&&e.crv==="P-256"))throw new Error("Secp256r1: The provided key is not a 'P-256' private JWK.");let n=NM(e,["d"]);return(r=n.kid)!==null&&r!==void 0||(n.kid=yield tr({jwk:n})),n})}static privateKeyToBytes({privateKey:e}){return gn(this,void 0,void 0,function*(){if(!kl(e))throw new Error("Secp256r1: The provided key is not a valid EC private key.");return at.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return gn(this,void 0,void 0,function*(){if(!(y_(e)&&e.y))throw new Error("Secp256r1: The provided key is not a valid EC public key.");const r=new Uint8Array([4]),n=at.base64Url(e.x).toUint8Array(),s=at.base64Url(e.y).toUint8Array();return new Uint8Array([...r,...n,...s])})}static sharedSecret({privateKeyA:e,publicKeyB:r}){return gn(this,void 0,void 0,function*(){if("x"in e&&"x"in r&&e.x===r.x)throw new Error("Secp256r1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const n=yield ho.privateKeyToBytes({privateKey:e}),s=yield ho.publicKeyToBytes({publicKey:r});return Ve.getSharedSecret(n,s,!0).slice(1)})}static sign({data:e,key:r}){return gn(this,void 0,void 0,function*(){const n=yield ho.privateKeyToBytes({privateKey:r}),s=pc(e);return Ve.sign(s,n).toCompactRawBytes()})}static validatePrivateKey({privateKeyBytes:e}){return gn(this,void 0,void 0,function*(){return Ve.utils.isValidPrivateKey(e)})}static validatePublicKey({publicKeyBytes:e}){return gn(this,void 0,void 0,function*(){try{Ve.ProjectivePoint.fromHex(e).assertValidity()}catch{return!1}return!0})}static verify({key:e,signature:r,data:n}){return gn(this,void 0,void 0,function*(){const s=yield ho.publicKeyToBytes({publicKey:e}),i=pc(n);return Ve.verify(r,i,s,{lowS:!1})})}static getCurvePoint({keyBytes:e}){return gn(this,void 0,void 0,function*(){e.byteLength===32&&(e=Ve.getPublicKey(e));const r=Ve.ProjectivePoint.fromHex(e),n=fr(r.x,32),s=fr(r.y,32);return{x:n,y:s}})}};var Gf=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let SS=class extends h_{computePublicKey({key:e}){return Gf(this,void 0,void 0,function*(){if(!kl(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(e.crv){case"secp256k1":{const r=yield Ti.computePublicKey({key:e});return r.alg="ES256K",r}case"P-256":{const r=yield fs.computePublicKey({key:e});return r.alg="ES256",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}generateKey({algorithm:e}){return Gf(this,void 0,void 0,function*(){switch(e){case"ES256K":case"secp256k1":{const r=yield Ti.generateKey();return r.alg="ES256K",r}case"ES256":case"secp256r1":{const r=yield fs.generateKey();return r.alg="ES256",r}}})}getPublicKey({key:e}){return Gf(this,void 0,void 0,function*(){if(!kl(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(e.crv){case"secp256k1":{const r=yield Ti.getPublicKey({key:e});return r.alg="ES256K",r}case"P-256":{const r=yield fs.getPublicKey({key:e});return r.alg="ES256",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}sign({key:e,data:r}){return Gf(this,void 0,void 0,function*(){if(!kl(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(e.crv){case"secp256k1":return yield Ti.sign({key:e,data:r});case"P-256":return yield fs.sign({key:e,data:r});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}verify({key:e,signature:r,data:n}){return Gf(this,void 0,void 0,function*(){if(!y_(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) public key.");switch(e.crv){case"secp256k1":return yield Ti.verify({key:e,signature:r,data:n});case"P-256":return yield fs.verify({key:e,signature:r,data:n});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}};var Wi=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},RM=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let yi=class Fu{static bytesToPrivateKey({privateKeyBytes:e}){return Wi(this,void 0,void 0,function*(){const r=Ht.getPublicKey(e),n={crv:"Ed25519",d:at.uint8Array(e).toBase64Url(),kty:"OKP",x:at.uint8Array(r).toBase64Url()};return n.kid=yield tr({jwk:n}),n})}static bytesToPublicKey({publicKeyBytes:e}){return Wi(this,void 0,void 0,function*(){const r={kty:"OKP",crv:"Ed25519",x:at.uint8Array(e).toBase64Url()};return r.kid=yield tr({jwk:r}),r})}static computePublicKey({key:e}){return Wi(this,void 0,void 0,function*(){const r=yield Fu.privateKeyToBytes({privateKey:e}),n=Ht.getPublicKey(r),s={kty:"OKP",crv:"Ed25519",x:at.uint8Array(n).toBase64Url()};return s.kid=yield tr({jwk:s}),s})}static convertPrivateKeyToX25519({privateKey:e}){return Wi(this,void 0,void 0,function*(){const r=yield Fu.privateKeyToBytes({privateKey:e}),n=Zh(r),s=Tn.getPublicKey(n),i={kty:"OKP",crv:"X25519",d:at.uint8Array(n).toBase64Url(),x:at.uint8Array(s).toBase64Url()};return i.kid=yield tr({jwk:i}),i})}static convertPublicKeyToX25519({publicKey:e}){return Wi(this,void 0,void 0,function*(){const r=yield Fu.publicKeyToBytes({publicKey:e});if(!(yield Fu.validatePublicKey({publicKeyBytes:r})))throw new Error("Ed25519: Invalid public key.");const s=Gh(r),i={kty:"OKP",crv:"X25519",x:at.uint8Array(s).toBase64Url()};return i.kid=yield tr({jwk:i}),i})}static generateKey(){return Wi(this,void 0,void 0,function*(){const e=Ht.utils.randomPrivateKey(),r=yield Fu.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield tr({jwk:r}),r})}static getPublicKey({key:e}){var r;return Wi(this,void 0,void 0,function*(){if(!(Ol(e)&&e.crv==="Ed25519"))throw new Error("Ed25519: The provided key is not an Ed25519 private JWK.");let n=RM(e,["d"]);return(r=n.kid)!==null&&r!==void 0||(n.kid=yield tr({jwk:n})),n})}static privateKeyToBytes({privateKey:e}){return Wi(this,void 0,void 0,function*(){if(!Ol(e))throw new Error("Ed25519: The provided key is not a valid OKP private key.");return at.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return Wi(this,void 0,void 0,function*(){if(!m_(e))throw new Error("Ed25519: The provided key is not a valid OKP public key.");return at.base64Url(e.x).toUint8Array()})}static sign({key:e,data:r}){return Wi(this,void 0,void 0,function*(){const n=yield Fu.privateKeyToBytes({privateKey:e});return Ht.sign(r,n)})}static validatePublicKey({publicKeyBytes:e}){return Wi(this,void 0,void 0,function*(){try{Ht.ExtendedPoint.fromHex(e).assertValidity()}catch{return!1}return!0})}static verify({key:e,signature:r,data:n}){return Wi(this,void 0,void 0,function*(){const s=yield Fu.publicKeyToBytes({publicKey:e});return Ht.verify(r,n,s)})}};var Zf=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let jM=class extends h_{computePublicKey({key:e}){return Zf(this,void 0,void 0,function*(){if(!Ol(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(e.crv){case"Ed25519":{const r=yield yi.computePublicKey({key:e});return r.alg="EdDSA",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}generateKey({algorithm:e}){return Zf(this,void 0,void 0,function*(){switch(e){case"Ed25519":{const r=yield yi.generateKey();return r.alg="EdDSA",r}}})}getPublicKey({key:e}){return Zf(this,void 0,void 0,function*(){if(!Ol(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(e.crv){case"Ed25519":{const r=yield yi.getPublicKey({key:e});return r.alg="EdDSA",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}sign({key:e,data:r}){return Zf(this,void 0,void 0,function*(){if(!Ol(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(e.crv){case"Ed25519":return yield yi.sign({key:e,data:r});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}verify({key:e,signature:r,data:n}){return Zf(this,void 0,void 0,function*(){if(!m_(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) public key.");switch(e.crv){case"Ed25519":return yield yi.verify({key:e,signature:r,data:n});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}};var da=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};const Wv={Ed25519:{implementation:jM,names:["Ed25519"]},secp256k1:{implementation:SS,names:["ES256K","secp256k1"]},secp256r1:{implementation:SS,names:["ES256","secp256r1"]},"SHA-256":{implementation:OM,names:["SHA-256"]}};let Wa=class{constructor(e){var r;this._algorithmInstances=new Map,this._keyStore=(r=e==null?void 0:e.keyStore)!==null&&r!==void 0?r:new PM}digest({algorithm:e,data:r}){return da(this,void 0,void 0,function*(){return yield this.getAlgorithm({algorithm:e}).digest({algorithm:e,data:r})})}exportKey({keyUri:e}){return da(this,void 0,void 0,function*(){return yield this.getPrivateKey({keyUri:e})})}generateKey({algorithm:e}){return da(this,void 0,void 0,function*(){const n=yield this.getAlgorithm({algorithm:e}).generateKey({algorithm:e});if((n==null?void 0:n.kid)===void 0)throw new Error("Generated key is missing a required property: kid");const s=`${AS}${n.kid}`;return yield this._keyStore.set(s,n),s})}getKeyUri({key:e}){return da(this,void 0,void 0,function*(){const r=yield tr({jwk:e});return`${AS}${r}`})}getPublicKey({keyUri:e}){return da(this,void 0,void 0,function*(){const r=yield this.getPrivateKey({keyUri:e}),n=this.getAlgorithmName({key:r});return yield this.getAlgorithm({algorithm:n}).getPublicKey({key:r})})}importKey({key:e}){var r;return da(this,void 0,void 0,function*(){if(!BM(e))throw new TypeError("Invalid key provided. Must be a private key in JWK format.");const n=structuredClone(e);(r=n.kid)!==null&&r!==void 0||(n.kid=yield tr({jwk:n}));const s=yield this.getKeyUri({key:n});return yield this._keyStore.set(s,n),s})}sign({keyUri:e,data:r}){return da(this,void 0,void 0,function*(){const n=yield this.getPrivateKey({keyUri:e}),s=this.getAlgorithmName({key:n});return this.getAlgorithm({algorithm:s}).sign({data:r,key:n})})}verify({key:e,signature:r,data:n}){return da(this,void 0,void 0,function*(){const s=this.getAlgorithmName({key:e});return this.getAlgorithm({algorithm:s}).verify({key:e,signature:r,data:n})})}getAlgorithm({algorithm:e}){var r;const n=(r=Wv[e])===null||r===void 0?void 0:r.implementation;if(!n)throw new Error(`Algorithm not supported: ${e}`);return this._algorithmInstances.has(n)||this._algorithmInstances.set(n,new n),this._algorithmInstances.get(n)}getAlgorithmName({key:e}){const r=e.alg,n=e.crv;for(const s in Wv){const i=Wv[s];if(r&&i.names.includes(r))return s;if(n&&i.names.includes(n))return s}throw new Error(`Unable to determine algorithm based on provided input: alg=${r}, crv=${n}`)}getPrivateKey({keyUri:e}){return da(this,void 0,void 0,function*(){const r=yield this._keyStore.get(e);if(!r)throw new Error(`Key not found: ${e}`);return r})}};function MM(t){const e={Ed25519:"EdDSA","P-256":"ES256","P-384":"ES384","P-521":"ES512",secp256k1:"ES256K"};if(t.alg&&Object.values(e).includes(t.alg))return t.alg;if(t.crv&&Object.keys(e).includes(t.crv))return e[t.crv];throw new Error(`Unable to determine algorithm based on provided input: alg=${t.alg}, crv=${t.crv}. Supported 'alg' values: ${Object.values(e).join(", ")}. Supported 'crv' values: ${Object.keys(e).join(", ")}.`)}var pu=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},UM=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let CC=class kp{static bytesToPrivateKey({privateKeyBytes:e}){return pu(this,void 0,void 0,function*(){const r=Tn.getPublicKey(e),n={kty:"OKP",crv:"X25519",d:at.uint8Array(e).toBase64Url(),x:at.uint8Array(r).toBase64Url()};return n.kid=yield tr({jwk:n}),n})}static bytesToPublicKey({publicKeyBytes:e}){return pu(this,void 0,void 0,function*(){const r={kty:"OKP",crv:"X25519",x:at.uint8Array(e).toBase64Url()};return r.kid=yield tr({jwk:r}),r})}static computePublicKey({key:e}){return pu(this,void 0,void 0,function*(){const r=yield kp.privateKeyToBytes({privateKey:e}),n=Tn.getPublicKey(r),s={kty:"OKP",crv:"X25519",x:at.uint8Array(n).toBase64Url()};return s.kid=yield tr({jwk:s}),s})}static generateKey(){return pu(this,void 0,void 0,function*(){const e=Tn.utils.randomPrivateKey(),r=yield kp.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield tr({jwk:r}),r})}static getPublicKey({key:e}){var r;return pu(this,void 0,void 0,function*(){if(!(Ol(e)&&e.crv==="X25519"))throw new Error("X25519: The provided key is not an X25519 private JWK.");let n=UM(e,["d"]);return(r=n.kid)!==null&&r!==void 0||(n.kid=yield tr({jwk:n})),n})}static privateKeyToBytes({privateKey:e}){return pu(this,void 0,void 0,function*(){if(!Ol(e))throw new Error("X25519: The provided key is not a valid OKP private key.");return at.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return pu(this,void 0,void 0,function*(){if(!m_(e))throw new Error("X25519: The provided key is not a valid OKP public key.");return at.base64Url(e.x).toUint8Array()})}static sharedSecret({privateKeyA:e,publicKeyB:r}){return pu(this,void 0,void 0,function*(){if("x"in e&&"x"in r&&e.x===r.x)throw new Error("X25519: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const n=yield kp.privateKeyToBytes({privateKey:e}),s=yield kp.publicKeyToBytes({publicKey:r});return Tn.getSharedSecret(n,s)})}};function Ks(t){if(typeof t=="string"&&t.length!==0)return t.split("#").pop()}function kC({didDocument:t}){var e,r;if(!t)throw new TypeError("Required parameter missing: 'didDocument'");const n=[];return n.push(...(r=(e=t.verificationMethod)===null||e===void 0?void 0:e.filter(Sb))!==null&&r!==void 0?r:[]),Object.keys(vh).forEach(s=>{var i,o;n.push(...(o=(i=t[s])===null||i===void 0?void 0:i.filter(Sb))!==null&&o!==void 0?o:[])}),n}function KM({didDocument:t}){const r=kC({didDocument:t}).map(n=>n.type);return[...new Set(r)]}function LM({didDocument:t,methodId:e}){const r=[];return Object.keys(vh).forEach(n=>{if(Array.isArray(t[n])){const s=t[n],i=Ks(e);s.some(a=>{const c=Ks(a)===i,l=Sb(a)&&Ks(a.id)===i;return c||l})&&r.push(n)}}),r}function Sb(t){return!(!t||typeof t!="object"||t===null||!("id"in t&&"type"in t&&"controller"in t)||typeof t.id!="string"||typeof t.type!="string"||typeof t.controller!="string")}function OC({keyBytes:t,multicodecCode:e,multicodecName:r}){const n=vs.addPrefix({code:e,data:t,name:r}),s=at.uint8Array(n).toBase58Btc();return at.base58Btc(s).toMultibase()}function $S({multibaseKeyId:t}){try{const e=at.multibase(t).toBase58Btc(),r=at.base58Btc(e).toUint8Array(),{code:n,data:s,name:i}=vs.removePrefix({prefixedData:r});return{keyBytes:s,multicodecCode:n,multicodecName:i}}catch{throw new rt(Je.InvalidDid,`Invalid multibase identifier: ${t}`)}}var Xf=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let yc=class TC{constructor({uri:e,document:r,metadata:n,keyManager:s}){this.uri=e,this.document=r,this.metadata=n,this.keyManager=s}export(){return Xf(this,void 0,void 0,function*(){if(!(Array.isArray(this.document.verificationMethod)&&this.document.verificationMethod.length>0))throw new Error(`DID document for '${this.uri}' is missing verification methods`);let e={uri:this.uri,document:this.document,metadata:this.metadata};if("exportKey"in this.keyManager&&typeof this.keyManager.exportKey=="function"){const r=[];for(let n of this.document.verificationMethod){if(!n.publicKeyJwk)throw new Error(`Verification method '${n.id}' does not contain a public key in JWK format`);const s=yield this.keyManager.getKeyUri({key:n.publicKeyJwk}),i=yield this.keyManager.exportKey({keyUri:s});r.push(Object.assign({},i))}e.privateKeys=r}return e})}getSigner(e){return Xf(this,void 0,void 0,function*(){var r;const n=(r=this.document.verificationMethod)===null||r===void 0?void 0:r.find(c=>{var l,u;return Ks(c.id)===((l=Ks(e==null?void 0:e.methodId))!==null&&l!==void 0?l:Ks((u=this.document.assertionMethod)===null||u===void 0?void 0:u[0]))});if(!(n&&n.publicKeyJwk))throw new rt(Je.InternalError,"A verification method intended for signing could not be determined from the DID Document");const s=yield this.keyManager.getKeyUri({key:n.publicKeyJwk}),i=yield this.keyManager.getPublicKey({keyUri:s}),o=this.keyManager;return{algorithm:MM(i),keyId:n.id,sign(c){return Xf(this,arguments,void 0,function*({data:l}){return yield o.sign({data:l,keyUri:s})})},verify(c){return Xf(this,arguments,void 0,function*({data:l,signature:u}){return yield o.verify({data:l,key:i,signature:u})})}}})}static import(e){return Xf(this,arguments,void 0,function*({portableDid:r,keyManager:n=new Wa}){var s;const i=kC({didDocument:r.document});if(i.length===0)throw new rt(Je.InvalidDidDocument,"At least one verification method is required but 0 were given");for(let a of(s=r.privateKeys)!==null&&s!==void 0?s:[])yield n.importKey({key:a});for(let a of i){if(!a.publicKeyJwk)throw new Error(`Verification method '${a.id}' does not contain a public key in JWK format`);const c=yield n.getKeyUri({key:a.publicKeyJwk});yield n.getPublicKey({keyUri:c})}return new TC({uri:r.uri,document:r.document,metadata:r.metadata,keyManager:n})})}};/* Common package for dealing with hex/string/uint8 conversions (and sha1 hashing)
*
* @author   Jimmy Wärting <jimmy@warting.se> (https://jimmy.warting.se/opensource)
* @license  MIT
*/const xS="0123456789abcdef",IC=[];for(let t=0;t<256;t++)IC[t]=xS[t>>4&15]+xS[t&15];const qM=t=>{const e=t.length;let r="",n=0;for(;n<e;)r+=IC[t[n++]];return r},VM=(t,e=0)=>{const r=t.length||0;if(!e){let o=r;for(;o--;)e+=t[o].length}const n=new Uint8Array(e);let s=e,i=r;for(;i--;)s-=t[i].length,n.set(t[i],s);return n};var DS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",zM=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var qy=0;qy<DS.length;qy++)zM[DS.charCodeAt(qy)]=qy;const HM=new TextDecoder,BC=(t,e)=>HM.decode(t),WM=new TextEncoder,Ja=t=>WM.encode(t),PS=typeof window<"u"?window:self,CS=PS.crypto||PS.msCrypto||{};CS.subtle||CS.webkitSubtle;function Xh(t){const e=t<0?1:0;return t=Math.abs(Number(t||1)),Math.floor(Math.log10(t))+1+e}function FC(t){return ArrayBuffer.isView(t)?"arraybufferview":Array.isArray(t)?"array":t instanceof Number?"number":t instanceof Boolean?"boolean":t instanceof Set?"set":t instanceof Map?"map":t instanceof String?"string":t instanceof ArrayBuffer?"arraybuffer":typeof t}function qt(t,e,r){const n=[];let s=null;return qt._encode(n,t),s=VM(n),qt.bytes=s.length,ArrayBuffer.isView(e)?(e.set(s,r),e):s}qt.bytes=-1;qt._floatConversionDetected=!1;qt._encode=function(t,e){if(e!=null)switch(FC(e)){case"object":qt.dict(t,e);break;case"map":qt.dictMap(t,e);break;case"array":qt.list(t,e);break;case"set":qt.listSet(t,e);break;case"string":qt.string(t,e);break;case"number":qt.number(t,e);break;case"boolean":qt.number(t,e);break;case"arraybufferview":qt.buffer(t,new Uint8Array(e.buffer,e.byteOffset,e.byteLength));break;case"arraybuffer":qt.buffer(t,new Uint8Array(e));break}};const kg=new Uint8Array([101]),NC=new Uint8Array([100]),RC=new Uint8Array([108]);qt.buffer=function(t,e){t.push(Ja(e.length+":"),e)};qt.string=function(t,e){t.push(Ja(Ja(e).byteLength+":"+e))};qt.number=function(t,e){if(Number.isInteger(e))return t.push(Ja("i"+BigInt(e)+"e"));const r=2147483648,n=e/r<<0,s=e%r<<0,i=n*r+s;t.push(Ja("i"+i+"e")),i!==e&&!qt._floatConversionDetected&&(qt._floatConversionDetected=!0,console.warn('WARNING: Possible data corruption detected with value "'+e+'":','Bencoding only defines support for integers, value was converted to "'+i+'"'),console.trace())};qt.dict=function(t,e){t.push(NC);let r=0,n;const s=Object.keys(e).sort(),i=s.length;for(;r<i;r++)n=s[r],e[n]!=null&&(qt.string(t,n),qt._encode(t,e[n]));t.push(kg)};qt.dictMap=function(t,e){t.push(NC);const r=Array.from(e.keys()).sort();for(const n of r)e.get(n)!=null&&(ArrayBuffer.isView(n)?qt._encode(t,n):qt.string(t,String(n)),qt._encode(t,e.get(n)));t.push(kg)};qt.list=function(t,e){let r=0;const n=e.length;for(t.push(RC);r<n;r++)e[r]!=null&&qt._encode(t,e[r]);t.push(kg)};qt.listSet=function(t,e){t.push(RC);for(const r of e)r!=null&&qt._encode(t,r);t.push(kg)};const JM=105,GM=58,ZM=100,XM=108,g_=101;function jC(t,e,r){let n=0,s=1;for(let i=e;i<r;i++){const o=t[i];if(o<58&&o>=48){n=n*10+(o-48);continue}if(!(i===e&&o===43)){if(i===e&&o===45){s=-1;continue}if(o===46)break;throw new Error("not a number: buffer["+i+"] = "+o)}}return n*s}function lt(t,e,r,n){return t==null||t.length===0?null:(typeof e!="number"&&n==null&&(n=e,e=void 0),typeof r!="number"&&n==null&&(n=r,r=void 0),lt.position=0,lt.encoding=n||null,lt.data=ArrayBuffer.isView(t)?new Uint8Array(t.slice(e,r)):Ja(t),lt.bytes=lt.data.length,lt.next())}lt.bytes=0;lt.position=0;lt.data=null;lt.encoding=null;lt.next=function(){switch(lt.data[lt.position]){case ZM:return lt.dictionary();case XM:return lt.list();case JM:return lt.integer();default:return lt.buffer()}};lt.find=function(t){let e=lt.position;const r=lt.data.length,n=lt.data;for(;e<r;){if(n[e]===t)return e;e++}throw new Error('Invalid data: Missing delimiter "'+String.fromCharCode(t)+'" [0x'+t.toString(16)+"]")};lt.dictionary=function(){lt.position++;const t={};for(;lt.data[lt.position]!==g_;){const e=lt.buffer();let r=BC(e);r.includes("�")&&(r=qM(e)),t[r]=lt.next()}return lt.position++,t};lt.list=function(){lt.position++;const t=[];for(;lt.data[lt.position]!==g_;)t.push(lt.next());return lt.position++,t};lt.integer=function(){const t=lt.find(g_),e=jC(lt.data,lt.position+1,t);return lt.position+=t+1-lt.position,e};lt.buffer=function(){let t=lt.find(GM);const e=jC(lt.data,lt.position,t),r=++t+e;return lt.position=r,lt.encoding?BC(lt.data.slice(t,r)):lt.data.slice(t,r)};function YM(t){let e=2;for(const r of t)e+=Yh(r);return e}function QM(t){let e=2;for(const[r,n]of t){const s=Ja(r).byteLength;e+=Xh(s)+1+s,e+=Yh(n)}return e}function e9(t){let e=2;const r=Object.keys(t);for(let n=0;n<r.length;n++){const s=Ja(r[n]).byteLength;e+=Xh(s)+1+s,e+=Yh(t[r[n]])}return e}function t9(t){const e=Ja(t).byteLength;return Xh(e)+1+e}function r9(t){const e=t.byteLength-t.byteOffset;return Xh(e)+1+e}function Yh(t){if(t==null)return 0;const r=FC(t);switch(r){case"arraybufferview":return r9(t);case"string":return t9(t);case"array":case"set":return YM(t);case"number":return 1+Xh(Math.floor(t))+1;case"bigint":return 1+t.toString().length+1;case"object":return e9(t);case"map":return QM(t);default:throw new TypeError(`Unsupported value of type "${r}"`)}}const n9=Yh,Qd={encode:qt,decode:lt,byteLength:Yh,encodingLength:n9},i9=/^(\d{1,3}\.){3,3}\d{1,3}$/,kS=4,s9=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i,Vy=16,Ro={name:"v4",size:kS,isFormat:t=>i9.test(t),encode(t,e,r){r=~~r,e=e||new Uint8Array(r+kS);const n=t.length;let s=0;for(let i=0;i<n;){const o=t.charCodeAt(i++);o===46?(e[r++]=s,s=0):s=s*10+(o-48)}return e[r]=s,e},decode(t,e){return e=~~e,`${t[e++]}.${t[e++]}.${t[e++]}.${t[e]}`}},ac={name:"v6",size:Vy,isFormat:t=>t.length>0&&s9.test(t),encode(t,e,r){r=~~r;let n=r+Vy,s=-1,i=0,o=0,a=!0,c=!1;e=e||new Uint8Array(r+Vy);for(let l=0;l<t.length;l++){let u=t.charCodeAt(l);u===58?(a?s!==-1?(r<n&&(e[r]=0),r<n-1&&(e[r+1]=0),r+=2):r<n&&(s=r):(c===!0?(r<n&&(e[r]=o),r++):(r<n&&(e[r]=i>>8),r<n-1&&(e[r+1]=i&255),r+=2),i=0,o=0),a=!0,c=!1):u===46?(r<n&&(e[r]=o),r++,o=0,i=0,a=!1,c=!0):(a=!1,u>=97?u-=87:u>=65?u-=55:(u-=48,o=o*10+u),i=(i<<4)+u)}if(a===!1)c===!0?(r<n&&(e[r]=o),r++):(r<n&&(e[r]=i>>8),r<n-1&&(e[r+1]=i&255),r+=2);else if(s===0)r<n&&(e[r]=0),r<n-1&&(e[r+1]=0),r+=2;else if(s!==-1){r+=2;for(let l=Math.min(r-1,n-1);l>=s+2;l--)e[l]=e[l-2];e[s]=0,e[s+1]=0,s=r}if(s!==r&&s!==-1)for(r>n-2&&(r=n-2);n>s;)e[--n]=r<n&&r>s?e[--r]:0;else for(;r<n;)e[r++]=0;return e},decode(t,e){e=~~e;let r="";for(let n=0;n<Vy;n+=2)n!==0&&(r+=":"),r+=(t[e+n]<<8|t[e+n+1]).toString(16);return r.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}};function MC(t){if(Ro.isFormat(t))return Ro.size;if(ac.isFormat(t))return ac.size;throw Error(`Invalid ip address: ${t}`)}function o9(t){return MC(t)===Ro.size?1:2}function a9(t,e,r){r=~~r;const n=MC(t);return typeof e=="function"&&(e=e(r+n)),n===Ro.size?Ro.encode(t,e,r):ac.encode(t,e,r)}function u9(t,e,r){if(e=~~e,r=r||t.length-e,r===Ro.size)return Ro.decode(t,e,r);if(r===ac.size)return ac.decode(t,e,r);throw Error(`Invalid buffer size needs to be ${Ro.size} for v4 or ${ac.size} for v6.`)}function Og(t){switch(t){case 1:return"A";case 10:return"NULL";case 28:return"AAAA";case 18:return"AFSDB";case 42:return"APL";case 257:return"CAA";case 60:return"CDNSKEY";case 59:return"CDS";case 37:return"CERT";case 5:return"CNAME";case 49:return"DHCID";case 32769:return"DLV";case 39:return"DNAME";case 48:return"DNSKEY";case 43:return"DS";case 55:return"HIP";case 13:return"HINFO";case 45:return"IPSECKEY";case 25:return"KEY";case 36:return"KX";case 29:return"LOC";case 15:return"MX";case 35:return"NAPTR";case 2:return"NS";case 47:return"NSEC";case 50:return"NSEC3";case 51:return"NSEC3PARAM";case 12:return"PTR";case 46:return"RRSIG";case 17:return"RP";case 24:return"SIG";case 6:return"SOA";case 99:return"SPF";case 33:return"SRV";case 44:return"SSHFP";case 32768:return"TA";case 249:return"TKEY";case 52:return"TLSA";case 250:return"TSIG";case 16:return"TXT";case 252:return"AXFR";case 251:return"IXFR";case 41:return"OPT";case 255:return"ANY"}return"UNKNOWN_"+t}function wh(t){switch(t.toUpperCase()){case"A":return 1;case"NULL":return 10;case"AAAA":return 28;case"AFSDB":return 18;case"APL":return 42;case"CAA":return 257;case"CDNSKEY":return 60;case"CDS":return 59;case"CERT":return 37;case"CNAME":return 5;case"DHCID":return 49;case"DLV":return 32769;case"DNAME":return 39;case"DNSKEY":return 48;case"DS":return 43;case"HIP":return 55;case"HINFO":return 13;case"IPSECKEY":return 45;case"KEY":return 25;case"KX":return 36;case"LOC":return 29;case"MX":return 15;case"NAPTR":return 35;case"NS":return 2;case"NSEC":return 47;case"NSEC3":return 50;case"NSEC3PARAM":return 51;case"PTR":return 12;case"RRSIG":return 46;case"RP":return 17;case"SIG":return 24;case"SOA":return 6;case"SPF":return 99;case"SRV":return 33;case"SSHFP":return 44;case"TA":return 32768;case"TKEY":return 249;case"TLSA":return 52;case"TSIG":return 250;case"TXT":return 16;case"AXFR":return 252;case"IXFR":return 251;case"OPT":return 41;case"ANY":return 255;case"*":return 255}return t.toUpperCase().startsWith("UNKNOWN_")?parseInt(t.slice(8)):0}function c9(t){switch(t){case 0:return"NOERROR";case 1:return"FORMERR";case 2:return"SERVFAIL";case 3:return"NXDOMAIN";case 4:return"NOTIMP";case 5:return"REFUSED";case 6:return"YXDOMAIN";case 7:return"YXRRSET";case 8:return"NXRRSET";case 9:return"NOTAUTH";case 10:return"NOTZONE";case 11:return"RCODE_11";case 12:return"RCODE_12";case 13:return"RCODE_13";case 14:return"RCODE_14";case 15:return"RCODE_15"}return"RCODE_"+t}function l9(t){switch(t){case 0:return"QUERY";case 1:return"IQUERY";case 2:return"STATUS";case 3:return"OPCODE_3";case 4:return"NOTIFY";case 5:return"UPDATE";case 6:return"OPCODE_6";case 7:return"OPCODE_7";case 8:return"OPCODE_8";case 9:return"OPCODE_9";case 10:return"OPCODE_10";case 11:return"OPCODE_11";case 12:return"OPCODE_12";case 13:return"OPCODE_13";case 14:return"OPCODE_14";case 15:return"OPCODE_15"}return"OPCODE_"+t}function UC(t){switch(t){case 1:return"IN";case 2:return"CS";case 3:return"CH";case 4:return"HS";case 255:return"ANY"}return"UNKNOWN_"+t}function KC(t){switch(t.toUpperCase()){case"IN":return 1;case"CS":return 2;case"CH":return 3;case"HS":return 4;case"ANY":return 255}return 0}function d9(t){switch(t){case 1:return"LLQ";case 2:return"UL";case 3:return"NSID";case 5:return"DAU";case 6:return"DHU";case 7:return"N3U";case 8:return"CLIENT_SUBNET";case 9:return"EXPIRE";case 10:return"COOKIE";case 11:return"TCP_KEEPALIVE";case 12:return"PADDING";case 13:return"CHAIN";case 14:return"KEY_TAG";case 26946:return"DEVICEID"}return t<0?null:`OPTION_${t}`}function OS(t){if(typeof t=="number")return t;if(!t)return-1;switch(t.toUpperCase()){case"OPTION_0":return 0;case"LLQ":return 1;case"UL":return 2;case"NSID":return 3;case"OPTION_4":return 4;case"DAU":return 5;case"DHU":return 6;case"N3U":return 7;case"CLIENT_SUBNET":return 8;case"EXPIRE":return 9;case"COOKIE":return 10;case"TCP_KEEPALIVE":return 11;case"PADDING":return 12;case"CHAIN":return 13;case"KEY_TAG":return 14;case"DEVICEID":return 26946;case"OPTION_65535":return 65535}const e=t.match(/_(\d+)$/);return e?parseInt(e[1],10):-1}const v_=55296,bh=56320;function LC(t){let e=0;const r=t.length;for(let n=0;n<r;n+=1){const s=t.charCodeAt(n);if(s<=127)e+=1;else if(s<=2047)e+=2;else if((s&63488)!==v_)e+=3;else{const i=n+1;i===r||s>=bh||(t.charCodeAt(i)&64512)!==bh?e+=3:(n=i,e+=4)}}return e}function _h(t,e,r){const n=t.length;r==null&&(r=0),e===void 0&&(e=new Uint8Array(LC(t)+r));let s=r;for(let i=0;i<n;i+=1){let o=t.charCodeAt(i);if(o<=127)e[s++]=o;else if(o<=2047)e[s++]=192|(o&1984)>>6,e[s++]=128|o&63;else if((o&63488)!==v_)e[s++]=224|(o&61440)>>12,e[s++]=128|(o&4032)>>6,e[s++]=128|o&63;else{const a=i+1;if(a===n||o>=bh)e[s++]=239,e[s++]=191,e[s++]=189;else{const c=t.charCodeAt(a);(c&64512)!==bh?(e[s++]=239,e[s++]=191,e[s++]=189):(i=a,o=65536|(o&1023)<<10|c&1023,e[s++]=240|(o&1835008)>>18,e[s++]=128|(o&258048)>>12,e[s++]=128|(o&4032)>>6,e[s++]=128|o&63)}}}return _h.bytes=s-r,e}_h.bytes=0;function Qh(t,e,r){let n="";e==null&&(e=0),r==null&&(r=t.length);for(let s=e;s<r;){const i=t[s++];let o;if(i<=128)o=i;else if(i>191&&i<224)o=(i&31)<<6|t[s++]&63;else if(i>239&&i<365){o=((i&7)<<18|(t[s++]&63)<<12|(t[s++]&63)<<6|t[s++]&63)-65536;const a=v_|o>>10&1023;n+=String.fromCharCode(a),o=bh|o&1023}else o=(i&15)<<12|(t[s++]&63)<<6|t[s++]&63;n+=String.fromCharCode(o)}return Qh.bytes=r-e,n}Qh.bytes=0;const ql=t=>t instanceof Uint8Array;function Ac(t){return typeof t=="string"?LC(t):t.byteLength}function w_(t){return t instanceof Uint8Array?t:Array.isArray(t)?new Uint8Array(t):_h(t)}function b_(t,e,r){if(typeof e!="string")throw new Error("unknown input type");return _h(e,t,r),_h.bytes}const Op={},qC=new Array(255);for(let t=0;t<=15;t+=1){const e=t.toString(16),r=e.toUpperCase();for(let n=0;n<=15;n+=1){const s=n.toString(16),i=s.toUpperCase(),o=t<<4|n,a=`${e}${s}`;qC[o]=a,Op[a]=o,Op[`${r}${s}`]=o,Op[`${e}${i}`]=o,Op[`${r}${i}`]=o}}function f9(t,e,r){let n="";for(let s=e;s<r;){const i=t[s++];n+=qC[i]}return n}function TS(t){return t.length>>>1}function p9(t,e,r,n){let s=0;for(;r<n;){const i=e.substr(s,2),o=Op[i];if(o===void 0)return;t[r++]=o,s+=2}return t}const h9=Math.pow(2,24),y9=Math.pow(2,16),m9=Math.pow(2,8),ja=(t,e)=>t[e]*h9+t[e+1]*y9+t[e+2]*m9+t[e+3],xt=(t,e)=>t[e]<<8|t[e+1],Ma=(t,e,r)=>(e=+e,t[r+3]=e,e=e>>>8,t[r+2]=e,e=e>>>8,t[r+1]=e,e=e>>>8,t[r]=e,r+4),ut=(t,e,r)=>(t[r]=e>>8,t[r+1]=e&255,r+2);function ms(t,e,r,n,s){return r<0&&(n-=r,r=0),n<0&&(n=0),s<0?new Uint8Array(0):r>=e.length||n>=s?0:g9(t,e,r,n,s)}function g9(t,e,r,n,s){s-n>e.length-r&&(s=n+e.length-r);let i=s-n;const o=t.length-n;return i>o&&(i=o),(n!==0||s<t.length)&&(t=new Uint8Array(t.buffer,t.byteOffset+n,i)),e.set(t,r),i}const v9=0,IS=32768,$b=32768,w9=~$b,VC=32768,b9=~VC;function ur({bytes:t=0,encode:e,decode:r,encodingLength:n}){return e.bytes=t,r.bytes=t,{encode:e,decode:r,encodingLength:n||(()=>t)}}const Le=ur({encode(t,e,r){e||(e=new Uint8Array(Le.encodingLength(t))),r||(r=0);const n=r,s=t.replace(/^\.|\.$/gm,"");if(s.length){const i=s.split(".");for(let o=0;o<i.length;o++){const a=b_(e,i[o],r+1);e[r]=a,r+=a+1}}return e[r++]=0,Le.encode.bytes=r-n,e},decode(t,e){e||(e=0);const r=[];let n=e,s=0,i=0,o=!1;for(;;){if(e>=t.length)throw new Error("Cannot decode name (buffer overflow)");const a=t[e++];if(i+=o?0:1,a===0)break;if(a&192)if((a&192)===192){if(e+1>t.length)throw new Error("Cannot decode name (buffer overflow)");const c=xt(t,e-1)-49152;if(c>=n)throw new Error("Cannot decode name (bad pointer)");e=c,n=c,i+=o?0:1,o=!0}else throw new Error("Cannot decode name (bad label)");else{if(e+a>t.length)throw new Error("Cannot decode name (buffer overflow)");if(s+=a+1,s>254)throw new Error("Cannot decode name (name too long)");r.push(Qh(t,e,e+a)),e+=a,i+=o?0:a}}return Le.decode.bytes=i,r.length===0?".":r.join(".")},encodingLength(t){return t==="."||t===".."?1:Ac(t.replace(/^\.|\.$/gm,""))+2}}),Zr=ur({encode(t,e,r){e||(e=new Uint8Array(Zr.encodingLength(t))),r||(r=0);const n=b_(e,t,r+1);return e[r]=n,Zr.encode.bytes=n+1,e},decode(t,e){e||(e=0);const r=t[e],n=Qh(t,e+1,e+1+r);return Zr.decode.bytes=r+1,n},encodingLength(t){return Ac(t)+1}}),xd=ur({bytes:12,encode(t,e,r){e||(e=new Uint8Array(xd.encodingLength(t))),r||(r=0);const n=(t.flags||0)&32767,s=t.type==="response"?IS:v9;return ut(e,t.id||0,r),ut(e,n|s,r+2),ut(e,t.questions.length,r+4),ut(e,t.answers.length,r+6),ut(e,t.authorities.length,r+8),ut(e,t.additionals.length,r+10),e},decode(t,e){if(e||(e=0),t.length<12)throw new Error("Header must be 12 bytes");const r=xt(t,e+2);return{id:xt(t,e),type:r&IS?"response":"query",flags:r&32767,flag_qr:(r>>15&1)===1,opcode:l9(r>>11&15),flag_aa:(r>>10&1)===1,flag_tc:(r>>9&1)===1,flag_rd:(r>>8&1)===1,flag_ra:(r>>7&1)===1,flag_z:(r>>6&1)===1,flag_ad:(r>>5&1)===1,flag_cd:(r>>4&1)===1,rcode:c9(r&15),questions:new Array(xt(t,e+4)),answers:new Array(xt(t,e+6)),authorities:new Array(xt(t,e+8)),additionals:new Array(xt(t,e+10))}},encodingLength(){return 12}}),jm=ur({encode(t,e,r){e||(e=new Uint8Array(jm.encodingLength(t))),r||(r=0);const n=t.length;return ut(e,n,r),ms(t,e,r+2,0,n),jm.encode.bytes=n+2,e},decode(t,e){e||(e=0);const r=xt(t,e),n=t.slice(e+2,e+2+r);return jm.decode.bytes=r+2,n},encodingLength(t){return t.length+2}}),Mm=ur({encode(t,e,r){return e||(e=new Uint8Array(Mm.encodingLength(t))),r||(r=0),Le.encode(t,e,r+2),ut(e,Le.encode.bytes,r),Mm.encode.bytes=Le.encode.bytes+2,e},decode(t,e){e||(e=0);const r=xt(t,e),n=Le.decode(t,e+2);return Mm.decode.bytes=r+2,n},encodingLength(t){return Le.encodingLength(t)+2}}),Um=ur({encode(t,e,r){e||(e=new Uint8Array(Um.encodingLength(t))),r||(r=0);const n=r;return r+=2,Le.encode(t.mname,e,r),r+=Le.encode.bytes,Le.encode(t.rname,e,r),r+=Le.encode.bytes,Ma(e,t.serial||0,r),r+=4,Ma(e,t.refresh||0,r),r+=4,Ma(e,t.retry||0,r),r+=4,Ma(e,t.expire||0,r),r+=4,Ma(e,t.minimum||0,r),r+=4,ut(e,r-n-2,n),Um.encode.bytes=r-n,e},decode(t,e){e||(e=0);const r=e,n={};return e+=2,n.mname=Le.decode(t,e),e+=Le.decode.bytes,n.rname=Le.decode(t,e),e+=Le.decode.bytes,n.serial=ja(t,e),e+=4,n.refresh=ja(t,e),e+=4,n.retry=ja(t,e),e+=4,n.expire=ja(t,e),e+=4,n.minimum=ja(t,e),e+=4,Um.decode.bytes=e-r,n},encodingLength(t){return 22+Le.encodingLength(t.mname)+Le.encodingLength(t.rname)}}),Km=ur({encode(t,e,r){Array.isArray(t)||(t=[t]);for(let s=0;s<t.length;s++)if(typeof t[s]=="string"&&(t[s]=w_(t[s])),!ql(t[s]))throw new Error("Must be a Buffer");e||(e=new Uint8Array(Km.encodingLength(t))),r||(r=0);const n=r;return r+=2,t.forEach(function(s){e[r++]=s.length,ms(s,e,r,0,s.length),r+=s.length}),ut(e,r-n-2,n),Km.encode.bytes=r-n,e},decode(t,e){e||(e=0);const r=e;let n=xt(t,e);e+=2;const s=[];for(;n>0;){const i=t[e++];if(--n,n<i)throw new Error("Buffer overflow");s.push(t.slice(e,e+i)),e+=i,n-=i}return Km.decode.bytes=e-r,s},encodingLength(t){Array.isArray(t)||(t=[t]);let e=2;return t.forEach(function(r){typeof r=="string"?e+=Ac(r)+1:e+=r.length+1}),e}}),Lm=ur({encode(t,e,r){e||(e=new Uint8Array(Lm.encodingLength(t))),r||(r=0),typeof t=="string"&&(t=w_(t)),t||(t=new Uint8Array(0));const n=r;r+=2;const s=t.length;return ms(t,e,r,0,s),r+=s,ut(e,r-n-2,n),Lm.encode.bytes=r-n,e},decode(t,e){e||(e=0);const r=e,n=xt(t,e);e+=2;const s=t.slice(e,e+n);return e+=n,Lm.decode.bytes=e-r,s},encodingLength(t){return t?(ql(t)?t.length:Ac(t))+2:2}}),qm=ur({encode(t,e,r){e||(e=new Uint8Array(qm.encodingLength(t))),r||(r=0);const n=r;return r+=2,Zr.encode(t.cpu,e,r),r+=Zr.encode.bytes,Zr.encode(t.os,e,r),r+=Zr.encode.bytes,ut(e,r-n-2,n),qm.encode.bytes=r-n,e},decode(t,e){e||(e=0);const r=e,n={};return e+=2,n.cpu=Zr.decode(t,e),e+=Zr.decode.bytes,n.os=Zr.decode(t,e),e+=Zr.decode.bytes,qm.decode.bytes=e-r,n},encodingLength(t){return Zr.encodingLength(t.cpu)+Zr.encodingLength(t.os)+2}}),Kd=ur({encode(t,e,r){return e||(e=new Uint8Array(Kd.encodingLength(t))),r||(r=0),Le.encode(t,e,r+2),ut(e,Le.encode.bytes,r),Kd.encode.bytes=Le.encode.bytes+2,e},decode(t,e){e||(e=0);const r=Le.decode(t,e+2);return Kd.decode.bytes=Le.decode.bytes+2,r},encodingLength(t){return Le.encodingLength(t)+2}}),Vm=ur({encode(t,e,r){e||(e=new Uint8Array(Vm.encodingLength(t))),r||(r=0),ut(e,t.priority||0,r+2),ut(e,t.weight||0,r+4),ut(e,t.port||0,r+6),Le.encode(t.target,e,r+8);const n=Le.encode.bytes+6;return ut(e,n,r),Vm.encode.bytes=n+2,e},decode(t,e){e||(e=0);const r=xt(t,e),n={};return n.priority=xt(t,e+2),n.weight=xt(t,e+4),n.port=xt(t,e+6),n.target=Le.decode(t,e+8),Vm.decode.bytes=r+2,n},encodingLength(t){return 8+Le.encodingLength(t.target)}}),Hu=ur({encode(t,e,r){const n=Hu.encodingLength(t);return e||(e=new Uint8Array(Hu.encodingLength(t))),r||(r=0),t.issuerCritical&&(t.flags=Hu.ISSUER_CRITICAL),ut(e,n-2,r),r+=2,e[r]=t.flags||0,r+=1,Zr.encode(t.tag,e,r),r+=Zr.encode.bytes,b_(e,t.value,r),r+=Ac(t.value),Hu.encode.bytes=n,e},decode(t,e){e||(e=0);const r=xt(t,e);e+=2;const n=e,s={};return s.flags=t[e],e+=1,s.tag=Zr.decode(t,e),e+=Zr.decode.bytes,s.value=Qh(t,e,n+r),s.issuerCritical=!!(s.flags&Hu.ISSUER_CRITICAL),Hu.decode.bytes=r+2,s},encodingLength(t){return Zr.encodingLength(t.tag)+Zr.encodingLength(t.value)+2}});Hu.ISSUER_CRITICAL=128;const zm=ur({encode(t,e,r){e||(e=new Uint8Array(zm.encodingLength(t))),r||(r=0);const n=r;return r+=2,ut(e,t.preference||0,r),r+=2,Le.encode(t.exchange,e,r),r+=Le.encode.bytes,ut(e,r-n-2,n),zm.encode.bytes=r-n,e},decode(t,e){e||(e=0);const r=e,n={};return e+=2,n.preference=xt(t,e),e+=2,n.exchange=Le.decode(t,e),e+=Le.decode.bytes,zm.decode.bytes=e-r,n},encodingLength(t){return 4+Le.encodingLength(t.exchange)}}),zC=ur({encode(t,e,r){return e||(e=new Uint8Array(zC.encodingLength(t))),r||(r=0),ut(e,4,r),r+=2,Ro.encode(t,e,r),e},decode(t,e){return e||(e=0),e+=2,Ro.decode(t,e)},bytes:6}),Hm=ur({encode(t,e,r){return e||(e=new Uint8Array(Hm.encodingLength(t))),r||(r=0),ut(e,16,r),r+=2,ac.encode(t,e,r),Hm.encode.bytes=18,e},decode(t,e){e||(e=0),e+=2;const r=ac.decode(t,e);return Hm.decode.bytes=18,r},bytes:18}),_9=t=>new Uint8Array(t),ka=ur({encode(t,e,r){e||(e=new Uint8Array(ka.encodingLength(t))),r||(r=0);const n=r,s=OS(t.code);if(ut(e,s,r),r+=2,t.data)ut(e,t.data.length,r),r+=2,ms(t.data,e,r),r+=t.data.length;else switch(s){case 8:{const i=t.sourcePrefixLength||0,o=t.family||o9(t.ip),a=a9(t.ip,_9),c=Math.ceil(i/8);ut(e,c+4,r),r+=2,ut(e,o,r),r+=2,e[r++]=i,e[r++]=t.scopePrefixLength||0,ms(a,e,r,0,c),r+=c}break;case 11:t.timeout?(ut(e,2,r),r+=2,ut(e,t.timeout,r),r+=2):(ut(e,0,r),r+=2);break;case 12:{const i=t.length||0;ut(e,i,r),r+=2,e.fill(0,r,r+i),r+=i}break;case 14:{const i=t.tags.length*2;ut(e,i,r),r+=2;for(const o of t.tags)ut(e,o,r),r+=2}break;default:throw new Error(`Unknown roption code: ${t.code}`)}return ka.encode.bytes=r-n,e},decode(t,e){e||(e=0);const r={};r.code=xt(t,e),r.type=d9(r.code),e+=2;const n=xt(t,e);switch(e+=2,r.data=t.slice(e,e+n),r.code){case 8:r.family=xt(t,e),e+=2,r.sourcePrefixLength=t[e++],r.scopePrefixLength=t[e++];{const s=new Uint8Array(r.family===1?4:16);ms(t,s,0,e,e+n-4),r.ip=u9(s)}break;case 11:n>0&&(r.timeout=xt(t,e),e+=2);break;case 14:r.tags=[];for(let s=0;s<n;s+=2)r.tags.push(xt(t,e)),e+=2}return ka.decode.bytes=n+4,r},encodingLength(t){if(t.data)return t.data.length+4;switch(OS(t.code)){case 8:{const r=t.sourcePrefixLength||0;return Math.ceil(r/8)+8}case 11:return typeof t.timeout=="number"?6:4;case 12:return t.length+4;case 14:return 4+t.tags.length*2}throw new Error(`Unknown roption code: ${t.code}`)}}),rc=ur({encode(t,e,r){e||(e=new Uint8Array(rc.encodingLength(t))),r||(r=0);const n=r,s=Fd(t,ka);return ut(e,s,r),r=Rp(t,ka,e,r+2),rc.encode.bytes=r-n,e},decode(t,e){e||(e=0);const r=e,n=[];let s=xt(t,e);e+=2;let i=0;for(;s>0;)n[i++]=ka.decode(t,e),e+=ka.decode.bytes,s-=ka.decode.bytes;return rc.decode.bytes=e-r,n},encodingLength(t){return 2+Fd(t||[],ka)}}),So=ur({encode(t,e,r){e||(e=new Uint8Array(So.encodingLength(t))),r||(r=0);const n=r,s=t.key;if(!ql(s))throw new Error("Key must be a Buffer");return r+=2,ut(e,t.flags,r),r+=2,e[r]=So.PROTOCOL_DNSSEC,r+=1,e[r]=t.algorithm,r+=1,ms(s,e,r,0,s.length),r+=s.length,So.encode.bytes=r-n,ut(e,So.encode.bytes-2,n),e},decode(t,e){e||(e=0);const r=e,n={},s=xt(t,e);if(e+=2,n.flags=xt(t,e),e+=2,t[e]!==So.PROTOCOL_DNSSEC)throw new Error("Protocol must be 3");return e+=1,n.algorithm=t[e],e+=1,n.key=t.slice(e,r+s+2),e+=n.key.length,So.decode.bytes=e-r,n},encodingLength(t){return 6+Ac(t.key)}});So.PROTOCOL_DNSSEC=3;So.ZONE_KEY=128;So.SECURE_ENTRYPOINT=32768;const Tp=ur({encode(t,e,r){e||(e=new Uint8Array(Tp.encodingLength(t))),r||(r=0);const n=r,s=t.signature;if(!ql(s))throw new Error("Signature must be a Buffer");return r+=2,ut(e,wh(t.typeCovered),r),r+=2,e[r]=t.algorithm,r+=1,e[r]=t.labels,r+=1,Ma(e,t.originalTTL,r),r+=4,Ma(e,t.expiration,r),r+=4,Ma(e,t.inception,r),r+=4,ut(e,t.keyTag,r),r+=2,Le.encode(t.signersName,e,r),r+=Le.encode.bytes,ms(s,e,r,0,s.length),r+=s.length,Tp.encode.bytes=r-n,ut(e,Tp.encode.bytes-2,n),e},decode(t,e){e||(e=0);const r=e,n={},s=xt(t,e);return e+=2,n.typeCovered=Og(xt(t,e)),e+=2,n.algorithm=t[e],e+=1,n.labels=t[e],e+=1,n.originalTTL=ja(t,e),e+=4,n.expiration=ja(t,e),e+=4,n.inception=ja(t,e),e+=4,n.keyTag=xt(t,e),e+=2,n.signersName=Le.decode(t,e),e+=Le.decode.bytes,n.signature=t.slice(e,r+s+2),e+=n.signature.length,Tp.decode.bytes=e-r,n},encodingLength(t){return 20+Le.encodingLength(t.signersName)+Ac(t.signature)}}),Ip=ur({encode(t,e,r){e||(e=new Uint8Array(Ip.encodingLength(t))),r||(r=0);const n=r;return r+=2,Le.encode(t.mbox||".",e,r),r+=Le.encode.bytes,Le.encode(t.txt||".",e,r),r+=Le.encode.bytes,Ip.encode.bytes=r-n,ut(e,Ip.encode.bytes-2,n),e},decode(t,e){e||(e=0);const r=e,n={};return e+=2,n.mbox=Le.decode(t,e)||".",e+=Le.decode.bytes,n.txt=Le.decode(t,e)||".",e+=Le.decode.bytes,Ip.decode.bytes=e-r,n},encodingLength(t){return 2+Le.encodingLength(t.mbox||".")+Le.encodingLength(t.txt||".")}}),Ii=ur({encode(t,e,r){e||(e=new Uint8Array(Ii.encodingLength(t))),r||(r=0);const n=r,s=[];for(let i=0;i<t.length;i++){const o=wh(t[i]);s[o>>8]===void 0&&(s[o>>8]=[]),s[o>>8][o>>3&31]|=1<<7-(o&7)}for(let i=0;i<s.length;i++)if(s[i]!==void 0){const o=w_(s[i]);e[r]=i,r+=1,e[r]=o.length,r+=1,ms(o,e,r,0,o.length),r+=o.length}return Ii.encode.bytes=r-n,e},decode(t,e,r){e||(e=0);const n=e,s=[];for(;e-n<r;){const i=t[e];e+=1;const o=t[e];e+=1;for(let a=0;a<o;a++){const c=t[e+a];for(let l=0;l<8;l++)if(c&1<<7-l){const u=Og(i<<8|a<<3|l);s.push(u)}}e+=o}return Ii.decode.bytes=e-n,s},encodingLength(t){const e=[];for(let n=0;n<t.length;n++){const s=wh(t[n]);e[s>>8]=Math.max(e[s>>8]||0,s&255)}let r=0;for(let n=0;n<e.length;n++)e[n]!==void 0&&(r+=2+Math.ceil((e[n]+1)/8));return r}}),Bp=ur({encode(t,e,r){e||(e=new Uint8Array(Bp.encodingLength(t))),r||(r=0);const n=r;return r+=2,Le.encode(t.nextDomain,e,r),r+=Le.encode.bytes,Ii.encode(t.rrtypes,e,r),r+=Ii.encode.bytes,Bp.encode.bytes=r-n,ut(e,Bp.encode.bytes-2,n),e},decode(t,e){e||(e=0);const r=e,n={},s=xt(t,e);return e+=2,n.nextDomain=Le.decode(t,e),e+=Le.decode.bytes,n.rrtypes=Ii.decode(t,e,s-(e-r)),e+=Ii.decode.bytes,Bp.decode.bytes=e-r,n},encodingLength(t){return 2+Le.encodingLength(t.nextDomain)+Ii.encodingLength(t.rrtypes)}}),Fp=ur({encode(t,e,r){e||(e=new Uint8Array(Fp.encodingLength(t))),r||(r=0);const n=r,s=t.salt;if(!ql(s))throw new Error("salt must be a Buffer");const i=t.nextDomain;if(!ql(i))throw new Error("nextDomain must be a Buffer");return r+=2,e[r]=t.algorithm,r+=1,e[r]=t.flags,r+=1,ut(e,t.iterations,r),r+=2,e[r]=s.length,r+=1,ms(s,e,r,0,s.length),r+=s.length,e[r]=i.length,r+=1,ms(i,e,r,0,i.length),r+=i.length,Ii.encode(t.rrtypes,e,r),r+=Ii.encode.bytes,Fp.encode.bytes=r-n,ut(e,Fp.encode.bytes-2,n),e},decode(t,e){e||(e=0);const r=e,n={},s=xt(t,e);e+=2,n.algorithm=t[e],e+=1,n.flags=t[e],e+=1,n.iterations=xt(t,e),e+=2;const i=t[e];e+=1,n.salt=t.slice(e,e+i),e+=i;const o=t[e];return e+=1,n.nextDomain=t.slice(e,e+o),e+=o,n.rrtypes=Ii.decode(t,e,s-(e-r)),e+=Ii.decode.bytes,Fp.decode.bytes=e-r,n},encodingLength(t){return 8+t.salt.length+t.nextDomain.length+Ii.encodingLength(t.rrtypes)}}),Np=ur({encode(t,e,r){e||(e=new Uint8Array(Np.encodingLength(t))),r||(r=0);const n=r,s=t.digest;if(!ql(s))throw new Error("Digest must be a Buffer");return r+=2,ut(e,t.keyTag,r),r+=2,e[r]=t.algorithm,r+=1,e[r]=t.digestType,r+=1,ms(s,e,r,0,s.length),r+=s.length,Np.encode.bytes=r-n,ut(e,Np.encode.bytes-2,n),e},decode(t,e){e||(e=0);const r=e,n={},s=xt(t,e);return e+=2,n.keyTag=xt(t,e),e+=2,n.algorithm=t[e],e+=1,n.digestType=t[e],e+=1,n.digest=t.slice(e,r+s+2),e+=n.digest.length,Np.decode.bytes=e-r,n},encodingLength(t){return 6+Ac(t.digest)}}),Bd=ur({encode(t,e,r){e||(e=new Uint8Array(Bd.encodingLength(t))),r||(r=0);const n=r;r+=2,e[r]=t.algorithm,r+=1,e[r]=t.hash,r+=1;const s=TS(t.fingerprint),i=xb(t.hash);if(s!==i)throw new Error(`Invalid length of fingerprint "${t.fingerprint}" for hashType=${t.hash}: ${s} != ${i}`);return p9(e,t.fingerprint,r,r+=s),Bd.encode.bytes=r-n,ut(e,Bd.encode.bytes-2,n),e},decode(t,e){e||(e=0);const r=e,n={};e+=2,n.algorithm=t[e],e+=1,n.hash=t[e],e+=1;const s=xb(n.hash);return n.fingerprint=f9(t,e,e+s),e+=s,Bd.decode.bytes=e-r,n},encodingLength(t){return 4+TS(t.fingerprint)}});function xb(t){if(t===1)return 20;if(t===2)return 32;throw new Error(`Invalid hashType=${t}, supported=1,2`)}Bd.getFingerprintLengthForHashType=xb;function Jv(t){switch(t.toUpperCase()){case"A":return zC;case"PTR":return Kd;case"CNAME":return Kd;case"DNAME":return Kd;case"TXT":return Km;case"NULL":return Lm;case"AAAA":return Hm;case"SRV":return Vm;case"HINFO":return qm;case"CAA":return Hu;case"NS":return Mm;case"SOA":return Um;case"MX":return zm;case"OPT":return rc;case"DNSKEY":return So;case"RRSIG":return Tp;case"RP":return Ip;case"NSEC":return Bp;case"NSEC3":return Fp;case"SSHFP":return Bd;case"DS":return Np}return jm}const rs=ur({encode(t,e,r){e||(e=new Uint8Array(rs.encodingLength(t))),r||(r=0);const n=r;if(Le.encode(t.name,e,r),r+=Le.encode.bytes,ut(e,wh(t.type),r),t.type.toUpperCase()==="OPT"){if(t.name!==".")throw new Error("OPT name must be root.");ut(e,t.udpPayloadSize||4096,r+2),e[r+4]=t.extendedRcode||0,e[r+5]=t.ednsVersion||0,ut(e,t.flags||0,r+6),r+=8,rc.encode(t.options||[],e,r),r+=rc.encode.bytes}else{let s=KC(t.class===void 0?"IN":t.class);t.flush&&(s|=$b),ut(e,s,r+2),Ma(e,t.ttl||0,r+4),r+=8;const i=Jv(t.type);i.encode(t.data,e,r),r+=i.encode.bytes}return rs.encode.bytes=r-n,e},decode(t,e){e||(e=0);const r={},n=e;if(r.name=Le.decode(t,e),e+=Le.decode.bytes,r.type=Og(xt(t,e)),r.type==="OPT")r.udpPayloadSize=xt(t,e+2),r.extendedRcode=t[e+4],r.ednsVersion=t[e+5],r.flags=xt(t,e+6),r.flag_do=(r.flags>>15&1)===1,r.options=rc.decode(t,e+8),e+=8+rc.decode.bytes;else{const s=xt(t,e+2);r.ttl=ja(t,e+4),r.class=UC(s&w9),r.flush=!!(s&$b);const i=Jv(r.type);r.data=i.decode(t,e+8),e+=8+i.decode.bytes}return rs.decode.bytes=e-n,r},encodingLength(t){const e=t.data!==null&&t.data!==void 0?t.data:t.options;return Le.encodingLength(t.name)+8+Jv(t.type).encodingLength(e)}}),Ld=ur({encode(t,e,r){e||(e=new Uint8Array(Ld.encodingLength(t))),r||(r=0);const n=r;return Le.encode(t.name,e,r),r+=Le.encode.bytes,ut(e,wh(t.type),r),r+=2,ut(e,KC(t.class===void 0?"IN":t.class),r),r+=2,Ld.encode.bytes=r-n,t},decode(t,e){e||(e=0);const r=e,n={};return n.name=Le.decode(t,e),e+=Le.decode.bytes,n.type=Og(xt(t,e)),e+=2,n.class=UC(xt(t,e)),e+=2,!!(n.class&VC)&&(n.class&=b9),Ld.decode.bytes=e-r,n},encodingLength(t){return Le.encodingLength(t.name)+4}}),__=1024,Vl={encode:function(t,e,r){const n=!e;n&&(e=new Uint8Array(E9(t))),r||(r=0);const s=r;return t.questions||(t.questions=[]),t.answers||(t.answers=[]),t.authorities||(t.authorities=[]),t.additionals||(t.additionals=[]),xd.encode(t,e,r),r+=xd.encode.bytes,r=Rp(t.questions,Ld,e,r),r=Rp(t.answers,rs,e,r),r=Rp(t.authorities,rs,e,r),r=Rp(t.additionals,rs,e,r),Vl.encode.bytes=r-s,n&&Eh.bytes!==e.length?e.slice(0,Eh.bytes):e},decode:function(t,e){e||(e=0);const r=e,n=xd.decode(t,e);return e+=xd.decode.bytes,e=zy(n.questions,Ld,t,e),e=zy(n.answers,rs,t,e),e=zy(n.authorities,rs,t,e),e=zy(n.additionals,rs,t,e),Vl.decode.bytes=e-r,n},encodingLength:function(t){return xd.encodingLength(t)+Fd(t.questions||[],Ld)+Fd(t.answers||[],rs)+Fd(t.authorities||[],rs)+Fd(t.additionals||[],rs)}};Vl.encode.bytes=0;Vl.decode.bytes=0;const Eh=Vl.encode,E_=Vl.decode,E9=Vl.encodingLength;function Fd(t,e){let r=0;for(let n=0;n<t.length;n++)r+=e.encodingLength(t[n]);return r}function Rp(t,e,r,n){for(let s=0;s<t.length;s++)e.encode(t[s],r,n),n+=e.encode.bytes;return n}function zy(t,e,r,n){for(let s=0;s<t.length;s++)t[s]=e.decode(r,n),n+=e.decode.bytes;return n}var BS=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let ey=class{static getSigningMethod(e){return BS(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement getSigningMethod()")})}static resolve(e,r){return BS(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement resolve()")})}};var un=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},FS=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};const NS="https://diddht.tbddev.org",A9=0,hu=7200,Wm=";",qn=",";var Db;(function(t){t[t.Discoverable=0]="Discoverable",t[t.Organization=1]="Organization",t[t.Government=2]="Government",t[t.Corporation=3]="Corporation",t[t.LocalBusiness=4]="LocalBusiness",t[t.SoftwarePackage=5]="SoftwarePackage",t[t.WebApp=6]="WebApp",t[t.FinancialInstitution=7]="FinancialInstitution"})(Db||(Db={}));var Zn;(function(t){t[t.Ed25519=0]="Ed25519",t[t.secp256k1=1]="secp256k1",t[t.secp256r1=2]="secp256r1",t[t.X25519=3]="X25519"})(Zn||(Zn={}));var Pb;(function(t){t.authentication="auth",t.assertionMethod="asm",t.capabilityDelegation="del",t.capabilityInvocation="inv",t.keyAgreement="agm"})(Pb||(Pb={}));const HC={Ed25519:Zn.Ed25519,ES256K:Zn.secp256k1,ES256:Zn.secp256r1,"P-256":Zn.secp256r1,secp256k1:Zn.secp256k1,secp256r1:Zn.secp256r1,X25519:Zn.X25519},RS={[Zn.Ed25519]:"EdDSA",[Zn.secp256k1]:"ES256K",[Zn.secp256r1]:"ES256",[Zn.X25519]:"ECDH-ES+A256KW"};let k0=class Cb extends ey{static create(){return un(this,arguments,void 0,function*({keyManager:e=new Wa,options:r={}}={}){var n,s,i,o,a,c,l,u,d,h,f;if(!((n=r.verificationMethods)===null||n===void 0)&&n.some(_=>!(_.algorithm in HC)))throw new Error("One or more verification method algorithms are not supported");const p=(s=r.verificationMethods)===null||s===void 0?void 0:s.filter(_=>"id"in _).map(_=>_.id);if(p&&p.length!==new Set(p).size)throw new Error("One or more verification method IDs are not unique");if(!((i=r.services)===null||i===void 0)&&i.some(_=>!_.id||!_.type||!_.serviceEndpoint))throw new Error("One or more services are missing required properties");const y=yield e.generateKey({algorithm:"Ed25519"}),b=yield e.getPublicKey({keyUri:y}),w=yield Mn.identityKeyToIdentifier({identityKey:b}),g=Object.assign(Object.assign({id:w},r.alsoKnownAs&&{alsoKnownAs:r.alsoKnownAs}),r.controllers&&{controller:r.controllers}),v=[...(o=r.verificationMethods)!==null&&o!==void 0?o:[]];v!=null&&v.some(_=>{var x;return((x=_.id)===null||x===void 0?void 0:x.split("#").pop())==="0"})||v.unshift({algorithm:"Ed25519",id:"0",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]});for(const _ of v){const x=_.id&&_.id.split("#").pop()==="0"?y:yield e.generateKey({algorithm:_.algorithm}),D=yield e.getPublicKey({keyUri:x});let E=(c=(a=_.id)!==null&&a!==void 0?a:D.kid)!==null&&c!==void 0?c:yield tr({jwk:D});E=`${w}#${Ks(E)}`,(l=g.verificationMethod)!==null&&l!==void 0||(g.verificationMethod=[]),g.verificationMethod.push({id:E,type:"JsonWebKey",controller:(u=_.controller)!==null&&u!==void 0?u:w,publicKeyJwk:D});for(const A of(d=_.purposes)!==null&&d!==void 0?d:[])g[A]||(g[A]=[]),g[A].push(E)}(h=r.services)===null||h===void 0||h.forEach(_=>{var x;(x=g.service)!==null&&x!==void 0||(g.service=[]),_.id=`${w}#${_.id.split("#").pop()}`,g.service.push(_)});const m=new yc({uri:w,document:g,metadata:Object.assign({published:!1},r.types&&{types:r.types}),keyManager:e});if(!((f=r.publish)!==null&&f!==void 0)||f){const _=yield Cb.publish({did:m,gatewayUri:r.gatewayUri});m.metadata=_.didDocumentMetadata}return m})}static import(e){return un(this,arguments,void 0,function*({portableDid:r,keyManager:n=new Wa}){var s;const i=Wt.parse(r.uri);if((i==null?void 0:i.method)!==Cb.methodName)throw new rt(Je.MethodNotSupported,"Method not supported");const o=yield yc.import({portableDid:r,keyManager:n});if(!(!((s=o.document.verificationMethod)===null||s===void 0)&&s.some(a=>{var c;return((c=a.id)===null||c===void 0?void 0:c.split("#").pop())==="0"})))throw new rt(Je.InvalidDidDocument,"DID document must contain an Identity Key");return o})}static getSigningMethod(e){return un(this,arguments,void 0,function*({didDocument:r,methodId:n="#0"}){var s;const i=Wt.parse(r.id);if(i&&i.method!==this.methodName)throw new rt(Je.MethodNotSupported,`Method not supported: ${i.method}`);const o=(s=r.verificationMethod)===null||s===void 0?void 0:s.find(a=>{var c,l;return Ks(a.id)===((c=Ks(n))!==null&&c!==void 0?c:Ks((l=r.assertionMethod)===null||l===void 0?void 0:l[0]))});if(!(o&&o.publicKeyJwk))throw new rt(Je.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static publish(e){return un(this,arguments,void 0,function*({did:r,gatewayUri:n=NS}){return yield jS.put({did:r,gatewayUri:n})})}static resolve(e){return un(this,arguments,void 0,function*(r,n={}){var s;const i=(s=n==null?void 0:n.gatewayUri)!==null&&s!==void 0?s:NS;try{yield Mn.identifierToIdentityKey({didUri:r});const{didDocument:o,didDocumentMetadata:a}=yield jS.get({didUri:r,gatewayUri:i});return Object.assign(Object.assign({},In),{didDocument:o,didDocumentMetadata:a})}catch(o){if(!(o instanceof rt))throw new Error(o);return Object.assign(Object.assign({},In),{didResolutionMetadata:Object.assign({error:o.code},o.message&&{errorMessage:o.message})})}})}};k0.methodName="dht";let jS=class rl{static get(e){return un(this,arguments,void 0,function*({didUri:r,gatewayUri:n}){const s=Mn.identifierToIdentityKeyBytes({didUri:r}),i=yield rl.pkarrGet({gatewayUri:n,publicKeyBytes:s}),o=yield Mn.parseBep44GetMessage({bep44Message:i}),a=yield rl.fromDnsPacket({didUri:r,dnsPacket:o});return a.didDocumentMetadata.versionId=i.seq.toString(),a})}static put(e){return un(this,arguments,void 0,function*({did:r,gatewayUri:n}){const s=yield rl.toDnsPacket({didDocument:r.document,didMetadata:r.metadata,authoritativeGatewayUris:[n]}),i=yield Mn.createBep44PutMessage({dnsPacket:s,publicKeyBytes:Mn.identifierToIdentityKeyBytes({didUri:r.uri}),signer:yield r.getSigner({methodId:"0"})}),o=yield rl.pkarrPut({gatewayUri:n,bep44Message:i});return{didDocument:r.document,didDocumentMetadata:Object.assign(Object.assign({},r.metadata),{published:o,versionId:i.seq.toString()}),didRegistrationMetadata:{}}})}static pkarrGet(e){return un(this,arguments,void 0,function*({gatewayUri:r,publicKeyBytes:n}){const s=at.uint8Array(n).toBase32Z(),i=new URL(s,r).href;let o;try{if(o=yield fetch(i,{method:"GET"}),!o.ok)throw new rt(Je.NotFound,`Pkarr record not found for: ${s}`)}catch(l){throw l instanceof rt?l:new rt(Je.InternalError,`Failed to fetch Pkarr record: ${l.message}`)}const a=yield o.arrayBuffer();if(!a)throw new rt(Je.NotFound,`Pkarr record not found for: ${s}`);if(a.byteLength<72)throw new rt(Je.InvalidDidDocumentLength,`Pkarr response must be at least 72 bytes but got: ${a.byteLength}`);if(a.byteLength>1072)throw new rt(Je.InvalidDidDocumentLength,`Pkarr response exceeds 1000 byte limit: ${a.byteLength}`);return{k:n,seq:Number(new DataView(a).getBigUint64(64)),sig:new Uint8Array(a,0,64),v:new Uint8Array(a,72)}})}static pkarrPut(e){return un(this,arguments,void 0,function*({gatewayUri:r,bep44Message:n}){const s=at.uint8Array(n.k).toBase32Z(),i=new URL(s,r).href,o=new Uint8Array(n.v.length+72);o.set(n.sig,0),new DataView(o.buffer).setBigUint64(n.sig.length,BigInt(n.seq)),o.set(n.v,n.sig.length+8);let a;try{a=yield fetch(i,{method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:o})}catch(c){throw new rt(Je.InternalError,`Failed to put Pkarr record for identifier ${s}: ${c.message}`)}return a.ok})}static fromDnsPacket(e){return un(this,arguments,void 0,function*({didUri:r,dnsPacket:n}){var s,i,o;const a={id:r},c={published:!0},l=new Map;for(const u of(s=n==null?void 0:n.answers)!==null&&s!==void 0?s:[]){if(u.type!=="TXT")continue;const d=u.name.split(".")[0].substring(1);switch(!0){case d.startsWith("aka"):{const h=Mn.parseTxtDataToString(u.data);a.alsoKnownAs=h.split(qn);break}case d.startsWith("cnt"):{const h=Mn.parseTxtDataToString(u.data);a.controller=h.includes(qn)?h.split(qn):h;break}case d.startsWith("k"):{const{id:h,t:f,k:p,c:y,a:b}=Mn.parseTxtDataToObject(u.data),w=at.base64Url(p).toUint8Array(),g=Zn[Number(f)];let v=yield Mn.keyConverter(g).bytesToPublicKey({publicKeyBytes:w});v.alg=b||RS[Number(f)];const m=d==="k0"?"0":h!==void 0?h:yield tr({jwk:v});(i=a.verificationMethod)!==null&&i!==void 0||(a.verificationMethod=[]);const _=`${r}#${m}`;a.verificationMethod.push({id:_,type:"JsonWebKey",controller:y??r,publicKeyJwk:v}),l.set(d,_);break}case d.startsWith("s"):{const h=Mn.parseTxtDataToObject(u.data),{id:f,t:p,se:y}=h,b=FS(h,["id","t","se"]),w=y.includes(qn)?y.split(qn):[y],g=Object.fromEntries(Object.entries(b).map(([v,m])=>[v,m.includes(qn)?m.split(qn):m]));(o=a.service)!==null&&o!==void 0||(a.service=[]),a.service.push(Object.assign(Object.assign({},g),{id:`${r}#${f}`,type:p,serviceEndpoint:w}));break}case d.startsWith("typ"):{const{id:h}=Mn.parseTxtDataToObject(u.data);c.types=h.split(qn).map(f=>Number(f));break}case d.startsWith("did"):{const h=g=>g.split(qn).map(v=>l.get(v)).filter(v=>typeof v=="string"),{auth:f,asm:p,del:y,inv:b,agm:w}=Mn.parseTxtDataToObject(u.data);f&&(a.authentication=h(f)),p&&(a.assertionMethod=h(p)),y&&(a.capabilityDelegation=h(y)),b&&(a.capabilityInvocation=h(b)),w&&(a.keyAgreement=h(w));break}}}return{didDocument:a,didDocumentMetadata:c,didResolutionMetadata:{}}})}static toDnsPacket(e){return un(this,arguments,void 0,function*({didDocument:r,didMetadata:n,authoritativeGatewayUris:s,previousDidProof:i}){var o,a,c,l,u;const d=[],h=[],f=new Map,p=[],y=[];if(i!==void 0){const{signature:g,previousDid:v}=i;yield Mn.validatePreviousDidProof({newDid:r.id,previousDidProof:i}),d.push({type:"TXT",name:"_prv._did.",ttl:hu,data:`id=${v};s=${g}`})}if(r.alsoKnownAs&&d.push({type:"TXT",name:"_aka._did.",ttl:hu,data:r.alsoKnownAs.join(qn)}),r.controller){const g=Array.isArray(r.controller)?r.controller.join(qn):r.controller;d.push({type:"TXT",name:"_cnt._did.",ttl:hu,data:g})}for(const[g,v]of(a=(o=r.verificationMethod)===null||o===void 0?void 0:o.entries())!==null&&a!==void 0?a:[]){const m=`k${g}`;y.push(m);let _=v.id.split("#").pop();f.set(_,m);const x=v.publicKeyJwk;if(!(x!=null&&x.crv&&x.crv in HC))throw new rt(Je.InvalidPublicKeyType,`Verification method '${v.id}' contains an unsupported key type: ${(c=x==null?void 0:x.crv)!==null&&c!==void 0?c:"undefined"}`);const D=Zn[x.crv],E=yield Mn.keyConverter(x.crv).publicKeyToBytes({publicKey:x}),A=at.uint8Array(E).toBase64Url(),S=[`t=${D}`,`k=${A}`];_!=="0"&&(yield tr({jwk:x}))!==_&&S.unshift(`id=${_}`),x.alg!==RS[D]&&S.push(`a=${x.alg}`),v.controller!==r.id&&S.push(`c=${v.controller}`),d.push({type:"TXT",name:`_${m}._did.`,ttl:hu,data:S.join(Wm)})}(l=r.service)===null||l===void 0||l.forEach((g,v)=>{const m=`s${v}`;p.push(m);let{id:_,type:x,serviceEndpoint:D}=g,E=FS(g,["id","type","serviceEndpoint"]);_=Ks(_),D=Array.isArray(D)?D.join(","):D;const S=Object.entries(Object.assign({id:_,t:x,se:D},E)).map(([I,N])=>`${I}=${N}`).join(Wm),O=Mn.chunkDataIfNeeded(S);d.push({type:"TXT",name:`_${m}._did.`,ttl:hu,data:O})});const b=[`v=${A9}`];if(y.length&&b.push(`vm=${y.join(qn)}`),Object.keys(vh).forEach(g=>{var v;const m=(v=r[g])===null||v===void 0?void 0:v.map(_=>f.get(_.split("#").pop()));if(m){const _=Pb[g];b.push(`${_}=${m.join(qn)}`)}}),p.length&&b.push(`svc=${p.join(qn)}`),!((u=n.types)===null||u===void 0)&&u.length){const v=n.types.map(m=>typeof m=="string"?Db[m]:m);d.push({type:"TXT",name:"_typ._did.",ttl:hu,data:`id=${v.join(qn)}`})}d.push({type:"TXT",name:"_did."+rl.getUniqueDidSuffix(r.id)+".",ttl:hu,data:b.join(Wm)});for(const g of s||[])h.push({type:"NS",name:"_did."+rl.getUniqueDidSuffix(r.id)+".",ttl:hu,data:g+"."});return{id:0,type:"response",flags:__,answers:[...d,...h]}})}static getUniqueDidSuffix(e){return e.split(":")[2]}},Mn=class Jm{static createBep44PutMessage(e){return un(this,arguments,void 0,function*({dnsPacket:r,publicKeyBytes:n,signer:s}){const i=Math.ceil(Date.now()/1e3),o=Eh(r),a=Qd.encode({seq:i,v:o}).subarray(1,-1);if(a.length>1e3)throw new rt(Je.InvalidDidDocumentLength,`DNS packet exceeds the 1000 byte maximum size: ${a.length} bytes`);const c=yield s.sign({data:a});return{k:n,seq:i,sig:c,v:o}})}static identifierToIdentityKey(e){return un(this,arguments,void 0,function*({didUri:r}){let n=Jm.identifierToIdentityKeyBytes({didUri:r});return yield yi.bytesToPublicKey({publicKeyBytes:n})})}static identifierToIdentityKeyBytes({didUri:e}){const r=Wt.parse(e);if(!r)throw new rt(Je.InvalidDid,`Invalid DID URI: ${e}`);if(r.method!==k0.methodName)throw new rt(Je.MethodNotSupported,`Method not supported: ${r.method}`);let n;try{n=at.base32Z(r.id).toUint8Array()}catch{throw new rt(Je.InvalidPublicKey,"Failed to decode method-specific identifier")}if(n.length!==32)throw new rt(Je.InvalidPublicKeyLength,`Invalid public key length: ${n.length}`);return n}static identityKeyToIdentifier(e){return un(this,arguments,void 0,function*({identityKey:r}){const n=yield yi.publicKeyToBytes({publicKey:r}),s=at.uint8Array(n).toBase32Z();return`did:${k0.methodName}:${s}`})}static keyConverter(e){const n={Ed25519:yi,"P-256":{publicKeyToBytes:s=>un(this,[s],void 0,function*({publicKey:i}){const o=yield fs.publicKeyToBytes({publicKey:i});return yield fs.compressPublicKey({publicKeyBytes:o})}),bytesToPublicKey:fs.bytesToPublicKey,privateKeyToBytes:fs.privateKeyToBytes,bytesToPrivateKey:fs.bytesToPrivateKey},secp256k1:{publicKeyToBytes:s=>un(this,[s],void 0,function*({publicKey:i}){const o=yield Ti.publicKeyToBytes({publicKey:i});return yield Ti.compressPublicKey({publicKeyBytes:o})}),bytesToPublicKey:Ti.bytesToPublicKey,privateKeyToBytes:Ti.privateKeyToBytes,bytesToPrivateKey:Ti.bytesToPrivateKey},X25519:CC}[e];if(!n)throw new rt(Je.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static parseBep44GetMessage(e){return un(this,arguments,void 0,function*({bep44Message:r}){const n=yield yi.bytesToPublicKey({publicKeyBytes:r.k}),s=Qd.encode({seq:r.seq,v:r.v}).subarray(1,-1);if(!(yield yi.verify({key:n,signature:r.sig,data:s})))throw new rt(Je.InvalidSignature,"Invalid signature for DHT BEP44 message");return E_(r.v)})}static parseTxtDataToObject(e){return this.parseTxtDataToString(e).split(Wm).reduce((r,n)=>{const[s,i]=n.split("=");return r[s]=i,r},{})}static parseTxtDataToString(e){if(typeof e=="string")return e;if(e instanceof Uint8Array)return at.uint8Array(e).toString();if(Array.isArray(e))return e.map(r=>this.parseTxtDataToString(r)).join("");throw new rt(Je.InternalError,"Pkarr returned DNS TXT record with invalid data type")}static validatePreviousDidProof(e){return un(this,arguments,void 0,function*({newDid:r,previousDidProof:n}){const s=yield Jm.identifierToIdentityKey({didUri:n.previousDid}),i=Jm.identifierToIdentityKeyBytes({didUri:r}),o=at.base64Url(n.signature).toUint8Array();if(!(yield yi.verify({key:s,data:i,signature:o})))throw new rt(Je.InvalidPreviousDidProof,"The previous DID proof is invalid.")})}static chunkDataIfNeeded(e){if(e.length<=255)return e;const r=[];for(let n=0;n<e.length;n+=255)r.push(e.slice(n,n+255));return r}};const Br={DeltaExceedsMaximumSize:"DeltaExceedsMaximumSize",DidDocumentPublicKeyIdDuplicated:"DidDocumentPublicKeyIdDuplicated",DidDocumentPublicKeyMissingOrIncorrectType:"DidDocumentPublicKeyMissingOrIncorrectType",DidDocumentServiceIdDuplicated:"DidDocumentServiceIdDuplicated",DidSuffixIncorrectLength:"DidSuffixIncorrectLength",EncodedStringIncorrectEncoding:"EncodedStringIncorrectEncoding",IdNotUsingBase64UrlCharacterSet:"IdNotUsingBase64UrlCharacterSet",IdTooLong:"IdTooLong",JwkEs256kMissingOrInvalidCrv:"JwkEs256kMissingOrInvalidCrv",JwkEs256kMissingOrInvalidKty:"JwkEs256kMissingOrInvalidKty",JwkEs256kHasIncorrectLengthOfX:"JwkEs256kHasIncorrectLengthOfX",JwkEs256kHasIncorrectLengthOfY:"JwkEs256kHasIncorrectLengthOfY",JwkEs256kHasIncorrectLengthOfD:"JwkEs256kHasIncorrectLengthOfD",MultihashStringNotAMultihash:"MultihashStringNotAMultihash",MultihashUnsupportedHashAlgorithm:"MultihashUnsupportedHashAlgorithm",PublicKeyJwkEs256kHasUnexpectedProperty:"PublicKeyJwkEs256kHasUnexpectedProperty",PublicKeyPurposeDuplicated:"PublicKeyPurposeDuplicated",ServiceEndpointCannotBeAnArray:"ServiceEndpointCannotBeAnArray",ServiceEndpointStringNotValidUri:"ServiceEndpointStringNotValidUri",ServiceTypeTooLong:"ServiceTypeTooLong"};class Fr extends Error{constructor(e,r){super(`${e}: ${r}`),this.code=e,Object.setPrototypeOf(this,new.target.prototype)}}const S9=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};let $9=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},x9=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return WC(this,e)}},D9=class{constructor(e){this.decoders=e}or(e){return WC(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const WC=(t,e)=>new D9({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let P9=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new $9(e,r,n),this.decoder=new x9(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const C9=({name:t,prefix:e,encode:r,decode:n})=>new P9(t,e,r,n),k9=(t,e,r,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},O9=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},Tg=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>C9({prefix:e,name:t,encode(s){return O9(s,n,r)},decode(s){return k9(s,n,r,t)}});Tg({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});Tg({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const MS=Tg({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});Tg({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});let ef=class Gm{static encode(e){return MS.baseEncode(e)}static decodeAsBytes(e,r){if(!Gm.isBase64UrlString(e))throw new Fr(Br.EncodedStringIncorrectEncoding,`Given ${r} must be base64url string.`);return MS.baseDecode(e)}static decodeAsString(e,r){const n=Gm.decodeAsBytes(e,r);return Gm.bytesToString(n)}static isBase64UrlString(e){return/^[A-Za-z0-9_-]+$/.test(e)}static stringToBytes(e){return new TextEncoder().encode(e)}static bytesToString(e){return new TextDecoder().decode(e)}};var kb={exports:{}};/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */(function(t,e){(function(r,n){n(e)})(Zt,function(r){function n(){for(var re=arguments.length,Q=Array(re),ie=0;ie<re;ie++)Q[ie]=arguments[ie];if(Q.length>1){Q[0]=Q[0].slice(0,-1);for(var fe=Q.length-1,le=1;le<fe;++le)Q[le]=Q[le].slice(1,-1);return Q[fe]=Q[fe].slice(1),Q.join("")}else return Q[0]}function s(re){return"(?:"+re+")"}function i(re){return re===void 0?"undefined":re===null?"null":Object.prototype.toString.call(re).split(" ").pop().split("]").shift().toLowerCase()}function o(re){return re.toUpperCase()}function a(re){return re!=null?re instanceof Array?re:typeof re.length!="number"||re.split||re.setInterval||re.call?[re]:Array.prototype.slice.call(re):[]}function c(re,Q){var ie=re;if(Q)for(var fe in Q)ie[fe]=Q[fe];return ie}function l(re){var Q="[A-Za-z]",ie="[0-9]",fe=n(ie,"[A-Fa-f]"),le=s(s("%[EFef]"+fe+"%"+fe+fe+"%"+fe+fe)+"|"+s("%[89A-Fa-f]"+fe+"%"+fe+fe)+"|"+s("%"+fe+fe)),je="[\\:\\/\\?\\#\\[\\]\\@]",et="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",jt=n(je,et),pr=re?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",Cr=re?"[\\uE000-\\uF8FF]":"[]",Bt=n(Q,ie,"[\\-\\.\\_\\~]",pr);s(Q+n(Q,ie,"[\\+\\-\\.]")+"*"),s(s(le+"|"+n(Bt,et,"[\\:]"))+"*");var cr=s(s("25[0-5]")+"|"+s("2[0-4]"+ie)+"|"+s("1"+ie+ie)+"|"+s("0?[1-9]"+ie)+"|0?0?"+ie),kr=s(cr+"\\."+cr+"\\."+cr+"\\."+cr),yt=s(fe+"{1,4}"),gr=s(s(yt+"\\:"+yt)+"|"+kr),jr=s(s(yt+"\\:")+"{6}"+gr),vr=s("\\:\\:"+s(yt+"\\:")+"{5}"+gr),ru=s(s(yt)+"?\\:\\:"+s(yt+"\\:")+"{4}"+gr),Ys=s(s(s(yt+"\\:")+"{0,1}"+yt)+"?\\:\\:"+s(yt+"\\:")+"{3}"+gr),Qs=s(s(s(yt+"\\:")+"{0,2}"+yt)+"?\\:\\:"+s(yt+"\\:")+"{2}"+gr),od=s(s(s(yt+"\\:")+"{0,3}"+yt)+"?\\:\\:"+yt+"\\:"+gr),kc=s(s(s(yt+"\\:")+"{0,4}"+yt)+"?\\:\\:"+gr),Vi=s(s(s(yt+"\\:")+"{0,5}"+yt)+"?\\:\\:"+yt),eo=s(s(s(yt+"\\:")+"{0,6}"+yt)+"?\\:\\:"),Oc=s([jr,vr,ru,Ys,Qs,od,kc,Vi,eo].join("|")),ta=s(s(Bt+"|"+le)+"+");s("[vV]"+fe+"+\\."+n(Bt,et,"[\\:]")+"+"),s(s(le+"|"+n(Bt,et))+"*");var xf=s(le+"|"+n(Bt,et,"[\\:\\@]"));return s(s(le+"|"+n(Bt,et,"[\\@]"))+"+"),s(s(xf+"|"+n("[\\/\\?]",Cr))+"*"),{NOT_SCHEME:new RegExp(n("[^]",Q,ie,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(n("[^\\%\\:]",Bt,et),"g"),NOT_HOST:new RegExp(n("[^\\%\\[\\]\\:]",Bt,et),"g"),NOT_PATH:new RegExp(n("[^\\%\\/\\:\\@]",Bt,et),"g"),NOT_PATH_NOSCHEME:new RegExp(n("[^\\%\\/\\@]",Bt,et),"g"),NOT_QUERY:new RegExp(n("[^\\%]",Bt,et,"[\\:\\@\\/\\?]",Cr),"g"),NOT_FRAGMENT:new RegExp(n("[^\\%]",Bt,et,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(n("[^]",Bt,et),"g"),UNRESERVED:new RegExp(Bt,"g"),OTHER_CHARS:new RegExp(n("[^\\%]",Bt,jt),"g"),PCT_ENCODED:new RegExp(le,"g"),IPV4ADDRESS:new RegExp("^("+kr+")$"),IPV6ADDRESS:new RegExp("^\\[?("+Oc+")"+s(s("\\%25|\\%(?!"+fe+"{2})")+"("+ta+")")+"?\\]?$")}}var u=l(!1),d=l(!0),h=function(){function re(Q,ie){var fe=[],le=!0,je=!1,et=void 0;try{for(var jt=Q[Symbol.iterator](),pr;!(le=(pr=jt.next()).done)&&(fe.push(pr.value),!(ie&&fe.length===ie));le=!0);}catch(Cr){je=!0,et=Cr}finally{try{!le&&jt.return&&jt.return()}finally{if(je)throw et}}return fe}return function(Q,ie){if(Array.isArray(Q))return Q;if(Symbol.iterator in Object(Q))return re(Q,ie);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f=function(re){if(Array.isArray(re)){for(var Q=0,ie=Array(re.length);Q<re.length;Q++)ie[Q]=re[Q];return ie}else return Array.from(re)},p=2147483647,y=36,b=1,w=26,g=38,v=700,m=72,_=128,x="-",D=/^xn--/,E=/[^\0-\x7E]/,A=/[\x2E\u3002\uFF0E\uFF61]/g,S={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},O=y-b,I=Math.floor,N=String.fromCharCode;function j(re){throw new RangeError(S[re])}function F(re,Q){for(var ie=[],fe=re.length;fe--;)ie[fe]=Q(re[fe]);return ie}function V(re,Q){var ie=re.split("@"),fe="";ie.length>1&&(fe=ie[0]+"@",re=ie[1]),re=re.replace(A,".");var le=re.split("."),je=F(le,Q).join(".");return fe+je}function ee(re){for(var Q=[],ie=0,fe=re.length;ie<fe;){var le=re.charCodeAt(ie++);if(le>=55296&&le<=56319&&ie<fe){var je=re.charCodeAt(ie++);(je&64512)==56320?Q.push(((le&1023)<<10)+(je&1023)+65536):(Q.push(le),ie--)}else Q.push(le)}return Q}var G=function(Q){return String.fromCodePoint.apply(String,f(Q))},Z=function(Q){return Q-48<10?Q-22:Q-65<26?Q-65:Q-97<26?Q-97:y},M=function(Q,ie){return Q+22+75*(Q<26)-((ie!=0)<<5)},k=function(Q,ie,fe){var le=0;for(Q=fe?I(Q/v):Q>>1,Q+=I(Q/ie);Q>O*w>>1;le+=y)Q=I(Q/O);return I(le+(O+1)*Q/(Q+g))},H=function(Q){var ie=[],fe=Q.length,le=0,je=_,et=m,jt=Q.lastIndexOf(x);jt<0&&(jt=0);for(var pr=0;pr<jt;++pr)Q.charCodeAt(pr)>=128&&j("not-basic"),ie.push(Q.charCodeAt(pr));for(var Cr=jt>0?jt+1:0;Cr<fe;){for(var Bt=le,cr=1,kr=y;;kr+=y){Cr>=fe&&j("invalid-input");var yt=Z(Q.charCodeAt(Cr++));(yt>=y||yt>I((p-le)/cr))&&j("overflow"),le+=yt*cr;var gr=kr<=et?b:kr>=et+w?w:kr-et;if(yt<gr)break;var jr=y-gr;cr>I(p/jr)&&j("overflow"),cr*=jr}var vr=ie.length+1;et=k(le-Bt,vr,Bt==0),I(le/vr)>p-je&&j("overflow"),je+=I(le/vr),le%=vr,ie.splice(le++,0,je)}return String.fromCodePoint.apply(String,ie)},U=function(Q){var ie=[];Q=ee(Q);var fe=Q.length,le=_,je=0,et=m,jt=!0,pr=!1,Cr=void 0;try{for(var Bt=Q[Symbol.iterator](),cr;!(jt=(cr=Bt.next()).done);jt=!0){var kr=cr.value;kr<128&&ie.push(N(kr))}}catch(Df){pr=!0,Cr=Df}finally{try{!jt&&Bt.return&&Bt.return()}finally{if(pr)throw Cr}}var yt=ie.length,gr=yt;for(yt&&ie.push(x);gr<fe;){var jr=p,vr=!0,ru=!1,Ys=void 0;try{for(var Qs=Q[Symbol.iterator](),od;!(vr=(od=Qs.next()).done);vr=!0){var kc=od.value;kc>=le&&kc<jr&&(jr=kc)}}catch(Df){ru=!0,Ys=Df}finally{try{!vr&&Qs.return&&Qs.return()}finally{if(ru)throw Ys}}var Vi=gr+1;jr-le>I((p-je)/Vi)&&j("overflow"),je+=(jr-le)*Vi,le=jr;var eo=!0,Oc=!1,ta=void 0;try{for(var xf=Q[Symbol.iterator](),O2;!(eo=(O2=xf.next()).done);eo=!0){var T2=O2.value;if(T2<le&&++je>p&&j("overflow"),T2==le){for(var vy=je,wy=y;;wy+=y){var by=wy<=et?b:wy>=et+w?w:wy-et;if(vy<by)break;var I2=vy-by,B2=y-by;ie.push(N(M(by+I2%B2,0))),vy=I(I2/B2)}ie.push(N(M(vy,0))),et=k(je,Vi,gr==yt),je=0,++gr}}}catch(Df){Oc=!0,ta=Df}finally{try{!eo&&xf.return&&xf.return()}finally{if(Oc)throw ta}}++je,++le}return ie.join("")},$=function(Q){return V(Q,function(ie){return D.test(ie)?H(ie.slice(4).toLowerCase()):ie})},T=function(Q){return V(Q,function(ie){return E.test(ie)?"xn--"+U(ie):ie})},z={version:"2.1.0",ucs2:{decode:ee,encode:G},decode:H,encode:U,toASCII:T,toUnicode:$},ne={};function ue(re){var Q=re.charCodeAt(0),ie=void 0;return Q<16?ie="%0"+Q.toString(16).toUpperCase():Q<128?ie="%"+Q.toString(16).toUpperCase():Q<2048?ie="%"+(Q>>6|192).toString(16).toUpperCase()+"%"+(Q&63|128).toString(16).toUpperCase():ie="%"+(Q>>12|224).toString(16).toUpperCase()+"%"+(Q>>6&63|128).toString(16).toUpperCase()+"%"+(Q&63|128).toString(16).toUpperCase(),ie}function ye(re){for(var Q="",ie=0,fe=re.length;ie<fe;){var le=parseInt(re.substr(ie+1,2),16);if(le<128)Q+=String.fromCharCode(le),ie+=3;else if(le>=194&&le<224){if(fe-ie>=6){var je=parseInt(re.substr(ie+4,2),16);Q+=String.fromCharCode((le&31)<<6|je&63)}else Q+=re.substr(ie,6);ie+=6}else if(le>=224){if(fe-ie>=9){var et=parseInt(re.substr(ie+4,2),16),jt=parseInt(re.substr(ie+7,2),16);Q+=String.fromCharCode((le&15)<<12|(et&63)<<6|jt&63)}else Q+=re.substr(ie,9);ie+=9}else Q+=re.substr(ie,3),ie+=3}return Q}function _e(re,Q){function ie(fe){var le=ye(fe);return le.match(Q.UNRESERVED)?le:fe}return re.scheme&&(re.scheme=String(re.scheme).replace(Q.PCT_ENCODED,ie).toLowerCase().replace(Q.NOT_SCHEME,"")),re.userinfo!==void 0&&(re.userinfo=String(re.userinfo).replace(Q.PCT_ENCODED,ie).replace(Q.NOT_USERINFO,ue).replace(Q.PCT_ENCODED,o)),re.host!==void 0&&(re.host=String(re.host).replace(Q.PCT_ENCODED,ie).toLowerCase().replace(Q.NOT_HOST,ue).replace(Q.PCT_ENCODED,o)),re.path!==void 0&&(re.path=String(re.path).replace(Q.PCT_ENCODED,ie).replace(re.scheme?Q.NOT_PATH:Q.NOT_PATH_NOSCHEME,ue).replace(Q.PCT_ENCODED,o)),re.query!==void 0&&(re.query=String(re.query).replace(Q.PCT_ENCODED,ie).replace(Q.NOT_QUERY,ue).replace(Q.PCT_ENCODED,o)),re.fragment!==void 0&&(re.fragment=String(re.fragment).replace(Q.PCT_ENCODED,ie).replace(Q.NOT_FRAGMENT,ue).replace(Q.PCT_ENCODED,o)),re}function Se(re){return re.replace(/^0*(.*)/,"$1")||"0"}function We(re,Q){var ie=re.match(Q.IPV4ADDRESS)||[],fe=h(ie,2),le=fe[1];return le?le.split(".").map(Se).join("."):re}function te(re,Q){var ie=re.match(Q.IPV6ADDRESS)||[],fe=h(ie,3),le=fe[1],je=fe[2];if(le){for(var et=le.toLowerCase().split("::").reverse(),jt=h(et,2),pr=jt[0],Cr=jt[1],Bt=Cr?Cr.split(":").map(Se):[],cr=pr.split(":").map(Se),kr=Q.IPV4ADDRESS.test(cr[cr.length-1]),yt=kr?7:8,gr=cr.length-yt,jr=Array(yt),vr=0;vr<yt;++vr)jr[vr]=Bt[vr]||cr[gr+vr]||"";kr&&(jr[yt-1]=We(jr[yt-1],Q));var ru=jr.reduce(function(Vi,eo,Oc){if(!eo||eo==="0"){var ta=Vi[Vi.length-1];ta&&ta.index+ta.length===Oc?ta.length++:Vi.push({index:Oc,length:1})}return Vi},[]),Ys=ru.sort(function(Vi,eo){return eo.length-Vi.length})[0],Qs=void 0;if(Ys&&Ys.length>1){var od=jr.slice(0,Ys.index),kc=jr.slice(Ys.index+Ys.length);Qs=od.join(":")+"::"+kc.join(":")}else Qs=jr.join(":");return je&&(Qs+="%"+je),Qs}else return re}var se=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,ce="".match(/(){0}/)[1]===void 0;function K(re){var Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ie={},fe=Q.iri!==!1?d:u;Q.reference==="suffix"&&(re=(Q.scheme?Q.scheme+":":"")+"//"+re);var le=re.match(se);if(le){ce?(ie.scheme=le[1],ie.userinfo=le[3],ie.host=le[4],ie.port=parseInt(le[5],10),ie.path=le[6]||"",ie.query=le[7],ie.fragment=le[8],isNaN(ie.port)&&(ie.port=le[5])):(ie.scheme=le[1]||void 0,ie.userinfo=re.indexOf("@")!==-1?le[3]:void 0,ie.host=re.indexOf("//")!==-1?le[4]:void 0,ie.port=parseInt(le[5],10),ie.path=le[6]||"",ie.query=re.indexOf("?")!==-1?le[7]:void 0,ie.fragment=re.indexOf("#")!==-1?le[8]:void 0,isNaN(ie.port)&&(ie.port=re.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?le[4]:void 0)),ie.host&&(ie.host=te(We(ie.host,fe),fe)),ie.scheme===void 0&&ie.userinfo===void 0&&ie.host===void 0&&ie.port===void 0&&!ie.path&&ie.query===void 0?ie.reference="same-document":ie.scheme===void 0?ie.reference="relative":ie.fragment===void 0?ie.reference="absolute":ie.reference="uri",Q.reference&&Q.reference!=="suffix"&&Q.reference!==ie.reference&&(ie.error=ie.error||"URI is not a "+Q.reference+" reference.");var je=ne[(Q.scheme||ie.scheme||"").toLowerCase()];if(!Q.unicodeSupport&&(!je||!je.unicodeSupport)){if(ie.host&&(Q.domainHost||je&&je.domainHost))try{ie.host=z.toASCII(ie.host.replace(fe.PCT_ENCODED,ye).toLowerCase())}catch(et){ie.error=ie.error||"Host's domain name can not be converted to ASCII via punycode: "+et}_e(ie,u)}else _e(ie,fe);je&&je.parse&&je.parse(ie,Q)}else ie.error=ie.error||"URI can not be parsed.";return ie}function C(re,Q){var ie=Q.iri!==!1?d:u,fe=[];return re.userinfo!==void 0&&(fe.push(re.userinfo),fe.push("@")),re.host!==void 0&&fe.push(te(We(String(re.host),ie),ie).replace(ie.IPV6ADDRESS,function(le,je,et){return"["+je+(et?"%25"+et:"")+"]"})),(typeof re.port=="number"||typeof re.port=="string")&&(fe.push(":"),fe.push(String(re.port))),fe.length?fe.join(""):void 0}var B=/^\.\.?\//,X=/^\/\.(\/|$)/,ae=/^\/\.\.(\/|$)/,ge=/^\/?(?:.|\n)*?(?=\/|$)/;function be(re){for(var Q=[];re.length;)if(re.match(B))re=re.replace(B,"");else if(re.match(X))re=re.replace(X,"/");else if(re.match(ae))re=re.replace(ae,"/"),Q.pop();else if(re==="."||re==="..")re="";else{var ie=re.match(ge);if(ie){var fe=ie[0];re=re.slice(fe.length),Q.push(fe)}else throw new Error("Unexpected dot segment condition")}return Q.join("")}function Ne(re){var Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ie=Q.iri?d:u,fe=[],le=ne[(Q.scheme||re.scheme||"").toLowerCase()];if(le&&le.serialize&&le.serialize(re,Q),re.host&&!ie.IPV6ADDRESS.test(re.host)){if(Q.domainHost||le&&le.domainHost)try{re.host=Q.iri?z.toUnicode(re.host):z.toASCII(re.host.replace(ie.PCT_ENCODED,ye).toLowerCase())}catch(jt){re.error=re.error||"Host's domain name can not be converted to "+(Q.iri?"Unicode":"ASCII")+" via punycode: "+jt}}_e(re,ie),Q.reference!=="suffix"&&re.scheme&&(fe.push(re.scheme),fe.push(":"));var je=C(re,Q);if(je!==void 0&&(Q.reference!=="suffix"&&fe.push("//"),fe.push(je),re.path&&re.path.charAt(0)!=="/"&&fe.push("/")),re.path!==void 0){var et=re.path;!Q.absolutePath&&(!le||!le.absolutePath)&&(et=be(et)),je===void 0&&(et=et.replace(/^\/\//,"/%2F")),fe.push(et)}return re.query!==void 0&&(fe.push("?"),fe.push(re.query)),re.fragment!==void 0&&(fe.push("#"),fe.push(re.fragment)),fe.join("")}function Oe(re,Q){var ie=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},fe=arguments[3],le={};return fe||(re=K(Ne(re,ie),ie),Q=K(Ne(Q,ie),ie)),ie=ie||{},!ie.tolerant&&Q.scheme?(le.scheme=Q.scheme,le.userinfo=Q.userinfo,le.host=Q.host,le.port=Q.port,le.path=be(Q.path||""),le.query=Q.query):(Q.userinfo!==void 0||Q.host!==void 0||Q.port!==void 0?(le.userinfo=Q.userinfo,le.host=Q.host,le.port=Q.port,le.path=be(Q.path||""),le.query=Q.query):(Q.path?(Q.path.charAt(0)==="/"?le.path=be(Q.path):((re.userinfo!==void 0||re.host!==void 0||re.port!==void 0)&&!re.path?le.path="/"+Q.path:re.path?le.path=re.path.slice(0,re.path.lastIndexOf("/")+1)+Q.path:le.path=Q.path,le.path=be(le.path)),le.query=Q.query):(le.path=re.path,Q.query!==void 0?le.query=Q.query:le.query=re.query),le.userinfo=re.userinfo,le.host=re.host,le.port=re.port),le.scheme=re.scheme),le.fragment=Q.fragment,le}function W(re,Q,ie){var fe=c({scheme:"null"},ie);return Ne(Oe(K(re,fe),K(Q,fe),fe,!0),fe)}function J(re,Q){return typeof re=="string"?re=Ne(K(re,Q),Q):i(re)==="object"&&(re=K(Ne(re,Q),Q)),re}function he(re,Q,ie){return typeof re=="string"?re=Ne(K(re,ie),ie):i(re)==="object"&&(re=Ne(re,ie)),typeof Q=="string"?Q=Ne(K(Q,ie),ie):i(Q)==="object"&&(Q=Ne(Q,ie)),re===Q}function we(re,Q){return re&&re.toString().replace(!Q||!Q.iri?u.ESCAPE:d.ESCAPE,ue)}function Ce(re,Q){return re&&re.toString().replace(!Q||!Q.iri?u.PCT_ENCODED:d.PCT_ENCODED,ye)}var Mt={scheme:"http",domainHost:!0,parse:function(Q,ie){return Q.host||(Q.error=Q.error||"HTTP URIs must have a host."),Q},serialize:function(Q,ie){var fe=String(Q.scheme).toLowerCase()==="https";return(Q.port===(fe?443:80)||Q.port==="")&&(Q.port=void 0),Q.path||(Q.path="/"),Q}},or={scheme:"https",domainHost:Mt.domainHost,parse:Mt.parse,serialize:Mt.serialize};function Gs(re){return typeof re.secure=="boolean"?re.secure:String(re.scheme).toLowerCase()==="wss"}var xr={scheme:"ws",domainHost:!0,parse:function(Q,ie){var fe=Q;return fe.secure=Gs(fe),fe.resourceName=(fe.path||"/")+(fe.query?"?"+fe.query:""),fe.path=void 0,fe.query=void 0,fe},serialize:function(Q,ie){if((Q.port===(Gs(Q)?443:80)||Q.port==="")&&(Q.port=void 0),typeof Q.secure=="boolean"&&(Q.scheme=Q.secure?"wss":"ws",Q.secure=void 0),Q.resourceName){var fe=Q.resourceName.split("?"),le=h(fe,2),je=le[0],et=le[1];Q.path=je&&je!=="/"?je:void 0,Q.query=et,Q.resourceName=void 0}return Q.fragment=void 0,Q}},mr={scheme:"wss",domainHost:xr.domainHost,parse:xr.parse,serialize:xr.serialize},sd={},Cc="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",Rt="[0-9A-Fa-f]",zr=s(s("%[EFef]"+Rt+"%"+Rt+Rt+"%"+Rt+Rt)+"|"+s("%[89A-Fa-f]"+Rt+"%"+Rt+Rt)+"|"+s("%"+Rt+Rt)),$s="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",Zs="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",Xs=n(Zs,'[\\"\\\\]'),xs="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",_i=new RegExp(Cc,"g"),P=new RegExp(zr,"g"),L=new RegExp(n("[^]",$s,"[\\.]",'[\\"]',Xs),"g"),R=new RegExp(n("[^]",Cc,xs),"g"),q=R;function Y(re){var Q=ye(re);return Q.match(_i)?Q:re}var pe={scheme:"mailto",parse:function(Q,ie){var fe=Q,le=fe.to=fe.path?fe.path.split(","):[];if(fe.path=void 0,fe.query){for(var je=!1,et={},jt=fe.query.split("&"),pr=0,Cr=jt.length;pr<Cr;++pr){var Bt=jt[pr].split("=");switch(Bt[0]){case"to":for(var cr=Bt[1].split(","),kr=0,yt=cr.length;kr<yt;++kr)le.push(cr[kr]);break;case"subject":fe.subject=Ce(Bt[1],ie);break;case"body":fe.body=Ce(Bt[1],ie);break;default:je=!0,et[Ce(Bt[0],ie)]=Ce(Bt[1],ie);break}}je&&(fe.headers=et)}fe.query=void 0;for(var gr=0,jr=le.length;gr<jr;++gr){var vr=le[gr].split("@");if(vr[0]=Ce(vr[0]),ie.unicodeSupport)vr[1]=Ce(vr[1],ie).toLowerCase();else try{vr[1]=z.toASCII(Ce(vr[1],ie).toLowerCase())}catch(ru){fe.error=fe.error||"Email address's domain name can not be converted to ASCII via punycode: "+ru}le[gr]=vr.join("@")}return fe},serialize:function(Q,ie){var fe=Q,le=a(Q.to);if(le){for(var je=0,et=le.length;je<et;++je){var jt=String(le[je]),pr=jt.lastIndexOf("@"),Cr=jt.slice(0,pr).replace(P,Y).replace(P,o).replace(L,ue),Bt=jt.slice(pr+1);try{Bt=ie.iri?z.toUnicode(Bt):z.toASCII(Ce(Bt,ie).toLowerCase())}catch(gr){fe.error=fe.error||"Email address's domain name can not be converted to "+(ie.iri?"Unicode":"ASCII")+" via punycode: "+gr}le[je]=Cr+"@"+Bt}fe.path=le.join(",")}var cr=Q.headers=Q.headers||{};Q.subject&&(cr.subject=Q.subject),Q.body&&(cr.body=Q.body);var kr=[];for(var yt in cr)cr[yt]!==sd[yt]&&kr.push(yt.replace(P,Y).replace(P,o).replace(R,ue)+"="+cr[yt].replace(P,Y).replace(P,o).replace(q,ue));return kr.length&&(fe.query=kr.join("&")),fe}},ve=/^([^\:]+)\:(.*)/,Ee={scheme:"urn",parse:function(Q,ie){var fe=Q.path&&Q.path.match(ve),le=Q;if(fe){var je=ie.scheme||le.scheme||"urn",et=fe[1].toLowerCase(),jt=fe[2],pr=je+":"+(ie.nid||et),Cr=ne[pr];le.nid=et,le.nss=jt,le.path=void 0,Cr&&(le=Cr.parse(le,ie))}else le.error=le.error||"URN can not be parsed.";return le},serialize:function(Q,ie){var fe=ie.scheme||Q.scheme||"urn",le=Q.nid,je=fe+":"+(ie.nid||le),et=ne[je];et&&(Q=et.serialize(Q,ie));var jt=Q,pr=Q.nss;return jt.path=(le||ie.nid)+":"+pr,jt}},Re=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Dt={scheme:"urn:uuid",parse:function(Q,ie){var fe=Q;return fe.uuid=fe.nss,fe.nss=void 0,!ie.tolerant&&(!fe.uuid||!fe.uuid.match(Re))&&(fe.error=fe.error||"UUID is not valid."),fe},serialize:function(Q,ie){var fe=Q;return fe.nss=(Q.uuid||"").toLowerCase(),fe}};ne[Mt.scheme]=Mt,ne[or.scheme]=or,ne[xr.scheme]=xr,ne[mr.scheme]=mr,ne[pe.scheme]=pe,ne[Ee.scheme]=Ee,ne[Dt.scheme]=Dt,r.SCHEMES=ne,r.pctEncChar=ue,r.pctDecChars=ye,r.parse=K,r.removeDotSegments=be,r.serialize=Ne,r.resolveComponents=Oe,r.resolve=W,r.normalize=J,r.equal=he,r.escapeComponent=we,r.unescapeComponent=Ce,Object.defineProperty(r,"__esModule",{value:!0})})})(kb,kb.exports);var JC=kb.exports,Ob;(function(t){t.Public="public",t.Private="private"})(Ob||(Ob={}));const bo=Ob;class Si{static validateEs256kOperationKey(e,r){const n=new Set(["kty","crv","x","y"]);r===bo.Private&&n.add("d");for(const s in e)if(!n.has(s))throw new Fr(Br.PublicKeyJwkEs256kHasUnexpectedProperty,`SECP256K1 JWK key has unexpected property '${s}'.`);if(e.crv!=="secp256k1")throw new Fr(Br.JwkEs256kMissingOrInvalidCrv,`SECP256K1 JWK 'crv' property must be 'secp256k1' but got '${e.crv}.'`);if(e.kty!=="EC")throw new Fr(Br.JwkEs256kMissingOrInvalidKty,`SECP256K1 JWK 'kty' property must be 'EC' but got '${e.kty}.'`);if(e.x.length!==43)throw new Fr(Br.JwkEs256kHasIncorrectLengthOfX,"SECP256K1 JWK 'x' property must be 43 bytes.");if(e.y.length!==43)throw new Fr(Br.JwkEs256kHasIncorrectLengthOfY,"SECP256K1 JWK 'y' property must be 43 bytes.");if(r===bo.Private&&(e.d===void 0||e.d.length!==43))throw new Fr(Br.JwkEs256kHasIncorrectLengthOfD,"SECP256K1 JWK 'd' property must be 43 bytes.")}static validateId(e){if(e.length>50)throw new Fr(Br.IdTooLong,`Key ID length ${e.length} exceed max allowed length of 50.`);if(!ef.isBase64UrlString(e))throw new Fr(Br.IdNotUsingBase64UrlCharacterSet,`Key ID '${e}' is not a Base64URL string.`)}static validatePublicKeyPurposes(e){if(e===void 0)return;const r=new Set;for(const n of e){if(r.has(n))throw new Fr(Br.PublicKeyPurposeDuplicated,`Public key purpose '${n}' already specified.`);r.add(n)}}}class Oi{}Oi.hashAlgorithmInMultihashCode=18;Oi.maxCanonicalizedDeltaSizeInBytes=1e3;var T9=function t(e){if(typeof e=="number"&&isNaN(e))throw new Error("NaN is not allowed");if(typeof e=="number"&&!isFinite(e))throw new Error("Infinity is not allowed");return e===null||typeof e!="object"?JSON.stringify(e):e.toJSON instanceof Function?t(e.toJSON()):Array.isArray(e)?`[${e.reduce((s,i,o)=>`${s}${o===0?"":","}${t(i===void 0||typeof i=="symbol"?null:i)}`,"")}]`:`{${Object.keys(e).sort().reduce((n,s)=>{if(e[s]===void 0||typeof e[s]=="symbol")return n;const i=n.length===0?"":",";return`${n}${i}${t(s)}:${t(e[s])}`},"")}}`};const GC=Jo(T9);class mc{static canonicalizeAsBytes(e){const r=mc.removeAllUndefinedProperties(e),n=GC(r);return ef.stringToBytes(n)}static removeAllUndefinedProperties(e){for(const r in e)typeof e[r]=="object"?mc.removeAllUndefinedProperties(e[r]):e[r]===void 0&&delete e[r];return e}}var I9=ZC,US=128,B9=127,F9=~B9,N9=Math.pow(2,31);function ZC(t,e,r){e=e||[],r=r||0;for(var n=r;t>=N9;)e[r++]=t&255|US,t/=128;for(;t&F9;)e[r++]=t&255|US,t>>>=7;return e[r]=t|0,ZC.bytes=r-n+1,e}var R9=Tb,j9=128,KS=127;function Tb(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw Tb.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&KS)<<s:(o&KS)*Math.pow(2,s),s+=7}while(o>=j9);return Tb.bytes=i-n,r}var M9=Math.pow(2,7),U9=Math.pow(2,14),K9=Math.pow(2,21),L9=Math.pow(2,28),q9=Math.pow(2,35),V9=Math.pow(2,42),z9=Math.pow(2,49),H9=Math.pow(2,56),W9=Math.pow(2,63),J9=function(t){return t<M9?1:t<U9?2:t<K9?3:t<L9?4:t<q9?5:t<V9?6:t<z9?7:t<H9?8:t<W9?9:10},G9={encode:I9,decode:R9,encodingLength:J9},O0=G9;const LS=(t,e=0)=>[O0.decode(t,e),O0.decode.bytes],qS=(t,e,r=0)=>(O0.encode(t,e,r),e),VS=t=>O0.encodingLength(t),zS=(t,e)=>{const r=e.byteLength,n=VS(t),s=n+VS(r),i=new Uint8Array(s+r);return qS(t,i,0),qS(r,i,n),i.set(e,s),new XC(t,r,e,i)},Z9=t=>{const e=S9(t),[r,n]=LS(e),[s,i]=LS(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new XC(r,s,o,e)};class XC{constructor(e,r,n,s){this.code=e,this.size=r,this.digest=n,this.bytes=s}}const X9=({name:t,code:e,encode:r})=>new Y9(t,e,r);class Y9{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?zS(this.code,r):r.then(n=>zS(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Q9=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),HS=X9({name:"sha2-256",code:18,encode:Q9("SHA-256")});var Yf=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};class sn{static hash(e,r){return Yf(this,void 0,void 0,function*(){let n;switch(r){case 18:n=(yield HS.digest(e)).bytes;break;default:throw new Fr(Br.MultihashUnsupportedHashAlgorithm,`Hash algorithm defined in multihash code ${r} is not supported.`)}return n})}static hashAsNonMultihashBytes(e,r){return Yf(this,void 0,void 0,function*(){let n;switch(r){case 18:n=yield HS.encode(e);break;default:throw new Fr(Br.MultihashUnsupportedHashAlgorithm,`Hash algorithm defined in multihash code ${r} is not supported.`)}return n})}static canonicalizeThenHashThenEncode(e,r){return Yf(this,void 0,void 0,function*(){const n=mc.canonicalizeAsBytes(e);return yield sn.hashThenEncode(n,r)})}static canonicalizeThenDoubleHashThenEncode(e,r){return Yf(this,void 0,void 0,function*(){const n=mc.canonicalizeAsBytes(e),s=yield sn.hashAsNonMultihashBytes(n,r);return yield sn.hashThenEncode(s,r)})}static hashThenEncode(e,r){return Yf(this,void 0,void 0,function*(){const n=yield sn.hash(e,r);return ef.encode(n)})}static validateEncodedHashComputedUsingSupportedHashAlgorithm(e,r){let n;const s=ef.decodeAsBytes(e,r);try{n=Z9(s)}catch{throw new Fr(Br.MultihashStringNotAMultihash,`Given ${r} string '${e}' is not a multihash after decoding.`)}const i=Oi.hashAlgorithmInMultihashCode;if(i!==n.code)throw new Fr(Br.MultihashUnsupportedHashAlgorithm,`Given ${r} uses unsupported multihash algorithm with code ${n.code}, should use ${i} or change IonSdkConfig to desired hashing algorithm.`)}}var Ib;(function(t){t.Create="create",t.Update="update",t.Deactivate="deactivate",t.Recover="recover"})(Ib||(Ib={}));const Hy=Ib;var Bb;(function(t){t.Replace="replace",t.AddPublicKeys="add-public-keys",t.RemovePublicKeys="remove-public-keys",t.AddServices="add-services",t.RemoveServices="remove-services"})(Bb||(Bb={}));const gd=Bb;var Wy=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};class Kn{static createCreateRequest(e){return Wy(this,void 0,void 0,function*(){const r=e.recoveryKey,n=e.updateKey,s=e.document.publicKeys,i=e.document.services;Si.validateEs256kOperationKey(r,bo.Public),Si.validateEs256kOperationKey(n,bo.Public),Kn.validateDidDocumentKeys(s),Kn.validateServices(i);const o=Oi.hashAlgorithmInMultihashCode,a=[{action:gd.Replace,document:e.document}],c={updateCommitment:yield sn.canonicalizeThenDoubleHashThenEncode(n,o),patches:a};Kn.validateDeltaSize(c);const u={deltaHash:yield sn.canonicalizeThenHashThenEncode(c,o),recoveryCommitment:yield sn.canonicalizeThenDoubleHashThenEncode(r,o)};return{type:Hy.Create,suffixData:u,delta:c}})}static createDeactivateRequest(e){return Wy(this,void 0,void 0,function*(){Kn.validateDidSuffix(e.didSuffix),Si.validateEs256kOperationKey(e.recoveryPublicKey,bo.Public);const r=Oi.hashAlgorithmInMultihashCode,n=yield sn.canonicalizeThenHashThenEncode(e.recoveryPublicKey,r),s={didSuffix:e.didSuffix,recoveryKey:e.recoveryPublicKey},i=yield e.signer.sign({alg:"ES256K"},s);return{type:Hy.Deactivate,didSuffix:e.didSuffix,revealValue:n,signedData:i}})}static createRecoverRequest(e){return Wy(this,void 0,void 0,function*(){Kn.validateDidSuffix(e.didSuffix),Si.validateEs256kOperationKey(e.recoveryPublicKey,bo.Public),Si.validateEs256kOperationKey(e.nextRecoveryPublicKey,bo.Public),Si.validateEs256kOperationKey(e.nextUpdatePublicKey,bo.Public),Kn.validateDidDocumentKeys(e.document.publicKeys),Kn.validateServices(e.document.services);const r=Oi.hashAlgorithmInMultihashCode,n=yield sn.canonicalizeThenHashThenEncode(e.recoveryPublicKey,r),s=[{action:gd.Replace,document:e.document}],i=yield sn.canonicalizeThenDoubleHashThenEncode(e.nextUpdatePublicKey,r),o={patches:s,updateCommitment:i},a=yield sn.canonicalizeThenHashThenEncode(o,r),l={recoveryCommitment:yield sn.canonicalizeThenDoubleHashThenEncode(e.nextRecoveryPublicKey,r),recoveryKey:e.recoveryPublicKey,deltaHash:a},u=yield e.signer.sign({alg:"ES256K"},l);return{type:Hy.Recover,didSuffix:e.didSuffix,revealValue:n,delta:o,signedData:u}})}static createUpdateRequest(e){return Wy(this,void 0,void 0,function*(){if(Kn.validateDidSuffix(e.didSuffix),Si.validateEs256kOperationKey(e.updatePublicKey,bo.Public),Si.validateEs256kOperationKey(e.nextUpdatePublicKey,bo.Public),Kn.validateServices(e.servicesToAdd),Kn.validateDidDocumentKeys(e.publicKeysToAdd),e.idsOfServicesToRemove!==void 0)for(const p of e.idsOfServicesToRemove)Si.validateId(p);if(e.idsOfPublicKeysToRemove!==void 0)for(const p of e.idsOfPublicKeysToRemove)Si.validateId(p);const r=[],n=e.servicesToAdd;if(n!==void 0&&n.length>0){const p={action:gd.AddServices,services:n};r.push(p)}const s=e.idsOfServicesToRemove;if(s!==void 0&&s.length>0){const p={action:gd.RemoveServices,ids:s};r.push(p)}const i=e.publicKeysToAdd;if(i!==void 0&&i.length>0){const p={action:gd.AddPublicKeys,publicKeys:i};r.push(p)}const o=e.idsOfPublicKeysToRemove;if(o!==void 0&&o.length>0){const p={action:gd.RemovePublicKeys,ids:o};r.push(p)}const a=Oi.hashAlgorithmInMultihashCode,c=yield sn.canonicalizeThenHashThenEncode(e.updatePublicKey,a),l=yield sn.canonicalizeThenDoubleHashThenEncode(e.nextUpdatePublicKey,a),u={patches:r,updateCommitment:l},d=yield sn.canonicalizeThenHashThenEncode(u,a),h={updateKey:e.updatePublicKey,deltaHash:d},f=yield e.signer.sign({alg:"ES256K"},h);return{type:Hy.Update,didSuffix:e.didSuffix,revealValue:c,delta:u,signedData:f}})}static validateDidSuffix(e){sn.validateEncodedHashComputedUsingSupportedHashAlgorithm(e,"didSuffix")}static validateDidDocumentKeys(e){if(e===void 0)return;const r=new Set;for(const n of e){if(Array.isArray(n.publicKeyJwk))throw new Fr(Br.DidDocumentPublicKeyMissingOrIncorrectType,"DID Document key 'publicKeyJwk' property is not a non-array object.");if(Si.validateId(n.id),r.has(n.id))throw new Fr(Br.DidDocumentPublicKeyIdDuplicated,`DID Document key with ID '${n.id}' already exists.`);r.add(n.id),Si.validatePublicKeyPurposes(n.purposes)}}static validateServices(e){if(e!==void 0&&e.length!==0){const r=new Set;for(const n of e){if(Kn.validateService(n),r.has(n.id))throw new Fr(Br.DidDocumentServiceIdDuplicated,"Service id has to be unique");r.add(n.id)}}}static validateService(e){Si.validateId(e.id);const r=30;if(e.type.length>r){const n=`Service endpoint type length ${e.type.length} exceeds max allowed length of ${r}.`;throw new Fr(Br.ServiceTypeTooLong,n)}if(Array.isArray(e.serviceEndpoint)){const n="Service endpoint value cannot be an array.";throw new Fr(Br.ServiceEndpointCannotBeAnArray,n)}if(typeof e.serviceEndpoint=="string"&&JC.parse(e.serviceEndpoint).error!==void 0)throw new Fr(Br.ServiceEndpointStringNotValidUri,`Service endpoint string '${e.serviceEndpoint}' is not a URI.`)}static validateDeltaSize(e){const r=mc.canonicalizeAsBytes(e);if(r.length>Oi.maxCanonicalizedDeltaSizeInBytes){const n=`Delta of ${r.length} bytes exceeded limit of ${Oi.maxCanonicalizedDeltaSizeInBytes} bytes.`;throw new Fr(Br.DeltaExceedsMaximumSize,n)}}}var WS=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};class ty{static createLongFormDid(e){return WS(this,void 0,void 0,function*(){const r=yield Kn.createCreateRequest(e),n=yield ty.computeDidUniqueSuffix(r.suffixData);let s;Oi.network===void 0||Oi.network==="mainnet"?s=`did:ion:${n}`:s=`did:ion:${Oi.network}:${n}`;const i={suffixData:r.suffixData,delta:r.delta},o=mc.canonicalizeAsBytes(i),a=ef.encode(o);return`${s}:${a}`})}static computeDidUniqueSuffix(e){return WS(this,void 0,void 0,function*(){const r=mc.canonicalizeAsBytes(e),n=yield sn.hash(r,Oi.hashAlgorithmInMultihashCode);return ef.encode(n)})}}var JS;(function(t){t.Mainnet="mainnet",t.Testnet="test"})(JS||(JS={}));var GS;(function(t){t.Authentication="authentication",t.AssertionMethod="assertionMethod",t.CapabilityInvocation="capabilityInvocation",t.CapabilityDelegation="capabilityDelegation",t.KeyAgreement="keyAgreement"})(GS||(GS={}));var Ju=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},$o;(function(t){t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.secp256r1="secp256r1",t.X25519="X25519"})($o||($o={}));const eU={Ed25519:$o.Ed25519,ES256K:$o.secp256k1,ES256:$o.secp256r1,"P-256":$o.secp256r1,secp256k1:$o.secp256k1,secp256r1:$o.secp256r1},ZS="https://ion.tbd.engineering";let tU=class jp extends ey{static create(){return Ju(this,arguments,void 0,function*({keyManager:e=new Wa,options:r={}}={}){var n,s,i,o,a,c,l;if(!((n=r.verificationMethods)===null||n===void 0)&&n.some(_=>!(_.algorithm in eU)))throw new Error("One or more verification method algorithms are not supported");const u=(s=r.verificationMethods)===null||s===void 0?void 0:s.filter(_=>"id"in _).map(_=>_.id);if(u&&u.length!==new Set(u).size)throw new Error("One or more verification method IDs are not unique");if(!((i=r.services)===null||i===void 0)&&i.some(_=>!_.id||!_.type||!_.serviceEndpoint))throw new Error("One or more services are missing required properties");const d={algorithm:"Ed25519",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]},h=[];for(const _ of(o=r.verificationMethods)!==null&&o!==void 0?o:[d]){const x=yield e.generateKey({algorithm:_.algorithm}),D=yield e.getPublicKey({keyUri:x});h.push({id:_.id,publicKeyJwk:D,purposes:(a=_.purposes)!==null&&a!==void 0?a:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]})}const f=yield e.generateKey({algorithm:$o.secp256k1}),p=yield e.getPublicKey({keyUri:f}),y=yield e.generateKey({algorithm:$o.secp256k1}),b=yield e.getPublicKey({keyUri:y}),w=yield Qf.computeLongFormDidUri({recoveryKey:p,updateKey:b,services:(c=r.services)!==null&&c!==void 0?c:[],verificationMethods:h}),{didDocument:g,didResolutionMetadata:v}=yield jp.resolve(w,{gatewayUri:r.gatewayUri});if(g===null)throw new Error(`Unable to resolve DID during creation: ${v==null?void 0:v.error}`);const m=new yc({uri:w,document:g,metadata:{published:!1,canonicalId:w.split(":",3).join(":"),recoveryKey:p,updateKey:b},keyManager:e});if(!((l=r.publish)!==null&&l!==void 0)||l){const _=yield jp.publish({did:m,gatewayUri:r.gatewayUri});m.metadata=_.didDocumentMetadata}return m})}static getSigningMethod(e){return Ju(this,arguments,void 0,function*({didDocument:r,methodId:n}){var s;const i=Wt.parse(r.id);if(i&&i.method!==this.methodName)throw new rt(Je.MethodNotSupported,`Method not supported: ${i.method}`);const o=(s=r.verificationMethod)===null||s===void 0?void 0:s.find(a=>{var c;return a.id===(n??((c=r.assertionMethod)===null||c===void 0?void 0:c[0]))});if(!(o&&o.publicKeyJwk))throw new rt(Je.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static import(e){return Ju(this,arguments,void 0,function*({portableDid:r,keyManager:n=new Wa}){const s=Wt.parse(r.uri);if((s==null?void 0:s.method)!==jp.methodName)throw new rt(Je.MethodNotSupported,"Method not supported");return yield yc.import({portableDid:r,keyManager:n})})}static publish(e){return Ju(this,arguments,void 0,function*({did:r,gatewayUri:n=ZS}){var s,i,o;const a=(i=(s=r.document.verificationMethod)===null||s===void 0?void 0:s.map(u=>({id:u.id,publicKeyJwk:u.publicKeyJwk,purposes:LM({didDocument:r.document,methodId:u.id})})))!==null&&i!==void 0?i:[],c=yield Qf.createIonDocument({services:(o=r.document.service)!==null&&o!==void 0?o:[],verificationMethods:a}),l=yield Qf.constructCreateRequest({ionDocument:c,recoveryKey:r.metadata.recoveryKey,updateKey:r.metadata.updateKey});try{const u=Qf.appendPathToUrl({baseUrl:n,path:"/operations"}),d=yield fetch(u,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});return{didDocument:r.document,didDocumentMetadata:Object.assign(Object.assign({},r.metadata),{published:d.ok}),didRegistrationMetadata:{}}}catch{return{didDocument:null,didDocumentMetadata:{published:!1},didRegistrationMetadata:{error:Je.InternalError,errorMessage:`Failed to publish DID document for: ${r.uri}`}}}})}static resolve(e){return Ju(this,arguments,void 0,function*(r,n={}){var s,i;const o=Wt.parse(r);if(!o)return Object.assign(Object.assign({},In),{didResolutionMetadata:{error:"invalidDid"}});if(o.method!==jp.methodName)return Object.assign(Object.assign({},In),{didResolutionMetadata:{error:"methodNotSupported"}});const a=(s=n==null?void 0:n.gatewayUri)!==null&&s!==void 0?s:ZS;try{const c=Qf.appendPathToUrl({baseUrl:a,path:`/identifiers/${r}`}),l=yield fetch(c);if(!l.ok)throw new rt(Je.NotFound,`Unable to find DID document for: ${r}`);const{didDocument:u,didDocumentMetadata:d}=yield l.json();return Object.assign(Object.assign(Object.assign({},In),u&&{didDocument:u}),{didDocumentMetadata:Object.assign({published:(i=d==null?void 0:d.method)===null||i===void 0?void 0:i.published},d)})}catch(c){if(!(c instanceof rt))throw new Error(c);return Object.assign(Object.assign({},In),{didResolutionMetadata:Object.assign({error:c.code},c.message&&{errorMessage:c.message})})}})}};tU.methodName="ion";let Qf=class nl{static appendPathToUrl({baseUrl:e,path:r}){const n=new URL(e);return n.pathname=n.pathname.endsWith("/")?n.pathname:n.pathname+"/",n.pathname+=r.startsWith("/")?r.substring(1):r,n.toString()}static computeLongFormDidUri(e){return Ju(this,arguments,void 0,function*({recoveryKey:r,updateKey:n,services:s,verificationMethods:i}){const o=yield nl.createIonDocument({services:s,verificationMethods:i}),a=nl.normalizeJwk(r),c=nl.normalizeJwk(n);return yield ty.createLongFormDid({document:o,recoveryKey:a,updateKey:c})})}static constructCreateRequest(e){return Ju(this,arguments,void 0,function*({ionDocument:r,recoveryKey:n,updateKey:s}){return yield Kn.createCreateRequest({document:r,recoveryKey:nl.normalizeJwk(n),updateKey:nl.normalizeJwk(s)})})}static createIonDocument(e){return Ju(this,arguments,void 0,function*({services:r,verificationMethods:n}){var s,i;const o=[];for(const l of n){let u=(i=(s=l.id)!==null&&s!==void 0?s:l.publicKeyJwk.kid)!==null&&i!==void 0?i:yield tr({jwk:l.publicKeyJwk});u=`${u.split("#").pop()}`;const d={id:u,publicKeyJwk:nl.normalizeJwk(l.publicKeyJwk),purposes:l.purposes,type:"JsonWebKey2020"};o.push(d)}const a=r.map(l=>Object.assign(Object.assign({},l),{id:`${l.id.split("#").pop()}`}));return{publicKeys:o,services:a}})}static normalizeJwk(e){const r=e.kty;let n;if(r==="EC")n={crv:e.crv,kty:e.kty,x:e.x,y:e.y};else if(r==="oct")n={k:e.k,kty:e.kty};else if(r==="OKP")n={crv:e.crv,kty:e.kty,x:e.x};else if(r==="RSA")n={e:e.e,kty:e.kty,n:e.n};else throw new Error(`Unsupported key type: ${r}`);return n}};var Jy=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let YC=class Mp extends ey{static create(){return Jy(this,arguments,void 0,function*({keyManager:e=new Wa,options:r={}}={}){var n,s,i,o;if(r.algorithm&&r.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(r.verificationMethods&&r.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");const a=(o=(n=r.algorithm)!==null&&n!==void 0?n:(i=(s=r.verificationMethods)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.algorithm)!==null&&o!==void 0?o:"Ed25519",c=yield e.generateKey({algorithm:a}),l=yield e.getPublicKey({keyUri:c}),u=at.object(l).toBase64Url(),d=`did:${Mp.methodName}:${u}`,f=(yield Mp.resolve(d)).didDocument;return new yc({uri:d,document:f,metadata:{},keyManager:e})})}static getSigningMethod(e){return Jy(this,arguments,void 0,function*({didDocument:r}){var n;const s=Wt.parse(r.id);if(s&&s.method!==this.methodName)throw new rt(Je.MethodNotSupported,`Method not supported: ${s.method}`);const[i]=(n=r.verificationMethod)!==null&&n!==void 0?n:[];if(!(i&&i.publicKeyJwk))throw new rt(Je.InternalError,"A verification method intended for signing could not be determined from the DID Document");return i})}static import(e){return Jy(this,arguments,void 0,function*({portableDid:r,keyManager:n=new Wa}){const s=Wt.parse(r.uri);if((s==null?void 0:s.method)!==Mp.methodName)throw new rt(Je.MethodNotSupported,"Method not supported");const i=yield yc.import({portableDid:r,keyManager:n});if(i.document.verificationMethod.length!==1)throw new rt(Je.InvalidDidDocument,"DID document must contain exactly one verification method");return i})}static resolve(e,r){return Jy(this,void 0,void 0,function*(){const n=Wt.parse(e);let s;try{s=at.base64Url(n.id).toObject()}catch{}if(!n||!s)return Object.assign(Object.assign({},In),{didResolutionMetadata:{error:"invalidDid"}});if(n.method!==Mp.methodName)return Object.assign(Object.assign({},In),{didResolutionMetadata:{error:"methodNotSupported"}});const i={"@context":["https://www.w3.org/ns/did/v1"],id:n.uri},o=`${i.id}#0`;switch(i.verificationMethod=[{id:o,type:"JsonWebKey",controller:i.id,publicKeyJwk:s}],i.authentication=[o],i.assertionMethod=[o],i.capabilityInvocation=[o],i.capabilityDelegation=[o],i.keyAgreement=[o],s.use){case"sig":{delete i.keyAgreement;break}case"enc":{delete i.authentication,delete i.assertionMethod,delete i.capabilityInvocation,delete i.capabilityDelegation;break}}return Object.assign(Object.assign({},In),{didDocument:i})})}};YC.methodName="jwk";var Ns=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},Sa;(function(t){t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.secp256r1="secp256r1",t.X25519="X25519"})(Sa||(Sa={}));const Gv={Ed25519VerificationKey2020:"https://w3id.org/security/suites/ed25519-2020/v1",JsonWebKey2020:"https://w3id.org/security/suites/jws-2020/v1",X25519KeyAgreementKey2020:"https://w3id.org/security/suites/x25519-2020/v1"},rU={Ed25519:Sa.Ed25519,ES256K:Sa.secp256k1,ES256:Sa.secp256r1,"P-256":Sa.secp256r1,secp256k1:Sa.secp256k1,secp256r1:Sa.secp256r1,X25519:Sa.X25519};let nU=class Ea extends ey{static create(){return Ns(this,arguments,void 0,function*({keyManager:e=new Wa,options:r={}}={}){var n,s,i,o;if(r.algorithm&&r.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(r.verificationMethods&&r.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");const a=(o=(n=r.algorithm)!==null&&n!==void 0?n:(i=(s=r.verificationMethods)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.algorithm)!==null&&o!==void 0?o:"Ed25519",c=yield e.generateKey({algorithm:a}),l=yield e.getPublicKey({keyUri:c}),u=yield ns.publicKeyToMultibaseId({publicKey:l}),d=`did:${Ea.methodName}:${u}`,f=(yield Ea.resolve(d,r)).didDocument;return new yc({uri:d,document:f,metadata:{},keyManager:e})})}static getSigningMethod(e){return Ns(this,arguments,void 0,function*({didDocument:r}){var n;const s=Wt.parse(r.id);if(s&&s.method!==this.methodName)throw new rt(Je.MethodNotSupported,`Method not supported: ${s.method}`);const[i]=r.assertionMethod||[],o=(n=r.verificationMethod)===null||n===void 0?void 0:n.find(a=>a.id===i);if(!(o&&o.publicKeyJwk))throw new rt(Je.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static import(e){return Ns(this,arguments,void 0,function*({portableDid:r,keyManager:n=new Wa}){const s=Wt.parse(r.uri);if((s==null?void 0:s.method)!==Ea.methodName)throw new rt(Je.MethodNotSupported,"Method not supported");const i=yield yc.import({portableDid:r,keyManager:n});if(i.document.verificationMethod.length!==1)throw new rt(Je.InvalidDidDocument,"DID document must contain exactly one verification method");return i})}static resolve(e,r){return Ns(this,void 0,void 0,function*(){try{const n=yield Ea.createDocument({didUri:e,options:r});return Object.assign(Object.assign({},In),{didDocument:n})}catch(n){if(!(n instanceof rt))throw new Error(n);return Object.assign(Object.assign({},In),{didResolutionMetadata:Object.assign({error:n.code},n.message&&{errorMessage:n.message})})}})}static createDocument(e){return Ns(this,arguments,void 0,function*({didUri:r,options:n={}}){const{defaultContext:s="https://www.w3.org/ns/did/v1",enableEncryptionKeyDerivation:i=!1,enableExperimentalPublicKeyTypes:o=!1,publicKeyFormat:a="JsonWebKey2020"}=n,c={id:""},l=Wt.parse(r);if(!l)throw new rt(Je.InvalidDid,`Invalid DID URI: ${r}`);const u=l.id;if(l.method!==Ea.methodName)throw new rt(Je.MethodNotSupported,`Method not supported: ${l.method}`);if(!Ea.validateIdentifier(l))throw new rt(Je.InvalidDid,`Invalid DID URI: ${r}`);const d=yield Ea.createSignatureMethod({didUri:r,multibaseValue:u,options:{enableExperimentalPublicKeyTypes:o,publicKeyFormat:a}});if(c.id=l.uri,c.verificationMethod=[d],c.authentication=[d.id],c.assertionMethod=[d.id],c.capabilityInvocation=[d.id],c.capabilityDelegation=[d.id],i===!0){const p=a==="Ed25519VerificationKey2020"?"X25519KeyAgreementKey2020":"JsonWebKey2020",y=yield this.createEncryptionMethod({didUri:r,multibaseValue:u,options:{enableExperimentalPublicKeyTypes:o,publicKeyFormat:p}});c.verificationMethod.push(y),c.keyAgreement=[y.id]}const h=[s];return KM({didDocument:c}).forEach(p=>{const y=Gv[p];h.push(y)}),c["@context"]=h,c})}static createEncryptionMethod(e){return Ns(this,arguments,void 0,function*({didUri:r,multibaseValue:n,options:s}){const{enableExperimentalPublicKeyTypes:i,publicKeyFormat:o}=s,a={id:"",type:"",controller:""},{keyBytes:c,multicodecCode:l}=yield Ea.deriveEncryptionKey({multibaseValue:n}),u=c.byteLength,d=ns.MULTICODEC_PUBLIC_KEY_LENGTH[l];if(u!==d)throw new rt(Je.InvalidPublicKeyLength,`Expected ${u} bytes. Actual: ${d}`);const h=OC({keyBytes:c,multicodecCode:l});a.id=`${r}#${h}`;try{new URL(a.id)}catch{throw new rt(Je.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(o in Gv))throw new rt(Je.UnsupportedPublicKeyType,`Unsupported format: ${o}`);if(i===!1&&!["Multikey","JsonWebKey2020","X25519KeyAgreementKey2020"].includes(o))throw new rt(Je.InvalidPublicKeyType,`Specified '${o}' without setting enableExperimentalPublicKeyTypes to true.`);if(a.type=o,a.controller=r,o==="X25519KeyAgreementKey2020"&&(a.publicKeyMultibase=h),o==="JsonWebKey2020"){const{crv:p}=yield ns.multicodecToJwk({code:l});a.publicKeyJwk=yield ns.keyConverter(p).bytesToPublicKey({publicKeyBytes:c})}return a})}static createSignatureMethod(e){return Ns(this,arguments,void 0,function*({didUri:r,multibaseValue:n,options:s}){const{enableExperimentalPublicKeyTypes:i,publicKeyFormat:o}=s,a={id:"",type:"",controller:""},{keyBytes:c,multicodecCode:l,multicodecName:u}=$S({multibaseKeyId:n}),d=c.byteLength,h=ns.MULTICODEC_PUBLIC_KEY_LENGTH[l];if(d!==h)throw new rt(Je.InvalidPublicKeyLength,`Expected ${d} bytes. Actual: ${h}`);let f=!1;switch(u){case"secp256k1-pub":f=yield Ti.validatePublicKey({publicKeyBytes:c});break;case"ed25519-pub":f=yield yi.validatePublicKey({publicKeyBytes:c});break;case"x25519-pub":f=!0;break}if(!f)throw new rt(Je.InvalidPublicKey,"Invalid public key detected.");a.id=`${r}#${n}`;try{new URL(a.id)}catch{throw new rt(Je.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(o in Gv))throw new rt(Je.UnsupportedPublicKeyType,`Unsupported format: ${o}`);if(i===!1&&!["Multikey","JsonWebKey2020","Ed25519VerificationKey2020"].includes(o))throw new rt(Je.InvalidPublicKeyType,`Specified '${o}' without setting enableExperimentalPublicKeyTypes to true.`);if(a.type=o,a.controller=r,o==="Ed25519VerificationKey2020"&&(a.publicKeyMultibase=n),o==="JsonWebKey2020"){const{crv:y}=yield ns.multicodecToJwk({code:l});a.publicKeyJwk=yield ns.keyConverter(y).bytesToPublicKey({publicKeyBytes:c})}return a})}static deriveEncryptionKey(e){return Ns(this,arguments,void 0,function*({multibaseValue:r}){let n={keyBytes:new Uint8Array,multicodecCode:0};const{keyBytes:s,multicodecCode:i}=$S({multibaseKeyId:r});if(i===237){const o=yield ns.keyConverter("Ed25519").bytesToPublicKey({publicKeyBytes:s}),a=yield yi.convertPublicKeyToX25519({publicKey:o});n={keyBytes:yield ns.keyConverter("Ed25519").publicKeyToBytes({publicKey:a}),multicodecCode:236}}return n})}static validateIdentifier(e){const{method:r,id:n}=e,[s]=e.uri.split(":",1);return s==="did"&&r==="key"&&Number("1")>0&&Eb(n)==="String"&&n.startsWith("z")}};nU.methodName="key";let ns=class Dd{static jwkToMulticodec(e){return Ns(this,arguments,void 0,function*({jwk:r}){const n=[];r.crv&&(n.push(r.crv),r.d?n.push("private"):n.push("public"));const s=n.join(":"),i=Dd.JWK_TO_MULTICODEC[s];if(i===void 0)throw new Error(`Unsupported JWK to Multicodec conversion: '${s}'`);return{code:vs.getCodeFromName({name:i}),name:i}})}static keyCompressor(e){const n={"P-256":fs.compressPublicKey,secp256k1:Ti.compressPublicKey}[e];if(!n)throw new rt(Je.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static keyConverter(e){const n={Ed25519:yi,"P-256":fs,secp256k1:Ti,X25519:CC}[e];if(!n)throw new rt(Je.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static multicodecToJwk(e){return Ns(this,arguments,void 0,function*({code:r,name:n}){if(!(n?!r:r))throw new Error("Either 'name' or 'code' must be defined, but not both.");n=n===void 0?vs.getNameFromCode({code:r}):n;const s=n,i=Dd.MULTICODEC_TO_JWK[s];if(i===void 0)throw new Error("Unsupported Multicodec to JWK conversion");return Object.assign({},i)})}static publicKeyToMultibaseId(e){return Ns(this,arguments,void 0,function*({publicKey:r}){var n;if(!(r!=null&&r.crv&&r.crv in rU))throw new rt(Je.InvalidPublicKeyType,`Public key contains an unsupported key type: ${(n=r==null?void 0:r.crv)!==null&&n!==void 0?n:"undefined"}`);let s=yield Dd.keyConverter(r.crv).publicKeyToBytes({publicKey:r});/^(secp256k1|P-256|P-384|P-521)$/.test(r.crv)&&(s=yield Dd.keyCompressor(r.crv)({publicKeyBytes:s}));const{name:i}=yield Dd.jwkToMulticodec({jwk:r});return OC({keyBytes:s,multicodecName:i})})}};ns.JWK_TO_MULTICODEC={"Ed25519:public":"ed25519-pub","Ed25519:private":"ed25519-priv","secp256k1:public":"secp256k1-pub","secp256k1:private":"secp256k1-priv","X25519:public":"x25519-pub","X25519:private":"x25519-priv"};ns.MULTICODEC_PUBLIC_KEY_LENGTH={231:33,236:32,237:32};ns.MULTICODEC_TO_JWK={"ed25519-pub":{crv:"Ed25519",kty:"OKP",x:""},"ed25519-priv":{crv:"Ed25519",kty:"OKP",x:"",d:""},"secp256k1-pub":{crv:"secp256k1",kty:"EC",x:"",y:""},"secp256k1-priv":{crv:"secp256k1",kty:"EC",x:"",y:"",d:""},"x25519-pub":{crv:"X25519",kty:"OKP",x:""},"x25519-priv":{crv:"X25519",kty:"OKP",x:"",d:""}};var iU=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let QC=class ek extends ey{static resolve(e,r){return iU(this,void 0,void 0,function*(){const n=Wt.parse(e);if(!n)return Object.assign(Object.assign({},In),{didResolutionMetadata:{error:"invalidDid"}});if(n.method!==ek.methodName)return Object.assign(Object.assign({},In),{didResolutionMetadata:{error:"methodNotSupported"}});let s=`https://${n.id.replace(/:/g,"/")}`;s=decodeURIComponent(s);const i=n.id.includes(":")?`${s}/did.json`:`${s}/.well-known/did.json`;try{const o=yield fetch(i);if(!o.ok)throw new Error("HTTP error status code returned");const a=yield o.json();return Object.assign(Object.assign({},In),{didDocument:a})}catch{return Object.assign(Object.assign({},In),{didResolutionMetadata:{error:"notFound"}})}})}};QC.methodName="web";var tf=1e3,rf=tf*60,nf=rf*60,zl=nf*24,sU=zl*7,oU=zl*365.25,aU=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return uU(t);if(r==="number"&&isFinite(t))return e.long?lU(t):cU(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function uU(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*oU;case"weeks":case"week":case"w":return r*sU;case"days":case"day":case"d":return r*zl;case"hours":case"hour":case"hrs":case"hr":case"h":return r*nf;case"minutes":case"minute":case"mins":case"min":case"m":return r*rf;case"seconds":case"second":case"secs":case"sec":case"s":return r*tf;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function cU(t){var e=Math.abs(t);return e>=zl?Math.round(t/zl)+"d":e>=nf?Math.round(t/nf)+"h":e>=rf?Math.round(t/rf)+"m":e>=tf?Math.round(t/tf)+"s":t+"ms"}function lU(t){var e=Math.abs(t);return e>=zl?Gy(t,e,zl,"day"):e>=nf?Gy(t,e,nf,"hour"):e>=rf?Gy(t,e,rf,"minute"):e>=tf?Gy(t,e,tf,"second"):t+" ms"}function Gy(t,e,r,n){var s=e>=r*1.5;return Math.round(t/r)+" "+n+(s?"s":"")}const dU=Jo(aU),fU={get:function(t){return null},set:function(t,e){return null},delete:function(t){return null},clear:function(){return null},close:function(){return null}};var XS=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let pU=class{constructor({cache:e,didResolvers:r}){this.didResolvers=new Map,this.cache=e||fU;for(const n of r)this.didResolvers.set(n.methodName,n)}resolve(e,r){return XS(this,void 0,void 0,function*(){const n=Wt.parse(e);if(!n)return Object.assign(Object.assign({},In),{didResolutionMetadata:{error:Je.InvalidDid,errorMessage:`Invalid DID URI: ${e}`}});const s=this.didResolvers.get(n.method);if(!s)return Object.assign(Object.assign({},In),{didResolutionMetadata:{error:Je.MethodNotSupported,errorMessage:`Method not supported: ${n.method}`}});const i=yield this.cache.get(n.uri);if(i)return i;{const o=yield s.resolve(n.uri,r);return o.didResolutionMetadata.error||(yield this.cache.set(n.uri,o)),o}})}dereference(e,r){return XS(this,void 0,void 0,function*(){const n=Wt.parse(e);if(!n)return{dereferencingMetadata:{error:Je.InvalidDidUrl},contentStream:null,contentMetadata:{}};const{didDocument:s,didResolutionMetadata:i,didDocumentMetadata:o}=yield this.resolve(n.uri);if(!s)return{dereferencingMetadata:{error:i.error},contentStream:null,contentMetadata:{}};if(!n.fragment||n.query)return{dereferencingMetadata:{contentType:"application/did+json"},contentStream:s,contentMetadata:o};const{service:a=[],verificationMethod:c=[]}=s,l=new Set([e,n.fragment,`#${n.fragment}`]);let u;for(let d of c)if(l.has(d.id)){u=d;break}for(let d of a)if(l.has(d.id)){u=d;break}return u?{dereferencingMetadata:{contentType:"application/did+json"},contentStream:u,contentMetadata:i}:{dereferencingMetadata:{error:Je.NotFound},contentStream:null,contentMetadata:{}}})}};const tk=new pU({didResolvers:[k0,YC,QC]});async function hU(t){const{didResolutionMetadata:e,didDocument:r}=await tk.resolve(t);if(e.error)throw new Error(`Failed to resolve DID: ${t}. Error: ${e.error}`);return r}function yU(t){return!!t&&"id"in t&&"type"in t&&"controller"in t}const mU=new Uj;class Tl{static digest(e){const r=GC(e),n=Bs.string(r).toUint8Array();return pc(n)}static async sign(e){const{did:r,payload:n,detached:s}=e,i=await r.getSigner();let o=i.keyId;o.startsWith("#")&&(o=`${r.uri}${o}`);const a={alg:i.algorithm,kid:o},c=Bs.object(a).toBase64Url(),l=Bs.uint8Array(n).toBase64Url(),u=`${c}.${l}`,d=Bs.string(u).toUint8Array(),h=await i.sign({data:d}),f=Bs.uint8Array(h).toBase64Url();return s?`${c}..${f}`:`${c}.${l}.${f}`}static async verify(e){const{signature:r,detachedPayload:n}=e;if(!r)throw new Error("Signature verification failed: Expected signature property to exist");const s=r.split(".");if(s.length!==3)throw new Error("Signature verification failed: Expected valid JWS with detached content");let[i,o,a]=s;if(n){if(o.length!==0)throw new Error("Signature verification failed: Expected valid JWS with detached content");o=Bs.uint8Array(n).toBase64Url()}const c=Bs.base64Url(i).toObject();if(!c.alg||!c.kid)throw new Error("Signature verification failed: Expected JWS header to contain alg and kid");const u=(await tk.dereference(c.kid)).contentStream;if(!yU(u))throw new Error("Signature verification failed: Expected kid in JWS header to dereference to a DID Document Verification Method");const d=u.publicKeyJwk;if(!d)throw new Error("Signature verification failed: Expected kid in JWS header to dereference to a DID Document Verification Method with publicKeyJwk");const h=`${i}.${o}`,f=Bs.string(h).toUint8Array(),p=Bs.base64Url(a).toUint8Array();if(!await mU.verify({key:d,data:f,signature:p}))throw new Error("Signature verification failed: Integrity mismatch");const[b]=c.kid.split("#");return b}}var ry={},Ig=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,s,i;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(s=n;s--!==0;)if(!t(e[s],r[s]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(i=Object.keys(e),n=i.length,n!==Object.keys(r).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(r,i[s]))return!1;for(s=n;s--!==0;){var o=i[s];if(!t(e[o],r[o]))return!1}return!0}return e!==e&&r!==r};Object.defineProperty(ry,"__esModule",{value:!0});const rk=Ig;rk.code='require("ajv/dist/runtime/equal").default';var YS=ry.default=rk;const gU=Pd;function Pd(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){for(const c in t)if(!(c==="reason"||c==="success"))return Pd.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:c},message:"must NOT have additional properties"}],!1;{if(t.reason!==void 0){const c=o;if(typeof t.reason!="string")return Pd.errors=[{instancePath:e+"/reason",schemaPath:"#/properties/reason/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=c===o}else var a=!0;if(a)if(t.success!==void 0){const c=o;if(typeof t.success!="boolean")return Pd.errors=[{instancePath:e+"/success",schemaPath:"#/properties/success/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var a=c===o}else var a=!0}}else return Pd.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Pd.errors=i,o===0}const vU=Fb;function Fb(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;return t&&typeof t=="object"&&!Array.isArray(t)?(Fb.errors=i,o===0):(Fb.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1)}const wU=tt,bU={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://tbdex.dev/offering.schema.json",type:"object",properties:{additionalProperties:!1,description:{type:"string",description:"Brief description of what is being offered."},payin:{type:"object",additionalProperties:!1,properties:{currencyCode:{type:"string",description:"ISO 3166 currency code string"},min:{$ref:"definitions.json#/definitions/decimalString",description:"Minimum amount of currency that can be requested"},max:{$ref:"definitions.json#/definitions/decimalString",description:"Maximum amount of currency that can be requested"},methods:{type:"array",items:{type:"object",additionalProperties:!1,properties:{kind:{type:"string",description:"The type of payment method. e.g. BITCOIN_ADDRESS, DEBIT_CARD, etc."},name:{type:"string",description:"Payment Method name. Expected to be rendered on screen."},description:{type:"string",description:'Blurb containing helpful information about the payment method. Expected to be rendered on screen. e.g. "segwit addresses only"'},group:{type:"string",description:"Value that can be used to group specific payment methods together (e.g. Mobile Money vs. Direct Bank Deposit)."},requiredPaymentDetails:{$ref:"http://json-schema.org/draft-07/schema",description:"A JSON Schema containing the fields that need to be collected in order to use this payment method"},min:{$ref:"definitions.json#/definitions/decimalString",description:"Minimum amount required to use this payment method."},max:{$ref:"definitions.json#/definitions/decimalString",description:"Maximum amount allowed when using this payment method."},fee:{$ref:"definitions.json#/definitions/decimalString",description:"Fee charged to use this payment method. Absence of this field implies that there is no _additional_ fee associated to the respective payment method."}},required:["kind"]}}},required:["currencyCode","methods"]},payout:{type:"object",additionalProperties:!1,properties:{currencyCode:{type:"string",description:"ISO 3166 currency code string"},min:{$ref:"definitions.json#/definitions/decimalString",description:"Minimum amount of currency that can be requested"},max:{$ref:"definitions.json#/definitions/decimalString",description:"Maximum amount of currency that can be requested"},methods:{type:"array",items:{type:"object",additionalProperties:!1,properties:{kind:{type:"string",description:"The type of payment method. e.g. BITCOIN_ADDRESS, DEBIT_CARD, etc."},name:{type:"string",description:"Payment Method name. Expected to be rendered on screen."},description:{type:"string",description:'Blurb containing helpful information about the payment method. Expected to be rendered on screen. e.g. "segwit addresses only"'},group:{type:"string",description:"Value that can be used to group specific payment methods together (e.g. Mobile Money vs. Direct Bank Deposit)."},requiredPaymentDetails:{$ref:"http://json-schema.org/draft-07/schema",description:"A JSON Schema containing the fields that need to be collected in order to use this payment method"},min:{$ref:"definitions.json#/definitions/decimalString",description:"Minimum amount required to use this payment method."},max:{$ref:"definitions.json#/definitions/decimalString",description:"Maximum amount allowed when using this payment method."},fee:{$ref:"definitions.json#/definitions/decimalString",description:"Fee charged to use this payment method. absence of this field implies that there is no _additional_ fee associated to the respective payment method"},estimatedSettlementTime:{type:"number",description:"Estimated time in seconds for the payout to be settled. e.g. 3600 for 1 hour. 0 for instant settlement.",minimum:0}},required:["kind","estimatedSettlementTime"]}}},required:["currencyCode","methods"]},payoutUnitsPerPayinUnit:{type:"string",description:"Number of payout currency units for one payin currency unit (i.e 290000 USD for 1 BTC)"},requiredClaims:{type:"object",description:"PresentationDefinition that describes the credential(s) the PFI requires in order to provide a quote."}},required:["description","payin","payout","payoutUnitsPerPayinUnit"]},fi=new RegExp("^([0-9]+(?:[.][0-9]+)?)$","u"),_U={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0},QS={enum:["array","boolean","integer","null","number","object","string"]};function is(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;return typeof t=="number"&&!(t%1)&&!isNaN(t)&&isFinite(t)?typeof t=="number"&&isFinite(t)&&(t<0||isNaN(t))?(is.errors=[{instancePath:e,schemaPath:"#/definitions/nonNegativeInteger/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1):(is.errors=i,o===0):(is.errors=[{instancePath:e,schemaPath:"#/definitions/nonNegativeInteger/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1)}const Zv={validate:De};function Hn(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(o===0)if(Array.isArray(t)){if(t.length<1)return Hn.errors=[{instancePath:e,schemaPath:"#/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{var a=!0;const c=t.length;for(let l=0;l<c;l++){const u=o;Zv.validate(t[l],{instancePath:e+"/"+l,parentData:t,parentDataProperty:l,rootData:s})||(i=i===null?Zv.validate.errors:i.concat(Zv.validate.errors),o=i.length);var a=u===o;if(!a)break}}}else return Hn.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;return Hn.errors=i,o===0}function De(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(!(t&&typeof t=="object"&&!Array.isArray(t))&&typeof t!="boolean")return De.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:_U.type},message:"must be object,boolean"}],!1;if(o===0&&t&&typeof t=="object"&&!Array.isArray(t)){if(t.$id!==void 0){const v=o;if(o===v&&o===v&&typeof t.$id!="string")return De.errors=[{instancePath:e+"/$id",schemaPath:"#/properties/%24id/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=v===o}else var a=!0;if(a){if(t.$schema!==void 0){const v=o;if(o===v&&o===v&&typeof t.$schema!="string")return De.errors=[{instancePath:e+"/$schema",schemaPath:"#/properties/%24schema/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=v===o}else var a=!0;if(a){if(t.$ref!==void 0){const v=o;if(o===v&&o===v&&typeof t.$ref!="string")return De.errors=[{instancePath:e+"/$ref",schemaPath:"#/properties/%24ref/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=v===o}else var a=!0;if(a){if(t.$comment!==void 0){const v=o;if(typeof t.$comment!="string")return De.errors=[{instancePath:e+"/$comment",schemaPath:"#/properties/%24comment/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=v===o}else var a=!0;if(a){if(t.title!==void 0){const v=o;if(typeof t.title!="string")return De.errors=[{instancePath:e+"/title",schemaPath:"#/properties/title/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=v===o}else var a=!0;if(a){if(t.description!==void 0){const v=o;if(typeof t.description!="string")return De.errors=[{instancePath:e+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=v===o}else var a=!0;if(a){if(t.readOnly!==void 0){const v=o;if(typeof t.readOnly!="boolean")return De.errors=[{instancePath:e+"/readOnly",schemaPath:"#/properties/readOnly/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var a=v===o}else var a=!0;if(a){if(t.examples!==void 0){const v=o;if(o===v&&!Array.isArray(t.examples))return De.errors=[{instancePath:e+"/examples",schemaPath:"#/properties/examples/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var a=v===o}else var a=!0;if(a){if(t.multipleOf!==void 0){let v=t.multipleOf;const m=o;if(o===m)if(typeof v=="number"&&isFinite(v)){if(v<=0||isNaN(v))return De.errors=[{instancePath:e+"/multipleOf",schemaPath:"#/properties/multipleOf/exclusiveMinimum",keyword:"exclusiveMinimum",params:{comparison:">",limit:0},message:"must be > 0"}],!1}else return De.errors=[{instancePath:e+"/multipleOf",schemaPath:"#/properties/multipleOf/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var a=m===o}else var a=!0;if(a){if(t.maximum!==void 0){let v=t.maximum;const m=o;if(!(typeof v=="number"&&isFinite(v)))return De.errors=[{instancePath:e+"/maximum",schemaPath:"#/properties/maximum/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var a=m===o}else var a=!0;if(a){if(t.exclusiveMaximum!==void 0){let v=t.exclusiveMaximum;const m=o;if(!(typeof v=="number"&&isFinite(v)))return De.errors=[{instancePath:e+"/exclusiveMaximum",schemaPath:"#/properties/exclusiveMaximum/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var a=m===o}else var a=!0;if(a){if(t.minimum!==void 0){let v=t.minimum;const m=o;if(!(typeof v=="number"&&isFinite(v)))return De.errors=[{instancePath:e+"/minimum",schemaPath:"#/properties/minimum/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var a=m===o}else var a=!0;if(a){if(t.exclusiveMinimum!==void 0){let v=t.exclusiveMinimum;const m=o;if(!(typeof v=="number"&&isFinite(v)))return De.errors=[{instancePath:e+"/exclusiveMinimum",schemaPath:"#/properties/exclusiveMinimum/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var a=m===o}else var a=!0;if(a){if(t.maxLength!==void 0){let v=t.maxLength;const m=o,_=o;if(!(typeof v=="number"&&!(v%1)&&!isNaN(v)&&isFinite(v)))return De.errors=[{instancePath:e+"/maxLength",schemaPath:"#/definitions/nonNegativeInteger/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;if(o===_&&typeof v=="number"&&isFinite(v)&&(v<0||isNaN(v)))return De.errors=[{instancePath:e+"/maxLength",schemaPath:"#/definitions/nonNegativeInteger/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1;var a=m===o}else var a=!0;if(a){if(t.minLength!==void 0){const v=o;is(t.minLength,{instancePath:e+"/minLength",parentData:t,parentDataProperty:"minLength",rootData:s})||(i=i===null?is.errors:i.concat(is.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.pattern!==void 0){const v=o;if(o===v&&o===v&&typeof t.pattern!="string")return De.errors=[{instancePath:e+"/pattern",schemaPath:"#/properties/pattern/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=v===o}else var a=!0;if(a){if(t.additionalItems!==void 0){const v=o;De(t.additionalItems,{instancePath:e+"/additionalItems",parentData:t,parentDataProperty:"additionalItems",rootData:s})||(i=i===null?De.errors:i.concat(De.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.items!==void 0){let v=t.items;const m=o,_=o;let x=!1;const D=o;De(v,{instancePath:e+"/items",parentData:t,parentDataProperty:"items",rootData:s})||(i=i===null?De.errors:i.concat(De.errors),o=i.length);var c=D===o;if(x=x||c,!x){const A=o;Hn(v,{instancePath:e+"/items",parentData:t,parentDataProperty:"items",rootData:s})||(i=i===null?Hn.errors:i.concat(Hn.errors),o=i.length);var c=A===o;x=x||c}if(x)o=_,i!==null&&(_?i.length=_:i=null);else{const A={instancePath:e+"/items",schemaPath:"#/properties/items/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return i===null?i=[A]:i.push(A),o++,De.errors=i,!1}var a=m===o}else var a=!0;if(a){if(t.maxItems!==void 0){let v=t.maxItems;const m=o,_=o;if(!(typeof v=="number"&&!(v%1)&&!isNaN(v)&&isFinite(v)))return De.errors=[{instancePath:e+"/maxItems",schemaPath:"#/definitions/nonNegativeInteger/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;if(o===_&&typeof v=="number"&&isFinite(v)&&(v<0||isNaN(v)))return De.errors=[{instancePath:e+"/maxItems",schemaPath:"#/definitions/nonNegativeInteger/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1;var a=m===o}else var a=!0;if(a){if(t.minItems!==void 0){const v=o;is(t.minItems,{instancePath:e+"/minItems",parentData:t,parentDataProperty:"minItems",rootData:s})||(i=i===null?is.errors:i.concat(is.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.uniqueItems!==void 0){const v=o;if(typeof t.uniqueItems!="boolean")return De.errors=[{instancePath:e+"/uniqueItems",schemaPath:"#/properties/uniqueItems/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var a=v===o}else var a=!0;if(a){if(t.contains!==void 0){const v=o;De(t.contains,{instancePath:e+"/contains",parentData:t,parentDataProperty:"contains",rootData:s})||(i=i===null?De.errors:i.concat(De.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.maxProperties!==void 0){let v=t.maxProperties;const m=o,_=o;if(!(typeof v=="number"&&!(v%1)&&!isNaN(v)&&isFinite(v)))return De.errors=[{instancePath:e+"/maxProperties",schemaPath:"#/definitions/nonNegativeInteger/type",keyword:"type",params:{type:"integer"},message:"must be integer"}],!1;if(o===_&&typeof v=="number"&&isFinite(v)&&(v<0||isNaN(v)))return De.errors=[{instancePath:e+"/maxProperties",schemaPath:"#/definitions/nonNegativeInteger/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1;var a=m===o}else var a=!0;if(a){if(t.minProperties!==void 0){const v=o;is(t.minProperties,{instancePath:e+"/minProperties",parentData:t,parentDataProperty:"minProperties",rootData:s})||(i=i===null?is.errors:i.concat(is.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.required!==void 0){let v=t.required;const m=o;if(o===o)if(Array.isArray(v)){var l=!0;const D=v.length;for(let E=0;E<D;E++){const A=o;if(typeof v[E]!="string")return De.errors=[{instancePath:e+"/required/"+E,schemaPath:"#/definitions/stringArray/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var l=A===o;if(!l)break}if(l){let E=v.length,A;if(E>1){const S={};for(;E--;){let O=v[E];if(typeof O=="string"){if(typeof S[O]=="number")return A=S[O],De.errors=[{instancePath:e+"/required",schemaPath:"#/definitions/stringArray/uniqueItems",keyword:"uniqueItems",params:{i:E,j:A},message:"must NOT have duplicate items (items ## "+A+" and "+E+" are identical)"}],!1;S[O]=E}}}}}else return De.errors=[{instancePath:e+"/required",schemaPath:"#/definitions/stringArray/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var a=m===o}else var a=!0;if(a){if(t.additionalProperties!==void 0){const v=o;De(t.additionalProperties,{instancePath:e+"/additionalProperties",parentData:t,parentDataProperty:"additionalProperties",rootData:s})||(i=i===null?De.errors:i.concat(De.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.definitions!==void 0){let v=t.definitions;const m=o;if(o===m)if(v&&typeof v=="object"&&!Array.isArray(v))for(const x in v){const D=o;De(v[x],{instancePath:e+"/definitions/"+x.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:v,parentDataProperty:x,rootData:s})||(i=i===null?De.errors:i.concat(De.errors),o=i.length);var u=D===o;if(!u)break}else return De.errors=[{instancePath:e+"/definitions",schemaPath:"#/properties/definitions/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=m===o}else var a=!0;if(a){if(t.properties!==void 0){let v=t.properties;const m=o;if(o===m)if(v&&typeof v=="object"&&!Array.isArray(v))for(const x in v){const D=o;De(v[x],{instancePath:e+"/properties/"+x.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:v,parentDataProperty:x,rootData:s})||(i=i===null?De.errors:i.concat(De.errors),o=i.length);var d=D===o;if(!d)break}else return De.errors=[{instancePath:e+"/properties",schemaPath:"#/properties/properties/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=m===o}else var a=!0;if(a){if(t.patternProperties!==void 0){let v=t.patternProperties;const m=o;if(o===m)if(v&&typeof v=="object"&&!Array.isArray(v)){for(const x in v){var h=o===o;if(!h){const E={instancePath:e+"/patternProperties",schemaPath:"#/properties/patternProperties/propertyNames",keyword:"propertyNames",params:{propertyName:x},message:"property name must be valid"};return i===null?i=[E]:i.push(E),o++,De.errors=i,!1}}if(h)for(const x in v){const D=o;De(v[x],{instancePath:e+"/patternProperties/"+x.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:v,parentDataProperty:x,rootData:s})||(i=i===null?De.errors:i.concat(De.errors),o=i.length);var f=D===o;if(!f)break}}else return De.errors=[{instancePath:e+"/patternProperties",schemaPath:"#/properties/patternProperties/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=m===o}else var a=!0;if(a){if(t.dependencies!==void 0){let v=t.dependencies;const m=o;if(o===m)if(v&&typeof v=="object"&&!Array.isArray(v))for(const x in v){let D=v[x];const E=o,A=o;let S=!1;const O=o;De(D,{instancePath:e+"/dependencies/"+x.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:v,parentDataProperty:x,rootData:s})||(i=i===null?De.errors:i.concat(De.errors),o=i.length);var p=O===o;if(S=S||p,!S){const I=o;if(o===o)if(Array.isArray(D)){var y=!0;const F=D.length;for(let V=0;V<F;V++){const ee=o;if(typeof D[V]!="string"){const Z={instancePath:e+"/dependencies/"+x.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+V,schemaPath:"#/definitions/stringArray/items/type",keyword:"type",params:{type:"string"},message:"must be string"};i===null?i=[Z]:i.push(Z),o++}var y=ee===o;if(!y)break}if(y){let V=D.length,ee;if(V>1){const G={};for(;V--;){let Z=D[V];if(typeof Z=="string"){if(typeof G[Z]=="number"){ee=G[Z];const M={instancePath:e+"/dependencies/"+x.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/stringArray/uniqueItems",keyword:"uniqueItems",params:{i:V,j:ee},message:"must NOT have duplicate items (items ## "+ee+" and "+V+" are identical)"};i===null?i=[M]:i.push(M),o++;break}G[Z]=V}}}}}else{const F={instancePath:e+"/dependencies/"+x.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/definitions/stringArray/type",keyword:"type",params:{type:"array"},message:"must be array"};i===null?i=[F]:i.push(F),o++}var p=I===o;S=S||p}if(S)o=A,i!==null&&(A?i.length=A:i=null);else{const I={instancePath:e+"/dependencies/"+x.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/dependencies/additionalProperties/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return i===null?i=[I]:i.push(I),o++,De.errors=i,!1}var b=E===o;if(!b)break}else return De.errors=[{instancePath:e+"/dependencies",schemaPath:"#/properties/dependencies/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=m===o}else var a=!0;if(a){if(t.propertyNames!==void 0){const v=o;De(t.propertyNames,{instancePath:e+"/propertyNames",parentData:t,parentDataProperty:"propertyNames",rootData:s})||(i=i===null?De.errors:i.concat(De.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.enum!==void 0){let v=t.enum;const m=o;if(o===m)if(Array.isArray(v)){if(v.length<1)return De.errors=[{instancePath:e+"/enum",schemaPath:"#/properties/enum/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{let x=v.length,D;if(x>1){for(;x--;)for(D=x;D--;)if(YS(v[x],v[D]))return De.errors=[{instancePath:e+"/enum",schemaPath:"#/properties/enum/uniqueItems",keyword:"uniqueItems",params:{i:x,j:D},message:"must NOT have duplicate items (items ## "+D+" and "+x+" are identical)"}],!1}}}else return De.errors=[{instancePath:e+"/enum",schemaPath:"#/properties/enum/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var a=m===o}else var a=!0;if(a){if(t.type!==void 0){let v=t.type;const m=o,_=o;let x=!1;const D=o;if(!(v==="array"||v==="boolean"||v==="integer"||v==="null"||v==="number"||v==="object"||v==="string")){const A={instancePath:e+"/type",schemaPath:"#/definitions/simpleTypes/enum",keyword:"enum",params:{allowedValues:QS.enum},message:"must be equal to one of the allowed values"};i===null?i=[A]:i.push(A),o++}var w=D===o;if(x=x||w,!x){const A=o;if(o===A)if(Array.isArray(v))if(v.length<1){const O={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf/1/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"};i===null?i=[O]:i.push(O),o++}else{var g=!0;const O=v.length;for(let I=0;I<O;I++){let N=v[I];const j=o;if(!(N==="array"||N==="boolean"||N==="integer"||N==="null"||N==="number"||N==="object"||N==="string")){const V={instancePath:e+"/type/"+I,schemaPath:"#/definitions/simpleTypes/enum",keyword:"enum",params:{allowedValues:QS.enum},message:"must be equal to one of the allowed values"};i===null?i=[V]:i.push(V),o++}var g=j===o;if(!g)break}if(g){let I=v.length,N;if(I>1){e:for(;I--;)for(N=I;N--;)if(YS(v[I],v[N])){const j={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf/1/uniqueItems",keyword:"uniqueItems",params:{i:I,j:N},message:"must NOT have duplicate items (items ## "+N+" and "+I+" are identical)"};i===null?i=[j]:i.push(j),o++;break e}}}}else{const O={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf/1/type",keyword:"type",params:{type:"array"},message:"must be array"};i===null?i=[O]:i.push(O),o++}var w=A===o;x=x||w}if(x)o=_,i!==null&&(_?i.length=_:i=null);else{const A={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return i===null?i=[A]:i.push(A),o++,De.errors=i,!1}var a=m===o}else var a=!0;if(a){if(t.format!==void 0){const v=o;if(typeof t.format!="string")return De.errors=[{instancePath:e+"/format",schemaPath:"#/properties/format/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=v===o}else var a=!0;if(a){if(t.contentMediaType!==void 0){const v=o;if(typeof t.contentMediaType!="string")return De.errors=[{instancePath:e+"/contentMediaType",schemaPath:"#/properties/contentMediaType/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=v===o}else var a=!0;if(a){if(t.contentEncoding!==void 0){const v=o;if(typeof t.contentEncoding!="string")return De.errors=[{instancePath:e+"/contentEncoding",schemaPath:"#/properties/contentEncoding/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=v===o}else var a=!0;if(a){if(t.if!==void 0){const v=o;De(t.if,{instancePath:e+"/if",parentData:t,parentDataProperty:"if",rootData:s})||(i=i===null?De.errors:i.concat(De.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.then!==void 0){const v=o;De(t.then,{instancePath:e+"/then",parentData:t,parentDataProperty:"then",rootData:s})||(i=i===null?De.errors:i.concat(De.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.else!==void 0){const v=o;De(t.else,{instancePath:e+"/else",parentData:t,parentDataProperty:"else",rootData:s})||(i=i===null?De.errors:i.concat(De.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.allOf!==void 0){const v=o;Hn(t.allOf,{instancePath:e+"/allOf",parentData:t,parentDataProperty:"allOf",rootData:s})||(i=i===null?Hn.errors:i.concat(Hn.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.anyOf!==void 0){const v=o;Hn(t.anyOf,{instancePath:e+"/anyOf",parentData:t,parentDataProperty:"anyOf",rootData:s})||(i=i===null?Hn.errors:i.concat(Hn.errors),o=i.length);var a=v===o}else var a=!0;if(a){if(t.oneOf!==void 0){const v=o;Hn(t.oneOf,{instancePath:e+"/oneOf",parentData:t,parentDataProperty:"oneOf",rootData:s})||(i=i===null?Hn.errors:i.concat(Hn.errors),o=i.length);var a=v===o}else var a=!0;if(a)if(t.not!==void 0){const v=o;De(t.not,{instancePath:e+"/not",parentData:t,parentDataProperty:"not",rootData:s})||(i=i===null?De.errors:i.concat(De.errors),o=i.length);var a=v===o}else var a=!0}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}return De.errors=i,o===0}const EU=Object.prototype.hasOwnProperty;function tt(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(o===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let p;if(t.description===void 0&&(p="description")||t.payin===void 0&&(p="payin")||t.payout===void 0&&(p="payout")||t.payoutUnitsPerPayinUnit===void 0&&(p="payoutUnitsPerPayinUnit"))return tt.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:p},message:"must have required property '"+p+"'"}],!1;if(t.additionalProperties!==void 0){var a=!1;return tt.errors=[{instancePath:e+"/additionalProperties",schemaPath:"#/properties/additionalProperties/false schema",keyword:"false schema",params:{},message:"boolean schema is false"}],!1}else var a=!0;if(a){if(t.description!==void 0){const y=o;if(typeof t.description!="string")return tt.errors=[{instancePath:e+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=y===o}else var a=!0;if(a){if(t.payin!==void 0){let y=t.payin;const b=o;if(o===b)if(y&&typeof y=="object"&&!Array.isArray(y)){let g;if(y.currencyCode===void 0&&(g="currencyCode")||y.methods===void 0&&(g="methods"))return tt.errors=[{instancePath:e+"/payin",schemaPath:"#/properties/payin/required",keyword:"required",params:{missingProperty:g},message:"must have required property '"+g+"'"}],!1;{const v=o;for(const m in y)if(!(m==="currencyCode"||m==="min"||m==="max"||m==="methods"))return tt.errors=[{instancePath:e+"/payin",schemaPath:"#/properties/payin/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:m},message:"must NOT have additional properties"}],!1;if(v===o){if(y.currencyCode!==void 0){const m=o;if(typeof y.currencyCode!="string")return tt.errors=[{instancePath:e+"/payin/currencyCode",schemaPath:"#/properties/payin/properties/currencyCode/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=m===o}else var c=!0;if(c){if(y.min!==void 0){let m=y.min;const _=o;if(o===o)if(typeof m=="string"){if(!fi.test(m))return tt.errors=[{instancePath:e+"/payin/min",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return tt.errors=[{instancePath:e+"/payin/min",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=_===o}else var c=!0;if(c){if(y.max!==void 0){let m=y.max;const _=o;if(o===o)if(typeof m=="string"){if(!fi.test(m))return tt.errors=[{instancePath:e+"/payin/max",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return tt.errors=[{instancePath:e+"/payin/max",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=_===o}else var c=!0;if(c)if(y.methods!==void 0){let m=y.methods;const _=o;if(o===_)if(Array.isArray(m)){var l=!0;const D=m.length;for(let E=0;E<D;E++){let A=m[E];const S=o;if(o===S)if(A&&typeof A=="object"&&!Array.isArray(A)){let I;if(A.kind===void 0&&(I="kind"))return tt.errors=[{instancePath:e+"/payin/methods/"+E,schemaPath:"#/properties/payin/properties/methods/items/required",keyword:"required",params:{missingProperty:I},message:"must have required property '"+I+"'"}],!1;{const N=o;for(const j in A)if(!(j==="kind"||j==="name"||j==="description"||j==="group"||j==="requiredPaymentDetails"||j==="min"||j==="max"||j==="fee"))return tt.errors=[{instancePath:e+"/payin/methods/"+E,schemaPath:"#/properties/payin/properties/methods/items/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:j},message:"must NOT have additional properties"}],!1;if(N===o){if(A.kind!==void 0){const j=o;if(typeof A.kind!="string")return tt.errors=[{instancePath:e+"/payin/methods/"+E+"/kind",schemaPath:"#/properties/payin/properties/methods/items/properties/kind/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=j===o}else var u=!0;if(u){if(A.name!==void 0){const j=o;if(typeof A.name!="string")return tt.errors=[{instancePath:e+"/payin/methods/"+E+"/name",schemaPath:"#/properties/payin/properties/methods/items/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=j===o}else var u=!0;if(u){if(A.description!==void 0){const j=o;if(typeof A.description!="string")return tt.errors=[{instancePath:e+"/payin/methods/"+E+"/description",schemaPath:"#/properties/payin/properties/methods/items/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=j===o}else var u=!0;if(u){if(A.group!==void 0){const j=o;if(typeof A.group!="string")return tt.errors=[{instancePath:e+"/payin/methods/"+E+"/group",schemaPath:"#/properties/payin/properties/methods/items/properties/group/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=j===o}else var u=!0;if(u){if(A.requiredPaymentDetails!==void 0){const j=o;De(A.requiredPaymentDetails,{instancePath:e+"/payin/methods/"+E+"/requiredPaymentDetails",parentData:A,parentDataProperty:"requiredPaymentDetails",rootData:s})||(i=i===null?De.errors:i.concat(De.errors),o=i.length);var u=j===o}else var u=!0;if(u){if(A.min!==void 0){let j=A.min;const F=o;if(o===o)if(typeof j=="string"){if(!fi.test(j))return tt.errors=[{instancePath:e+"/payin/methods/"+E+"/min",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return tt.errors=[{instancePath:e+"/payin/methods/"+E+"/min",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=F===o}else var u=!0;if(u){if(A.max!==void 0){let j=A.max;const F=o;if(o===o)if(typeof j=="string"){if(!fi.test(j))return tt.errors=[{instancePath:e+"/payin/methods/"+E+"/max",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return tt.errors=[{instancePath:e+"/payin/methods/"+E+"/max",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=F===o}else var u=!0;if(u)if(A.fee!==void 0){let j=A.fee;const F=o;if(o===o)if(typeof j=="string"){if(!fi.test(j))return tt.errors=[{instancePath:e+"/payin/methods/"+E+"/fee",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return tt.errors=[{instancePath:e+"/payin/methods/"+E+"/fee",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=F===o}else var u=!0}}}}}}}}}else return tt.errors=[{instancePath:e+"/payin/methods/"+E,schemaPath:"#/properties/payin/properties/methods/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var l=S===o;if(!l)break}}else return tt.errors=[{instancePath:e+"/payin/methods",schemaPath:"#/properties/payin/properties/methods/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var c=_===o}else var c=!0}}}}}else return tt.errors=[{instancePath:e+"/payin",schemaPath:"#/properties/payin/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=b===o}else var a=!0;if(a){if(t.payout!==void 0){let y=t.payout;const b=o;if(o===b)if(y&&typeof y=="object"&&!Array.isArray(y)){let g;if(y.currencyCode===void 0&&(g="currencyCode")||y.methods===void 0&&(g="methods"))return tt.errors=[{instancePath:e+"/payout",schemaPath:"#/properties/payout/required",keyword:"required",params:{missingProperty:g},message:"must have required property '"+g+"'"}],!1;{const v=o;for(const m in y)if(!(m==="currencyCode"||m==="min"||m==="max"||m==="methods"))return tt.errors=[{instancePath:e+"/payout",schemaPath:"#/properties/payout/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:m},message:"must NOT have additional properties"}],!1;if(v===o){if(y.currencyCode!==void 0){const m=o;if(typeof y.currencyCode!="string")return tt.errors=[{instancePath:e+"/payout/currencyCode",schemaPath:"#/properties/payout/properties/currencyCode/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var d=m===o}else var d=!0;if(d){if(y.min!==void 0){let m=y.min;const _=o;if(o===o)if(typeof m=="string"){if(!fi.test(m))return tt.errors=[{instancePath:e+"/payout/min",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return tt.errors=[{instancePath:e+"/payout/min",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var d=_===o}else var d=!0;if(d){if(y.max!==void 0){let m=y.max;const _=o;if(o===o)if(typeof m=="string"){if(!fi.test(m))return tt.errors=[{instancePath:e+"/payout/max",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return tt.errors=[{instancePath:e+"/payout/max",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var d=_===o}else var d=!0;if(d)if(y.methods!==void 0){let m=y.methods;const _=o;if(o===_)if(Array.isArray(m)){var h=!0;const D=m.length;for(let E=0;E<D;E++){let A=m[E];const S=o;if(o===S)if(A&&typeof A=="object"&&!Array.isArray(A)){let I;if(A.kind===void 0&&(I="kind")||A.estimatedSettlementTime===void 0&&(I="estimatedSettlementTime"))return tt.errors=[{instancePath:e+"/payout/methods/"+E,schemaPath:"#/properties/payout/properties/methods/items/required",keyword:"required",params:{missingProperty:I},message:"must have required property '"+I+"'"}],!1;{const N=o;for(const j in A)if(!EU.call(bU.properties.payout.properties.methods.items.properties,j))return tt.errors=[{instancePath:e+"/payout/methods/"+E,schemaPath:"#/properties/payout/properties/methods/items/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:j},message:"must NOT have additional properties"}],!1;if(N===o){if(A.kind!==void 0){const j=o;if(typeof A.kind!="string")return tt.errors=[{instancePath:e+"/payout/methods/"+E+"/kind",schemaPath:"#/properties/payout/properties/methods/items/properties/kind/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var f=j===o}else var f=!0;if(f){if(A.name!==void 0){const j=o;if(typeof A.name!="string")return tt.errors=[{instancePath:e+"/payout/methods/"+E+"/name",schemaPath:"#/properties/payout/properties/methods/items/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var f=j===o}else var f=!0;if(f){if(A.description!==void 0){const j=o;if(typeof A.description!="string")return tt.errors=[{instancePath:e+"/payout/methods/"+E+"/description",schemaPath:"#/properties/payout/properties/methods/items/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var f=j===o}else var f=!0;if(f){if(A.group!==void 0){const j=o;if(typeof A.group!="string")return tt.errors=[{instancePath:e+"/payout/methods/"+E+"/group",schemaPath:"#/properties/payout/properties/methods/items/properties/group/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var f=j===o}else var f=!0;if(f){if(A.requiredPaymentDetails!==void 0){const j=o;De(A.requiredPaymentDetails,{instancePath:e+"/payout/methods/"+E+"/requiredPaymentDetails",parentData:A,parentDataProperty:"requiredPaymentDetails",rootData:s})||(i=i===null?De.errors:i.concat(De.errors),o=i.length);var f=j===o}else var f=!0;if(f){if(A.min!==void 0){let j=A.min;const F=o;if(o===o)if(typeof j=="string"){if(!fi.test(j))return tt.errors=[{instancePath:e+"/payout/methods/"+E+"/min",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return tt.errors=[{instancePath:e+"/payout/methods/"+E+"/min",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var f=F===o}else var f=!0;if(f){if(A.max!==void 0){let j=A.max;const F=o;if(o===o)if(typeof j=="string"){if(!fi.test(j))return tt.errors=[{instancePath:e+"/payout/methods/"+E+"/max",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return tt.errors=[{instancePath:e+"/payout/methods/"+E+"/max",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var f=F===o}else var f=!0;if(f){if(A.fee!==void 0){let j=A.fee;const F=o;if(o===o)if(typeof j=="string"){if(!fi.test(j))return tt.errors=[{instancePath:e+"/payout/methods/"+E+"/fee",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return tt.errors=[{instancePath:e+"/payout/methods/"+E+"/fee",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var f=F===o}else var f=!0;if(f)if(A.estimatedSettlementTime!==void 0){let j=A.estimatedSettlementTime;const F=o;if(o===F)if(typeof j=="number"&&isFinite(j)){if(j<0||isNaN(j))return tt.errors=[{instancePath:e+"/payout/methods/"+E+"/estimatedSettlementTime",schemaPath:"#/properties/payout/properties/methods/items/properties/estimatedSettlementTime/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1}else return tt.errors=[{instancePath:e+"/payout/methods/"+E+"/estimatedSettlementTime",schemaPath:"#/properties/payout/properties/methods/items/properties/estimatedSettlementTime/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var f=F===o}else var f=!0}}}}}}}}}}else return tt.errors=[{instancePath:e+"/payout/methods/"+E,schemaPath:"#/properties/payout/properties/methods/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var h=S===o;if(!h)break}}else return tt.errors=[{instancePath:e+"/payout/methods",schemaPath:"#/properties/payout/properties/methods/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var d=_===o}else var d=!0}}}}}else return tt.errors=[{instancePath:e+"/payout",schemaPath:"#/properties/payout/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=b===o}else var a=!0;if(a){if(t.payoutUnitsPerPayinUnit!==void 0){const y=o;if(typeof t.payoutUnitsPerPayinUnit!="string")return tt.errors=[{instancePath:e+"/payoutUnitsPerPayinUnit",schemaPath:"#/properties/payoutUnitsPerPayinUnit/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=y===o}else var a=!0;if(a)if(t.requiredClaims!==void 0){let y=t.requiredClaims;const b=o;if(!(y&&typeof y=="object"&&!Array.isArray(y)))return tt.errors=[{instancePath:e+"/requiredClaims",schemaPath:"#/properties/requiredClaims/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=b===o}else var a=!0}}}}}else return tt.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return tt.errors=i,o===0}const AU=Nu;function Nu(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){let c;if(t.currencyCode===void 0&&(c="currencyCode")||t.available===void 0&&(c="available"))return Nu.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:c},message:"must have required property '"+c+"'"}],!1;if(t.additionalProperties!==void 0){var a=!1;return Nu.errors=[{instancePath:e+"/additionalProperties",schemaPath:"#/properties/additionalProperties/false schema",keyword:"false schema",params:{},message:"boolean schema is false"}],!1}else var a=!0;if(a){if(t.currencyCode!==void 0){const l=o;if(typeof t.currencyCode!="string")return Nu.errors=[{instancePath:e+"/currencyCode",schemaPath:"#/properties/currencyCode/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=l===o}else var a=!0;if(a)if(t.available!==void 0){let l=t.available;const u=o;if(typeof l=="string"){if(!fi.test(l))return Nu.errors=[{instancePath:e+"/available",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return Nu.errors=[{instancePath:e+"/available",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=u===o}else var a=!0}}else return Nu.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Nu.errors=i,o===0}const SU=Ru,$U={type:"object",additionalProperties:!1,properties:{from:{$ref:"definitions.json#/definitions/did",description:"The sender's DID"},to:{$ref:"definitions.json#/definitions/did",description:"The recipient's DID"},kind:{type:"string",enum:["rfq","quote","order","orderstatus","close"],description:"The message kind (e.g. rfq, quote)"},id:{type:"string",description:"The message ID"},exchangeId:{type:"string",description:"ID for a 'thread' of messages between Alice <-> PFI. Set by the first message in a thread"},externalId:{type:"string",description:"Arbitrary ID for the caller to associate with the message."},createdAt:{type:"string",description:"ISO8601 formatted string representing the timestamp"},protocol:{type:"string",description:"Version of the protocol in use (x.x format)"}},required:["from","to","kind","id","exchangeId","createdAt","protocol"]},Nb=new RegExp("^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$","u");function nn(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){let c;if(t.from===void 0&&(c="from")||t.to===void 0&&(c="to")||t.kind===void 0&&(c="kind")||t.id===void 0&&(c="id")||t.exchangeId===void 0&&(c="exchangeId")||t.createdAt===void 0&&(c="createdAt")||t.protocol===void 0&&(c="protocol"))return nn.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:c},message:"must have required property '"+c+"'"}],!1;for(const l in t)if(!(l==="from"||l==="to"||l==="kind"||l==="id"||l==="exchangeId"||l==="externalId"||l==="createdAt"||l==="protocol"))return nn.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:l},message:"must NOT have additional properties"}],!1;{if(t.from!==void 0){let l=t.from;const u=o;if(typeof l=="string"){if(!Nb.test(l))return nn.errors=[{instancePath:e+"/from",schemaPath:"definitions.json#/definitions/did/pattern",keyword:"pattern",params:{pattern:"^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"},message:'must match pattern "^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"'}],!1}else return nn.errors=[{instancePath:e+"/from",schemaPath:"definitions.json#/definitions/did/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=u===o}else var a=!0;if(a){if(t.to!==void 0){let l=t.to;const u=o;if(typeof l=="string"){if(!Nb.test(l))return nn.errors=[{instancePath:e+"/to",schemaPath:"definitions.json#/definitions/did/pattern",keyword:"pattern",params:{pattern:"^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"},message:'must match pattern "^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"'}],!1}else return nn.errors=[{instancePath:e+"/to",schemaPath:"definitions.json#/definitions/did/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=u===o}else var a=!0;if(a){if(t.kind!==void 0){let l=t.kind;const u=o;if(typeof l!="string")return nn.errors=[{instancePath:e+"/kind",schemaPath:"#/properties/kind/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(l==="rfq"||l==="quote"||l==="order"||l==="orderstatus"||l==="close"))return nn.errors=[{instancePath:e+"/kind",schemaPath:"#/properties/kind/enum",keyword:"enum",params:{allowedValues:$U.properties.kind.enum},message:"must be equal to one of the allowed values"}],!1;var a=u===o}else var a=!0;if(a){if(t.id!==void 0){const l=o;if(typeof t.id!="string")return nn.errors=[{instancePath:e+"/id",schemaPath:"#/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=l===o}else var a=!0;if(a){if(t.exchangeId!==void 0){const l=o;if(typeof t.exchangeId!="string")return nn.errors=[{instancePath:e+"/exchangeId",schemaPath:"#/properties/exchangeId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=l===o}else var a=!0;if(a){if(t.externalId!==void 0){const l=o;if(typeof t.externalId!="string")return nn.errors=[{instancePath:e+"/externalId",schemaPath:"#/properties/externalId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=l===o}else var a=!0;if(a){if(t.createdAt!==void 0){const l=o;if(typeof t.createdAt!="string")return nn.errors=[{instancePath:e+"/createdAt",schemaPath:"#/properties/createdAt/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=l===o}else var a=!0;if(a)if(t.protocol!==void 0){const l=o;if(typeof t.protocol!="string")return nn.errors=[{instancePath:e+"/protocol",schemaPath:"#/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=l===o}else var a=!0}}}}}}}}else return nn.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return nn.errors=i,o===0}function Ru(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(o===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let c;if(t.metadata===void 0&&(c="metadata")||t.data===void 0&&(c="data")||t.signature===void 0&&(c="signature"))return Ru.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:c},message:"must have required property '"+c+"'"}],!1;{const l=o;for(const u in t)if(!(u==="metadata"||u==="data"||u==="signature"||u==="privateData"))return Ru.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:u},message:"must NOT have additional properties"}],!1;if(l===o){if(t.metadata!==void 0){const u=o;nn(t.metadata,{instancePath:e+"/metadata",parentData:t,parentDataProperty:"metadata",rootData:s})||(i=i===null?nn.errors:i.concat(nn.errors),o=i.length);var a=u===o}else var a=!0;if(a){if(t.data!==void 0){let u=t.data;const d=o;if(!(u&&typeof u=="object"&&!Array.isArray(u)))return Ru.errors=[{instancePath:e+"/data",schemaPath:"#/properties/data/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=d===o}else var a=!0;if(a){if(t.signature!==void 0){const u=o;if(typeof t.signature!="string")return Ru.errors=[{instancePath:e+"/signature",schemaPath:"#/properties/signature/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=u===o}else var a=!0;if(a)if(t.privateData!==void 0){let u=t.privateData;const d=o;if(!(u&&typeof u=="object"&&!Array.isArray(u)))return Ru.errors=[{instancePath:e+"/privateData",schemaPath:"#/properties/privateData/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=d===o}else var a=!0}}}}}else return Ru.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Ru.errors=i,o===0}const xU=Zm;function Zm(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t))for(const a in t)return Zm.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:a},message:"must NOT have additional properties"}],!1;else return Zm.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Zm.errors=i,o===0}const DU=Cd;function Cd(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){let a;if(t.orderStatus===void 0&&(a="orderStatus"))return Cd.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:a},message:"must have required property '"+a+"'"}],!1;for(const c in t)if(c!=="orderStatus")return Cd.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:c},message:"must NOT have additional properties"}],!1;if(t.orderStatus!==void 0&&typeof t.orderStatus!="string")return Cd.errors=[{instancePath:e+"/orderStatus",schemaPath:"#/properties/orderStatus/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1}else return Cd.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Cd.errors=i,o===0}const PU=kd;function Gr(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){let l;if(t.currencyCode===void 0&&(l="currencyCode")||t.amount===void 0&&(l="amount"))return Gr.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:l},message:"must have required property '"+l+"'"}],!1;for(const u in t)if(!(u==="currencyCode"||u==="amount"||u==="fee"||u==="paymentInstruction"))return Gr.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:u},message:"must NOT have additional properties"}],!1;{if(t.currencyCode!==void 0){const u=o;if(typeof t.currencyCode!="string")return Gr.errors=[{instancePath:e+"/currencyCode",schemaPath:"#/properties/currencyCode/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=u===o}else var a=!0;if(a){if(t.amount!==void 0){let u=t.amount;const d=o;if(typeof u=="string"){if(!fi.test(u))return Gr.errors=[{instancePath:e+"/amount",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return Gr.errors=[{instancePath:e+"/amount",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=d===o}else var a=!0;if(a){if(t.fee!==void 0){let u=t.fee;const d=o;if(typeof u=="string"){if(!fi.test(u))return Gr.errors=[{instancePath:e+"/fee",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return Gr.errors=[{instancePath:e+"/fee",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=d===o}else var a=!0;if(a)if(t.paymentInstruction!==void 0){let u=t.paymentInstruction;const d=o;if(u&&typeof u=="object"&&!Array.isArray(u)){for(const f in u)if(!(f==="link"||f==="instruction"))return Gr.errors=[{instancePath:e+"/paymentInstruction",schemaPath:"#/definitions/PaymentInstruction/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:f},message:"must NOT have additional properties"}],!1;{if(u.link!==void 0){const f=o;if(typeof u.link!="string")return Gr.errors=[{instancePath:e+"/paymentInstruction/link",schemaPath:"#/definitions/PaymentInstruction/properties/link/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=f===o}else var c=!0;if(c)if(u.instruction!==void 0){const f=o;if(typeof u.instruction!="string")return Gr.errors=[{instancePath:e+"/paymentInstruction/instruction",schemaPath:"#/definitions/PaymentInstruction/properties/instruction/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=f===o}else var c=!0}}else return Gr.errors=[{instancePath:e+"/paymentInstruction",schemaPath:"#/definitions/PaymentInstruction/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=d===o}else var a=!0}}}}else return Gr.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Gr.errors=i,o===0}function kd(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(o===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let c;if(t.expiresAt===void 0&&(c="expiresAt")||t.payin===void 0&&(c="payin")||t.payout===void 0&&(c="payout"))return kd.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:c},message:"must have required property '"+c+"'"}],!1;{const l=o;for(const u in t)if(!(u==="expiresAt"||u==="payin"||u==="payout"))return kd.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:u},message:"must NOT have additional properties"}],!1;if(l===o){if(t.expiresAt!==void 0){const u=o;if(typeof t.expiresAt!="string")return kd.errors=[{instancePath:e+"/expiresAt",schemaPath:"#/properties/expiresAt/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=u===o}else var a=!0;if(a){if(t.payin!==void 0){const u=o;Gr(t.payin,{instancePath:e+"/payin",parentData:t,parentDataProperty:"payin",rootData:s})||(i=i===null?Gr.errors:i.concat(Gr.errors),o=i.length);var a=u===o}else var a=!0;if(a)if(t.payout!==void 0){const u=o;Gr(t.payout,{instancePath:e+"/payout",parentData:t,parentDataProperty:"payout",rootData:s})||(i=i===null?Gr.errors:i.concat(Gr.errors),o=i.length);var a=u===o}else var a=!0}}}}else return kd.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return kd.errors=i,o===0}const CU=Sn,kU={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://tbdex.dev/resource.schema.json",type:"object",additionalProperties:!1,properties:{metadata:{type:"object",properties:{from:{$ref:"definitions.json#/definitions/did",description:"The PFI's DID"},kind:{type:"string",enum:["offering","balance"],description:"The resource kind (e.g. Offering)"},id:{type:"string",description:"The resource id"},createdAt:{type:"string",description:"When the resource was created at. Expressed as ISO8601"},updatedAt:{type:"string",description:"When the resource was last updated. Expressed as ISO8601"},protocol:{type:"string",description:"Version of the protocol in use (x.x format)"}},required:["from","kind","id","createdAt","protocol"],description:"The metadata object contains fields about the resource and is present for every tbdex resources of all types."},data:{description:"The actual resource content",type:"object"},signature:{type:"string",description:"Signature that verifies that authenticity and integrity of a message"}},required:["metadata","data","signature"],description:"ResourceModel"};function Sn(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){let l;if(t.metadata===void 0&&(l="metadata")||t.data===void 0&&(l="data")||t.signature===void 0&&(l="signature"))return Sn.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:l},message:"must have required property '"+l+"'"}],!1;for(const u in t)if(!(u==="metadata"||u==="data"||u==="signature"))return Sn.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:u},message:"must NOT have additional properties"}],!1;{if(t.metadata!==void 0){let u=t.metadata;const d=o;if(u&&typeof u=="object"&&!Array.isArray(u)){let h;if(u.from===void 0&&(h="from")||u.kind===void 0&&(h="kind")||u.id===void 0&&(h="id")||u.createdAt===void 0&&(h="createdAt")||u.protocol===void 0&&(h="protocol"))return Sn.errors=[{instancePath:e+"/metadata",schemaPath:"#/properties/metadata/required",keyword:"required",params:{missingProperty:h},message:"must have required property '"+h+"'"}],!1;if(u.from!==void 0){let f=u.from;const p=o;if(typeof f=="string"){if(!Nb.test(f))return Sn.errors=[{instancePath:e+"/metadata/from",schemaPath:"definitions.json#/definitions/did/pattern",keyword:"pattern",params:{pattern:"^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"},message:'must match pattern "^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"'}],!1}else return Sn.errors=[{instancePath:e+"/metadata/from",schemaPath:"definitions.json#/definitions/did/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=p===o}else var a=!0;if(a){if(u.kind!==void 0){let f=u.kind;const p=o;if(typeof f!="string")return Sn.errors=[{instancePath:e+"/metadata/kind",schemaPath:"#/properties/metadata/properties/kind/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(f==="offering"||f==="balance"))return Sn.errors=[{instancePath:e+"/metadata/kind",schemaPath:"#/properties/metadata/properties/kind/enum",keyword:"enum",params:{allowedValues:kU.properties.metadata.properties.kind.enum},message:"must be equal to one of the allowed values"}],!1;var a=p===o}else var a=!0;if(a){if(u.id!==void 0){const f=o;if(typeof u.id!="string")return Sn.errors=[{instancePath:e+"/metadata/id",schemaPath:"#/properties/metadata/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=f===o}else var a=!0;if(a){if(u.createdAt!==void 0){const f=o;if(typeof u.createdAt!="string")return Sn.errors=[{instancePath:e+"/metadata/createdAt",schemaPath:"#/properties/metadata/properties/createdAt/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=f===o}else var a=!0;if(a){if(u.updatedAt!==void 0){const f=o;if(typeof u.updatedAt!="string")return Sn.errors=[{instancePath:e+"/metadata/updatedAt",schemaPath:"#/properties/metadata/properties/updatedAt/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=f===o}else var a=!0;if(a)if(u.protocol!==void 0){const f=o;if(typeof u.protocol!="string")return Sn.errors=[{instancePath:e+"/metadata/protocol",schemaPath:"#/properties/metadata/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=f===o}else var a=!0}}}}}else return Sn.errors=[{instancePath:e+"/metadata",schemaPath:"#/properties/metadata/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var c=d===o}else var c=!0;if(c){if(t.data!==void 0){let u=t.data;const d=o;if(!(u&&typeof u=="object"&&!Array.isArray(u)))return Sn.errors=[{instancePath:e+"/data",schemaPath:"#/properties/data/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var c=d===o}else var c=!0;if(c)if(t.signature!==void 0){const u=o;if(typeof t.signature!="string")return Sn.errors=[{instancePath:e+"/signature",schemaPath:"#/properties/signature/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=u===o}else var c=!0}}}else return Sn.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Sn.errors=i,o===0}const OU=si;function si(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){let l;if(t.salt===void 0&&(l="salt"))return si.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:l},message:"must have required property '"+l+"'"}],!1;if(t.additionalProperties!==void 0){var a=!1;return si.errors=[{instancePath:e+"/additionalProperties",schemaPath:"#/properties/additionalProperties/false schema",keyword:"false schema",params:{},message:"boolean schema is false"}],!1}else var a=!0;if(a){if(t.salt!==void 0){const u=o;if(typeof t.salt!="string")return si.errors=[{instancePath:e+"/salt",schemaPath:"#/properties/salt/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=u===o}else var a=!0;if(a){if(t.claims!==void 0){let u=t.claims;const d=o;if(Array.isArray(u)){var c=!0;const f=u.length;for(let p=0;p<f;p++){const y=o;if(typeof u[p]!="string")return si.errors=[{instancePath:e+"/claims/"+p,schemaPath:"#/properties/claims/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=y===o;if(!c)break}}else return si.errors=[{instancePath:e+"/claims",schemaPath:"#/properties/claims/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var a=d===o}else var a=!0;if(a){if(t.payin!==void 0){let u=t.payin;const d=o;if(u&&typeof u=="object"&&!Array.isArray(u)){for(const f in u)if(f!=="paymentDetails")return si.errors=[{instancePath:e+"/payin",schemaPath:"#/properties/payin/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:f},message:"must NOT have additional properties"}],!1;if(u.paymentDetails!==void 0){let f=u.paymentDetails;if(!(f&&typeof f=="object"&&!Array.isArray(f)))return si.errors=[{instancePath:e+"/payin/paymentDetails",schemaPath:"#/properties/payin/properties/paymentDetails/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1}}else return si.errors=[{instancePath:e+"/payin",schemaPath:"#/properties/payin/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=d===o}else var a=!0;if(a)if(t.payout!==void 0){let u=t.payout;const d=o;if(u&&typeof u=="object"&&!Array.isArray(u)){for(const f in u)if(f!=="paymentDetails")return si.errors=[{instancePath:e+"/payout",schemaPath:"#/properties/payout/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:f},message:"must NOT have additional properties"}],!1;if(u.paymentDetails!==void 0){let f=u.paymentDetails;if(!(f&&typeof f=="object"&&!Array.isArray(f)))return si.errors=[{instancePath:e+"/payout/paymentDetails",schemaPath:"#/properties/payout/properties/paymentDetails/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1}}else return si.errors=[{instancePath:e+"/payout",schemaPath:"#/properties/payout/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=d===o}else var a=!0}}}}else return si.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return si.errors=i,o===0}const TU=$n;function $n(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){let u;if(t.offeringId===void 0&&(u="offeringId")||t.payin===void 0&&(u="payin")||t.payout===void 0&&(u="payout"))return $n.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:u},message:"must have required property '"+u+"'"}],!1;if(t.additionalProperties!==void 0){var a=!1;return $n.errors=[{instancePath:e+"/additionalProperties",schemaPath:"#/properties/additionalProperties/false schema",keyword:"false schema",params:{},message:"boolean schema is false"}],!1}else var a=!0;if(a){if(t.offeringId!==void 0){const d=o;if(typeof t.offeringId!="string")return $n.errors=[{instancePath:e+"/offeringId",schemaPath:"#/properties/offeringId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=d===o}else var a=!0;if(a){if(t.claimsHash!==void 0){const d=o;if(typeof t.claimsHash!="string")return $n.errors=[{instancePath:e+"/claimsHash",schemaPath:"#/properties/claimsHash/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var a=d===o}else var a=!0;if(a){if(t.payin!==void 0){let d=t.payin;const h=o;if(d&&typeof d=="object"&&!Array.isArray(d)){let p;if(d.amount===void 0&&(p="amount")||d.kind===void 0&&(p="kind"))return $n.errors=[{instancePath:e+"/payin",schemaPath:"#/properties/payin/required",keyword:"required",params:{missingProperty:p},message:"must have required property '"+p+"'"}],!1;if(d.amount!==void 0){let y=d.amount;const b=o;if(typeof y=="string"){if(!fi.test(y))return $n.errors=[{instancePath:e+"/payin/amount",schemaPath:"definitions.json#/definitions/decimalString/pattern",keyword:"pattern",params:{pattern:"^([0-9]+(?:[.][0-9]+)?)$"},message:'must match pattern "^([0-9]+(?:[.][0-9]+)?)$"'}],!1}else return $n.errors=[{instancePath:e+"/payin/amount",schemaPath:"definitions.json#/definitions/decimalString/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=b===o}else var c=!0;if(c){if(d.kind!==void 0){const y=o;if(typeof d.kind!="string")return $n.errors=[{instancePath:e+"/payin/kind",schemaPath:"#/properties/payin/properties/kind/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=y===o}else var c=!0;if(c)if(d.paymentDetailsHash!==void 0){const y=o;if(typeof d.paymentDetailsHash!="string")return $n.errors=[{instancePath:e+"/payin/paymentDetailsHash",schemaPath:"#/properties/payin/properties/paymentDetailsHash/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=y===o}else var c=!0}}else return $n.errors=[{instancePath:e+"/payin",schemaPath:"#/properties/payin/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=h===o}else var a=!0;if(a)if(t.payout!==void 0){let d=t.payout;const h=o;if(d&&typeof d=="object"&&!Array.isArray(d)){let p;if(d.kind===void 0&&(p="kind"))return $n.errors=[{instancePath:e+"/payout",schemaPath:"#/properties/payout/required",keyword:"required",params:{missingProperty:p},message:"must have required property '"+p+"'"}],!1;if(d.kind!==void 0){const y=o;if(typeof d.kind!="string")return $n.errors=[{instancePath:e+"/payout/kind",schemaPath:"#/properties/payout/properties/kind/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var l=y===o}else var l=!0;if(l)if(d.paymentDetailsHash!==void 0){const y=o;if(typeof d.paymentDetailsHash!="string")return $n.errors=[{instancePath:e+"/payout/paymentDetailsHash",schemaPath:"#/properties/payout/properties/paymentDetailsHash/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var l=y===o}else var l=!0}else return $n.errors=[{instancePath:e+"/payout",schemaPath:"#/properties/payout/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var a=h===o}else var a=!0}}}}else return $n.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return $n.errors=i,o===0}const IU=Object.freeze(Object.defineProperty({__proto__:null,balance:AU,close:gU,definitions:vU,message:SU,offering:wU,order:xU,orderstatus:DU,quote:PU,resource:CU,rfq:TU,rfqPrivate:OU},Symbol.toStringTag,{value:"Module"}));function Ah(t,e){let r=IU[e];if(!r)throw new Error(`no validator found for ${e}`);r(t),r.errors&&BU(r.errors)}function BU(t){const[e]=t;let{instancePath:r,message:n,params:s}=e;throw r||(r="message"),n=s.allowedValues?`${n} - ${s.allowedValues.join(", ")}`:n,new Error(`${r}: ${n}`)}class T0{constructor(e,r,n){de(this,"metadata");de(this,"data");de(this,"_signature");this.metadata=e,this.data=r,this._signature=n}static generateId(e){return O1(e).toString()}async sign(e){this._signature=await Tl.sign({did:e,payload:this.digest(),detached:!0})}async verify(){return this.validate(),this.verifySignature()}async verifySignature(){if(this.signature===void 0)throw new Error("Could not verify message signature because no signature is missing");const e=await Tl.verify({detachedPayload:this.digest(),signature:this.signature});if(this.metadata.from!==e)throw new Error("Signature verification failed: Expected DID in kid of JWS header to match metadata.from");return e}digest(){return Tl.digest({metadata:this.metadata,data:this.data})}validate(){Ah(this.toJSON(),"resource"),this.validateData()}validateData(){Ah(this.data,this.kind)}toJSON(){return{metadata:this.metadata,data:this.data,signature:this.signature}}get signature(){return this._signature}get id(){return this.metadata.id}get from(){return this.metadata.from}get createdAt(){return this.metadata.createdAt}get updatedAt(){return this.metadata.updatedAt}get protocol(){return this.metadata.protocol}isOffering(){return this.metadata.kind==="offering"}isBalance(){return this.metadata.kind==="balance"}}class qo{constructor(e,r,n){de(this,"metadata");de(this,"data");de(this,"_signature");this.metadata=e,this.data=r,this._signature=n}static generateId(e){return O1(e).toString()}async sign(e){this._signature=await Tl.sign({did:e,payload:this.digest(),detached:!0})}async verify(){return this.validate(),await this.verifySignature()}async verifySignature(){if(this.signature===void 0)throw new Error("Could not verify message signature because no signature is missing");const e=await Tl.verify({detachedPayload:this.digest(),signature:this.signature});if(this.metadata.from!==e)throw new Error("Signature verification failed: Expected DID in kid of JWS header to match metadata.from");return e}digest(){return Tl.digest({metadata:this.metadata,data:this.data})}validate(){Ah(this.toJSON(),"message"),this.validateData()}validateData(){Ah(this.data,this.kind)}get signature(){return this._signature}get id(){return this.metadata.id}get exchangeId(){return this.metadata.exchangeId}get from(){return this.metadata.from}get to(){return this.metadata.to}get createdAt(){return this.metadata.createdAt}get externalId(){return this.metadata.externalId}get protocol(){return this.metadata.protocol}isRfq(){return this.metadata.kind==="rfq"}isQuote(){return this.metadata.kind==="quote"}isOrder(){return this.metadata.kind==="order"}isOrderStatus(){return this.metadata.kind==="orderstatus"}isClose(){return this.metadata.kind==="close"}toJSON(){return{metadata:this.metadata,data:this.data,signature:this.signature}}}var FU=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,Xv=Math.ceil,Yi=Math.floor,ci="[BigNumber Error] ",e$=ci+"Number primitive has more than 15 significant digits: ",Ps=1e14,vt=14,Yv=9007199254740991,Qv=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],yu=1e7,tn=1e9;function nk(t){var e,r,n,s=g.prototype={constructor:g,toString:null,valueOf:null},i=new g(1),o=20,a=4,c=-7,l=21,u=-1e7,d=1e7,h=!1,f=1,p=0,y={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},b="0123456789abcdefghijklmnopqrstuvwxyz",w=!0;function g(E,A){var S,O,I,N,j,F,V,ee,G=this;if(!(G instanceof g))return new g(E,A);if(A==null){if(E&&E._isBigNumber===!0){G.s=E.s,!E.c||E.e>d?G.c=G.e=null:E.e<u?G.c=[G.e=0]:(G.e=E.e,G.c=E.c.slice());return}if((F=typeof E=="number")&&E*0==0){if(G.s=1/E<0?(E=-E,-1):1,E===~~E){for(N=0,j=E;j>=10;j/=10,N++);N>d?G.c=G.e=null:(G.e=N,G.c=[E]);return}ee=String(E)}else{if(!FU.test(ee=String(E)))return n(G,ee,F);G.s=ee.charCodeAt(0)==45?(ee=ee.slice(1),-1):1}(N=ee.indexOf("."))>-1&&(ee=ee.replace(".","")),(j=ee.search(/e/i))>0?(N<0&&(N=j),N+=+ee.slice(j+1),ee=ee.substring(0,j)):N<0&&(N=ee.length)}else{if(Er(A,2,b.length,"Base"),A==10&&w)return G=new g(E),x(G,o+G.e+1,a);if(ee=String(E),F=typeof E=="number"){if(E*0!=0)return n(G,ee,F,A);if(G.s=1/E<0?(ee=ee.slice(1),-1):1,g.DEBUG&&ee.replace(/^0\.0*|\./,"").length>15)throw Error(e$+E)}else G.s=ee.charCodeAt(0)===45?(ee=ee.slice(1),-1):1;for(S=b.slice(0,A),N=j=0,V=ee.length;j<V;j++)if(S.indexOf(O=ee.charAt(j))<0){if(O=="."){if(j>N){N=V;continue}}else if(!I&&(ee==ee.toUpperCase()&&(ee=ee.toLowerCase())||ee==ee.toLowerCase()&&(ee=ee.toUpperCase()))){I=!0,j=-1,N=0;continue}return n(G,String(E),F,A)}F=!1,ee=r(ee,A,10,G.s),(N=ee.indexOf("."))>-1?ee=ee.replace(".",""):N=ee.length}for(j=0;ee.charCodeAt(j)===48;j++);for(V=ee.length;ee.charCodeAt(--V)===48;);if(ee=ee.slice(j,++V)){if(V-=j,F&&g.DEBUG&&V>15&&(E>Yv||E!==Yi(E)))throw Error(e$+G.s*E);if((N=N-j-1)>d)G.c=G.e=null;else if(N<u)G.c=[G.e=0];else{if(G.e=N,G.c=[],j=(N+1)%vt,N<0&&(j+=vt),j<V){for(j&&G.c.push(+ee.slice(0,j)),V-=vt;j<V;)G.c.push(+ee.slice(j,j+=vt));j=vt-(ee=ee.slice(j)).length}else j-=V;for(;j--;ee+="0");G.c.push(+ee)}}else G.c=[G.e=0]}g.clone=nk,g.ROUND_UP=0,g.ROUND_DOWN=1,g.ROUND_CEIL=2,g.ROUND_FLOOR=3,g.ROUND_HALF_UP=4,g.ROUND_HALF_DOWN=5,g.ROUND_HALF_EVEN=6,g.ROUND_HALF_CEIL=7,g.ROUND_HALF_FLOOR=8,g.EUCLID=9,g.config=g.set=function(E){var A,S;if(E!=null)if(typeof E=="object"){if(E.hasOwnProperty(A="DECIMAL_PLACES")&&(S=E[A],Er(S,0,tn,A),o=S),E.hasOwnProperty(A="ROUNDING_MODE")&&(S=E[A],Er(S,0,8,A),a=S),E.hasOwnProperty(A="EXPONENTIAL_AT")&&(S=E[A],S&&S.pop?(Er(S[0],-tn,0,A),Er(S[1],0,tn,A),c=S[0],l=S[1]):(Er(S,-tn,tn,A),c=-(l=S<0?-S:S))),E.hasOwnProperty(A="RANGE"))if(S=E[A],S&&S.pop)Er(S[0],-tn,-1,A),Er(S[1],1,tn,A),u=S[0],d=S[1];else if(Er(S,-tn,tn,A),S)u=-(d=S<0?-S:S);else throw Error(ci+A+" cannot be zero: "+S);if(E.hasOwnProperty(A="CRYPTO"))if(S=E[A],S===!!S)if(S)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))h=S;else throw h=!S,Error(ci+"crypto unavailable");else h=S;else throw Error(ci+A+" not true or false: "+S);if(E.hasOwnProperty(A="MODULO_MODE")&&(S=E[A],Er(S,0,9,A),f=S),E.hasOwnProperty(A="POW_PRECISION")&&(S=E[A],Er(S,0,tn,A),p=S),E.hasOwnProperty(A="FORMAT"))if(S=E[A],typeof S=="object")y=S;else throw Error(ci+A+" not an object: "+S);if(E.hasOwnProperty(A="ALPHABET"))if(S=E[A],typeof S=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(S))w=S.slice(0,10)=="0123456789",b=S;else throw Error(ci+A+" invalid: "+S)}else throw Error(ci+"Object expected: "+E);return{DECIMAL_PLACES:o,ROUNDING_MODE:a,EXPONENTIAL_AT:[c,l],RANGE:[u,d],CRYPTO:h,MODULO_MODE:f,POW_PRECISION:p,FORMAT:y,ALPHABET:b}},g.isBigNumber=function(E){if(!E||E._isBigNumber!==!0)return!1;if(!g.DEBUG)return!0;var A,S,O=E.c,I=E.e,N=E.s;e:if({}.toString.call(O)=="[object Array]"){if((N===1||N===-1)&&I>=-tn&&I<=tn&&I===Yi(I)){if(O[0]===0){if(I===0&&O.length===1)return!0;break e}if(A=(I+1)%vt,A<1&&(A+=vt),String(O[0]).length==A){for(A=0;A<O.length;A++)if(S=O[A],S<0||S>=Ps||S!==Yi(S))break e;if(S!==0)return!0}}}else if(O===null&&I===null&&(N===null||N===1||N===-1))return!0;throw Error(ci+"Invalid BigNumber: "+E)},g.maximum=g.max=function(){return m(arguments,-1)},g.minimum=g.min=function(){return m(arguments,1)},g.random=function(){var E=9007199254740992,A=Math.random()*E&2097151?function(){return Yi(Math.random()*E)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(S){var O,I,N,j,F,V=0,ee=[],G=new g(i);if(S==null?S=o:Er(S,0,tn),j=Xv(S/vt),h)if(crypto.getRandomValues){for(O=crypto.getRandomValues(new Uint32Array(j*=2));V<j;)F=O[V]*131072+(O[V+1]>>>11),F>=9e15?(I=crypto.getRandomValues(new Uint32Array(2)),O[V]=I[0],O[V+1]=I[1]):(ee.push(F%1e14),V+=2);V=j/2}else if(crypto.randomBytes){for(O=crypto.randomBytes(j*=7);V<j;)F=(O[V]&31)*281474976710656+O[V+1]*1099511627776+O[V+2]*4294967296+O[V+3]*16777216+(O[V+4]<<16)+(O[V+5]<<8)+O[V+6],F>=9e15?crypto.randomBytes(7).copy(O,V):(ee.push(F%1e14),V+=7);V=j/7}else throw h=!1,Error(ci+"crypto unavailable");if(!h)for(;V<j;)F=A(),F<9e15&&(ee[V++]=F%1e14);for(j=ee[--V],S%=vt,j&&S&&(F=Qv[vt-S],ee[V]=Yi(j/F)*F);ee[V]===0;ee.pop(),V--);if(V<0)ee=[N=0];else{for(N=-1;ee[0]===0;ee.splice(0,1),N-=vt);for(V=1,F=ee[0];F>=10;F/=10,V++);V<vt&&(N-=vt-V)}return G.e=N,G.c=ee,G}}(),g.sum=function(){for(var E=1,A=arguments,S=new g(A[0]);E<A.length;)S=S.plus(A[E++]);return S},r=function(){var E="0123456789";function A(S,O,I,N){for(var j,F=[0],V,ee=0,G=S.length;ee<G;){for(V=F.length;V--;F[V]*=O);for(F[0]+=N.indexOf(S.charAt(ee++)),j=0;j<F.length;j++)F[j]>I-1&&(F[j+1]==null&&(F[j+1]=0),F[j+1]+=F[j]/I|0,F[j]%=I)}return F.reverse()}return function(S,O,I,N,j){var F,V,ee,G,Z,M,k,H,U=S.indexOf("."),$=o,T=a;for(U>=0&&(G=p,p=0,S=S.replace(".",""),H=new g(O),M=H.pow(S.length-U),p=G,H.c=A(fa(Ji(M.c),M.e,"0"),10,I,E),H.e=H.c.length),k=A(S,O,I,j?(F=b,E):(F=E,b)),ee=G=k.length;k[--G]==0;k.pop());if(!k[0])return F.charAt(0);if(U<0?--ee:(M.c=k,M.e=ee,M.s=N,M=e(M,H,$,T,I),k=M.c,Z=M.r,ee=M.e),V=ee+$+1,U=k[V],G=I/2,Z=Z||V<0||k[V+1]!=null,Z=T<4?(U!=null||Z)&&(T==0||T==(M.s<0?3:2)):U>G||U==G&&(T==4||Z||T==6&&k[V-1]&1||T==(M.s<0?8:7)),V<1||!k[0])S=Z?fa(F.charAt(1),-$,F.charAt(0)):F.charAt(0);else{if(k.length=V,Z)for(--I;++k[--V]>I;)k[V]=0,V||(++ee,k=[1].concat(k));for(G=k.length;!k[--G];);for(U=0,S="";U<=G;S+=F.charAt(k[U++]));S=fa(S,ee,F.charAt(0))}return S}}(),e=function(){function E(O,I,N){var j,F,V,ee,G=0,Z=O.length,M=I%yu,k=I/yu|0;for(O=O.slice();Z--;)V=O[Z]%yu,ee=O[Z]/yu|0,j=k*V+ee*M,F=M*V+j%yu*yu+G,G=(F/N|0)+(j/yu|0)+k*ee,O[Z]=F%N;return G&&(O=[G].concat(O)),O}function A(O,I,N,j){var F,V;if(N!=j)V=N>j?1:-1;else for(F=V=0;F<N;F++)if(O[F]!=I[F]){V=O[F]>I[F]?1:-1;break}return V}function S(O,I,N,j){for(var F=0;N--;)O[N]-=F,F=O[N]<I[N]?1:0,O[N]=F*j+O[N]-I[N];for(;!O[0]&&O.length>1;O.splice(0,1));}return function(O,I,N,j,F){var V,ee,G,Z,M,k,H,U,$,T,z,ne,ue,ye,_e,Se,We,te=O.s==I.s?1:-1,se=O.c,ce=I.c;if(!se||!se[0]||!ce||!ce[0])return new g(!O.s||!I.s||(se?ce&&se[0]==ce[0]:!ce)?NaN:se&&se[0]==0||!ce?te*0:te/0);for(U=new g(te),$=U.c=[],ee=O.e-I.e,te=N+ee+1,F||(F=Ps,ee=Qi(O.e/vt)-Qi(I.e/vt),te=te/vt|0),G=0;ce[G]==(se[G]||0);G++);if(ce[G]>(se[G]||0)&&ee--,te<0)$.push(1),Z=!0;else{for(ye=se.length,Se=ce.length,G=0,te+=2,M=Yi(F/(ce[0]+1)),M>1&&(ce=E(ce,M,F),se=E(se,M,F),Se=ce.length,ye=se.length),ue=Se,T=se.slice(0,Se),z=T.length;z<Se;T[z++]=0);We=ce.slice(),We=[0].concat(We),_e=ce[0],ce[1]>=F/2&&_e++;do{if(M=0,V=A(ce,T,Se,z),V<0){if(ne=T[0],Se!=z&&(ne=ne*F+(T[1]||0)),M=Yi(ne/_e),M>1)for(M>=F&&(M=F-1),k=E(ce,M,F),H=k.length,z=T.length;A(k,T,H,z)==1;)M--,S(k,Se<H?We:ce,H,F),H=k.length,V=1;else M==0&&(V=M=1),k=ce.slice(),H=k.length;if(H<z&&(k=[0].concat(k)),S(T,k,z,F),z=T.length,V==-1)for(;A(ce,T,Se,z)<1;)M++,S(T,Se<z?We:ce,z,F),z=T.length}else V===0&&(M++,T=[0]);$[G++]=M,T[0]?T[z++]=se[ue]||0:(T=[se[ue]],z=1)}while((ue++<ye||T[0]!=null)&&te--);Z=T[0]!=null,$[0]||$.splice(0,1)}if(F==Ps){for(G=1,te=$[0];te>=10;te/=10,G++);x(U,N+(U.e=G+ee*vt-1)+1,j,Z)}else U.e=ee,U.r=+Z;return U}}();function v(E,A,S,O){var I,N,j,F,V;if(S==null?S=a:Er(S,0,8),!E.c)return E.toString();if(I=E.c[0],j=E.e,A==null)V=Ji(E.c),V=O==1||O==2&&(j<=c||j>=l)?Xy(V,j):fa(V,j,"0");else if(E=x(new g(E),A,S),N=E.e,V=Ji(E.c),F=V.length,O==1||O==2&&(A<=N||N<=c)){for(;F<A;V+="0",F++);V=Xy(V,N)}else if(A-=j,V=fa(V,N,"0"),N+1>F){if(--A>0)for(V+=".";A--;V+="0");}else if(A+=N-F,A>0)for(N+1==F&&(V+=".");A--;V+="0");return E.s<0&&I?"-"+V:V}function m(E,A){for(var S,O,I=1,N=new g(E[0]);I<E.length;I++)O=new g(E[I]),(!O.s||(S=zc(N,O))===A||S===0&&N.s===A)&&(N=O);return N}function _(E,A,S){for(var O=1,I=A.length;!A[--I];A.pop());for(I=A[0];I>=10;I/=10,O++);return(S=O+S*vt-1)>d?E.c=E.e=null:S<u?E.c=[E.e=0]:(E.e=S,E.c=A),E}n=function(){var E=/^(-?)0([xbo])(?=\w[\w.]*$)/i,A=/^([^.]+)\.$/,S=/^\.([^.]+)$/,O=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(N,j,F,V){var ee,G=F?j:j.replace(I,"");if(O.test(G))N.s=isNaN(G)?null:G<0?-1:1;else{if(!F&&(G=G.replace(E,function(Z,M,k){return ee=(k=k.toLowerCase())=="x"?16:k=="b"?2:8,!V||V==ee?M:Z}),V&&(ee=V,G=G.replace(A,"$1").replace(S,"0.$1")),j!=G))return new g(G,ee);if(g.DEBUG)throw Error(ci+"Not a"+(V?" base "+V:"")+" number: "+j);N.s=null}N.c=N.e=null}}();function x(E,A,S,O){var I,N,j,F,V,ee,G,Z=E.c,M=Qv;if(Z){e:{for(I=1,F=Z[0];F>=10;F/=10,I++);if(N=A-I,N<0)N+=vt,j=A,V=Z[ee=0],G=Yi(V/M[I-j-1]%10);else if(ee=Xv((N+1)/vt),ee>=Z.length)if(O){for(;Z.length<=ee;Z.push(0));V=G=0,I=1,N%=vt,j=N-vt+1}else break e;else{for(V=F=Z[ee],I=1;F>=10;F/=10,I++);N%=vt,j=N-vt+I,G=j<0?0:Yi(V/M[I-j-1]%10)}if(O=O||A<0||Z[ee+1]!=null||(j<0?V:V%M[I-j-1]),O=S<4?(G||O)&&(S==0||S==(E.s<0?3:2)):G>5||G==5&&(S==4||O||S==6&&(N>0?j>0?V/M[I-j]:0:Z[ee-1])%10&1||S==(E.s<0?8:7)),A<1||!Z[0])return Z.length=0,O?(A-=E.e+1,Z[0]=M[(vt-A%vt)%vt],E.e=-A||0):Z[0]=E.e=0,E;if(N==0?(Z.length=ee,F=1,ee--):(Z.length=ee+1,F=M[vt-N],Z[ee]=j>0?Yi(V/M[I-j]%M[j])*F:0),O)for(;;)if(ee==0){for(N=1,j=Z[0];j>=10;j/=10,N++);for(j=Z[0]+=F,F=1;j>=10;j/=10,F++);N!=F&&(E.e++,Z[0]==Ps&&(Z[0]=1));break}else{if(Z[ee]+=F,Z[ee]!=Ps)break;Z[ee--]=0,F=1}for(N=Z.length;Z[--N]===0;Z.pop());}E.e>d?E.c=E.e=null:E.e<u&&(E.c=[E.e=0])}return E}function D(E){var A,S=E.e;return S===null?E.toString():(A=Ji(E.c),A=S<=c||S>=l?Xy(A,S):fa(A,S,"0"),E.s<0?"-"+A:A)}return s.absoluteValue=s.abs=function(){var E=new g(this);return E.s<0&&(E.s=1),E},s.comparedTo=function(E,A){return zc(this,new g(E,A))},s.decimalPlaces=s.dp=function(E,A){var S,O,I,N=this;if(E!=null)return Er(E,0,tn),A==null?A=a:Er(A,0,8),x(new g(N),E+N.e+1,A);if(!(S=N.c))return null;if(O=((I=S.length-1)-Qi(this.e/vt))*vt,I=S[I])for(;I%10==0;I/=10,O--);return O<0&&(O=0),O},s.dividedBy=s.div=function(E,A){return e(this,new g(E,A),o,a)},s.dividedToIntegerBy=s.idiv=function(E,A){return e(this,new g(E,A),0,1)},s.exponentiatedBy=s.pow=function(E,A){var S,O,I,N,j,F,V,ee,G,Z=this;if(E=new g(E),E.c&&!E.isInteger())throw Error(ci+"Exponent not an integer: "+D(E));if(A!=null&&(A=new g(A)),F=E.e>14,!Z.c||!Z.c[0]||Z.c[0]==1&&!Z.e&&Z.c.length==1||!E.c||!E.c[0])return G=new g(Math.pow(+D(Z),F?E.s*(2-Zy(E)):+D(E))),A?G.mod(A):G;if(V=E.s<0,A){if(A.c?!A.c[0]:!A.s)return new g(NaN);O=!V&&Z.isInteger()&&A.isInteger(),O&&(Z=Z.mod(A))}else{if(E.e>9&&(Z.e>0||Z.e<-1||(Z.e==0?Z.c[0]>1||F&&Z.c[1]>=24e7:Z.c[0]<8e13||F&&Z.c[0]<=9999975e7)))return N=Z.s<0&&Zy(E)?-0:0,Z.e>-1&&(N=1/N),new g(V?1/N:N);p&&(N=Xv(p/vt+2))}for(F?(S=new g(.5),V&&(E.s=1),ee=Zy(E)):(I=Math.abs(+D(E)),ee=I%2),G=new g(i);;){if(ee){if(G=G.times(Z),!G.c)break;N?G.c.length>N&&(G.c.length=N):O&&(G=G.mod(A))}if(I){if(I=Yi(I/2),I===0)break;ee=I%2}else if(E=E.times(S),x(E,E.e+1,1),E.e>14)ee=Zy(E);else{if(I=+D(E),I===0)break;ee=I%2}Z=Z.times(Z),N?Z.c&&Z.c.length>N&&(Z.c.length=N):O&&(Z=Z.mod(A))}return O?G:(V&&(G=i.div(G)),A?G.mod(A):N?x(G,p,a,j):G)},s.integerValue=function(E){var A=new g(this);return E==null?E=a:Er(E,0,8),x(A,A.e+1,E)},s.isEqualTo=s.eq=function(E,A){return zc(this,new g(E,A))===0},s.isFinite=function(){return!!this.c},s.isGreaterThan=s.gt=function(E,A){return zc(this,new g(E,A))>0},s.isGreaterThanOrEqualTo=s.gte=function(E,A){return(A=zc(this,new g(E,A)))===1||A===0},s.isInteger=function(){return!!this.c&&Qi(this.e/vt)>this.c.length-2},s.isLessThan=s.lt=function(E,A){return zc(this,new g(E,A))<0},s.isLessThanOrEqualTo=s.lte=function(E,A){return(A=zc(this,new g(E,A)))===-1||A===0},s.isNaN=function(){return!this.s},s.isNegative=function(){return this.s<0},s.isPositive=function(){return this.s>0},s.isZero=function(){return!!this.c&&this.c[0]==0},s.minus=function(E,A){var S,O,I,N,j=this,F=j.s;if(E=new g(E,A),A=E.s,!F||!A)return new g(NaN);if(F!=A)return E.s=-A,j.plus(E);var V=j.e/vt,ee=E.e/vt,G=j.c,Z=E.c;if(!V||!ee){if(!G||!Z)return G?(E.s=-A,E):new g(Z?j:NaN);if(!G[0]||!Z[0])return Z[0]?(E.s=-A,E):new g(G[0]?j:a==3?-0:0)}if(V=Qi(V),ee=Qi(ee),G=G.slice(),F=V-ee){for((N=F<0)?(F=-F,I=G):(ee=V,I=Z),I.reverse(),A=F;A--;I.push(0));I.reverse()}else for(O=(N=(F=G.length)<(A=Z.length))?F:A,F=A=0;A<O;A++)if(G[A]!=Z[A]){N=G[A]<Z[A];break}if(N&&(I=G,G=Z,Z=I,E.s=-E.s),A=(O=Z.length)-(S=G.length),A>0)for(;A--;G[S++]=0);for(A=Ps-1;O>F;){if(G[--O]<Z[O]){for(S=O;S&&!G[--S];G[S]=A);--G[S],G[O]+=Ps}G[O]-=Z[O]}for(;G[0]==0;G.splice(0,1),--ee);return G[0]?_(E,G,ee):(E.s=a==3?-1:1,E.c=[E.e=0],E)},s.modulo=s.mod=function(E,A){var S,O,I=this;return E=new g(E,A),!I.c||!E.s||E.c&&!E.c[0]?new g(NaN):!E.c||I.c&&!I.c[0]?new g(I):(f==9?(O=E.s,E.s=1,S=e(I,E,0,3),E.s=O,S.s*=O):S=e(I,E,0,f),E=I.minus(S.times(E)),!E.c[0]&&f==1&&(E.s=I.s),E)},s.multipliedBy=s.times=function(E,A){var S,O,I,N,j,F,V,ee,G,Z,M,k,H,U,$,T=this,z=T.c,ne=(E=new g(E,A)).c;if(!z||!ne||!z[0]||!ne[0])return!T.s||!E.s||z&&!z[0]&&!ne||ne&&!ne[0]&&!z?E.c=E.e=E.s=null:(E.s*=T.s,!z||!ne?E.c=E.e=null:(E.c=[0],E.e=0)),E;for(O=Qi(T.e/vt)+Qi(E.e/vt),E.s*=T.s,V=z.length,Z=ne.length,V<Z&&(H=z,z=ne,ne=H,I=V,V=Z,Z=I),I=V+Z,H=[];I--;H.push(0));for(U=Ps,$=yu,I=Z;--I>=0;){for(S=0,M=ne[I]%$,k=ne[I]/$|0,j=V,N=I+j;N>I;)ee=z[--j]%$,G=z[j]/$|0,F=k*ee+G*M,ee=M*ee+F%$*$+H[N]+S,S=(ee/U|0)+(F/$|0)+k*G,H[N--]=ee%U;H[N]=S}return S?++O:H.splice(0,1),_(E,H,O)},s.negated=function(){var E=new g(this);return E.s=-E.s||null,E},s.plus=function(E,A){var S,O=this,I=O.s;if(E=new g(E,A),A=E.s,!I||!A)return new g(NaN);if(I!=A)return E.s=-A,O.minus(E);var N=O.e/vt,j=E.e/vt,F=O.c,V=E.c;if(!N||!j){if(!F||!V)return new g(I/0);if(!F[0]||!V[0])return V[0]?E:new g(F[0]?O:I*0)}if(N=Qi(N),j=Qi(j),F=F.slice(),I=N-j){for(I>0?(j=N,S=V):(I=-I,S=F),S.reverse();I--;S.push(0));S.reverse()}for(I=F.length,A=V.length,I-A<0&&(S=V,V=F,F=S,A=I),I=0;A;)I=(F[--A]=F[A]+V[A]+I)/Ps|0,F[A]=Ps===F[A]?0:F[A]%Ps;return I&&(F=[I].concat(F),++j),_(E,F,j)},s.precision=s.sd=function(E,A){var S,O,I,N=this;if(E!=null&&E!==!!E)return Er(E,1,tn),A==null?A=a:Er(A,0,8),x(new g(N),E,A);if(!(S=N.c))return null;if(I=S.length-1,O=I*vt+1,I=S[I]){for(;I%10==0;I/=10,O--);for(I=S[0];I>=10;I/=10,O++);}return E&&N.e+1>O&&(O=N.e+1),O},s.shiftedBy=function(E){return Er(E,-Yv,Yv),this.times("1e"+E)},s.squareRoot=s.sqrt=function(){var E,A,S,O,I,N=this,j=N.c,F=N.s,V=N.e,ee=o+4,G=new g("0.5");if(F!==1||!j||!j[0])return new g(!F||F<0&&(!j||j[0])?NaN:j?N:1/0);if(F=Math.sqrt(+D(N)),F==0||F==1/0?(A=Ji(j),(A.length+V)%2==0&&(A+="0"),F=Math.sqrt(+A),V=Qi((V+1)/2)-(V<0||V%2),F==1/0?A="5e"+V:(A=F.toExponential(),A=A.slice(0,A.indexOf("e")+1)+V),S=new g(A)):S=new g(F+""),S.c[0]){for(V=S.e,F=V+ee,F<3&&(F=0);;)if(I=S,S=G.times(I.plus(e(N,I,ee,1))),Ji(I.c).slice(0,F)===(A=Ji(S.c)).slice(0,F))if(S.e<V&&--F,A=A.slice(F-3,F+1),A=="9999"||!O&&A=="4999"){if(!O&&(x(I,I.e+o+2,0),I.times(I).eq(N))){S=I;break}ee+=4,F+=4,O=1}else{(!+A||!+A.slice(1)&&A.charAt(0)=="5")&&(x(S,S.e+o+2,1),E=!S.times(S).eq(N));break}}return x(S,S.e+o+1,a,E)},s.toExponential=function(E,A){return E!=null&&(Er(E,0,tn),E++),v(this,E,A,1)},s.toFixed=function(E,A){return E!=null&&(Er(E,0,tn),E=E+this.e+1),v(this,E,A)},s.toFormat=function(E,A,S){var O,I=this;if(S==null)E!=null&&A&&typeof A=="object"?(S=A,A=null):E&&typeof E=="object"?(S=E,E=A=null):S=y;else if(typeof S!="object")throw Error(ci+"Argument not an object: "+S);if(O=I.toFixed(E,A),I.c){var N,j=O.split("."),F=+S.groupSize,V=+S.secondaryGroupSize,ee=S.groupSeparator||"",G=j[0],Z=j[1],M=I.s<0,k=M?G.slice(1):G,H=k.length;if(V&&(N=F,F=V,V=N,H-=N),F>0&&H>0){for(N=H%F||F,G=k.substr(0,N);N<H;N+=F)G+=ee+k.substr(N,F);V>0&&(G+=ee+k.slice(N)),M&&(G="-"+G)}O=Z?G+(S.decimalSeparator||"")+((V=+S.fractionGroupSize)?Z.replace(new RegExp("\\d{"+V+"}\\B","g"),"$&"+(S.fractionGroupSeparator||"")):Z):G}return(S.prefix||"")+O+(S.suffix||"")},s.toFraction=function(E){var A,S,O,I,N,j,F,V,ee,G,Z,M,k=this,H=k.c;if(E!=null&&(F=new g(E),!F.isInteger()&&(F.c||F.s!==1)||F.lt(i)))throw Error(ci+"Argument "+(F.isInteger()?"out of range: ":"not an integer: ")+D(F));if(!H)return new g(k);for(A=new g(i),ee=S=new g(i),O=V=new g(i),M=Ji(H),N=A.e=M.length-k.e-1,A.c[0]=Qv[(j=N%vt)<0?vt+j:j],E=!E||F.comparedTo(A)>0?N>0?A:ee:F,j=d,d=1/0,F=new g(M),V.c[0]=0;G=e(F,A,0,1),I=S.plus(G.times(O)),I.comparedTo(E)!=1;)S=O,O=I,ee=V.plus(G.times(I=ee)),V=I,A=F.minus(G.times(I=A)),F=I;return I=e(E.minus(S),O,0,1),V=V.plus(I.times(ee)),S=S.plus(I.times(O)),V.s=ee.s=k.s,N=N*2,Z=e(ee,O,N,a).minus(k).abs().comparedTo(e(V,S,N,a).minus(k).abs())<1?[ee,O]:[V,S],d=j,Z},s.toNumber=function(){return+D(this)},s.toPrecision=function(E,A){return E!=null&&Er(E,1,tn),v(this,E,A,2)},s.toString=function(E){var A,S=this,O=S.s,I=S.e;return I===null?O?(A="Infinity",O<0&&(A="-"+A)):A="NaN":(E==null?A=I<=c||I>=l?Xy(Ji(S.c),I):fa(Ji(S.c),I,"0"):E===10&&w?(S=x(new g(S),o+I+1,a),A=fa(Ji(S.c),S.e,"0")):(Er(E,2,b.length,"Base"),A=r(fa(Ji(S.c),I,"0"),10,E,O,!0)),O<0&&S.c[0]&&(A="-"+A)),A},s.valueOf=s.toJSON=function(){return D(this)},s._isBigNumber=!0,s[Symbol.toStringTag]="BigNumber",s[Symbol.for("nodejs.util.inspect.custom")]=s.valueOf,t!=null&&g.set(t),g}function Qi(t){var e=t|0;return t>0||t===e?e:e-1}function Ji(t){for(var e,r,n=1,s=t.length,i=t[0]+"";n<s;){for(e=t[n++]+"",r=vt-e.length;r--;e="0"+e);i+=e}for(s=i.length;i.charCodeAt(--s)===48;);return i.slice(0,s+1||1)}function zc(t,e){var r,n,s=t.c,i=e.c,o=t.s,a=e.s,c=t.e,l=e.e;if(!o||!a)return null;if(r=s&&!s[0],n=i&&!i[0],r||n)return r?n?0:-a:o;if(o!=a)return o;if(r=o<0,n=c==l,!s||!i)return n?0:!s^r?1:-1;if(!n)return c>l^r?1:-1;for(a=(c=s.length)<(l=i.length)?c:l,o=0;o<a;o++)if(s[o]!=i[o])return s[o]>i[o]^r?1:-1;return c==l?0:c>l^r?1:-1}function Er(t,e,r,n){if(t<e||t>r||t!==Yi(t))throw Error(ci+(n||"Argument")+(typeof t=="number"?t<e||t>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function Zy(t){var e=t.c.length-1;return Qi(t.e/vt)==e&&t.c[e]%2!=0}function Xy(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function fa(t,e,r){var n,s;if(e<0){for(s=r+".";++e;s+=r);t=s+t}else if(n=t.length,++e>n){for(s=r,e-=n;--e;s+=r);t+=s}else e<n&&(t=t.slice(0,e)+"."+t.slice(e));return t}var Yy=nk();function NU(t){if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")}function RU(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var y=0,b=0,w=0,g=p.length;w!==g&&p[w]===0;)w++,y++;for(var v=(g-w)*u+1>>>0,m=new Uint8Array(v);w!==g;){for(var _=p[w],x=0,D=v-1;(_!==0||x<b)&&D!==-1;D--,x++)_+=256*m[D]>>>0,m[D]=_%a>>>0,_=_/a>>>0;if(_!==0)throw new Error("Non-zero carry");b=x,w++}for(var E=v-b;E!==v&&m[E]===0;)E++;for(var A=c.repeat(y);E<v;++E)A+=t.charAt(m[E]);return A}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var y=0;if(p[y]!==" "){for(var b=0,w=0;p[y]===c;)b++,y++;for(var g=(p.length-y)*l+1>>>0,v=new Uint8Array(g);p[y];){var m=r[p.charCodeAt(y)];if(m===255)return;for(var _=0,x=g-1;(m!==0||_<w)&&x!==-1;x--,_++)m+=a*v[x]>>>0,v[x]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");w=_,y++}if(p[y]!==" "){for(var D=g-w;D!==g&&v[D]===0;)D++;for(var E=new Uint8Array(b+(g-D)),A=b;D!==g;)E[A++]=v[D++];return E}}}function f(p){var y=h(p);if(y)return y;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var jU=RU,MU=jU;let UU=class{constructor(e,r,n){de(this,"name");de(this,"prefix");de(this,"baseEncode");this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},KU=class{constructor(e,r,n){de(this,"name");de(this,"prefix");de(this,"baseDecode");de(this,"prefixCodePoint");if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ik(this,e)}},LU=class{constructor(e){de(this,"decoders");this.decoders=e}or(e){return ik(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n!=null)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function ik(t,e){return new LU({...t.decoders??{[t.prefix]:t},...e.decoders??{[e.prefix]:e}})}let qU=class{constructor(e,r,n,s){de(this,"name");de(this,"prefix");de(this,"baseEncode");de(this,"baseDecode");de(this,"encoder");de(this,"decoder");this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new UU(e,r,n),this.decoder=new KU(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};function sk({name:t,prefix:e,encode:r,decode:n}){return new qU(t,e,r,n)}function ok({name:t,prefix:e,alphabet:r}){const{encode:n,decode:s}=MU(r,t);return sk({prefix:e,name:t,encode:n,decode:i=>NU(s(i))})}function VU(t,e,r,n){const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o}function zU(t,e,r){const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o!==0&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i}function Mi({name:t,prefix:e,bitsPerChar:r,alphabet:n}){return sk({prefix:e,name:t,encode(s){return zU(s,n,r)},decode(s){return VU(s,n,r,t)}})}Mi({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});Mi({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});Mi({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});Mi({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});Mi({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});Mi({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});Mi({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});Mi({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});const t$=Mi({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Qy=ok({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});ok({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});Mi({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});Mi({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const pa=Mi({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});Mi({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function HU(t){return t.byteOffset!==0||t.byteLength!==t.buffer.byteLength}function WU(t){return typeof t!="object"||t===null?!1:typeof t[Symbol.asyncIterator]=="function"}function r$(t){const r=Object.prototype.toString.call(t).match(/\s([a-zA-Z0-9]+)/),[n,s]=r;return s}var ep=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},n$=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}};const em=new TextEncoder,Hc=new TextDecoder;let mu=class oi{constructor(e,r){this.data=e,this.format=r}static arrayBuffer(e){return new oi(e,"ArrayBuffer")}static asyncIterable(e){if(!WU(e))throw new TypeError("Input must be of type AsyncIterable.");return new oi(e,"AsyncIterable")}static base32Z(e){return new oi(e,"Base32Z")}static base58Btc(e){return new oi(e,"Base58Btc")}static base64Url(e){return new oi(e,"Base64Url")}static bufferSource(e){return new oi(e,"BufferSource")}static hex(e){if(typeof e!="string")throw new TypeError("Hex input must be a string.");if(e.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new oi(e,"Hex")}static multibase(e){return new oi(e,"Multibase")}static object(e){return new oi(e,"Object")}static string(e){return new oi(e,"String")}static uint8Array(e){return new oi(e,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return Qy.baseDecode(this.data).buffer;case"Base64Url":return pa.baseDecode(this.data).buffer;case"BufferSource":{if(r$(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return HU(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return ep(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return t$.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return Qy.baseEncode(e)}case"Multibase":return this.data.substring(1);case"Uint8Array":return Qy.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return pa.baseEncode(e)}case"BufferSource":{const e=this.toUint8Array();return pa.baseEncode(e)}case"Object":{const e=JSON.stringify(this.data),r=em.encode(e);return pa.baseEncode(r)}case"String":{const e=em.encode(this.data);return pa.baseEncode(e)}case"Uint8Array":return pa.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){return ep(this,void 0,void 0,function*(){var e,r,n,s;switch(this.format){case"AsyncIterable":{const c=[];try{for(var i=!0,o=n$(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const u=s;c.push(u)}}catch(u){r={error:u}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return new Blob(c)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){const e=Array.from({length:256},(r,n)=>n.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{const r=this.toUint8Array();return oi.uint8Array(r).toHex()}case"Base64Url":{const r=this.toUint8Array();return oi.uint8Array(r).toHex()}case"Uint8Array":{let r="";for(let n=0;n<this.data.length;n++)r+=e[this.data[n]];return r}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{const e=pa.baseDecode(this.data),r=Hc.decode(e);return JSON.parse(r)}case"String":return JSON.parse(this.data);case"Uint8Array":{const e=Hc.decode(this.data);return JSON.parse(e)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return ep(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toStringAsync();return JSON.parse(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return Hc.decode(this.data);case"Base64Url":{const e=pa.baseDecode(this.data);return Hc.decode(e)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return Hc.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){return ep(this,void 0,void 0,function*(){var e,r,n,s;switch(this.format){case"AsyncIterable":{let c="";try{for(var i=!0,o=n$(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const l=s;typeof l=="string"?c+=l:c+=Hc.decode(l,{stream:!0})}}catch(l){r={error:l}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return c+=Hc.decode(void 0,{stream:!1}),c}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return t$.baseDecode(this.data);case"Base58Btc":return Qy.baseDecode(this.data);case"Base64Url":return pa.baseDecode(this.data);case"BufferSource":{const e=r$(this.data);if(e==="Uint8Array")return this.data;if(e==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{const e=new Uint8Array(this.data.length/2);for(let r=0;r<this.data.length;r+=2){const n=parseInt(this.data.substring(r,r+2),16);if(isNaN(n))throw new TypeError("Input is not a valid hexadecimal string.");e[r/2]=n}return e}case"Object":{const e=JSON.stringify(this.data);return em.encode(e)}case"String":return em.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return ep(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toArrayBufferAsync();return new Uint8Array(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}};var JU=ak,i$=128,GU=127,ZU=~GU,XU=Math.pow(2,31);function ak(t,e,r){e=e||[],r=r||0;for(var n=r;t>=XU;)e[r++]=t&255|i$,t/=128;for(;t&ZU;)e[r++]=t&255|i$,t>>>=7;return e[r]=t|0,ak.bytes=r-n+1,e}var YU=Rb,QU=128,s$=127;function Rb(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw Rb.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&s$)<<s:(o&s$)*Math.pow(2,s),s+=7}while(o>=QU);return Rb.bytes=i-n,r}var eK=Math.pow(2,7),tK=Math.pow(2,14),rK=Math.pow(2,21),nK=Math.pow(2,28),iK=Math.pow(2,35),sK=Math.pow(2,42),oK=Math.pow(2,49),aK=Math.pow(2,56),uK=Math.pow(2,63),cK=function(t){return t<eK?1:t<tK?2:t<rK?3:t<nK?4:t<iK?5:t<sK?6:t<oK?7:t<aK?8:t<uK?9:10},lK={encode:JU,decode:YU,encodingLength:cK},I0=lK;function o$(t,e=0){return[I0.decode(t,e),I0.decode.bytes]}function dK(t,e,r=0){return I0.encode(t,e,r),e}function fK(t){return I0.encodingLength(t)}let Sc=class ju{static addPrefix(e){var r;let{code:n,data:s,name:i}=e;if(!(i?!n:n))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(n=ju.codeToName.has(n)?n:ju.nameToCode.get(i),n===void 0)throw new Error(`Unsupported multicodec: ${(r=e.name)!==null&&r!==void 0?r:e.code}`);const o=fK(n),a=new Uint8Array(o+s.byteLength);return a.set(s,o),dK(n,a),a}static getCodeFromData(e){const{prefixedData:r}=e,[n,s]=o$(r);return n}static getCodeFromName(e){const{name:r}=e,n=ju.nameToCode.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static getNameFromCode(e){const{code:r}=e,n=ju.codeToName.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static registerCodec(e){ju.codeToName.set(e.code,e.name),ju.nameToCode.set(e.name,e.code)}static removePrefix(e){const{prefixedData:r}=e,[n,s]=o$(r),i=ju.codeToName.get(n);if(i===void 0)throw new Error(`Unsupported multicodec: ${n}`);return{code:n,data:r.slice(s),name:i}}};Sc.codeToName=new Map;Sc.nameToCode=new Map;Sc.registerCodec({code:237,name:"ed25519-pub"});Sc.registerCodec({code:4864,name:"ed25519-priv"});Sc.registerCodec({code:236,name:"x25519-pub"});Sc.registerCodec({code:4866,name:"x25519-priv"});Sc.registerCodec({code:231,name:"secp256k1-pub"});Sc.registerCodec({code:4865,name:"secp256k1-priv"});function pK(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var y=0,b=0,w=0,g=p.length;w!==g&&p[w]===0;)w++,y++;for(var v=(g-w)*u+1>>>0,m=new Uint8Array(v);w!==g;){for(var _=p[w],x=0,D=v-1;(_!==0||x<b)&&D!==-1;D--,x++)_+=256*m[D]>>>0,m[D]=_%a>>>0,_=_/a>>>0;if(_!==0)throw new Error("Non-zero carry");b=x,w++}for(var E=v-b;E!==v&&m[E]===0;)E++;for(var A=c.repeat(y);E<v;++E)A+=t.charAt(m[E]);return A}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var y=0;if(p[y]!==" "){for(var b=0,w=0;p[y]===c;)b++,y++;for(var g=(p.length-y)*l+1>>>0,v=new Uint8Array(g);p[y];){var m=r[p.charCodeAt(y)];if(m===255)return;for(var _=0,x=g-1;(m!==0||_<w)&&x!==-1;x--,_++)m+=a*v[x]>>>0,v[x]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");w=_,y++}if(p[y]!==" "){for(var D=g-w;D!==g&&v[D]===0;)D++;for(var E=new Uint8Array(b+(g-D)),A=b;D!==g;)E[A++]=v[D++];return E}}}function f(p){var y=h(p);if(y)return y;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var hK=pK,yK=hK;const mK=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};let gK=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},vK=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return uk(this,e)}},wK=class{constructor(e){this.decoders=e}or(e){return uk(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const uk=(t,e)=>new wK({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let bK=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new gK(e,r,n),this.decoder=new vK(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const ck=({name:t,prefix:e,encode:r,decode:n})=>new bK(t,e,r,n),lk=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:s}=yK(r,e);return ck({prefix:t,name:e,encode:n,decode:i=>mK(s(i))})},_K=(t,e,r,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},EK=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},Ui=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>ck({prefix:e,name:t,encode(s){return EK(s,n,r)},decode(s){return _K(s,n,r,t)}});Ui({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});Ui({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});Ui({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});Ui({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});Ui({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});Ui({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});Ui({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});Ui({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});const a$=Ui({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),tm=lk({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});lk({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});Ui({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});Ui({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const ha=Ui({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});Ui({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function AK(t){return t.byteOffset!==0||t.byteLength!==t.buffer.byteLength}function SK(t){return typeof t!="object"||t===null?!1:typeof t[Symbol.asyncIterator]=="function"}function u$(t){const r=Object.prototype.toString.call(t).match(/\s([a-zA-Z0-9]+)/),[n,s]=r;return s}var tp=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},c$=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}};const rm=new TextEncoder,Wc=new TextDecoder;let Vt=class ai{constructor(e,r){this.data=e,this.format=r}static arrayBuffer(e){return new ai(e,"ArrayBuffer")}static asyncIterable(e){if(!SK(e))throw new TypeError("Input must be of type AsyncIterable.");return new ai(e,"AsyncIterable")}static base32Z(e){return new ai(e,"Base32Z")}static base58Btc(e){return new ai(e,"Base58Btc")}static base64Url(e){return new ai(e,"Base64Url")}static bufferSource(e){return new ai(e,"BufferSource")}static hex(e){if(typeof e!="string")throw new TypeError("Hex input must be a string.");if(e.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new ai(e,"Hex")}static multibase(e){return new ai(e,"Multibase")}static object(e){return new ai(e,"Object")}static string(e){return new ai(e,"String")}static uint8Array(e){return new ai(e,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return tm.baseDecode(this.data).buffer;case"Base64Url":return ha.baseDecode(this.data).buffer;case"BufferSource":{if(u$(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return AK(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return tp(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return a$.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return tm.baseEncode(e)}case"Multibase":return this.data.substring(1);case"Uint8Array":return tm.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return ha.baseEncode(e)}case"BufferSource":{const e=this.toUint8Array();return ha.baseEncode(e)}case"Object":{const e=JSON.stringify(this.data),r=rm.encode(e);return ha.baseEncode(r)}case"String":{const e=rm.encode(this.data);return ha.baseEncode(e)}case"Uint8Array":return ha.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){var e,r,n,s;return tp(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const c=[];try{for(var i=!0,o=c$(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const u=s;c.push(u)}}catch(u){r={error:u}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return new Blob(c)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){const e=Array.from({length:256},(r,n)=>n.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{const r=this.toUint8Array();return ai.uint8Array(r).toHex()}case"Base64Url":{const r=this.toUint8Array();return ai.uint8Array(r).toHex()}case"Uint8Array":{let r="";for(let n=0;n<this.data.length;n++)r+=e[this.data[n]];return r}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{const e=ha.baseDecode(this.data),r=Wc.decode(e);return JSON.parse(r)}case"String":return JSON.parse(this.data);case"Uint8Array":{const e=Wc.decode(this.data);return JSON.parse(e)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return tp(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toStringAsync();return JSON.parse(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return Wc.decode(this.data);case"Base64Url":{const e=ha.baseDecode(this.data);return Wc.decode(e)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return Wc.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){var e,r,n,s;return tp(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let c="";try{for(var i=!0,o=c$(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const l=s;typeof l=="string"?c+=l:c+=Wc.decode(l,{stream:!0})}}catch(l){r={error:l}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return c+=Wc.decode(void 0,{stream:!1}),c}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return a$.baseDecode(this.data);case"Base58Btc":return tm.baseDecode(this.data);case"Base64Url":return ha.baseDecode(this.data);case"BufferSource":{const e=u$(this.data);if(e==="Uint8Array")return this.data;if(e==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{const e=new Uint8Array(this.data.length/2);for(let r=0;r<this.data.length;r+=2){const n=parseInt(this.data.substring(r,r+2),16);if(isNaN(n))throw new TypeError("Input is not a valid hexadecimal string.");e[r/2]=n}return e}case"Object":{const e=JSON.stringify(this.data);return rm.encode(e)}case"String":return rm.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return tp(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toArrayBufferAsync();return new Uint8Array(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}};var $K=dk,l$=128,xK=127,DK=~xK,PK=Math.pow(2,31);function dk(t,e,r){e=e||[],r=r||0;for(var n=r;t>=PK;)e[r++]=t&255|l$,t/=128;for(;t&DK;)e[r++]=t&255|l$,t>>>=7;return e[r]=t|0,dk.bytes=r-n+1,e}var CK=jb,kK=128,d$=127;function jb(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw jb.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&d$)<<s:(o&d$)*Math.pow(2,s),s+=7}while(o>=kK);return jb.bytes=i-n,r}var OK=Math.pow(2,7),TK=Math.pow(2,14),IK=Math.pow(2,21),BK=Math.pow(2,28),FK=Math.pow(2,35),NK=Math.pow(2,42),RK=Math.pow(2,49),jK=Math.pow(2,56),MK=Math.pow(2,63),UK=function(t){return t<OK?1:t<TK?2:t<IK?3:t<BK?4:t<FK?5:t<NK?6:t<RK?7:t<jK?8:t<MK?9:10},KK={encode:$K,decode:CK,encodingLength:UK},B0=KK;const f$=(t,e=0)=>[B0.decode(t,e),B0.decode.bytes],LK=(t,e,r=0)=>(B0.encode(t,e,r),e),qK=t=>B0.encodingLength(t);let $c=class Mu{static addPrefix(e){var r;let{code:n,data:s,name:i}=e;if(!(i?!n:n))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(n=Mu.codeToName.has(n)?n:Mu.nameToCode.get(i),n===void 0)throw new Error(`Unsupported multicodec: ${(r=e.name)!==null&&r!==void 0?r:e.code}`);const o=qK(n),a=new Uint8Array(o+s.byteLength);return a.set(s,o),LK(n,a),a}static getCodeFromData(e){const{prefixedData:r}=e,[n,s]=f$(r);return n}static getCodeFromName(e){const{name:r}=e,n=Mu.nameToCode.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static getNameFromCode(e){const{code:r}=e,n=Mu.codeToName.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static registerCodec(e){Mu.codeToName.set(e.code,e.name),Mu.nameToCode.set(e.name,e.code)}static removePrefix(e){const{prefixedData:r}=e,[n,s]=f$(r),i=Mu.codeToName.get(n);if(i===void 0)throw new Error(`Unsupported multicodec: ${n}`);return{code:n,data:r.slice(s),name:i}}};$c.codeToName=new Map;$c.nameToCode=new Map;$c.registerCodec({code:237,name:"ed25519-pub"});$c.registerCodec({code:4864,name:"ed25519-priv"});$c.registerCodec({code:236,name:"x25519-pub"});$c.registerCodec({code:4866,name:"x25519-priv"});$c.registerCodec({code:231,name:"secp256k1-pub"});$c.registerCodec({code:4865,name:"secp256k1-priv"});function fk(t){Object.keys(t).forEach(e=>{t[e]===void 0?delete t[e]:typeof t[e]=="object"&&fk(t[e])})}var Jc=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let VK=class{constructor(){this.store=new Map}clear(){return Jc(this,void 0,void 0,function*(){this.store.clear()})}close(){return Jc(this,void 0,void 0,function*(){})}delete(e){return Jc(this,void 0,void 0,function*(){return this.store.delete(e)})}get(e){return Jc(this,void 0,void 0,function*(){return this.store.get(e)})}has(e){return Jc(this,void 0,void 0,function*(){return this.store.has(e)})}list(){return Jc(this,void 0,void 0,function*(){return Array.from(this.store.values())})}set(e,r){return Jc(this,void 0,void 0,function*(){this.store.set(e,r)})}};function zK(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function pk(t,...e){if(!zK(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function p$(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function HK(t,e){pk(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const WK=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ew=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),so=(t,e)=>t<<32-e|t>>>e;new Uint8Array(new Uint32Array([287454020]).buffer)[0];function JK(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function hk(t){return typeof t=="string"&&(t=JK(t)),pk(t),t}let GK=class{clone(){return this._cloneInto()}};function ZK(t){const e=n=>t().update(hk(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function XK(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),c=n?4:0,l=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+l,a,n)}const YK=(t,e,r)=>t&e^~t&r,QK=(t,e,r)=>t&e^t&r^e&r;let e7=class extends GK{constructor(e,r,n,s){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ew(this.buffer)}update(e){p$(this);const{view:r,buffer:n,blockLen:s}=this;e=hk(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=ew(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){p$(this),HK(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)r[d]=0;XK(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=ew(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%r&&e.buffer.set(n),e}};const t7=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),gu=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),vu=new Uint32Array(64);let r7=class extends e7{constructor(){super(64,32,8,!1),this.A=gu[0]|0,this.B=gu[1]|0,this.C=gu[2]|0,this.D=gu[3]|0,this.E=gu[4]|0,this.F=gu[5]|0,this.G=gu[6]|0,this.H=gu[7]|0}get(){const{A:e,B:r,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,r,n,s,i,o,a,c]}set(e,r,n,s,i,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let d=0;d<16;d++,r+=4)vu[d]=e.getUint32(r,!1);for(let d=16;d<64;d++){const h=vu[d-15],f=vu[d-2],p=so(h,7)^so(h,18)^h>>>3,y=so(f,17)^so(f,19)^f>>>10;vu[d]=y+vu[d-7]+p+vu[d-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=so(a,6)^so(a,11)^so(a,25),f=u+h+YK(a,c,l)+t7[d]+vu[d]|0,y=(so(n,2)^so(n,13)^so(n,22))+QK(n,s,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=s,s=n,n=f+y|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,s,i,o,a,c,l,u)}roundClean(){vu.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const Sh=ZK(()=>new r7);var n7=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let yk=class{static digest(e){return n7(this,arguments,void 0,function*({data:r}){return Sh(r)})}},A_=class{};var i7=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let s7=class extends A_{digest(e){return i7(this,arguments,void 0,function*({algorithm:r,data:n}){switch(r){case"SHA-256":return yield yk.digest({data:n})}})}};function o7(t){const e=n=>{if(n!==null&&typeof n=="object"&&!Array.isArray(n)){const s=Object.keys(n).sort(),i={};for(const o of s)i[o]=e(n[o]);return i}return n},r=e(t);return JSON.stringify(r)}var a7=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};const h$="urn:jwk:";function Yr(t){return a7(this,arguments,void 0,function*({jwk:e}){const r=e.kty;let n;if(r==="EC")n={crv:e.crv,kty:e.kty,x:e.x,y:e.y};else if(r==="oct")n={k:e.k,kty:e.kty};else if(r==="OKP")n={crv:e.crv,kty:e.kty,x:e.x};else if(r==="RSA")n={e:e.e,kty:e.kty,n:e.n};else throw new Error(`Unsupported key type: ${r}`);fk(n);const s=o7(n),i=Vt.string(s).toUint8Array(),o=yield yk.digest({data:i});return Vt.uint8Array(o).toBase64Url()})}function Il(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="EC"||typeof t.d!="string"||typeof t.x!="string")}function S_(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t)||"d"in t||t.kty!=="EC"||typeof t.x!="string")}function Zp(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="OKP"||typeof t.d!="string"||typeof t.x!="string")}function mk(t){return!(!t||typeof t!="object"||"d"in t||!("kty"in t&&"crv"in t&&"x"in t)||t.kty!=="OKP"||typeof t.x!="string")}function u7(t){if(!t||typeof t!="object")return!1;switch(t.kty){case"EC":case"OKP":case"RSA":return"d"in t;case"oct":return"k"in t;default:return!1}}var vn=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},c7=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let rp=class yo{static adjustSignatureToLowS(e){return vn(this,arguments,void 0,function*({signature:r}){const n=qe.Signature.fromCompact(r);return n.hasHighS()?n.normalizeS().toCompactRawBytes():r})}static bytesToPrivateKey(e){return vn(this,arguments,void 0,function*({privateKeyBytes:r}){const n=yield yo.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"secp256k1",d:Vt.uint8Array(r).toBase64Url(),x:Vt.uint8Array(n.x).toBase64Url(),y:Vt.uint8Array(n.y).toBase64Url()};return s.kid=yield Yr({jwk:s}),s})}static bytesToPublicKey(e){return vn(this,arguments,void 0,function*({publicKeyBytes:r}){const n=yield yo.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"secp256k1",x:Vt.uint8Array(n.x).toBase64Url(),y:Vt.uint8Array(n.y).toBase64Url()};return s.kid=yield Yr({jwk:s}),s})}static compressPublicKey(e){return vn(this,arguments,void 0,function*({publicKeyBytes:r}){return qe.ProjectivePoint.fromHex(r).toRawBytes(!0)})}static computePublicKey(e){return vn(this,arguments,void 0,function*({key:r}){const n=yield yo.privateKeyToBytes({privateKey:r}),s=yield yo.getCurvePoint({keyBytes:n}),i={kty:"EC",crv:"secp256k1",x:Vt.uint8Array(s.x).toBase64Url(),y:Vt.uint8Array(s.y).toBase64Url()};return i.kid=yield Yr({jwk:i}),i})}static convertDerToCompactSignature(e){return vn(this,arguments,void 0,function*({derSignature:r}){return qe.Signature.fromDER(r).toCompactRawBytes()})}static decompressPublicKey(e){return vn(this,arguments,void 0,function*({publicKeyBytes:r}){return qe.ProjectivePoint.fromHex(r).toRawBytes(!1)})}static generateKey(){return vn(this,void 0,void 0,function*(){const e=qe.utils.randomPrivateKey(),r=yield yo.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Yr({jwk:r}),r})}static getPublicKey(e){return vn(this,arguments,void 0,function*({key:r}){var n;if(!(Il(r)&&r.crv==="secp256k1"))throw new Error("Secp256k1: The provided key is not a secp256k1 private JWK.");let s=c7(r,["d"]);return(n=s.kid)!==null&&n!==void 0||(s.kid=yield Yr({jwk:s})),s})}static privateKeyToBytes(e){return vn(this,arguments,void 0,function*({privateKey:r}){if(!Il(r))throw new Error("Secp256k1: The provided key is not a valid EC private key.");return Vt.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return vn(this,arguments,void 0,function*({publicKey:r}){if(!(S_(r)&&r.y))throw new Error("Secp256k1: The provided key is not a valid EC public key.");const n=new Uint8Array([4]),s=Vt.base64Url(r.x).toUint8Array(),i=Vt.base64Url(r.y).toUint8Array();return new Uint8Array([...n,...s,...i])})}static sharedSecret(e){return vn(this,arguments,void 0,function*({privateKeyA:r,publicKeyB:n}){if("x"in r&&"x"in n&&r.x===n.x)throw new Error("Secp256k1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const s=yield yo.privateKeyToBytes({privateKey:r}),i=yield yo.publicKeyToBytes({publicKey:n});return qe.getSharedSecret(s,i,!0).slice(1)})}static sign(e){return vn(this,arguments,void 0,function*({data:r,key:n}){const s=yield yo.privateKeyToBytes({privateKey:n}),i=Sh(r);return qe.sign(i,s).toCompactRawBytes()})}static validatePrivateKey(e){return vn(this,arguments,void 0,function*({privateKeyBytes:r}){return qe.utils.isValidPrivateKey(r)})}static validatePublicKey(e){return vn(this,arguments,void 0,function*({publicKeyBytes:r}){try{qe.ProjectivePoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return vn(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=yield yo.publicKeyToBytes({publicKey:r}),o=Sh(s);return qe.verify(n,o,i,{lowS:!1})})}static getCurvePoint(e){return vn(this,arguments,void 0,function*({keyBytes:r}){r.byteLength===32&&(r=qe.getPublicKey(r));const n=qe.ProjectivePoint.fromHex(r),s=fr(n.x,32),i=fr(n.y,32);return{x:s,y:i}})}};var wn=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},l7=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let np=class mo{static adjustSignatureToLowS(e){return wn(this,arguments,void 0,function*({signature:r}){const n=Ve.Signature.fromCompact(r);return n.hasHighS()?n.normalizeS().toCompactRawBytes():r})}static bytesToPrivateKey(e){return wn(this,arguments,void 0,function*({privateKeyBytes:r}){const n=yield mo.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"P-256",d:Vt.uint8Array(r).toBase64Url(),x:Vt.uint8Array(n.x).toBase64Url(),y:Vt.uint8Array(n.y).toBase64Url()};return s.kid=yield Yr({jwk:s}),s})}static bytesToPublicKey(e){return wn(this,arguments,void 0,function*({publicKeyBytes:r}){const n=yield mo.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"P-256",x:Vt.uint8Array(n.x).toBase64Url(),y:Vt.uint8Array(n.y).toBase64Url()};return s.kid=yield Yr({jwk:s}),s})}static compressPublicKey(e){return wn(this,arguments,void 0,function*({publicKeyBytes:r}){return Ve.ProjectivePoint.fromHex(r).toRawBytes(!0)})}static computePublicKey(e){return wn(this,arguments,void 0,function*({key:r}){const n=yield mo.privateKeyToBytes({privateKey:r}),s=yield mo.getCurvePoint({keyBytes:n}),i={kty:"EC",crv:"P-256",x:Vt.uint8Array(s.x).toBase64Url(),y:Vt.uint8Array(s.y).toBase64Url()};return i.kid=yield Yr({jwk:i}),i})}static convertDerToCompactSignature(e){return wn(this,arguments,void 0,function*({derSignature:r}){return Ve.Signature.fromDER(r).toCompactRawBytes()})}static decompressPublicKey(e){return wn(this,arguments,void 0,function*({publicKeyBytes:r}){return Ve.ProjectivePoint.fromHex(r).toRawBytes(!1)})}static generateKey(){return wn(this,void 0,void 0,function*(){const e=Ve.utils.randomPrivateKey(),r=yield mo.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Yr({jwk:r}),r})}static getPublicKey(e){return wn(this,arguments,void 0,function*({key:r}){var n;if(!(Il(r)&&r.crv==="P-256"))throw new Error("Secp256r1: The provided key is not a 'P-256' private JWK.");let s=l7(r,["d"]);return(n=s.kid)!==null&&n!==void 0||(s.kid=yield Yr({jwk:s})),s})}static privateKeyToBytes(e){return wn(this,arguments,void 0,function*({privateKey:r}){if(!Il(r))throw new Error("Secp256r1: The provided key is not a valid EC private key.");return Vt.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return wn(this,arguments,void 0,function*({publicKey:r}){if(!(S_(r)&&r.y))throw new Error("Secp256r1: The provided key is not a valid EC public key.");const n=new Uint8Array([4]),s=Vt.base64Url(r.x).toUint8Array(),i=Vt.base64Url(r.y).toUint8Array();return new Uint8Array([...n,...s,...i])})}static sharedSecret(e){return wn(this,arguments,void 0,function*({privateKeyA:r,publicKeyB:n}){if("x"in r&&"x"in n&&r.x===n.x)throw new Error("Secp256r1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const s=yield mo.privateKeyToBytes({privateKey:r}),i=yield mo.publicKeyToBytes({publicKey:n});return Ve.getSharedSecret(s,i,!0).slice(1)})}static sign(e){return wn(this,arguments,void 0,function*({data:r,key:n}){const s=yield mo.privateKeyToBytes({privateKey:n}),i=Sh(r);return Ve.sign(i,s).toCompactRawBytes()})}static validatePrivateKey(e){return wn(this,arguments,void 0,function*({privateKeyBytes:r}){return Ve.utils.isValidPrivateKey(r)})}static validatePublicKey(e){return wn(this,arguments,void 0,function*({publicKeyBytes:r}){try{Ve.ProjectivePoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return wn(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=yield mo.publicKeyToBytes({publicKey:r}),o=Sh(s);return Ve.verify(n,o,i,{lowS:!1})})}static getCurvePoint(e){return wn(this,arguments,void 0,function*({keyBytes:r}){r.byteLength===32&&(r=Ve.getPublicKey(r));const n=Ve.ProjectivePoint.fromHex(r),s=fr(n.x,32),i=fr(n.y,32);return{x:s,y:i}})}};var ip=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let y$=class extends A_{computePublicKey(e){return ip(this,arguments,void 0,function*({key:r}){if(!Il(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":{const n=yield rp.computePublicKey({key:r});return n.alg="ES256K",n}case"P-256":{const n=yield np.computePublicKey({key:r});return n.alg="ES256",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}generateKey(e){return ip(this,arguments,void 0,function*({algorithm:r}){switch(r){case"ES256K":case"secp256k1":{const n=yield rp.generateKey();return n.alg="ES256K",n}case"ES256":case"secp256r1":{const n=yield np.generateKey();return n.alg="ES256",n}}})}getPublicKey(e){return ip(this,arguments,void 0,function*({key:r}){if(!Il(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":{const n=yield rp.getPublicKey({key:r});return n.alg="ES256K",n}case"P-256":{const n=yield np.getPublicKey({key:r});return n.alg="ES256",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}sign(e){return ip(this,arguments,void 0,function*({key:r,data:n}){if(!Il(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":return yield rp.sign({key:r,data:n});case"P-256":return yield np.sign({key:r,data:n});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}verify(e){return ip(this,arguments,void 0,function*({key:r,signature:n,data:s}){if(!S_(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) public key.");switch(r.crv){case"secp256k1":return yield rp.verify({key:r,signature:n,data:s});case"P-256":return yield np.verify({key:r,signature:n,data:s});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}};var Gi=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},d7=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let sp=class Uu{static bytesToPrivateKey(e){return Gi(this,arguments,void 0,function*({privateKeyBytes:r}){const n=Ht.getPublicKey(r),s={crv:"Ed25519",d:Vt.uint8Array(r).toBase64Url(),kty:"OKP",x:Vt.uint8Array(n).toBase64Url()};return s.kid=yield Yr({jwk:s}),s})}static bytesToPublicKey(e){return Gi(this,arguments,void 0,function*({publicKeyBytes:r}){const n={kty:"OKP",crv:"Ed25519",x:Vt.uint8Array(r).toBase64Url()};return n.kid=yield Yr({jwk:n}),n})}static computePublicKey(e){return Gi(this,arguments,void 0,function*({key:r}){const n=yield Uu.privateKeyToBytes({privateKey:r}),s=Ht.getPublicKey(n),i={kty:"OKP",crv:"Ed25519",x:Vt.uint8Array(s).toBase64Url()};return i.kid=yield Yr({jwk:i}),i})}static convertPrivateKeyToX25519(e){return Gi(this,arguments,void 0,function*({privateKey:r}){const n=yield Uu.privateKeyToBytes({privateKey:r}),s=Zh(n),i=Tn.getPublicKey(s),o={kty:"OKP",crv:"X25519",d:Vt.uint8Array(s).toBase64Url(),x:Vt.uint8Array(i).toBase64Url()};return o.kid=yield Yr({jwk:o}),o})}static convertPublicKeyToX25519(e){return Gi(this,arguments,void 0,function*({publicKey:r}){const n=yield Uu.publicKeyToBytes({publicKey:r});if(!(yield Uu.validatePublicKey({publicKeyBytes:n})))throw new Error("Ed25519: Invalid public key.");const i=Gh(n),o={kty:"OKP",crv:"X25519",x:Vt.uint8Array(i).toBase64Url()};return o.kid=yield Yr({jwk:o}),o})}static generateKey(){return Gi(this,void 0,void 0,function*(){const e=Ht.utils.randomPrivateKey(),r=yield Uu.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield Yr({jwk:r}),r})}static getPublicKey(e){return Gi(this,arguments,void 0,function*({key:r}){var n;if(!(Zp(r)&&r.crv==="Ed25519"))throw new Error("Ed25519: The provided key is not an Ed25519 private JWK.");let s=d7(r,["d"]);return(n=s.kid)!==null&&n!==void 0||(s.kid=yield Yr({jwk:s})),s})}static privateKeyToBytes(e){return Gi(this,arguments,void 0,function*({privateKey:r}){if(!Zp(r))throw new Error("Ed25519: The provided key is not a valid OKP private key.");return Vt.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return Gi(this,arguments,void 0,function*({publicKey:r}){if(!mk(r))throw new Error("Ed25519: The provided key is not a valid OKP public key.");return Vt.base64Url(r.x).toUint8Array()})}static sign(e){return Gi(this,arguments,void 0,function*({key:r,data:n}){const s=yield Uu.privateKeyToBytes({privateKey:r});return Ht.sign(n,s)})}static validatePublicKey(e){return Gi(this,arguments,void 0,function*({publicKeyBytes:r}){try{Ht.ExtendedPoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return Gi(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=yield Uu.publicKeyToBytes({publicKey:r});return Ht.verify(n,s,i)})}};var op=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let f7=class extends A_{computePublicKey(e){return op(this,arguments,void 0,function*({key:r}){if(!Zp(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":{const n=yield sp.computePublicKey({key:r});return n.alg="EdDSA",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}generateKey(e){return op(this,arguments,void 0,function*({algorithm:r}){switch(r){case"Ed25519":{const n=yield sp.generateKey();return n.alg="EdDSA",n}}})}getPublicKey(e){return op(this,arguments,void 0,function*({key:r}){if(!Zp(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":{const n=yield sp.getPublicKey({key:r});return n.alg="EdDSA",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}sign(e){return op(this,arguments,void 0,function*({key:r,data:n}){if(!Zp(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":return yield sp.sign({key:r,data:n});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}verify(e){return op(this,arguments,void 0,function*({key:r,signature:n,data:s}){if(!mk(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) public key.");switch(r.crv){case"Ed25519":return yield sp.verify({key:r,signature:n,data:s});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}};var ya=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};const tw={Ed25519:{implementation:f7,names:["Ed25519"]},secp256k1:{implementation:y$,names:["ES256K","secp256k1"]},secp256r1:{implementation:y$,names:["ES256","secp256r1"]},"SHA-256":{implementation:s7,names:["SHA-256"]}};let p7=class{constructor(e){var r;this._algorithmInstances=new Map,this._keyStore=(r=e==null?void 0:e.keyStore)!==null&&r!==void 0?r:new VK}digest(e){return ya(this,arguments,void 0,function*({algorithm:r,data:n}){return yield this.getAlgorithm({algorithm:r}).digest({algorithm:r,data:n})})}exportKey(e){return ya(this,arguments,void 0,function*({keyUri:r}){return yield this.getPrivateKey({keyUri:r})})}generateKey(e){return ya(this,arguments,void 0,function*({algorithm:r}){const s=yield this.getAlgorithm({algorithm:r}).generateKey({algorithm:r});if((s==null?void 0:s.kid)===void 0)throw new Error("Generated key is missing a required property: kid");const i=`${h$}${s.kid}`;return yield this._keyStore.set(i,s),i})}getKeyUri(e){return ya(this,arguments,void 0,function*({key:r}){const n=yield Yr({jwk:r});return`${h$}${n}`})}getPublicKey(e){return ya(this,arguments,void 0,function*({keyUri:r}){const n=yield this.getPrivateKey({keyUri:r}),s=this.getAlgorithmName({key:n});return yield this.getAlgorithm({algorithm:s}).getPublicKey({key:n})})}importKey(e){return ya(this,arguments,void 0,function*({key:r}){var n;if(!u7(r))throw new TypeError("Invalid key provided. Must be a private key in JWK format.");const s=structuredClone(r);(n=s.kid)!==null&&n!==void 0||(s.kid=yield Yr({jwk:s}));const i=yield this.getKeyUri({key:s});return yield this._keyStore.set(i,s),i})}sign(e){return ya(this,arguments,void 0,function*({keyUri:r,data:n}){const s=yield this.getPrivateKey({keyUri:r}),i=this.getAlgorithmName({key:s});return this.getAlgorithm({algorithm:i}).sign({data:n,key:s})})}verify(e){return ya(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=this.getAlgorithmName({key:r});return this.getAlgorithm({algorithm:i}).verify({key:r,signature:n,data:s})})}getAlgorithm({algorithm:e}){var r;const n=(r=tw[e])===null||r===void 0?void 0:r.implementation;if(!n)throw new Error(`Algorithm not supported: ${e}`);return this._algorithmInstances.has(n)||this._algorithmInstances.set(n,new n),this._algorithmInstances.get(n)}getAlgorithmName({key:e}){const r=e.alg,n=e.crv;for(const s in tw){const i=tw[s];if(r&&i.names.includes(r))return s;if(n&&i.names.includes(n))return s}throw new Error(`Unable to determine algorithm based on provided input: alg=${r}, crv=${n}`)}getPrivateKey(e){return ya(this,arguments,void 0,function*({keyUri:r}){const n=yield this._keyStore.get(r);if(!n)throw new Error(`Key not found: ${r}`);return n})}};function h7(){return WK.randomUUID()}var $h;(function(t){t.authentication="authentication",t.assertionMethod="assertionMethod",t.keyAgreement="keyAgreement",t.capabilityInvocation="capabilityInvocation",t.capabilityDelegation="capabilityDelegation"})($h||($h={}));const Bn={"@context":"https://w3id.org/did-resolution/v1",didResolutionMetadata:{},didDocument:null,didDocumentMetadata:{}};let Jt=class gk{constructor({method:e,id:r,path:n,query:s,fragment:i,params:o}){this.uri=`did:${e}:${r}`,this.method=e,this.id=r,this.path=n,this.query=s,this.fragment=i,this.params=o}static parse(e){if(!e)return null;const r=gk.DID_URI_PATTERN.exec(e);if(!r||!r.groups)return null;const{method:n,id:s,path:i,query:o,fragment:a}=r.groups,c={uri:`did:${n}:${s}`,method:n,id:s};if(i&&(c.path=i),o&&(c.query=o.slice(1)),a&&(c.fragment=a.slice(1)),o){const l={},u=o.slice(1).split("&");for(const d of u){const[h,f]=d.split("=");l[h]=f}c.params=l}return c}};Jt.METHOD_PATTERN="([a-z0-9]+)";Jt.PCT_ENCODED_PATTERN="(?:%[0-9a-fA-F]{2})";Jt.ID_CHAR_PATTERN=`(?:[a-zA-Z0-9._-]|${Jt.PCT_ENCODED_PATTERN})`;Jt.METHOD_ID_PATTERN=`((?:${Jt.ID_CHAR_PATTERN}*:)*(${Jt.ID_CHAR_PATTERN}+))`;Jt.PATH_PATTERN="(/[^#?]*)?";Jt.QUERY_PATTERN="([?][^#]*)?";Jt.FRAGMENT_PATTERN="(#.*)?";Jt.DID_URI_PATTERN=new RegExp(`^did:(?<method>${Jt.METHOD_PATTERN}):(?<id>${Jt.METHOD_ID_PATTERN})(?<path>${Jt.PATH_PATTERN})(?<query>${Jt.QUERY_PATTERN})(?<fragment>${Jt.FRAGMENT_PATTERN})$`);let nt=class vk extends Error{constructor(e,r){super(`${e}: ${r}`),this.code=e,this.name="DidError",Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,vk)}};var Ge;(function(t){t.InvalidDid="invalidDid",t.MethodNotSupported="methodNotSupported",t.InternalError="internalError",t.InvalidDidDocument="invalidDidDocument",t.InvalidDidDocumentLength="invalidDidDocumentLength",t.InvalidDidUrl="invalidDidUrl",t.InvalidPreviousDidProof="invalidPreviousDidProof",t.InvalidPublicKey="invalidPublicKey",t.InvalidPublicKeyLength="invalidPublicKeyLength",t.InvalidPublicKeyType="invalidPublicKeyType",t.InvalidSignature="invalidSignature",t.NotFound="notFound",t.RepresentationNotSupported="representationNotSupported",t.UnsupportedPublicKeyType="unsupportedPublicKeyType"})(Ge||(Ge={}));function y7(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var y=0,b=0,w=0,g=p.length;w!==g&&p[w]===0;)w++,y++;for(var v=(g-w)*u+1>>>0,m=new Uint8Array(v);w!==g;){for(var _=p[w],x=0,D=v-1;(_!==0||x<b)&&D!==-1;D--,x++)_+=256*m[D]>>>0,m[D]=_%a>>>0,_=_/a>>>0;if(_!==0)throw new Error("Non-zero carry");b=x,w++}for(var E=v-b;E!==v&&m[E]===0;)E++;for(var A=c.repeat(y);E<v;++E)A+=t.charAt(m[E]);return A}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var y=0;if(p[y]!==" "){for(var b=0,w=0;p[y]===c;)b++,y++;for(var g=(p.length-y)*l+1>>>0,v=new Uint8Array(g);p[y];){var m=r[p.charCodeAt(y)];if(m===255)return;for(var _=0,x=g-1;(m!==0||_<w)&&x!==-1;x--,_++)m+=a*v[x]>>>0,v[x]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");w=_,y++}if(p[y]!==" "){for(var D=g-w;D!==g&&v[D]===0;)D++;for(var E=new Uint8Array(b+(g-D)),A=b;D!==g;)E[A++]=v[D++];return E}}}function f(p){var y=h(p);if(y)return y;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var m7=y7,g7=m7;const v7=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};let w7=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},b7=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return wk(this,e)}},_7=class{constructor(e){this.decoders=e}or(e){return wk(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const wk=(t,e)=>new _7({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let E7=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new w7(e,r,n),this.decoder=new b7(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const bk=({name:t,prefix:e,encode:r,decode:n})=>new E7(t,e,r,n),_k=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:s}=g7(r,e);return bk({prefix:t,name:e,encode:n,decode:i=>v7(s(i))})},A7=(t,e,r,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},S7=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},Ki=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>bk({prefix:e,name:t,encode(s){return S7(s,n,r)},decode(s){return A7(s,n,r,t)}});Ki({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});Ki({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});Ki({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});Ki({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});Ki({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});Ki({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});Ki({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});Ki({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});const m$=Ki({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),nm=_k({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});_k({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});Ki({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});Ki({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const ma=Ki({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});Ki({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function $7(t){return t.byteOffset!==0||t.byteLength!==t.buffer.byteLength}function x7(t){return typeof t!="object"||t===null?!1:typeof t[Symbol.asyncIterator]=="function"}function Mb(t){const r=Object.prototype.toString.call(t).match(/\s([a-zA-Z0-9]+)/),[n,s]=r;return s}var ap=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},g$=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}};const im=new TextEncoder,Gc=new TextDecoder;let ct=class ui{constructor(e,r){this.data=e,this.format=r}static arrayBuffer(e){return new ui(e,"ArrayBuffer")}static asyncIterable(e){if(!x7(e))throw new TypeError("Input must be of type AsyncIterable.");return new ui(e,"AsyncIterable")}static base32Z(e){return new ui(e,"Base32Z")}static base58Btc(e){return new ui(e,"Base58Btc")}static base64Url(e){return new ui(e,"Base64Url")}static bufferSource(e){return new ui(e,"BufferSource")}static hex(e){if(typeof e!="string")throw new TypeError("Hex input must be a string.");if(e.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new ui(e,"Hex")}static multibase(e){return new ui(e,"Multibase")}static object(e){return new ui(e,"Object")}static string(e){return new ui(e,"String")}static uint8Array(e){return new ui(e,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return nm.baseDecode(this.data).buffer;case"Base64Url":return ma.baseDecode(this.data).buffer;case"BufferSource":{if(Mb(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return $7(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return ap(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return m$.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return nm.baseEncode(e)}case"Multibase":return this.data.substring(1);case"Uint8Array":return nm.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return ma.baseEncode(e)}case"BufferSource":{const e=this.toUint8Array();return ma.baseEncode(e)}case"Object":{const e=JSON.stringify(this.data),r=im.encode(e);return ma.baseEncode(r)}case"String":{const e=im.encode(this.data);return ma.baseEncode(e)}case"Uint8Array":return ma.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){var e,r,n,s;return ap(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const c=[];try{for(var i=!0,o=g$(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const u=s;c.push(u)}}catch(u){r={error:u}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return new Blob(c)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){const e=Array.from({length:256},(r,n)=>n.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{const r=this.toUint8Array();return ui.uint8Array(r).toHex()}case"Base64Url":{const r=this.toUint8Array();return ui.uint8Array(r).toHex()}case"Uint8Array":{let r="";for(let n=0;n<this.data.length;n++)r+=e[this.data[n]];return r}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{const e=ma.baseDecode(this.data),r=Gc.decode(e);return JSON.parse(r)}case"String":return JSON.parse(this.data);case"Uint8Array":{const e=Gc.decode(this.data);return JSON.parse(e)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return ap(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toStringAsync();return JSON.parse(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return Gc.decode(this.data);case"Base64Url":{const e=ma.baseDecode(this.data);return Gc.decode(e)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return Gc.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){var e,r,n,s;return ap(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let c="";try{for(var i=!0,o=g$(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const l=s;typeof l=="string"?c+=l:c+=Gc.decode(l,{stream:!0})}}catch(l){r={error:l}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return c+=Gc.decode(void 0,{stream:!1}),c}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return m$.baseDecode(this.data);case"Base58Btc":return nm.baseDecode(this.data);case"Base64Url":return ma.baseDecode(this.data);case"BufferSource":{const e=Mb(this.data);if(e==="Uint8Array")return this.data;if(e==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{const e=new Uint8Array(this.data.length/2);for(let r=0;r<this.data.length;r+=2){const n=parseInt(this.data.substring(r,r+2),16);if(isNaN(n))throw new TypeError("Input is not a valid hexadecimal string.");e[r/2]=n}return e}case"Object":{const e=JSON.stringify(this.data);return im.encode(e)}case"String":return im.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return ap(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toArrayBufferAsync();return new Uint8Array(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}};var D7=Ek,v$=128,P7=127,C7=~P7,k7=Math.pow(2,31);function Ek(t,e,r){e=e||[],r=r||0;for(var n=r;t>=k7;)e[r++]=t&255|v$,t/=128;for(;t&C7;)e[r++]=t&255|v$,t>>>=7;return e[r]=t|0,Ek.bytes=r-n+1,e}var O7=Ub,T7=128,w$=127;function Ub(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw Ub.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&w$)<<s:(o&w$)*Math.pow(2,s),s+=7}while(o>=T7);return Ub.bytes=i-n,r}var I7=Math.pow(2,7),B7=Math.pow(2,14),F7=Math.pow(2,21),N7=Math.pow(2,28),R7=Math.pow(2,35),j7=Math.pow(2,42),M7=Math.pow(2,49),U7=Math.pow(2,56),K7=Math.pow(2,63),L7=function(t){return t<I7?1:t<B7?2:t<F7?3:t<N7?4:t<R7?5:t<j7?6:t<M7?7:t<U7?8:t<K7?9:10},q7={encode:D7,decode:O7,encodingLength:L7},F0=q7;const b$=(t,e=0)=>[F0.decode(t,e),F0.decode.bytes],V7=(t,e,r=0)=>(F0.encode(t,e,r),e),z7=t=>F0.encodingLength(t);let ws=class Ku{static addPrefix(e){var r;let{code:n,data:s,name:i}=e;if(!(i?!n:n))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(n=Ku.codeToName.has(n)?n:Ku.nameToCode.get(i),n===void 0)throw new Error(`Unsupported multicodec: ${(r=e.name)!==null&&r!==void 0?r:e.code}`);const o=z7(n),a=new Uint8Array(o+s.byteLength);return a.set(s,o),V7(n,a),a}static getCodeFromData(e){const{prefixedData:r}=e,[n,s]=b$(r);return n}static getCodeFromName(e){const{name:r}=e,n=Ku.nameToCode.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static getNameFromCode(e){const{code:r}=e,n=Ku.codeToName.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static registerCodec(e){Ku.codeToName.set(e.code,e.name),Ku.nameToCode.set(e.name,e.code)}static removePrefix(e){const{prefixedData:r}=e,[n,s]=b$(r),i=Ku.codeToName.get(n);if(i===void 0)throw new Error(`Unsupported multicodec: ${n}`);return{code:n,data:r.slice(s),name:i}}};ws.codeToName=new Map;ws.nameToCode=new Map;ws.registerCodec({code:237,name:"ed25519-pub"});ws.registerCodec({code:4864,name:"ed25519-priv"});ws.registerCodec({code:236,name:"x25519-pub"});ws.registerCodec({code:4866,name:"x25519-priv"});ws.registerCodec({code:231,name:"secp256k1-pub"});ws.registerCodec({code:4865,name:"secp256k1-priv"});function Ak(t){Object.keys(t).forEach(e=>{t[e]===void 0?delete t[e]:typeof t[e]=="object"&&Ak(t[e])})}var Zc=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let H7=class{constructor(){this.store=new Map}clear(){return Zc(this,void 0,void 0,function*(){this.store.clear()})}close(){return Zc(this,void 0,void 0,function*(){})}delete(e){return Zc(this,void 0,void 0,function*(){return this.store.delete(e)})}get(e){return Zc(this,void 0,void 0,function*(){return this.store.get(e)})}has(e){return Zc(this,void 0,void 0,function*(){return this.store.has(e)})}list(){return Zc(this,void 0,void 0,function*(){return Array.from(this.store.values())})}set(e,r){return Zc(this,void 0,void 0,function*(){this.store.set(e,r)})}};function W7(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function J7(t,...e){if(!W7(t))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function _$(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function G7(t,e){J7(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Z7(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}const rw=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),oo=(t,e)=>t<<32-e|t>>>e,X7=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!X7)throw new Error("Non little-endian hardware is not supported");function Y7(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Sk(t){if(typeof t=="string"&&(t=Y7(t)),!Z7(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}let Q7=class{clone(){return this._cloneInto()}};function eL(t){const e=n=>t().update(Sk(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function tL(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),c=n?4:0,l=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+l,a,n)}class rL extends Q7{constructor(e,r,n,s){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=rw(this.buffer)}update(e){_$(this);const{view:r,buffer:n,blockLen:s}=this;e=Sk(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=rw(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){_$(this),G7(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)r[d]=0;tL(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=rw(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%r&&e.buffer.set(n),e}}const nL=(t,e,r)=>t&e^~t&r,iL=(t,e,r)=>t&e^t&r^e&r,sL=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),wu=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),bu=new Uint32Array(64);let oL=class extends rL{constructor(){super(64,32,8,!1),this.A=wu[0]|0,this.B=wu[1]|0,this.C=wu[2]|0,this.D=wu[3]|0,this.E=wu[4]|0,this.F=wu[5]|0,this.G=wu[6]|0,this.H=wu[7]|0}get(){const{A:e,B:r,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,r,n,s,i,o,a,c]}set(e,r,n,s,i,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let d=0;d<16;d++,r+=4)bu[d]=e.getUint32(r,!1);for(let d=16;d<64;d++){const h=bu[d-15],f=bu[d-2],p=oo(h,7)^oo(h,18)^h>>>3,y=oo(f,17)^oo(f,19)^f>>>10;bu[d]=y+bu[d-7]+p+bu[d-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=oo(a,6)^oo(a,11)^oo(a,25),f=u+h+nL(a,c,l)+sL[d]+bu[d]|0,y=(oo(n,2)^oo(n,13)^oo(n,22))+iL(n,s,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=s,s=n,n=f+y|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,s,i,o,a,c,l,u)}roundClean(){bu.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const xh=eL(()=>new oL);var aL=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let $k=class{static digest({data:e}){return aL(this,void 0,void 0,function*(){return xh(e)})}},$_=class{};var uL=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let cL=class extends $_{digest({algorithm:e,data:r}){return uL(this,void 0,void 0,function*(){switch(e){case"SHA-256":return yield $k.digest({data:r})}})}};function lL(t){const e=n=>{if(n!==null&&typeof n=="object"&&!Array.isArray(n)){const s=Object.keys(n).sort(),i={};for(const o of s)i[o]=e(n[o]);return i}return n},r=e(t);return JSON.stringify(r)}var dL=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};const E$="urn:jwk:";function rr({jwk:t}){return dL(this,void 0,void 0,function*(){const e=t.kty;let r;if(e==="EC")r={crv:t.crv,kty:t.kty,x:t.x,y:t.y};else if(e==="oct")r={k:t.k,kty:t.kty};else if(e==="OKP")r={crv:t.crv,kty:t.kty,x:t.x};else if(e==="RSA")r={e:t.e,kty:t.kty,n:t.n};else throw new Error(`Unsupported key type: ${e}`);Ak(r);const n=lL(r),s=ct.string(n).toUint8Array(),i=yield $k.digest({data:s});return ct.uint8Array(i).toBase64Url()})}function Bl(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="EC"||typeof t.d!="string"||typeof t.x!="string")}function x_(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t)||"d"in t||t.kty!=="EC"||typeof t.x!="string")}function Fl(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="OKP"||typeof t.d!="string"||typeof t.x!="string")}function D_(t){return!(!t||typeof t!="object"||"d"in t||!("kty"in t&&"crv"in t&&"x"in t)||t.kty!=="OKP"||typeof t.x!="string")}function fL(t){if(!t||typeof t!="object")return!1;switch(t.kty){case"EC":case"OKP":case"RSA":return"d"in t;case"oct":return"k"in t;default:return!1}}var bn=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},pL=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let Bi=class go{static adjustSignatureToLowS({signature:e}){return bn(this,void 0,void 0,function*(){const r=qe.Signature.fromCompact(e);return r.hasHighS()?r.normalizeS().toCompactRawBytes():e})}static bytesToPrivateKey({privateKeyBytes:e}){return bn(this,void 0,void 0,function*(){const r=yield go.getCurvePoint({keyBytes:e}),n={kty:"EC",crv:"secp256k1",d:ct.uint8Array(e).toBase64Url(),x:ct.uint8Array(r.x).toBase64Url(),y:ct.uint8Array(r.y).toBase64Url()};return n.kid=yield rr({jwk:n}),n})}static bytesToPublicKey({publicKeyBytes:e}){return bn(this,void 0,void 0,function*(){const r=yield go.getCurvePoint({keyBytes:e}),n={kty:"EC",crv:"secp256k1",x:ct.uint8Array(r.x).toBase64Url(),y:ct.uint8Array(r.y).toBase64Url()};return n.kid=yield rr({jwk:n}),n})}static compressPublicKey({publicKeyBytes:e}){return bn(this,void 0,void 0,function*(){return qe.ProjectivePoint.fromHex(e).toRawBytes(!0)})}static computePublicKey({key:e}){return bn(this,void 0,void 0,function*(){const r=yield go.privateKeyToBytes({privateKey:e}),n=yield go.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"secp256k1",x:ct.uint8Array(n.x).toBase64Url(),y:ct.uint8Array(n.y).toBase64Url()};return s.kid=yield rr({jwk:s}),s})}static convertDerToCompactSignature({derSignature:e}){return bn(this,void 0,void 0,function*(){return qe.Signature.fromDER(e).toCompactRawBytes()})}static decompressPublicKey({publicKeyBytes:e}){return bn(this,void 0,void 0,function*(){return qe.ProjectivePoint.fromHex(e).toRawBytes(!1)})}static generateKey(){return bn(this,void 0,void 0,function*(){const e=qe.utils.randomPrivateKey(),r=yield go.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield rr({jwk:r}),r})}static getPublicKey({key:e}){var r;return bn(this,void 0,void 0,function*(){if(!(Bl(e)&&e.crv==="secp256k1"))throw new Error("Secp256k1: The provided key is not a secp256k1 private JWK.");let n=pL(e,["d"]);return(r=n.kid)!==null&&r!==void 0||(n.kid=yield rr({jwk:n})),n})}static privateKeyToBytes({privateKey:e}){return bn(this,void 0,void 0,function*(){if(!Bl(e))throw new Error("Secp256k1: The provided key is not a valid EC private key.");return ct.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return bn(this,void 0,void 0,function*(){if(!(x_(e)&&e.y))throw new Error("Secp256k1: The provided key is not a valid EC public key.");const r=new Uint8Array([4]),n=ct.base64Url(e.x).toUint8Array(),s=ct.base64Url(e.y).toUint8Array();return new Uint8Array([...r,...n,...s])})}static sharedSecret({privateKeyA:e,publicKeyB:r}){return bn(this,void 0,void 0,function*(){if("x"in e&&"x"in r&&e.x===r.x)throw new Error("Secp256k1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const n=yield go.privateKeyToBytes({privateKey:e}),s=yield go.publicKeyToBytes({publicKey:r});return qe.getSharedSecret(n,s,!0).slice(1)})}static sign({data:e,key:r}){return bn(this,void 0,void 0,function*(){const n=yield go.privateKeyToBytes({privateKey:r}),s=xh(e);return qe.sign(s,n).toCompactRawBytes()})}static validatePrivateKey({privateKeyBytes:e}){return bn(this,void 0,void 0,function*(){return qe.utils.isValidPrivateKey(e)})}static validatePublicKey({publicKeyBytes:e}){return bn(this,void 0,void 0,function*(){try{qe.ProjectivePoint.fromHex(e).assertValidity()}catch{return!1}return!0})}static verify({key:e,signature:r,data:n}){return bn(this,void 0,void 0,function*(){const s=yield go.publicKeyToBytes({publicKey:e}),i=xh(n);return qe.verify(r,i,s,{lowS:!1})})}static getCurvePoint({keyBytes:e}){return bn(this,void 0,void 0,function*(){e.byteLength===32&&(e=qe.getPublicKey(e));const r=qe.ProjectivePoint.fromHex(e),n=fr(r.x,32),s=fr(r.y,32);return{x:n,y:s}})}};var _n=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},hL=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let ps=class vo{static adjustSignatureToLowS({signature:e}){return _n(this,void 0,void 0,function*(){const r=Ve.Signature.fromCompact(e);return r.hasHighS()?r.normalizeS().toCompactRawBytes():e})}static bytesToPrivateKey({privateKeyBytes:e}){return _n(this,void 0,void 0,function*(){const r=yield vo.getCurvePoint({keyBytes:e}),n={kty:"EC",crv:"P-256",d:ct.uint8Array(e).toBase64Url(),x:ct.uint8Array(r.x).toBase64Url(),y:ct.uint8Array(r.y).toBase64Url()};return n.kid=yield rr({jwk:n}),n})}static bytesToPublicKey({publicKeyBytes:e}){return _n(this,void 0,void 0,function*(){const r=yield vo.getCurvePoint({keyBytes:e}),n={kty:"EC",crv:"P-256",x:ct.uint8Array(r.x).toBase64Url(),y:ct.uint8Array(r.y).toBase64Url()};return n.kid=yield rr({jwk:n}),n})}static compressPublicKey({publicKeyBytes:e}){return _n(this,void 0,void 0,function*(){return Ve.ProjectivePoint.fromHex(e).toRawBytes(!0)})}static computePublicKey({key:e}){return _n(this,void 0,void 0,function*(){const r=yield vo.privateKeyToBytes({privateKey:e}),n=yield vo.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"P-256",x:ct.uint8Array(n.x).toBase64Url(),y:ct.uint8Array(n.y).toBase64Url()};return s.kid=yield rr({jwk:s}),s})}static convertDerToCompactSignature({derSignature:e}){return _n(this,void 0,void 0,function*(){return Ve.Signature.fromDER(e).toCompactRawBytes()})}static decompressPublicKey({publicKeyBytes:e}){return _n(this,void 0,void 0,function*(){return Ve.ProjectivePoint.fromHex(e).toRawBytes(!1)})}static generateKey(){return _n(this,void 0,void 0,function*(){const e=Ve.utils.randomPrivateKey(),r=yield vo.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield rr({jwk:r}),r})}static getPublicKey({key:e}){var r;return _n(this,void 0,void 0,function*(){if(!(Bl(e)&&e.crv==="P-256"))throw new Error("Secp256r1: The provided key is not a 'P-256' private JWK.");let n=hL(e,["d"]);return(r=n.kid)!==null&&r!==void 0||(n.kid=yield rr({jwk:n})),n})}static privateKeyToBytes({privateKey:e}){return _n(this,void 0,void 0,function*(){if(!Bl(e))throw new Error("Secp256r1: The provided key is not a valid EC private key.");return ct.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return _n(this,void 0,void 0,function*(){if(!(x_(e)&&e.y))throw new Error("Secp256r1: The provided key is not a valid EC public key.");const r=new Uint8Array([4]),n=ct.base64Url(e.x).toUint8Array(),s=ct.base64Url(e.y).toUint8Array();return new Uint8Array([...r,...n,...s])})}static sharedSecret({privateKeyA:e,publicKeyB:r}){return _n(this,void 0,void 0,function*(){if("x"in e&&"x"in r&&e.x===r.x)throw new Error("Secp256r1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const n=yield vo.privateKeyToBytes({privateKey:e}),s=yield vo.publicKeyToBytes({publicKey:r});return Ve.getSharedSecret(n,s,!0).slice(1)})}static sign({data:e,key:r}){return _n(this,void 0,void 0,function*(){const n=yield vo.privateKeyToBytes({privateKey:r}),s=xh(e);return Ve.sign(s,n).toCompactRawBytes()})}static validatePrivateKey({privateKeyBytes:e}){return _n(this,void 0,void 0,function*(){return Ve.utils.isValidPrivateKey(e)})}static validatePublicKey({publicKeyBytes:e}){return _n(this,void 0,void 0,function*(){try{Ve.ProjectivePoint.fromHex(e).assertValidity()}catch{return!1}return!0})}static verify({key:e,signature:r,data:n}){return _n(this,void 0,void 0,function*(){const s=yield vo.publicKeyToBytes({publicKey:e}),i=xh(n);return Ve.verify(r,i,s,{lowS:!1})})}static getCurvePoint({keyBytes:e}){return _n(this,void 0,void 0,function*(){e.byteLength===32&&(e=Ve.getPublicKey(e));const r=Ve.ProjectivePoint.fromHex(e),n=fr(r.x,32),s=fr(r.y,32);return{x:n,y:s}})}};var up=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let A$=class extends $_{computePublicKey({key:e}){return up(this,void 0,void 0,function*(){if(!Bl(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(e.crv){case"secp256k1":{const r=yield Bi.computePublicKey({key:e});return r.alg="ES256K",r}case"P-256":{const r=yield ps.computePublicKey({key:e});return r.alg="ES256",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}generateKey({algorithm:e}){return up(this,void 0,void 0,function*(){switch(e){case"ES256K":case"secp256k1":{const r=yield Bi.generateKey();return r.alg="ES256K",r}case"ES256":case"secp256r1":{const r=yield ps.generateKey();return r.alg="ES256",r}}})}getPublicKey({key:e}){return up(this,void 0,void 0,function*(){if(!Bl(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(e.crv){case"secp256k1":{const r=yield Bi.getPublicKey({key:e});return r.alg="ES256K",r}case"P-256":{const r=yield ps.getPublicKey({key:e});return r.alg="ES256",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}sign({key:e,data:r}){return up(this,void 0,void 0,function*(){if(!Bl(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(e.crv){case"secp256k1":return yield Bi.sign({key:e,data:r});case"P-256":return yield ps.sign({key:e,data:r});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}verify({key:e,signature:r,data:n}){return up(this,void 0,void 0,function*(){if(!x_(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) public key.");switch(e.crv){case"secp256k1":return yield Bi.verify({key:e,signature:r,data:n});case"P-256":return yield ps.verify({key:e,signature:r,data:n});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}};var Zi=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},yL=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let mi=class Lu{static bytesToPrivateKey({privateKeyBytes:e}){return Zi(this,void 0,void 0,function*(){const r=Ht.getPublicKey(e),n={crv:"Ed25519",d:ct.uint8Array(e).toBase64Url(),kty:"OKP",x:ct.uint8Array(r).toBase64Url()};return n.kid=yield rr({jwk:n}),n})}static bytesToPublicKey({publicKeyBytes:e}){return Zi(this,void 0,void 0,function*(){const r={kty:"OKP",crv:"Ed25519",x:ct.uint8Array(e).toBase64Url()};return r.kid=yield rr({jwk:r}),r})}static computePublicKey({key:e}){return Zi(this,void 0,void 0,function*(){const r=yield Lu.privateKeyToBytes({privateKey:e}),n=Ht.getPublicKey(r),s={kty:"OKP",crv:"Ed25519",x:ct.uint8Array(n).toBase64Url()};return s.kid=yield rr({jwk:s}),s})}static convertPrivateKeyToX25519({privateKey:e}){return Zi(this,void 0,void 0,function*(){const r=yield Lu.privateKeyToBytes({privateKey:e}),n=Zh(r),s=Tn.getPublicKey(n),i={kty:"OKP",crv:"X25519",d:ct.uint8Array(n).toBase64Url(),x:ct.uint8Array(s).toBase64Url()};return i.kid=yield rr({jwk:i}),i})}static convertPublicKeyToX25519({publicKey:e}){return Zi(this,void 0,void 0,function*(){const r=yield Lu.publicKeyToBytes({publicKey:e});if(!(yield Lu.validatePublicKey({publicKeyBytes:r})))throw new Error("Ed25519: Invalid public key.");const s=Gh(r),i={kty:"OKP",crv:"X25519",x:ct.uint8Array(s).toBase64Url()};return i.kid=yield rr({jwk:i}),i})}static generateKey(){return Zi(this,void 0,void 0,function*(){const e=Ht.utils.randomPrivateKey(),r=yield Lu.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield rr({jwk:r}),r})}static getPublicKey({key:e}){var r;return Zi(this,void 0,void 0,function*(){if(!(Fl(e)&&e.crv==="Ed25519"))throw new Error("Ed25519: The provided key is not an Ed25519 private JWK.");let n=yL(e,["d"]);return(r=n.kid)!==null&&r!==void 0||(n.kid=yield rr({jwk:n})),n})}static privateKeyToBytes({privateKey:e}){return Zi(this,void 0,void 0,function*(){if(!Fl(e))throw new Error("Ed25519: The provided key is not a valid OKP private key.");return ct.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return Zi(this,void 0,void 0,function*(){if(!D_(e))throw new Error("Ed25519: The provided key is not a valid OKP public key.");return ct.base64Url(e.x).toUint8Array()})}static sign({key:e,data:r}){return Zi(this,void 0,void 0,function*(){const n=yield Lu.privateKeyToBytes({privateKey:e});return Ht.sign(r,n)})}static validatePublicKey({publicKeyBytes:e}){return Zi(this,void 0,void 0,function*(){try{Ht.ExtendedPoint.fromHex(e).assertValidity()}catch{return!1}return!0})}static verify({key:e,signature:r,data:n}){return Zi(this,void 0,void 0,function*(){const s=yield Lu.publicKeyToBytes({publicKey:e});return Ht.verify(r,n,s)})}};var cp=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let mL=class extends $_{computePublicKey({key:e}){return cp(this,void 0,void 0,function*(){if(!Fl(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(e.crv){case"Ed25519":{const r=yield mi.computePublicKey({key:e});return r.alg="EdDSA",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}generateKey({algorithm:e}){return cp(this,void 0,void 0,function*(){switch(e){case"Ed25519":{const r=yield mi.generateKey();return r.alg="EdDSA",r}}})}getPublicKey({key:e}){return cp(this,void 0,void 0,function*(){if(!Fl(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(e.crv){case"Ed25519":{const r=yield mi.getPublicKey({key:e});return r.alg="EdDSA",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}sign({key:e,data:r}){return cp(this,void 0,void 0,function*(){if(!Fl(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(e.crv){case"Ed25519":return yield mi.sign({key:e,data:r});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}verify({key:e,signature:r,data:n}){return cp(this,void 0,void 0,function*(){if(!D_(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) public key.");switch(e.crv){case"Ed25519":return yield mi.verify({key:e,signature:r,data:n});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}};var ga=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};const nw={Ed25519:{implementation:mL,names:["Ed25519"]},secp256k1:{implementation:A$,names:["ES256K","secp256k1"]},secp256r1:{implementation:A$,names:["ES256","secp256r1"]},"SHA-256":{implementation:cL,names:["SHA-256"]}};let Ga=class{constructor(e){var r;this._algorithmInstances=new Map,this._keyStore=(r=e==null?void 0:e.keyStore)!==null&&r!==void 0?r:new H7}digest({algorithm:e,data:r}){return ga(this,void 0,void 0,function*(){return yield this.getAlgorithm({algorithm:e}).digest({algorithm:e,data:r})})}exportKey({keyUri:e}){return ga(this,void 0,void 0,function*(){return yield this.getPrivateKey({keyUri:e})})}generateKey({algorithm:e}){return ga(this,void 0,void 0,function*(){const n=yield this.getAlgorithm({algorithm:e}).generateKey({algorithm:e});if((n==null?void 0:n.kid)===void 0)throw new Error("Generated key is missing a required property: kid");const s=`${E$}${n.kid}`;return yield this._keyStore.set(s,n),s})}getKeyUri({key:e}){return ga(this,void 0,void 0,function*(){const r=yield rr({jwk:e});return`${E$}${r}`})}getPublicKey({keyUri:e}){return ga(this,void 0,void 0,function*(){const r=yield this.getPrivateKey({keyUri:e}),n=this.getAlgorithmName({key:r});return yield this.getAlgorithm({algorithm:n}).getPublicKey({key:r})})}importKey({key:e}){var r;return ga(this,void 0,void 0,function*(){if(!fL(e))throw new TypeError("Invalid key provided. Must be a private key in JWK format.");const n=structuredClone(e);(r=n.kid)!==null&&r!==void 0||(n.kid=yield rr({jwk:n}));const s=yield this.getKeyUri({key:n});return yield this._keyStore.set(s,n),s})}sign({keyUri:e,data:r}){return ga(this,void 0,void 0,function*(){const n=yield this.getPrivateKey({keyUri:e}),s=this.getAlgorithmName({key:n});return this.getAlgorithm({algorithm:s}).sign({data:r,key:n})})}verify({key:e,signature:r,data:n}){return ga(this,void 0,void 0,function*(){const s=this.getAlgorithmName({key:e});return this.getAlgorithm({algorithm:s}).verify({key:e,signature:r,data:n})})}getAlgorithm({algorithm:e}){var r;const n=(r=nw[e])===null||r===void 0?void 0:r.implementation;if(!n)throw new Error(`Algorithm not supported: ${e}`);return this._algorithmInstances.has(n)||this._algorithmInstances.set(n,new n),this._algorithmInstances.get(n)}getAlgorithmName({key:e}){const r=e.alg,n=e.crv;for(const s in nw){const i=nw[s];if(r&&i.names.includes(r))return s;if(n&&i.names.includes(n))return s}throw new Error(`Unable to determine algorithm based on provided input: alg=${r}, crv=${n}`)}getPrivateKey({keyUri:e}){return ga(this,void 0,void 0,function*(){const r=yield this._keyStore.get(e);if(!r)throw new Error(`Key not found: ${e}`);return r})}};function gL(t){const e={Ed25519:"EdDSA","P-256":"ES256","P-384":"ES384","P-521":"ES512",secp256k1:"ES256K"};if(t.alg&&Object.values(e).includes(t.alg))return t.alg;if(t.crv&&Object.keys(e).includes(t.crv))return e[t.crv];throw new Error(`Unable to determine algorithm based on provided input: alg=${t.alg}, crv=${t.crv}. Supported 'alg' values: ${Object.values(e).join(", ")}. Supported 'crv' values: ${Object.keys(e).join(", ")}.`)}var _u=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},vL=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};let xk=class Up{static bytesToPrivateKey({privateKeyBytes:e}){return _u(this,void 0,void 0,function*(){const r=Tn.getPublicKey(e),n={kty:"OKP",crv:"X25519",d:ct.uint8Array(e).toBase64Url(),x:ct.uint8Array(r).toBase64Url()};return n.kid=yield rr({jwk:n}),n})}static bytesToPublicKey({publicKeyBytes:e}){return _u(this,void 0,void 0,function*(){const r={kty:"OKP",crv:"X25519",x:ct.uint8Array(e).toBase64Url()};return r.kid=yield rr({jwk:r}),r})}static computePublicKey({key:e}){return _u(this,void 0,void 0,function*(){const r=yield Up.privateKeyToBytes({privateKey:e}),n=Tn.getPublicKey(r),s={kty:"OKP",crv:"X25519",x:ct.uint8Array(n).toBase64Url()};return s.kid=yield rr({jwk:s}),s})}static generateKey(){return _u(this,void 0,void 0,function*(){const e=Tn.utils.randomPrivateKey(),r=yield Up.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield rr({jwk:r}),r})}static getPublicKey({key:e}){var r;return _u(this,void 0,void 0,function*(){if(!(Fl(e)&&e.crv==="X25519"))throw new Error("X25519: The provided key is not an X25519 private JWK.");let n=vL(e,["d"]);return(r=n.kid)!==null&&r!==void 0||(n.kid=yield rr({jwk:n})),n})}static privateKeyToBytes({privateKey:e}){return _u(this,void 0,void 0,function*(){if(!Fl(e))throw new Error("X25519: The provided key is not a valid OKP private key.");return ct.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return _u(this,void 0,void 0,function*(){if(!D_(e))throw new Error("X25519: The provided key is not a valid OKP public key.");return ct.base64Url(e.x).toUint8Array()})}static sharedSecret({privateKeyA:e,publicKeyB:r}){return _u(this,void 0,void 0,function*(){if("x"in e&&"x"in r&&e.x===r.x)throw new Error("X25519: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const n=yield Up.privateKeyToBytes({privateKey:e}),s=yield Up.publicKeyToBytes({publicKey:r});return Tn.getSharedSecret(n,s)})}};function Ls(t){if(typeof t=="string"&&t.length!==0)return t.split("#").pop()}function Dk({didDocument:t}){var e,r;if(!t)throw new TypeError("Required parameter missing: 'didDocument'");const n=[];return n.push(...(r=(e=t.verificationMethod)===null||e===void 0?void 0:e.filter(N0))!==null&&r!==void 0?r:[]),Object.keys($h).forEach(s=>{var i,o;n.push(...(o=(i=t[s])===null||i===void 0?void 0:i.filter(N0))!==null&&o!==void 0?o:[])}),n}function wL({didDocument:t}){const r=Dk({didDocument:t}).map(n=>n.type);return[...new Set(r)]}function bL({didDocument:t,methodId:e}){const r=[];return Object.keys($h).forEach(n=>{if(Array.isArray(t[n])){const s=t[n],i=Ls(e);s.some(a=>{const c=Ls(a)===i,l=N0(a)&&Ls(a.id)===i;return c||l})&&r.push(n)}}),r}function N0(t){return!(!t||typeof t!="object"||t===null||!("id"in t&&"type"in t&&"controller"in t)||typeof t.id!="string"||typeof t.type!="string"||typeof t.controller!="string")}function Pk({keyBytes:t,multicodecCode:e,multicodecName:r}){const n=ws.addPrefix({code:e,data:t,name:r}),s=ct.uint8Array(n).toBase58Btc();return ct.base58Btc(s).toMultibase()}function S$({multibaseKeyId:t}){try{const e=ct.multibase(t).toBase58Btc(),r=ct.base58Btc(e).toUint8Array(),{code:n,data:s,name:i}=ws.removePrefix({prefixedData:r});return{keyBytes:s,multicodecCode:n,multicodecName:i}}catch{throw new nt(Ge.InvalidDid,`Invalid multibase identifier: ${t}`)}}var lp=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let gc=class Ck{constructor({uri:e,document:r,metadata:n,keyManager:s}){this.uri=e,this.document=r,this.metadata=n,this.keyManager=s}export(){return lp(this,void 0,void 0,function*(){if(!(Array.isArray(this.document.verificationMethod)&&this.document.verificationMethod.length>0))throw new Error(`DID document for '${this.uri}' is missing verification methods`);let e={uri:this.uri,document:this.document,metadata:this.metadata};if("exportKey"in this.keyManager&&typeof this.keyManager.exportKey=="function"){const r=[];for(let n of this.document.verificationMethod){if(!n.publicKeyJwk)throw new Error(`Verification method '${n.id}' does not contain a public key in JWK format`);const s=yield this.keyManager.getKeyUri({key:n.publicKeyJwk}),i=yield this.keyManager.exportKey({keyUri:s});r.push(Object.assign({},i))}e.privateKeys=r}return e})}getSigner(e){return lp(this,void 0,void 0,function*(){var r;const n=(r=this.document.verificationMethod)===null||r===void 0?void 0:r.find(c=>{var l,u;return Ls(c.id)===((l=Ls(e==null?void 0:e.methodId))!==null&&l!==void 0?l:Ls((u=this.document.assertionMethod)===null||u===void 0?void 0:u[0]))});if(!(n&&n.publicKeyJwk))throw new nt(Ge.InternalError,"A verification method intended for signing could not be determined from the DID Document");const s=yield this.keyManager.getKeyUri({key:n.publicKeyJwk}),i=yield this.keyManager.getPublicKey({keyUri:s}),o=this.keyManager;return{algorithm:gL(i),keyId:n.id,sign(c){return lp(this,arguments,void 0,function*({data:l}){return yield o.sign({data:l,keyUri:s})})},verify(c){return lp(this,arguments,void 0,function*({data:l,signature:u}){return yield o.verify({data:l,key:i,signature:u})})}}})}static import(e){return lp(this,arguments,void 0,function*({portableDid:r,keyManager:n=new Ga}){var s;const i=Dk({didDocument:r.document});if(i.length===0)throw new nt(Ge.InvalidDidDocument,"At least one verification method is required but 0 were given");for(let a of(s=r.privateKeys)!==null&&s!==void 0?s:[])yield n.importKey({key:a});for(let a of i){if(!a.publicKeyJwk)throw new Error(`Verification method '${a.id}' does not contain a public key in JWK format`);const c=yield n.getKeyUri({key:a.publicKeyJwk});yield n.getPublicKey({keyUri:c})}return new Ck({uri:r.uri,document:r.document,metadata:r.metadata,keyManager:n})})}};var $$=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let ny=class{static getSigningMethod(e){return $$(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement getSigningMethod()")})}static resolve(e,r){return $$(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement resolve()")})}};var cn=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},x$=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};const D$="https://diddht.tbddev.org",_L=0,Eu=7200,Xm=";",Vn=",";var Kb;(function(t){t[t.Discoverable=0]="Discoverable",t[t.Organization=1]="Organization",t[t.Government=2]="Government",t[t.Corporation=3]="Corporation",t[t.LocalBusiness=4]="LocalBusiness",t[t.SoftwarePackage=5]="SoftwarePackage",t[t.WebApp=6]="WebApp",t[t.FinancialInstitution=7]="FinancialInstitution"})(Kb||(Kb={}));var Xn;(function(t){t[t.Ed25519=0]="Ed25519",t[t.secp256k1=1]="secp256k1",t[t.secp256r1=2]="secp256r1",t[t.X25519=3]="X25519"})(Xn||(Xn={}));var Lb;(function(t){t.authentication="auth",t.assertionMethod="asm",t.capabilityDelegation="del",t.capabilityInvocation="inv",t.keyAgreement="agm"})(Lb||(Lb={}));const kk={Ed25519:Xn.Ed25519,ES256K:Xn.secp256k1,ES256:Xn.secp256r1,"P-256":Xn.secp256r1,secp256k1:Xn.secp256k1,secp256r1:Xn.secp256r1,X25519:Xn.X25519},P$={[Xn.Ed25519]:"EdDSA",[Xn.secp256k1]:"ES256K",[Xn.secp256r1]:"ES256",[Xn.X25519]:"ECDH-ES+A256KW"};let R0=class qb extends ny{static create(){return cn(this,arguments,void 0,function*({keyManager:e=new Ga,options:r={}}={}){var n,s,i,o,a,c,l,u,d,h,f;if(!((n=r.verificationMethods)===null||n===void 0)&&n.some(_=>!(_.algorithm in kk)))throw new Error("One or more verification method algorithms are not supported");const p=(s=r.verificationMethods)===null||s===void 0?void 0:s.filter(_=>"id"in _).map(_=>_.id);if(p&&p.length!==new Set(p).size)throw new Error("One or more verification method IDs are not unique");if(!((i=r.services)===null||i===void 0)&&i.some(_=>!_.id||!_.type||!_.serviceEndpoint))throw new Error("One or more services are missing required properties");const y=yield e.generateKey({algorithm:"Ed25519"}),b=yield e.getPublicKey({keyUri:y}),w=yield Un.identityKeyToIdentifier({identityKey:b}),g=Object.assign(Object.assign({id:w},r.alsoKnownAs&&{alsoKnownAs:r.alsoKnownAs}),r.controllers&&{controller:r.controllers}),v=[...(o=r.verificationMethods)!==null&&o!==void 0?o:[]];v!=null&&v.some(_=>{var x;return((x=_.id)===null||x===void 0?void 0:x.split("#").pop())==="0"})||v.unshift({algorithm:"Ed25519",id:"0",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]});for(const _ of v){const x=_.id&&_.id.split("#").pop()==="0"?y:yield e.generateKey({algorithm:_.algorithm}),D=yield e.getPublicKey({keyUri:x});let E=(c=(a=_.id)!==null&&a!==void 0?a:D.kid)!==null&&c!==void 0?c:yield rr({jwk:D});E=`${w}#${Ls(E)}`,(l=g.verificationMethod)!==null&&l!==void 0||(g.verificationMethod=[]),g.verificationMethod.push({id:E,type:"JsonWebKey",controller:(u=_.controller)!==null&&u!==void 0?u:w,publicKeyJwk:D});for(const A of(d=_.purposes)!==null&&d!==void 0?d:[])g[A]||(g[A]=[]),g[A].push(E)}(h=r.services)===null||h===void 0||h.forEach(_=>{var x;(x=g.service)!==null&&x!==void 0||(g.service=[]),_.id=`${w}#${_.id.split("#").pop()}`,g.service.push(_)});const m=new gc({uri:w,document:g,metadata:Object.assign({published:!1},r.types&&{types:r.types}),keyManager:e});if(!((f=r.publish)!==null&&f!==void 0)||f){const _=yield qb.publish({did:m,gatewayUri:r.gatewayUri});m.metadata=_.didDocumentMetadata}return m})}static import(e){return cn(this,arguments,void 0,function*({portableDid:r,keyManager:n=new Ga}){var s;const i=Jt.parse(r.uri);if((i==null?void 0:i.method)!==qb.methodName)throw new nt(Ge.MethodNotSupported,"Method not supported");const o=yield gc.import({portableDid:r,keyManager:n});if(!(!((s=o.document.verificationMethod)===null||s===void 0)&&s.some(a=>{var c;return((c=a.id)===null||c===void 0?void 0:c.split("#").pop())==="0"})))throw new nt(Ge.InvalidDidDocument,"DID document must contain an Identity Key");return o})}static getSigningMethod(e){return cn(this,arguments,void 0,function*({didDocument:r,methodId:n="#0"}){var s;const i=Jt.parse(r.id);if(i&&i.method!==this.methodName)throw new nt(Ge.MethodNotSupported,`Method not supported: ${i.method}`);const o=(s=r.verificationMethod)===null||s===void 0?void 0:s.find(a=>{var c,l;return Ls(a.id)===((c=Ls(n))!==null&&c!==void 0?c:Ls((l=r.assertionMethod)===null||l===void 0?void 0:l[0]))});if(!(o&&o.publicKeyJwk))throw new nt(Ge.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static publish(e){return cn(this,arguments,void 0,function*({did:r,gatewayUri:n=D$}){return yield C$.put({did:r,gatewayUri:n})})}static resolve(e){return cn(this,arguments,void 0,function*(r,n={}){var s;const i=(s=n==null?void 0:n.gatewayUri)!==null&&s!==void 0?s:D$;try{yield Un.identifierToIdentityKey({didUri:r});const{didDocument:o,didDocumentMetadata:a}=yield C$.get({didUri:r,gatewayUri:i});return Object.assign(Object.assign({},Bn),{didDocument:o,didDocumentMetadata:a})}catch(o){if(!(o instanceof nt))throw new Error(o);return Object.assign(Object.assign({},Bn),{didResolutionMetadata:Object.assign({error:o.code},o.message&&{errorMessage:o.message})})}})}};R0.methodName="dht";let C$=class il{static get(e){return cn(this,arguments,void 0,function*({didUri:r,gatewayUri:n}){const s=Un.identifierToIdentityKeyBytes({didUri:r}),i=yield il.pkarrGet({gatewayUri:n,publicKeyBytes:s}),o=yield Un.parseBep44GetMessage({bep44Message:i}),a=yield il.fromDnsPacket({didUri:r,dnsPacket:o});return a.didDocumentMetadata.versionId=i.seq.toString(),a})}static put(e){return cn(this,arguments,void 0,function*({did:r,gatewayUri:n}){const s=yield il.toDnsPacket({didDocument:r.document,didMetadata:r.metadata,authoritativeGatewayUris:[n]}),i=yield Un.createBep44PutMessage({dnsPacket:s,publicKeyBytes:Un.identifierToIdentityKeyBytes({didUri:r.uri}),signer:yield r.getSigner({methodId:"0"})}),o=yield il.pkarrPut({gatewayUri:n,bep44Message:i});return{didDocument:r.document,didDocumentMetadata:Object.assign(Object.assign({},r.metadata),{published:o,versionId:i.seq.toString()}),didRegistrationMetadata:{}}})}static pkarrGet(e){return cn(this,arguments,void 0,function*({gatewayUri:r,publicKeyBytes:n}){const s=ct.uint8Array(n).toBase32Z(),i=new URL(s,r).href;let o;try{if(o=yield fetch(i,{method:"GET"}),!o.ok)throw new nt(Ge.NotFound,`Pkarr record not found for: ${s}`)}catch(l){throw l instanceof nt?l:new nt(Ge.InternalError,`Failed to fetch Pkarr record: ${l.message}`)}const a=yield o.arrayBuffer();if(!a)throw new nt(Ge.NotFound,`Pkarr record not found for: ${s}`);if(a.byteLength<72)throw new nt(Ge.InvalidDidDocumentLength,`Pkarr response must be at least 72 bytes but got: ${a.byteLength}`);if(a.byteLength>1072)throw new nt(Ge.InvalidDidDocumentLength,`Pkarr response exceeds 1000 byte limit: ${a.byteLength}`);return{k:n,seq:Number(new DataView(a).getBigUint64(64)),sig:new Uint8Array(a,0,64),v:new Uint8Array(a,72)}})}static pkarrPut(e){return cn(this,arguments,void 0,function*({gatewayUri:r,bep44Message:n}){const s=ct.uint8Array(n.k).toBase32Z(),i=new URL(s,r).href,o=new Uint8Array(n.v.length+72);o.set(n.sig,0),new DataView(o.buffer).setBigUint64(n.sig.length,BigInt(n.seq)),o.set(n.v,n.sig.length+8);let a;try{a=yield fetch(i,{method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:o})}catch(c){throw new nt(Ge.InternalError,`Failed to put Pkarr record for identifier ${s}: ${c.message}`)}return a.ok})}static fromDnsPacket(e){return cn(this,arguments,void 0,function*({didUri:r,dnsPacket:n}){var s,i,o;const a={id:r},c={published:!0},l=new Map;for(const u of(s=n==null?void 0:n.answers)!==null&&s!==void 0?s:[]){if(u.type!=="TXT")continue;const d=u.name.split(".")[0].substring(1);switch(!0){case d.startsWith("aka"):{const h=Un.parseTxtDataToString(u.data);a.alsoKnownAs=h.split(Vn);break}case d.startsWith("cnt"):{const h=Un.parseTxtDataToString(u.data);a.controller=h.includes(Vn)?h.split(Vn):h;break}case d.startsWith("k"):{const{id:h,t:f,k:p,c:y,a:b}=Un.parseTxtDataToObject(u.data),w=ct.base64Url(p).toUint8Array(),g=Xn[Number(f)];let v=yield Un.keyConverter(g).bytesToPublicKey({publicKeyBytes:w});v.alg=b||P$[Number(f)];const m=d==="k0"?"0":h!==void 0?h:yield rr({jwk:v});(i=a.verificationMethod)!==null&&i!==void 0||(a.verificationMethod=[]);const _=`${r}#${m}`;a.verificationMethod.push({id:_,type:"JsonWebKey",controller:y??r,publicKeyJwk:v}),l.set(d,_);break}case d.startsWith("s"):{const h=Un.parseTxtDataToObject(u.data),{id:f,t:p,se:y}=h,b=x$(h,["id","t","se"]),w=y.includes(Vn)?y.split(Vn):[y],g=Object.fromEntries(Object.entries(b).map(([v,m])=>[v,m.includes(Vn)?m.split(Vn):m]));(o=a.service)!==null&&o!==void 0||(a.service=[]),a.service.push(Object.assign(Object.assign({},g),{id:`${r}#${f}`,type:p,serviceEndpoint:w}));break}case d.startsWith("typ"):{const{id:h}=Un.parseTxtDataToObject(u.data);c.types=h.split(Vn).map(f=>Number(f));break}case d.startsWith("did"):{const h=g=>g.split(Vn).map(v=>l.get(v)).filter(v=>typeof v=="string"),{auth:f,asm:p,del:y,inv:b,agm:w}=Un.parseTxtDataToObject(u.data);f&&(a.authentication=h(f)),p&&(a.assertionMethod=h(p)),y&&(a.capabilityDelegation=h(y)),b&&(a.capabilityInvocation=h(b)),w&&(a.keyAgreement=h(w));break}}}return{didDocument:a,didDocumentMetadata:c,didResolutionMetadata:{}}})}static toDnsPacket(e){return cn(this,arguments,void 0,function*({didDocument:r,didMetadata:n,authoritativeGatewayUris:s,previousDidProof:i}){var o,a,c,l,u;const d=[],h=[],f=new Map,p=[],y=[];if(i!==void 0){const{signature:g,previousDid:v}=i;yield Un.validatePreviousDidProof({newDid:r.id,previousDidProof:i}),d.push({type:"TXT",name:"_prv._did.",ttl:Eu,data:`id=${v};s=${g}`})}if(r.alsoKnownAs&&d.push({type:"TXT",name:"_aka._did.",ttl:Eu,data:r.alsoKnownAs.join(Vn)}),r.controller){const g=Array.isArray(r.controller)?r.controller.join(Vn):r.controller;d.push({type:"TXT",name:"_cnt._did.",ttl:Eu,data:g})}for(const[g,v]of(a=(o=r.verificationMethod)===null||o===void 0?void 0:o.entries())!==null&&a!==void 0?a:[]){const m=`k${g}`;y.push(m);let _=v.id.split("#").pop();f.set(_,m);const x=v.publicKeyJwk;if(!(x!=null&&x.crv&&x.crv in kk))throw new nt(Ge.InvalidPublicKeyType,`Verification method '${v.id}' contains an unsupported key type: ${(c=x==null?void 0:x.crv)!==null&&c!==void 0?c:"undefined"}`);const D=Xn[x.crv],E=yield Un.keyConverter(x.crv).publicKeyToBytes({publicKey:x}),A=ct.uint8Array(E).toBase64Url(),S=[`t=${D}`,`k=${A}`];_!=="0"&&(yield rr({jwk:x}))!==_&&S.unshift(`id=${_}`),x.alg!==P$[D]&&S.push(`a=${x.alg}`),v.controller!==r.id&&S.push(`c=${v.controller}`),d.push({type:"TXT",name:`_${m}._did.`,ttl:Eu,data:S.join(Xm)})}(l=r.service)===null||l===void 0||l.forEach((g,v)=>{const m=`s${v}`;p.push(m);let{id:_,type:x,serviceEndpoint:D}=g,E=x$(g,["id","type","serviceEndpoint"]);_=Ls(_),D=Array.isArray(D)?D.join(","):D;const S=Object.entries(Object.assign({id:_,t:x,se:D},E)).map(([I,N])=>`${I}=${N}`).join(Xm),O=Un.chunkDataIfNeeded(S);d.push({type:"TXT",name:`_${m}._did.`,ttl:Eu,data:O})});const b=[`v=${_L}`];if(y.length&&b.push(`vm=${y.join(Vn)}`),Object.keys($h).forEach(g=>{var v;const m=(v=r[g])===null||v===void 0?void 0:v.map(_=>f.get(_.split("#").pop()));if(m){const _=Lb[g];b.push(`${_}=${m.join(Vn)}`)}}),p.length&&b.push(`svc=${p.join(Vn)}`),!((u=n.types)===null||u===void 0)&&u.length){const v=n.types.map(m=>typeof m=="string"?Kb[m]:m);d.push({type:"TXT",name:"_typ._did.",ttl:Eu,data:`id=${v.join(Vn)}`})}d.push({type:"TXT",name:"_did."+il.getUniqueDidSuffix(r.id)+".",ttl:Eu,data:b.join(Xm)});for(const g of s||[])h.push({type:"NS",name:"_did."+il.getUniqueDidSuffix(r.id)+".",ttl:Eu,data:g+"."});return{id:0,type:"response",flags:__,answers:[...d,...h]}})}static getUniqueDidSuffix(e){return e.split(":")[2]}},Un=class Ym{static createBep44PutMessage(e){return cn(this,arguments,void 0,function*({dnsPacket:r,publicKeyBytes:n,signer:s}){const i=Math.ceil(Date.now()/1e3),o=Eh(r),a=Qd.encode({seq:i,v:o}).subarray(1,-1);if(a.length>1e3)throw new nt(Ge.InvalidDidDocumentLength,`DNS packet exceeds the 1000 byte maximum size: ${a.length} bytes`);const c=yield s.sign({data:a});return{k:n,seq:i,sig:c,v:o}})}static identifierToIdentityKey(e){return cn(this,arguments,void 0,function*({didUri:r}){let n=Ym.identifierToIdentityKeyBytes({didUri:r});return yield mi.bytesToPublicKey({publicKeyBytes:n})})}static identifierToIdentityKeyBytes({didUri:e}){const r=Jt.parse(e);if(!r)throw new nt(Ge.InvalidDid,`Invalid DID URI: ${e}`);if(r.method!==R0.methodName)throw new nt(Ge.MethodNotSupported,`Method not supported: ${r.method}`);let n;try{n=ct.base32Z(r.id).toUint8Array()}catch{throw new nt(Ge.InvalidPublicKey,"Failed to decode method-specific identifier")}if(n.length!==32)throw new nt(Ge.InvalidPublicKeyLength,`Invalid public key length: ${n.length}`);return n}static identityKeyToIdentifier(e){return cn(this,arguments,void 0,function*({identityKey:r}){const n=yield mi.publicKeyToBytes({publicKey:r}),s=ct.uint8Array(n).toBase32Z();return`did:${R0.methodName}:${s}`})}static keyConverter(e){const n={Ed25519:mi,"P-256":{publicKeyToBytes:s=>cn(this,[s],void 0,function*({publicKey:i}){const o=yield ps.publicKeyToBytes({publicKey:i});return yield ps.compressPublicKey({publicKeyBytes:o})}),bytesToPublicKey:ps.bytesToPublicKey,privateKeyToBytes:ps.privateKeyToBytes,bytesToPrivateKey:ps.bytesToPrivateKey},secp256k1:{publicKeyToBytes:s=>cn(this,[s],void 0,function*({publicKey:i}){const o=yield Bi.publicKeyToBytes({publicKey:i});return yield Bi.compressPublicKey({publicKeyBytes:o})}),bytesToPublicKey:Bi.bytesToPublicKey,privateKeyToBytes:Bi.privateKeyToBytes,bytesToPrivateKey:Bi.bytesToPrivateKey},X25519:xk}[e];if(!n)throw new nt(Ge.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static parseBep44GetMessage(e){return cn(this,arguments,void 0,function*({bep44Message:r}){const n=yield mi.bytesToPublicKey({publicKeyBytes:r.k}),s=Qd.encode({seq:r.seq,v:r.v}).subarray(1,-1);if(!(yield mi.verify({key:n,signature:r.sig,data:s})))throw new nt(Ge.InvalidSignature,"Invalid signature for DHT BEP44 message");return E_(r.v)})}static parseTxtDataToObject(e){return this.parseTxtDataToString(e).split(Xm).reduce((r,n)=>{const[s,i]=n.split("=");return r[s]=i,r},{})}static parseTxtDataToString(e){if(typeof e=="string")return e;if(e instanceof Uint8Array)return ct.uint8Array(e).toString();if(Array.isArray(e))return e.map(r=>this.parseTxtDataToString(r)).join("");throw new nt(Ge.InternalError,"Pkarr returned DNS TXT record with invalid data type")}static validatePreviousDidProof(e){return cn(this,arguments,void 0,function*({newDid:r,previousDidProof:n}){const s=yield Ym.identifierToIdentityKey({didUri:n.previousDid}),i=Ym.identifierToIdentityKeyBytes({didUri:r}),o=ct.base64Url(n.signature).toUint8Array();if(!(yield mi.verify({key:s,data:i,signature:o})))throw new nt(Ge.InvalidPreviousDidProof,"The previous DID proof is invalid.")})}static chunkDataIfNeeded(e){if(e.length<=255)return e;const r=[];for(let n=0;n<e.length;n+=255)r.push(e.slice(n,n+255));return r}};var Gu=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},xo;(function(t){t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.secp256r1="secp256r1",t.X25519="X25519"})(xo||(xo={}));const EL={Ed25519:xo.Ed25519,ES256K:xo.secp256k1,ES256:xo.secp256r1,"P-256":xo.secp256r1,secp256k1:xo.secp256k1,secp256r1:xo.secp256r1},k$="https://ion.tbd.engineering";let Ok=class Kp extends ny{static create(){return Gu(this,arguments,void 0,function*({keyManager:e=new Ga,options:r={}}={}){var n,s,i,o,a,c,l;if(!((n=r.verificationMethods)===null||n===void 0)&&n.some(_=>!(_.algorithm in EL)))throw new Error("One or more verification method algorithms are not supported");const u=(s=r.verificationMethods)===null||s===void 0?void 0:s.filter(_=>"id"in _).map(_=>_.id);if(u&&u.length!==new Set(u).size)throw new Error("One or more verification method IDs are not unique");if(!((i=r.services)===null||i===void 0)&&i.some(_=>!_.id||!_.type||!_.serviceEndpoint))throw new Error("One or more services are missing required properties");const d={algorithm:"Ed25519",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]},h=[];for(const _ of(o=r.verificationMethods)!==null&&o!==void 0?o:[d]){const x=yield e.generateKey({algorithm:_.algorithm}),D=yield e.getPublicKey({keyUri:x});h.push({id:_.id,publicKeyJwk:D,purposes:(a=_.purposes)!==null&&a!==void 0?a:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]})}const f=yield e.generateKey({algorithm:xo.secp256k1}),p=yield e.getPublicKey({keyUri:f}),y=yield e.generateKey({algorithm:xo.secp256k1}),b=yield e.getPublicKey({keyUri:y}),w=yield dp.computeLongFormDidUri({recoveryKey:p,updateKey:b,services:(c=r.services)!==null&&c!==void 0?c:[],verificationMethods:h}),{didDocument:g,didResolutionMetadata:v}=yield Kp.resolve(w,{gatewayUri:r.gatewayUri});if(g===null)throw new Error(`Unable to resolve DID during creation: ${v==null?void 0:v.error}`);const m=new gc({uri:w,document:g,metadata:{published:!1,canonicalId:w.split(":",3).join(":"),recoveryKey:p,updateKey:b},keyManager:e});if(!((l=r.publish)!==null&&l!==void 0)||l){const _=yield Kp.publish({did:m,gatewayUri:r.gatewayUri});m.metadata=_.didDocumentMetadata}return m})}static getSigningMethod(e){return Gu(this,arguments,void 0,function*({didDocument:r,methodId:n}){var s;const i=Jt.parse(r.id);if(i&&i.method!==this.methodName)throw new nt(Ge.MethodNotSupported,`Method not supported: ${i.method}`);const o=(s=r.verificationMethod)===null||s===void 0?void 0:s.find(a=>{var c;return a.id===(n??((c=r.assertionMethod)===null||c===void 0?void 0:c[0]))});if(!(o&&o.publicKeyJwk))throw new nt(Ge.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static import(e){return Gu(this,arguments,void 0,function*({portableDid:r,keyManager:n=new Ga}){const s=Jt.parse(r.uri);if((s==null?void 0:s.method)!==Kp.methodName)throw new nt(Ge.MethodNotSupported,"Method not supported");return yield gc.import({portableDid:r,keyManager:n})})}static publish(e){return Gu(this,arguments,void 0,function*({did:r,gatewayUri:n=k$}){var s,i,o;const a=(i=(s=r.document.verificationMethod)===null||s===void 0?void 0:s.map(u=>({id:u.id,publicKeyJwk:u.publicKeyJwk,purposes:bL({didDocument:r.document,methodId:u.id})})))!==null&&i!==void 0?i:[],c=yield dp.createIonDocument({services:(o=r.document.service)!==null&&o!==void 0?o:[],verificationMethods:a}),l=yield dp.constructCreateRequest({ionDocument:c,recoveryKey:r.metadata.recoveryKey,updateKey:r.metadata.updateKey});try{const u=dp.appendPathToUrl({baseUrl:n,path:"/operations"}),d=yield fetch(u,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});return{didDocument:r.document,didDocumentMetadata:Object.assign(Object.assign({},r.metadata),{published:d.ok}),didRegistrationMetadata:{}}}catch{return{didDocument:null,didDocumentMetadata:{published:!1},didRegistrationMetadata:{error:Ge.InternalError,errorMessage:`Failed to publish DID document for: ${r.uri}`}}}})}static resolve(e){return Gu(this,arguments,void 0,function*(r,n={}){var s,i;const o=Jt.parse(r);if(!o)return Object.assign(Object.assign({},Bn),{didResolutionMetadata:{error:"invalidDid"}});if(o.method!==Kp.methodName)return Object.assign(Object.assign({},Bn),{didResolutionMetadata:{error:"methodNotSupported"}});const a=(s=n==null?void 0:n.gatewayUri)!==null&&s!==void 0?s:k$;try{const c=dp.appendPathToUrl({baseUrl:a,path:`/identifiers/${r}`}),l=yield fetch(c);if(!l.ok)throw new nt(Ge.NotFound,`Unable to find DID document for: ${r}`);const{didDocument:u,didDocumentMetadata:d}=yield l.json();return Object.assign(Object.assign(Object.assign({},Bn),u&&{didDocument:u}),{didDocumentMetadata:Object.assign({published:(i=d==null?void 0:d.method)===null||i===void 0?void 0:i.published},d)})}catch(c){if(!(c instanceof nt))throw new Error(c);return Object.assign(Object.assign({},Bn),{didResolutionMetadata:Object.assign({error:c.code},c.message&&{errorMessage:c.message})})}})}};Ok.methodName="ion";let dp=class sl{static appendPathToUrl({baseUrl:e,path:r}){const n=new URL(e);return n.pathname=n.pathname.endsWith("/")?n.pathname:n.pathname+"/",n.pathname+=r.startsWith("/")?r.substring(1):r,n.toString()}static computeLongFormDidUri(e){return Gu(this,arguments,void 0,function*({recoveryKey:r,updateKey:n,services:s,verificationMethods:i}){const o=yield sl.createIonDocument({services:s,verificationMethods:i}),a=sl.normalizeJwk(r),c=sl.normalizeJwk(n);return yield ty.createLongFormDid({document:o,recoveryKey:a,updateKey:c})})}static constructCreateRequest(e){return Gu(this,arguments,void 0,function*({ionDocument:r,recoveryKey:n,updateKey:s}){return yield Kn.createCreateRequest({document:r,recoveryKey:sl.normalizeJwk(n),updateKey:sl.normalizeJwk(s)})})}static createIonDocument(e){return Gu(this,arguments,void 0,function*({services:r,verificationMethods:n}){var s,i;const o=[];for(const l of n){let u=(i=(s=l.id)!==null&&s!==void 0?s:l.publicKeyJwk.kid)!==null&&i!==void 0?i:yield rr({jwk:l.publicKeyJwk});u=`${u.split("#").pop()}`;const d={id:u,publicKeyJwk:sl.normalizeJwk(l.publicKeyJwk),purposes:l.purposes,type:"JsonWebKey2020"};o.push(d)}const a=r.map(l=>Object.assign(Object.assign({},l),{id:`${l.id.split("#").pop()}`}));return{publicKeys:o,services:a}})}static normalizeJwk(e){const r=e.kty;let n;if(r==="EC")n={crv:e.crv,kty:e.kty,x:e.x,y:e.y};else if(r==="oct")n={k:e.k,kty:e.kty};else if(r==="OKP")n={crv:e.crv,kty:e.kty,x:e.x};else if(r==="RSA")n={e:e.e,kty:e.kty,n:e.n};else throw new Error(`Unsupported key type: ${r}`);return n}};var sm=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let Tk=class Lp extends ny{static create(){return sm(this,arguments,void 0,function*({keyManager:e=new Ga,options:r={}}={}){var n,s,i,o;if(r.algorithm&&r.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(r.verificationMethods&&r.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");const a=(o=(n=r.algorithm)!==null&&n!==void 0?n:(i=(s=r.verificationMethods)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.algorithm)!==null&&o!==void 0?o:"Ed25519",c=yield e.generateKey({algorithm:a}),l=yield e.getPublicKey({keyUri:c}),u=ct.object(l).toBase64Url(),d=`did:${Lp.methodName}:${u}`,f=(yield Lp.resolve(d)).didDocument;return new gc({uri:d,document:f,metadata:{},keyManager:e})})}static getSigningMethod(e){return sm(this,arguments,void 0,function*({didDocument:r}){var n;const s=Jt.parse(r.id);if(s&&s.method!==this.methodName)throw new nt(Ge.MethodNotSupported,`Method not supported: ${s.method}`);const[i]=(n=r.verificationMethod)!==null&&n!==void 0?n:[];if(!(i&&i.publicKeyJwk))throw new nt(Ge.InternalError,"A verification method intended for signing could not be determined from the DID Document");return i})}static import(e){return sm(this,arguments,void 0,function*({portableDid:r,keyManager:n=new Ga}){const s=Jt.parse(r.uri);if((s==null?void 0:s.method)!==Lp.methodName)throw new nt(Ge.MethodNotSupported,"Method not supported");const i=yield gc.import({portableDid:r,keyManager:n});if(i.document.verificationMethod.length!==1)throw new nt(Ge.InvalidDidDocument,"DID document must contain exactly one verification method");return i})}static resolve(e,r){return sm(this,void 0,void 0,function*(){const n=Jt.parse(e);let s;try{s=ct.base64Url(n.id).toObject()}catch{}if(!n||!s)return Object.assign(Object.assign({},Bn),{didResolutionMetadata:{error:"invalidDid"}});if(n.method!==Lp.methodName)return Object.assign(Object.assign({},Bn),{didResolutionMetadata:{error:"methodNotSupported"}});const i={"@context":["https://www.w3.org/ns/did/v1"],id:n.uri},o=`${i.id}#0`;switch(i.verificationMethod=[{id:o,type:"JsonWebKey",controller:i.id,publicKeyJwk:s}],i.authentication=[o],i.assertionMethod=[o],i.capabilityInvocation=[o],i.capabilityDelegation=[o],i.keyAgreement=[o],s.use){case"sig":{delete i.keyAgreement;break}case"enc":{delete i.authentication,delete i.assertionMethod,delete i.capabilityInvocation,delete i.capabilityDelegation;break}}return Object.assign(Object.assign({},Bn),{didDocument:i})})}};Tk.methodName="jwk";var Rs=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},$a;(function(t){t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.secp256r1="secp256r1",t.X25519="X25519"})($a||($a={}));const iw={Ed25519VerificationKey2020:"https://w3id.org/security/suites/ed25519-2020/v1",JsonWebKey2020:"https://w3id.org/security/suites/jws-2020/v1",X25519KeyAgreementKey2020:"https://w3id.org/security/suites/x25519-2020/v1"},AL={Ed25519:$a.Ed25519,ES256K:$a.secp256k1,ES256:$a.secp256r1,"P-256":$a.secp256r1,secp256k1:$a.secp256k1,secp256r1:$a.secp256r1,X25519:$a.X25519};let Ik=class Aa extends ny{static create(){return Rs(this,arguments,void 0,function*({keyManager:e=new Ga,options:r={}}={}){var n,s,i,o;if(r.algorithm&&r.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(r.verificationMethods&&r.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");const a=(o=(n=r.algorithm)!==null&&n!==void 0?n:(i=(s=r.verificationMethods)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.algorithm)!==null&&o!==void 0?o:"Ed25519",c=yield e.generateKey({algorithm:a}),l=yield e.getPublicKey({keyUri:c}),u=yield ss.publicKeyToMultibaseId({publicKey:l}),d=`did:${Aa.methodName}:${u}`,f=(yield Aa.resolve(d,r)).didDocument;return new gc({uri:d,document:f,metadata:{},keyManager:e})})}static getSigningMethod(e){return Rs(this,arguments,void 0,function*({didDocument:r}){var n;const s=Jt.parse(r.id);if(s&&s.method!==this.methodName)throw new nt(Ge.MethodNotSupported,`Method not supported: ${s.method}`);const[i]=r.assertionMethod||[],o=(n=r.verificationMethod)===null||n===void 0?void 0:n.find(a=>a.id===i);if(!(o&&o.publicKeyJwk))throw new nt(Ge.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static import(e){return Rs(this,arguments,void 0,function*({portableDid:r,keyManager:n=new Ga}){const s=Jt.parse(r.uri);if((s==null?void 0:s.method)!==Aa.methodName)throw new nt(Ge.MethodNotSupported,"Method not supported");const i=yield gc.import({portableDid:r,keyManager:n});if(i.document.verificationMethod.length!==1)throw new nt(Ge.InvalidDidDocument,"DID document must contain exactly one verification method");return i})}static resolve(e,r){return Rs(this,void 0,void 0,function*(){try{const n=yield Aa.createDocument({didUri:e,options:r});return Object.assign(Object.assign({},Bn),{didDocument:n})}catch(n){if(!(n instanceof nt))throw new Error(n);return Object.assign(Object.assign({},Bn),{didResolutionMetadata:Object.assign({error:n.code},n.message&&{errorMessage:n.message})})}})}static createDocument(e){return Rs(this,arguments,void 0,function*({didUri:r,options:n={}}){const{defaultContext:s="https://www.w3.org/ns/did/v1",enableEncryptionKeyDerivation:i=!1,enableExperimentalPublicKeyTypes:o=!1,publicKeyFormat:a="JsonWebKey2020"}=n,c={id:""},l=Jt.parse(r);if(!l)throw new nt(Ge.InvalidDid,`Invalid DID URI: ${r}`);const u=l.id;if(l.method!==Aa.methodName)throw new nt(Ge.MethodNotSupported,`Method not supported: ${l.method}`);if(!Aa.validateIdentifier(l))throw new nt(Ge.InvalidDid,`Invalid DID URI: ${r}`);const d=yield Aa.createSignatureMethod({didUri:r,multibaseValue:u,options:{enableExperimentalPublicKeyTypes:o,publicKeyFormat:a}});if(c.id=l.uri,c.verificationMethod=[d],c.authentication=[d.id],c.assertionMethod=[d.id],c.capabilityInvocation=[d.id],c.capabilityDelegation=[d.id],i===!0){const p=a==="Ed25519VerificationKey2020"?"X25519KeyAgreementKey2020":"JsonWebKey2020",y=yield this.createEncryptionMethod({didUri:r,multibaseValue:u,options:{enableExperimentalPublicKeyTypes:o,publicKeyFormat:p}});c.verificationMethod.push(y),c.keyAgreement=[y.id]}const h=[s];return wL({didDocument:c}).forEach(p=>{const y=iw[p];h.push(y)}),c["@context"]=h,c})}static createEncryptionMethod(e){return Rs(this,arguments,void 0,function*({didUri:r,multibaseValue:n,options:s}){const{enableExperimentalPublicKeyTypes:i,publicKeyFormat:o}=s,a={id:"",type:"",controller:""},{keyBytes:c,multicodecCode:l}=yield Aa.deriveEncryptionKey({multibaseValue:n}),u=c.byteLength,d=ss.MULTICODEC_PUBLIC_KEY_LENGTH[l];if(u!==d)throw new nt(Ge.InvalidPublicKeyLength,`Expected ${u} bytes. Actual: ${d}`);const h=Pk({keyBytes:c,multicodecCode:l});a.id=`${r}#${h}`;try{new URL(a.id)}catch{throw new nt(Ge.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(o in iw))throw new nt(Ge.UnsupportedPublicKeyType,`Unsupported format: ${o}`);if(i===!1&&!["Multikey","JsonWebKey2020","X25519KeyAgreementKey2020"].includes(o))throw new nt(Ge.InvalidPublicKeyType,`Specified '${o}' without setting enableExperimentalPublicKeyTypes to true.`);if(a.type=o,a.controller=r,o==="X25519KeyAgreementKey2020"&&(a.publicKeyMultibase=h),o==="JsonWebKey2020"){const{crv:p}=yield ss.multicodecToJwk({code:l});a.publicKeyJwk=yield ss.keyConverter(p).bytesToPublicKey({publicKeyBytes:c})}return a})}static createSignatureMethod(e){return Rs(this,arguments,void 0,function*({didUri:r,multibaseValue:n,options:s}){const{enableExperimentalPublicKeyTypes:i,publicKeyFormat:o}=s,a={id:"",type:"",controller:""},{keyBytes:c,multicodecCode:l,multicodecName:u}=S$({multibaseKeyId:n}),d=c.byteLength,h=ss.MULTICODEC_PUBLIC_KEY_LENGTH[l];if(d!==h)throw new nt(Ge.InvalidPublicKeyLength,`Expected ${d} bytes. Actual: ${h}`);let f=!1;switch(u){case"secp256k1-pub":f=yield Bi.validatePublicKey({publicKeyBytes:c});break;case"ed25519-pub":f=yield mi.validatePublicKey({publicKeyBytes:c});break;case"x25519-pub":f=!0;break}if(!f)throw new nt(Ge.InvalidPublicKey,"Invalid public key detected.");a.id=`${r}#${n}`;try{new URL(a.id)}catch{throw new nt(Ge.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(o in iw))throw new nt(Ge.UnsupportedPublicKeyType,`Unsupported format: ${o}`);if(i===!1&&!["Multikey","JsonWebKey2020","Ed25519VerificationKey2020"].includes(o))throw new nt(Ge.InvalidPublicKeyType,`Specified '${o}' without setting enableExperimentalPublicKeyTypes to true.`);if(a.type=o,a.controller=r,o==="Ed25519VerificationKey2020"&&(a.publicKeyMultibase=n),o==="JsonWebKey2020"){const{crv:y}=yield ss.multicodecToJwk({code:l});a.publicKeyJwk=yield ss.keyConverter(y).bytesToPublicKey({publicKeyBytes:c})}return a})}static deriveEncryptionKey(e){return Rs(this,arguments,void 0,function*({multibaseValue:r}){let n={keyBytes:new Uint8Array,multicodecCode:0};const{keyBytes:s,multicodecCode:i}=S$({multibaseKeyId:r});if(i===237){const o=yield ss.keyConverter("Ed25519").bytesToPublicKey({publicKeyBytes:s}),a=yield mi.convertPublicKeyToX25519({publicKey:o});n={keyBytes:yield ss.keyConverter("Ed25519").publicKeyToBytes({publicKey:a}),multicodecCode:236}}return n})}static validateIdentifier(e){const{method:r,id:n}=e,[s]=e.uri.split(":",1);return s==="did"&&r==="key"&&Number("1")>0&&Mb(n)==="String"&&n.startsWith("z")}};Ik.methodName="key";let ss=class Od{static jwkToMulticodec(e){return Rs(this,arguments,void 0,function*({jwk:r}){const n=[];r.crv&&(n.push(r.crv),r.d?n.push("private"):n.push("public"));const s=n.join(":"),i=Od.JWK_TO_MULTICODEC[s];if(i===void 0)throw new Error(`Unsupported JWK to Multicodec conversion: '${s}'`);return{code:ws.getCodeFromName({name:i}),name:i}})}static keyCompressor(e){const n={"P-256":ps.compressPublicKey,secp256k1:Bi.compressPublicKey}[e];if(!n)throw new nt(Ge.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static keyConverter(e){const n={Ed25519:mi,"P-256":ps,secp256k1:Bi,X25519:xk}[e];if(!n)throw new nt(Ge.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static multicodecToJwk(e){return Rs(this,arguments,void 0,function*({code:r,name:n}){if(!(n?!r:r))throw new Error("Either 'name' or 'code' must be defined, but not both.");n=n===void 0?ws.getNameFromCode({code:r}):n;const s=n,i=Od.MULTICODEC_TO_JWK[s];if(i===void 0)throw new Error("Unsupported Multicodec to JWK conversion");return Object.assign({},i)})}static publicKeyToMultibaseId(e){return Rs(this,arguments,void 0,function*({publicKey:r}){var n;if(!(r!=null&&r.crv&&r.crv in AL))throw new nt(Ge.InvalidPublicKeyType,`Public key contains an unsupported key type: ${(n=r==null?void 0:r.crv)!==null&&n!==void 0?n:"undefined"}`);let s=yield Od.keyConverter(r.crv).publicKeyToBytes({publicKey:r});/^(secp256k1|P-256|P-384|P-521)$/.test(r.crv)&&(s=yield Od.keyCompressor(r.crv)({publicKeyBytes:s}));const{name:i}=yield Od.jwkToMulticodec({jwk:r});return Pk({keyBytes:s,multicodecName:i})})}};ss.JWK_TO_MULTICODEC={"Ed25519:public":"ed25519-pub","Ed25519:private":"ed25519-priv","secp256k1:public":"secp256k1-pub","secp256k1:private":"secp256k1-priv","X25519:public":"x25519-pub","X25519:private":"x25519-priv"};ss.MULTICODEC_PUBLIC_KEY_LENGTH={231:33,236:32,237:32};ss.MULTICODEC_TO_JWK={"ed25519-pub":{crv:"Ed25519",kty:"OKP",x:""},"ed25519-priv":{crv:"Ed25519",kty:"OKP",x:"",d:""},"secp256k1-pub":{crv:"secp256k1",kty:"EC",x:"",y:""},"secp256k1-priv":{crv:"secp256k1",kty:"EC",x:"",y:"",d:""},"x25519-pub":{crv:"X25519",kty:"OKP",x:""},"x25519-priv":{crv:"X25519",kty:"OKP",x:"",d:""}};var SL=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};let Bk=class Fk extends ny{static resolve(e,r){return SL(this,void 0,void 0,function*(){const n=Jt.parse(e);if(!n)return Object.assign(Object.assign({},Bn),{didResolutionMetadata:{error:"invalidDid"}});if(n.method!==Fk.methodName)return Object.assign(Object.assign({},Bn),{didResolutionMetadata:{error:"methodNotSupported"}});let s=`https://${n.id.replace(/:/g,"/")}`;s=decodeURIComponent(s);const i=n.id.includes(":")?`${s}/did.json`:`${s}/.well-known/did.json`;try{const o=yield fetch(i);if(!o.ok)throw new Error("HTTP error status code returned");const a=yield o.json();return Object.assign(Object.assign({},Bn),{didDocument:a})}catch{return Object.assign(Object.assign({},Bn),{didResolutionMetadata:{error:"notFound"}})}})}};Bk.methodName="web";const $L={get:function(t){return null},set:function(t,e){return null},delete:function(t){return null},clear:function(){return null},close:function(){return null}};var O$=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};class xL{constructor({cache:e,didResolvers:r}){this.didResolvers=new Map,this.cache=e||$L;for(const n of r)this.didResolvers.set(n.methodName,n)}resolve(e,r){return O$(this,void 0,void 0,function*(){const n=Jt.parse(e);if(!n)return Object.assign(Object.assign({},Bn),{didResolutionMetadata:{error:Ge.InvalidDid,errorMessage:`Invalid DID URI: ${e}`}});const s=this.didResolvers.get(n.method);if(!s)return Object.assign(Object.assign({},Bn),{didResolutionMetadata:{error:Ge.MethodNotSupported,errorMessage:`Method not supported: ${n.method}`}});const i=yield this.cache.get(n.uri);if(i)return i;{const o=yield s.resolve(n.uri,r);return o.didResolutionMetadata.error||(yield this.cache.set(n.uri,o)),o}})}dereference(e,r){return O$(this,void 0,void 0,function*(){const n=Jt.parse(e);if(!n)return{dereferencingMetadata:{error:Ge.InvalidDidUrl},contentStream:null,contentMetadata:{}};const{didDocument:s,didResolutionMetadata:i,didDocumentMetadata:o}=yield this.resolve(n.uri);if(!s)return{dereferencingMetadata:{error:i.error},contentStream:null,contentMetadata:{}};if(!n.fragment||n.query)return{dereferencingMetadata:{contentType:"application/did+json"},contentStream:s,contentMetadata:o};const{service:a=[],verificationMethod:c=[]}=s,l=new Set([e,n.fragment,`#${n.fragment}`]);let u;for(let d of c)if(l.has(d.id)){u=d;break}for(let d of a)if(l.has(d.id)){u=d;break}return u?{dereferencingMetadata:{contentType:"application/did+json"},contentStream:u,contentMetadata:i}:{dereferencingMetadata:{error:Ge.NotFound},contentStream:null,contentMetadata:{}}})}}var T$=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};const DL=new p7;class jo{static sign(e){return T$(this,void 0,void 0,function*(){const{signerDid:r,payload:n}=e,s=yield r.getSigner();let i=s.keyId;i.charAt(0)==="#"&&(i=`${r.uri}${i}`);const o={typ:"JWT",alg:s.algorithm,kid:i},a=mu.object(o).toBase64Url(),c=mu.object(n).toBase64Url(),l=`${a}.${c}`,u=mu.string(l).toUint8Array(),d=yield s.sign({data:u}),h=mu.uint8Array(d).toBase64Url();return`${l}.${h}`})}static verify(e){return T$(this,void 0,void 0,function*(){const{decoded:r,encoded:n}=jo.parse({jwt:e.jwt});if(r.payload.exp&&Math.floor(Date.now()/1e3)>r.payload.exp)throw new Error("Verification failed: JWT is expired");const s=yield jo.didResolver.dereference(r.header.kid);if(s.dereferencingMetadata.error)throw new Error(`Failed to resolve ${r.header.kid}`);const i=s.contentStream;if(!i||!N0(i))throw new Error("Verification failed: Expected kid in JWT header to dereference a DID Document Verification Method");const o=i.publicKeyJwk;if(!o)throw new Error("Verification failed: Expected kid in JWT header to dereference to a DID Document Verification Method with publicKeyJwk");if(o.alg&&o.alg!==r.header.alg)throw new Error("Verification failed: Expected alg in JWT header to match DID Document Verification Method alg");const a=`${n.header}.${n.payload}`,c=mu.string(a).toUint8Array(),l=mu.base64Url(n.signature).toUint8Array();if(!(yield DL.verify({key:o,signature:l,data:c})))throw new Error("Signature verification failed: Integrity mismatch");return r})}static parse(e){const r=e.jwt.split(".");if(r.length!==3)throw new Error(`Verification failed: Malformed JWT. expected 3 parts. got ${r.length}`);const[n,s,i]=r;let o,a;try{o=mu.base64Url(n).toObject()}catch{throw new Error("Verification failed: Malformed JWT. Invalid base64url encoding for JWT header")}if(!o.typ||o.typ!=="JWT")throw new Error("Verification failed: Expected JWT header to contain typ property set to JWT");if(!o.alg||!o.kid)throw new Error("Verification failed: Expected JWT header to contain alg and kid");try{a=mu.base64Url(s).toObject()}catch{throw new Error("Verification failed: Malformed JWT. Invalid base64url encoding for JWT payload")}return{decoded:{header:o,payload:a},encoded:{header:n,payload:s,signature:i}}}}jo.didResolver=new xL({didResolvers:[R0,Ok,Ik,Tk,Bk]});const $e={INFO:"info",WARN:"warn",ERROR:"error"},j0=class{constructor(t,e,r){de(this,"tag");de(this,"status");de(this,"message");this.tag=t,this.status=e,this.message=r}},PL=t=>{function e(r){return r.status===$e.ERROR}return t.filter(r=>e(r)).length>0};var sf={},P_={},Nk={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.parseDid=t.IProofType=t.IProofPurpose=void 0,function(n){n.verificationMethod="verificationMethod",n.assertionMethod="assertionMethod",n.authentication="authentication",n.keyAgreement="keyAgreement",n.contractAgreement="contactAgreement",n.capabilityInvocation="capabilityInvocation",n.capabilityDelegation="capabilityDelegation"}(t.IProofPurpose||(t.IProofPurpose={})),function(n){n.Ed25519Signature2018="Ed25519Signature2018",n.Ed25519Signature2020="Ed25519Signature2020",n.EcdsaSecp256k1Signature2019="EcdsaSecp256k1Signature2019",n.EcdsaSecp256k1RecoverySignature2020="EcdsaSecp256k1RecoverySignature2020",n.JsonWebSignature2020="JsonWebSignature2020",n.RsaSignature2018="RsaSignature2018",n.GpgSignature2020="GpgSignature2020",n.JcsEd25519Signature2020="JcsEd25519Signature2020",n.BbsBlsSignatureProof2020="BbsBlsSignatureProof2020",n.BbsBlsBoundSignatureProof2020="BbsBlsBoundSignatureProof2020",n.JwtProof2020="JwtProof2020"}(t.IProofType||(t.IProofType={}));const e=n=>{const s=r(n);if(s===null)throw new Error("invalid did");return s};t.parseDid=e;const r=n=>{const i="(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))",o="([a-z0-9]+)",a=`((?:${i}*:)*(${i}+))`,c="[a-zA-Z0-9_.:%-]",u=`((${`;${c}+=${c}*`})*)`,d="(/[^#?]*)?",h="([?][^#]*)?",f="(#.*)?",p=new RegExp(`^did:${o}:${a}${u}${d}${h}${f}$`);if(n===""||!n)return null;const y=n.match(p);if(y){const b={did:`did:${y[1]}:${y[2]}`,method:y[1],id:y[2],didUrl:n};if(y[4]){const w=y[4].slice(1).split(";");b.params={};for(const g of w){const v=g.split("=");b.params[v[0]]=v[1]}}return y[6]&&(b.path=y[6]),y[7]&&(b.query=y[7].slice(1)),y[8]&&(b.fragment=y[8].slice(1)),b}return null}})(Nk);var Rk={};Object.defineProperty(Rk,"__esModule",{value:!0});var jk={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.JWT_PROOF_TYPE_2020=t.DocumentFormat=t.OriginalType=void 0,function(e){e.JSONLD="json-ld",e.JWT_ENCODED="jwt-encoded",e.JWT_DECODED="jwt-decoded"}(t.OriginalType||(t.OriginalType={})),function(e){e[e.JWT=0]="JWT",e[e.JSONLD=1]="JSONLD",e[e.EIP712=2]="EIP712"}(t.DocumentFormat||(t.DocumentFormat={})),t.JWT_PROOF_TYPE_2020="JwtProof2020"})(jk);var Mk={};Object.defineProperty(Mk,"__esModule",{value:!0});(function(t){var e=Zt&&Zt.__createBinding||(Object.create?function(n,s,i,o){o===void 0&&(o=i);var a=Object.getOwnPropertyDescriptor(s,i);(!a||("get"in a?!s.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return s[i]}}),Object.defineProperty(n,o,a)}:function(n,s,i,o){o===void 0&&(o=i),n[o]=s[i]}),r=Zt&&Zt.__exportStar||function(n,s){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(s,i)&&e(s,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(Nk,t),r(Rk,t),r(jk,t),r(Mk,t)})(P_);var C_={},Bg={};Object.defineProperty(Bg,"__esModule",{value:!0});Bg.ObjectUtils=void 0;let CL=class Uk{static asArray(e){return Array.isArray(e)?e:[e]}static isObject(e){return Object.prototype.toString.call(e)==="[object Object]"}static isUrlAbsolute(e){const r=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;Uk.isString(e)&&r.test(e)}static isString(e){return typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"}};Bg.ObjectUtils=CL;(function(t){var e=Zt&&Zt.__createBinding||(Object.create?function(n,s,i,o){o===void 0&&(o=i);var a=Object.getOwnPropertyDescriptor(s,i);(!a||("get"in a?!s.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return s[i]}}),Object.defineProperty(n,o,a)}:function(n,s,i,o){o===void 0&&(o=i),n[o]=s[i]}),r=Zt&&Zt.__exportStar||function(n,s){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(s,i)&&e(s,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(Bg,t)})(C_);var Kk={},Fg={};function Vb(t){this.message=t}Vb.prototype=new Error,Vb.prototype.name="InvalidCharacterError";var I$=typeof window<"u"&&window.atob&&window.atob.bind(window)||function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new Vb("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,s=0,i=0,o="";n=e.charAt(i++);~n&&(r=s%4?64*r+n:n,s++%4)?o+=String.fromCharCode(255&r>>(-2*s&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return o};function kL(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return function(r){return decodeURIComponent(I$(r).replace(/(.)/g,function(n,s){var i=s.charCodeAt(0).toString(16).toUpperCase();return i.length<2&&(i="0"+i),"%"+i}))}(e)}catch{return I$(e)}}function Dh(t){this.message=t}function OL(t,e){if(typeof t!="string")throw new Dh("Invalid token specified");var r=(e=e||{}).header===!0?0:1;try{return JSON.parse(kL(t.split(".")[r]))}catch(n){throw new Dh("Invalid token specified: "+n.message)}}Dh.prototype=new Error,Dh.prototype.name="InvalidTokenError";const TL=Object.freeze(Object.defineProperty({__proto__:null,InvalidTokenError:Dh,default:OL},Symbol.toStringTag,{value:"Module"})),IL=uB(TL);var B$=Zt&&Zt.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r},BL=Zt&&Zt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Fg,"__esModule",{value:!0});Fg.CredentialMapper=void 0;const ao=P_,vd=BL(IL),F$=C_;class mt{static decodeVerifiablePresentation(e){var r;if(mt.isJwtEncoded(e)){const n=(0,vd.default)(e),s=(0,vd.default)(e,{header:!0});return n.vp.proof={type:ao.IProofType.JwtProof2020,created:n.nbf,proofPurpose:ao.IProofPurpose.authentication,verificationMethod:(r=s.kid)!==null&&r!==void 0?r:n.iss,jwt:e},n}else return mt.isJwtDecodedPresentation(e)?e:mt.isJsonLdAsString(e)?JSON.parse(e):e}static decodeVerifiableCredential(e){var r;if(mt.isJwtEncoded(e)){const n=(0,vd.default)(e),s=(0,vd.default)(e,{header:!0});return n.vc.proof={type:ao.IProofType.JwtProof2020,created:n.nbf,proofPurpose:ao.IProofPurpose.authentication,verificationMethod:(r=s.kid)!==null&&r!==void 0?r:n.iss,jwt:e},n}else return mt.isJwtDecodedCredential(e)?e:mt.isJsonLdAsString(e)?JSON.parse(e):e}static toWrappedVerifiablePresentation(e,r){const n=mt.getFirstProof(e),s=typeof e!="string"&&mt.hasJWTProofType(e)?n==null?void 0:n.jwt:e;if(!s)throw Error("Could not determine original presentation, probably it was a converted JWT presentation, that is now missing the JWT value in the proof");const i=mt.decodeVerifiablePresentation(s),o=mt.isJwtEncoded(s),a=mt.isJwtDecodedPresentation(s),c=o?ao.OriginalType.JWT_ENCODED:a?ao.OriginalType.JWT_DECODED:ao.OriginalType.JSONLD,l=a||o?"jwt_vp":"ldp_vp";let u;if(o||a?u=mt.jwtDecodedPresentationToUniformPresentation(i,!1,r):u=i,!u||!("verifiableCredential"in u)||!u.verifiableCredential||u.verifiableCredential.length===0)throw Error("VP needs to have at least one verifiable credential at this point");const d=mt.toWrappedVerifiableCredentials(u.verifiableCredential,r),h=Object.assign(Object.assign({},u),{verifiableCredential:d});return{type:c,format:l,original:s,decoded:i,presentation:h,vcs:d}}static toWrappedVerifiableCredentials(e,r){return e.map(n=>mt.toWrappedVerifiableCredential(n,r))}static toWrappedVerifiableCredential(e,r){var n;const s=mt.getFirstProof(e),i=mt.hasJWTProofType(e)&&s&&(n=s.jwt)!==null&&n!==void 0?n:e;if(!i)throw Error("Could not determine original credential, probably it was a converted JWT credential, that is now missing the JWT value in the proof");const o=mt.decodeVerifiableCredential(i),a=mt.isJwtEncoded(i),c=mt.isJwtDecodedCredential(i),l=a?ao.OriginalType.JWT_ENCODED:c?ao.OriginalType.JWT_DECODED:ao.OriginalType.JSONLD,u=a||c?mt.jwtDecodedCredentialToUniformCredential(o,r):o;return{original:i,decoded:o,format:a||c?"jwt_vc":"ldp_vc",type:l,credential:u}}static isJwtEncoded(e){return F$.ObjectUtils.isString(e)&&e.startsWith("ey")}static isJsonLdAsString(e){return F$.ObjectUtils.isString(e)&&e.includes("@context")}static isJwtDecodedCredential(e){return e.vc!==void 0&&e.iss!==void 0}static isJwtDecodedPresentation(e){return e.vp!==void 0&&e.iss!==void 0}static jwtEncodedPresentationToUniformPresentation(e,r=!0,n){return mt.jwtDecodedPresentationToUniformPresentation((0,vd.default)(e),r,n)}static jwtDecodedPresentationToUniformPresentation(e,r=!0,n){const{iss:s,aud:i,jti:o,vp:a}=e,c=B$(e,["iss","aud","jti","vp"]),l=Object.assign(Object.assign({},c),a);if(r){if(!a.verifiableCredential)throw Error("Verifiable Presentation should have a verifiable credential at this point");l.verifiableCredential=a.verifiableCredential.map(u=>mt.toUniformCredential(u,n))}if(s){const u=l.holder;if(u&&u!==s)throw new Error(`Inconsistent holders between JWT claim (${s}) and VC value (${u})`);l.holder=s}if(i){const u=l.verifier;if(u&&u!==i)throw new Error(`Inconsistent holders between JWT claim (${i}) and VC value (${u})`);l.verifier=i}if(o){const u=l.id;if(u&&u!==o)throw new Error(`Inconsistent VP ids between JWT claim (${o}) and VP value (${u})`);l.id=o}return l}static toUniformCredential(e,r){var n;const s=typeof e!="string"&&mt.hasJWTProofType(e)?(n=mt.getFirstProof(e))===null||n===void 0?void 0:n.jwt:e;if(!s)throw Error("Could not determine original credential from passed in credential. Probably because a JWT proof type was present, but now is not available anymore");const i=mt.decodeVerifiableCredential(s),o=mt.isJwtEncoded(s);return mt.isJwtDecodedCredential(s)||o?mt.jwtDecodedCredentialToUniformCredential(i,r):i}static toUniformPresentation(e,r){var n;const s=mt.getFirstProof(e),i=typeof e!="string"&&mt.hasJWTProofType(e)?s==null?void 0:s.jwt:e;if(!i)throw Error("Could not determine original presentation, probably it was a converted JWT presentation, that is now missing the JWT value in the proof");const o=mt.decodeVerifiablePresentation(i),a=mt.isJwtEncoded(i),c=mt.isJwtDecodedPresentation(i),l=a||c?mt.jwtDecodedPresentationToUniformPresentation(o,!1):o;return r!=null&&r.addContextIfMissing&&!l["@context"]&&(l["@context"]=["https://www.w3.org/2018/credentials/v1"]),l.verifiableCredential=(n=l.verifiableCredential)===null||n===void 0?void 0:n.map(u=>mt.toUniformCredential(u,r)),l}static jwtEncodedCredentialToUniformCredential(e,r){return mt.jwtDecodedCredentialToUniformCredential((0,vd.default)(e),r)}static jwtDecodedCredentialToUniformCredential(e,r){const{exp:n,nbf:s,iss:i,vc:o,sub:a,jti:c}=e,l=B$(e,["exp","nbf","iss","vc","sub","jti"]),u=Object.assign(Object.assign({},l),o),d=(r==null?void 0:r.maxTimeSkewInMS)!==void 0?r.maxTimeSkewInMS:999;if(n){const h=u.expirationDate,f=parseInt(n.toString()),p=f<9999999999?new Date(f*1e3).toISOString().replace(/\.000Z/,"Z"):new Date(f).toISOString();if(h&&h!==p){const y=Math.abs(new Date(p).getTime()-new Date(h).getTime());if(!d||y>d)throw new Error(`Inconsistent expiration dates between JWT claim (${p}) and VC value (${h})`)}u.expirationDate=p}if(s){const h=u.issuanceDate,f=parseInt(s.toString()),p=f<9999999999?new Date(f*1e3).toISOString().replace(/\.000Z/,"Z"):new Date(f).toISOString();if(h&&h!==p){const y=Math.abs(new Date(p).getTime()-new Date(h).getTime());if(!d||y>d)throw new Error(`Inconsistent issuance dates between JWT claim (${p}) and VC value (${h})`)}u.issuanceDate=p}if(i){const h=u.issuer;if(h){if(typeof h=="string"){if(h!==i)throw new Error(`Inconsistent issuers between JWT claim (${i}) and VC value (${h})`)}else if(h.id!==i)throw new Error(`Inconsistent issuers between JWT claim (${i}) and VC value (${h.id})`)}else u.issuer=i}if(a){const h=Array.isArray(u.credentialSubject)?u.credentialSubject:[u.credentialSubject];for(let f=0;f<h.length;f++){const p=h[f].id;if(p&&p!==a)throw new Error(`Inconsistent credential subject ids between JWT claim (${a}) and VC value (${p})`);Array.isArray(u.credentialSubject)?u.credentialSubject[f].id=a:u.credentialSubject.id=a}}if(c){const h=u.id;if(h&&h!==c)throw new Error(`Inconsistent credential ids between JWT claim (${c}) and VC value (${h})`);u.id=c}return u}static toExternalVerifiableCredential(e){let r;if(e.proof){if(!e.proof.type)throw new Error("Verifiable credential proof is missing a type");if(!e.proof.created)throw new Error("Verifiable credential proof is missing a created date");if(!e.proof.proofPurpose)throw new Error("Verifiable credential proof is missing a proof purpose");if(!e.proof.verificationMethod)throw new Error("Verifiable credential proof is missing a verification method");r=Object.assign(Object.assign({},e.proof),{type:e.proof.type,created:e.proof.created,proofPurpose:e.proof.proofPurpose,verificationMethod:e.proof.verificationMethod})}return Object.assign(Object.assign({},e),{type:e.type?typeof e.type=="string"?[e.type]:e.type:["VerifiableCredential"],proof:r})}static storedCredentialToOriginalFormat(e){const r=mt.detectDocumentType(e);if(typeof e=="string"){if(r===0)return mt.toCompactJWT(e);if(r===1)return JSON.parse(e)}return e}static storedPresentationToOriginalFormat(e){const r=mt.detectDocumentType(e);if(typeof e=="string"){if(r===0)return mt.toCompactJWT(e);if(r===1)return JSON.parse(e)}return e}static toCompactJWT(e){if(!e||mt.detectDocumentType(e)!==0)throw Error("Cannot convert non JWT credential to JWT");if(typeof e=="string")return e;let r;if("vp"in e?r=e.vp.proof:"vc"in e?r=e.vc.proof:r=Array.isArray(e.proof)?e.proof[0].jwt:e.proof.jwt,!r)throw Error("Could not get JWT from supplied document");return r}static detectDocumentType(e){if(typeof e=="string")return this.isJsonLdAsString(e)?1:0;const r="vc"in e?e.vc.proof:"vp"in e?e.vp.proof:e.proof,n=Array.isArray(r)?r[0]:r;return n!=null&&n.jwt?0:(n==null?void 0:n.type)==="EthereumEip712Signature2021"?2:1}static hasJWTProofType(e){var r;return typeof e=="string"?!1:!!(!((r=mt.getFirstProof(e))===null||r===void 0)&&r.jwt)}static getFirstProof(e){if(!e||typeof e=="string")return;const r="vc"in e?e.vc.proof:"vp"in e?e.vp.proof:e.proof;return Array.isArray(r)?r[0]:r}}Fg.CredentialMapper=mt;(function(t){var e=Zt&&Zt.__createBinding||(Object.create?function(n,s,i,o){o===void 0&&(o=i);var a=Object.getOwnPropertyDescriptor(s,i);(!a||("get"in a?!s.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return s[i]}}),Object.defineProperty(n,o,a)}:function(n,s,i,o){o===void 0&&(o=i),n[o]=s[i]}),r=Zt&&Zt.__exportStar||function(n,s){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(s,i)&&e(s,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(Fg,t)})(Kk);(function(t){var e=Zt&&Zt.__createBinding||(Object.create?function(n,s,i,o){o===void 0&&(o=i);var a=Object.getOwnPropertyDescriptor(s,i);(!a||("get"in a?!s.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return s[i]}}),Object.defineProperty(n,o,a)}:function(n,s,i,o){o===void 0&&(o=i),n[o]=s[i]}),r=Zt&&Zt.__exportStar||function(n,s){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(s,i)&&e(s,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(P_,t),r(C_,t),r(Kk,t)})(sf);var zb;(function(t){t.INPUT_CANDIDATE_DOESNT_CONTAIN_PROPERTY="Input candidate does not contain property",t.INPUT_CANDIDATE_FAILED_FILTER_EVALUATION="Input candidate failed filter evaluation",t.INPUT_CANDIDATE_IS_ELIGIBLE_FOR_PRESENTATION_SUBMISSION="The input candidate is eligible for submission",t.INPUT_CANDIDATE_IS_NOT_ELIGIBLE_FOR_PRESENTATION_SUBMISSION="The input candidate is not eligible for submission",t.INPUT_DESCRIPTOR_CONTEXT_CONTAINS_HASHLINK_VERIFICATION_NOT_SUPPORTED="Input descriptor contains hashlink. This version doesn't support hashlink verification.",t.LIMIT_DISCLOSURE_APPLIED="added variable in the limit_disclosure to the verifiableCredential",t.LIMIT_DISCLOSURE_NOT_SUPPORTED="Limit disclosure not supported",t.SUBJECT_IS_NOT_ISSUER="subject is not issuer",t.SUBJECT_IS_ISSUER="subject is issuer",t.FORMAT_RESTRICTION_PASSED="the Credential format of the candidate inputs matches the required formats",t.FORMAT_RESTRICTION_DIDNT_PASS="the Credential format of the candidate inputs didn't match the required formats",t.URI_EVALUATION_PASSED="@context URI(s) for the schema of the candidate input is equal to one of the input_descriptors object uri values.",t.URI_EVALUATION_DIDNT_PASS="@context URI for the of the candidate input MUST be equal to one of the input_descriptors object uri values exactly.",t.UNKNOWN_EXCEPTION="unknown exception occurred: ",t.VERIFIABLE_CREDENTIAL_MANDATORY_FIELD_NOT_PRESENT="mandatory field not present in the verifiableCredential"})(zb||(zb={}));const qr=zb;var Be,Js,Lk,qu,Ie,k_,qk,ke,Yt,oe,bt,kt,ir,me,Te,Xe,Pe;Be={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9};Js={};Js[Be.BooleanLiteral]="Boolean";Js[Be.EOF]="<end>";Js[Be.Identifier]="Identifier";Js[Be.Keyword]="Keyword";Js[Be.NullLiteral]="Null";Js[Be.NumericLiteral]="Numeric";Js[Be.Punctuator]="Punctuator";Js[Be.StringLiteral]="String";Js[Be.RegularExpression]="RegularExpression";Lk=["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="];var st={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement"};qu={Data:1,Get:2,Set:4};Ie={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"};k_={NonAsciiIdentifierStart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]"),NonAsciiIdentifierPart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮ̀-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁ҃-҇Ҋ-ԧԱ-Ֆՙա-և֑-ׇֽֿׁׂׅׄא-תװ-ײؐ-ؚؠ-٩ٮ-ۓە-ۜ۟-۪ۨ-ۼۿܐ-݊ݍ-ޱ߀-ߵߺࠀ-࠭ࡀ-࡛ࢠࢢ-ࢬࣤ-ࣾऀ-ॣ०-९ॱ-ॷॹ-ॿঁ-ঃঅ-ঌএঐও-নপ-রলশ-হ়-ৄেৈো-ৎৗড়ঢ়য়-ৣ০-ৱਁ-ਃਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹ਼ਾ-ੂੇੈੋ-੍ੑਖ਼-ੜਫ਼੦-ੵઁ-ઃઅ-ઍએ-ઑઓ-નપ-રલળવ-હ઼-ૅે-ૉો-્ૐૠ-ૣ૦-૯ଁ-ଃଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହ଼-ୄେୈୋ-୍ୖୗଡ଼ଢ଼ୟ-ୣ୦-୯ୱஂஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹா-ூெ-ைொ-்ௐௗ௦-௯ఁ-ఃఅ-ఌఎ-ఐఒ-నప-ళవ-హఽ-ౄె-ైొ-్ౕౖౘౙౠ-ౣ౦-౯ಂಃಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹ಼-ೄೆ-ೈೊ-್ೕೖೞೠ-ೣ೦-೯ೱೲംഃഅ-ഌഎ-ഐഒ-ഺഽ-ൄെ-ൈൊ-ൎൗൠ-ൣ൦-൯ൺ-ൿංඃඅ-ඖක-නඳ-රලව-ෆ්ා-ුූෘ-ෟෲෳก-ฺเ-๎๐-๙ກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ູົ-ຽເ-ໄໆ່-ໍ໐-໙ໜ-ໟༀ༘༙༠-༩༹༵༷༾-ཇཉ-ཬཱ-྄྆-ྗྙ-ྼ࿆က-၉ၐ-ႝႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚ፝-፟ᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-᜔ᜠ-᜴ᝀ-ᝓᝠ-ᝬᝮ-ᝰᝲᝳក-៓ៗៜ៝០-៩᠋-᠍᠐-᠙ᠠ-ᡷᢀ-ᢪᢰ-ᣵᤀ-ᤜᤠ-ᤫᤰ-᤻᥆-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉ᧐-᧙ᨀ-ᨛᨠ-ᩞ᩠-᩿᩼-᪉᪐-᪙ᪧᬀ-ᭋ᭐-᭙᭫-᭳ᮀ-᯳ᰀ-᰷᱀-᱉ᱍ-ᱽ᳐-᳔᳒-ᳶᴀ-ᷦ᷼-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼ‌‍‿⁀⁔ⁱⁿₐ-ₜ⃐-⃥⃜⃡-⃰ℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯ⵿-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⷠ-ⷿⸯ々-〇〡-〯〱-〵〸-〼ぁ-ゖ゙゚ゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘫꙀ-꙯ꙴ-꙽ꙿ-ꚗꚟ-꛱ꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠧꡀ-ꡳꢀ-꣄꣐-꣙꣠-ꣷꣻ꤀-꤭ꤰ-꥓ꥠ-ꥼꦀ-꧀ꧏ-꧙ꨀ-ꨶꩀ-ꩍ꩐-꩙ꩠ-ꩶꩺꩻꪀ-ꫂꫛ-ꫝꫠ-ꫯꫲ-꫶ꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯪ꯬꯭꯰-꯹가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻ︀-️︠-︦︳︴﹍-﹏ﹰ-ﹴﹶ-ﻼ０-９Ａ-Ｚ＿ａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]")};function iy(t,e){if(!t)throw new Error("ASSERT: "+e)}function Oa(t){return t>=48&&t<=57}function Vk(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function Xp(t){return"01234567".indexOf(t)>=0}function FL(t){return t===32||t===9||t===11||t===12||t===160||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function Hl(t){return t===10||t===13||t===8232||t===8233}function mf(t){return t==64||t===36||t===95||t>=65&&t<=90||t>=97&&t<=122||t===92||t>=128&&k_.NonAsciiIdentifierStart.test(String.fromCharCode(t))}function M0(t){return t===36||t===95||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||t===92||t>=128&&k_.NonAsciiIdentifierPart.test(String.fromCharCode(t))}function NL(t){switch(t){case"class":case"enum":case"export":case"extends":case"import":case"super":return!0;default:return!1}}function sy(t){switch(t){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}}function bs(t){return t==="eval"||t==="arguments"}function RL(t){if(Yt&&sy(t))return!0;switch(t.length){case 2:return t==="if"||t==="in"||t==="do";case 3:return t==="var"||t==="for"||t==="new"||t==="try"||t==="let";case 4:return t==="this"||t==="else"||t==="case"||t==="void"||t==="with"||t==="enum";case 5:return t==="while"||t==="break"||t==="catch"||t==="throw"||t==="const"||t==="yield"||t==="class"||t==="super";case 6:return t==="return"||t==="typeof"||t==="delete"||t==="switch"||t==="export"||t==="import";case 7:return t==="default"||t==="finally"||t==="extends";case 8:return t==="function"||t==="continue"||t==="debugger";case 10:return t==="instanceof";default:return!1}}function Hb(t,e,r,n,s){var i;iy(typeof r=="number","Comment must have valid position"),!(Xe.lastCommentStart>=r)&&(Xe.lastCommentStart=r,i={type:t,value:e},Pe.range&&(i.range=[r,n]),Pe.loc&&(i.loc=s),Pe.comments.push(i),Pe.attachComment&&(Pe.leadingComments.push(i),Pe.trailingComments.push(i)))}function sw(t){var e,r,n,s;for(e=oe-t,r={start:{line:bt,column:oe-kt-t}};oe<ir;)if(n=ke.charCodeAt(oe),++oe,Hl(n)){Pe.comments&&(s=ke.slice(e+t,oe-1),r.end={line:bt,column:oe-kt-1},Hb("Line",s,e,oe-1,r)),n===13&&ke.charCodeAt(oe)===10&&++oe,++bt,kt=oe;return}Pe.comments&&(s=ke.slice(e+t,oe),r.end={line:bt,column:oe-kt},Hb("Line",s,e,oe,r))}function jL(){var t,e,r,n;for(Pe.comments&&(t=oe-2,e={start:{line:bt,column:oe-kt-2}});oe<ir;)if(r=ke.charCodeAt(oe),Hl(r))r===13&&ke.charCodeAt(oe+1)===10&&++oe,++bt,++oe,kt=oe,oe>=ir&&At({},Ie.UnexpectedToken,"ILLEGAL");else if(r===42){if(ke.charCodeAt(oe+1)===47){++oe,++oe,Pe.comments&&(n=ke.slice(t+2,oe-2),e.end={line:bt,column:oe-kt},Hb("Block",n,t,oe,e));return}++oe}else++oe;At({},Ie.UnexpectedToken,"ILLEGAL")}function xc(){var t,e;for(e=oe===0;oe<ir;)if(t=ke.charCodeAt(oe),FL(t))++oe;else if(Hl(t))++oe,t===13&&ke.charCodeAt(oe)===10&&++oe,++bt,kt=oe,e=!0;else if(t===47)if(t=ke.charCodeAt(oe+1),t===47)++oe,++oe,sw(2),e=!0;else if(t===42)++oe,++oe,jL();else break;else if(e&&t===45)if(ke.charCodeAt(oe+1)===45&&ke.charCodeAt(oe+2)===62)oe+=3,sw(3);else break;else if(t===60)if(ke.slice(oe+1,oe+4)==="!--")++oe,++oe,++oe,++oe,sw(4);else break;else break}function U0(t){var e,r,n,s=0;for(r=t==="u"?4:2,e=0;e<r;++e)if(oe<ir&&Vk(ke[oe]))n=ke[oe++],s=s*16+"0123456789abcdef".indexOf(n.toLowerCase());else return"";return String.fromCharCode(s)}function zk(){var t,e;for(t=ke.charCodeAt(oe++),e=String.fromCharCode(t),t===92&&(ke.charCodeAt(oe)!==117&&At({},Ie.UnexpectedToken,"ILLEGAL"),++oe,t=U0("u"),(!t||t==="\\"||!mf(t.charCodeAt(0)))&&At({},Ie.UnexpectedToken,"ILLEGAL"),e=t);oe<ir&&(t=ke.charCodeAt(oe),!!M0(t));)++oe,e+=String.fromCharCode(t),t===92&&(e=e.substr(0,e.length-1),ke.charCodeAt(oe)!==117&&At({},Ie.UnexpectedToken,"ILLEGAL"),++oe,t=U0("u"),(!t||t==="\\"||!M0(t.charCodeAt(0)))&&At({},Ie.UnexpectedToken,"ILLEGAL"),e+=t);return e}function ML(){var t,e;for(t=oe++;oe<ir;){if(e=ke.charCodeAt(oe),e===92)return oe=t,zk();if(M0(e))++oe;else break}return ke.slice(t,oe)}function UL(){var t,e,r;return t=oe,e=ke.charCodeAt(oe)===92?zk():ML(),e.length===1?r=Be.Identifier:RL(e)?r=Be.Keyword:e==="null"?r=Be.NullLiteral:e==="true"||e==="false"?r=Be.BooleanLiteral:r=Be.Identifier,{type:r,value:e,lineNumber:bt,lineStart:kt,start:t,end:oe}}function Ta(){var t=oe,e=ke.charCodeAt(oe),r,n=ke[oe],s,i,o;switch(e){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++oe,Pe.tokenize&&(e===40?Pe.openParenToken=Pe.tokens.length:e===123&&(Pe.openCurlyToken=Pe.tokens.length)),{type:Be.Punctuator,value:String.fromCharCode(e),lineNumber:bt,lineStart:kt,start:t,end:oe};default:if(r=ke.charCodeAt(oe+1),r===61)switch(e){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return oe+=2,{type:Be.Punctuator,value:String.fromCharCode(e)+String.fromCharCode(r),lineNumber:bt,lineStart:kt,start:t,end:oe};case 33:case 61:return oe+=2,ke.charCodeAt(oe)===61&&++oe,{type:Be.Punctuator,value:ke.slice(t,oe),lineNumber:bt,lineStart:kt,start:t,end:oe}}}if(o=ke.substr(oe,4),o===">>>=")return oe+=4,{type:Be.Punctuator,value:o,lineNumber:bt,lineStart:kt,start:t,end:oe};if(i=o.substr(0,3),i===">>>"||i==="<<="||i===">>=")return oe+=3,{type:Be.Punctuator,value:i,lineNumber:bt,lineStart:kt,start:t,end:oe};if(s=i.substr(0,2),n===s[1]&&"+-<>&|".indexOf(n)>=0||s==="=>")return oe+=2,{type:Be.Punctuator,value:s,lineNumber:bt,lineStart:kt,start:t,end:oe};if("<>=!+-*%&|^/".indexOf(n)>=0)return++oe,{type:Be.Punctuator,value:n,lineNumber:bt,lineStart:kt,start:t,end:oe};At({},Ie.UnexpectedToken,"ILLEGAL")}function KL(t){for(var e="";oe<ir&&Vk(ke[oe]);)e+=ke[oe++];return e.length===0&&At({},Ie.UnexpectedToken,"ILLEGAL"),mf(ke.charCodeAt(oe))&&At({},Ie.UnexpectedToken,"ILLEGAL"),{type:Be.NumericLiteral,value:parseInt("0x"+e,16),lineNumber:bt,lineStart:kt,start:t,end:oe}}function LL(t){for(var e="0"+ke[oe++];oe<ir&&Xp(ke[oe]);)e+=ke[oe++];return(mf(ke.charCodeAt(oe))||Oa(ke.charCodeAt(oe)))&&At({},Ie.UnexpectedToken,"ILLEGAL"),{type:Be.NumericLiteral,value:parseInt(e,8),octal:!0,lineNumber:bt,lineStart:kt,start:t,end:oe}}function N$(){var t,e,r;if(r=ke[oe],iy(Oa(r.charCodeAt(0))||r===".","Numeric literal must start with a decimal digit or a decimal point"),e=oe,t="",r!=="."){if(t=ke[oe++],r=ke[oe],t==="0"){if(r==="x"||r==="X")return++oe,KL(e);if(Xp(r))return LL(e);r&&Oa(r.charCodeAt(0))&&At({},Ie.UnexpectedToken,"ILLEGAL")}for(;Oa(ke.charCodeAt(oe));)t+=ke[oe++];r=ke[oe]}if(r==="."){for(t+=ke[oe++];Oa(ke.charCodeAt(oe));)t+=ke[oe++];r=ke[oe]}if(r==="e"||r==="E")if(t+=ke[oe++],r=ke[oe],(r==="+"||r==="-")&&(t+=ke[oe++]),Oa(ke.charCodeAt(oe)))for(;Oa(ke.charCodeAt(oe));)t+=ke[oe++];else At({},Ie.UnexpectedToken,"ILLEGAL");return mf(ke.charCodeAt(oe))&&At({},Ie.UnexpectedToken,"ILLEGAL"),{type:Be.NumericLiteral,value:parseFloat(t),lineNumber:bt,lineStart:kt,start:e,end:oe}}function qL(){var t="",e,r,n,s,i,o,a=!1,c,l;for(c=bt,l=kt,e=ke[oe],iy(e==="'"||e==='"',"String literal must starts with a quote"),r=oe,++oe;oe<ir;)if(n=ke[oe++],n===e){e="";break}else if(n==="\\")if(n=ke[oe++],!n||!Hl(n.charCodeAt(0)))switch(n){case"u":case"x":o=oe,i=U0(n),i?t+=i:(oe=o,t+=n);break;case"n":t+=`
`;break;case"r":t+="\r";break;case"t":t+="	";break;case"b":t+="\b";break;case"f":t+="\f";break;case"v":t+="\v";break;default:Xp(n)?(s="01234567".indexOf(n),s!==0&&(a=!0),oe<ir&&Xp(ke[oe])&&(a=!0,s=s*8+"01234567".indexOf(ke[oe++]),"0123".indexOf(n)>=0&&oe<ir&&Xp(ke[oe])&&(s=s*8+"01234567".indexOf(ke[oe++]))),t+=String.fromCharCode(s)):t+=n;break}else++bt,n==="\r"&&ke[oe]===`
`&&++oe,kt=oe;else{if(Hl(n.charCodeAt(0)))break;t+=n}return e!==""&&At({},Ie.UnexpectedToken,"ILLEGAL"),{type:Be.StringLiteral,value:t,octal:a,startLineNumber:c,startLineStart:l,lineNumber:bt,lineStart:kt,start:r,end:oe}}function VL(t,e){var r;try{r=new RegExp(t,e)}catch{At({},Ie.InvalidRegExp)}return r}function zL(){var t,e,r,n,s;for(t=ke[oe],iy(t==="/","Regular expression literal must start with a slash"),e=ke[oe++],r=!1,n=!1;oe<ir;)if(t=ke[oe++],e+=t,t==="\\")t=ke[oe++],Hl(t.charCodeAt(0))&&At({},Ie.UnterminatedRegExp),e+=t;else if(Hl(t.charCodeAt(0)))At({},Ie.UnterminatedRegExp);else if(r)t==="]"&&(r=!1);else if(t==="/"){n=!0;break}else t==="["&&(r=!0);return n||At({},Ie.UnterminatedRegExp),s=e.substr(1,e.length-2),{value:s,literal:e}}function HL(){var t,e,r,n;for(e="",r="";oe<ir&&(t=ke[oe],!!M0(t.charCodeAt(0)));)if(++oe,t==="\\"&&oe<ir)if(t=ke[oe],t==="u"){if(++oe,n=oe,t=U0("u"),t)for(r+=t,e+="\\u";n<oe;++n)e+=ke[n];else oe=n,r+="u",e+="\\u";Qt({},Ie.UnexpectedToken,"ILLEGAL")}else e+="\\",Qt({},Ie.UnexpectedToken,"ILLEGAL");else r+=t,e+=t;return{value:r,literal:e}}function Hk(){var t,e,r,n;return Te=null,xc(),t=oe,e=zL(),r=HL(),n=VL(e.value,r.value),Pe.tokenize?{type:Be.RegularExpression,value:n,lineNumber:bt,lineStart:kt,start:t,end:oe}:{literal:e.literal+r.literal,value:n,start:t,end:oe}}function ol(){var t,e,r,n;return xc(),t=oe,e={start:{line:bt,column:oe-kt}},r=Hk(),e.end={line:bt,column:oe-kt},Pe.tokenize||(Pe.tokens.length>0&&(n=Pe.tokens[Pe.tokens.length-1],n.range[0]===t&&n.type==="Punctuator"&&(n.value==="/"||n.value==="/=")&&Pe.tokens.pop()),Pe.tokens.push({type:"RegularExpression",value:r.literal,range:[t,oe],loc:e})),r}function WL(t){return t.type===Be.Identifier||t.type===Be.Keyword||t.type===Be.BooleanLiteral||t.type===Be.NullLiteral}function JL(){var t,e;if(t=Pe.tokens[Pe.tokens.length-1],!t)return ol();if(t.type==="Punctuator"){if(t.value==="]")return Ta();if(t.value===")")return e=Pe.tokens[Pe.openParenToken-1],e&&e.type==="Keyword"&&(e.value==="if"||e.value==="while"||e.value==="for"||e.value==="with")?ol():Ta();if(t.value==="}"){if(Pe.tokens[Pe.openCurlyToken-3]&&Pe.tokens[Pe.openCurlyToken-3].type==="Keyword"){if(e=Pe.tokens[Pe.openCurlyToken-4],!e)return Ta()}else if(Pe.tokens[Pe.openCurlyToken-4]&&Pe.tokens[Pe.openCurlyToken-4].type==="Keyword"){if(e=Pe.tokens[Pe.openCurlyToken-5],!e)return ol()}else return Ta();return Lk.indexOf(e.value)>=0?Ta():ol()}return ol()}return t.type==="Keyword"?ol():Ta()}function O_(){var t;return xc(),oe>=ir?{type:Be.EOF,lineNumber:bt,lineStart:kt,start:oe,end:oe}:(t=ke.charCodeAt(oe),mf(t)?UL():t===40||t===41||t===59?Ta():t===39||t===34?qL():t===46?Oa(ke.charCodeAt(oe+1))?N$():Ta():Oa(t)?N$():Pe.tokenize&&t===47?JL():Ta())}function Wk(){var t,e,r;return xc(),t={start:{line:bt,column:oe-kt}},e=O_(),t.end={line:bt,column:oe-kt},e.type!==Be.EOF&&(r=ke.slice(e.start,e.end),Pe.tokens.push({type:Js[e.type],value:r,range:[e.start,e.end],loc:t})),e}function Ot(){var t;return t=Te,oe=t.end,bt=t.lineNumber,kt=t.lineStart,Te=typeof Pe.tokens<"u"?Wk():O_(),oe=t.end,bt=t.lineNumber,kt=t.lineStart,t}function Jk(){var t,e,r;t=oe,e=bt,r=kt,Te=typeof Pe.tokens<"u"?Wk():O_(),oe=t,bt=e,kt=r}function R$(t,e){this.line=t,this.column=e}function GL(t,e,r,n){this.start=new R$(t,e),this.end=new R$(r,n)}qk={name:"SyntaxTree",processComment:function(t){var e,r;if(!(t.type===st.Program&&t.body.length>0)){for(Pe.trailingComments.length>0?Pe.trailingComments[0].range[0]>=t.range[1]?(r=Pe.trailingComments,Pe.trailingComments=[]):Pe.trailingComments.length=0:Pe.bottomRightStack.length>0&&Pe.bottomRightStack[Pe.bottomRightStack.length-1].trailingComments&&Pe.bottomRightStack[Pe.bottomRightStack.length-1].trailingComments[0].range[0]>=t.range[1]&&(r=Pe.bottomRightStack[Pe.bottomRightStack.length-1].trailingComments,delete Pe.bottomRightStack[Pe.bottomRightStack.length-1].trailingComments);Pe.bottomRightStack.length>0&&Pe.bottomRightStack[Pe.bottomRightStack.length-1].range[0]>=t.range[0];)e=Pe.bottomRightStack.pop();e?e.leadingComments&&e.leadingComments[e.leadingComments.length-1].range[1]<=t.range[0]&&(t.leadingComments=e.leadingComments,delete e.leadingComments):Pe.leadingComments.length>0&&Pe.leadingComments[Pe.leadingComments.length-1].range[1]<=t.range[0]&&(t.leadingComments=Pe.leadingComments,Pe.leadingComments=[]),r&&(t.trailingComments=r),Pe.bottomRightStack.push(t)}},markEnd:function(t,e){return Pe.range&&(t.range=[e.start,oe]),Pe.loc&&(t.loc=new GL(e.startLineNumber===void 0?e.lineNumber:e.startLineNumber,e.start-(e.startLineStart===void 0?e.lineStart:e.startLineStart),bt,oe-kt),this.postProcess(t)),Pe.attachComment&&this.processComment(t),t},postProcess:function(t){return Pe.source&&(t.loc.source=Pe.source),t},createArrayExpression:function(t){return{type:st.ArrayExpression,elements:t}},createAssignmentExpression:function(t,e,r){return{type:st.AssignmentExpression,operator:t,left:e,right:r}},createBinaryExpression:function(t,e,r){var n=t==="||"||t==="&&"?st.LogicalExpression:st.BinaryExpression;return{type:n,operator:t,left:e,right:r}},createBlockStatement:function(t){return{type:st.BlockStatement,body:t}},createBreakStatement:function(t){return{type:st.BreakStatement,label:t}},createCallExpression:function(t,e){return{type:st.CallExpression,callee:t,arguments:e}},createCatchClause:function(t,e){return{type:st.CatchClause,param:t,body:e}},createConditionalExpression:function(t,e,r){return{type:st.ConditionalExpression,test:t,consequent:e,alternate:r}},createContinueStatement:function(t){return{type:st.ContinueStatement,label:t}},createDebuggerStatement:function(){return{type:st.DebuggerStatement}},createDoWhileStatement:function(t,e){return{type:st.DoWhileStatement,body:t,test:e}},createEmptyStatement:function(){return{type:st.EmptyStatement}},createExpressionStatement:function(t){return{type:st.ExpressionStatement,expression:t}},createForStatement:function(t,e,r,n){return{type:st.ForStatement,init:t,test:e,update:r,body:n}},createForInStatement:function(t,e,r){return{type:st.ForInStatement,left:t,right:e,body:r,each:!1}},createFunctionDeclaration:function(t,e,r,n){return{type:st.FunctionDeclaration,id:t,params:e,defaults:r,body:n,rest:null,generator:!1,expression:!1}},createFunctionExpression:function(t,e,r,n){return{type:st.FunctionExpression,id:t,params:e,defaults:r,body:n,rest:null,generator:!1,expression:!1}},createIdentifier:function(t){return{type:st.Identifier,name:t}},createIfStatement:function(t,e,r){return{type:st.IfStatement,test:t,consequent:e,alternate:r}},createLabeledStatement:function(t,e){return{type:st.LabeledStatement,label:t,body:e}},createLiteral:function(t){return{type:st.Literal,value:t.value,raw:ke.slice(t.start,t.end)}},createMemberExpression:function(t,e,r){return{type:st.MemberExpression,computed:t==="[",object:e,property:r}},createNewExpression:function(t,e){return{type:st.NewExpression,callee:t,arguments:e}},createObjectExpression:function(t){return{type:st.ObjectExpression,properties:t}},createPostfixExpression:function(t,e){return{type:st.UpdateExpression,operator:t,argument:e,prefix:!1}},createProgram:function(t){return{type:st.Program,body:t}},createProperty:function(t,e,r){return{type:st.Property,key:e,value:r,kind:t}},createReturnStatement:function(t){return{type:st.ReturnStatement,argument:t}},createSequenceExpression:function(t){return{type:st.SequenceExpression,expressions:t}},createSwitchCase:function(t,e){return{type:st.SwitchCase,test:t,consequent:e}},createSwitchStatement:function(t,e){return{type:st.SwitchStatement,discriminant:t,cases:e}},createThisExpression:function(){return{type:st.ThisExpression}},createThrowStatement:function(t){return{type:st.ThrowStatement,argument:t}},createTryStatement:function(t,e,r,n){return{type:st.TryStatement,block:t,guardedHandlers:e,handlers:r,finalizer:n}},createUnaryExpression:function(t,e){return t==="++"||t==="--"?{type:st.UpdateExpression,operator:t,argument:e,prefix:!0}:{type:st.UnaryExpression,operator:t,argument:e,prefix:!0}},createVariableDeclaration:function(t,e){return{type:st.VariableDeclaration,declarations:t,kind:e}},createVariableDeclarator:function(t,e){return{type:st.VariableDeclarator,id:t,init:e}},createWhileStatement:function(t,e){return{type:st.WhileStatement,test:t,body:e}},createWithStatement:function(t,e){return{type:st.WithStatement,object:t,body:e}}};function oy(){var t,e,r,n;return t=oe,e=bt,r=kt,xc(),n=bt!==e,oe=t,bt=e,kt=r,n}function At(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var s,i=e.replace(/%(\d)/g,function(o,a){return iy(a<r.length,"Message reference must be in range"),r[a]});throw typeof t.lineNumber=="number"?(s=new Error("Line "+t.lineNumber+": "+i),s.index=t.start,s.lineNumber=t.lineNumber,s.column=t.start-kt+1):(s=new Error("Line "+bt+": "+i),s.index=oe,s.lineNumber=bt,s.column=oe-kt+1),s.description=i,s}function Qt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{At.apply(null,t)}catch(r){if(Pe.errors)Pe.errors.push(r);else throw r}}function Vo(t){if(t.type===Be.EOF&&At(t,Ie.UnexpectedEOS),t.type===Be.NumericLiteral&&At(t,Ie.UnexpectedNumber),t.type===Be.StringLiteral&&At(t,Ie.UnexpectedString),t.type===Be.Identifier&&At(t,Ie.UnexpectedIdentifier),t.type===Be.Keyword){if(NL(t.value))At(t,Ie.UnexpectedReserved);else if(Yt&&sy(t.value)){Qt(t,Ie.StrictReservedWord);return}At(t,Ie.UnexpectedToken,t.value)}At(t,Ie.UnexpectedToken,t.value)}function dt(t){var e=Ot();(e.type!==Be.Punctuator||e.value!==t)&&Vo(e)}function Vr(t){var e=Ot();(e.type!==Be.Keyword||e.value!==t)&&Vo(e)}function ot(t){return Te.type===Be.Punctuator&&Te.value===t}function Fn(t){return Te.type===Be.Keyword&&Te.value===t}function ZL(){var t;return Te.type!==Be.Punctuator?!1:(t=Te.value,t==="="||t==="*="||t==="/="||t==="%="||t==="+="||t==="-="||t==="<<="||t===">>="||t===">>>="||t==="&="||t==="^="||t==="|=")}function zo(){var t;if(ke.charCodeAt(oe)===59||ot(";")){Ot();return}t=bt,xc(),bt===t&&Te.type!==Be.EOF&&!ot("}")&&Vo(Te)}function Ng(t){return t.type===st.Identifier||t.type===st.MemberExpression}function XL(){var t=[],e;for(e=Te,dt("[");!ot("]");)ot(",")?(Ot(),t.push(null)):(t.push(Ws()),ot("]")||dt(","));return Ot(),me.markEnd(me.createArrayExpression(t),e)}function ow(t,e){var r,n,s;return r=Yt,s=Te,n=I_(),e&&Yt&&bs(t[0].name)&&Qt(e,Ie.StrictParamName),Yt=r,me.markEnd(me.createFunctionExpression(null,t,[],n),s)}function om(){var t,e;return e=Te,t=Ot(),t.type===Be.StringLiteral||t.type===Be.NumericLiteral?(Yt&&t.octal&&Qt(t,Ie.StrictOctalLiteral),me.markEnd(me.createLiteral(t),e)):me.markEnd(me.createIdentifier(t.value),e)}function YL(){var t,e,r,n,s,i;if(t=Te,i=Te,t.type===Be.Identifier)return r=om(),t.value==="get"&&!ot(":")?(e=om(),dt("("),dt(")"),n=ow([]),me.markEnd(me.createProperty("get",e,n),i)):t.value==="set"&&!ot(":")?(e=om(),dt("("),t=Te,t.type!==Be.Identifier?(dt(")"),Qt(t,Ie.UnexpectedToken,t.value),n=ow([])):(s=[Dc()],dt(")"),n=ow(s,t)),me.markEnd(me.createProperty("set",e,n),i)):(dt(":"),n=Ws(),me.markEnd(me.createProperty("init",r,n),i));if(t.type===Be.EOF||t.type===Be.Punctuator)Vo(t);else return e=om(),dt(":"),n=Ws(),me.markEnd(me.createProperty("init",e,n),i)}function QL(){var t=[],e,r,n,s,i={},o=String,a;for(a=Te,dt("{");!ot("}");)e=YL(),e.key.type===st.Identifier?r=e.key.name:r=o(e.key.value),s=e.kind==="init"?qu.Data:e.kind==="get"?qu.Get:qu.Set,n="$"+r,Object.prototype.hasOwnProperty.call(i,n)?(i[n]===qu.Data?Yt&&s===qu.Data?Qt({},Ie.StrictDuplicateProperty):s!==qu.Data&&Qt({},Ie.AccessorDataProperty):s===qu.Data?Qt({},Ie.AccessorDataProperty):i[n]&s&&Qt({},Ie.AccessorGetSet),i[n]|=s):i[n]=s,t.push(e),ot("}")||dt(",");return dt("}"),me.markEnd(me.createObjectExpression(t),a)}function eq(){var t;return dt("("),t=dn(),dt(")"),t}function Gk(){var t,e,r,n;if(ot("("))return eq();if(ot("["))return XL();if(ot("{"))return QL();if(t=Te.type,n=Te,t===Be.Identifier)r=me.createIdentifier(Ot().value);else if(t===Be.StringLiteral||t===Be.NumericLiteral)Yt&&Te.octal&&Qt(Te,Ie.StrictOctalLiteral),r=me.createLiteral(Ot());else if(t===Be.Keyword){if(Fn("function"))return Dq();Fn("this")?(Ot(),r=me.createThisExpression()):Vo(Ot())}else t===Be.BooleanLiteral?(e=Ot(),e.value=e.value==="true",r=me.createLiteral(e)):t===Be.NullLiteral?(e=Ot(),e.value=null,r=me.createLiteral(e)):ot("/")||ot("/=")?(typeof Pe.tokens<"u"?r=me.createLiteral(ol()):r=me.createLiteral(Hk()),Jk()):Vo(Ot());return me.markEnd(r,n)}function Zk(){var t=[];if(dt("("),!ot(")"))for(;oe<ir&&(t.push(Ws()),!ot(")"));)dt(",");return dt(")"),t}function tq(){var t,e;return e=Te,t=Ot(),WL(t)||Vo(t),me.markEnd(me.createIdentifier(t.value),e)}function Xk(){return dt("."),tq()}function Yk(){var t;return dt("["),t=dn(),dt("]"),t}function Qk(){var t,e,r;return r=Te,Vr("new"),t=nq(),e=ot("(")?Zk():[],me.markEnd(me.createNewExpression(t,e),r)}function rq(){var t,e,r,n,s;for(s=Te,t=Xe.allowIn,Xe.allowIn=!0,e=Fn("new")?Qk():Gk(),Xe.allowIn=t;;){if(ot("."))n=Xk(),e=me.createMemberExpression(".",e,n);else if(ot("("))r=Zk(),e=me.createCallExpression(e,r);else if(ot("["))n=Yk(),e=me.createMemberExpression("[",e,n);else break;me.markEnd(e,s)}return e}function nq(){var t,e,r,n;for(n=Te,t=Xe.allowIn,e=Fn("new")?Qk():Gk(),Xe.allowIn=t;ot(".")||ot("[");)ot("[")?(r=Yk(),e=me.createMemberExpression("[",e,r)):(r=Xk(),e=me.createMemberExpression(".",e,r)),me.markEnd(e,n);return e}function j$(){var t,e,r=Te;return t=rq(),Te.type===Be.Punctuator&&(ot("++")||ot("--"))&&!oy()&&(Yt&&t.type===st.Identifier&&bs(t.name)&&Qt({},Ie.StrictLHSPostfix),Ng(t)||Qt({},Ie.InvalidLHSInAssignment),e=Ot(),t=me.markEnd(me.createPostfixExpression(e.value,t),r)),t}function qd(){var t,e,r;return Te.type!==Be.Punctuator&&Te.type!==Be.Keyword?e=j$():ot("++")||ot("--")?(r=Te,t=Ot(),e=qd(),Yt&&e.type===st.Identifier&&bs(e.name)&&Qt({},Ie.StrictLHSPrefix),Ng(e)||Qt({},Ie.InvalidLHSInAssignment),e=me.createUnaryExpression(t.value,e),e=me.markEnd(e,r)):ot("+")||ot("-")||ot("~")||ot("!")?(r=Te,t=Ot(),e=qd(),e=me.createUnaryExpression(t.value,e),e=me.markEnd(e,r)):Fn("delete")||Fn("void")||Fn("typeof")?(r=Te,t=Ot(),e=qd(),e=me.createUnaryExpression(t.value,e),e=me.markEnd(e,r),Yt&&e.operator==="delete"&&e.argument.type===st.Identifier&&Qt({},Ie.StrictDelete)):e=j$(),e}function M$(t,e){var r=0;if(t.type!==Be.Punctuator&&t.type!==Be.Keyword)return 0;switch(t.value){case"||":r=1;break;case"&&":r=2;break;case"|":r=3;break;case"^":r=4;break;case"&":r=5;break;case"==":case"!=":case"===":case"!==":r=6;break;case"<":case">":case"<=":case">=":case"instanceof":r=7;break;case"in":r=e?7:0;break;case"<<":case">>":case">>>":r=8;break;case"+":case"-":r=9;break;case"*":case"/":case"%":r=11;break}return r}function iq(){var t,e,r,n,s,i,o,a,c,l;if(t=Te,c=qd(),n=Te,s=M$(n,Xe.allowIn),s===0)return c;for(n.prec=s,Ot(),e=[t,Te],o=qd(),i=[c,n,o];(s=M$(Te,Xe.allowIn))>0;){for(;i.length>2&&s<=i[i.length-2].prec;)o=i.pop(),a=i.pop().value,c=i.pop(),r=me.createBinaryExpression(a,c,o),e.pop(),t=e[e.length-1],me.markEnd(r,t),i.push(r);n=Ot(),n.prec=s,i.push(n),e.push(Te),r=qd(),i.push(r)}for(l=i.length-1,r=i[l],e.pop();l>1;)r=me.createBinaryExpression(i[l-1].value,i[l-2],r),l-=2,t=e.pop(),me.markEnd(r,t);return r}function sq(){var t,e,r,n,s;return s=Te,t=iq(),ot("?")&&(Ot(),e=Xe.allowIn,Xe.allowIn=!0,r=Ws(),Xe.allowIn=e,dt(":"),n=Ws(),t=me.createConditionalExpression(t,r,n),me.markEnd(t,s)),t}function Ws(){var t,e,r,n,s;return t=Te,s=Te,n=e=sq(),ZL()&&(Ng(e)||Qt({},Ie.InvalidLHSInAssignment),Yt&&e.type===st.Identifier&&bs(e.name)&&Qt(t,Ie.StrictLHSAssignment),t=Ot(),r=Ws(),n=me.markEnd(me.createAssignmentExpression(t.value,e,r),s)),n}function dn(){var t,e=Te;if(t=Ws(),ot(",")){for(t=me.createSequenceExpression([t]);oe<ir&&ot(",");)Ot(),t.expressions.push(Ws());me.markEnd(t,e)}return t}function oq(){for(var t=[],e;oe<ir&&!(ot("}")||(e=Ph(),typeof e>"u"));)t.push(e);return t}function K0(){var t,e;return e=Te,dt("{"),t=oq(),dt("}"),me.markEnd(me.createBlockStatement(t),e)}function Dc(){var t,e;return e=Te,t=Ot(),t.type!==Be.Identifier&&Vo(t),me.markEnd(me.createIdentifier(t.value),e)}function aq(t){var e=null,r,n;return n=Te,r=Dc(),Yt&&bs(r.name)&&Qt({},Ie.StrictVarName),t==="const"?(dt("="),e=Ws()):ot("=")&&(Ot(),e=Ws()),me.markEnd(me.createVariableDeclarator(r,e),n)}function T_(t){var e=[];do{if(e.push(aq(t)),!ot(","))break;Ot()}while(oe<ir);return e}function uq(){var t;return Vr("var"),t=T_(),zo(),me.createVariableDeclaration(t,"var")}function cq(t){var e,r;return r=Te,Vr(t),e=T_(t),zo(),me.markEnd(me.createVariableDeclaration(e,t),r)}function lq(){return dt(";"),me.createEmptyStatement()}function dq(){var t=dn();return zo(),me.createExpressionStatement(t)}function fq(){var t,e,r;return Vr("if"),dt("("),t=dn(),dt(")"),e=Ho(),Fn("else")?(Ot(),r=Ho()):r=null,me.createIfStatement(t,e,r)}function pq(){var t,e,r;return Vr("do"),r=Xe.inIteration,Xe.inIteration=!0,t=Ho(),Xe.inIteration=r,Vr("while"),dt("("),e=dn(),dt(")"),ot(";")&&Ot(),me.createDoWhileStatement(t,e)}function hq(){var t,e,r;return Vr("while"),dt("("),t=dn(),dt(")"),r=Xe.inIteration,Xe.inIteration=!0,e=Ho(),Xe.inIteration=r,me.createWhileStatement(t,e)}function yq(){var t,e,r;return r=Te,t=Ot(),e=T_(),me.markEnd(me.createVariableDeclaration(e,t.value),r)}function mq(){var t,e,r,n,s,i,o;return t=e=r=null,Vr("for"),dt("("),ot(";")?Ot():(Fn("var")||Fn("let")?(Xe.allowIn=!1,t=yq(),Xe.allowIn=!0,t.declarations.length===1&&Fn("in")&&(Ot(),n=t,s=dn(),t=null)):(Xe.allowIn=!1,t=dn(),Xe.allowIn=!0,Fn("in")&&(Ng(t)||Qt({},Ie.InvalidLHSInForIn),Ot(),n=t,s=dn(),t=null)),typeof n>"u"&&dt(";")),typeof n>"u"&&(ot(";")||(e=dn()),dt(";"),ot(")")||(r=dn())),dt(")"),o=Xe.inIteration,Xe.inIteration=!0,i=Ho(),Xe.inIteration=o,typeof n>"u"?me.createForStatement(t,e,r,i):me.createForInStatement(n,s,i)}function gq(){var t=null,e;return Vr("continue"),ke.charCodeAt(oe)===59?(Ot(),Xe.inIteration||At({},Ie.IllegalContinue),me.createContinueStatement(null)):oy()?(Xe.inIteration||At({},Ie.IllegalContinue),me.createContinueStatement(null)):(Te.type===Be.Identifier&&(t=Dc(),e="$"+t.name,Object.prototype.hasOwnProperty.call(Xe.labelSet,e)||At({},Ie.UnknownLabel,t.name)),zo(),t===null&&!Xe.inIteration&&At({},Ie.IllegalContinue),me.createContinueStatement(t))}function vq(){var t=null,e;return Vr("break"),ke.charCodeAt(oe)===59?(Ot(),Xe.inIteration||Xe.inSwitch||At({},Ie.IllegalBreak),me.createBreakStatement(null)):oy()?(Xe.inIteration||Xe.inSwitch||At({},Ie.IllegalBreak),me.createBreakStatement(null)):(Te.type===Be.Identifier&&(t=Dc(),e="$"+t.name,Object.prototype.hasOwnProperty.call(Xe.labelSet,e)||At({},Ie.UnknownLabel,t.name)),zo(),t===null&&!(Xe.inIteration||Xe.inSwitch)&&At({},Ie.IllegalBreak),me.createBreakStatement(t))}function wq(){var t=null;return Vr("return"),Xe.inFunctionBody||Qt({},Ie.IllegalReturn),ke.charCodeAt(oe)===32&&mf(ke.charCodeAt(oe+1))?(t=dn(),zo(),me.createReturnStatement(t)):oy()?me.createReturnStatement(null):(ot(";")||!ot("}")&&Te.type!==Be.EOF&&(t=dn()),zo(),me.createReturnStatement(t))}function bq(){var t,e;return Yt&&(xc(),Qt({},Ie.StrictModeWith)),Vr("with"),dt("("),t=dn(),dt(")"),e=Ho(),me.createWithStatement(t,e)}function _q(){var t,e=[],r,n;for(n=Te,Fn("default")?(Ot(),t=null):(Vr("case"),t=dn()),dt(":");oe<ir&&!(ot("}")||Fn("default")||Fn("case"));)r=Ho(),e.push(r);return me.markEnd(me.createSwitchCase(t,e),n)}function Eq(){var t,e,r,n,s;if(Vr("switch"),dt("("),t=dn(),dt(")"),dt("{"),e=[],ot("}"))return Ot(),me.createSwitchStatement(t,e);for(n=Xe.inSwitch,Xe.inSwitch=!0,s=!1;oe<ir&&!ot("}");)r=_q(),r.test===null&&(s&&At({},Ie.MultipleDefaultsInSwitch),s=!0),e.push(r);return Xe.inSwitch=n,dt("}"),me.createSwitchStatement(t,e)}function Aq(){var t;return Vr("throw"),oy()&&At({},Ie.NewlineAfterThrow),t=dn(),zo(),me.createThrowStatement(t)}function Sq(){var t,e,r;return r=Te,Vr("catch"),dt("("),ot(")")&&Vo(Te),t=Dc(),Yt&&bs(t.name)&&Qt({},Ie.StrictCatchVariable),dt(")"),e=K0(),me.markEnd(me.createCatchClause(t,e),r)}function $q(){var t,e=[],r=null;return Vr("try"),t=K0(),Fn("catch")&&e.push(Sq()),Fn("finally")&&(Ot(),r=K0()),e.length===0&&!r&&At({},Ie.NoCatchOrFinally),me.createTryStatement(t,[],e,r)}function xq(){return Vr("debugger"),zo(),me.createDebuggerStatement()}function Ho(){var t=Te.type,e,r,n,s;if(t===Be.EOF&&Vo(Te),t===Be.Punctuator&&Te.value==="{")return K0();if(s=Te,t===Be.Punctuator)switch(Te.value){case";":return me.markEnd(lq(),s);case"(":return me.markEnd(dq(),s)}if(t===Be.Keyword)switch(Te.value){case"break":return me.markEnd(vq(),s);case"continue":return me.markEnd(gq(),s);case"debugger":return me.markEnd(xq(),s);case"do":return me.markEnd(pq(),s);case"for":return me.markEnd(mq(),s);case"function":return me.markEnd(tO(),s);case"if":return me.markEnd(fq(),s);case"return":return me.markEnd(wq(),s);case"switch":return me.markEnd(Eq(),s);case"throw":return me.markEnd(Aq(),s);case"try":return me.markEnd($q(),s);case"var":return me.markEnd(uq(),s);case"while":return me.markEnd(hq(),s);case"with":return me.markEnd(bq(),s)}return e=dn(),e.type===st.Identifier&&ot(":")?(Ot(),n="$"+e.name,Object.prototype.hasOwnProperty.call(Xe.labelSet,n)&&At({},Ie.Redeclaration,"Label",e.name),Xe.labelSet[n]=!0,r=Ho(),delete Xe.labelSet[n],me.markEnd(me.createLabeledStatement(e,r),s)):(zo(),me.markEnd(me.createExpressionStatement(e),s))}function I_(){var t,e=[],r,n,s,i,o,a,c,l;for(l=Te,dt("{");oe<ir&&!(Te.type!==Be.StringLiteral||(r=Te,t=Ph(),e.push(t),t.expression.type!==st.Literal));)n=ke.slice(r.start+1,r.end-1),n==="use strict"?(Yt=!0,s&&Qt(s,Ie.StrictOctalLiteral)):!s&&r.octal&&(s=r);for(i=Xe.labelSet,o=Xe.inIteration,a=Xe.inSwitch,c=Xe.inFunctionBody,Xe.labelSet={},Xe.inIteration=!1,Xe.inSwitch=!1,Xe.inFunctionBody=!0;oe<ir&&!(ot("}")||(t=Ph(),typeof t>"u"));)e.push(t);return dt("}"),Xe.labelSet=i,Xe.inIteration=o,Xe.inSwitch=a,Xe.inFunctionBody=c,me.markEnd(me.createBlockStatement(e),l)}function eO(t){var e,r=[],n,s,i,o,a;if(dt("("),!ot(")"))for(i={};oe<ir&&(n=Te,e=Dc(),o="$"+n.value,Yt?(bs(n.value)&&(s=n,a=Ie.StrictParamName),Object.prototype.hasOwnProperty.call(i,o)&&(s=n,a=Ie.StrictParamDupe)):t||(bs(n.value)?(t=n,a=Ie.StrictParamName):sy(n.value)?(t=n,a=Ie.StrictReservedWord):Object.prototype.hasOwnProperty.call(i,o)&&(t=n,a=Ie.StrictParamDupe)),r.push(e),i[o]=!0,!ot(")"));)dt(",");return dt(")"),{params:r,stricted:s,firstRestricted:t,message:a}}function tO(){var t,e=[],r,n,s,i,o,a,c,l;return l=Te,Vr("function"),n=Te,t=Dc(),Yt?bs(n.value)&&Qt(n,Ie.StrictFunctionName):bs(n.value)?(o=n,a=Ie.StrictFunctionName):sy(n.value)&&(o=n,a=Ie.StrictReservedWord),i=eO(o),e=i.params,s=i.stricted,o=i.firstRestricted,i.message&&(a=i.message),c=Yt,r=I_(),Yt&&o&&At(o,a),Yt&&s&&Qt(s,a),Yt=c,me.markEnd(me.createFunctionDeclaration(t,e,[],r),l)}function Dq(){var t,e=null,r,n,s,i,o=[],a,c,l;return l=Te,Vr("function"),ot("(")||(t=Te,e=Dc(),Yt?bs(t.value)&&Qt(t,Ie.StrictFunctionName):bs(t.value)?(n=t,s=Ie.StrictFunctionName):sy(t.value)&&(n=t,s=Ie.StrictReservedWord)),i=eO(n),o=i.params,r=i.stricted,n=i.firstRestricted,i.message&&(s=i.message),c=Yt,a=I_(),Yt&&n&&At(n,s),Yt&&r&&Qt(r,s),Yt=c,me.markEnd(me.createFunctionExpression(e,o,[],a),l)}function Ph(){if(Te.type===Be.Keyword)switch(Te.value){case"const":case"let":return cq(Te.value);case"function":return tO();default:return Ho()}if(Te.type!==Be.EOF)return Ho()}function Pq(){for(var t,e=[],r,n,s;oe<ir&&(r=Te,!(r.type!==Be.StringLiteral||(t=Ph(),e.push(t),t.expression.type!==st.Literal)));)n=ke.slice(r.start+1,r.end-1),n==="use strict"?(Yt=!0,s&&Qt(s,Ie.StrictOctalLiteral)):!s&&r.octal&&(s=r);for(;oe<ir&&(t=Ph(),!(typeof t>"u"));)e.push(t);return e}function Cq(){var t,e;return xc(),Jk(),e=Te,Yt=!1,t=Pq(),me.markEnd(me.createProgram(t),e)}function kq(){var t,e,r,n=[];for(t=0;t<Pe.tokens.length;++t)e=Pe.tokens[t],r={type:e.type,value:e.value},Pe.range&&(r.range=e.range),Pe.loc&&(r.loc=e.loc),n.push(r);Pe.tokens=n}function Wb(t,e){var r,n;n=String,typeof t!="string"&&!(t instanceof String)&&(t=n(t)),me=qk,ke=t,oe=0,bt=ke.length>0?1:0,kt=0,ir=ke.length,Te=null,Xe={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},Pe={};try{r=Cq(),typeof Pe.comments<"u"&&(r.comments=Pe.comments),typeof Pe.tokens<"u"&&(kq(),r.tokens=Pe.tokens),typeof Pe.errors<"u"&&(r.errors=Pe.errors)}catch(s){throw s}finally{Pe={}}return r}function Oq(t,e,r,n){function s(c){return String(c).match(/^[0-9]+$/)?parseInt(c):Number.isFinite(c)?parseInt(c,10):0}if(typeof e=="string")throw new Error("start cannot be a string");if(typeof r=="string")throw new Error("end cannot be a string");if(typeof n=="string")throw new Error("step cannot be a string");var i=t.length;if(n===0)throw new Error("step cannot be zero");if(n=n?s(n):1,e=e<0?i+e:e,r=r<0?i+r:r,e=s(e===0?0:e||(n>0?0:i-1)),r=s(r===0?0:r||(n>0?i:-1)),e=n>0?Math.max(0,e):Math.min(i,e),r=n>0?Math.min(r,i):Math.max(-1,r),n>0&&r<=e)return[];if(n<0&&e<=r)return[];for(var o=[],a=e;a!=r&&!(n<0&&a<=r||n>0&&a>=r);a+=n)o.push(t[a]);return o}var rO={},nO={};const Tq="estraverse",Iq="ECMAScript JS AST traversal functions",Bq="https://github.com/estools/estraverse",Fq="estraverse.js",Nq="4.3.0",Rq={node:">=4.0"},jq=[{name:"Yusuke Suzuki",email:"utatane.tea@gmail.com",web:"http://github.com/Constellation"}],Mq={type:"git",url:"http://github.com/estools/estraverse.git"},Uq={"babel-preset-env":"^1.6.1","babel-register":"^6.3.13",chai:"^2.1.1",espree:"^1.11.0",gulp:"^3.8.10","gulp-bump":"^0.2.2","gulp-filter":"^2.0.0","gulp-git":"^1.0.1","gulp-tag-version":"^1.3.0",jshint:"^2.5.6",mocha:"^2.1.0"},Kq="BSD-2-Clause",Lq={test:"npm run-script lint && npm run-script unit-test",lint:"jshint estraverse.js","unit-test":"mocha --compilers js:babel-register"},qq={name:Tq,description:Iq,homepage:Bq,main:Fq,version:Nq,engines:Rq,maintainers:jq,repository:Mq,devDependencies:Uq,license:Kq,scripts:Lq};(function(t){(function e(r){var n,s,i,o,a,c;function l(m){var _={},x,D;for(x in m)m.hasOwnProperty(x)&&(D=m[x],typeof D=="object"&&D!==null?_[x]=l(D):_[x]=D);return _}function u(m,_){var x,D,E,A;for(D=m.length,E=0;D;)x=D>>>1,A=E+x,_(m[A])?D=x:(E=A+1,D-=x+1);return E}n={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ComprehensionBlock:"ComprehensionBlock",ComprehensionExpression:"ComprehensionExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DebuggerStatement:"DebuggerStatement",DirectiveStatement:"DirectiveStatement",DoWhileStatement:"DoWhileStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",ForOfStatement:"ForOfStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",GeneratorExpression:"GeneratorExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportExpression:"ImportExpression",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",ModuleSpecifier:"ModuleSpecifier",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Program:"Program",Property:"Property",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"},i={AssignmentExpression:["left","right"],AssignmentPattern:["left","right"],ArrayExpression:["elements"],ArrayPattern:["elements"],ArrowFunctionExpression:["params","body"],AwaitExpression:["argument"],BlockStatement:["body"],BinaryExpression:["left","right"],BreakStatement:["label"],CallExpression:["callee","arguments"],CatchClause:["param","body"],ClassBody:["body"],ClassDeclaration:["id","superClass","body"],ClassExpression:["id","superClass","body"],ComprehensionBlock:["left","right"],ComprehensionExpression:["blocks","filter","body"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DirectiveStatement:[],DoWhileStatement:["body","test"],EmptyStatement:[],ExportAllDeclaration:["source"],ExportDefaultDeclaration:["declaration"],ExportNamedDeclaration:["declaration","specifiers","source"],ExportSpecifier:["exported","local"],ExpressionStatement:["expression"],ForStatement:["init","test","update","body"],ForInStatement:["left","right","body"],ForOfStatement:["left","right","body"],FunctionDeclaration:["id","params","body"],FunctionExpression:["id","params","body"],GeneratorExpression:["blocks","filter","body"],Identifier:[],IfStatement:["test","consequent","alternate"],ImportExpression:["source"],ImportDeclaration:["specifiers","source"],ImportDefaultSpecifier:["local"],ImportNamespaceSpecifier:["local"],ImportSpecifier:["imported","local"],Literal:[],LabeledStatement:["label","body"],LogicalExpression:["left","right"],MemberExpression:["object","property"],MetaProperty:["meta","property"],MethodDefinition:["key","value"],ModuleSpecifier:[],NewExpression:["callee","arguments"],ObjectExpression:["properties"],ObjectPattern:["properties"],Program:["body"],Property:["key","value"],RestElement:["argument"],ReturnStatement:["argument"],SequenceExpression:["expressions"],SpreadElement:["argument"],Super:[],SwitchStatement:["discriminant","cases"],SwitchCase:["test","consequent"],TaggedTemplateExpression:["tag","quasi"],TemplateElement:[],TemplateLiteral:["quasis","expressions"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handler","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],YieldExpression:["argument"]},o={},a={},c={},s={Break:o,Skip:a,Remove:c};function d(m,_){this.parent=m,this.key=_}d.prototype.replace=function(_){this.parent[this.key]=_},d.prototype.remove=function(){return Array.isArray(this.parent)?(this.parent.splice(this.key,1),!0):(this.replace(null),!1)};function h(m,_,x,D){this.node=m,this.path=_,this.wrap=x,this.ref=D}function f(){}f.prototype.path=function(){var _,x,D,E,A,S;function O(I,N){if(Array.isArray(N))for(D=0,E=N.length;D<E;++D)I.push(N[D]);else I.push(N)}if(!this.__current.path)return null;for(A=[],_=2,x=this.__leavelist.length;_<x;++_)S=this.__leavelist[_],O(A,S.path);return O(A,this.__current.path),A},f.prototype.type=function(){var m=this.current();return m.type||this.__current.wrap},f.prototype.parents=function(){var _,x,D;for(D=[],_=1,x=this.__leavelist.length;_<x;++_)D.push(this.__leavelist[_].node);return D},f.prototype.current=function(){return this.__current.node},f.prototype.__execute=function(_,x){var D,E;return E=void 0,D=this.__current,this.__current=x,this.__state=null,_&&(E=_.call(this,x.node,this.__leavelist[this.__leavelist.length-1].node)),this.__current=D,E},f.prototype.notify=function(_){this.__state=_},f.prototype.skip=function(){this.notify(a)},f.prototype.break=function(){this.notify(o)},f.prototype.remove=function(){this.notify(c)},f.prototype.__initialize=function(m,_){this.visitor=_,this.root=m,this.__worklist=[],this.__leavelist=[],this.__current=null,this.__state=null,this.__fallback=null,_.fallback==="iteration"?this.__fallback=Object.keys:typeof _.fallback=="function"&&(this.__fallback=_.fallback),this.__keys=i,_.keys&&(this.__keys=Object.assign(Object.create(this.__keys),_.keys))};function p(m){return m==null?!1:typeof m=="object"&&typeof m.type=="string"}function y(m,_){return(m===n.ObjectExpression||m===n.ObjectPattern)&&_==="properties"}f.prototype.traverse=function(_,x){var D,E,A,S,O,I,N,j,F,V,ee,G;for(this.__initialize(_,x),G={},D=this.__worklist,E=this.__leavelist,D.push(new h(_,null,null,null)),E.push(new h(null,null,null,null));D.length;){if(A=D.pop(),A===G){if(A=E.pop(),I=this.__execute(x.leave,A),this.__state===o||I===o)return;continue}if(A.node){if(I=this.__execute(x.enter,A),this.__state===o||I===o)return;if(D.push(G),E.push(A),this.__state===a||I===a)continue;if(S=A.node,O=S.type||A.wrap,V=this.__keys[O],!V)if(this.__fallback)V=this.__fallback(S);else throw new Error("Unknown node type "+O+".");for(j=V.length;(j-=1)>=0;)if(N=V[j],ee=S[N],!!ee)if(Array.isArray(ee)){for(F=ee.length;(F-=1)>=0;)if(ee[F]){if(y(O,V[j]))A=new h(ee[F],[N,F],"Property",null);else if(p(ee[F]))A=new h(ee[F],[N,F],null,null);else continue;D.push(A)}}else p(ee)&&D.push(new h(ee,N,null,null))}}},f.prototype.replace=function(_,x){var D,E,A,S,O,I,N,j,F,V,ee,G,Z;function M(k){var H,U,$,T;if(k.ref.remove()){for(U=k.ref.key,T=k.ref.parent,H=D.length;H--;)if($=D[H],$.ref&&$.ref.parent===T){if($.ref.key<U)break;--$.ref.key}}}for(this.__initialize(_,x),ee={},D=this.__worklist,E=this.__leavelist,G={root:_},I=new h(_,null,null,new d(G,"root")),D.push(I),E.push(I);D.length;){if(I=D.pop(),I===ee){if(I=E.pop(),O=this.__execute(x.leave,I),O!==void 0&&O!==o&&O!==a&&O!==c&&I.ref.replace(O),(this.__state===c||O===c)&&M(I),this.__state===o||O===o)return G.root;continue}if(O=this.__execute(x.enter,I),O!==void 0&&O!==o&&O!==a&&O!==c&&(I.ref.replace(O),I.node=O),(this.__state===c||O===c)&&(M(I),I.node=null),this.__state===o||O===o)return G.root;if(A=I.node,!!A&&(D.push(ee),E.push(I),!(this.__state===a||O===a))){if(S=A.type||I.wrap,F=this.__keys[S],!F)if(this.__fallback)F=this.__fallback(A);else throw new Error("Unknown node type "+S+".");for(N=F.length;(N-=1)>=0;)if(Z=F[N],V=A[Z],!!V)if(Array.isArray(V)){for(j=V.length;(j-=1)>=0;)if(V[j]){if(y(S,F[N]))I=new h(V[j],[Z,j],"Property",new d(V,j));else if(p(V[j]))I=new h(V[j],[Z,j],null,new d(V,j));else continue;D.push(I)}}else p(V)&&D.push(new h(V,Z,null,new d(A,Z)))}}return G.root};function b(m,_){var x=new f;return x.traverse(m,_)}function w(m,_){var x=new f;return x.replace(m,_)}function g(m,_){var x;return x=u(_,function(E){return E.range[0]>m.range[0]}),m.extendedRange=[m.range[0],m.range[1]],x!==_.length&&(m.extendedRange[1]=_[x].range[0]),x-=1,x>=0&&(m.extendedRange[0]=_[x].range[1]),m}function v(m,_,x){var D=[],E,A,S,O;if(!m.range)throw new Error("attachComments needs range information");if(!x.length){if(_.length){for(S=0,A=_.length;S<A;S+=1)E=l(_[S]),E.extendedRange=[0,m.range[0]],D.push(E);m.leadingComments=D}return m}for(S=0,A=_.length;S<A;S+=1)D.push(g(l(_[S]),x));return O=0,b(m,{enter:function(I){for(var N;O<D.length&&(N=D[O],!(N.extendedRange[1]>I.range[0]));)N.extendedRange[1]===I.range[0]?(I.leadingComments||(I.leadingComments=[]),I.leadingComments.push(N),D.splice(O,1)):O+=1;if(O===D.length)return s.Break;if(D[O].extendedRange[0]>I.range[1])return s.Skip}}),O=0,b(m,{leave:function(I){for(var N;O<D.length&&(N=D[O],!(I.range[1]<N.extendedRange[0]));)I.range[1]===N.extendedRange[0]?(I.trailingComments||(I.trailingComments=[]),I.trailingComments.push(N),D.splice(O,1)):O+=1;if(O===D.length)return s.Break;if(D[O].extendedRange[0]>I.range[1])return s.Skip}}),m}return r.version=qq.version,r.Syntax=n,r.traverse=b,r.replace=w,r.attachComments=v,r.VisitorKeys=i,r.VisitorOption=s,r.Controller=f,r.cloneEnvironment=function(){return e({})},r})(t)})(nO);var Qm={},iO={exports:{}};(function(){function t(o){if(o==null)return!1;switch(o.type){case"ArrayExpression":case"AssignmentExpression":case"BinaryExpression":case"CallExpression":case"ConditionalExpression":case"FunctionExpression":case"Identifier":case"Literal":case"LogicalExpression":case"MemberExpression":case"NewExpression":case"ObjectExpression":case"SequenceExpression":case"ThisExpression":case"UnaryExpression":case"UpdateExpression":return!0}return!1}function e(o){if(o==null)return!1;switch(o.type){case"DoWhileStatement":case"ForInStatement":case"ForStatement":case"WhileStatement":return!0}return!1}function r(o){if(o==null)return!1;switch(o.type){case"BlockStatement":case"BreakStatement":case"ContinueStatement":case"DebuggerStatement":case"DoWhileStatement":case"EmptyStatement":case"ExpressionStatement":case"ForInStatement":case"ForStatement":case"IfStatement":case"LabeledStatement":case"ReturnStatement":case"SwitchStatement":case"ThrowStatement":case"TryStatement":case"VariableDeclaration":case"WhileStatement":case"WithStatement":return!0}return!1}function n(o){return r(o)||o!=null&&o.type==="FunctionDeclaration"}function s(o){switch(o.type){case"IfStatement":return o.alternate!=null?o.alternate:o.consequent;case"LabeledStatement":case"ForStatement":case"ForInStatement":case"WhileStatement":case"WithStatement":return o.body}return null}function i(o){var a;if(o.type!=="IfStatement"||o.alternate==null)return!1;a=o.consequent;do{if(a.type==="IfStatement"&&a.alternate==null)return!0;a=s(a)}while(a);return!1}iO.exports={isExpression:t,isStatement:r,isIterationStatement:e,isSourceElement:n,isProblematicIfStatement:i,trailingStatement:s}})();var Vq=iO.exports,sO={exports:{}};(function(){var t,e,r,n,s,i;e={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,NonAsciiIdentifierPart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/},t={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/};function o(b){return 48<=b&&b<=57}function a(b){return 48<=b&&b<=57||97<=b&&b<=102||65<=b&&b<=70}function c(b){return b>=48&&b<=55}r=[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function l(b){return b===32||b===9||b===11||b===12||b===160||b>=5760&&r.indexOf(b)>=0}function u(b){return b===10||b===13||b===8232||b===8233}function d(b){if(b<=65535)return String.fromCharCode(b);var w=String.fromCharCode(Math.floor((b-65536)/1024)+55296),g=String.fromCharCode((b-65536)%1024+56320);return w+g}for(n=new Array(128),i=0;i<128;++i)n[i]=i>=97&&i<=122||i>=65&&i<=90||i===36||i===95;for(s=new Array(128),i=0;i<128;++i)s[i]=i>=97&&i<=122||i>=65&&i<=90||i>=48&&i<=57||i===36||i===95;function h(b){return b<128?n[b]:e.NonAsciiIdentifierStart.test(d(b))}function f(b){return b<128?s[b]:e.NonAsciiIdentifierPart.test(d(b))}function p(b){return b<128?n[b]:t.NonAsciiIdentifierStart.test(d(b))}function y(b){return b<128?s[b]:t.NonAsciiIdentifierPart.test(d(b))}sO.exports={isDecimalDigit:o,isHexDigit:a,isOctalDigit:c,isWhiteSpace:l,isLineTerminator:u,isIdentifierStartES5:h,isIdentifierPartES5:f,isIdentifierStartES6:p,isIdentifierPartES6:y}})();var oO=sO.exports,aO={exports:{}};(function(){var t=oO;function e(h){switch(h){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"let":return!0;default:return!1}}function r(h,f){return!f&&h==="yield"?!1:n(h,f)}function n(h,f){if(f&&e(h))return!0;switch(h.length){case 2:return h==="if"||h==="in"||h==="do";case 3:return h==="var"||h==="for"||h==="new"||h==="try";case 4:return h==="this"||h==="else"||h==="case"||h==="void"||h==="with"||h==="enum";case 5:return h==="while"||h==="break"||h==="catch"||h==="throw"||h==="const"||h==="yield"||h==="class"||h==="super";case 6:return h==="return"||h==="typeof"||h==="delete"||h==="switch"||h==="export"||h==="import";case 7:return h==="default"||h==="finally"||h==="extends";case 8:return h==="function"||h==="continue"||h==="debugger";case 10:return h==="instanceof";default:return!1}}function s(h,f){return h==="null"||h==="true"||h==="false"||r(h,f)}function i(h,f){return h==="null"||h==="true"||h==="false"||n(h,f)}function o(h){return h==="eval"||h==="arguments"}function a(h){var f,p,y;if(h.length===0||(y=h.charCodeAt(0),!t.isIdentifierStartES5(y)))return!1;for(f=1,p=h.length;f<p;++f)if(y=h.charCodeAt(f),!t.isIdentifierPartES5(y))return!1;return!0}function c(h,f){return(h-55296)*1024+(f-56320)+65536}function l(h){var f,p,y,b,w;if(h.length===0)return!1;for(w=t.isIdentifierStartES6,f=0,p=h.length;f<p;++f){if(y=h.charCodeAt(f),55296<=y&&y<=56319){if(++f,f>=p||(b=h.charCodeAt(f),!(56320<=b&&b<=57343)))return!1;y=c(y,b)}if(!w(y))return!1;w=t.isIdentifierPartES6}return!0}function u(h,f){return a(h)&&!s(h,f)}function d(h,f){return l(h)&&!i(h,f)}aO.exports={isKeywordES5:r,isKeywordES6:n,isReservedWordES5:s,isReservedWordES6:i,isRestrictedWord:o,isIdentifierNameES5:a,isIdentifierNameES6:l,isIdentifierES5:u,isIdentifierES6:d}})();var zq=aO.exports;(function(){Qm.ast=Vq,Qm.code=oO,Qm.keyword=zq})();var fp={},aw={},am={},um={},U$;function Hq(){if(U$)return um;U$=1;var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return um.encode=function(e){if(0<=e&&e<t.length)return t[e];throw new TypeError("Must be between 0 and 63: "+e)},um.decode=function(e){var r=65,n=90,s=97,i=122,o=48,a=57,c=43,l=47,u=26,d=52;return r<=e&&e<=n?e-r:s<=e&&e<=i?e-s+u:o<=e&&e<=a?e-o+d:e==c?62:e==l?63:-1},um}var K$;function uO(){if(K$)return am;K$=1;var t=Hq(),e=5,r=1<<e,n=r-1,s=r;function i(a){return a<0?(-a<<1)+1:(a<<1)+0}function o(a){var c=(a&1)===1,l=a>>1;return c?-l:l}return am.encode=function(c){var l="",u,d=i(c);do u=d&n,d>>>=e,d>0&&(u|=s),l+=t.encode(u);while(d>0);return l},am.decode=function(c,l,u){var d=c.length,h=0,f=0,p,y;do{if(l>=d)throw new Error("Expected more digits in base 64 VLQ value.");if(y=t.decode(c.charCodeAt(l++)),y===-1)throw new Error("Invalid base64 digit: "+c.charAt(l-1));p=!!(y&s),y&=n,h=h+(y<<f),f+=e}while(p);u.value=o(h),u.rest=l},am}var uw={},L$;function ay(){return L$||(L$=1,function(t){function e(m,_,x){if(_ in m)return m[_];if(arguments.length===3)return x;throw new Error('"'+_+'" is a required argument.')}t.getArg=e;var r=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,n=/^data:.+\,.+$/;function s(m){var _=m.match(r);return _?{scheme:_[1],auth:_[2],host:_[3],port:_[4],path:_[5]}:null}t.urlParse=s;function i(m){var _="";return m.scheme&&(_+=m.scheme+":"),_+="//",m.auth&&(_+=m.auth+"@"),m.host&&(_+=m.host),m.port&&(_+=":"+m.port),m.path&&(_+=m.path),_}t.urlGenerate=i;function o(m){var _=m,x=s(m);if(x){if(!x.path)return m;_=x.path}for(var D=t.isAbsolute(_),E=_.split(/\/+/),A,S=0,O=E.length-1;O>=0;O--)A=E[O],A==="."?E.splice(O,1):A===".."?S++:S>0&&(A===""?(E.splice(O+1,S),S=0):(E.splice(O,2),S--));return _=E.join("/"),_===""&&(_=D?"/":"."),x?(x.path=_,i(x)):_}t.normalize=o;function a(m,_){m===""&&(m="."),_===""&&(_=".");var x=s(_),D=s(m);if(D&&(m=D.path||"/"),x&&!x.scheme)return D&&(x.scheme=D.scheme),i(x);if(x||_.match(n))return _;if(D&&!D.host&&!D.path)return D.host=_,i(D);var E=_.charAt(0)==="/"?_:o(m.replace(/\/+$/,"")+"/"+_);return D?(D.path=E,i(D)):E}t.join=a,t.isAbsolute=function(m){return m.charAt(0)==="/"||r.test(m)};function c(m,_){m===""&&(m="."),m=m.replace(/\/$/,"");for(var x=0;_.indexOf(m+"/")!==0;){var D=m.lastIndexOf("/");if(D<0||(m=m.slice(0,D),m.match(/^([^\/]+:\/)?\/*$/)))return _;++x}return Array(x+1).join("../")+_.substr(m.length+1)}t.relative=c;var l=function(){var m=Object.create(null);return!("__proto__"in m)}();function u(m){return m}function d(m){return f(m)?"$"+m:m}t.toSetString=l?u:d;function h(m){return f(m)?m.slice(1):m}t.fromSetString=l?u:h;function f(m){if(!m)return!1;var _=m.length;if(_<9||m.charCodeAt(_-1)!==95||m.charCodeAt(_-2)!==95||m.charCodeAt(_-3)!==111||m.charCodeAt(_-4)!==116||m.charCodeAt(_-5)!==111||m.charCodeAt(_-6)!==114||m.charCodeAt(_-7)!==112||m.charCodeAt(_-8)!==95||m.charCodeAt(_-9)!==95)return!1;for(var x=_-10;x>=0;x--)if(m.charCodeAt(x)!==36)return!1;return!0}function p(m,_,x){var D=b(m.source,_.source);return D!==0||(D=m.originalLine-_.originalLine,D!==0)||(D=m.originalColumn-_.originalColumn,D!==0||x)||(D=m.generatedColumn-_.generatedColumn,D!==0)||(D=m.generatedLine-_.generatedLine,D!==0)?D:b(m.name,_.name)}t.compareByOriginalPositions=p;function y(m,_,x){var D=m.generatedLine-_.generatedLine;return D!==0||(D=m.generatedColumn-_.generatedColumn,D!==0||x)||(D=b(m.source,_.source),D!==0)||(D=m.originalLine-_.originalLine,D!==0)||(D=m.originalColumn-_.originalColumn,D!==0)?D:b(m.name,_.name)}t.compareByGeneratedPositionsDeflated=y;function b(m,_){return m===_?0:m===null?1:_===null?-1:m>_?1:-1}function w(m,_){var x=m.generatedLine-_.generatedLine;return x!==0||(x=m.generatedColumn-_.generatedColumn,x!==0)||(x=b(m.source,_.source),x!==0)||(x=m.originalLine-_.originalLine,x!==0)||(x=m.originalColumn-_.originalColumn,x!==0)?x:b(m.name,_.name)}t.compareByGeneratedPositionsInflated=w;function g(m){return JSON.parse(m.replace(/^\)]}'[^\n]*\n/,""))}t.parseSourceMapInput=g;function v(m,_,x){if(_=_||"",m&&(m[m.length-1]!=="/"&&_[0]!=="/"&&(m+="/"),_=m+_),x){var D=s(x);if(!D)throw new Error("sourceMapURL could not be parsed");if(D.path){var E=D.path.lastIndexOf("/");E>=0&&(D.path=D.path.substring(0,E+1))}_=a(i(D),_)}return o(_)}t.computeSourceURL=v}(uw)),uw}var cw={},q$;function cO(){if(q$)return cw;q$=1;var t=ay(),e=Object.prototype.hasOwnProperty,r=typeof Map<"u";function n(){this._array=[],this._set=r?new Map:Object.create(null)}return n.fromArray=function(i,o){for(var a=new n,c=0,l=i.length;c<l;c++)a.add(i[c],o);return a},n.prototype.size=function(){return r?this._set.size:Object.getOwnPropertyNames(this._set).length},n.prototype.add=function(i,o){var a=r?i:t.toSetString(i),c=r?this.has(i):e.call(this._set,a),l=this._array.length;(!c||o)&&this._array.push(i),c||(r?this._set.set(i,l):this._set[a]=l)},n.prototype.has=function(i){if(r)return this._set.has(i);var o=t.toSetString(i);return e.call(this._set,o)},n.prototype.indexOf=function(i){if(r){var o=this._set.get(i);if(o>=0)return o}else{var a=t.toSetString(i);if(e.call(this._set,a))return this._set[a]}throw new Error('"'+i+'" is not in the set.')},n.prototype.at=function(i){if(i>=0&&i<this._array.length)return this._array[i];throw new Error("No element indexed by "+i)},n.prototype.toArray=function(){return this._array.slice()},cw.ArraySet=n,cw}var lw={},V$;function Wq(){if(V$)return lw;V$=1;var t=ay();function e(n,s){var i=n.generatedLine,o=s.generatedLine,a=n.generatedColumn,c=s.generatedColumn;return o>i||o==i&&c>=a||t.compareByGeneratedPositionsInflated(n,s)<=0}function r(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}return r.prototype.unsortedForEach=function(s,i){this._array.forEach(s,i)},r.prototype.add=function(s){e(this._last,s)?(this._last=s,this._array.push(s)):(this._sorted=!1,this._array.push(s))},r.prototype.toArray=function(){return this._sorted||(this._array.sort(t.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},lw.MappingList=r,lw}var z$;function lO(){if(z$)return aw;z$=1;var t=uO(),e=ay(),r=cO().ArraySet,n=Wq().MappingList;function s(i){i||(i={}),this._file=e.getArg(i,"file",null),this._sourceRoot=e.getArg(i,"sourceRoot",null),this._skipValidation=e.getArg(i,"skipValidation",!1),this._sources=new r,this._names=new r,this._mappings=new n,this._sourcesContents=null}return s.prototype._version=3,s.fromSourceMap=function(o){var a=o.sourceRoot,c=new s({file:o.file,sourceRoot:a});return o.eachMapping(function(l){var u={generated:{line:l.generatedLine,column:l.generatedColumn}};l.source!=null&&(u.source=l.source,a!=null&&(u.source=e.relative(a,u.source)),u.original={line:l.originalLine,column:l.originalColumn},l.name!=null&&(u.name=l.name)),c.addMapping(u)}),o.sources.forEach(function(l){var u=l;a!==null&&(u=e.relative(a,l)),c._sources.has(u)||c._sources.add(u);var d=o.sourceContentFor(l);d!=null&&c.setSourceContent(l,d)}),c},s.prototype.addMapping=function(o){var a=e.getArg(o,"generated"),c=e.getArg(o,"original",null),l=e.getArg(o,"source",null),u=e.getArg(o,"name",null);this._skipValidation||this._validateMapping(a,c,l,u),l!=null&&(l=String(l),this._sources.has(l)||this._sources.add(l)),u!=null&&(u=String(u),this._names.has(u)||this._names.add(u)),this._mappings.add({generatedLine:a.line,generatedColumn:a.column,originalLine:c!=null&&c.line,originalColumn:c!=null&&c.column,source:l,name:u})},s.prototype.setSourceContent=function(o,a){var c=o;this._sourceRoot!=null&&(c=e.relative(this._sourceRoot,c)),a!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[e.toSetString(c)]=a):this._sourcesContents&&(delete this._sourcesContents[e.toSetString(c)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))},s.prototype.applySourceMap=function(o,a,c){var l=a;if(a==null){if(o.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);l=o.file}var u=this._sourceRoot;u!=null&&(l=e.relative(u,l));var d=new r,h=new r;this._mappings.unsortedForEach(function(f){if(f.source===l&&f.originalLine!=null){var p=o.originalPositionFor({line:f.originalLine,column:f.originalColumn});p.source!=null&&(f.source=p.source,c!=null&&(f.source=e.join(c,f.source)),u!=null&&(f.source=e.relative(u,f.source)),f.originalLine=p.line,f.originalColumn=p.column,p.name!=null&&(f.name=p.name))}var y=f.source;y!=null&&!d.has(y)&&d.add(y);var b=f.name;b!=null&&!h.has(b)&&h.add(b)},this),this._sources=d,this._names=h,o.sources.forEach(function(f){var p=o.sourceContentFor(f);p!=null&&(c!=null&&(f=e.join(c,f)),u!=null&&(f=e.relative(u,f)),this.setSourceContent(f,p))},this)},s.prototype._validateMapping=function(o,a,c,l){if(a&&typeof a.line!="number"&&typeof a.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(o&&"line"in o&&"column"in o&&o.line>0&&o.column>=0&&!a&&!c&&!l)){if(o&&"line"in o&&"column"in o&&a&&"line"in a&&"column"in a&&o.line>0&&o.column>=0&&a.line>0&&a.column>=0&&c)return;throw new Error("Invalid mapping: "+JSON.stringify({generated:o,source:c,original:a,name:l}))}},s.prototype._serializeMappings=function(){for(var o=0,a=1,c=0,l=0,u=0,d=0,h="",f,p,y,b,w=this._mappings.toArray(),g=0,v=w.length;g<v;g++){if(p=w[g],f="",p.generatedLine!==a)for(o=0;p.generatedLine!==a;)f+=";",a++;else if(g>0){if(!e.compareByGeneratedPositionsInflated(p,w[g-1]))continue;f+=","}f+=t.encode(p.generatedColumn-o),o=p.generatedColumn,p.source!=null&&(b=this._sources.indexOf(p.source),f+=t.encode(b-d),d=b,f+=t.encode(p.originalLine-1-l),l=p.originalLine-1,f+=t.encode(p.originalColumn-c),c=p.originalColumn,p.name!=null&&(y=this._names.indexOf(p.name),f+=t.encode(y-u),u=y)),h+=f}return h},s.prototype._generateSourcesContent=function(o,a){return o.map(function(c){if(!this._sourcesContents)return null;a!=null&&(c=e.relative(a,c));var l=e.toSetString(c);return Object.prototype.hasOwnProperty.call(this._sourcesContents,l)?this._sourcesContents[l]:null},this)},s.prototype.toJSON=function(){var o={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(o.file=this._file),this._sourceRoot!=null&&(o.sourceRoot=this._sourceRoot),this._sourcesContents&&(o.sourcesContent=this._generateSourcesContent(o.sources,o.sourceRoot)),o},s.prototype.toString=function(){return JSON.stringify(this.toJSON())},aw.SourceMapGenerator=s,aw}var pp={},dw={},H$;function Jq(){return H$||(H$=1,function(t){t.GREATEST_LOWER_BOUND=1,t.LEAST_UPPER_BOUND=2;function e(r,n,s,i,o,a){var c=Math.floor((n-r)/2)+r,l=o(s,i[c],!0);return l===0?c:l>0?n-c>1?e(c,n,s,i,o,a):a==t.LEAST_UPPER_BOUND?n<i.length?n:-1:c:c-r>1?e(r,c,s,i,o,a):a==t.LEAST_UPPER_BOUND?c:r<0?-1:r}t.search=function(n,s,i,o){if(s.length===0)return-1;var a=e(-1,s.length,n,s,i,o||t.GREATEST_LOWER_BOUND);if(a<0)return-1;for(;a-1>=0&&i(s[a],s[a-1],!0)===0;)--a;return a}}(dw)),dw}var fw={},W$;function Gq(){if(W$)return fw;W$=1;function t(n,s,i){var o=n[s];n[s]=n[i],n[i]=o}function e(n,s){return Math.round(n+Math.random()*(s-n))}function r(n,s,i,o){if(i<o){var a=e(i,o),c=i-1;t(n,a,o);for(var l=n[o],u=i;u<o;u++)s(n[u],l)<=0&&(c+=1,t(n,c,u));t(n,c+1,u);var d=c+1;r(n,s,i,d-1),r(n,s,d+1,o)}}return fw.quickSort=function(n,s){r(n,s,0,n.length-1)},fw}var J$;function Zq(){if(J$)return pp;J$=1;var t=ay(),e=Jq(),r=cO().ArraySet,n=uO(),s=Gq().quickSort;function i(l,u){var d=l;return typeof l=="string"&&(d=t.parseSourceMapInput(l)),d.sections!=null?new c(d,u):new o(d,u)}i.fromSourceMap=function(l,u){return o.fromSourceMap(l,u)},i.prototype._version=3,i.prototype.__generatedMappings=null,Object.defineProperty(i.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),i.prototype.__originalMappings=null,Object.defineProperty(i.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),i.prototype._charIsMappingSeparator=function(u,d){var h=u.charAt(d);return h===";"||h===","},i.prototype._parseMappings=function(u,d){throw new Error("Subclasses must implement _parseMappings")},i.GENERATED_ORDER=1,i.ORIGINAL_ORDER=2,i.GREATEST_LOWER_BOUND=1,i.LEAST_UPPER_BOUND=2,i.prototype.eachMapping=function(u,d,h){var f=d||null,p=h||i.GENERATED_ORDER,y;switch(p){case i.GENERATED_ORDER:y=this._generatedMappings;break;case i.ORIGINAL_ORDER:y=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var b=this.sourceRoot;y.map(function(w){var g=w.source===null?null:this._sources.at(w.source);return g=t.computeSourceURL(b,g,this._sourceMapURL),{source:g,generatedLine:w.generatedLine,generatedColumn:w.generatedColumn,originalLine:w.originalLine,originalColumn:w.originalColumn,name:w.name===null?null:this._names.at(w.name)}},this).forEach(u,f)},i.prototype.allGeneratedPositionsFor=function(u){var d=t.getArg(u,"line"),h={source:t.getArg(u,"source"),originalLine:d,originalColumn:t.getArg(u,"column",0)};if(h.source=this._findSourceIndex(h.source),h.source<0)return[];var f=[],p=this._findMapping(h,this._originalMappings,"originalLine","originalColumn",t.compareByOriginalPositions,e.LEAST_UPPER_BOUND);if(p>=0){var y=this._originalMappings[p];if(u.column===void 0)for(var b=y.originalLine;y&&y.originalLine===b;)f.push({line:t.getArg(y,"generatedLine",null),column:t.getArg(y,"generatedColumn",null),lastColumn:t.getArg(y,"lastGeneratedColumn",null)}),y=this._originalMappings[++p];else for(var w=y.originalColumn;y&&y.originalLine===d&&y.originalColumn==w;)f.push({line:t.getArg(y,"generatedLine",null),column:t.getArg(y,"generatedColumn",null),lastColumn:t.getArg(y,"lastGeneratedColumn",null)}),y=this._originalMappings[++p]}return f},pp.SourceMapConsumer=i;function o(l,u){var d=l;typeof l=="string"&&(d=t.parseSourceMapInput(l));var h=t.getArg(d,"version"),f=t.getArg(d,"sources"),p=t.getArg(d,"names",[]),y=t.getArg(d,"sourceRoot",null),b=t.getArg(d,"sourcesContent",null),w=t.getArg(d,"mappings"),g=t.getArg(d,"file",null);if(h!=this._version)throw new Error("Unsupported version: "+h);y&&(y=t.normalize(y)),f=f.map(String).map(t.normalize).map(function(v){return y&&t.isAbsolute(y)&&t.isAbsolute(v)?t.relative(y,v):v}),this._names=r.fromArray(p.map(String),!0),this._sources=r.fromArray(f,!0),this._absoluteSources=this._sources.toArray().map(function(v){return t.computeSourceURL(y,v,u)}),this.sourceRoot=y,this.sourcesContent=b,this._mappings=w,this._sourceMapURL=u,this.file=g}o.prototype=Object.create(i.prototype),o.prototype.consumer=i,o.prototype._findSourceIndex=function(l){var u=l;if(this.sourceRoot!=null&&(u=t.relative(this.sourceRoot,u)),this._sources.has(u))return this._sources.indexOf(u);var d;for(d=0;d<this._absoluteSources.length;++d)if(this._absoluteSources[d]==l)return d;return-1},o.fromSourceMap=function(u,d){var h=Object.create(o.prototype),f=h._names=r.fromArray(u._names.toArray(),!0),p=h._sources=r.fromArray(u._sources.toArray(),!0);h.sourceRoot=u._sourceRoot,h.sourcesContent=u._generateSourcesContent(h._sources.toArray(),h.sourceRoot),h.file=u._file,h._sourceMapURL=d,h._absoluteSources=h._sources.toArray().map(function(x){return t.computeSourceURL(h.sourceRoot,x,d)});for(var y=u._mappings.toArray().slice(),b=h.__generatedMappings=[],w=h.__originalMappings=[],g=0,v=y.length;g<v;g++){var m=y[g],_=new a;_.generatedLine=m.generatedLine,_.generatedColumn=m.generatedColumn,m.source&&(_.source=p.indexOf(m.source),_.originalLine=m.originalLine,_.originalColumn=m.originalColumn,m.name&&(_.name=f.indexOf(m.name)),w.push(_)),b.push(_)}return s(h.__originalMappings,t.compareByOriginalPositions),h},o.prototype._version=3,Object.defineProperty(o.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function a(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}o.prototype._parseMappings=function(u,d){for(var h=1,f=0,p=0,y=0,b=0,w=0,g=u.length,v=0,m={},_={},x=[],D=[],E,A,S,O,I;v<g;)if(u.charAt(v)===";")h++,v++,f=0;else if(u.charAt(v)===",")v++;else{for(E=new a,E.generatedLine=h,O=v;O<g&&!this._charIsMappingSeparator(u,O);O++);if(A=u.slice(v,O),S=m[A],S)v+=A.length;else{for(S=[];v<O;)n.decode(u,v,_),I=_.value,v=_.rest,S.push(I);if(S.length===2)throw new Error("Found a source, but no line and column");if(S.length===3)throw new Error("Found a source and line, but no column");m[A]=S}E.generatedColumn=f+S[0],f=E.generatedColumn,S.length>1&&(E.source=b+S[1],b+=S[1],E.originalLine=p+S[2],p=E.originalLine,E.originalLine+=1,E.originalColumn=y+S[3],y=E.originalColumn,S.length>4&&(E.name=w+S[4],w+=S[4])),D.push(E),typeof E.originalLine=="number"&&x.push(E)}s(D,t.compareByGeneratedPositionsDeflated),this.__generatedMappings=D,s(x,t.compareByOriginalPositions),this.__originalMappings=x},o.prototype._findMapping=function(u,d,h,f,p,y){if(u[h]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+u[h]);if(u[f]<0)throw new TypeError("Column must be greater than or equal to 0, got "+u[f]);return e.search(u,d,p,y)},o.prototype.computeColumnSpans=function(){for(var u=0;u<this._generatedMappings.length;++u){var d=this._generatedMappings[u];if(u+1<this._generatedMappings.length){var h=this._generatedMappings[u+1];if(d.generatedLine===h.generatedLine){d.lastGeneratedColumn=h.generatedColumn-1;continue}}d.lastGeneratedColumn=1/0}},o.prototype.originalPositionFor=function(u){var d={generatedLine:t.getArg(u,"line"),generatedColumn:t.getArg(u,"column")},h=this._findMapping(d,this._generatedMappings,"generatedLine","generatedColumn",t.compareByGeneratedPositionsDeflated,t.getArg(u,"bias",i.GREATEST_LOWER_BOUND));if(h>=0){var f=this._generatedMappings[h];if(f.generatedLine===d.generatedLine){var p=t.getArg(f,"source",null);p!==null&&(p=this._sources.at(p),p=t.computeSourceURL(this.sourceRoot,p,this._sourceMapURL));var y=t.getArg(f,"name",null);return y!==null&&(y=this._names.at(y)),{source:p,line:t.getArg(f,"originalLine",null),column:t.getArg(f,"originalColumn",null),name:y}}}return{source:null,line:null,column:null,name:null}},o.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(u){return u==null}):!1},o.prototype.sourceContentFor=function(u,d){if(!this.sourcesContent)return null;var h=this._findSourceIndex(u);if(h>=0)return this.sourcesContent[h];var f=u;this.sourceRoot!=null&&(f=t.relative(this.sourceRoot,f));var p;if(this.sourceRoot!=null&&(p=t.urlParse(this.sourceRoot))){var y=f.replace(/^file:\/\//,"");if(p.scheme=="file"&&this._sources.has(y))return this.sourcesContent[this._sources.indexOf(y)];if((!p.path||p.path=="/")&&this._sources.has("/"+f))return this.sourcesContent[this._sources.indexOf("/"+f)]}if(d)return null;throw new Error('"'+f+'" is not in the SourceMap.')},o.prototype.generatedPositionFor=function(u){var d=t.getArg(u,"source");if(d=this._findSourceIndex(d),d<0)return{line:null,column:null,lastColumn:null};var h={source:d,originalLine:t.getArg(u,"line"),originalColumn:t.getArg(u,"column")},f=this._findMapping(h,this._originalMappings,"originalLine","originalColumn",t.compareByOriginalPositions,t.getArg(u,"bias",i.GREATEST_LOWER_BOUND));if(f>=0){var p=this._originalMappings[f];if(p.source===h.source)return{line:t.getArg(p,"generatedLine",null),column:t.getArg(p,"generatedColumn",null),lastColumn:t.getArg(p,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},pp.BasicSourceMapConsumer=o;function c(l,u){var d=l;typeof l=="string"&&(d=t.parseSourceMapInput(l));var h=t.getArg(d,"version"),f=t.getArg(d,"sections");if(h!=this._version)throw new Error("Unsupported version: "+h);this._sources=new r,this._names=new r;var p={line:-1,column:0};this._sections=f.map(function(y){if(y.url)throw new Error("Support for url field in sections not implemented.");var b=t.getArg(y,"offset"),w=t.getArg(b,"line"),g=t.getArg(b,"column");if(w<p.line||w===p.line&&g<p.column)throw new Error("Section offsets must be ordered and non-overlapping.");return p=b,{generatedOffset:{generatedLine:w+1,generatedColumn:g+1},consumer:new i(t.getArg(y,"map"),u)}})}return c.prototype=Object.create(i.prototype),c.prototype.constructor=i,c.prototype._version=3,Object.defineProperty(c.prototype,"sources",{get:function(){for(var l=[],u=0;u<this._sections.length;u++)for(var d=0;d<this._sections[u].consumer.sources.length;d++)l.push(this._sections[u].consumer.sources[d]);return l}}),c.prototype.originalPositionFor=function(u){var d={generatedLine:t.getArg(u,"line"),generatedColumn:t.getArg(u,"column")},h=e.search(d,this._sections,function(p,y){var b=p.generatedLine-y.generatedOffset.generatedLine;return b||p.generatedColumn-y.generatedOffset.generatedColumn}),f=this._sections[h];return f?f.consumer.originalPositionFor({line:d.generatedLine-(f.generatedOffset.generatedLine-1),column:d.generatedColumn-(f.generatedOffset.generatedLine===d.generatedLine?f.generatedOffset.generatedColumn-1:0),bias:u.bias}):{source:null,line:null,column:null,name:null}},c.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(u){return u.consumer.hasContentsOfAllSources()})},c.prototype.sourceContentFor=function(u,d){for(var h=0;h<this._sections.length;h++){var f=this._sections[h],p=f.consumer.sourceContentFor(u,!0);if(p)return p}if(d)return null;throw new Error('"'+u+'" is not in the SourceMap.')},c.prototype.generatedPositionFor=function(u){for(var d=0;d<this._sections.length;d++){var h=this._sections[d];if(h.consumer._findSourceIndex(t.getArg(u,"source"))!==-1){var f=h.consumer.generatedPositionFor(u);if(f){var p={line:f.line+(h.generatedOffset.generatedLine-1),column:f.column+(h.generatedOffset.generatedLine===f.line?h.generatedOffset.generatedColumn-1:0)};return p}}}return{line:null,column:null}},c.prototype._parseMappings=function(u,d){this.__generatedMappings=[],this.__originalMappings=[];for(var h=0;h<this._sections.length;h++)for(var f=this._sections[h],p=f.consumer._generatedMappings,y=0;y<p.length;y++){var b=p[y],w=f.consumer._sources.at(b.source);w=t.computeSourceURL(f.consumer.sourceRoot,w,this._sourceMapURL),this._sources.add(w),w=this._sources.indexOf(w);var g=null;b.name&&(g=f.consumer._names.at(b.name),this._names.add(g),g=this._names.indexOf(g));var v={source:w,generatedLine:b.generatedLine+(f.generatedOffset.generatedLine-1),generatedColumn:b.generatedColumn+(f.generatedOffset.generatedLine===b.generatedLine?f.generatedOffset.generatedColumn-1:0),originalLine:b.originalLine,originalColumn:b.originalColumn,name:g};this.__generatedMappings.push(v),typeof v.originalLine=="number"&&this.__originalMappings.push(v)}s(this.__generatedMappings,t.compareByGeneratedPositionsDeflated),s(this.__originalMappings,t.compareByOriginalPositions)},pp.IndexedSourceMapConsumer=c,pp}var pw={},G$;function Xq(){if(G$)return pw;G$=1;var t=lO().SourceMapGenerator,e=ay(),r=/(\r?\n)/,n=10,s="$$$isSourceNode$$$";function i(o,a,c,l,u){this.children=[],this.sourceContents={},this.line=o??null,this.column=a??null,this.source=c??null,this.name=u??null,this[s]=!0,l!=null&&this.add(l)}return i.fromStringWithSourceMap=function(a,c,l){var u=new i,d=a.split(r),h=0,f=function(){var g=m(),v=m()||"";return g+v;function m(){return h<d.length?d[h++]:void 0}},p=1,y=0,b=null;return c.eachMapping(function(g){if(b!==null)if(p<g.generatedLine)w(b,f()),p++,y=0;else{var v=d[h]||"",m=v.substr(0,g.generatedColumn-y);d[h]=v.substr(g.generatedColumn-y),y=g.generatedColumn,w(b,m),b=g;return}for(;p<g.generatedLine;)u.add(f()),p++;if(y<g.generatedColumn){var v=d[h]||"";u.add(v.substr(0,g.generatedColumn)),d[h]=v.substr(g.generatedColumn),y=g.generatedColumn}b=g},this),h<d.length&&(b&&w(b,f()),u.add(d.splice(h).join(""))),c.sources.forEach(function(g){var v=c.sourceContentFor(g);v!=null&&(l!=null&&(g=e.join(l,g)),u.setSourceContent(g,v))}),u;function w(g,v){if(g===null||g.source===void 0)u.add(v);else{var m=l?e.join(l,g.source):g.source;u.add(new i(g.originalLine,g.originalColumn,m,v,g.name))}}},i.prototype.add=function(a){if(Array.isArray(a))a.forEach(function(c){this.add(c)},this);else if(a[s]||typeof a=="string")a&&this.children.push(a);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+a);return this},i.prototype.prepend=function(a){if(Array.isArray(a))for(var c=a.length-1;c>=0;c--)this.prepend(a[c]);else if(a[s]||typeof a=="string")this.children.unshift(a);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+a);return this},i.prototype.walk=function(a){for(var c,l=0,u=this.children.length;l<u;l++)c=this.children[l],c[s]?c.walk(a):c!==""&&a(c,{source:this.source,line:this.line,column:this.column,name:this.name})},i.prototype.join=function(a){var c,l,u=this.children.length;if(u>0){for(c=[],l=0;l<u-1;l++)c.push(this.children[l]),c.push(a);c.push(this.children[l]),this.children=c}return this},i.prototype.replaceRight=function(a,c){var l=this.children[this.children.length-1];return l[s]?l.replaceRight(a,c):typeof l=="string"?this.children[this.children.length-1]=l.replace(a,c):this.children.push("".replace(a,c)),this},i.prototype.setSourceContent=function(a,c){this.sourceContents[e.toSetString(a)]=c},i.prototype.walkSourceContents=function(a){for(var c=0,l=this.children.length;c<l;c++)this.children[c][s]&&this.children[c].walkSourceContents(a);for(var u=Object.keys(this.sourceContents),c=0,l=u.length;c<l;c++)a(e.fromSetString(u[c]),this.sourceContents[u[c]])},i.prototype.toString=function(){var a="";return this.walk(function(c){a+=c}),a},i.prototype.toStringWithSourceMap=function(a){var c={code:"",line:1,column:0},l=new t(a),u=!1,d=null,h=null,f=null,p=null;return this.walk(function(y,b){c.code+=y,b.source!==null&&b.line!==null&&b.column!==null?((d!==b.source||h!==b.line||f!==b.column||p!==b.name)&&l.addMapping({source:b.source,original:{line:b.line,column:b.column},generated:{line:c.line,column:c.column},name:b.name}),d=b.source,h=b.line,f=b.column,p=b.name,u=!0):u&&(l.addMapping({generated:{line:c.line,column:c.column}}),d=null,u=!1);for(var w=0,g=y.length;w<g;w++)y.charCodeAt(w)===n?(c.line++,c.column=0,w+1===g?(d=null,u=!1):u&&l.addMapping({source:b.source,original:{line:b.line,column:b.column},generated:{line:c.line,column:c.column},name:b.name})):c.column++}),this.walkSourceContents(function(y,b){l.setSourceContent(y,b)}),{code:c.code,map:l}},pw.SourceNode=i,pw}var Z$;function Yq(){return Z$||(Z$=1,fp.SourceMapGenerator=lO().SourceMapGenerator,fp.SourceMapConsumer=Zq().SourceMapConsumer,fp.SourceNode=Xq().SourceNode),fp}const Qq="escodegen",eV="ECMAScript code generator",tV="http://github.com/estools/escodegen",rV="escodegen.js",nV={esgenerate:"./bin/esgenerate.js",escodegen:"./bin/escodegen.js"},iV=["LICENSE.BSD","README.md","bin","escodegen.js","package.json"],sV="1.14.3",oV={node:">=4.0"},aV=[{name:"Yusuke Suzuki",email:"utatane.tea@gmail.com",web:"http://github.com/Constellation"}],uV={type:"git",url:"http://github.com/estools/escodegen.git"},cV={estraverse:"^4.2.0",esutils:"^2.0.2",esprima:"^4.0.1",optionator:"^0.8.1"},lV={"source-map":"~0.6.1"},dV={acorn:"^7.1.0",bluebird:"^3.4.7","bower-registry-client":"^1.0.0",chai:"^3.5.0","commonjs-everywhere":"^0.9.7",gulp:"^3.8.10","gulp-eslint":"^3.0.1","gulp-mocha":"^3.0.1",semver:"^5.1.0"},fV="BSD-2-Clause",pV={test:"gulp travis","unit-test":"gulp test",lint:"gulp lint",release:"node tools/release.js","build-min":"./node_modules/.bin/cjsify -ma path: tools/entry-point.js > escodegen.browser.min.js",build:"./node_modules/.bin/cjsify -a path: tools/entry-point.js > escodegen.browser.js"},hV={name:Qq,description:eV,homepage:tV,main:rV,bin:nV,files:iV,version:sV,engines:oV,maintainers:aV,repository:uV,dependencies:cV,optionalDependencies:lV,devDependencies:dV,license:fV,scripts:pV};(function(t){(function(){var e,r,n,s,i,o,a,c,l,u,d,h,f,p,y,b,w,g,v,m,_,x,D,E,A,S;i=nO,o=Qm,e=i.Syntax;function O(P){return Rt.Expression.hasOwnProperty(P.type)}function I(P){return Rt.Statement.hasOwnProperty(P.type)}r={Sequence:0,Yield:1,Assignment:1,Conditional:2,ArrowFunction:2,LogicalOR:3,LogicalAND:4,BitwiseOR:5,BitwiseXOR:6,BitwiseAND:7,Equality:8,Relational:9,BitwiseSHIFT:10,Additive:11,Multiplicative:12,Exponentiation:13,Await:14,Unary:14,Postfix:15,Call:16,New:17,TaggedTemplate:18,Member:19,Primary:20},n={"||":r.LogicalOR,"&&":r.LogicalAND,"|":r.BitwiseOR,"^":r.BitwiseXOR,"&":r.BitwiseAND,"==":r.Equality,"!=":r.Equality,"===":r.Equality,"!==":r.Equality,is:r.Equality,isnt:r.Equality,"<":r.Relational,">":r.Relational,"<=":r.Relational,">=":r.Relational,in:r.Relational,instanceof:r.Relational,"<<":r.BitwiseSHIFT,">>":r.BitwiseSHIFT,">>>":r.BitwiseSHIFT,"+":r.Additive,"-":r.Additive,"*":r.Multiplicative,"%":r.Multiplicative,"/":r.Multiplicative,"**":r.Exponentiation};var N=1,j=2,F=4,V=8,ee=16,G=32,Z=j|F,M=N|j,k=N|j|F,H=N,U=F,$=N|F,T=N,z=N|G,ne=0,ue=N|ee,ye=N|V;function _e(){return{indent:null,base:null,parse:null,comment:!1,format:{indent:{style:"    ",base:0,adjustMultilineComment:!1},newline:`
`,space:" ",json:!1,renumber:!1,hexadecimal:!1,quotes:"single",escapeless:!1,compact:!1,parentheses:!0,semicolons:!0,safeConcatenation:!1,preserveBlankLines:!1},moz:{comprehensionExpressionStartsWithAssignment:!1,starlessGenerator:!1},sourceMap:null,sourceMapRoot:null,sourceMapWithCode:!1,directive:!1,raw:!0,verbatim:null,sourceCode:null}}function Se(P,L){var R="";for(L|=0;L>0;L>>>=1,P+=P)L&1&&(R+=P);return R}function We(P){return/[\r\n]/g.test(P)}function te(P){var L=P.length;return L&&o.code.isLineTerminator(P.charCodeAt(L-1))}function se(P,L){var R;for(R in L)L.hasOwnProperty(R)&&(P[R]=L[R]);return P}function ce(P,L){var R,q;function Y(pe){return typeof pe=="object"&&pe instanceof Object&&!(pe instanceof RegExp)}for(R in L)L.hasOwnProperty(R)&&(q=L[R],Y(q)?Y(P[R])?ce(P[R],q):P[R]=ce({},q):P[R]=q);return P}function K(P){var L,R,q,Y,pe;if(P!==P)throw new Error("Numeric literal whose value is NaN");if(P<0||P===0&&1/P<0)throw new Error("Numeric literal whose value is negative");if(P===1/0)return l?"null":u?"1e400":"1e+400";if(L=""+P,!u||L.length<3)return L;for(R=L.indexOf("."),!l&&L.charCodeAt(0)===48&&R===1&&(R=0,L=L.slice(1)),q=L,L=L.replace("e+","e"),Y=0,(pe=q.indexOf("e"))>0&&(Y=+q.slice(pe+1),q=q.slice(0,pe)),R>=0&&(Y-=q.length-R-1,q=+(q.slice(0,R)+q.slice(R+1))+""),pe=0;q.charCodeAt(q.length+pe-1)===48;)--pe;return pe!==0&&(Y-=pe,q=q.slice(0,pe)),Y!==0&&(q+="e"+Y),(q.length<L.length||d&&P>1e12&&Math.floor(P)===P&&(q="0x"+P.toString(16)).length<L.length)&&+q===P&&(L=q),L}function C(P,L){return(P&-2)===8232?(L?"u":"\\u")+(P===8232?"2028":"2029"):P===10||P===13?(L?"":"\\")+(P===10?"n":"r"):String.fromCharCode(P)}function B(P){var L,R,q,Y,pe,ve,Ee,Re;if(R=P.toString(),P.source){if(L=R.match(/\/([^/]*)$/),!L)return R;for(q=L[1],R="",Ee=!1,Re=!1,Y=0,pe=P.source.length;Y<pe;++Y)ve=P.source.charCodeAt(Y),Re?(R+=C(ve,Re),Re=!1):(Ee?ve===93&&(Ee=!1):ve===47?R+="\\":ve===91&&(Ee=!0),R+=C(ve,Re),Re=ve===92);return"/"+R+"/"+q}return R}function X(P,L){var R;return P===8?"\\b":P===12?"\\f":P===9?"\\t":(R=P.toString(16).toUpperCase(),l||P>255?"\\u"+"0000".slice(R.length)+R:P===0&&!o.code.isDecimalDigit(L)?"\\0":P===11?"\\x0B":"\\x"+"00".slice(R.length)+R)}function ae(P){if(P===92)return"\\\\";if(P===10)return"\\n";if(P===13)return"\\r";if(P===8232)return"\\u2028";if(P===8233)return"\\u2029";throw new Error("Incorrectly classified character")}function ge(P){var L,R,q,Y;for(Y=h==="double"?'"':"'",L=0,R=P.length;L<R;++L)if(q=P.charCodeAt(L),q===39){Y='"';break}else if(q===34){Y="'";break}else q===92&&++L;return Y+P+Y}function be(P){var L="",R,q,Y,pe=0,ve=0,Ee,Re;for(R=0,q=P.length;R<q;++R){if(Y=P.charCodeAt(R),Y===39)++pe;else if(Y===34)++ve;else if(Y===47&&l)L+="\\";else if(o.code.isLineTerminator(Y)||Y===92){L+=ae(Y);continue}else if(!o.code.isIdentifierPartES5(Y)&&(l&&Y<32||!l&&!f&&(Y<32||Y>126))){L+=X(Y,P.charCodeAt(R+1));continue}L+=String.fromCharCode(Y)}if(Ee=!(h==="double"||h==="auto"&&ve<pe),Re=Ee?"'":'"',!(Ee?pe:ve))return Re+L+Re;for(P=L,L=Re,R=0,q=P.length;R<q;++R)Y=P.charCodeAt(R),(Y===39&&Ee||Y===34&&!Ee)&&(L+="\\"),L+=String.fromCharCode(Y);return L+Re}function Ne(P){var L,R,q,Y="";for(L=0,R=P.length;L<R;++L)q=P[L],Y+=Array.isArray(q)?Ne(q):q;return Y}function Oe(P,L){if(!x)return Array.isArray(P)?Ne(P):P;if(L==null){if(P instanceof s)return P;L={}}return L.loc==null?new s(null,null,x,P,L.name||null):new s(L.loc.start.line,L.loc.start.column,x===!0?L.loc.source||null:x,P,L.name||null)}function W(){return y||" "}function J(P,L){var R,q,Y,pe;return R=Oe(P).toString(),R.length===0?[L]:(q=Oe(L).toString(),q.length===0?[P]:(Y=R.charCodeAt(R.length-1),pe=q.charCodeAt(0),(Y===43||Y===45)&&Y===pe||o.code.isIdentifierPartES5(Y)&&o.code.isIdentifierPartES5(pe)||Y===47&&pe===105?[P,W(),L]:o.code.isWhiteSpace(Y)||o.code.isLineTerminator(Y)||o.code.isWhiteSpace(pe)||o.code.isLineTerminator(pe)?[P,L]:[P,y,L]))}function he(P){return[a,P]}function we(P){var L;L=a,a+=c,P(a),a=L}function Ce(P){var L;for(L=P.length-1;L>=0&&!o.code.isLineTerminator(P.charCodeAt(L));--L);return P.length-1-L}function Mt(P,L){var R,q,Y,pe,ve,Ee,Re,Dt;for(R=P.split(/\r\n|[\r\n]/),Ee=Number.MAX_VALUE,q=1,Y=R.length;q<Y;++q){for(pe=R[q],ve=0;ve<pe.length&&o.code.isWhiteSpace(pe.charCodeAt(ve));)++ve;Ee>ve&&(Ee=ve)}for(typeof L<"u"?(Re=a,R[1][Ee]==="*"&&(L+=" "),a=L):(Ee&1&&--Ee,Re=a),q=1,Y=R.length;q<Y;++q)Dt=Oe(he(R[q].slice(Ee))),R[q]=x?Dt.join(""):Dt;return a=Re,R.join(`
`)}function or(P,L){if(P.type==="Line"){if(te(P.value))return"//"+P.value;var R="//"+P.value;return E||(R+=`
`),R}return m.format.indent.adjustMultilineComment&&/[\n\r]/.test(P.value)?Mt("/*"+P.value+"*/",L):"/*"+P.value+"*/"}function Gs(P,L){var R,q,Y,pe,ve,Ee,Re,Dt,re,Q,ie,fe,le,je;if(P.leadingComments&&P.leadingComments.length>0){if(pe=L,E){for(Y=P.leadingComments[0],L=[],Dt=Y.extendedRange,re=Y.range,ie=D.substring(Dt[0],re[0]),je=(ie.match(/\n/g)||[]).length,je>0?(L.push(Se(`
`,je)),L.push(he(or(Y)))):(L.push(ie),L.push(or(Y))),Q=re,R=1,q=P.leadingComments.length;R<q;R++)Y=P.leadingComments[R],re=Y.range,fe=D.substring(Q[1],re[0]),je=(fe.match(/\n/g)||[]).length,L.push(Se(`
`,je)),L.push(he(or(Y))),Q=re;le=D.substring(re[1],Dt[1]),je=(le.match(/\n/g)||[]).length,L.push(Se(`
`,je))}else for(Y=P.leadingComments[0],L=[],g&&P.type===e.Program&&P.body.length===0&&L.push(`
`),L.push(or(Y)),te(Oe(L).toString())||L.push(`
`),R=1,q=P.leadingComments.length;R<q;++R)Y=P.leadingComments[R],Re=[or(Y)],te(Oe(Re).toString())||Re.push(`
`),L.push(he(Re));L.push(he(pe))}if(P.trailingComments)if(E)Y=P.trailingComments[0],Dt=Y.extendedRange,re=Y.range,ie=D.substring(Dt[0],re[0]),je=(ie.match(/\n/g)||[]).length,je>0?(L.push(Se(`
`,je)),L.push(he(or(Y)))):(L.push(ie),L.push(or(Y)));else for(ve=!te(Oe(L).toString()),Ee=Se(" ",Ce(Oe([a,L,c]).toString())),R=0,q=P.trailingComments.length;R<q;++R)Y=P.trailingComments[R],ve?(R===0?L=[L,c]:L=[L,Ee],L.push(or(Y,Ee))):L=[L,he(or(Y))],R!==q-1&&!te(Oe(L).toString())&&(L=[L,`
`]);return L}function xr(P,L,R){var q,Y=0;for(q=P;q<L;q++)D[q]===`
`&&Y++;for(q=1;q<Y;q++)R.push(p)}function mr(P,L,R){return L<R?["(",P,")"]:P}function sd(P){var L,R,q;for(q=P.split(/\r\n|\n/),L=1,R=q.length;L<R;L++)q[L]=p+a+q[L];return q}function Cc(P,L){var R,q,Y;return R=P[m.verbatim],typeof R=="string"?q=mr(sd(R),r.Sequence,L):(q=sd(R.content),Y=R.precedence!=null?R.precedence:r.Sequence,q=mr(q,Y,L)),Oe(q,P)}function Rt(){}Rt.prototype.maybeBlock=function(P,L){var R,q,Y=this;return q=!m.comment||!P.leadingComments,P.type===e.BlockStatement&&q?[y,this.generateStatement(P,L)]:P.type===e.EmptyStatement&&q?";":(we(function(){R=[p,he(Y.generateStatement(P,L))]}),R)},Rt.prototype.maybeBlockSuffix=function(P,L){var R=te(Oe(L).toString());return P.type===e.BlockStatement&&(!m.comment||!P.leadingComments)&&!R?[L,y]:R?[L,a]:[L,p,a]};function zr(P){return Oe(P.name,P)}function $s(P,L){return P.async?"async"+(L?W():y):""}function Zs(P){var L=P.generator&&!m.moz.starlessGenerator;return L?"*"+y:""}function Xs(P){var L=P.value,R="";return L.async&&(R+=$s(L,!P.computed)),L.generator&&(R+=Zs(L)?"*":""),R}Rt.prototype.generatePattern=function(P,L,R){return P.type===e.Identifier?zr(P):this.generateExpression(P,L,R)},Rt.prototype.generateFunctionParams=function(P){var L,R,q,Y;if(Y=!1,P.type===e.ArrowFunctionExpression&&!P.rest&&(!P.defaults||P.defaults.length===0)&&P.params.length===1&&P.params[0].type===e.Identifier)q=[$s(P,!0),zr(P.params[0])];else{for(q=P.type===e.ArrowFunctionExpression?[$s(P,!1)]:[],q.push("("),P.defaults&&(Y=!0),L=0,R=P.params.length;L<R;++L)Y&&P.defaults[L]?q.push(this.generateAssignment(P.params[L],P.defaults[L],"=",r.Assignment,k)):q.push(this.generatePattern(P.params[L],r.Assignment,k)),L+1<R&&q.push(","+y);P.rest&&(P.params.length&&q.push(","+y),q.push("..."),q.push(zr(P.rest))),q.push(")")}return q},Rt.prototype.generateFunctionBody=function(P){var L,R;return L=this.generateFunctionParams(P),P.type===e.ArrowFunctionExpression&&(L.push(y),L.push("=>")),P.expression?(L.push(y),R=this.generateExpression(P.body,r.Assignment,k),R.toString().charAt(0)==="{"&&(R=["(",R,")"]),L.push(R)):L.push(this.maybeBlock(P.body,ye)),L},Rt.prototype.generateIterationForStatement=function(P,L,R){var q=["for"+(L.await?W()+"await":"")+y+"("],Y=this;return we(function(){L.left.type===e.VariableDeclaration?we(function(){q.push(L.left.kind+W()),q.push(Y.generateStatement(L.left.declarations[0],ne))}):q.push(Y.generateExpression(L.left,r.Call,k)),q=J(q,P),q=[J(q,Y.generateExpression(L.right,r.Assignment,k)),")"]}),q.push(this.maybeBlock(L.body,R)),q},Rt.prototype.generatePropertyKey=function(P,L){var R=[];return L&&R.push("["),R.push(this.generateExpression(P,r.Assignment,k)),L&&R.push("]"),R},Rt.prototype.generateAssignment=function(P,L,R,q,Y){return r.Assignment<q&&(Y|=N),mr([this.generateExpression(P,r.Call,Y),y+R+y,this.generateExpression(L,r.Assignment,Y)],r.Assignment,q)},Rt.prototype.semicolon=function(P){return!w&&P&G?"":";"},Rt.Statement={BlockStatement:function(P,L){var R,q,Y=["{",p],pe=this;return we(function(){P.body.length===0&&E&&(R=P.range,R[1]-R[0]>2&&(q=D.substring(R[0]+1,R[1]-1),q[0]===`
`&&(Y=["{"]),Y.push(q)));var ve,Ee,Re,Dt;for(Dt=T,L&V&&(Dt|=ee),ve=0,Ee=P.body.length;ve<Ee;++ve)E&&(ve===0&&(P.body[0].leadingComments&&(R=P.body[0].leadingComments[0].extendedRange,q=D.substring(R[0],R[1]),q[0]===`
`&&(Y=["{"])),P.body[0].leadingComments||xr(P.range[0],P.body[0].range[0],Y)),ve>0&&!P.body[ve-1].trailingComments&&!P.body[ve].leadingComments&&xr(P.body[ve-1].range[1],P.body[ve].range[0],Y)),ve===Ee-1&&(Dt|=G),P.body[ve].leadingComments&&E?Re=pe.generateStatement(P.body[ve],Dt):Re=he(pe.generateStatement(P.body[ve],Dt)),Y.push(Re),te(Oe(Re).toString())||E&&ve<Ee-1&&P.body[ve+1].leadingComments||Y.push(p),E&&ve===Ee-1&&(P.body[ve].trailingComments||xr(P.body[ve].range[1],P.range[1],Y))}),Y.push(he("}")),Y},BreakStatement:function(P,L){return P.label?"break "+P.label.name+this.semicolon(L):"break"+this.semicolon(L)},ContinueStatement:function(P,L){return P.label?"continue "+P.label.name+this.semicolon(L):"continue"+this.semicolon(L)},ClassBody:function(P,L){var R=["{",p],q=this;return we(function(Y){var pe,ve;for(pe=0,ve=P.body.length;pe<ve;++pe)R.push(Y),R.push(q.generateExpression(P.body[pe],r.Sequence,k)),pe+1<ve&&R.push(p)}),te(Oe(R).toString())||R.push(p),R.push(a),R.push("}"),R},ClassDeclaration:function(P,L){var R,q;return R=["class"],P.id&&(R=J(R,this.generateExpression(P.id,r.Sequence,k))),P.superClass&&(q=J("extends",this.generateExpression(P.superClass,r.Unary,k)),R=J(R,q)),R.push(y),R.push(this.generateStatement(P.body,z)),R},DirectiveStatement:function(P,L){return m.raw&&P.raw?P.raw+this.semicolon(L):ge(P.directive)+this.semicolon(L)},DoWhileStatement:function(P,L){var R=J("do",this.maybeBlock(P.body,T));return R=this.maybeBlockSuffix(P.body,R),J(R,["while"+y+"(",this.generateExpression(P.test,r.Sequence,k),")"+this.semicolon(L)])},CatchClause:function(P,L){var R,q=this;return we(function(){var Y;P.param?(R=["catch"+y+"(",q.generateExpression(P.param,r.Sequence,k),")"],P.guard&&(Y=q.generateExpression(P.guard,r.Sequence,k),R.splice(2,0," if ",Y))):R=["catch"]}),R.push(this.maybeBlock(P.body,T)),R},DebuggerStatement:function(P,L){return"debugger"+this.semicolon(L)},EmptyStatement:function(P,L){return";"},ExportDefaultDeclaration:function(P,L){var R=["export"],q;return q=L&G?z:T,R=J(R,"default"),I(P.declaration)?R=J(R,this.generateStatement(P.declaration,q)):R=J(R,this.generateExpression(P.declaration,r.Assignment,k)+this.semicolon(L)),R},ExportNamedDeclaration:function(P,L){var R=["export"],q,Y=this;return q=L&G?z:T,P.declaration?J(R,this.generateStatement(P.declaration,q)):(P.specifiers&&(P.specifiers.length===0?R=J(R,"{"+y+"}"):P.specifiers[0].type===e.ExportBatchSpecifier?R=J(R,this.generateExpression(P.specifiers[0],r.Sequence,k)):(R=J(R,"{"),we(function(pe){var ve,Ee;for(R.push(p),ve=0,Ee=P.specifiers.length;ve<Ee;++ve)R.push(pe),R.push(Y.generateExpression(P.specifiers[ve],r.Sequence,k)),ve+1<Ee&&R.push(","+p)}),te(Oe(R).toString())||R.push(p),R.push(a+"}")),P.source?R=J(R,["from"+y,this.generateExpression(P.source,r.Sequence,k),this.semicolon(L)]):R.push(this.semicolon(L))),R)},ExportAllDeclaration:function(P,L){return["export"+y,"*"+y,"from"+y,this.generateExpression(P.source,r.Sequence,k),this.semicolon(L)]},ExpressionStatement:function(P,L){var R,q;function Y(Ee){var Re;return Ee.slice(0,5)!=="class"?!1:(Re=Ee.charCodeAt(5),Re===123||o.code.isWhiteSpace(Re)||o.code.isLineTerminator(Re))}function pe(Ee){var Re;return Ee.slice(0,8)!=="function"?!1:(Re=Ee.charCodeAt(8),Re===40||o.code.isWhiteSpace(Re)||Re===42||o.code.isLineTerminator(Re))}function ve(Ee){var Re,Dt,re;if(Ee.slice(0,5)!=="async"||!o.code.isWhiteSpace(Ee.charCodeAt(5)))return!1;for(Dt=6,re=Ee.length;Dt<re&&o.code.isWhiteSpace(Ee.charCodeAt(Dt));++Dt);return Dt===re||Ee.slice(Dt,Dt+8)!=="function"?!1:(Re=Ee.charCodeAt(Dt+8),Re===40||o.code.isWhiteSpace(Re)||Re===42||o.code.isLineTerminator(Re))}return R=[this.generateExpression(P.expression,r.Sequence,k)],q=Oe(R).toString(),q.charCodeAt(0)===123||Y(q)||pe(q)||ve(q)||v&&L&ee&&P.expression.type===e.Literal&&typeof P.expression.value=="string"?R=["(",R,")"+this.semicolon(L)]:R.push(this.semicolon(L)),R},ImportDeclaration:function(P,L){var R,q,Y=this;return P.specifiers.length===0?["import",y,this.generateExpression(P.source,r.Sequence,k),this.semicolon(L)]:(R=["import"],q=0,P.specifiers[q].type===e.ImportDefaultSpecifier&&(R=J(R,[this.generateExpression(P.specifiers[q],r.Sequence,k)]),++q),P.specifiers[q]&&(q!==0&&R.push(","),P.specifiers[q].type===e.ImportNamespaceSpecifier?R=J(R,[y,this.generateExpression(P.specifiers[q],r.Sequence,k)]):(R.push(y+"{"),P.specifiers.length-q===1?(R.push(y),R.push(this.generateExpression(P.specifiers[q],r.Sequence,k)),R.push(y+"}"+y)):(we(function(pe){var ve,Ee;for(R.push(p),ve=q,Ee=P.specifiers.length;ve<Ee;++ve)R.push(pe),R.push(Y.generateExpression(P.specifiers[ve],r.Sequence,k)),ve+1<Ee&&R.push(","+p)}),te(Oe(R).toString())||R.push(p),R.push(a+"}"+y)))),R=J(R,["from"+y,this.generateExpression(P.source,r.Sequence,k),this.semicolon(L)]),R)},VariableDeclarator:function(P,L){var R=L&N?k:Z;return P.init?[this.generateExpression(P.id,r.Assignment,R),y,"=",y,this.generateExpression(P.init,r.Assignment,R)]:this.generatePattern(P.id,r.Assignment,R)},VariableDeclaration:function(P,L){var R,q,Y,pe,ve,Ee=this;R=[P.kind],ve=L&N?T:ne;function Re(){for(pe=P.declarations[0],m.comment&&pe.leadingComments?(R.push(`
`),R.push(he(Ee.generateStatement(pe,ve)))):(R.push(W()),R.push(Ee.generateStatement(pe,ve))),q=1,Y=P.declarations.length;q<Y;++q)pe=P.declarations[q],m.comment&&pe.leadingComments?(R.push(","+p),R.push(he(Ee.generateStatement(pe,ve)))):(R.push(","+y),R.push(Ee.generateStatement(pe,ve)))}return P.declarations.length>1?we(Re):Re(),R.push(this.semicolon(L)),R},ThrowStatement:function(P,L){return[J("throw",this.generateExpression(P.argument,r.Sequence,k)),this.semicolon(L)]},TryStatement:function(P,L){var R,q,Y,pe;if(R=["try",this.maybeBlock(P.block,T)],R=this.maybeBlockSuffix(P.block,R),P.handlers)for(q=0,Y=P.handlers.length;q<Y;++q)R=J(R,this.generateStatement(P.handlers[q],T)),(P.finalizer||q+1!==Y)&&(R=this.maybeBlockSuffix(P.handlers[q].body,R));else{for(pe=P.guardedHandlers||[],q=0,Y=pe.length;q<Y;++q)R=J(R,this.generateStatement(pe[q],T)),(P.finalizer||q+1!==Y)&&(R=this.maybeBlockSuffix(pe[q].body,R));if(P.handler)if(Array.isArray(P.handler))for(q=0,Y=P.handler.length;q<Y;++q)R=J(R,this.generateStatement(P.handler[q],T)),(P.finalizer||q+1!==Y)&&(R=this.maybeBlockSuffix(P.handler[q].body,R));else R=J(R,this.generateStatement(P.handler,T)),P.finalizer&&(R=this.maybeBlockSuffix(P.handler.body,R))}return P.finalizer&&(R=J(R,["finally",this.maybeBlock(P.finalizer,T)])),R},SwitchStatement:function(P,L){var R,q,Y,pe,ve,Ee=this;if(we(function(){R=["switch"+y+"(",Ee.generateExpression(P.discriminant,r.Sequence,k),")"+y+"{"+p]}),P.cases)for(ve=T,Y=0,pe=P.cases.length;Y<pe;++Y)Y===pe-1&&(ve|=G),q=he(this.generateStatement(P.cases[Y],ve)),R.push(q),te(Oe(q).toString())||R.push(p);return R.push(he("}")),R},SwitchCase:function(P,L){var R,q,Y,pe,ve,Ee=this;return we(function(){for(P.test?R=[J("case",Ee.generateExpression(P.test,r.Sequence,k)),":"]:R=["default:"],Y=0,pe=P.consequent.length,pe&&P.consequent[0].type===e.BlockStatement&&(q=Ee.maybeBlock(P.consequent[0],T),R.push(q),Y=1),Y!==pe&&!te(Oe(R).toString())&&R.push(p),ve=T;Y<pe;++Y)Y===pe-1&&L&G&&(ve|=G),q=he(Ee.generateStatement(P.consequent[Y],ve)),R.push(q),Y+1!==pe&&!te(Oe(q).toString())&&R.push(p)}),R},IfStatement:function(P,L){var R,q,Y,pe=this;return we(function(){R=["if"+y+"(",pe.generateExpression(P.test,r.Sequence,k),")"]}),Y=L&G,q=T,Y&&(q|=G),P.alternate?(R.push(this.maybeBlock(P.consequent,T)),R=this.maybeBlockSuffix(P.consequent,R),P.alternate.type===e.IfStatement?R=J(R,["else ",this.generateStatement(P.alternate,q)]):R=J(R,J("else",this.maybeBlock(P.alternate,q)))):R.push(this.maybeBlock(P.consequent,q)),R},ForStatement:function(P,L){var R,q=this;return we(function(){R=["for"+y+"("],P.init?P.init.type===e.VariableDeclaration?R.push(q.generateStatement(P.init,ne)):(R.push(q.generateExpression(P.init,r.Sequence,Z)),R.push(";")):R.push(";"),P.test&&(R.push(y),R.push(q.generateExpression(P.test,r.Sequence,k))),R.push(";"),P.update&&(R.push(y),R.push(q.generateExpression(P.update,r.Sequence,k))),R.push(")")}),R.push(this.maybeBlock(P.body,L&G?z:T)),R},ForInStatement:function(P,L){return this.generateIterationForStatement("in",P,L&G?z:T)},ForOfStatement:function(P,L){return this.generateIterationForStatement("of",P,L&G?z:T)},LabeledStatement:function(P,L){return[P.label.name+":",this.maybeBlock(P.body,L&G?z:T)]},Program:function(P,L){var R,q,Y,pe,ve;for(pe=P.body.length,R=[g&&pe>0?`
`:""],ve=ue,Y=0;Y<pe;++Y)!g&&Y===pe-1&&(ve|=G),E&&(Y===0&&(P.body[0].leadingComments||xr(P.range[0],P.body[Y].range[0],R)),Y>0&&!P.body[Y-1].trailingComments&&!P.body[Y].leadingComments&&xr(P.body[Y-1].range[1],P.body[Y].range[0],R)),q=he(this.generateStatement(P.body[Y],ve)),R.push(q),Y+1<pe&&!te(Oe(q).toString())&&(E&&P.body[Y+1].leadingComments||R.push(p)),E&&Y===pe-1&&(P.body[Y].trailingComments||xr(P.body[Y].range[1],P.range[1],R));return R},FunctionDeclaration:function(P,L){return[$s(P,!0),"function",Zs(P)||W(),P.id?zr(P.id):"",this.generateFunctionBody(P)]},ReturnStatement:function(P,L){return P.argument?[J("return",this.generateExpression(P.argument,r.Sequence,k)),this.semicolon(L)]:["return"+this.semicolon(L)]},WhileStatement:function(P,L){var R,q=this;return we(function(){R=["while"+y+"(",q.generateExpression(P.test,r.Sequence,k),")"]}),R.push(this.maybeBlock(P.body,L&G?z:T)),R},WithStatement:function(P,L){var R,q=this;return we(function(){R=["with"+y+"(",q.generateExpression(P.object,r.Sequence,k),")"]}),R.push(this.maybeBlock(P.body,L&G?z:T)),R}},se(Rt.prototype,Rt.Statement),Rt.Expression={SequenceExpression:function(P,L,R){var q,Y,pe;for(r.Sequence<L&&(R|=N),q=[],Y=0,pe=P.expressions.length;Y<pe;++Y)q.push(this.generateExpression(P.expressions[Y],r.Assignment,R)),Y+1<pe&&q.push(","+y);return mr(q,r.Sequence,L)},AssignmentExpression:function(P,L,R){return this.generateAssignment(P.left,P.right,P.operator,L,R)},ArrowFunctionExpression:function(P,L,R){return mr(this.generateFunctionBody(P),r.ArrowFunction,L)},ConditionalExpression:function(P,L,R){return r.Conditional<L&&(R|=N),mr([this.generateExpression(P.test,r.LogicalOR,R),y+"?"+y,this.generateExpression(P.consequent,r.Assignment,R),y+":"+y,this.generateExpression(P.alternate,r.Assignment,R)],r.Conditional,L)},LogicalExpression:function(P,L,R){return this.BinaryExpression(P,L,R)},BinaryExpression:function(P,L,R){var q,Y,pe,ve,Ee,Re;return ve=n[P.operator],Y=P.operator==="**"?r.Postfix:ve,pe=P.operator==="**"?ve:ve+1,ve<L&&(R|=N),Ee=this.generateExpression(P.left,Y,R),Re=Ee.toString(),Re.charCodeAt(Re.length-1)===47&&o.code.isIdentifierPartES5(P.operator.charCodeAt(0))?q=[Ee,W(),P.operator]:q=J(Ee,P.operator),Ee=this.generateExpression(P.right,pe,R),P.operator==="/"&&Ee.toString().charAt(0)==="/"||P.operator.slice(-1)==="<"&&Ee.toString().slice(0,3)==="!--"?(q.push(W()),q.push(Ee)):q=J(q,Ee),P.operator==="in"&&!(R&N)?["(",q,")"]:mr(q,ve,L)},CallExpression:function(P,L,R){var q,Y,pe;for(q=[this.generateExpression(P.callee,r.Call,M)],q.push("("),Y=0,pe=P.arguments.length;Y<pe;++Y)q.push(this.generateExpression(P.arguments[Y],r.Assignment,k)),Y+1<pe&&q.push(","+y);return q.push(")"),R&j?mr(q,r.Call,L):["(",q,")"]},NewExpression:function(P,L,R){var q,Y,pe,ve,Ee;if(Y=P.arguments.length,Ee=R&F&&!b&&Y===0?$:H,q=J("new",this.generateExpression(P.callee,r.New,Ee)),!(R&F)||b||Y>0){for(q.push("("),pe=0,ve=Y;pe<ve;++pe)q.push(this.generateExpression(P.arguments[pe],r.Assignment,k)),pe+1<ve&&q.push(","+y);q.push(")")}return mr(q,r.New,L)},MemberExpression:function(P,L,R){var q,Y;return q=[this.generateExpression(P.object,r.Call,R&j?M:H)],P.computed?(q.push("["),q.push(this.generateExpression(P.property,r.Sequence,R&j?k:$)),q.push("]")):(P.object.type===e.Literal&&typeof P.object.value=="number"&&(Y=Oe(q).toString(),Y.indexOf(".")<0&&!/[eExX]/.test(Y)&&o.code.isDecimalDigit(Y.charCodeAt(Y.length-1))&&!(Y.length>=2&&Y.charCodeAt(0)===48)&&q.push(" ")),q.push("."),q.push(zr(P.property))),mr(q,r.Member,L)},MetaProperty:function(P,L,R){var q;return q=[],q.push(typeof P.meta=="string"?P.meta:zr(P.meta)),q.push("."),q.push(typeof P.property=="string"?P.property:zr(P.property)),mr(q,r.Member,L)},UnaryExpression:function(P,L,R){var q,Y,pe,ve,Ee;return Y=this.generateExpression(P.argument,r.Unary,k),y===""?q=J(P.operator,Y):(q=[P.operator],P.operator.length>2?q=J(q,Y):(ve=Oe(q).toString(),Ee=ve.charCodeAt(ve.length-1),pe=Y.toString().charCodeAt(0),((Ee===43||Ee===45)&&Ee===pe||o.code.isIdentifierPartES5(Ee)&&o.code.isIdentifierPartES5(pe))&&q.push(W()),q.push(Y))),mr(q,r.Unary,L)},YieldExpression:function(P,L,R){var q;return P.delegate?q="yield*":q="yield",P.argument&&(q=J(q,this.generateExpression(P.argument,r.Yield,k))),mr(q,r.Yield,L)},AwaitExpression:function(P,L,R){var q=J(P.all?"await*":"await",this.generateExpression(P.argument,r.Await,k));return mr(q,r.Await,L)},UpdateExpression:function(P,L,R){return P.prefix?mr([P.operator,this.generateExpression(P.argument,r.Unary,k)],r.Unary,L):mr([this.generateExpression(P.argument,r.Postfix,k),P.operator],r.Postfix,L)},FunctionExpression:function(P,L,R){var q=[$s(P,!0),"function"];return P.id?(q.push(Zs(P)||W()),q.push(zr(P.id))):q.push(Zs(P)||y),q.push(this.generateFunctionBody(P)),q},ArrayPattern:function(P,L,R){return this.ArrayExpression(P,L,R,!0)},ArrayExpression:function(P,L,R,q){var Y,pe,ve=this;return P.elements.length?(pe=q?!1:P.elements.length>1,Y=["[",pe?p:""],we(function(Ee){var Re,Dt;for(Re=0,Dt=P.elements.length;Re<Dt;++Re)P.elements[Re]?(Y.push(pe?Ee:""),Y.push(ve.generateExpression(P.elements[Re],r.Assignment,k))):(pe&&Y.push(Ee),Re+1===Dt&&Y.push(",")),Re+1<Dt&&Y.push(","+(pe?p:y))}),pe&&!te(Oe(Y).toString())&&Y.push(p),Y.push(pe?a:""),Y.push("]"),Y):"[]"},RestElement:function(P,L,R){return"..."+this.generatePattern(P.argument)},ClassExpression:function(P,L,R){var q,Y;return q=["class"],P.id&&(q=J(q,this.generateExpression(P.id,r.Sequence,k))),P.superClass&&(Y=J("extends",this.generateExpression(P.superClass,r.Unary,k)),q=J(q,Y)),q.push(y),q.push(this.generateStatement(P.body,z)),q},MethodDefinition:function(P,L,R){var q,Y;return P.static?q=["static"+y]:q=[],P.kind==="get"||P.kind==="set"?Y=[J(P.kind,this.generatePropertyKey(P.key,P.computed)),this.generateFunctionBody(P.value)]:Y=[Xs(P),this.generatePropertyKey(P.key,P.computed),this.generateFunctionBody(P.value)],J(q,Y)},Property:function(P,L,R){return P.kind==="get"||P.kind==="set"?[P.kind,W(),this.generatePropertyKey(P.key,P.computed),this.generateFunctionBody(P.value)]:P.shorthand?P.value.type==="AssignmentPattern"?this.AssignmentPattern(P.value,r.Sequence,k):this.generatePropertyKey(P.key,P.computed):P.method?[Xs(P),this.generatePropertyKey(P.key,P.computed),this.generateFunctionBody(P.value)]:[this.generatePropertyKey(P.key,P.computed),":"+y,this.generateExpression(P.value,r.Assignment,k)]},ObjectExpression:function(P,L,R){var q,Y,pe,ve=this;return P.properties.length?(q=P.properties.length>1,we(function(){pe=ve.generateExpression(P.properties[0],r.Sequence,k)}),!q&&!We(Oe(pe).toString())?["{",y,pe,y,"}"]:(we(function(Ee){var Re,Dt;if(Y=["{",p,Ee,pe],q)for(Y.push(","+p),Re=1,Dt=P.properties.length;Re<Dt;++Re)Y.push(Ee),Y.push(ve.generateExpression(P.properties[Re],r.Sequence,k)),Re+1<Dt&&Y.push(","+p)}),te(Oe(Y).toString())||Y.push(p),Y.push(a),Y.push("}"),Y)):"{}"},AssignmentPattern:function(P,L,R){return this.generateAssignment(P.left,P.right,"=",L,R)},ObjectPattern:function(P,L,R){var q,Y,pe,ve,Ee,Re=this;if(!P.properties.length)return"{}";if(ve=!1,P.properties.length===1)Ee=P.properties[0],Ee.type===e.Property&&Ee.value.type!==e.Identifier&&(ve=!0);else for(Y=0,pe=P.properties.length;Y<pe;++Y)if(Ee=P.properties[Y],Ee.type===e.Property&&!Ee.shorthand){ve=!0;break}return q=["{",ve?p:""],we(function(Dt){var re,Q;for(re=0,Q=P.properties.length;re<Q;++re)q.push(ve?Dt:""),q.push(Re.generateExpression(P.properties[re],r.Sequence,k)),re+1<Q&&q.push(","+(ve?p:y))}),ve&&!te(Oe(q).toString())&&q.push(p),q.push(ve?a:""),q.push("}"),q},ThisExpression:function(P,L,R){return"this"},Super:function(P,L,R){return"super"},Identifier:function(P,L,R){return zr(P)},ImportDefaultSpecifier:function(P,L,R){return zr(P.id||P.local)},ImportNamespaceSpecifier:function(P,L,R){var q=["*"],Y=P.id||P.local;return Y&&q.push(y+"as"+W()+zr(Y)),q},ImportSpecifier:function(P,L,R){var q=P.imported,Y=[q.name],pe=P.local;return pe&&pe.name!==q.name&&Y.push(W()+"as"+W()+zr(pe)),Y},ExportSpecifier:function(P,L,R){var q=P.local,Y=[q.name],pe=P.exported;return pe&&pe.name!==q.name&&Y.push(W()+"as"+W()+zr(pe)),Y},Literal:function(P,L,R){var q;if(P.hasOwnProperty("raw")&&_&&m.raw)try{if(q=_(P.raw).body[0].expression,q.type===e.Literal&&q.value===P.value)return P.raw}catch{}return P.regex?"/"+P.regex.pattern+"/"+P.regex.flags:P.value===null?"null":typeof P.value=="string"?be(P.value):typeof P.value=="number"?K(P.value):typeof P.value=="boolean"?P.value?"true":"false":B(P.value)},GeneratorExpression:function(P,L,R){return this.ComprehensionExpression(P,L,R)},ComprehensionExpression:function(P,L,R){var q,Y,pe,ve,Ee=this;return q=P.type===e.GeneratorExpression?["("]:["["],m.moz.comprehensionExpressionStartsWithAssignment&&(ve=this.generateExpression(P.body,r.Assignment,k),q.push(ve)),P.blocks&&we(function(){for(Y=0,pe=P.blocks.length;Y<pe;++Y)ve=Ee.generateExpression(P.blocks[Y],r.Sequence,k),Y>0||m.moz.comprehensionExpressionStartsWithAssignment?q=J(q,ve):q.push(ve)}),P.filter&&(q=J(q,"if"+y),ve=this.generateExpression(P.filter,r.Sequence,k),q=J(q,["(",ve,")"])),m.moz.comprehensionExpressionStartsWithAssignment||(ve=this.generateExpression(P.body,r.Assignment,k),q=J(q,ve)),q.push(P.type===e.GeneratorExpression?")":"]"),q},ComprehensionBlock:function(P,L,R){var q;return P.left.type===e.VariableDeclaration?q=[P.left.kind,W(),this.generateStatement(P.left.declarations[0],ne)]:q=this.generateExpression(P.left,r.Call,k),q=J(q,P.of?"of":"in"),q=J(q,this.generateExpression(P.right,r.Sequence,k)),["for"+y+"(",q,")"]},SpreadElement:function(P,L,R){return["...",this.generateExpression(P.argument,r.Assignment,k)]},TaggedTemplateExpression:function(P,L,R){var q=M;R&j||(q=H);var Y=[this.generateExpression(P.tag,r.Call,q),this.generateExpression(P.quasi,r.Primary,U)];return mr(Y,r.TaggedTemplate,L)},TemplateElement:function(P,L,R){return P.value.raw},TemplateLiteral:function(P,L,R){var q,Y,pe;for(q=["`"],Y=0,pe=P.quasis.length;Y<pe;++Y)q.push(this.generateExpression(P.quasis[Y],r.Primary,k)),Y+1<pe&&(q.push("${"+y),q.push(this.generateExpression(P.expressions[Y],r.Sequence,k)),q.push(y+"}"));return q.push("`"),q},ModuleSpecifier:function(P,L,R){return this.Literal(P,L,R)},ImportExpression:function(P,L,R){return mr(["import(",this.generateExpression(P.source,r.Assignment,k),")"],r.Call,L)}},se(Rt.prototype,Rt.Expression),Rt.prototype.generateExpression=function(P,L,R){var q,Y;return Y=P.type||e.Property,m.verbatim&&P.hasOwnProperty(m.verbatim)?Cc(P,L):(q=this[Y](P,L,R),m.comment&&(q=Gs(P,q)),Oe(q,P))},Rt.prototype.generateStatement=function(P,L){var R,q;return R=this[P.type](P,L),m.comment&&(R=Gs(P,R)),q=Oe(R).toString(),P.type===e.Program&&!g&&p===""&&q.charAt(q.length-1)===`
`&&(R=x?Oe(R).replaceRight(/\s+$/,""):q.replace(/\s+$/,"")),Oe(R,P)};function xs(P){var L;if(L=new Rt,I(P))return L.generateStatement(P,T);if(O(P))return L.generateExpression(P,r.Sequence,k);throw new Error("Unknown node type: "+P.type)}function _i(P,L){var R=_e(),q,Y;return L!=null?(typeof L.indent=="string"&&(R.format.indent.style=L.indent),typeof L.base=="number"&&(R.format.indent.base=L.base),L=ce(R,L),c=L.format.indent.style,typeof L.base=="string"?a=L.base:a=Se(c,L.format.indent.base)):(L=R,c=L.format.indent.style,a=Se(c,L.format.indent.base)),l=L.format.json,u=L.format.renumber,d=l?!1:L.format.hexadecimal,h=l?"double":L.format.quotes,f=L.format.escapeless,p=L.format.newline,y=L.format.space,L.format.compact&&(p=y=c=a=""),b=L.format.parentheses,w=L.format.semicolons,g=L.format.safeConcatenation,v=L.directive,_=l?null:L.parse,x=L.sourceMap,D=L.sourceCode,E=L.format.preserveBlankLines&&D!==null,m=L,x&&(t.browser?s=Zt.sourceMap.SourceNode:s=Yq().SourceNode),q=xs(P),x?(Y=q.toStringWithSourceMap({file:L.file,sourceRoot:L.sourceMapRoot}),L.sourceContent&&Y.map.setSourceContent(L.sourceMap,L.sourceContent),L.sourceMapWithCode?Y:Y.map.toString()):(Y={code:q.toString(),map:null},L.sourceMapWithCode?Y:Y.code)}A={indent:{style:"",base:0},renumber:!0,hexadecimal:!0,quotes:"auto",escapeless:!0,compact:!0,parentheses:!1,semicolons:!1},S=_e().format,t.version=hV.version,t.generate=_i,t.attachComments=i.attachComments,t.Precedence=ce({},r),t.browser=!1,t.FORMAT_MINIFY=A,t.FORMAT_DEFAULTS=S})()})(rO);var yV=rO.generate,mV=function(t,e){e||(e={});var r={},n=function s(i,o){if(i.type==="Literal")return i.value;if(i.type==="UnaryExpression"){var a=s(i.argument);return i.operator==="+"?+a:i.operator==="-"?-a:i.operator==="~"?~a:i.operator==="!"?!a:r}else if(i.type==="ArrayExpression"){for(var c=[],l=0,u=i.elements.length;l<u;l++){var d=s(i.elements[l]);if(d===r)return r;c.push(d)}return c}else if(i.type==="ObjectExpression"){for(var h={},l=0;l<i.properties.length;l++){var f=i.properties[l],p=f.value===null?f.value:s(f.value);if(p===r)return r;h[f.key.value||f.key.name]=p}return h}else if(i.type==="BinaryExpression"||i.type==="LogicalExpression"){var u=s(i.left);if(u===r)return r;var y=s(i.right);if(y===r)return r;var b=i.operator;return b==="=="?u==y:b==="==="?u===y:b==="!="?u!=y:b==="!=="?u!==y:b==="+"?u+y:b==="-"?u-y:b==="*"?u*y:b==="/"?u/y:b==="%"?u%y:b==="<"?u<y:b==="<="?u<=y:b===">"?u>y:b===">="?u>=y:b==="|"?u|y:b==="&"?u&y:b==="^"?u^y:b==="&&"?u&&y:b==="||"?u||y:r}else{if(i.type==="Identifier")return{}.hasOwnProperty.call(e,i.name)?e[i.name]:r;if(i.type==="ThisExpression")return{}.hasOwnProperty.call(e,"this")?e.this:r;if(i.type==="CallExpression"){var w=s(i.callee);if(w===r||typeof w!="function")return r;var g=i.callee.object?s(i.callee.object):r;g===r&&(g=null);for(var v=[],l=0,u=i.arguments.length;l<u;l++){var d=s(i.arguments[l]);if(d===r)return r;v.push(d)}return w.apply(g,v)}else if(i.type==="MemberExpression"){var h=s(i.object);if(h===r||typeof h=="function")return r;if(i.property.type==="Identifier")return h[i.property.name];var f=s(i.property);return f===r?r:h[f]}else if(i.type==="ConditionalExpression"){var a=s(i.test);return a===r?r:s(a?i.consequent:i.alternate)}else if(i.type==="ExpressionStatement"){var a=s(i.expression);return a===r?r:a}else{if(i.type==="ReturnStatement")return s(i.argument);if(i.type==="FunctionExpression"){var m=i.body.body,_={};Object.keys(e).forEach(function(j){_[j]=e[j]});for(var l=0;l<i.params.length;l++){var x=i.params[l];if(x.type=="Identifier")e[x.name]=null;else return r}for(var l in m)if(s(m[l])===r)return r;e=_;var D=Object.keys(e),E=D.map(function(j){return e[j]});return Function(D.join(", "),"return "+yV(i)).apply(null,E)}else if(i.type==="TemplateLiteral"){for(var A="",l=0;l<i.expressions.length;l++)A+=s(i.quasis[l]),A+=s(i.expressions[l]);return A+=s(i.quasis[l]),A}else if(i.type==="TaggedTemplateExpression"){var S=s(i.tag),O=i.quasi,I=O.quasis.map(s),N=O.expressions.map(s);return S.apply(null,[I].concat(N))}else return i.type==="TemplateElement"?i.value.cooked:r}}}(t);return n===r?void 0:n};const gV=Jo(mV);function X$(t){return function(e,r,n,s){var i=e.value,o=e.path,a=[],c=(function(l,u){dO(l)?(l.forEach(function(d,h){a.length>=s||n(h,d,r)&&a.push({path:u.concat(h),value:d})}),l.forEach(function(d,h){a.length>=s||t&&c(d,u.concat(h))})):wV(l)&&(Object.keys(l).forEach(function(d){a.length>=s||n(d,l[d],r)&&a.push({path:u.concat(d),value:l[d]})}),Object.keys(l).forEach(function(d){a.length>=s||t&&c(l[d],u.concat(d))}))}).bind(this);return c(i,o),a}}function Jb(t,e){try{return gV(t,e)}catch{}}function cm(t){return function(e,r,n){return this.descend(r,e.expression.value,t,n)}}function lm(t){return function(e,r,n){return this.traverse(r,e.expression.value,t,n)}}function Y$(t){return t=t.filter(function(e){return e}),_V(t,function(e){return e.path.map(function(r){return String(r).replace("-","--")}).join("-")})}function vV(t){var e=String(t);return e.match(/^-?[0-9]+$/)?parseInt(e):null}function dO(t){return Array.isArray(t)}function wV(t){return t&&!(t instanceof Array)&&t instanceof Object}function hw(t,e,r){var n=Wb(e).body[0].expression,s=Jb(n,{"@":t.value}),i=r.replace(/\{\{\s*value\s*\}\}/g,s),o=zt.nodes(t.value,i);return o.forEach(function(a){a.path=t.path.concat(a.path.slice(1))}),o}var bV=function(){function t(){this._fns={"member-child-identifier":function(e,r){var n=e.expression.value,s=r.value;if(s instanceof Object&&n in s)return[{value:s[n],path:r.path.concat(n)}]},"member-descendant-identifier":lm(function(e,r,n){return e==n}),"subscript-child-numeric_literal":cm(function(e,r,n){return e===n}),"member-child-numeric_literal":cm(function(e,r,n){return String(e)===String(n)}),"subscript-descendant-numeric_literal":lm(function(e,r,n){return e===n}),"member-child-wildcard":cm(function(){return!0}),"member-descendant-wildcard":lm(function(){return!0}),"subscript-descendant-wildcard":lm(function(){return!0}),"subscript-child-wildcard":cm(function(){return!0}),"subscript-child-slice":function(e,r){if(dO(r.value)){var n=e.expression.value.split(":").map(vV),s=r.value.map(function(i,o){return{value:i,path:r.path.concat(o)}});return Oq.apply(null,[s].concat(n))}},"subscript-child-union":function(e,r){var n=[];return e.expression.value.forEach(function(s){var i={operation:"subscript",scope:"child",expression:s.expression},o=this.resolve(i),a=o(i,r);a&&(n=n.concat(a))},this),Y$(n)},"subscript-descendant-union":function(e,r,n){var s=this,i=[],o=zt.nodes(r,"$..*").slice(1);return o.forEach(function(a){i.length>=n||e.expression.value.forEach(function(c){var l={operation:"subscript",scope:"child",expression:c.expression},u=s.resolve(l),d=u(l,a);i=i.concat(d)})}),Y$(i)},"subscript-child-filter_expression":function(e,r,n){var s=e.expression.value.slice(2,-1),i=Wb(s).body[0].expression,o=function(a,c){return Jb(i,{"@":c})};return this.descend(r,null,o,n)},"subscript-descendant-filter_expression":function(e,r,n){var s=e.expression.value.slice(2,-1),i=Wb(s).body[0].expression,o=function(a,c){return Jb(i,{"@":c})};return this.traverse(r,null,o,n)},"subscript-child-script_expression":function(e,r){var n=e.expression.value.slice(1,-1);return hw(r,n,"$[{{value}}]")},"member-child-script_expression":function(e,r){var n=e.expression.value.slice(1,-1);return hw(r,n,"$.{{value}}")},"member-descendant-script_expression":function(e,r){var n=e.expression.value.slice(1,-1);return hw(r,n,"$..value")}},this.initialize()}return t.prototype.initialize=function(){this.traverse=X$(!0),this.descend=X$(),this._fns["subscript-child-string_literal"]=this._fns["member-child-identifier"],this._fns["member-descendant-numeric_literal"]=this._fns["subscript-descendant-string_literal"]=this._fns["member-descendant-identifier"]},t.prototype.resolve=function(e){var r=[e.operation,e.scope,e.expression.type].join("-"),n=this._fns[r];if(!n)throw new Error("couldn't resolve key: "+r);return n.bind(this)},t.prototype.register=function(e,r){if(!(r instanceof Function))throw new Error("handler must be a function");this._fns[e]=r},t}();function _V(t,e){for(var r=[],n=[],s=0,i=t==null?void 0:t.length;s<i;s++){var o=t[s],a=e?e(o,s):o;n.includes(a)||(n.push(a),r.push(o))}return r}var EV={identifier:"[a-zA-Z_]+[a-zA-Z0-9_]*",integer:"-?(?:0|[1-9][0-9]*)",qq_string:'"(?:\\\\["bfnrt/\\\\]|\\\\u[a-fA-F0-9]{4}|[^"\\\\])*"',q_string:"'(?:\\\\['bfnrt/\\\\]|\\\\u[a-fA-F0-9]{4}|[^'\\\\])*'"};function AV(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var fO={};(function(t){var e=function(){var r=function(E,A,S,O){for(S=S||{},O=E.length;O--;S[E[O]]=A);return S},n=[1,5],s=[1,6],i=[1,7],o=[1,8],a=[1,9],c=[1,18],l=[1,19],u=[1,20],d=[1,12,14,22],h=[1,29],f=[1,30],p=[1,33],y=[1,35],b=[1,31],w=[1,36],g=[1,37],v=[24,28],m={trace:function(){},yy:{},symbols_:{error:2,JSON_PATH:3,DOLLAR:4,PATH_COMPONENTS:5,LEADING_CHILD_MEMBER_EXPRESSION:6,PATH_COMPONENT:7,MEMBER_COMPONENT:8,SUBSCRIPT_COMPONENT:9,CHILD_MEMBER_COMPONENT:10,DESCENDANT_MEMBER_COMPONENT:11,DOT:12,MEMBER_EXPRESSION:13,DOT_DOT:14,STAR:15,IDENTIFIER:16,SCRIPT_EXPRESSION:17,INTEGER:18,END:19,CHILD_SUBSCRIPT_COMPONENT:20,DESCENDANT_SUBSCRIPT_COMPONENT:21,"[":22,SUBSCRIPT:23,"]":24,SUBSCRIPT_EXPRESSION:25,SUBSCRIPT_EXPRESSION_LIST:26,SUBSCRIPT_EXPRESSION_LISTABLE:27,",":28,STRING_LITERAL:29,ARRAY_SLICE:30,FILTER_EXPRESSION:31,QQ_STRING:32,Q_STRING:33,$accept:0,$end:1},terminals_:{2:"error",4:"DOLLAR",12:"DOT",14:"DOT_DOT",15:"STAR",16:"IDENTIFIER",17:"SCRIPT_EXPRESSION",18:"INTEGER",19:"END",22:"[",24:"]",28:",",30:"ARRAY_SLICE",31:"FILTER_EXPRESSION",32:"QQ_STRING",33:"Q_STRING"},productions_:[0,[3,1],[3,2],[3,1],[3,2],[5,1],[5,2],[7,1],[7,1],[8,1],[8,1],[10,2],[6,1],[11,2],[13,1],[13,1],[13,1],[13,1],[13,1],[9,1],[9,1],[20,3],[21,4],[23,1],[23,1],[26,1],[26,3],[27,1],[27,1],[27,1],[25,1],[25,1],[25,1],[29,1],[29,1]],performAction:function(A,S,O,I,N,j,F){I.ast||(I.ast=_,_.initialize());var V=j.length-1;switch(N){case 1:return I.ast.set({expression:{type:"root",value:j[V]}}),I.ast.unshift(),I.ast.yield();case 2:return I.ast.set({expression:{type:"root",value:j[V-1]}}),I.ast.unshift(),I.ast.yield();case 3:return I.ast.unshift(),I.ast.yield();case 4:return I.ast.set({operation:"member",scope:"child",expression:{type:"identifier",value:j[V-1]}}),I.ast.unshift(),I.ast.yield();case 5:case 6:case 11:case 13:case 18:case 21:case 22:case 23:break;case 7:I.ast.set({operation:"member"}),I.ast.push();break;case 8:I.ast.set({operation:"subscript"}),I.ast.push();break;case 9:case 19:I.ast.set({scope:"child"});break;case 10:case 20:I.ast.set({scope:"descendant"});break;case 12:I.ast.set({scope:"child",operation:"member"});break;case 14:I.ast.set({expression:{type:"wildcard",value:j[V]}});break;case 15:I.ast.set({expression:{type:"identifier",value:j[V]}});break;case 16:I.ast.set({expression:{type:"script_expression",value:j[V]}});break;case 17:I.ast.set({expression:{type:"numeric_literal",value:parseInt(j[V])}});break;case 24:j[V].length>1?I.ast.set({expression:{type:"union",value:j[V]}}):this.$=j[V];break;case 25:this.$=[j[V]];break;case 26:this.$=j[V-2].concat(j[V]);break;case 27:this.$={expression:{type:"numeric_literal",value:parseInt(j[V])}},I.ast.set(this.$);break;case 28:this.$={expression:{type:"string_literal",value:j[V]}},I.ast.set(this.$);break;case 29:this.$={expression:{type:"slice",value:j[V]}},I.ast.set(this.$);break;case 30:this.$={expression:{type:"wildcard",value:j[V]}},I.ast.set(this.$);break;case 31:this.$={expression:{type:"script_expression",value:j[V]}},I.ast.set(this.$);break;case 32:this.$={expression:{type:"filter_expression",value:j[V]}},I.ast.set(this.$);break;case 33:case 34:this.$=j[V];break}},table:[{3:1,4:[1,2],6:3,13:4,15:n,16:s,17:i,18:o,19:a},{1:[3]},{1:[2,1],5:10,7:11,8:12,9:13,10:14,11:15,12:c,14:l,20:16,21:17,22:u},{1:[2,3],5:21,7:11,8:12,9:13,10:14,11:15,12:c,14:l,20:16,21:17,22:u},r(d,[2,12]),r(d,[2,14]),r(d,[2,15]),r(d,[2,16]),r(d,[2,17]),r(d,[2,18]),{1:[2,2],7:22,8:12,9:13,10:14,11:15,12:c,14:l,20:16,21:17,22:u},r(d,[2,5]),r(d,[2,7]),r(d,[2,8]),r(d,[2,9]),r(d,[2,10]),r(d,[2,19]),r(d,[2,20]),{13:23,15:n,16:s,17:i,18:o,19:a},{13:24,15:n,16:s,17:i,18:o,19:a,22:[1,25]},{15:h,17:f,18:p,23:26,25:27,26:28,27:32,29:34,30:y,31:b,32:w,33:g},{1:[2,4],7:22,8:12,9:13,10:14,11:15,12:c,14:l,20:16,21:17,22:u},r(d,[2,6]),r(d,[2,11]),r(d,[2,13]),{15:h,17:f,18:p,23:38,25:27,26:28,27:32,29:34,30:y,31:b,32:w,33:g},{24:[1,39]},{24:[2,23]},{24:[2,24],28:[1,40]},{24:[2,30]},{24:[2,31]},{24:[2,32]},r(v,[2,25]),r(v,[2,27]),r(v,[2,28]),r(v,[2,29]),r(v,[2,33]),r(v,[2,34]),{24:[1,41]},r(d,[2,21]),{18:p,27:42,29:34,30:y,32:w,33:g},r(d,[2,22]),r(v,[2,26])],defaultActions:{27:[2,23],29:[2,30],30:[2,31],31:[2,32]},parseError:function(A,S){if(S.recoverable)this.trace(A);else{var O=new Error(A);throw O.hash=S,O}},parse:function(A){var S=this,O=[0],I=[null],N=[],j=this.table,F="",V=0,ee=0,G=2,Z=1,M=N.slice.call(arguments,1),k=Object.create(this.lexer),H={yy:{}};for(var U in this.yy)Object.prototype.hasOwnProperty.call(this.yy,U)&&(H.yy[U]=this.yy[U]);k.setInput(A,H.yy),H.yy.lexer=k,H.yy.parser=this,typeof k.yylloc>"u"&&(k.yylloc={});var $=k.yylloc;N.push($);var T=k.options&&k.options.ranges;typeof H.yy.parseError=="function"?this.parseError=H.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var z=function(){var C;return C=k.lex()||Z,typeof C!="number"&&(C=S.symbols_[C]||C),C},ne,ue,ye,_e,Se={},We,te,se,ce;;){if(ue=O[O.length-1],this.defaultActions[ue]?ye=this.defaultActions[ue]:((ne===null||typeof ne>"u")&&(ne=z()),ye=j[ue]&&j[ue][ne]),typeof ye>"u"||!ye.length||!ye[0]){var K="";ce=[];for(We in j[ue])this.terminals_[We]&&We>G&&ce.push("'"+this.terminals_[We]+"'");k.showPosition?K="Parse error on line "+(V+1)+`:
`+k.showPosition()+`
Expecting `+ce.join(", ")+", got '"+(this.terminals_[ne]||ne)+"'":K="Parse error on line "+(V+1)+": Unexpected "+(ne==Z?"end of input":"'"+(this.terminals_[ne]||ne)+"'"),this.parseError(K,{text:k.match,token:this.terminals_[ne]||ne,line:k.yylineno,loc:$,expected:ce})}if(ye[0]instanceof Array&&ye.length>1)throw new Error("Parse Error: multiple actions possible at state: "+ue+", token: "+ne);switch(ye[0]){case 1:O.push(ne),I.push(k.yytext),N.push(k.yylloc),O.push(ye[1]),ne=null,ee=k.yyleng,F=k.yytext,V=k.yylineno,$=k.yylloc;break;case 2:if(te=this.productions_[ye[1]][1],Se.$=I[I.length-te],Se._$={first_line:N[N.length-(te||1)].first_line,last_line:N[N.length-1].last_line,first_column:N[N.length-(te||1)].first_column,last_column:N[N.length-1].last_column},T&&(Se._$.range=[N[N.length-(te||1)].range[0],N[N.length-1].range[1]]),_e=this.performAction.apply(Se,[F,ee,V,H.yy,ye[1],I,N].concat(M)),typeof _e<"u")return _e;te&&(O=O.slice(0,-1*te*2),I=I.slice(0,-1*te),N=N.slice(0,-1*te)),O.push(this.productions_[ye[1]][0]),I.push(Se.$),N.push(Se._$),se=j[O[O.length-2]][O[O.length-1]],O.push(se);break;case 3:return!0}}return!0}},_={initialize:function(){this._nodes=[],this._node={},this._stash=[]},set:function(E){for(var A in E)this._node[A]=E[A];return this._node},node:function(E){return arguments.length&&(this._node=E),this._node},push:function(){this._nodes.push(this._node),this._node={}},unshift:function(){this._nodes.unshift(this._node),this._node={}},yield:function(){var E=this._nodes;return this.initialize(),E}},x=function(){var E={EOF:1,parseError:function(S,O){if(this.yy.parser)this.yy.parser.parseError(S,O);else throw new Error(S)},setInput:function(A,S){return this.yy=S||this.yy||{},this._input=A,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var A=this._input[0];this.yytext+=A,this.yyleng++,this.offset++,this.match+=A,this.matched+=A;var S=A.match(/(?:\r\n?|\n).*/g);return S?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),A},unput:function(A){var S=A.length,O=A.split(/(?:\r\n?|\n)/g);this._input=A+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-S),this.offset-=S;var I=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),O.length-1&&(this.yylineno-=O.length-1);var N=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:O?(O.length===I.length?this.yylloc.first_column:0)+I[I.length-O.length].length-O[0].length:this.yylloc.first_column-S},this.options.ranges&&(this.yylloc.range=[N[0],N[0]+this.yyleng-S]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(A){this.unput(this.match.slice(A))},pastInput:function(){var A=this.matched.substr(0,this.matched.length-this.match.length);return(A.length>20?"...":"")+A.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var A=this.match;return A.length<20&&(A+=this._input.substr(0,20-A.length)),(A.substr(0,20)+(A.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var A=this.pastInput(),S=new Array(A.length+1).join("-");return A+this.upcomingInput()+`
`+S+"^"},test_match:function(A,S){var O,I,N;if(this.options.backtrack_lexer&&(N={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(N.yylloc.range=this.yylloc.range.slice(0))),I=A[0].match(/(?:\r\n?|\n).*/g),I&&(this.yylineno+=I.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:I?I[I.length-1].length-I[I.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+A[0].length},this.yytext+=A[0],this.match+=A[0],this.matches=A,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(A[0].length),this.matched+=A[0],O=this.performAction.call(this,this.yy,this,S,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),O)return O;if(this._backtrack){for(var j in N)this[j]=N[j];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var A,S,O,I;this._more||(this.yytext="",this.match="");for(var N=this._currentRules(),j=0;j<N.length;j++)if(O=this._input.match(this.rules[N[j]]),O&&(!S||O[0].length>S[0].length)){if(S=O,I=j,this.options.backtrack_lexer){if(A=this.test_match(O,N[j]),A!==!1)return A;if(this._backtrack){S=!1;continue}else return!1}else if(!this.options.flex)break}return S?(A=this.test_match(S,N[I]),A!==!1?A:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var S=this.next();return S||this.lex()},begin:function(S){this.conditionStack.push(S)},popState:function(){var S=this.conditionStack.length-1;return S>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(S){return S=this.conditionStack.length-1-Math.abs(S||0),S>=0?this.conditionStack[S]:"INITIAL"},pushState:function(S){this.begin(S)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(S,O,I,N){switch(I){case 0:return 4;case 1:return 14;case 2:return 12;case 3:return 15;case 4:return 16;case 5:return 22;case 6:return 24;case 7:return 28;case 8:return 30;case 9:return 18;case 10:return O.yytext=O.yytext.substr(1,O.yyleng-2),32;case 11:return O.yytext=O.yytext.substr(1,O.yyleng-2),33;case 12:return 17;case 13:return 31}},rules:[/^(?:\$)/,/^(?:\.\.)/,/^(?:\.)/,/^(?:\*)/,/^(?:[a-zA-Z_]+[a-zA-Z0-9_]*)/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?:((-?(?:0|[1-9][0-9]*)))?\:((-?(?:0|[1-9][0-9]*)))?(\:((-?(?:0|[1-9][0-9]*)))?)?)/,/^(?:(-?(?:0|[1-9][0-9]*)))/,/^(?:"(?:\\["bfnrt\/\\]|\\u[a-fA-F0-9]{4}|[^"\\])*")/,/^(?:'(?:\\['bfnrt\/\\]|\\u[a-fA-F0-9]{4}|[^'\\])*')/,/^(?:\(.+?\)(?=\]))/,/^(?:\?\(.+?\)(?=\]))/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return E}();m.lexer=x;function D(){this.yy={}}return D.prototype=m,m.Parser=D,new D}();typeof AV<"u"&&(t.parser=e,t.Parser=e.Parser,t.parse=function(){return e.parse.apply(e,arguments)})})(fO);function dm(){var t=new fO.Parser,e=t.parseError;return t.yy.parseError=function(){t.yy.ast&&t.yy.ast.initialize(),e.apply(t,arguments)},t}var rn=function(){function t(){}return t.ok=function(e,r){if(!e)throw new Error(r)},t.equal=function(e,r,n){if(e!==r)throw new Error(n)},t}(),zt=function(){function t(){}return t.parse=function(e){return rn.ok(typeof e=="string","we need a path"),new dm().parse(e)},t.parent=function(e,r){rn.ok(e instanceof Object,"obj needs to be an object"),rn.ok(r,"we need a path");var n=this.nodes(e,r)[0];return n.path.pop(),this.value(e,n.path)},t.apply=function(e,r,n){rn.ok(e instanceof Object,"obj needs to be an object"),rn.ok(r,"we need a path"),rn.equal(typeof n,"function","fn needs to be function");var s=this.nodes(e,r).sort(function(i,o){return o.path.length-i.path.length});return s.forEach(function(i){var o=i.path.pop(),a=this.value(e,this.stringify(i.path)),c=i.value=n.call(e,a[o]);a[o]=c},this),s},t.value=function(e,r,n){if(rn.ok(e instanceof Object,"obj needs to be an object"),rn.ok(r,"we need a path"),n!==void 0){var s=this.nodes(e,r).shift();if(!s)return this._vivify(e,r,n);var i=s.path.slice(-1).shift(),o=this.parent(e,this.stringify(s.path));o[i]=n}return this.query(e,this.stringify(r),1).shift()},t._vivify=function(e,r,n){var s=this;rn.ok(e instanceof Object,"obj needs to be an object"),rn.ok(r,"we need a path");var i=new dm().parse(r).map(function(a){return a.expression.value}),o=function(a,c){var l=a.pop(),u=s.value(e,a);u||(o(a.concat(),typeof l=="string"?{}:[]),u=s.value(e,a)),u[l]=c};return o(i,n),this.query(e,r)[0]},t.query=function(e,r,n){rn.ok(e instanceof Object,"obj needs to be an object"),rn.ok(typeof r=="string","we need a path");var s=this.nodes(e,r,n).map(function(i){return i.value});return s},t.paths=function(e,r,n){rn.ok(e instanceof Object,"obj needs to be an object"),rn.ok(r,"we need a path");var s=this.nodes(e,r,n).map(function(i){return i.path});return s},t.nodes=function(e,r,n){if(rn.ok(e instanceof Object,"obj needs to be an object"),rn.ok(r,"we need a path"),n===0)return[];var s=new dm().parse(r),i=new bV,o=[{path:["$"],value:e}],a=[];return s.length&&s[0].expression.type=="root"&&s.shift(),s.length?(s.forEach(function(c,l){if(!(a.length>=n)){var u=i.resolve(c),d=[];o.forEach(function(h){if(!(a.length>=n)){var f=u(c,h,n);l==s.length-1?a=a.concat(f||[]):d=d.concat(f||[])}}),o=d}}),n?a.slice(0,n):a):o},t.stringify=function(e){rn.ok(e,"we need a path");var r="$",n={"descendant-member":"..{{value}}","child-member":".{{value}}","descendant-subscript":"..[{{value}}]","child-subscript":"[{{value}}]"};return e=this._normalize(e),e.forEach(function(s){if(s.expression.type!="root"){var i=[s.scope,s.operation].join("-"),o=n[i],a;if(s.expression.type=="string_literal"?a=JSON.stringify(s.expression.value):a=s.expression.value,!o)throw new Error("couldn't find template "+i);r+=o.replace(/{{value}}/,a)}}),r},t._normalize=function(e){if(rn.ok(e,"we need a path"),typeof e=="string")return new dm().parse(e);if(Array.isArray(e)&&typeof e[0]=="string"){var r=[{expression:{type:"root",value:"$"}}];return e.forEach(function(n,s){if(!(n=="$"&&s===0))if(typeof n=="string"&&n.match("^"+EV.identifier+"$"))r.push({operation:"member",scope:"child",expression:{value:n,type:"identifier"}});else{var i=typeof n=="number"?"numeric_literal":"string_literal";r.push({operation:"subscript",scope:"child",expression:{value:n,type:i}})}}),r}else if(Array.isArray(e)&&typeof e[0]=="object")return e;throw new Error("couldn't understand path "+e)},t}();const jd=class jd{static extractInputField(e,r){let n=[];if(r){for(const s of r)if(n=zt.nodes(e,s),n.length)break}return n}static changePropertyNameRecursively(e,r,n){const s=jd.extractInputField(e,["$.."+r]);for(const i of s)this.copyResultPathToDestinationDefinition(i.path,e,n)}static copyResultPathToDestinationDefinition(e,r,n){let s=r;for(let i=1;i<e.length;i++)if(i+1<e.length&&(s=s[e[i]]),e.length==i+1){s[n]=s[e[i]],delete s[e[i]];break}}static changeSpecialPathsRecursively(e){const r=jd.extractInputField(e,["$..path"]);for(const n of r)this.modifyPathsWithSpecialCharacter(n.path,e)}static modifyPathsWithSpecialCharacter(e,r){let n=r;for(let s=1;s<e.length;s++)if(s+1<e.length&&(n=n[e[s]]),e.length==s+1){const i=n[e[s]],o=[];for(let a=0;a<i.length;a++)o.push(this.modifyPathWithSpecialCharacter(i[a]));n[e[s]]=o;break}}static modifyPathWithSpecialCharacter(e){const r=this.matchAll(e,this.REGEX_PATH);return e=this.modifyPathRecursive(r,e),e}static modifyPathRecursive(e,r){let n=e.next(),s=!1;for(;n&&!n.done&&!s;){const i=n.value.index;if(i&&i==1)r=r.charAt(0)+"['"+n.value[0]+"']"+r.substring(i+n.value[0].length),s=!0,this.modifyPathRecursive(e,r);else if(i&&i>1&&r.substring(i-2,i)!=="['"&&r.substring(i-2,i)!=='["')if(r.substring(i-2,i)===".."){r=r.substring(0,i-2)+"..['"+n.value[0]+"']"+r.substring(i+n.value[0].length),s=!0;const o=this.matchAll(r,this.REGEX_PATH);this.modifyPathRecursive(o,r)}else r.charAt(i-1)==="."&&(r=r.substring(0,i-1)+"['"+n.value[0]+"']"+r.substring(i+n.value[0].length),s=!0,this.modifyPathRecursive(e,r));n=e.next()}return r}};de(jd,"matchAll",require("string.prototype.matchall")),de(jd,"REGEX_PATH",/@\w+/g);let gs=jd;class Ci{static asArray(e){return Array.isArray(e)?e:[e]}static isObject(e){return Object.prototype.toString.call(e)==="[object Object]"}static isUrlAbsolute(e){const r=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;Ci.isString(e)&&r.test(e)}static isString(e){return typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"}static getDistinctFieldInObject(e,r){const n=e.map(s=>s[r]);return Array.from(new Set(n))}}class Zu{static optionalNonEmptyString(e){return e==null||e.length>0}static nonEmptyString(e){return e!=null&&e.length>0}static isValidDIDURI(e){const n="^did:([a-z0-9]+)(:([a-zA-Z0-9\\.\\-_]|%[0-9a-fA-F]{2})+)+(/("+"[a-zA-Z-\\._~]|%[0-9a-fA-F]{2}|[!$&'()*+,;=:@]"+")*)?";return new RegExp(n).test(e)}}class SV{constructor(e,r,n,s,i,o){de(this,"input_descriptors");de(this,"format");de(this,"id");de(this,"name");de(this,"purpose");de(this,"submission_requirements");this.id=e,this.input_descriptors=r,this.format=n,this.name=s,this.purpose=i,this.submission_requirements=o}getVersion(){return Vs.v1}}class $V{constructor(e,r,n,s,i,o,a){de(this,"format");de(this,"frame");de(this,"id");de(this,"input_descriptors");de(this,"name");de(this,"purpose");de(this,"submission_requirements");this.format=n,this.frame=s,this.id=e,this.input_descriptors=r,this.name=i,this.purpose=o,this.submission_requirements=a}getVersion(){return Vs.v2}}var Vs;(function(t){t.v1="v1",t.v2="v2"})(Vs||(Vs={}));class Wn{static modelEntityToInternalPresentationDefinitionV1(e){const r=Wn.createCopyAndModifyPresentationDefinition(e);return new SV(r.id,r.input_descriptors,r.format,r.name,r.purpose,r.submission_requirements)}static modelEntityInternalPresentationDefinitionV2(e){const r=Wn.createCopyAndModifyPresentationDefinition(e);return new $V(r.id,r.input_descriptors,r.format,r.frame,r.name,r.purpose,r.submission_requirements)}static createCopyAndModifyPresentationDefinition(e){const r=JSON.parse(JSON.stringify(e));return gs.changePropertyNameRecursively(r,"_const","const"),gs.changePropertyNameRecursively(r,"_enum","enum"),gs.changeSpecialPathsRecursively(r),r}static mapExternalVerifiablePresentationToWrappedVP(e){return sf.CredentialMapper.toWrappedVerifiablePresentation(e)}static mapExternalVerifiableCredentialsToWrappedVcs(e){return sf.CredentialMapper.toWrappedVerifiableCredentials(Array.isArray(e)?e:[e])}static toInternalPresentationDefinition(e){const r=JSON.parse(JSON.stringify(e)),n=Gb(r);if(n.error)throw n.error;return n.version==Vs.v1?Wn.modelEntityToInternalPresentationDefinitionV1(r):Wn.modelEntityInternalPresentationDefinitionV2(r)}}var B_={exports:{}};B_.exports=F_;B_.exports.default=F_;const Hr={$schema:"http://json-schema.org/draft-07/schema#",title:"Presentation Definition",definitions:{schema:{type:"object",properties:{uri:{type:"string"},required:{type:"boolean"}},required:["uri"],additionalProperties:!1},issuance:{type:"object",properties:{manifest:{type:"string"}},additionalProperties:!0},filter:{type:"object",properties:{type:{type:"string"},format:{type:"string"},pattern:{type:"string"},minimum:{type:["number","string"]},minLength:{type:"integer"},maxLength:{type:"integer"},exclusiveMinimum:{type:["number","string"]},exclusiveMaximum:{type:["number","string"]},maximum:{type:["number","string"]},const:{type:["number","string"]},enum:{type:"array",items:{type:["number","string"]}},not:{type:"object",minProperties:1}},required:["type"],additionalProperties:!1},format:{type:"object",patternProperties:{"^jwt$|^jwt_vc$|^jwt_vp$":{type:"object",properties:{alg:{type:"array",minItems:1,items:{type:"string"}}},required:["alg"],additionalProperties:!1},"^ldp_vc$|^ldp_vp$|^ldp$":{type:"object",properties:{proof_type:{type:"array",minItems:1,items:{type:"string"}}},required:["proof_type"],additionalProperties:!1},additionalProperties:!1},additionalProperties:!1},submission_requirements:{type:"object",oneOf:[{properties:{name:{type:"string"},purpose:{type:"string"},rule:{type:"string",enum:["all","pick"]},count:{type:"integer",minimum:1},min:{type:"integer",minimum:0},max:{type:"integer",minimum:0},from:{type:"string"}},required:["rule","from"],additionalProperties:!1},{properties:{name:{type:"string"},purpose:{type:"string"},rule:{type:"string",enum:["all","pick"]},count:{type:"integer",minimum:1},min:{type:"integer",minimum:0},max:{type:"integer",minimum:0},from_nested:{type:"array",minItems:1,items:{$ref:"#/definitions/submission_requirements"}}},required:["rule","from_nested"],additionalProperties:!1}]},input_descriptors:{type:"object",properties:{id:{type:"string"},name:{type:"string"},purpose:{type:"string"},group:{type:"array",items:{type:"string"}},schema:{type:"array",items:{$ref:"#/definitions/schema"}},issuance:{type:"array",items:{$ref:"#/definitions/issuance"}},constraints:{type:"object",properties:{limit_disclosure:{type:"string",enum:["required","preferred"]},statuses:{type:"object",properties:{active:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}},suspended:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}},revoked:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}}}},fields:{type:"array",items:{$ref:"#/definitions/field"}},subject_is_issuer:{type:"string",enum:["required","preferred"]},is_holder:{type:"array",items:{type:"object",properties:{field_id:{type:"array",items:{type:"string"}},directive:{type:"string",enum:["required","preferred"]}},required:["field_id","directive"],additionalProperties:!1}},same_subject:{type:"array",items:{type:"object",properties:{field_id:{type:"array",items:{type:"string"}},directive:{type:"string",enum:["required","preferred"]}},required:["field_id","directive"],additionalProperties:!1}}},additionalProperties:!1}},required:["id","schema"],additionalProperties:!1},field:{type:"object",oneOf:[{properties:{id:{type:"string"},path:{type:"array",items:{type:"string"}},purpose:{type:"string"},filter:{$ref:"#/definitions/filter"}},required:["path"],additionalProperties:!1},{properties:{id:{type:"string"},path:{type:"array",items:{type:"string"}},purpose:{type:"string"},filter:{$ref:"#/definitions/filter"},predicate:{type:"string",enum:["required","preferred"]}},required:["path","filter","predicate"],additionalProperties:!1}]}},type:"object",properties:{presentation_definition:{type:"object",properties:{id:{type:"string"},name:{type:"string"},purpose:{type:"string"},format:{$ref:"#/definitions/format"},submission_requirements:{type:"array",items:{$ref:"#/definitions/submission_requirements"}},input_descriptors:{type:"array",items:{$ref:"#/definitions/input_descriptors"}}},required:["id","input_descriptors"],additionalProperties:!1}}},wr={type:"object",patternProperties:{"^jwt$|^jwt_vc$|^jwt_vp$":{type:"object",properties:{alg:{type:"array",minItems:1,items:{type:"string"}}},required:["alg"],additionalProperties:!1},"^ldp_vc$|^ldp_vp$|^ldp$":{type:"object",properties:{proof_type:{type:"array",minItems:1,items:{type:"string"}}},required:["proof_type"],additionalProperties:!1},additionalProperties:!1},additionalProperties:!1},Q$=new RegExp("^jwt$|^jwt_vc$|^jwt_vp$","u"),ex=new RegExp("^ldp_vc$|^ldp_vp$|^ldp$","u"),tx=new RegExp("additionalProperties","u");function e0(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){for(const a in t)if(!(Q$.test(a)||ex.test(a)||tx.test(a))){const c={instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:a},message:"must NOT have additional properties",schema:!1,parentSchema:wr,data:t};i===null?i=[c]:i.push(c),o++}for(const a in t)if(Q$.test(a)){let c=t[a];if(c&&typeof c=="object"&&!Array.isArray(c)){if(c.alg===void 0){const l={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24/required",keyword:"required",params:{missingProperty:"alg"},message:"must have required property 'alg'",schema:wr.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$"].required,parentSchema:wr.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$"],data:c};i===null?i=[l]:i.push(l),o++}for(const l in c)if(l!=="alg"){const u={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:l},message:"must NOT have additional properties",schema:!1,parentSchema:wr.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$"],data:c};i===null?i=[u]:i.push(u),o++}if(c.alg!==void 0){let l=c.alg;if(Array.isArray(l)){if(l.length<1){const d={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/alg",schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24/properties/alg/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items",schema:1,parentSchema:wr.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$"].properties.alg,data:l};i===null?i=[d]:i.push(d),o++}const u=l.length;for(let d=0;d<u;d++){let h=l[d];if(typeof h!="string"){const f={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/alg/"+d,schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24/properties/alg/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:wr.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$"].properties.alg.items.type,parentSchema:wr.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$"].properties.alg.items,data:h};i===null?i=[f]:i.push(f),o++}}}else{const u={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/alg",schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24/properties/alg/type",keyword:"type",params:{type:"array"},message:"must be array",schema:wr.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$"].properties.alg.type,parentSchema:wr.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$"].properties.alg,data:l};i===null?i=[u]:i.push(u),o++}}}else{const l={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24/type",keyword:"type",params:{type:"object"},message:"must be object",schema:wr.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$"].type,parentSchema:wr.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$"],data:c};i===null?i=[l]:i.push(l),o++}}for(const a in t)if(ex.test(a)){let c=t[a];if(c&&typeof c=="object"&&!Array.isArray(c)){if(c.proof_type===void 0){const l={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/required",keyword:"required",params:{missingProperty:"proof_type"},message:"must have required property 'proof_type'",schema:wr.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].required,parentSchema:wr.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"],data:c};i===null?i=[l]:i.push(l),o++}for(const l in c)if(l!=="proof_type"){const u={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:l},message:"must NOT have additional properties",schema:!1,parentSchema:wr.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"],data:c};i===null?i=[u]:i.push(u),o++}if(c.proof_type!==void 0){let l=c.proof_type;if(Array.isArray(l)){if(l.length<1){const d={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/proof_type",schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/properties/proof_type/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items",schema:1,parentSchema:wr.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].properties.proof_type,data:l};i===null?i=[d]:i.push(d),o++}const u=l.length;for(let d=0;d<u;d++){let h=l[d];if(typeof h!="string"){const f={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/proof_type/"+d,schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/properties/proof_type/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:wr.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].properties.proof_type.items.type,parentSchema:wr.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].properties.proof_type.items,data:h};i===null?i=[f]:i.push(f),o++}}}else{const u={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/proof_type",schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/properties/proof_type/type",keyword:"type",params:{type:"array"},message:"must be array",schema:wr.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].properties.proof_type.type,parentSchema:wr.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].properties.proof_type,data:l};i===null?i=[u]:i.push(u),o++}}}else{const l={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/type",keyword:"type",params:{type:"object"},message:"must be object",schema:wr.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].type,parentSchema:wr.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"],data:c};i===null?i=[l]:i.push(l),o++}}for(const a in t)if(tx.test(a)){const c={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/additionalProperties/false schema",keyword:"false schema",params:{},message:"boolean schema is false",schema:!1,parentSchema:wr.patternProperties.additionalProperties,data:t[a]};i===null?i=[c]:i.push(c),o++}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:wr.type,parentSchema:wr,data:t};i===null?i=[a]:i.push(a),o++}return e0.errors=i,o===0}const Ye={type:"object",oneOf:[{properties:{name:{type:"string"},purpose:{type:"string"},rule:{type:"string",enum:["all","pick"]},count:{type:"integer",minimum:1},min:{type:"integer",minimum:0},max:{type:"integer",minimum:0},from:{type:"string"}},required:["rule","from"],additionalProperties:!1},{properties:{name:{type:"string"},purpose:{type:"string"},rule:{type:"string",enum:["all","pick"]},count:{type:"integer",minimum:1},min:{type:"integer",minimum:0},max:{type:"integer",minimum:0},from_nested:{type:"array",minItems:1,items:{$ref:"#/definitions/submission_requirements"}}},required:["rule","from_nested"],additionalProperties:!1}]},yw={validate:Yp};function Yp(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(!(t&&typeof t=="object"&&!Array.isArray(t))){const f={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Ye.type,parentSchema:Ye,data:t};i===null?i=[f]:i.push(f),o++}const a=o;let c=!1,l=null;const u=o;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.rule===void 0){const f={instancePath:e,schemaPath:"#/oneOf/0/required",keyword:"required",params:{missingProperty:"rule"},message:"must have required property 'rule'",schema:Ye.oneOf[0].required,parentSchema:Ye.oneOf[0],data:t};i===null?i=[f]:i.push(f),o++}if(t.from===void 0){const f={instancePath:e,schemaPath:"#/oneOf/0/required",keyword:"required",params:{missingProperty:"from"},message:"must have required property 'from'",schema:Ye.oneOf[0].required,parentSchema:Ye.oneOf[0],data:t};i===null?i=[f]:i.push(f),o++}for(const f in t)if(!(f==="name"||f==="purpose"||f==="rule"||f==="count"||f==="min"||f==="max"||f==="from")){const p={instancePath:e,schemaPath:"#/oneOf/0/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:f},message:"must NOT have additional properties",schema:!1,parentSchema:Ye.oneOf[0],data:t};i===null?i=[p]:i.push(p),o++}if(t.name!==void 0){let f=t.name;if(typeof f!="string"){const p={instancePath:e+"/name",schemaPath:"#/oneOf/0/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ye.oneOf[0].properties.name.type,parentSchema:Ye.oneOf[0].properties.name,data:f};i===null?i=[p]:i.push(p),o++}}if(t.purpose!==void 0){let f=t.purpose;if(typeof f!="string"){const p={instancePath:e+"/purpose",schemaPath:"#/oneOf/0/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ye.oneOf[0].properties.purpose.type,parentSchema:Ye.oneOf[0].properties.purpose,data:f};i===null?i=[p]:i.push(p),o++}}if(t.rule!==void 0){let f=t.rule;if(typeof f!="string"){const p={instancePath:e+"/rule",schemaPath:"#/oneOf/0/properties/rule/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ye.oneOf[0].properties.rule.type,parentSchema:Ye.oneOf[0].properties.rule,data:f};i===null?i=[p]:i.push(p),o++}if(!(f==="all"||f==="pick")){const p={instancePath:e+"/rule",schemaPath:"#/oneOf/0/properties/rule/enum",keyword:"enum",params:{allowedValues:Ye.oneOf[0].properties.rule.enum},message:"must be equal to one of the allowed values",schema:Ye.oneOf[0].properties.rule.enum,parentSchema:Ye.oneOf[0].properties.rule,data:f};i===null?i=[p]:i.push(p),o++}}if(t.count!==void 0){let f=t.count;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/count",schemaPath:"#/oneOf/0/properties/count/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:Ye.oneOf[0].properties.count.type,parentSchema:Ye.oneOf[0].properties.count,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<1||isNaN(f))){const p={instancePath:e+"/count",schemaPath:"#/oneOf/0/properties/count/minimum",keyword:"minimum",params:{comparison:">=",limit:1},message:"must be >= 1",schema:1,parentSchema:Ye.oneOf[0].properties.count,data:f};i===null?i=[p]:i.push(p),o++}}if(t.min!==void 0){let f=t.min;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/min",schemaPath:"#/oneOf/0/properties/min/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:Ye.oneOf[0].properties.min.type,parentSchema:Ye.oneOf[0].properties.min,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<0||isNaN(f))){const p={instancePath:e+"/min",schemaPath:"#/oneOf/0/properties/min/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0",schema:0,parentSchema:Ye.oneOf[0].properties.min,data:f};i===null?i=[p]:i.push(p),o++}}if(t.max!==void 0){let f=t.max;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/max",schemaPath:"#/oneOf/0/properties/max/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:Ye.oneOf[0].properties.max.type,parentSchema:Ye.oneOf[0].properties.max,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<0||isNaN(f))){const p={instancePath:e+"/max",schemaPath:"#/oneOf/0/properties/max/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0",schema:0,parentSchema:Ye.oneOf[0].properties.max,data:f};i===null?i=[p]:i.push(p),o++}}if(t.from!==void 0){let f=t.from;if(typeof f!="string"){const p={instancePath:e+"/from",schemaPath:"#/oneOf/0/properties/from/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ye.oneOf[0].properties.from.type,parentSchema:Ye.oneOf[0].properties.from,data:f};i===null?i=[p]:i.push(p),o++}}}var h=u===o;h&&(c=!0,l=0);const d=o;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.rule===void 0){const f={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:"rule"},message:"must have required property 'rule'",schema:Ye.oneOf[1].required,parentSchema:Ye.oneOf[1],data:t};i===null?i=[f]:i.push(f),o++}if(t.from_nested===void 0){const f={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:"from_nested"},message:"must have required property 'from_nested'",schema:Ye.oneOf[1].required,parentSchema:Ye.oneOf[1],data:t};i===null?i=[f]:i.push(f),o++}for(const f in t)if(!(f==="name"||f==="purpose"||f==="rule"||f==="count"||f==="min"||f==="max"||f==="from_nested")){const p={instancePath:e,schemaPath:"#/oneOf/1/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:f},message:"must NOT have additional properties",schema:!1,parentSchema:Ye.oneOf[1],data:t};i===null?i=[p]:i.push(p),o++}if(t.name!==void 0){let f=t.name;if(typeof f!="string"){const p={instancePath:e+"/name",schemaPath:"#/oneOf/1/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ye.oneOf[1].properties.name.type,parentSchema:Ye.oneOf[1].properties.name,data:f};i===null?i=[p]:i.push(p),o++}}if(t.purpose!==void 0){let f=t.purpose;if(typeof f!="string"){const p={instancePath:e+"/purpose",schemaPath:"#/oneOf/1/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ye.oneOf[1].properties.purpose.type,parentSchema:Ye.oneOf[1].properties.purpose,data:f};i===null?i=[p]:i.push(p),o++}}if(t.rule!==void 0){let f=t.rule;if(typeof f!="string"){const p={instancePath:e+"/rule",schemaPath:"#/oneOf/1/properties/rule/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ye.oneOf[1].properties.rule.type,parentSchema:Ye.oneOf[1].properties.rule,data:f};i===null?i=[p]:i.push(p),o++}if(!(f==="all"||f==="pick")){const p={instancePath:e+"/rule",schemaPath:"#/oneOf/1/properties/rule/enum",keyword:"enum",params:{allowedValues:Ye.oneOf[1].properties.rule.enum},message:"must be equal to one of the allowed values",schema:Ye.oneOf[1].properties.rule.enum,parentSchema:Ye.oneOf[1].properties.rule,data:f};i===null?i=[p]:i.push(p),o++}}if(t.count!==void 0){let f=t.count;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/count",schemaPath:"#/oneOf/1/properties/count/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:Ye.oneOf[1].properties.count.type,parentSchema:Ye.oneOf[1].properties.count,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<1||isNaN(f))){const p={instancePath:e+"/count",schemaPath:"#/oneOf/1/properties/count/minimum",keyword:"minimum",params:{comparison:">=",limit:1},message:"must be >= 1",schema:1,parentSchema:Ye.oneOf[1].properties.count,data:f};i===null?i=[p]:i.push(p),o++}}if(t.min!==void 0){let f=t.min;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/min",schemaPath:"#/oneOf/1/properties/min/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:Ye.oneOf[1].properties.min.type,parentSchema:Ye.oneOf[1].properties.min,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<0||isNaN(f))){const p={instancePath:e+"/min",schemaPath:"#/oneOf/1/properties/min/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0",schema:0,parentSchema:Ye.oneOf[1].properties.min,data:f};i===null?i=[p]:i.push(p),o++}}if(t.max!==void 0){let f=t.max;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/max",schemaPath:"#/oneOf/1/properties/max/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:Ye.oneOf[1].properties.max.type,parentSchema:Ye.oneOf[1].properties.max,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<0||isNaN(f))){const p={instancePath:e+"/max",schemaPath:"#/oneOf/1/properties/max/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0",schema:0,parentSchema:Ye.oneOf[1].properties.max,data:f};i===null?i=[p]:i.push(p),o++}}if(t.from_nested!==void 0){let f=t.from_nested;if(Array.isArray(f)){if(f.length<1){const y={instancePath:e+"/from_nested",schemaPath:"#/oneOf/1/properties/from_nested/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items",schema:1,parentSchema:Ye.oneOf[1].properties.from_nested,data:f};i===null?i=[y]:i.push(y),o++}const p=f.length;for(let y=0;y<p;y++)yw.validate(f[y],{instancePath:e+"/from_nested/"+y,parentData:f,parentDataProperty:y,rootData:s})||(i=i===null?yw.validate.errors:i.concat(yw.validate.errors),o=i.length)}else{const p={instancePath:e+"/from_nested",schemaPath:"#/oneOf/1/properties/from_nested/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Ye.oneOf[1].properties.from_nested.type,parentSchema:Ye.oneOf[1].properties.from_nested,data:f};i===null?i=[p]:i.push(p),o++}}}var h=d===o;if(h&&c?(c=!1,l=[l,1]):h&&(c=!0,l=1),c)o=a,i!==null&&(a?i.length=a:i=null);else{const f={instancePath:e,schemaPath:"#/oneOf",keyword:"oneOf",params:{passingSchemas:l},message:"must match exactly one schema in oneOf",schema:Ye.oneOf,parentSchema:Ye,data:t};i===null?i=[f]:i.push(f),o++}return Yp.errors=i,o===0}const Ae={type:"object",properties:{id:{type:"string"},name:{type:"string"},purpose:{type:"string"},group:{type:"array",items:{type:"string"}},schema:{type:"array",items:{$ref:"#/definitions/schema"}},issuance:{type:"array",items:{$ref:"#/definitions/issuance"}},constraints:{type:"object",properties:{limit_disclosure:{type:"string",enum:["required","preferred"]},statuses:{type:"object",properties:{active:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}},suspended:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}},revoked:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}}}},fields:{type:"array",items:{$ref:"#/definitions/field"}},subject_is_issuer:{type:"string",enum:["required","preferred"]},is_holder:{type:"array",items:{type:"object",properties:{field_id:{type:"array",items:{type:"string"}},directive:{type:"string",enum:["required","preferred"]}},required:["field_id","directive"],additionalProperties:!1}},same_subject:{type:"array",items:{type:"object",properties:{field_id:{type:"array",items:{type:"string"}},directive:{type:"string",enum:["required","preferred"]}},required:["field_id","directive"],additionalProperties:!1}}},additionalProperties:!1}},required:["id","schema"],additionalProperties:!1},va={type:"object",properties:{uri:{type:"string"},required:{type:"boolean"}},required:["uri"],additionalProperties:!1};function t0(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.uri===void 0){const a={instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:"uri"},message:"must have required property 'uri'",schema:va.required,parentSchema:va,data:t};i===null?i=[a]:i.push(a),o++}for(const a in t)if(!(a==="uri"||a==="required")){const c={instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:a},message:"must NOT have additional properties",schema:!1,parentSchema:va,data:t};i===null?i=[c]:i.push(c),o++}if(t.uri!==void 0){let a=t.uri;if(typeof a!="string"){const c={instancePath:e+"/uri",schemaPath:"#/properties/uri/type",keyword:"type",params:{type:"string"},message:"must be string",schema:va.properties.uri.type,parentSchema:va.properties.uri,data:a};i===null?i=[c]:i.push(c),o++}}if(t.required!==void 0){let a=t.required;if(typeof a!="boolean"){const c={instancePath:e+"/required",schemaPath:"#/properties/required/type",keyword:"type",params:{type:"boolean"},message:"must be boolean",schema:va.properties.required.type,parentSchema:va.properties.required,data:a};i===null?i=[c]:i.push(c),o++}}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:va.type,parentSchema:va,data:t};i===null?i=[a]:i.push(a),o++}return t0.errors=i,o===0}const fm={type:"object",properties:{manifest:{type:"string"}},additionalProperties:!0};function r0(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.manifest!==void 0){let a=t.manifest;if(typeof a!="string"){const c={instancePath:e+"/manifest",schemaPath:"#/properties/manifest/type",keyword:"type",params:{type:"string"},message:"must be string",schema:fm.properties.manifest.type,parentSchema:fm.properties.manifest,data:a};i===null?i=[c]:i.push(c),o++}}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:fm.type,parentSchema:fm,data:t};i===null?i=[a]:i.push(a),o++}return r0.errors=i,o===0}const Ft={type:"object",oneOf:[{properties:{id:{type:"string"},path:{type:"array",items:{type:"string"}},purpose:{type:"string"},filter:{$ref:"#/definitions/filter"}},required:["path"],additionalProperties:!1},{properties:{id:{type:"string"},path:{type:"array",items:{type:"string"}},purpose:{type:"string"},filter:{$ref:"#/definitions/filter"},predicate:{type:"string",enum:["required","preferred"]}},required:["path","filter","predicate"],additionalProperties:!1}]},$t={type:"object",properties:{type:{type:"string"},format:{type:"string"},pattern:{type:"string"},minimum:{type:["number","string"]},minLength:{type:"integer"},maxLength:{type:"integer"},exclusiveMinimum:{type:["number","string"]},exclusiveMaximum:{type:["number","string"]},maximum:{type:["number","string"]},const:{type:["number","string"]},enum:{type:"array",items:{type:["number","string"]}},not:{type:"object",minProperties:1}},required:["type"],additionalProperties:!1},xV=Object.prototype.hasOwnProperty;function al(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.type===void 0){const a={instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:"type"},message:"must have required property 'type'",schema:$t.required,parentSchema:$t,data:t};i===null?i=[a]:i.push(a),o++}for(const a in t)if(!xV.call($t.properties,a)){const c={instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:a},message:"must NOT have additional properties",schema:!1,parentSchema:$t,data:t};i===null?i=[c]:i.push(c),o++}if(t.type!==void 0){let a=t.type;if(typeof a!="string"){const c={instancePath:e+"/type",schemaPath:"#/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string",schema:$t.properties.type.type,parentSchema:$t.properties.type,data:a};i===null?i=[c]:i.push(c),o++}}if(t.format!==void 0){let a=t.format;if(typeof a!="string"){const c={instancePath:e+"/format",schemaPath:"#/properties/format/type",keyword:"type",params:{type:"string"},message:"must be string",schema:$t.properties.format.type,parentSchema:$t.properties.format,data:a};i===null?i=[c]:i.push(c),o++}}if(t.pattern!==void 0){let a=t.pattern;if(typeof a!="string"){const c={instancePath:e+"/pattern",schemaPath:"#/properties/pattern/type",keyword:"type",params:{type:"string"},message:"must be string",schema:$t.properties.pattern.type,parentSchema:$t.properties.pattern,data:a};i===null?i=[c]:i.push(c),o++}}if(t.minimum!==void 0){let a=t.minimum;if(typeof a!="number"&&typeof a!="string"){const c={instancePath:e+"/minimum",schemaPath:"#/properties/minimum/type",keyword:"type",params:{type:$t.properties.minimum.type},message:"must be number,string",schema:$t.properties.minimum.type,parentSchema:$t.properties.minimum,data:a};i===null?i=[c]:i.push(c),o++}}if(t.minLength!==void 0){let a=t.minLength;if(!(typeof a=="number"&&!(a%1)&&!isNaN(a))){const c={instancePath:e+"/minLength",schemaPath:"#/properties/minLength/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:$t.properties.minLength.type,parentSchema:$t.properties.minLength,data:a};i===null?i=[c]:i.push(c),o++}}if(t.maxLength!==void 0){let a=t.maxLength;if(!(typeof a=="number"&&!(a%1)&&!isNaN(a))){const c={instancePath:e+"/maxLength",schemaPath:"#/properties/maxLength/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:$t.properties.maxLength.type,parentSchema:$t.properties.maxLength,data:a};i===null?i=[c]:i.push(c),o++}}if(t.exclusiveMinimum!==void 0){let a=t.exclusiveMinimum;if(typeof a!="number"&&typeof a!="string"){const c={instancePath:e+"/exclusiveMinimum",schemaPath:"#/properties/exclusiveMinimum/type",keyword:"type",params:{type:$t.properties.exclusiveMinimum.type},message:"must be number,string",schema:$t.properties.exclusiveMinimum.type,parentSchema:$t.properties.exclusiveMinimum,data:a};i===null?i=[c]:i.push(c),o++}}if(t.exclusiveMaximum!==void 0){let a=t.exclusiveMaximum;if(typeof a!="number"&&typeof a!="string"){const c={instancePath:e+"/exclusiveMaximum",schemaPath:"#/properties/exclusiveMaximum/type",keyword:"type",params:{type:$t.properties.exclusiveMaximum.type},message:"must be number,string",schema:$t.properties.exclusiveMaximum.type,parentSchema:$t.properties.exclusiveMaximum,data:a};i===null?i=[c]:i.push(c),o++}}if(t.maximum!==void 0){let a=t.maximum;if(typeof a!="number"&&typeof a!="string"){const c={instancePath:e+"/maximum",schemaPath:"#/properties/maximum/type",keyword:"type",params:{type:$t.properties.maximum.type},message:"must be number,string",schema:$t.properties.maximum.type,parentSchema:$t.properties.maximum,data:a};i===null?i=[c]:i.push(c),o++}}if(t.const!==void 0){let a=t.const;if(typeof a!="number"&&typeof a!="string"){const c={instancePath:e+"/const",schemaPath:"#/properties/const/type",keyword:"type",params:{type:$t.properties.const.type},message:"must be number,string",schema:$t.properties.const.type,parentSchema:$t.properties.const,data:a};i===null?i=[c]:i.push(c),o++}}if(t.enum!==void 0){let a=t.enum;if(Array.isArray(a)){const c=a.length;for(let l=0;l<c;l++){let u=a[l];if(typeof u!="number"&&typeof u!="string"){const d={instancePath:e+"/enum/"+l,schemaPath:"#/properties/enum/items/type",keyword:"type",params:{type:$t.properties.enum.items.type},message:"must be number,string",schema:$t.properties.enum.items.type,parentSchema:$t.properties.enum.items,data:u};i===null?i=[d]:i.push(d),o++}}}else{const c={instancePath:e+"/enum",schemaPath:"#/properties/enum/type",keyword:"type",params:{type:"array"},message:"must be array",schema:$t.properties.enum.type,parentSchema:$t.properties.enum,data:a};i===null?i=[c]:i.push(c),o++}}if(t.not!==void 0){let a=t.not;if(a&&typeof a=="object"&&!Array.isArray(a)){if(Object.keys(a).length<1){const c={instancePath:e+"/not",schemaPath:"#/properties/not/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties",schema:1,parentSchema:$t.properties.not,data:a};i===null?i=[c]:i.push(c),o++}}else{const c={instancePath:e+"/not",schemaPath:"#/properties/not/type",keyword:"type",params:{type:"object"},message:"must be object",schema:$t.properties.not.type,parentSchema:$t.properties.not,data:a};i===null?i=[c]:i.push(c),o++}}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:$t.type,parentSchema:$t,data:t};i===null?i=[a]:i.push(a),o++}return al.errors=i,o===0}function n0(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(!(t&&typeof t=="object"&&!Array.isArray(t))){const f={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Ft.type,parentSchema:Ft,data:t};i===null?i=[f]:i.push(f),o++}const a=o;let c=!1,l=null;const u=o;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.path===void 0){const f={instancePath:e,schemaPath:"#/oneOf/0/required",keyword:"required",params:{missingProperty:"path"},message:"must have required property 'path'",schema:Ft.oneOf[0].required,parentSchema:Ft.oneOf[0],data:t};i===null?i=[f]:i.push(f),o++}for(const f in t)if(!(f==="id"||f==="path"||f==="purpose"||f==="filter")){const p={instancePath:e,schemaPath:"#/oneOf/0/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:f},message:"must NOT have additional properties",schema:!1,parentSchema:Ft.oneOf[0],data:t};i===null?i=[p]:i.push(p),o++}if(t.id!==void 0){let f=t.id;if(typeof f!="string"){const p={instancePath:e+"/id",schemaPath:"#/oneOf/0/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ft.oneOf[0].properties.id.type,parentSchema:Ft.oneOf[0].properties.id,data:f};i===null?i=[p]:i.push(p),o++}}if(t.path!==void 0){let f=t.path;if(Array.isArray(f)){const p=f.length;for(let y=0;y<p;y++){let b=f[y];if(typeof b!="string"){const w={instancePath:e+"/path/"+y,schemaPath:"#/oneOf/0/properties/path/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ft.oneOf[0].properties.path.items.type,parentSchema:Ft.oneOf[0].properties.path.items,data:b};i===null?i=[w]:i.push(w),o++}}}else{const p={instancePath:e+"/path",schemaPath:"#/oneOf/0/properties/path/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Ft.oneOf[0].properties.path.type,parentSchema:Ft.oneOf[0].properties.path,data:f};i===null?i=[p]:i.push(p),o++}}if(t.purpose!==void 0){let f=t.purpose;if(typeof f!="string"){const p={instancePath:e+"/purpose",schemaPath:"#/oneOf/0/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ft.oneOf[0].properties.purpose.type,parentSchema:Ft.oneOf[0].properties.purpose,data:f};i===null?i=[p]:i.push(p),o++}}t.filter!==void 0&&(al(t.filter,{instancePath:e+"/filter",parentData:t,parentDataProperty:"filter",rootData:s})||(i=i===null?al.errors:i.concat(al.errors),o=i.length))}var h=u===o;h&&(c=!0,l=0);const d=o;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.path===void 0){const f={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:"path"},message:"must have required property 'path'",schema:Ft.oneOf[1].required,parentSchema:Ft.oneOf[1],data:t};i===null?i=[f]:i.push(f),o++}if(t.filter===void 0){const f={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:"filter"},message:"must have required property 'filter'",schema:Ft.oneOf[1].required,parentSchema:Ft.oneOf[1],data:t};i===null?i=[f]:i.push(f),o++}if(t.predicate===void 0){const f={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:"predicate"},message:"must have required property 'predicate'",schema:Ft.oneOf[1].required,parentSchema:Ft.oneOf[1],data:t};i===null?i=[f]:i.push(f),o++}for(const f in t)if(!(f==="id"||f==="path"||f==="purpose"||f==="filter"||f==="predicate")){const p={instancePath:e,schemaPath:"#/oneOf/1/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:f},message:"must NOT have additional properties",schema:!1,parentSchema:Ft.oneOf[1],data:t};i===null?i=[p]:i.push(p),o++}if(t.id!==void 0){let f=t.id;if(typeof f!="string"){const p={instancePath:e+"/id",schemaPath:"#/oneOf/1/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ft.oneOf[1].properties.id.type,parentSchema:Ft.oneOf[1].properties.id,data:f};i===null?i=[p]:i.push(p),o++}}if(t.path!==void 0){let f=t.path;if(Array.isArray(f)){const p=f.length;for(let y=0;y<p;y++){let b=f[y];if(typeof b!="string"){const w={instancePath:e+"/path/"+y,schemaPath:"#/oneOf/1/properties/path/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ft.oneOf[1].properties.path.items.type,parentSchema:Ft.oneOf[1].properties.path.items,data:b};i===null?i=[w]:i.push(w),o++}}}else{const p={instancePath:e+"/path",schemaPath:"#/oneOf/1/properties/path/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Ft.oneOf[1].properties.path.type,parentSchema:Ft.oneOf[1].properties.path,data:f};i===null?i=[p]:i.push(p),o++}}if(t.purpose!==void 0){let f=t.purpose;if(typeof f!="string"){const p={instancePath:e+"/purpose",schemaPath:"#/oneOf/1/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ft.oneOf[1].properties.purpose.type,parentSchema:Ft.oneOf[1].properties.purpose,data:f};i===null?i=[p]:i.push(p),o++}}if(t.filter!==void 0&&(al(t.filter,{instancePath:e+"/filter",parentData:t,parentDataProperty:"filter",rootData:s})||(i=i===null?al.errors:i.concat(al.errors),o=i.length)),t.predicate!==void 0){let f=t.predicate;if(typeof f!="string"){const p={instancePath:e+"/predicate",schemaPath:"#/oneOf/1/properties/predicate/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ft.oneOf[1].properties.predicate.type,parentSchema:Ft.oneOf[1].properties.predicate,data:f};i===null?i=[p]:i.push(p),o++}if(!(f==="required"||f==="preferred")){const p={instancePath:e+"/predicate",schemaPath:"#/oneOf/1/properties/predicate/enum",keyword:"enum",params:{allowedValues:Ft.oneOf[1].properties.predicate.enum},message:"must be equal to one of the allowed values",schema:Ft.oneOf[1].properties.predicate.enum,parentSchema:Ft.oneOf[1].properties.predicate,data:f};i===null?i=[p]:i.push(p),o++}}}var h=d===o;if(h&&c?(c=!1,l=[l,1]):h&&(c=!0,l=1),c)o=a,i!==null&&(a?i.length=a:i=null);else{const f={instancePath:e,schemaPath:"#/oneOf",keyword:"oneOf",params:{passingSchemas:l},message:"must match exactly one schema in oneOf",schema:Ft.oneOf,parentSchema:Ft,data:t};i===null?i=[f]:i.push(f),o++}return n0.errors=i,o===0}function i0(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.id===void 0){const a={instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:"id"},message:"must have required property 'id'",schema:Ae.required,parentSchema:Ae,data:t};i===null?i=[a]:i.push(a),o++}if(t.schema===void 0){const a={instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:"schema"},message:"must have required property 'schema'",schema:Ae.required,parentSchema:Ae,data:t};i===null?i=[a]:i.push(a),o++}for(const a in t)if(!(a==="id"||a==="name"||a==="purpose"||a==="group"||a==="schema"||a==="issuance"||a==="constraints")){const c={instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:a},message:"must NOT have additional properties",schema:!1,parentSchema:Ae,data:t};i===null?i=[c]:i.push(c),o++}if(t.id!==void 0){let a=t.id;if(typeof a!="string"){const c={instancePath:e+"/id",schemaPath:"#/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ae.properties.id.type,parentSchema:Ae.properties.id,data:a};i===null?i=[c]:i.push(c),o++}}if(t.name!==void 0){let a=t.name;if(typeof a!="string"){const c={instancePath:e+"/name",schemaPath:"#/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ae.properties.name.type,parentSchema:Ae.properties.name,data:a};i===null?i=[c]:i.push(c),o++}}if(t.purpose!==void 0){let a=t.purpose;if(typeof a!="string"){const c={instancePath:e+"/purpose",schemaPath:"#/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ae.properties.purpose.type,parentSchema:Ae.properties.purpose,data:a};i===null?i=[c]:i.push(c),o++}}if(t.group!==void 0){let a=t.group;if(Array.isArray(a)){const c=a.length;for(let l=0;l<c;l++){let u=a[l];if(typeof u!="string"){const d={instancePath:e+"/group/"+l,schemaPath:"#/properties/group/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ae.properties.group.items.type,parentSchema:Ae.properties.group.items,data:u};i===null?i=[d]:i.push(d),o++}}}else{const c={instancePath:e+"/group",schemaPath:"#/properties/group/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Ae.properties.group.type,parentSchema:Ae.properties.group,data:a};i===null?i=[c]:i.push(c),o++}}if(t.schema!==void 0){let a=t.schema;if(Array.isArray(a)){const c=a.length;for(let l=0;l<c;l++)t0(a[l],{instancePath:e+"/schema/"+l,parentData:a,parentDataProperty:l,rootData:s})||(i=i===null?t0.errors:i.concat(t0.errors),o=i.length)}else{const c={instancePath:e+"/schema",schemaPath:"#/properties/schema/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Ae.properties.schema.type,parentSchema:Ae.properties.schema,data:a};i===null?i=[c]:i.push(c),o++}}if(t.issuance!==void 0){let a=t.issuance;if(Array.isArray(a)){const c=a.length;for(let l=0;l<c;l++)r0(a[l],{instancePath:e+"/issuance/"+l,parentData:a,parentDataProperty:l,rootData:s})||(i=i===null?r0.errors:i.concat(r0.errors),o=i.length)}else{const c={instancePath:e+"/issuance",schemaPath:"#/properties/issuance/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Ae.properties.issuance.type,parentSchema:Ae.properties.issuance,data:a};i===null?i=[c]:i.push(c),o++}}if(t.constraints!==void 0){let a=t.constraints;if(a&&typeof a=="object"&&!Array.isArray(a)){for(const c in a)if(!(c==="limit_disclosure"||c==="statuses"||c==="fields"||c==="subject_is_issuer"||c==="is_holder"||c==="same_subject")){const l={instancePath:e+"/constraints",schemaPath:"#/properties/constraints/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:c},message:"must NOT have additional properties",schema:!1,parentSchema:Ae.properties.constraints,data:a};i===null?i=[l]:i.push(l),o++}if(a.limit_disclosure!==void 0){let c=a.limit_disclosure;if(typeof c!="string"){const l={instancePath:e+"/constraints/limit_disclosure",schemaPath:"#/properties/constraints/properties/limit_disclosure/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ae.properties.constraints.properties.limit_disclosure.type,parentSchema:Ae.properties.constraints.properties.limit_disclosure,data:c};i===null?i=[l]:i.push(l),o++}if(!(c==="required"||c==="preferred")){const l={instancePath:e+"/constraints/limit_disclosure",schemaPath:"#/properties/constraints/properties/limit_disclosure/enum",keyword:"enum",params:{allowedValues:Ae.properties.constraints.properties.limit_disclosure.enum},message:"must be equal to one of the allowed values",schema:Ae.properties.constraints.properties.limit_disclosure.enum,parentSchema:Ae.properties.constraints.properties.limit_disclosure,data:c};i===null?i=[l]:i.push(l),o++}}if(a.statuses!==void 0){let c=a.statuses;if(c&&typeof c=="object"&&!Array.isArray(c)){if(c.active!==void 0){let l=c.active;if(l&&typeof l=="object"&&!Array.isArray(l)){if(l.directive!==void 0){let u=l.directive;if(typeof u!="string"){const d={instancePath:e+"/constraints/statuses/active/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/active/properties/directive/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ae.properties.constraints.properties.statuses.properties.active.properties.directive.type,parentSchema:Ae.properties.constraints.properties.statuses.properties.active.properties.directive,data:u};i===null?i=[d]:i.push(d),o++}if(!(u==="required"||u==="allowed"||u==="disallowed")){const d={instancePath:e+"/constraints/statuses/active/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/active/properties/directive/enum",keyword:"enum",params:{allowedValues:Ae.properties.constraints.properties.statuses.properties.active.properties.directive.enum},message:"must be equal to one of the allowed values",schema:Ae.properties.constraints.properties.statuses.properties.active.properties.directive.enum,parentSchema:Ae.properties.constraints.properties.statuses.properties.active.properties.directive,data:u};i===null?i=[d]:i.push(d),o++}}}else{const u={instancePath:e+"/constraints/statuses/active",schemaPath:"#/properties/constraints/properties/statuses/properties/active/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Ae.properties.constraints.properties.statuses.properties.active.type,parentSchema:Ae.properties.constraints.properties.statuses.properties.active,data:l};i===null?i=[u]:i.push(u),o++}}if(c.suspended!==void 0){let l=c.suspended;if(l&&typeof l=="object"&&!Array.isArray(l)){if(l.directive!==void 0){let u=l.directive;if(typeof u!="string"){const d={instancePath:e+"/constraints/statuses/suspended/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/suspended/properties/directive/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ae.properties.constraints.properties.statuses.properties.suspended.properties.directive.type,parentSchema:Ae.properties.constraints.properties.statuses.properties.suspended.properties.directive,data:u};i===null?i=[d]:i.push(d),o++}if(!(u==="required"||u==="allowed"||u==="disallowed")){const d={instancePath:e+"/constraints/statuses/suspended/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/suspended/properties/directive/enum",keyword:"enum",params:{allowedValues:Ae.properties.constraints.properties.statuses.properties.suspended.properties.directive.enum},message:"must be equal to one of the allowed values",schema:Ae.properties.constraints.properties.statuses.properties.suspended.properties.directive.enum,parentSchema:Ae.properties.constraints.properties.statuses.properties.suspended.properties.directive,data:u};i===null?i=[d]:i.push(d),o++}}}else{const u={instancePath:e+"/constraints/statuses/suspended",schemaPath:"#/properties/constraints/properties/statuses/properties/suspended/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Ae.properties.constraints.properties.statuses.properties.suspended.type,parentSchema:Ae.properties.constraints.properties.statuses.properties.suspended,data:l};i===null?i=[u]:i.push(u),o++}}if(c.revoked!==void 0){let l=c.revoked;if(l&&typeof l=="object"&&!Array.isArray(l)){if(l.directive!==void 0){let u=l.directive;if(typeof u!="string"){const d={instancePath:e+"/constraints/statuses/revoked/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/revoked/properties/directive/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ae.properties.constraints.properties.statuses.properties.revoked.properties.directive.type,parentSchema:Ae.properties.constraints.properties.statuses.properties.revoked.properties.directive,data:u};i===null?i=[d]:i.push(d),o++}if(!(u==="required"||u==="allowed"||u==="disallowed")){const d={instancePath:e+"/constraints/statuses/revoked/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/revoked/properties/directive/enum",keyword:"enum",params:{allowedValues:Ae.properties.constraints.properties.statuses.properties.revoked.properties.directive.enum},message:"must be equal to one of the allowed values",schema:Ae.properties.constraints.properties.statuses.properties.revoked.properties.directive.enum,parentSchema:Ae.properties.constraints.properties.statuses.properties.revoked.properties.directive,data:u};i===null?i=[d]:i.push(d),o++}}}else{const u={instancePath:e+"/constraints/statuses/revoked",schemaPath:"#/properties/constraints/properties/statuses/properties/revoked/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Ae.properties.constraints.properties.statuses.properties.revoked.type,parentSchema:Ae.properties.constraints.properties.statuses.properties.revoked,data:l};i===null?i=[u]:i.push(u),o++}}}else{const l={instancePath:e+"/constraints/statuses",schemaPath:"#/properties/constraints/properties/statuses/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Ae.properties.constraints.properties.statuses.type,parentSchema:Ae.properties.constraints.properties.statuses,data:c};i===null?i=[l]:i.push(l),o++}}if(a.fields!==void 0){let c=a.fields;if(Array.isArray(c)){const l=c.length;for(let u=0;u<l;u++)n0(c[u],{instancePath:e+"/constraints/fields/"+u,parentData:c,parentDataProperty:u,rootData:s})||(i=i===null?n0.errors:i.concat(n0.errors),o=i.length)}else{const l={instancePath:e+"/constraints/fields",schemaPath:"#/properties/constraints/properties/fields/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Ae.properties.constraints.properties.fields.type,parentSchema:Ae.properties.constraints.properties.fields,data:c};i===null?i=[l]:i.push(l),o++}}if(a.subject_is_issuer!==void 0){let c=a.subject_is_issuer;if(typeof c!="string"){const l={instancePath:e+"/constraints/subject_is_issuer",schemaPath:"#/properties/constraints/properties/subject_is_issuer/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ae.properties.constraints.properties.subject_is_issuer.type,parentSchema:Ae.properties.constraints.properties.subject_is_issuer,data:c};i===null?i=[l]:i.push(l),o++}if(!(c==="required"||c==="preferred")){const l={instancePath:e+"/constraints/subject_is_issuer",schemaPath:"#/properties/constraints/properties/subject_is_issuer/enum",keyword:"enum",params:{allowedValues:Ae.properties.constraints.properties.subject_is_issuer.enum},message:"must be equal to one of the allowed values",schema:Ae.properties.constraints.properties.subject_is_issuer.enum,parentSchema:Ae.properties.constraints.properties.subject_is_issuer,data:c};i===null?i=[l]:i.push(l),o++}}if(a.is_holder!==void 0){let c=a.is_holder;if(Array.isArray(c)){const l=c.length;for(let u=0;u<l;u++){let d=c[u];if(d&&typeof d=="object"&&!Array.isArray(d)){if(d.field_id===void 0){const h={instancePath:e+"/constraints/is_holder/"+u,schemaPath:"#/properties/constraints/properties/is_holder/items/required",keyword:"required",params:{missingProperty:"field_id"},message:"must have required property 'field_id'",schema:Ae.properties.constraints.properties.is_holder.items.required,parentSchema:Ae.properties.constraints.properties.is_holder.items,data:d};i===null?i=[h]:i.push(h),o++}if(d.directive===void 0){const h={instancePath:e+"/constraints/is_holder/"+u,schemaPath:"#/properties/constraints/properties/is_holder/items/required",keyword:"required",params:{missingProperty:"directive"},message:"must have required property 'directive'",schema:Ae.properties.constraints.properties.is_holder.items.required,parentSchema:Ae.properties.constraints.properties.is_holder.items,data:d};i===null?i=[h]:i.push(h),o++}for(const h in d)if(!(h==="field_id"||h==="directive")){const f={instancePath:e+"/constraints/is_holder/"+u,schemaPath:"#/properties/constraints/properties/is_holder/items/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:h},message:"must NOT have additional properties",schema:!1,parentSchema:Ae.properties.constraints.properties.is_holder.items,data:d};i===null?i=[f]:i.push(f),o++}if(d.field_id!==void 0){let h=d.field_id;if(Array.isArray(h)){const f=h.length;for(let p=0;p<f;p++){let y=h[p];if(typeof y!="string"){const b={instancePath:e+"/constraints/is_holder/"+u+"/field_id/"+p,schemaPath:"#/properties/constraints/properties/is_holder/items/properties/field_id/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ae.properties.constraints.properties.is_holder.items.properties.field_id.items.type,parentSchema:Ae.properties.constraints.properties.is_holder.items.properties.field_id.items,data:y};i===null?i=[b]:i.push(b),o++}}}else{const f={instancePath:e+"/constraints/is_holder/"+u+"/field_id",schemaPath:"#/properties/constraints/properties/is_holder/items/properties/field_id/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Ae.properties.constraints.properties.is_holder.items.properties.field_id.type,parentSchema:Ae.properties.constraints.properties.is_holder.items.properties.field_id,data:h};i===null?i=[f]:i.push(f),o++}}if(d.directive!==void 0){let h=d.directive;if(typeof h!="string"){const f={instancePath:e+"/constraints/is_holder/"+u+"/directive",schemaPath:"#/properties/constraints/properties/is_holder/items/properties/directive/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ae.properties.constraints.properties.is_holder.items.properties.directive.type,parentSchema:Ae.properties.constraints.properties.is_holder.items.properties.directive,data:h};i===null?i=[f]:i.push(f),o++}if(!(h==="required"||h==="preferred")){const f={instancePath:e+"/constraints/is_holder/"+u+"/directive",schemaPath:"#/properties/constraints/properties/is_holder/items/properties/directive/enum",keyword:"enum",params:{allowedValues:Ae.properties.constraints.properties.is_holder.items.properties.directive.enum},message:"must be equal to one of the allowed values",schema:Ae.properties.constraints.properties.is_holder.items.properties.directive.enum,parentSchema:Ae.properties.constraints.properties.is_holder.items.properties.directive,data:h};i===null?i=[f]:i.push(f),o++}}}else{const h={instancePath:e+"/constraints/is_holder/"+u,schemaPath:"#/properties/constraints/properties/is_holder/items/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Ae.properties.constraints.properties.is_holder.items.type,parentSchema:Ae.properties.constraints.properties.is_holder.items,data:d};i===null?i=[h]:i.push(h),o++}}}else{const l={instancePath:e+"/constraints/is_holder",schemaPath:"#/properties/constraints/properties/is_holder/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Ae.properties.constraints.properties.is_holder.type,parentSchema:Ae.properties.constraints.properties.is_holder,data:c};i===null?i=[l]:i.push(l),o++}}if(a.same_subject!==void 0){let c=a.same_subject;if(Array.isArray(c)){const l=c.length;for(let u=0;u<l;u++){let d=c[u];if(d&&typeof d=="object"&&!Array.isArray(d)){if(d.field_id===void 0){const h={instancePath:e+"/constraints/same_subject/"+u,schemaPath:"#/properties/constraints/properties/same_subject/items/required",keyword:"required",params:{missingProperty:"field_id"},message:"must have required property 'field_id'",schema:Ae.properties.constraints.properties.same_subject.items.required,parentSchema:Ae.properties.constraints.properties.same_subject.items,data:d};i===null?i=[h]:i.push(h),o++}if(d.directive===void 0){const h={instancePath:e+"/constraints/same_subject/"+u,schemaPath:"#/properties/constraints/properties/same_subject/items/required",keyword:"required",params:{missingProperty:"directive"},message:"must have required property 'directive'",schema:Ae.properties.constraints.properties.same_subject.items.required,parentSchema:Ae.properties.constraints.properties.same_subject.items,data:d};i===null?i=[h]:i.push(h),o++}for(const h in d)if(!(h==="field_id"||h==="directive")){const f={instancePath:e+"/constraints/same_subject/"+u,schemaPath:"#/properties/constraints/properties/same_subject/items/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:h},message:"must NOT have additional properties",schema:!1,parentSchema:Ae.properties.constraints.properties.same_subject.items,data:d};i===null?i=[f]:i.push(f),o++}if(d.field_id!==void 0){let h=d.field_id;if(Array.isArray(h)){const f=h.length;for(let p=0;p<f;p++){let y=h[p];if(typeof y!="string"){const b={instancePath:e+"/constraints/same_subject/"+u+"/field_id/"+p,schemaPath:"#/properties/constraints/properties/same_subject/items/properties/field_id/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ae.properties.constraints.properties.same_subject.items.properties.field_id.items.type,parentSchema:Ae.properties.constraints.properties.same_subject.items.properties.field_id.items,data:y};i===null?i=[b]:i.push(b),o++}}}else{const f={instancePath:e+"/constraints/same_subject/"+u+"/field_id",schemaPath:"#/properties/constraints/properties/same_subject/items/properties/field_id/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Ae.properties.constraints.properties.same_subject.items.properties.field_id.type,parentSchema:Ae.properties.constraints.properties.same_subject.items.properties.field_id,data:h};i===null?i=[f]:i.push(f),o++}}if(d.directive!==void 0){let h=d.directive;if(typeof h!="string"){const f={instancePath:e+"/constraints/same_subject/"+u+"/directive",schemaPath:"#/properties/constraints/properties/same_subject/items/properties/directive/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ae.properties.constraints.properties.same_subject.items.properties.directive.type,parentSchema:Ae.properties.constraints.properties.same_subject.items.properties.directive,data:h};i===null?i=[f]:i.push(f),o++}if(!(h==="required"||h==="preferred")){const f={instancePath:e+"/constraints/same_subject/"+u+"/directive",schemaPath:"#/properties/constraints/properties/same_subject/items/properties/directive/enum",keyword:"enum",params:{allowedValues:Ae.properties.constraints.properties.same_subject.items.properties.directive.enum},message:"must be equal to one of the allowed values",schema:Ae.properties.constraints.properties.same_subject.items.properties.directive.enum,parentSchema:Ae.properties.constraints.properties.same_subject.items.properties.directive,data:h};i===null?i=[f]:i.push(f),o++}}}else{const h={instancePath:e+"/constraints/same_subject/"+u,schemaPath:"#/properties/constraints/properties/same_subject/items/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Ae.properties.constraints.properties.same_subject.items.type,parentSchema:Ae.properties.constraints.properties.same_subject.items,data:d};i===null?i=[h]:i.push(h),o++}}}else{const l={instancePath:e+"/constraints/same_subject",schemaPath:"#/properties/constraints/properties/same_subject/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Ae.properties.constraints.properties.same_subject.type,parentSchema:Ae.properties.constraints.properties.same_subject,data:c};i===null?i=[l]:i.push(l),o++}}}else{const c={instancePath:e+"/constraints",schemaPath:"#/properties/constraints/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Ae.properties.constraints.type,parentSchema:Ae.properties.constraints,data:a};i===null?i=[c]:i.push(c),o++}}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Ae.type,parentSchema:Ae,data:t};i===null?i=[a]:i.push(a),o++}return i0.errors=i,o===0}function F_(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.presentation_definition!==void 0){let a=t.presentation_definition;if(a&&typeof a=="object"&&!Array.isArray(a)){if(a.id===void 0){const c={instancePath:e+"/presentation_definition",schemaPath:"#/properties/presentation_definition/required",keyword:"required",params:{missingProperty:"id"},message:"must have required property 'id'",schema:Hr.properties.presentation_definition.required,parentSchema:Hr.properties.presentation_definition,data:a};i===null?i=[c]:i.push(c),o++}if(a.input_descriptors===void 0){const c={instancePath:e+"/presentation_definition",schemaPath:"#/properties/presentation_definition/required",keyword:"required",params:{missingProperty:"input_descriptors"},message:"must have required property 'input_descriptors'",schema:Hr.properties.presentation_definition.required,parentSchema:Hr.properties.presentation_definition,data:a};i===null?i=[c]:i.push(c),o++}for(const c in a)if(!(c==="id"||c==="name"||c==="purpose"||c==="format"||c==="submission_requirements"||c==="input_descriptors")){const l={instancePath:e+"/presentation_definition",schemaPath:"#/properties/presentation_definition/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:c},message:"must NOT have additional properties",schema:!1,parentSchema:Hr.properties.presentation_definition,data:a};i===null?i=[l]:i.push(l),o++}if(a.id!==void 0){let c=a.id;if(typeof c!="string"){const l={instancePath:e+"/presentation_definition/id",schemaPath:"#/properties/presentation_definition/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Hr.properties.presentation_definition.properties.id.type,parentSchema:Hr.properties.presentation_definition.properties.id,data:c};i===null?i=[l]:i.push(l),o++}}if(a.name!==void 0){let c=a.name;if(typeof c!="string"){const l={instancePath:e+"/presentation_definition/name",schemaPath:"#/properties/presentation_definition/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Hr.properties.presentation_definition.properties.name.type,parentSchema:Hr.properties.presentation_definition.properties.name,data:c};i===null?i=[l]:i.push(l),o++}}if(a.purpose!==void 0){let c=a.purpose;if(typeof c!="string"){const l={instancePath:e+"/presentation_definition/purpose",schemaPath:"#/properties/presentation_definition/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Hr.properties.presentation_definition.properties.purpose.type,parentSchema:Hr.properties.presentation_definition.properties.purpose,data:c};i===null?i=[l]:i.push(l),o++}}if(a.format!==void 0&&(e0(a.format,{instancePath:e+"/presentation_definition/format",parentData:a,parentDataProperty:"format",rootData:s})||(i=i===null?e0.errors:i.concat(e0.errors),o=i.length)),a.submission_requirements!==void 0){let c=a.submission_requirements;if(Array.isArray(c)){const l=c.length;for(let u=0;u<l;u++)Yp(c[u],{instancePath:e+"/presentation_definition/submission_requirements/"+u,parentData:c,parentDataProperty:u,rootData:s})||(i=i===null?Yp.errors:i.concat(Yp.errors),o=i.length)}else{const l={instancePath:e+"/presentation_definition/submission_requirements",schemaPath:"#/properties/presentation_definition/properties/submission_requirements/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Hr.properties.presentation_definition.properties.submission_requirements.type,parentSchema:Hr.properties.presentation_definition.properties.submission_requirements,data:c};i===null?i=[l]:i.push(l),o++}}if(a.input_descriptors!==void 0){let c=a.input_descriptors;if(Array.isArray(c)){const l=c.length;for(let u=0;u<l;u++)i0(c[u],{instancePath:e+"/presentation_definition/input_descriptors/"+u,parentData:c,parentDataProperty:u,rootData:s})||(i=i===null?i0.errors:i.concat(i0.errors),o=i.length)}else{const l={instancePath:e+"/presentation_definition/input_descriptors",schemaPath:"#/properties/presentation_definition/properties/input_descriptors/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Hr.properties.presentation_definition.properties.input_descriptors.type,parentSchema:Hr.properties.presentation_definition.properties.input_descriptors,data:c};i===null?i=[l]:i.push(l),o++}}}else{const c={instancePath:e+"/presentation_definition",schemaPath:"#/properties/presentation_definition/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Hr.properties.presentation_definition.type,parentSchema:Hr.properties.presentation_definition,data:a};i===null?i=[c]:i.push(c),o++}}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Hr.type,parentSchema:Hr,data:t};i===null?i=[a]:i.push(a),o++}return F_.errors=i,o===0}var DV=B_.exports;const pO=Jo(DV);var N_={exports:{}},gf={};Object.defineProperty(gf,"__esModule",{value:!0});const hO=Ig;hO.code='require("ajv/dist/runtime/equal").default';gf.default=hO;N_.exports=R_;N_.exports.default=R_;const Or={$schema:"http://json-schema.org/draft-07/schema#",title:"Presentation Definition",definitions:{issuance:{type:"object",properties:{manifest:{type:"string"}},additionalProperties:!0},format:{type:"object",patternProperties:{"^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$":{type:"object",properties:{alg:{type:"array",minItems:1,items:{type:"string"}}},required:["alg"],additionalProperties:!1},"^ldp_vc$|^ldp_vp$|^ldp$":{type:"object",properties:{proof_type:{type:"array",minItems:1,items:{type:"string"}}},required:["proof_type"],additionalProperties:!1},additionalProperties:!1},additionalProperties:!1},submission_requirements:{type:"object",oneOf:[{properties:{name:{type:"string"},purpose:{type:"string"},rule:{type:"string",enum:["all","pick"]},count:{type:"integer",minimum:1},min:{type:"integer",minimum:0},max:{type:"integer",minimum:0},from:{type:"string"}},required:["rule","from"],additionalProperties:!1},{properties:{name:{type:"string"},purpose:{type:"string"},rule:{type:"string",enum:["all","pick"]},count:{type:"integer",minimum:1},min:{type:"integer",minimum:0},max:{type:"integer",minimum:0},from_nested:{type:"array",minItems:1,items:{$ref:"#/definitions/submission_requirements"}}},required:["rule","from_nested"],additionalProperties:!1}]},input_descriptors:{type:"object",properties:{id:{type:"string"},name:{type:"string"},purpose:{type:"string"},issuance:{type:"array",items:{$ref:"#/definitions/issuance"}},group:{type:"array",items:{type:"string"}},format:{$ref:"#/definitions/format"},constraints:{type:"object",properties:{limit_disclosure:{type:"string",enum:["required","preferred"]},statuses:{type:"object",properties:{active:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}},suspended:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}},revoked:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}}}},fields:{type:"array",items:{$ref:"#/definitions/field"}},subject_is_issuer:{type:"string",enum:["required","preferred"]},is_holder:{type:"array",items:{type:"object",properties:{field_id:{type:"array",items:{type:"string"}},directive:{type:"string",enum:["required","preferred"]}},required:["field_id","directive"],additionalProperties:!1}},same_subject:{type:"array",items:{type:"object",properties:{field_id:{type:"array",items:{type:"string"}},directive:{type:"string",enum:["required","preferred"]}},required:["field_id","directive"],additionalProperties:!1}}},additionalProperties:!1}},required:["id"],additionalProperties:!1},field:{type:"object",oneOf:[{properties:{id:{type:"string"},path:{type:"array",items:{type:"string"}},purpose:{type:"string"},intent_to_retain:{type:"boolean"},filter:{$ref:"http://json-schema.org/schema#"},name:{type:"string"}},required:["path"],additionalProperties:!1},{properties:{id:{type:"string"},path:{type:"array",items:{type:"string"}},purpose:{type:"string"},intent_to_retain:{type:"boolean"},filter:{$ref:"http://json-schema.org/schema#"},predicate:{type:"string",enum:["required","preferred"]},name:{type:"string"}},required:["path","filter","predicate"],additionalProperties:!1}]}},type:"object",properties:{presentation_definition:{type:"object",properties:{id:{type:"string"},name:{type:"string"},purpose:{type:"string"},format:{$ref:"#/definitions/format"},frame:{type:"object",additionalProperties:!0},submission_requirements:{type:"array",items:{$ref:"#/definitions/submission_requirements"}},input_descriptors:{type:"array",items:{$ref:"#/definitions/input_descriptors"}}},required:["id","input_descriptors"],additionalProperties:!1}}},br={type:"object",patternProperties:{"^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$":{type:"object",properties:{alg:{type:"array",minItems:1,items:{type:"string"}}},required:["alg"],additionalProperties:!1},"^ldp_vc$|^ldp_vp$|^ldp$":{type:"object",properties:{proof_type:{type:"array",minItems:1,items:{type:"string"}}},required:["proof_type"],additionalProperties:!1},additionalProperties:!1},additionalProperties:!1},rx=new RegExp("^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$","u"),nx=new RegExp("^ldp_vc$|^ldp_vp$|^ldp$","u"),ix=new RegExp("additionalProperties","u");function Nl(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){for(const a in t)if(!(rx.test(a)||nx.test(a)||ix.test(a))){const c={instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:a},message:"must NOT have additional properties",schema:!1,parentSchema:br,data:t};i===null?i=[c]:i.push(c),o++}for(const a in t)if(rx.test(a)){let c=t[a];if(c&&typeof c=="object"&&!Array.isArray(c)){if(c.alg===void 0){const l={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24%7C%5Emso_mdoc%24/required",keyword:"required",params:{missingProperty:"alg"},message:"must have required property 'alg'",schema:br.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$"].required,parentSchema:br.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$"],data:c};i===null?i=[l]:i.push(l),o++}for(const l in c)if(l!=="alg"){const u={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24%7C%5Emso_mdoc%24/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:l},message:"must NOT have additional properties",schema:!1,parentSchema:br.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$"],data:c};i===null?i=[u]:i.push(u),o++}if(c.alg!==void 0){let l=c.alg;if(Array.isArray(l)){if(l.length<1){const d={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/alg",schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24%7C%5Emso_mdoc%24/properties/alg/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items",schema:1,parentSchema:br.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$"].properties.alg,data:l};i===null?i=[d]:i.push(d),o++}const u=l.length;for(let d=0;d<u;d++){let h=l[d];if(typeof h!="string"){const f={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/alg/"+d,schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24%7C%5Emso_mdoc%24/properties/alg/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:br.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$"].properties.alg.items.type,parentSchema:br.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$"].properties.alg.items,data:h};i===null?i=[f]:i.push(f),o++}}}else{const u={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/alg",schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24%7C%5Emso_mdoc%24/properties/alg/type",keyword:"type",params:{type:"array"},message:"must be array",schema:br.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$"].properties.alg.type,parentSchema:br.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$"].properties.alg,data:l};i===null?i=[u]:i.push(u),o++}}}else{const l={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Ejwt%24%7C%5Ejwt_vc%24%7C%5Ejwt_vp%24%7C%5Emso_mdoc%24/type",keyword:"type",params:{type:"object"},message:"must be object",schema:br.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$"].type,parentSchema:br.patternProperties["^jwt$|^jwt_vc$|^jwt_vp$|^mso_mdoc$"],data:c};i===null?i=[l]:i.push(l),o++}}for(const a in t)if(nx.test(a)){let c=t[a];if(c&&typeof c=="object"&&!Array.isArray(c)){if(c.proof_type===void 0){const l={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/required",keyword:"required",params:{missingProperty:"proof_type"},message:"must have required property 'proof_type'",schema:br.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].required,parentSchema:br.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"],data:c};i===null?i=[l]:i.push(l),o++}for(const l in c)if(l!=="proof_type"){const u={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:l},message:"must NOT have additional properties",schema:!1,parentSchema:br.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"],data:c};i===null?i=[u]:i.push(u),o++}if(c.proof_type!==void 0){let l=c.proof_type;if(Array.isArray(l)){if(l.length<1){const d={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/proof_type",schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/properties/proof_type/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items",schema:1,parentSchema:br.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].properties.proof_type,data:l};i===null?i=[d]:i.push(d),o++}const u=l.length;for(let d=0;d<u;d++){let h=l[d];if(typeof h!="string"){const f={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/proof_type/"+d,schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/properties/proof_type/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:br.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].properties.proof_type.items.type,parentSchema:br.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].properties.proof_type.items,data:h};i===null?i=[f]:i.push(f),o++}}}else{const u={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1")+"/proof_type",schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/properties/proof_type/type",keyword:"type",params:{type:"array"},message:"must be array",schema:br.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].properties.proof_type.type,parentSchema:br.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].properties.proof_type,data:l};i===null?i=[u]:i.push(u),o++}}}else{const l={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/%5Eldp_vc%24%7C%5Eldp_vp%24%7C%5Eldp%24/type",keyword:"type",params:{type:"object"},message:"must be object",schema:br.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"].type,parentSchema:br.patternProperties["^ldp_vc$|^ldp_vp$|^ldp$"],data:c};i===null?i=[l]:i.push(l),o++}}for(const a in t)if(ix.test(a)){const c={instancePath:e+"/"+a.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/patternProperties/additionalProperties/false schema",keyword:"false schema",params:{},message:"boolean schema is false",schema:!1,parentSchema:br.patternProperties.additionalProperties,data:t[a]};i===null?i=[c]:i.push(c),o++}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:br.type,parentSchema:br,data:t};i===null?i=[a]:i.push(a),o++}return Nl.errors=i,o===0}const Qe={type:"object",oneOf:[{properties:{name:{type:"string"},purpose:{type:"string"},rule:{type:"string",enum:["all","pick"]},count:{type:"integer",minimum:1},min:{type:"integer",minimum:0},max:{type:"integer",minimum:0},from:{type:"string"}},required:["rule","from"],additionalProperties:!1},{properties:{name:{type:"string"},purpose:{type:"string"},rule:{type:"string",enum:["all","pick"]},count:{type:"integer",minimum:1},min:{type:"integer",minimum:0},max:{type:"integer",minimum:0},from_nested:{type:"array",minItems:1,items:{$ref:"#/definitions/submission_requirements"}}},required:["rule","from_nested"],additionalProperties:!1}]},mw={validate:Qp};function Qp(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(!(t&&typeof t=="object"&&!Array.isArray(t))){const f={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Qe.type,parentSchema:Qe,data:t};i===null?i=[f]:i.push(f),o++}const a=o;let c=!1,l=null;const u=o;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.rule===void 0){const f={instancePath:e,schemaPath:"#/oneOf/0/required",keyword:"required",params:{missingProperty:"rule"},message:"must have required property 'rule'",schema:Qe.oneOf[0].required,parentSchema:Qe.oneOf[0],data:t};i===null?i=[f]:i.push(f),o++}if(t.from===void 0){const f={instancePath:e,schemaPath:"#/oneOf/0/required",keyword:"required",params:{missingProperty:"from"},message:"must have required property 'from'",schema:Qe.oneOf[0].required,parentSchema:Qe.oneOf[0],data:t};i===null?i=[f]:i.push(f),o++}for(const f in t)if(!(f==="name"||f==="purpose"||f==="rule"||f==="count"||f==="min"||f==="max"||f==="from")){const p={instancePath:e,schemaPath:"#/oneOf/0/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:f},message:"must NOT have additional properties",schema:!1,parentSchema:Qe.oneOf[0],data:t};i===null?i=[p]:i.push(p),o++}if(t.name!==void 0){let f=t.name;if(typeof f!="string"){const p={instancePath:e+"/name",schemaPath:"#/oneOf/0/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Qe.oneOf[0].properties.name.type,parentSchema:Qe.oneOf[0].properties.name,data:f};i===null?i=[p]:i.push(p),o++}}if(t.purpose!==void 0){let f=t.purpose;if(typeof f!="string"){const p={instancePath:e+"/purpose",schemaPath:"#/oneOf/0/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Qe.oneOf[0].properties.purpose.type,parentSchema:Qe.oneOf[0].properties.purpose,data:f};i===null?i=[p]:i.push(p),o++}}if(t.rule!==void 0){let f=t.rule;if(typeof f!="string"){const p={instancePath:e+"/rule",schemaPath:"#/oneOf/0/properties/rule/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Qe.oneOf[0].properties.rule.type,parentSchema:Qe.oneOf[0].properties.rule,data:f};i===null?i=[p]:i.push(p),o++}if(!(f==="all"||f==="pick")){const p={instancePath:e+"/rule",schemaPath:"#/oneOf/0/properties/rule/enum",keyword:"enum",params:{allowedValues:Qe.oneOf[0].properties.rule.enum},message:"must be equal to one of the allowed values",schema:Qe.oneOf[0].properties.rule.enum,parentSchema:Qe.oneOf[0].properties.rule,data:f};i===null?i=[p]:i.push(p),o++}}if(t.count!==void 0){let f=t.count;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/count",schemaPath:"#/oneOf/0/properties/count/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:Qe.oneOf[0].properties.count.type,parentSchema:Qe.oneOf[0].properties.count,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<1||isNaN(f))){const p={instancePath:e+"/count",schemaPath:"#/oneOf/0/properties/count/minimum",keyword:"minimum",params:{comparison:">=",limit:1},message:"must be >= 1",schema:1,parentSchema:Qe.oneOf[0].properties.count,data:f};i===null?i=[p]:i.push(p),o++}}if(t.min!==void 0){let f=t.min;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/min",schemaPath:"#/oneOf/0/properties/min/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:Qe.oneOf[0].properties.min.type,parentSchema:Qe.oneOf[0].properties.min,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<0||isNaN(f))){const p={instancePath:e+"/min",schemaPath:"#/oneOf/0/properties/min/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0",schema:0,parentSchema:Qe.oneOf[0].properties.min,data:f};i===null?i=[p]:i.push(p),o++}}if(t.max!==void 0){let f=t.max;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/max",schemaPath:"#/oneOf/0/properties/max/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:Qe.oneOf[0].properties.max.type,parentSchema:Qe.oneOf[0].properties.max,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<0||isNaN(f))){const p={instancePath:e+"/max",schemaPath:"#/oneOf/0/properties/max/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0",schema:0,parentSchema:Qe.oneOf[0].properties.max,data:f};i===null?i=[p]:i.push(p),o++}}if(t.from!==void 0){let f=t.from;if(typeof f!="string"){const p={instancePath:e+"/from",schemaPath:"#/oneOf/0/properties/from/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Qe.oneOf[0].properties.from.type,parentSchema:Qe.oneOf[0].properties.from,data:f};i===null?i=[p]:i.push(p),o++}}}var h=u===o;h&&(c=!0,l=0);const d=o;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.rule===void 0){const f={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:"rule"},message:"must have required property 'rule'",schema:Qe.oneOf[1].required,parentSchema:Qe.oneOf[1],data:t};i===null?i=[f]:i.push(f),o++}if(t.from_nested===void 0){const f={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:"from_nested"},message:"must have required property 'from_nested'",schema:Qe.oneOf[1].required,parentSchema:Qe.oneOf[1],data:t};i===null?i=[f]:i.push(f),o++}for(const f in t)if(!(f==="name"||f==="purpose"||f==="rule"||f==="count"||f==="min"||f==="max"||f==="from_nested")){const p={instancePath:e,schemaPath:"#/oneOf/1/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:f},message:"must NOT have additional properties",schema:!1,parentSchema:Qe.oneOf[1],data:t};i===null?i=[p]:i.push(p),o++}if(t.name!==void 0){let f=t.name;if(typeof f!="string"){const p={instancePath:e+"/name",schemaPath:"#/oneOf/1/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Qe.oneOf[1].properties.name.type,parentSchema:Qe.oneOf[1].properties.name,data:f};i===null?i=[p]:i.push(p),o++}}if(t.purpose!==void 0){let f=t.purpose;if(typeof f!="string"){const p={instancePath:e+"/purpose",schemaPath:"#/oneOf/1/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Qe.oneOf[1].properties.purpose.type,parentSchema:Qe.oneOf[1].properties.purpose,data:f};i===null?i=[p]:i.push(p),o++}}if(t.rule!==void 0){let f=t.rule;if(typeof f!="string"){const p={instancePath:e+"/rule",schemaPath:"#/oneOf/1/properties/rule/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Qe.oneOf[1].properties.rule.type,parentSchema:Qe.oneOf[1].properties.rule,data:f};i===null?i=[p]:i.push(p),o++}if(!(f==="all"||f==="pick")){const p={instancePath:e+"/rule",schemaPath:"#/oneOf/1/properties/rule/enum",keyword:"enum",params:{allowedValues:Qe.oneOf[1].properties.rule.enum},message:"must be equal to one of the allowed values",schema:Qe.oneOf[1].properties.rule.enum,parentSchema:Qe.oneOf[1].properties.rule,data:f};i===null?i=[p]:i.push(p),o++}}if(t.count!==void 0){let f=t.count;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/count",schemaPath:"#/oneOf/1/properties/count/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:Qe.oneOf[1].properties.count.type,parentSchema:Qe.oneOf[1].properties.count,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<1||isNaN(f))){const p={instancePath:e+"/count",schemaPath:"#/oneOf/1/properties/count/minimum",keyword:"minimum",params:{comparison:">=",limit:1},message:"must be >= 1",schema:1,parentSchema:Qe.oneOf[1].properties.count,data:f};i===null?i=[p]:i.push(p),o++}}if(t.min!==void 0){let f=t.min;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/min",schemaPath:"#/oneOf/1/properties/min/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:Qe.oneOf[1].properties.min.type,parentSchema:Qe.oneOf[1].properties.min,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<0||isNaN(f))){const p={instancePath:e+"/min",schemaPath:"#/oneOf/1/properties/min/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0",schema:0,parentSchema:Qe.oneOf[1].properties.min,data:f};i===null?i=[p]:i.push(p),o++}}if(t.max!==void 0){let f=t.max;if(!(typeof f=="number"&&!(f%1)&&!isNaN(f))){const p={instancePath:e+"/max",schemaPath:"#/oneOf/1/properties/max/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:Qe.oneOf[1].properties.max.type,parentSchema:Qe.oneOf[1].properties.max,data:f};i===null?i=[p]:i.push(p),o++}if(typeof f=="number"&&(f<0||isNaN(f))){const p={instancePath:e+"/max",schemaPath:"#/oneOf/1/properties/max/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0",schema:0,parentSchema:Qe.oneOf[1].properties.max,data:f};i===null?i=[p]:i.push(p),o++}}if(t.from_nested!==void 0){let f=t.from_nested;if(Array.isArray(f)){if(f.length<1){const y={instancePath:e+"/from_nested",schemaPath:"#/oneOf/1/properties/from_nested/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items",schema:1,parentSchema:Qe.oneOf[1].properties.from_nested,data:f};i===null?i=[y]:i.push(y),o++}const p=f.length;for(let y=0;y<p;y++)mw.validate(f[y],{instancePath:e+"/from_nested/"+y,parentData:f,parentDataProperty:y,rootData:s})||(i=i===null?mw.validate.errors:i.concat(mw.validate.errors),o=i.length)}else{const p={instancePath:e+"/from_nested",schemaPath:"#/oneOf/1/properties/from_nested/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Qe.oneOf[1].properties.from_nested.type,parentSchema:Qe.oneOf[1].properties.from_nested,data:f};i===null?i=[p]:i.push(p),o++}}}var h=d===o;if(h&&c?(c=!1,l=[l,1]):h&&(c=!0,l=1),c)o=a,i!==null&&(a?i.length=a:i=null);else{const f={instancePath:e,schemaPath:"#/oneOf",keyword:"oneOf",params:{passingSchemas:l},message:"must match exactly one schema in oneOf",schema:Qe.oneOf,parentSchema:Qe,data:t};i===null?i=[f]:i.push(f),o++}return Qp.errors=i,o===0}const xe={type:"object",properties:{id:{type:"string"},name:{type:"string"},purpose:{type:"string"},issuance:{type:"array",items:{$ref:"#/definitions/issuance"}},group:{type:"array",items:{type:"string"}},format:{$ref:"#/definitions/format"},constraints:{type:"object",properties:{limit_disclosure:{type:"string",enum:["required","preferred"]},statuses:{type:"object",properties:{active:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}},suspended:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}},revoked:{type:"object",properties:{directive:{type:"string",enum:["required","allowed","disallowed"]}}}}},fields:{type:"array",items:{$ref:"#/definitions/field"}},subject_is_issuer:{type:"string",enum:["required","preferred"]},is_holder:{type:"array",items:{type:"object",properties:{field_id:{type:"array",items:{type:"string"}},directive:{type:"string",enum:["required","preferred"]}},required:["field_id","directive"],additionalProperties:!1}},same_subject:{type:"array",items:{type:"object",properties:{field_id:{type:"array",items:{type:"string"}},directive:{type:"string",enum:["required","preferred"]}},required:["field_id","directive"],additionalProperties:!1}}},additionalProperties:!1}},required:["id"],additionalProperties:!1},pm={type:"object",properties:{manifest:{type:"string"}},additionalProperties:!0};function s0(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.manifest!==void 0){let a=t.manifest;if(typeof a!="string"){const c={instancePath:e+"/manifest",schemaPath:"#/properties/manifest/type",keyword:"type",params:{type:"string"},message:"must be string",schema:pm.properties.manifest.type,parentSchema:pm.properties.manifest,data:a};i===null?i=[c]:i.push(c),o++}}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:pm.type,parentSchema:pm,data:t};i===null?i=[a]:i.push(a),o++}return s0.errors=i,o===0}const gt={type:"object",oneOf:[{properties:{id:{type:"string"},path:{type:"array",items:{type:"string"}},purpose:{type:"string"},intent_to_retain:{type:"boolean"},filter:{$ref:"http://json-schema.org/schema#"},name:{type:"string"}},required:["path"],additionalProperties:!1},{properties:{id:{type:"string"},path:{type:"array",items:{type:"string"}},purpose:{type:"string"},intent_to_retain:{type:"boolean"},filter:{$ref:"http://json-schema.org/schema#"},predicate:{type:"string",enum:["required","preferred"]},name:{type:"string"}},required:["path","filter","predicate"],additionalProperties:!1}]},Ke={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0},gw={type:"integer",minimum:0};function Pi(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(!(typeof t=="number"&&!(t%1)&&!isNaN(t))){const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"integer"},message:"must be integer",schema:gw.type,parentSchema:gw,data:t};i===null?i=[a]:i.push(a),o++}if(typeof t=="number"&&(t<0||isNaN(t))){const a={instancePath:e,schemaPath:"#/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0",schema:0,parentSchema:gw,data:t};i===null?i=[a]:i.push(a),o++}return Pi.errors=i,o===0}function wo(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;return Pi(t,{instancePath:e,parentData:r,parentDataProperty:n,rootData:s})||(i=i===null?Pi.errors:i.concat(Pi.errors),o=i.length),wo.errors=i,o===0}const vw={type:"array",minItems:1,items:{$ref:"#"}},ww={validate:ft};function $i(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(Array.isArray(t)){if(t.length<1){const c={instancePath:e,schemaPath:"#/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items",schema:1,parentSchema:vw,data:t};i===null?i=[c]:i.push(c),o++}const a=t.length;for(let c=0;c<a;c++)ww.validate(t[c],{instancePath:e+"/"+c,parentData:t,parentDataProperty:c,rootData:s})||(i=i===null?ww.validate.errors:i.concat(ww.validate.errors),o=i.length)}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"array"},message:"must be array",schema:vw.type,parentSchema:vw,data:t};i===null?i=[a]:i.push(a),o++}return $i.errors=i,o===0}const hp={type:"array",items:{type:"string"},uniqueItems:!0,default:[]};function ul(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(Array.isArray(t)){const a=t.length;for(let u=0;u<a;u++){let d=t[u];if(typeof d!="string"){const h={instancePath:e+"/"+u,schemaPath:"#/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:hp.items.type,parentSchema:hp.items,data:d};i===null?i=[h]:i.push(h),o++}}let c=t.length,l;if(c>1){const u={};for(;c--;){let d=t[c];if(typeof d=="string"){if(typeof u[d]=="number"){l=u[d];const h={instancePath:e,schemaPath:"#/uniqueItems",keyword:"uniqueItems",params:{i:c,j:l},message:"must NOT have duplicate items (items ## "+l+" and "+c+" are identical)",schema:!0,parentSchema:hp,data:t};i===null?i=[h]:i.push(h),o++;break}u[d]=c}}}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"array"},message:"must be array",schema:hp.type,parentSchema:hp,data:t};i===null?i=[a]:i.push(a),o++}return ul.errors=i,o===0}const bw={enum:["array","boolean","integer","null","number","object","string"]};function cl(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(!(t==="array"||t==="boolean"||t==="integer"||t==="null"||t==="number"||t==="object"||t==="string")){const a={instancePath:e,schemaPath:"#/enum",keyword:"enum",params:{allowedValues:bw.enum},message:"must be equal to one of the allowed values",schema:bw.enum,parentSchema:bw,data:t};i===null?i=[a]:i.push(a),o++}return cl.errors=i,o===0}const sx=gf.default;function ft(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(!(t&&typeof t=="object"&&!Array.isArray(t))&&typeof t!="boolean"){const d={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:Ke.type},message:"must be object,boolean",schema:Ke.type,parentSchema:Ke,data:t};i===null?i=[d]:i.push(d),o++}if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.$id!==void 0){let d=t.$id;if(typeof d!="string"){const h={instancePath:e+"/$id",schemaPath:"#/properties/%24id/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ke.properties.$id.type,parentSchema:Ke.properties.$id,data:d};i===null?i=[h]:i.push(h),o++}}if(t.$schema!==void 0){let d=t.$schema;if(typeof d!="string"){const h={instancePath:e+"/$schema",schemaPath:"#/properties/%24schema/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ke.properties.$schema.type,parentSchema:Ke.properties.$schema,data:d};i===null?i=[h]:i.push(h),o++}}if(t.$ref!==void 0){let d=t.$ref;if(typeof d!="string"){const h={instancePath:e+"/$ref",schemaPath:"#/properties/%24ref/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ke.properties.$ref.type,parentSchema:Ke.properties.$ref,data:d};i===null?i=[h]:i.push(h),o++}}if(t.$comment!==void 0){let d=t.$comment;if(typeof d!="string"){const h={instancePath:e+"/$comment",schemaPath:"#/properties/%24comment/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ke.properties.$comment.type,parentSchema:Ke.properties.$comment,data:d};i===null?i=[h]:i.push(h),o++}}if(t.title!==void 0){let d=t.title;if(typeof d!="string"){const h={instancePath:e+"/title",schemaPath:"#/properties/title/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ke.properties.title.type,parentSchema:Ke.properties.title,data:d};i===null?i=[h]:i.push(h),o++}}if(t.description!==void 0){let d=t.description;if(typeof d!="string"){const h={instancePath:e+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ke.properties.description.type,parentSchema:Ke.properties.description,data:d};i===null?i=[h]:i.push(h),o++}}if(t.readOnly!==void 0){let d=t.readOnly;if(typeof d!="boolean"){const h={instancePath:e+"/readOnly",schemaPath:"#/properties/readOnly/type",keyword:"type",params:{type:"boolean"},message:"must be boolean",schema:Ke.properties.readOnly.type,parentSchema:Ke.properties.readOnly,data:d};i===null?i=[h]:i.push(h),o++}}if(t.examples!==void 0){let d=t.examples;if(!Array.isArray(d)){const h={instancePath:e+"/examples",schemaPath:"#/properties/examples/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Ke.properties.examples.type,parentSchema:Ke.properties.examples,data:d};i===null?i=[h]:i.push(h),o++}}if(t.multipleOf!==void 0){let d=t.multipleOf;if(typeof d=="number"){if(d<=0||isNaN(d)){const h={instancePath:e+"/multipleOf",schemaPath:"#/properties/multipleOf/exclusiveMinimum",keyword:"exclusiveMinimum",params:{comparison:">",limit:0},message:"must be > 0",schema:0,parentSchema:Ke.properties.multipleOf,data:d};i===null?i=[h]:i.push(h),o++}}else{const h={instancePath:e+"/multipleOf",schemaPath:"#/properties/multipleOf/type",keyword:"type",params:{type:"number"},message:"must be number",schema:Ke.properties.multipleOf.type,parentSchema:Ke.properties.multipleOf,data:d};i===null?i=[h]:i.push(h),o++}}if(t.maximum!==void 0){let d=t.maximum;if(typeof d!="number"){const h={instancePath:e+"/maximum",schemaPath:"#/properties/maximum/type",keyword:"type",params:{type:"number"},message:"must be number",schema:Ke.properties.maximum.type,parentSchema:Ke.properties.maximum,data:d};i===null?i=[h]:i.push(h),o++}}if(t.exclusiveMaximum!==void 0){let d=t.exclusiveMaximum;if(typeof d!="number"){const h={instancePath:e+"/exclusiveMaximum",schemaPath:"#/properties/exclusiveMaximum/type",keyword:"type",params:{type:"number"},message:"must be number",schema:Ke.properties.exclusiveMaximum.type,parentSchema:Ke.properties.exclusiveMaximum,data:d};i===null?i=[h]:i.push(h),o++}}if(t.minimum!==void 0){let d=t.minimum;if(typeof d!="number"){const h={instancePath:e+"/minimum",schemaPath:"#/properties/minimum/type",keyword:"type",params:{type:"number"},message:"must be number",schema:Ke.properties.minimum.type,parentSchema:Ke.properties.minimum,data:d};i===null?i=[h]:i.push(h),o++}}if(t.exclusiveMinimum!==void 0){let d=t.exclusiveMinimum;if(typeof d!="number"){const h={instancePath:e+"/exclusiveMinimum",schemaPath:"#/properties/exclusiveMinimum/type",keyword:"type",params:{type:"number"},message:"must be number",schema:Ke.properties.exclusiveMinimum.type,parentSchema:Ke.properties.exclusiveMinimum,data:d};i===null?i=[h]:i.push(h),o++}}if(t.maxLength!==void 0&&(Pi(t.maxLength,{instancePath:e+"/maxLength",parentData:t,parentDataProperty:"maxLength",rootData:s})||(i=i===null?Pi.errors:i.concat(Pi.errors),o=i.length)),t.minLength!==void 0&&(wo(t.minLength,{instancePath:e+"/minLength",parentData:t,parentDataProperty:"minLength",rootData:s})||(i=i===null?wo.errors:i.concat(wo.errors),o=i.length)),t.pattern!==void 0){let d=t.pattern;if(typeof d!="string"){const h={instancePath:e+"/pattern",schemaPath:"#/properties/pattern/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ke.properties.pattern.type,parentSchema:Ke.properties.pattern,data:d};i===null?i=[h]:i.push(h),o++}}if(t.additionalItems!==void 0&&(ft(t.additionalItems,{instancePath:e+"/additionalItems",parentData:t,parentDataProperty:"additionalItems",rootData:s})||(i=i===null?ft.errors:i.concat(ft.errors),o=i.length)),t.items!==void 0){let d=t.items;const h=o;let f=!1;const p=o;ft(d,{instancePath:e+"/items",parentData:t,parentDataProperty:"items",rootData:s})||(i=i===null?ft.errors:i.concat(ft.errors),o=i.length);var a=p===o;if(f=f||a,!f){const y=o;$i(d,{instancePath:e+"/items",parentData:t,parentDataProperty:"items",rootData:s})||(i=i===null?$i.errors:i.concat($i.errors),o=i.length);var a=y===o;f=f||a}if(f)o=h,i!==null&&(h?i.length=h:i=null);else{const y={instancePath:e+"/items",schemaPath:"#/properties/items/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf",schema:Ke.properties.items.anyOf,parentSchema:Ke.properties.items,data:d};i===null?i=[y]:i.push(y),o++}}if(t.maxItems!==void 0&&(Pi(t.maxItems,{instancePath:e+"/maxItems",parentData:t,parentDataProperty:"maxItems",rootData:s})||(i=i===null?Pi.errors:i.concat(Pi.errors),o=i.length)),t.minItems!==void 0&&(wo(t.minItems,{instancePath:e+"/minItems",parentData:t,parentDataProperty:"minItems",rootData:s})||(i=i===null?wo.errors:i.concat(wo.errors),o=i.length)),t.uniqueItems!==void 0){let d=t.uniqueItems;if(typeof d!="boolean"){const h={instancePath:e+"/uniqueItems",schemaPath:"#/properties/uniqueItems/type",keyword:"type",params:{type:"boolean"},message:"must be boolean",schema:Ke.properties.uniqueItems.type,parentSchema:Ke.properties.uniqueItems,data:d};i===null?i=[h]:i.push(h),o++}}if(t.contains!==void 0&&(ft(t.contains,{instancePath:e+"/contains",parentData:t,parentDataProperty:"contains",rootData:s})||(i=i===null?ft.errors:i.concat(ft.errors),o=i.length)),t.maxProperties!==void 0&&(Pi(t.maxProperties,{instancePath:e+"/maxProperties",parentData:t,parentDataProperty:"maxProperties",rootData:s})||(i=i===null?Pi.errors:i.concat(Pi.errors),o=i.length)),t.minProperties!==void 0&&(wo(t.minProperties,{instancePath:e+"/minProperties",parentData:t,parentDataProperty:"minProperties",rootData:s})||(i=i===null?wo.errors:i.concat(wo.errors),o=i.length)),t.required!==void 0&&(ul(t.required,{instancePath:e+"/required",parentData:t,parentDataProperty:"required",rootData:s})||(i=i===null?ul.errors:i.concat(ul.errors),o=i.length)),t.additionalProperties!==void 0&&(ft(t.additionalProperties,{instancePath:e+"/additionalProperties",parentData:t,parentDataProperty:"additionalProperties",rootData:s})||(i=i===null?ft.errors:i.concat(ft.errors),o=i.length)),t.definitions!==void 0){let d=t.definitions;if(d&&typeof d=="object"&&!Array.isArray(d))for(const h in d)ft(d[h],{instancePath:e+"/definitions/"+h.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:d,parentDataProperty:h,rootData:s})||(i=i===null?ft.errors:i.concat(ft.errors),o=i.length);else{const h={instancePath:e+"/definitions",schemaPath:"#/properties/definitions/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Ke.properties.definitions.type,parentSchema:Ke.properties.definitions,data:d};i===null?i=[h]:i.push(h),o++}}if(t.properties!==void 0){let d=t.properties;if(d&&typeof d=="object"&&!Array.isArray(d))for(const h in d)ft(d[h],{instancePath:e+"/properties/"+h.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:d,parentDataProperty:h,rootData:s})||(i=i===null?ft.errors:i.concat(ft.errors),o=i.length);else{const h={instancePath:e+"/properties",schemaPath:"#/properties/properties/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Ke.properties.properties.type,parentSchema:Ke.properties.properties,data:d};i===null?i=[h]:i.push(h),o++}}if(t.patternProperties!==void 0){let d=t.patternProperties;if(d&&typeof d=="object"&&!Array.isArray(d)){for(const h in d){var c=o===o;if(!c){const p={instancePath:e+"/patternProperties",schemaPath:"#/properties/patternProperties/propertyNames",keyword:"propertyNames",params:{propertyName:h},message:"property name must be valid",schema:Ke.properties.patternProperties.propertyNames,parentSchema:Ke.properties.patternProperties,data:d};i===null?i=[p]:i.push(p),o++}}for(const h in d)ft(d[h],{instancePath:e+"/patternProperties/"+h.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:d,parentDataProperty:h,rootData:s})||(i=i===null?ft.errors:i.concat(ft.errors),o=i.length)}else{const h={instancePath:e+"/patternProperties",schemaPath:"#/properties/patternProperties/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Ke.properties.patternProperties.type,parentSchema:Ke.properties.patternProperties,data:d};i===null?i=[h]:i.push(h),o++}}if(t.dependencies!==void 0){let d=t.dependencies;if(d&&typeof d=="object"&&!Array.isArray(d))for(const h in d){let f=d[h];const p=o;let y=!1;const b=o;ft(f,{instancePath:e+"/dependencies/"+h.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:d,parentDataProperty:h,rootData:s})||(i=i===null?ft.errors:i.concat(ft.errors),o=i.length);var l=b===o;if(y=y||l,!y){const w=o;ul(f,{instancePath:e+"/dependencies/"+h.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:d,parentDataProperty:h,rootData:s})||(i=i===null?ul.errors:i.concat(ul.errors),o=i.length);var l=w===o;y=y||l}if(y)o=p,i!==null&&(p?i.length=p:i=null);else{const w={instancePath:e+"/dependencies/"+h.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/dependencies/additionalProperties/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf",schema:Ke.properties.dependencies.additionalProperties.anyOf,parentSchema:Ke.properties.dependencies.additionalProperties,data:f};i===null?i=[w]:i.push(w),o++}}else{const h={instancePath:e+"/dependencies",schemaPath:"#/properties/dependencies/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Ke.properties.dependencies.type,parentSchema:Ke.properties.dependencies,data:d};i===null?i=[h]:i.push(h),o++}}if(t.propertyNames!==void 0&&(ft(t.propertyNames,{instancePath:e+"/propertyNames",parentData:t,parentDataProperty:"propertyNames",rootData:s})||(i=i===null?ft.errors:i.concat(ft.errors),o=i.length)),t.enum!==void 0){let d=t.enum;if(Array.isArray(d)){if(d.length<1){const p={instancePath:e+"/enum",schemaPath:"#/properties/enum/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items",schema:1,parentSchema:Ke.properties.enum,data:d};i===null?i=[p]:i.push(p),o++}let h=d.length,f;if(h>1){e:for(;h--;)for(f=h;f--;)if(sx(d[h],d[f])){const p={instancePath:e+"/enum",schemaPath:"#/properties/enum/uniqueItems",keyword:"uniqueItems",params:{i:h,j:f},message:"must NOT have duplicate items (items ## "+f+" and "+h+" are identical)",schema:!0,parentSchema:Ke.properties.enum,data:d};i===null?i=[p]:i.push(p),o++;break e}}}else{const h={instancePath:e+"/enum",schemaPath:"#/properties/enum/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Ke.properties.enum.type,parentSchema:Ke.properties.enum,data:d};i===null?i=[h]:i.push(h),o++}}if(t.type!==void 0){let d=t.type;const h=o;let f=!1;const p=o;cl(d,{instancePath:e+"/type",parentData:t,parentDataProperty:"type",rootData:s})||(i=i===null?cl.errors:i.concat(cl.errors),o=i.length);var u=p===o;if(f=f||u,!f){const y=o;if(Array.isArray(d)){if(d.length<1){const m={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf/1/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items",schema:1,parentSchema:Ke.properties.type.anyOf[1],data:d};i===null?i=[m]:i.push(m),o++}const w=d.length;for(let m=0;m<w;m++)cl(d[m],{instancePath:e+"/type/"+m,parentData:d,parentDataProperty:m,rootData:s})||(i=i===null?cl.errors:i.concat(cl.errors),o=i.length);let g=d.length,v;if(g>1){e:for(;g--;)for(v=g;v--;)if(sx(d[g],d[v])){const m={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf/1/uniqueItems",keyword:"uniqueItems",params:{i:g,j:v},message:"must NOT have duplicate items (items ## "+v+" and "+g+" are identical)",schema:!0,parentSchema:Ke.properties.type.anyOf[1],data:d};i===null?i=[m]:i.push(m),o++;break e}}}else{const w={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf/1/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Ke.properties.type.anyOf[1].type,parentSchema:Ke.properties.type.anyOf[1],data:d};i===null?i=[w]:i.push(w),o++}var u=y===o;f=f||u}if(f)o=h,i!==null&&(h?i.length=h:i=null);else{const y={instancePath:e+"/type",schemaPath:"#/properties/type/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf",schema:Ke.properties.type.anyOf,parentSchema:Ke.properties.type,data:d};i===null?i=[y]:i.push(y),o++}}if(t.format!==void 0){let d=t.format;if(typeof d!="string"){const h={instancePath:e+"/format",schemaPath:"#/properties/format/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ke.properties.format.type,parentSchema:Ke.properties.format,data:d};i===null?i=[h]:i.push(h),o++}}if(t.contentMediaType!==void 0){let d=t.contentMediaType;if(typeof d!="string"){const h={instancePath:e+"/contentMediaType",schemaPath:"#/properties/contentMediaType/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ke.properties.contentMediaType.type,parentSchema:Ke.properties.contentMediaType,data:d};i===null?i=[h]:i.push(h),o++}}if(t.contentEncoding!==void 0){let d=t.contentEncoding;if(typeof d!="string"){const h={instancePath:e+"/contentEncoding",schemaPath:"#/properties/contentEncoding/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Ke.properties.contentEncoding.type,parentSchema:Ke.properties.contentEncoding,data:d};i===null?i=[h]:i.push(h),o++}}t.if!==void 0&&(ft(t.if,{instancePath:e+"/if",parentData:t,parentDataProperty:"if",rootData:s})||(i=i===null?ft.errors:i.concat(ft.errors),o=i.length)),t.then!==void 0&&(ft(t.then,{instancePath:e+"/then",parentData:t,parentDataProperty:"then",rootData:s})||(i=i===null?ft.errors:i.concat(ft.errors),o=i.length)),t.else!==void 0&&(ft(t.else,{instancePath:e+"/else",parentData:t,parentDataProperty:"else",rootData:s})||(i=i===null?ft.errors:i.concat(ft.errors),o=i.length)),t.allOf!==void 0&&($i(t.allOf,{instancePath:e+"/allOf",parentData:t,parentDataProperty:"allOf",rootData:s})||(i=i===null?$i.errors:i.concat($i.errors),o=i.length)),t.anyOf!==void 0&&($i(t.anyOf,{instancePath:e+"/anyOf",parentData:t,parentDataProperty:"anyOf",rootData:s})||(i=i===null?$i.errors:i.concat($i.errors),o=i.length)),t.oneOf!==void 0&&($i(t.oneOf,{instancePath:e+"/oneOf",parentData:t,parentDataProperty:"oneOf",rootData:s})||(i=i===null?$i.errors:i.concat($i.errors),o=i.length)),t.not!==void 0&&(ft(t.not,{instancePath:e+"/not",parentData:t,parentDataProperty:"not",rootData:s})||(i=i===null?ft.errors:i.concat(ft.errors),o=i.length))}return ft.errors=i,o===0}function o0(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(!(t&&typeof t=="object"&&!Array.isArray(t))){const f={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:gt.type,parentSchema:gt,data:t};i===null?i=[f]:i.push(f),o++}const a=o;let c=!1,l=null;const u=o;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.path===void 0){const f={instancePath:e,schemaPath:"#/oneOf/0/required",keyword:"required",params:{missingProperty:"path"},message:"must have required property 'path'",schema:gt.oneOf[0].required,parentSchema:gt.oneOf[0],data:t};i===null?i=[f]:i.push(f),o++}for(const f in t)if(!(f==="id"||f==="path"||f==="purpose"||f==="intent_to_retain"||f==="filter"||f==="name")){const p={instancePath:e,schemaPath:"#/oneOf/0/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:f},message:"must NOT have additional properties",schema:!1,parentSchema:gt.oneOf[0],data:t};i===null?i=[p]:i.push(p),o++}if(t.id!==void 0){let f=t.id;if(typeof f!="string"){const p={instancePath:e+"/id",schemaPath:"#/oneOf/0/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string",schema:gt.oneOf[0].properties.id.type,parentSchema:gt.oneOf[0].properties.id,data:f};i===null?i=[p]:i.push(p),o++}}if(t.path!==void 0){let f=t.path;if(Array.isArray(f)){const p=f.length;for(let y=0;y<p;y++){let b=f[y];if(typeof b!="string"){const w={instancePath:e+"/path/"+y,schemaPath:"#/oneOf/0/properties/path/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:gt.oneOf[0].properties.path.items.type,parentSchema:gt.oneOf[0].properties.path.items,data:b};i===null?i=[w]:i.push(w),o++}}}else{const p={instancePath:e+"/path",schemaPath:"#/oneOf/0/properties/path/type",keyword:"type",params:{type:"array"},message:"must be array",schema:gt.oneOf[0].properties.path.type,parentSchema:gt.oneOf[0].properties.path,data:f};i===null?i=[p]:i.push(p),o++}}if(t.purpose!==void 0){let f=t.purpose;if(typeof f!="string"){const p={instancePath:e+"/purpose",schemaPath:"#/oneOf/0/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:gt.oneOf[0].properties.purpose.type,parentSchema:gt.oneOf[0].properties.purpose,data:f};i===null?i=[p]:i.push(p),o++}}if(t.intent_to_retain!==void 0){let f=t.intent_to_retain;if(typeof f!="boolean"){const p={instancePath:e+"/intent_to_retain",schemaPath:"#/oneOf/0/properties/intent_to_retain/type",keyword:"type",params:{type:"boolean"},message:"must be boolean",schema:gt.oneOf[0].properties.intent_to_retain.type,parentSchema:gt.oneOf[0].properties.intent_to_retain,data:f};i===null?i=[p]:i.push(p),o++}}if(t.filter!==void 0&&(ft(t.filter,{instancePath:e+"/filter",parentData:t,parentDataProperty:"filter",rootData:s})||(i=i===null?ft.errors:i.concat(ft.errors),o=i.length)),t.name!==void 0){let f=t.name;if(typeof f!="string"){const p={instancePath:e+"/name",schemaPath:"#/oneOf/0/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string",schema:gt.oneOf[0].properties.name.type,parentSchema:gt.oneOf[0].properties.name,data:f};i===null?i=[p]:i.push(p),o++}}}var h=u===o;h&&(c=!0,l=0);const d=o;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.path===void 0){const f={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:"path"},message:"must have required property 'path'",schema:gt.oneOf[1].required,parentSchema:gt.oneOf[1],data:t};i===null?i=[f]:i.push(f),o++}if(t.filter===void 0){const f={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:"filter"},message:"must have required property 'filter'",schema:gt.oneOf[1].required,parentSchema:gt.oneOf[1],data:t};i===null?i=[f]:i.push(f),o++}if(t.predicate===void 0){const f={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:"predicate"},message:"must have required property 'predicate'",schema:gt.oneOf[1].required,parentSchema:gt.oneOf[1],data:t};i===null?i=[f]:i.push(f),o++}for(const f in t)if(!(f==="id"||f==="path"||f==="purpose"||f==="intent_to_retain"||f==="filter"||f==="predicate"||f==="name")){const p={instancePath:e,schemaPath:"#/oneOf/1/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:f},message:"must NOT have additional properties",schema:!1,parentSchema:gt.oneOf[1],data:t};i===null?i=[p]:i.push(p),o++}if(t.id!==void 0){let f=t.id;if(typeof f!="string"){const p={instancePath:e+"/id",schemaPath:"#/oneOf/1/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string",schema:gt.oneOf[1].properties.id.type,parentSchema:gt.oneOf[1].properties.id,data:f};i===null?i=[p]:i.push(p),o++}}if(t.path!==void 0){let f=t.path;if(Array.isArray(f)){const p=f.length;for(let y=0;y<p;y++){let b=f[y];if(typeof b!="string"){const w={instancePath:e+"/path/"+y,schemaPath:"#/oneOf/1/properties/path/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:gt.oneOf[1].properties.path.items.type,parentSchema:gt.oneOf[1].properties.path.items,data:b};i===null?i=[w]:i.push(w),o++}}}else{const p={instancePath:e+"/path",schemaPath:"#/oneOf/1/properties/path/type",keyword:"type",params:{type:"array"},message:"must be array",schema:gt.oneOf[1].properties.path.type,parentSchema:gt.oneOf[1].properties.path,data:f};i===null?i=[p]:i.push(p),o++}}if(t.purpose!==void 0){let f=t.purpose;if(typeof f!="string"){const p={instancePath:e+"/purpose",schemaPath:"#/oneOf/1/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:gt.oneOf[1].properties.purpose.type,parentSchema:gt.oneOf[1].properties.purpose,data:f};i===null?i=[p]:i.push(p),o++}}if(t.intent_to_retain!==void 0){let f=t.intent_to_retain;if(typeof f!="boolean"){const p={instancePath:e+"/intent_to_retain",schemaPath:"#/oneOf/1/properties/intent_to_retain/type",keyword:"type",params:{type:"boolean"},message:"must be boolean",schema:gt.oneOf[1].properties.intent_to_retain.type,parentSchema:gt.oneOf[1].properties.intent_to_retain,data:f};i===null?i=[p]:i.push(p),o++}}if(t.filter!==void 0&&(ft(t.filter,{instancePath:e+"/filter",parentData:t,parentDataProperty:"filter",rootData:s})||(i=i===null?ft.errors:i.concat(ft.errors),o=i.length)),t.predicate!==void 0){let f=t.predicate;if(typeof f!="string"){const p={instancePath:e+"/predicate",schemaPath:"#/oneOf/1/properties/predicate/type",keyword:"type",params:{type:"string"},message:"must be string",schema:gt.oneOf[1].properties.predicate.type,parentSchema:gt.oneOf[1].properties.predicate,data:f};i===null?i=[p]:i.push(p),o++}if(!(f==="required"||f==="preferred")){const p={instancePath:e+"/predicate",schemaPath:"#/oneOf/1/properties/predicate/enum",keyword:"enum",params:{allowedValues:gt.oneOf[1].properties.predicate.enum},message:"must be equal to one of the allowed values",schema:gt.oneOf[1].properties.predicate.enum,parentSchema:gt.oneOf[1].properties.predicate,data:f};i===null?i=[p]:i.push(p),o++}}if(t.name!==void 0){let f=t.name;if(typeof f!="string"){const p={instancePath:e+"/name",schemaPath:"#/oneOf/1/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string",schema:gt.oneOf[1].properties.name.type,parentSchema:gt.oneOf[1].properties.name,data:f};i===null?i=[p]:i.push(p),o++}}}var h=d===o;if(h&&c?(c=!1,l=[l,1]):h&&(c=!0,l=1),c)o=a,i!==null&&(a?i.length=a:i=null);else{const f={instancePath:e,schemaPath:"#/oneOf",keyword:"oneOf",params:{passingSchemas:l},message:"must match exactly one schema in oneOf",schema:gt.oneOf,parentSchema:gt,data:t};i===null?i=[f]:i.push(f),o++}return o0.errors=i,o===0}function a0(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.id===void 0){const a={instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:"id"},message:"must have required property 'id'",schema:xe.required,parentSchema:xe,data:t};i===null?i=[a]:i.push(a),o++}for(const a in t)if(!(a==="id"||a==="name"||a==="purpose"||a==="issuance"||a==="group"||a==="format"||a==="constraints")){const c={instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:a},message:"must NOT have additional properties",schema:!1,parentSchema:xe,data:t};i===null?i=[c]:i.push(c),o++}if(t.id!==void 0){let a=t.id;if(typeof a!="string"){const c={instancePath:e+"/id",schemaPath:"#/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string",schema:xe.properties.id.type,parentSchema:xe.properties.id,data:a};i===null?i=[c]:i.push(c),o++}}if(t.name!==void 0){let a=t.name;if(typeof a!="string"){const c={instancePath:e+"/name",schemaPath:"#/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string",schema:xe.properties.name.type,parentSchema:xe.properties.name,data:a};i===null?i=[c]:i.push(c),o++}}if(t.purpose!==void 0){let a=t.purpose;if(typeof a!="string"){const c={instancePath:e+"/purpose",schemaPath:"#/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:xe.properties.purpose.type,parentSchema:xe.properties.purpose,data:a};i===null?i=[c]:i.push(c),o++}}if(t.issuance!==void 0){let a=t.issuance;if(Array.isArray(a)){const c=a.length;for(let l=0;l<c;l++)s0(a[l],{instancePath:e+"/issuance/"+l,parentData:a,parentDataProperty:l,rootData:s})||(i=i===null?s0.errors:i.concat(s0.errors),o=i.length)}else{const c={instancePath:e+"/issuance",schemaPath:"#/properties/issuance/type",keyword:"type",params:{type:"array"},message:"must be array",schema:xe.properties.issuance.type,parentSchema:xe.properties.issuance,data:a};i===null?i=[c]:i.push(c),o++}}if(t.group!==void 0){let a=t.group;if(Array.isArray(a)){const c=a.length;for(let l=0;l<c;l++){let u=a[l];if(typeof u!="string"){const d={instancePath:e+"/group/"+l,schemaPath:"#/properties/group/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:xe.properties.group.items.type,parentSchema:xe.properties.group.items,data:u};i===null?i=[d]:i.push(d),o++}}}else{const c={instancePath:e+"/group",schemaPath:"#/properties/group/type",keyword:"type",params:{type:"array"},message:"must be array",schema:xe.properties.group.type,parentSchema:xe.properties.group,data:a};i===null?i=[c]:i.push(c),o++}}if(t.format!==void 0&&(Nl(t.format,{instancePath:e+"/format",parentData:t,parentDataProperty:"format",rootData:s})||(i=i===null?Nl.errors:i.concat(Nl.errors),o=i.length)),t.constraints!==void 0){let a=t.constraints;if(a&&typeof a=="object"&&!Array.isArray(a)){for(const c in a)if(!(c==="limit_disclosure"||c==="statuses"||c==="fields"||c==="subject_is_issuer"||c==="is_holder"||c==="same_subject")){const l={instancePath:e+"/constraints",schemaPath:"#/properties/constraints/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:c},message:"must NOT have additional properties",schema:!1,parentSchema:xe.properties.constraints,data:a};i===null?i=[l]:i.push(l),o++}if(a.limit_disclosure!==void 0){let c=a.limit_disclosure;if(typeof c!="string"){const l={instancePath:e+"/constraints/limit_disclosure",schemaPath:"#/properties/constraints/properties/limit_disclosure/type",keyword:"type",params:{type:"string"},message:"must be string",schema:xe.properties.constraints.properties.limit_disclosure.type,parentSchema:xe.properties.constraints.properties.limit_disclosure,data:c};i===null?i=[l]:i.push(l),o++}if(!(c==="required"||c==="preferred")){const l={instancePath:e+"/constraints/limit_disclosure",schemaPath:"#/properties/constraints/properties/limit_disclosure/enum",keyword:"enum",params:{allowedValues:xe.properties.constraints.properties.limit_disclosure.enum},message:"must be equal to one of the allowed values",schema:xe.properties.constraints.properties.limit_disclosure.enum,parentSchema:xe.properties.constraints.properties.limit_disclosure,data:c};i===null?i=[l]:i.push(l),o++}}if(a.statuses!==void 0){let c=a.statuses;if(c&&typeof c=="object"&&!Array.isArray(c)){if(c.active!==void 0){let l=c.active;if(l&&typeof l=="object"&&!Array.isArray(l)){if(l.directive!==void 0){let u=l.directive;if(typeof u!="string"){const d={instancePath:e+"/constraints/statuses/active/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/active/properties/directive/type",keyword:"type",params:{type:"string"},message:"must be string",schema:xe.properties.constraints.properties.statuses.properties.active.properties.directive.type,parentSchema:xe.properties.constraints.properties.statuses.properties.active.properties.directive,data:u};i===null?i=[d]:i.push(d),o++}if(!(u==="required"||u==="allowed"||u==="disallowed")){const d={instancePath:e+"/constraints/statuses/active/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/active/properties/directive/enum",keyword:"enum",params:{allowedValues:xe.properties.constraints.properties.statuses.properties.active.properties.directive.enum},message:"must be equal to one of the allowed values",schema:xe.properties.constraints.properties.statuses.properties.active.properties.directive.enum,parentSchema:xe.properties.constraints.properties.statuses.properties.active.properties.directive,data:u};i===null?i=[d]:i.push(d),o++}}}else{const u={instancePath:e+"/constraints/statuses/active",schemaPath:"#/properties/constraints/properties/statuses/properties/active/type",keyword:"type",params:{type:"object"},message:"must be object",schema:xe.properties.constraints.properties.statuses.properties.active.type,parentSchema:xe.properties.constraints.properties.statuses.properties.active,data:l};i===null?i=[u]:i.push(u),o++}}if(c.suspended!==void 0){let l=c.suspended;if(l&&typeof l=="object"&&!Array.isArray(l)){if(l.directive!==void 0){let u=l.directive;if(typeof u!="string"){const d={instancePath:e+"/constraints/statuses/suspended/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/suspended/properties/directive/type",keyword:"type",params:{type:"string"},message:"must be string",schema:xe.properties.constraints.properties.statuses.properties.suspended.properties.directive.type,parentSchema:xe.properties.constraints.properties.statuses.properties.suspended.properties.directive,data:u};i===null?i=[d]:i.push(d),o++}if(!(u==="required"||u==="allowed"||u==="disallowed")){const d={instancePath:e+"/constraints/statuses/suspended/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/suspended/properties/directive/enum",keyword:"enum",params:{allowedValues:xe.properties.constraints.properties.statuses.properties.suspended.properties.directive.enum},message:"must be equal to one of the allowed values",schema:xe.properties.constraints.properties.statuses.properties.suspended.properties.directive.enum,parentSchema:xe.properties.constraints.properties.statuses.properties.suspended.properties.directive,data:u};i===null?i=[d]:i.push(d),o++}}}else{const u={instancePath:e+"/constraints/statuses/suspended",schemaPath:"#/properties/constraints/properties/statuses/properties/suspended/type",keyword:"type",params:{type:"object"},message:"must be object",schema:xe.properties.constraints.properties.statuses.properties.suspended.type,parentSchema:xe.properties.constraints.properties.statuses.properties.suspended,data:l};i===null?i=[u]:i.push(u),o++}}if(c.revoked!==void 0){let l=c.revoked;if(l&&typeof l=="object"&&!Array.isArray(l)){if(l.directive!==void 0){let u=l.directive;if(typeof u!="string"){const d={instancePath:e+"/constraints/statuses/revoked/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/revoked/properties/directive/type",keyword:"type",params:{type:"string"},message:"must be string",schema:xe.properties.constraints.properties.statuses.properties.revoked.properties.directive.type,parentSchema:xe.properties.constraints.properties.statuses.properties.revoked.properties.directive,data:u};i===null?i=[d]:i.push(d),o++}if(!(u==="required"||u==="allowed"||u==="disallowed")){const d={instancePath:e+"/constraints/statuses/revoked/directive",schemaPath:"#/properties/constraints/properties/statuses/properties/revoked/properties/directive/enum",keyword:"enum",params:{allowedValues:xe.properties.constraints.properties.statuses.properties.revoked.properties.directive.enum},message:"must be equal to one of the allowed values",schema:xe.properties.constraints.properties.statuses.properties.revoked.properties.directive.enum,parentSchema:xe.properties.constraints.properties.statuses.properties.revoked.properties.directive,data:u};i===null?i=[d]:i.push(d),o++}}}else{const u={instancePath:e+"/constraints/statuses/revoked",schemaPath:"#/properties/constraints/properties/statuses/properties/revoked/type",keyword:"type",params:{type:"object"},message:"must be object",schema:xe.properties.constraints.properties.statuses.properties.revoked.type,parentSchema:xe.properties.constraints.properties.statuses.properties.revoked,data:l};i===null?i=[u]:i.push(u),o++}}}else{const l={instancePath:e+"/constraints/statuses",schemaPath:"#/properties/constraints/properties/statuses/type",keyword:"type",params:{type:"object"},message:"must be object",schema:xe.properties.constraints.properties.statuses.type,parentSchema:xe.properties.constraints.properties.statuses,data:c};i===null?i=[l]:i.push(l),o++}}if(a.fields!==void 0){let c=a.fields;if(Array.isArray(c)){const l=c.length;for(let u=0;u<l;u++)o0(c[u],{instancePath:e+"/constraints/fields/"+u,parentData:c,parentDataProperty:u,rootData:s})||(i=i===null?o0.errors:i.concat(o0.errors),o=i.length)}else{const l={instancePath:e+"/constraints/fields",schemaPath:"#/properties/constraints/properties/fields/type",keyword:"type",params:{type:"array"},message:"must be array",schema:xe.properties.constraints.properties.fields.type,parentSchema:xe.properties.constraints.properties.fields,data:c};i===null?i=[l]:i.push(l),o++}}if(a.subject_is_issuer!==void 0){let c=a.subject_is_issuer;if(typeof c!="string"){const l={instancePath:e+"/constraints/subject_is_issuer",schemaPath:"#/properties/constraints/properties/subject_is_issuer/type",keyword:"type",params:{type:"string"},message:"must be string",schema:xe.properties.constraints.properties.subject_is_issuer.type,parentSchema:xe.properties.constraints.properties.subject_is_issuer,data:c};i===null?i=[l]:i.push(l),o++}if(!(c==="required"||c==="preferred")){const l={instancePath:e+"/constraints/subject_is_issuer",schemaPath:"#/properties/constraints/properties/subject_is_issuer/enum",keyword:"enum",params:{allowedValues:xe.properties.constraints.properties.subject_is_issuer.enum},message:"must be equal to one of the allowed values",schema:xe.properties.constraints.properties.subject_is_issuer.enum,parentSchema:xe.properties.constraints.properties.subject_is_issuer,data:c};i===null?i=[l]:i.push(l),o++}}if(a.is_holder!==void 0){let c=a.is_holder;if(Array.isArray(c)){const l=c.length;for(let u=0;u<l;u++){let d=c[u];if(d&&typeof d=="object"&&!Array.isArray(d)){if(d.field_id===void 0){const h={instancePath:e+"/constraints/is_holder/"+u,schemaPath:"#/properties/constraints/properties/is_holder/items/required",keyword:"required",params:{missingProperty:"field_id"},message:"must have required property 'field_id'",schema:xe.properties.constraints.properties.is_holder.items.required,parentSchema:xe.properties.constraints.properties.is_holder.items,data:d};i===null?i=[h]:i.push(h),o++}if(d.directive===void 0){const h={instancePath:e+"/constraints/is_holder/"+u,schemaPath:"#/properties/constraints/properties/is_holder/items/required",keyword:"required",params:{missingProperty:"directive"},message:"must have required property 'directive'",schema:xe.properties.constraints.properties.is_holder.items.required,parentSchema:xe.properties.constraints.properties.is_holder.items,data:d};i===null?i=[h]:i.push(h),o++}for(const h in d)if(!(h==="field_id"||h==="directive")){const f={instancePath:e+"/constraints/is_holder/"+u,schemaPath:"#/properties/constraints/properties/is_holder/items/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:h},message:"must NOT have additional properties",schema:!1,parentSchema:xe.properties.constraints.properties.is_holder.items,data:d};i===null?i=[f]:i.push(f),o++}if(d.field_id!==void 0){let h=d.field_id;if(Array.isArray(h)){const f=h.length;for(let p=0;p<f;p++){let y=h[p];if(typeof y!="string"){const b={instancePath:e+"/constraints/is_holder/"+u+"/field_id/"+p,schemaPath:"#/properties/constraints/properties/is_holder/items/properties/field_id/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:xe.properties.constraints.properties.is_holder.items.properties.field_id.items.type,parentSchema:xe.properties.constraints.properties.is_holder.items.properties.field_id.items,data:y};i===null?i=[b]:i.push(b),o++}}}else{const f={instancePath:e+"/constraints/is_holder/"+u+"/field_id",schemaPath:"#/properties/constraints/properties/is_holder/items/properties/field_id/type",keyword:"type",params:{type:"array"},message:"must be array",schema:xe.properties.constraints.properties.is_holder.items.properties.field_id.type,parentSchema:xe.properties.constraints.properties.is_holder.items.properties.field_id,data:h};i===null?i=[f]:i.push(f),o++}}if(d.directive!==void 0){let h=d.directive;if(typeof h!="string"){const f={instancePath:e+"/constraints/is_holder/"+u+"/directive",schemaPath:"#/properties/constraints/properties/is_holder/items/properties/directive/type",keyword:"type",params:{type:"string"},message:"must be string",schema:xe.properties.constraints.properties.is_holder.items.properties.directive.type,parentSchema:xe.properties.constraints.properties.is_holder.items.properties.directive,data:h};i===null?i=[f]:i.push(f),o++}if(!(h==="required"||h==="preferred")){const f={instancePath:e+"/constraints/is_holder/"+u+"/directive",schemaPath:"#/properties/constraints/properties/is_holder/items/properties/directive/enum",keyword:"enum",params:{allowedValues:xe.properties.constraints.properties.is_holder.items.properties.directive.enum},message:"must be equal to one of the allowed values",schema:xe.properties.constraints.properties.is_holder.items.properties.directive.enum,parentSchema:xe.properties.constraints.properties.is_holder.items.properties.directive,data:h};i===null?i=[f]:i.push(f),o++}}}else{const h={instancePath:e+"/constraints/is_holder/"+u,schemaPath:"#/properties/constraints/properties/is_holder/items/type",keyword:"type",params:{type:"object"},message:"must be object",schema:xe.properties.constraints.properties.is_holder.items.type,parentSchema:xe.properties.constraints.properties.is_holder.items,data:d};i===null?i=[h]:i.push(h),o++}}}else{const l={instancePath:e+"/constraints/is_holder",schemaPath:"#/properties/constraints/properties/is_holder/type",keyword:"type",params:{type:"array"},message:"must be array",schema:xe.properties.constraints.properties.is_holder.type,parentSchema:xe.properties.constraints.properties.is_holder,data:c};i===null?i=[l]:i.push(l),o++}}if(a.same_subject!==void 0){let c=a.same_subject;if(Array.isArray(c)){const l=c.length;for(let u=0;u<l;u++){let d=c[u];if(d&&typeof d=="object"&&!Array.isArray(d)){if(d.field_id===void 0){const h={instancePath:e+"/constraints/same_subject/"+u,schemaPath:"#/properties/constraints/properties/same_subject/items/required",keyword:"required",params:{missingProperty:"field_id"},message:"must have required property 'field_id'",schema:xe.properties.constraints.properties.same_subject.items.required,parentSchema:xe.properties.constraints.properties.same_subject.items,data:d};i===null?i=[h]:i.push(h),o++}if(d.directive===void 0){const h={instancePath:e+"/constraints/same_subject/"+u,schemaPath:"#/properties/constraints/properties/same_subject/items/required",keyword:"required",params:{missingProperty:"directive"},message:"must have required property 'directive'",schema:xe.properties.constraints.properties.same_subject.items.required,parentSchema:xe.properties.constraints.properties.same_subject.items,data:d};i===null?i=[h]:i.push(h),o++}for(const h in d)if(!(h==="field_id"||h==="directive")){const f={instancePath:e+"/constraints/same_subject/"+u,schemaPath:"#/properties/constraints/properties/same_subject/items/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:h},message:"must NOT have additional properties",schema:!1,parentSchema:xe.properties.constraints.properties.same_subject.items,data:d};i===null?i=[f]:i.push(f),o++}if(d.field_id!==void 0){let h=d.field_id;if(Array.isArray(h)){const f=h.length;for(let p=0;p<f;p++){let y=h[p];if(typeof y!="string"){const b={instancePath:e+"/constraints/same_subject/"+u+"/field_id/"+p,schemaPath:"#/properties/constraints/properties/same_subject/items/properties/field_id/items/type",keyword:"type",params:{type:"string"},message:"must be string",schema:xe.properties.constraints.properties.same_subject.items.properties.field_id.items.type,parentSchema:xe.properties.constraints.properties.same_subject.items.properties.field_id.items,data:y};i===null?i=[b]:i.push(b),o++}}}else{const f={instancePath:e+"/constraints/same_subject/"+u+"/field_id",schemaPath:"#/properties/constraints/properties/same_subject/items/properties/field_id/type",keyword:"type",params:{type:"array"},message:"must be array",schema:xe.properties.constraints.properties.same_subject.items.properties.field_id.type,parentSchema:xe.properties.constraints.properties.same_subject.items.properties.field_id,data:h};i===null?i=[f]:i.push(f),o++}}if(d.directive!==void 0){let h=d.directive;if(typeof h!="string"){const f={instancePath:e+"/constraints/same_subject/"+u+"/directive",schemaPath:"#/properties/constraints/properties/same_subject/items/properties/directive/type",keyword:"type",params:{type:"string"},message:"must be string",schema:xe.properties.constraints.properties.same_subject.items.properties.directive.type,parentSchema:xe.properties.constraints.properties.same_subject.items.properties.directive,data:h};i===null?i=[f]:i.push(f),o++}if(!(h==="required"||h==="preferred")){const f={instancePath:e+"/constraints/same_subject/"+u+"/directive",schemaPath:"#/properties/constraints/properties/same_subject/items/properties/directive/enum",keyword:"enum",params:{allowedValues:xe.properties.constraints.properties.same_subject.items.properties.directive.enum},message:"must be equal to one of the allowed values",schema:xe.properties.constraints.properties.same_subject.items.properties.directive.enum,parentSchema:xe.properties.constraints.properties.same_subject.items.properties.directive,data:h};i===null?i=[f]:i.push(f),o++}}}else{const h={instancePath:e+"/constraints/same_subject/"+u,schemaPath:"#/properties/constraints/properties/same_subject/items/type",keyword:"type",params:{type:"object"},message:"must be object",schema:xe.properties.constraints.properties.same_subject.items.type,parentSchema:xe.properties.constraints.properties.same_subject.items,data:d};i===null?i=[h]:i.push(h),o++}}}else{const l={instancePath:e+"/constraints/same_subject",schemaPath:"#/properties/constraints/properties/same_subject/type",keyword:"type",params:{type:"array"},message:"must be array",schema:xe.properties.constraints.properties.same_subject.type,parentSchema:xe.properties.constraints.properties.same_subject,data:c};i===null?i=[l]:i.push(l),o++}}}else{const c={instancePath:e+"/constraints",schemaPath:"#/properties/constraints/type",keyword:"type",params:{type:"object"},message:"must be object",schema:xe.properties.constraints.type,parentSchema:xe.properties.constraints,data:a};i===null?i=[c]:i.push(c),o++}}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:xe.type,parentSchema:xe,data:t};i===null?i=[a]:i.push(a),o++}return a0.errors=i,o===0}function R_(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.presentation_definition!==void 0){let a=t.presentation_definition;if(a&&typeof a=="object"&&!Array.isArray(a)){if(a.id===void 0){const c={instancePath:e+"/presentation_definition",schemaPath:"#/properties/presentation_definition/required",keyword:"required",params:{missingProperty:"id"},message:"must have required property 'id'",schema:Or.properties.presentation_definition.required,parentSchema:Or.properties.presentation_definition,data:a};i===null?i=[c]:i.push(c),o++}if(a.input_descriptors===void 0){const c={instancePath:e+"/presentation_definition",schemaPath:"#/properties/presentation_definition/required",keyword:"required",params:{missingProperty:"input_descriptors"},message:"must have required property 'input_descriptors'",schema:Or.properties.presentation_definition.required,parentSchema:Or.properties.presentation_definition,data:a};i===null?i=[c]:i.push(c),o++}for(const c in a)if(!(c==="id"||c==="name"||c==="purpose"||c==="format"||c==="frame"||c==="submission_requirements"||c==="input_descriptors")){const l={instancePath:e+"/presentation_definition",schemaPath:"#/properties/presentation_definition/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:c},message:"must NOT have additional properties",schema:!1,parentSchema:Or.properties.presentation_definition,data:a};i===null?i=[l]:i.push(l),o++}if(a.id!==void 0){let c=a.id;if(typeof c!="string"){const l={instancePath:e+"/presentation_definition/id",schemaPath:"#/properties/presentation_definition/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Or.properties.presentation_definition.properties.id.type,parentSchema:Or.properties.presentation_definition.properties.id,data:c};i===null?i=[l]:i.push(l),o++}}if(a.name!==void 0){let c=a.name;if(typeof c!="string"){const l={instancePath:e+"/presentation_definition/name",schemaPath:"#/properties/presentation_definition/properties/name/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Or.properties.presentation_definition.properties.name.type,parentSchema:Or.properties.presentation_definition.properties.name,data:c};i===null?i=[l]:i.push(l),o++}}if(a.purpose!==void 0){let c=a.purpose;if(typeof c!="string"){const l={instancePath:e+"/presentation_definition/purpose",schemaPath:"#/properties/presentation_definition/properties/purpose/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Or.properties.presentation_definition.properties.purpose.type,parentSchema:Or.properties.presentation_definition.properties.purpose,data:c};i===null?i=[l]:i.push(l),o++}}if(a.format!==void 0&&(Nl(a.format,{instancePath:e+"/presentation_definition/format",parentData:a,parentDataProperty:"format",rootData:s})||(i=i===null?Nl.errors:i.concat(Nl.errors),o=i.length)),a.frame!==void 0){let c=a.frame;if(!(c&&typeof c=="object"&&!Array.isArray(c))){const l={instancePath:e+"/presentation_definition/frame",schemaPath:"#/properties/presentation_definition/properties/frame/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Or.properties.presentation_definition.properties.frame.type,parentSchema:Or.properties.presentation_definition.properties.frame,data:c};i===null?i=[l]:i.push(l),o++}}if(a.submission_requirements!==void 0){let c=a.submission_requirements;if(Array.isArray(c)){const l=c.length;for(let u=0;u<l;u++)Qp(c[u],{instancePath:e+"/presentation_definition/submission_requirements/"+u,parentData:c,parentDataProperty:u,rootData:s})||(i=i===null?Qp.errors:i.concat(Qp.errors),o=i.length)}else{const l={instancePath:e+"/presentation_definition/submission_requirements",schemaPath:"#/properties/presentation_definition/properties/submission_requirements/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Or.properties.presentation_definition.properties.submission_requirements.type,parentSchema:Or.properties.presentation_definition.properties.submission_requirements,data:c};i===null?i=[l]:i.push(l),o++}}if(a.input_descriptors!==void 0){let c=a.input_descriptors;if(Array.isArray(c)){const l=c.length;for(let u=0;u<l;u++)a0(c[u],{instancePath:e+"/presentation_definition/input_descriptors/"+u,parentData:c,parentDataProperty:u,rootData:s})||(i=i===null?a0.errors:i.concat(a0.errors),o=i.length)}else{const l={instancePath:e+"/presentation_definition/input_descriptors",schemaPath:"#/properties/presentation_definition/properties/input_descriptors/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Or.properties.presentation_definition.properties.input_descriptors.type,parentSchema:Or.properties.presentation_definition.properties.input_descriptors,data:c};i===null?i=[l]:i.push(l),o++}}}else{const c={instancePath:e+"/presentation_definition",schemaPath:"#/properties/presentation_definition/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Or.properties.presentation_definition.type,parentSchema:Or.properties.presentation_definition,data:a};i===null?i=[c]:i.push(c),o++}}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Or.type,parentSchema:Or,data:t};i===null?i=[a]:i.push(a),o++}return R_.errors=i,o===0}var PV=N_.exports;const yO=Jo(PV);function CV(t){return(Array.isArray(t.credentialSubject)?t.credentialSubject:[t.credentialSubject]).filter(r=>!!r.id).map(r=>r.id)}function kV(t){return Ci.isString(t.issuer)?t.issuer:t.issuer.id}function Gb(t){const e=JSON.parse(JSON.stringify(t));gs.changePropertyNameRecursively(e,"_const","const"),gs.changePropertyNameRecursively(e,"_enum","enum");const r={presentation_definition:e};let n=yO(r);return n?{version:Vs.v2}:(n=pO(r),n?{version:Vs.v1}:{error:"This is not a valid PresentationDefinition"})}function L0(t,e){let r=(t==null?void 0:t.map(n=>n.toLowerCase()).map(n=>n.startsWith("did:")?n:`did:${n}`))??[];return r.includes("did")?[]:r}function OV(t,e){const r=L0(e);return r.length===0||r.some(n=>t.toLowerCase().startsWith(n))}function TV(t,e){const r=L0(e);return r.length===0?t:r.flatMap(n=>t.filter(s=>s.toLowerCase().startsWith(n)))}class Yo{constructor(e){de(this,"_client");de(this,"nextHandler");this._client=e}setNext(e){return this.nextHandler=e,e}getNext(){return this.nextHandler}hasNext(){return this.nextHandler!=null}get client(){return this._client}get wrappedVcs(){return this._client.wrappedVcs}set wrappedVcs(e){this._client.wrappedVcs=e}get presentationSubmission(){return this._client.presentationSubmission}set presentationSubmission(e){this._client.presentationSubmission=e}getResults(){return this._client.results}updatePresentationSubmission(e){this._client.assertPresentationSubmission(),this.presentationSubmission.descriptor_map.forEach((r,n,s)=>{let i;this.getResults().filter(a=>a.status===$e.ERROR&&a.evaluator===this.getName()).find(a=>(i=zt.query(e,a.input_descriptor_path)[0],a.verifiable_credential_path===r.path&&(i==null?void 0:i.id)===r.id))&&delete s[n]})}removeDuplicate(e){return e.reduce((r,n)=>r.find(i=>i.input_descriptor_path===n.input_descriptor_path&&i.verifiable_credential_path===n.verifiable_credential_path)?r:r.concat([n]),[])}}var Zb={exports:{}},mO={},zs={},of={},uy={},St={},Ch={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.regexpCode=t.getEsmExportName=t.getProperty=t.safeStringify=t.stringify=t.strConcat=t.addCodeArg=t.str=t._=t.nil=t._Code=t.Name=t.IDENTIFIER=t._CodeOrName=void 0;class e{}t._CodeOrName=e,t.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class r extends e{constructor(g){if(super(),!t.IDENTIFIER.test(g))throw new Error("CodeGen: name must be a valid identifier");this.str=g}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}t.Name=r;class n extends e{constructor(g){super(),this._items=typeof g=="string"?[g]:g}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const g=this._items[0];return g===""||g==='""'}get str(){var g;return(g=this._str)!==null&&g!==void 0?g:this._str=this._items.reduce((v,m)=>`${v}${m}`,"")}get names(){var g;return(g=this._names)!==null&&g!==void 0?g:this._names=this._items.reduce((v,m)=>(m instanceof r&&(v[m.str]=(v[m.str]||0)+1),v),{})}}t._Code=n,t.nil=new n("");function s(w,...g){const v=[w[0]];let m=0;for(;m<g.length;)a(v,g[m]),v.push(w[++m]);return new n(v)}t._=s;const i=new n("+");function o(w,...g){const v=[f(w[0])];let m=0;for(;m<g.length;)v.push(i),a(v,g[m]),v.push(i,f(w[++m]));return c(v),new n(v)}t.str=o;function a(w,g){g instanceof n?w.push(...g._items):g instanceof r?w.push(g):w.push(d(g))}t.addCodeArg=a;function c(w){let g=1;for(;g<w.length-1;){if(w[g]===i){const v=l(w[g-1],w[g+1]);if(v!==void 0){w.splice(g-1,3,v);continue}w[g++]="+"}g++}}function l(w,g){if(g==='""')return w;if(w==='""')return g;if(typeof w=="string")return g instanceof r||w[w.length-1]!=='"'?void 0:typeof g!="string"?`${w.slice(0,-1)}${g}"`:g[0]==='"'?w.slice(0,-1)+g.slice(1):void 0;if(typeof g=="string"&&g[0]==='"'&&!(w instanceof r))return`"${w}${g.slice(1)}`}function u(w,g){return g.emptyStr()?w:w.emptyStr()?g:o`${w}${g}`}t.strConcat=u;function d(w){return typeof w=="number"||typeof w=="boolean"||w===null?w:f(Array.isArray(w)?w.join(","):w)}function h(w){return new n(f(w))}t.stringify=h;function f(w){return JSON.stringify(w).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}t.safeStringify=f;function p(w){return typeof w=="string"&&t.IDENTIFIER.test(w)?new n(`.${w}`):s`[${w}]`}t.getProperty=p;function y(w){if(typeof w=="string"&&t.IDENTIFIER.test(w))return new n(`${w}`);throw new Error(`CodeGen: invalid export name: ${w}, use explicit $id name mapping`)}t.getEsmExportName=y;function b(w){return new n(w.toString())}t.regexpCode=b})(Ch);var Xb={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ValueScope=t.ValueScopeName=t.Scope=t.varKinds=t.UsedValueState=void 0;const e=Ch;class r extends Error{constructor(l){super(`CodeGen: "code" for ${l} not defined`),this.value=l.value}}var n;(function(c){c[c.Started=0]="Started",c[c.Completed=1]="Completed"})(n||(t.UsedValueState=n={})),t.varKinds={const:new e.Name("const"),let:new e.Name("let"),var:new e.Name("var")};class s{constructor({prefixes:l,parent:u}={}){this._names={},this._prefixes=l,this._parent=u}toName(l){return l instanceof e.Name?l:this.name(l)}name(l){return new e.Name(this._newName(l))}_newName(l){const u=this._names[l]||this._nameGroup(l);return`${l}${u.index++}`}_nameGroup(l){var u,d;if(!((d=(u=this._parent)===null||u===void 0?void 0:u._prefixes)===null||d===void 0)&&d.has(l)||this._prefixes&&!this._prefixes.has(l))throw new Error(`CodeGen: prefix "${l}" is not allowed in this scope`);return this._names[l]={prefix:l,index:0}}}t.Scope=s;class i extends e.Name{constructor(l,u){super(u),this.prefix=l}setValue(l,{property:u,itemIndex:d}){this.value=l,this.scopePath=(0,e._)`.${new e.Name(u)}[${d}]`}}t.ValueScopeName=i;const o=(0,e._)`\n`;class a extends s{constructor(l){super(l),this._values={},this._scope=l.scope,this.opts={...l,_n:l.lines?o:e.nil}}get(){return this._scope}name(l){return new i(l,this._newName(l))}value(l,u){var d;if(u.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const h=this.toName(l),{prefix:f}=h,p=(d=u.key)!==null&&d!==void 0?d:u.ref;let y=this._values[f];if(y){const g=y.get(p);if(g)return g}else y=this._values[f]=new Map;y.set(p,h);const b=this._scope[f]||(this._scope[f]=[]),w=b.length;return b[w]=u.ref,h.setValue(u,{property:f,itemIndex:w}),h}getValue(l,u){const d=this._values[l];if(d)return d.get(u)}scopeRefs(l,u=this._values){return this._reduceValues(u,d=>{if(d.scopePath===void 0)throw new Error(`CodeGen: name "${d}" has no value`);return(0,e._)`${l}${d.scopePath}`})}scopeCode(l=this._values,u,d){return this._reduceValues(l,h=>{if(h.value===void 0)throw new Error(`CodeGen: name "${h}" has no value`);return h.value.code},u,d)}_reduceValues(l,u,d={},h){let f=e.nil;for(const p in l){const y=l[p];if(!y)continue;const b=d[p]=d[p]||new Map;y.forEach(w=>{if(b.has(w))return;b.set(w,n.Started);let g=u(w);if(g){const v=this.opts.es5?t.varKinds.var:t.varKinds.const;f=(0,e._)`${f}${v} ${w} = ${g};${this.opts._n}`}else if(g=h==null?void 0:h(w))f=(0,e._)`${f}${g}${this.opts._n}`;else throw new r(w);b.set(w,n.Completed)})}return f}}t.ValueScope=a})(Xb);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.or=t.and=t.not=t.CodeGen=t.operators=t.varKinds=t.ValueScopeName=t.ValueScope=t.Scope=t.Name=t.regexpCode=t.stringify=t.getProperty=t.nil=t.strConcat=t.str=t._=void 0;const e=Ch,r=Xb;var n=Ch;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(t,"strConcat",{enumerable:!0,get:function(){return n.strConcat}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(t,"getProperty",{enumerable:!0,get:function(){return n.getProperty}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(t,"regexpCode",{enumerable:!0,get:function(){return n.regexpCode}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return n.Name}});var s=Xb;Object.defineProperty(t,"Scope",{enumerable:!0,get:function(){return s.Scope}}),Object.defineProperty(t,"ValueScope",{enumerable:!0,get:function(){return s.ValueScope}}),Object.defineProperty(t,"ValueScopeName",{enumerable:!0,get:function(){return s.ValueScopeName}}),Object.defineProperty(t,"varKinds",{enumerable:!0,get:function(){return s.varKinds}}),t.operators={GT:new e._Code(">"),GTE:new e._Code(">="),LT:new e._Code("<"),LTE:new e._Code("<="),EQ:new e._Code("==="),NEQ:new e._Code("!=="),NOT:new e._Code("!"),OR:new e._Code("||"),AND:new e._Code("&&"),ADD:new e._Code("+")};class i{optimizeNodes(){return this}optimizeNames($,T){return this}}class o extends i{constructor($,T,z){super(),this.varKind=$,this.name=T,this.rhs=z}render({es5:$,_n:T}){const z=$?r.varKinds.var:this.varKind,ne=this.rhs===void 0?"":` = ${this.rhs}`;return`${z} ${this.name}${ne};`+T}optimizeNames($,T){if($[this.name.str])return this.rhs&&(this.rhs=j(this.rhs,$,T)),this}get names(){return this.rhs instanceof e._CodeOrName?this.rhs.names:{}}}class a extends i{constructor($,T,z){super(),this.lhs=$,this.rhs=T,this.sideEffects=z}render({_n:$}){return`${this.lhs} = ${this.rhs};`+$}optimizeNames($,T){if(!(this.lhs instanceof e.Name&&!$[this.lhs.str]&&!this.sideEffects))return this.rhs=j(this.rhs,$,T),this}get names(){const $=this.lhs instanceof e.Name?{}:{...this.lhs.names};return N($,this.rhs)}}class c extends a{constructor($,T,z,ne){super($,z,ne),this.op=T}render({_n:$}){return`${this.lhs} ${this.op}= ${this.rhs};`+$}}class l extends i{constructor($){super(),this.label=$,this.names={}}render({_n:$}){return`${this.label}:`+$}}class u extends i{constructor($){super(),this.label=$,this.names={}}render({_n:$}){return`break${this.label?` ${this.label}`:""};`+$}}class d extends i{constructor($){super(),this.error=$}render({_n:$}){return`throw ${this.error};`+$}get names(){return this.error.names}}class h extends i{constructor($){super(),this.code=$}render({_n:$}){return`${this.code};`+$}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames($,T){return this.code=j(this.code,$,T),this}get names(){return this.code instanceof e._CodeOrName?this.code.names:{}}}class f extends i{constructor($=[]){super(),this.nodes=$}render($){return this.nodes.reduce((T,z)=>T+z.render($),"")}optimizeNodes(){const{nodes:$}=this;let T=$.length;for(;T--;){const z=$[T].optimizeNodes();Array.isArray(z)?$.splice(T,1,...z):z?$[T]=z:$.splice(T,1)}return $.length>0?this:void 0}optimizeNames($,T){const{nodes:z}=this;let ne=z.length;for(;ne--;){const ue=z[ne];ue.optimizeNames($,T)||(F($,ue.names),z.splice(ne,1))}return z.length>0?this:void 0}get names(){return this.nodes.reduce(($,T)=>I($,T.names),{})}}class p extends f{render($){return"{"+$._n+super.render($)+"}"+$._n}}class y extends f{}class b extends p{}b.kind="else";class w extends p{constructor($,T){super(T),this.condition=$}render($){let T=`if(${this.condition})`+super.render($);return this.else&&(T+="else "+this.else.render($)),T}optimizeNodes(){super.optimizeNodes();const $=this.condition;if($===!0)return this.nodes;let T=this.else;if(T){const z=T.optimizeNodes();T=this.else=Array.isArray(z)?new b(z):z}if(T)return $===!1?T instanceof w?T:T.nodes:this.nodes.length?this:new w(V($),T instanceof w?[T]:T.nodes);if(!($===!1||!this.nodes.length))return this}optimizeNames($,T){var z;if(this.else=(z=this.else)===null||z===void 0?void 0:z.optimizeNames($,T),!!(super.optimizeNames($,T)||this.else))return this.condition=j(this.condition,$,T),this}get names(){const $=super.names;return N($,this.condition),this.else&&I($,this.else.names),$}}w.kind="if";class g extends p{}g.kind="for";class v extends g{constructor($){super(),this.iteration=$}render($){return`for(${this.iteration})`+super.render($)}optimizeNames($,T){if(super.optimizeNames($,T))return this.iteration=j(this.iteration,$,T),this}get names(){return I(super.names,this.iteration.names)}}class m extends g{constructor($,T,z,ne){super(),this.varKind=$,this.name=T,this.from=z,this.to=ne}render($){const T=$.es5?r.varKinds.var:this.varKind,{name:z,from:ne,to:ue}=this;return`for(${T} ${z}=${ne}; ${z}<${ue}; ${z}++)`+super.render($)}get names(){const $=N(super.names,this.from);return N($,this.to)}}class _ extends g{constructor($,T,z,ne){super(),this.loop=$,this.varKind=T,this.name=z,this.iterable=ne}render($){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render($)}optimizeNames($,T){if(super.optimizeNames($,T))return this.iterable=j(this.iterable,$,T),this}get names(){return I(super.names,this.iterable.names)}}class x extends p{constructor($,T,z){super(),this.name=$,this.args=T,this.async=z}render($){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render($)}}x.kind="func";class D extends f{render($){return"return "+super.render($)}}D.kind="return";class E extends p{render($){let T="try"+super.render($);return this.catch&&(T+=this.catch.render($)),this.finally&&(T+=this.finally.render($)),T}optimizeNodes(){var $,T;return super.optimizeNodes(),($=this.catch)===null||$===void 0||$.optimizeNodes(),(T=this.finally)===null||T===void 0||T.optimizeNodes(),this}optimizeNames($,T){var z,ne;return super.optimizeNames($,T),(z=this.catch)===null||z===void 0||z.optimizeNames($,T),(ne=this.finally)===null||ne===void 0||ne.optimizeNames($,T),this}get names(){const $=super.names;return this.catch&&I($,this.catch.names),this.finally&&I($,this.finally.names),$}}class A extends p{constructor($){super(),this.error=$}render($){return`catch(${this.error})`+super.render($)}}A.kind="catch";class S extends p{render($){return"finally"+super.render($)}}S.kind="finally";class O{constructor($,T={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...T,_n:T.lines?`
`:""},this._extScope=$,this._scope=new r.Scope({parent:$}),this._nodes=[new y]}toString(){return this._root.render(this.opts)}name($){return this._scope.name($)}scopeName($){return this._extScope.name($)}scopeValue($,T){const z=this._extScope.value($,T);return(this._values[z.prefix]||(this._values[z.prefix]=new Set)).add(z),z}getScopeValue($,T){return this._extScope.getValue($,T)}scopeRefs($){return this._extScope.scopeRefs($,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def($,T,z,ne){const ue=this._scope.toName(T);return z!==void 0&&ne&&(this._constants[ue.str]=z),this._leafNode(new o($,ue,z)),ue}const($,T,z){return this._def(r.varKinds.const,$,T,z)}let($,T,z){return this._def(r.varKinds.let,$,T,z)}var($,T,z){return this._def(r.varKinds.var,$,T,z)}assign($,T,z){return this._leafNode(new a($,T,z))}add($,T){return this._leafNode(new c($,t.operators.ADD,T))}code($){return typeof $=="function"?$():$!==e.nil&&this._leafNode(new h($)),this}object(...$){const T=["{"];for(const[z,ne]of $)T.length>1&&T.push(","),T.push(z),(z!==ne||this.opts.es5)&&(T.push(":"),(0,e.addCodeArg)(T,ne));return T.push("}"),new e._Code(T)}if($,T,z){if(this._blockNode(new w($)),T&&z)this.code(T).else().code(z).endIf();else if(T)this.code(T).endIf();else if(z)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf($){return this._elseNode(new w($))}else(){return this._elseNode(new b)}endIf(){return this._endBlockNode(w,b)}_for($,T){return this._blockNode($),T&&this.code(T).endFor(),this}for($,T){return this._for(new v($),T)}forRange($,T,z,ne,ue=this.opts.es5?r.varKinds.var:r.varKinds.let){const ye=this._scope.toName($);return this._for(new m(ue,ye,T,z),()=>ne(ye))}forOf($,T,z,ne=r.varKinds.const){const ue=this._scope.toName($);if(this.opts.es5){const ye=T instanceof e.Name?T:this.var("_arr",T);return this.forRange("_i",0,(0,e._)`${ye}.length`,_e=>{this.var(ue,(0,e._)`${ye}[${_e}]`),z(ue)})}return this._for(new _("of",ne,ue,T),()=>z(ue))}forIn($,T,z,ne=this.opts.es5?r.varKinds.var:r.varKinds.const){if(this.opts.ownProperties)return this.forOf($,(0,e._)`Object.keys(${T})`,z);const ue=this._scope.toName($);return this._for(new _("in",ne,ue,T),()=>z(ue))}endFor(){return this._endBlockNode(g)}label($){return this._leafNode(new l($))}break($){return this._leafNode(new u($))}return($){const T=new D;if(this._blockNode(T),this.code($),T.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(D)}try($,T,z){if(!T&&!z)throw new Error('CodeGen: "try" without "catch" and "finally"');const ne=new E;if(this._blockNode(ne),this.code($),T){const ue=this.name("e");this._currNode=ne.catch=new A(ue),T(ue)}return z&&(this._currNode=ne.finally=new S,this.code(z)),this._endBlockNode(A,S)}throw($){return this._leafNode(new d($))}block($,T){return this._blockStarts.push(this._nodes.length),$&&this.code($).endBlock(T),this}endBlock($){const T=this._blockStarts.pop();if(T===void 0)throw new Error("CodeGen: not in self-balancing block");const z=this._nodes.length-T;if(z<0||$!==void 0&&z!==$)throw new Error(`CodeGen: wrong number of nodes: ${z} vs ${$} expected`);return this._nodes.length=T,this}func($,T=e.nil,z,ne){return this._blockNode(new x($,T,z)),ne&&this.code(ne).endFunc(),this}endFunc(){return this._endBlockNode(x)}optimize($=1){for(;$-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode($){return this._currNode.nodes.push($),this}_blockNode($){this._currNode.nodes.push($),this._nodes.push($)}_endBlockNode($,T){const z=this._currNode;if(z instanceof $||T&&z instanceof T)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${T?`${$.kind}/${T.kind}`:$.kind}"`)}_elseNode($){const T=this._currNode;if(!(T instanceof w))throw new Error('CodeGen: "else" without "if"');return this._currNode=T.else=$,this}get _root(){return this._nodes[0]}get _currNode(){const $=this._nodes;return $[$.length-1]}set _currNode($){const T=this._nodes;T[T.length-1]=$}}t.CodeGen=O;function I(U,$){for(const T in $)U[T]=(U[T]||0)+($[T]||0);return U}function N(U,$){return $ instanceof e._CodeOrName?I(U,$.names):U}function j(U,$,T){if(U instanceof e.Name)return z(U);if(!ne(U))return U;return new e._Code(U._items.reduce((ue,ye)=>(ye instanceof e.Name&&(ye=z(ye)),ye instanceof e._Code?ue.push(...ye._items):ue.push(ye),ue),[]));function z(ue){const ye=T[ue.str];return ye===void 0||$[ue.str]!==1?ue:(delete $[ue.str],ye)}function ne(ue){return ue instanceof e._Code&&ue._items.some(ye=>ye instanceof e.Name&&$[ye.str]===1&&T[ye.str]!==void 0)}}function F(U,$){for(const T in $)U[T]=(U[T]||0)-($[T]||0)}function V(U){return typeof U=="boolean"||typeof U=="number"||U===null?!U:(0,e._)`!${H(U)}`}t.not=V;const ee=k(t.operators.AND);function G(...U){return U.reduce(ee)}t.and=G;const Z=k(t.operators.OR);function M(...U){return U.reduce(Z)}t.or=M;function k(U){return($,T)=>$===e.nil?T:T===e.nil?$:(0,e._)`${H($)} ${U} ${H(T)}`}function H(U){return U instanceof e.Name?U:(0,e._)`(${U})`}})(St);var Fe={};Object.defineProperty(Fe,"__esModule",{value:!0});Fe.checkStrictMode=Fe.getErrorPath=Fe.Type=Fe.useFunc=Fe.setEvaluated=Fe.evaluatedPropsToName=Fe.mergeEvaluated=Fe.eachItem=Fe.unescapeJsonPointer=Fe.escapeJsonPointer=Fe.escapeFragment=Fe.unescapeFragment=Fe.schemaRefOrVal=Fe.schemaHasRulesButRef=Fe.schemaHasRules=Fe.checkUnknownRules=Fe.alwaysValidSchema=Fe.toHash=void 0;const ar=St,IV=Ch;function BV(t){const e={};for(const r of t)e[r]=!0;return e}Fe.toHash=BV;function FV(t,e){return typeof e=="boolean"?e:Object.keys(e).length===0?!0:(gO(t,e),!vO(e,t.self.RULES.all))}Fe.alwaysValidSchema=FV;function gO(t,e=t.schema){const{opts:r,self:n}=t;if(!r.strictSchema||typeof e=="boolean")return;const s=n.RULES.keywords;for(const i in e)s[i]||_O(t,`unknown keyword: "${i}"`)}Fe.checkUnknownRules=gO;function vO(t,e){if(typeof t=="boolean")return!t;for(const r in t)if(e[r])return!0;return!1}Fe.schemaHasRules=vO;function NV(t,e){if(typeof t=="boolean")return!t;for(const r in t)if(r!=="$ref"&&e.all[r])return!0;return!1}Fe.schemaHasRulesButRef=NV;function RV({topSchemaRef:t,schemaPath:e},r,n,s){if(!s){if(typeof r=="number"||typeof r=="boolean")return r;if(typeof r=="string")return(0,ar._)`${r}`}return(0,ar._)`${t}${e}${(0,ar.getProperty)(n)}`}Fe.schemaRefOrVal=RV;function jV(t){return wO(decodeURIComponent(t))}Fe.unescapeFragment=jV;function MV(t){return encodeURIComponent(j_(t))}Fe.escapeFragment=MV;function j_(t){return typeof t=="number"?`${t}`:t.replace(/~/g,"~0").replace(/\//g,"~1")}Fe.escapeJsonPointer=j_;function wO(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}Fe.unescapeJsonPointer=wO;function UV(t,e){if(Array.isArray(t))for(const r of t)e(r);else e(t)}Fe.eachItem=UV;function ox({mergeNames:t,mergeToName:e,mergeValues:r,resultToName:n}){return(s,i,o,a)=>{const c=o===void 0?i:o instanceof ar.Name?(i instanceof ar.Name?t(s,i,o):e(s,i,o),o):i instanceof ar.Name?(e(s,o,i),i):r(i,o);return a===ar.Name&&!(c instanceof ar.Name)?n(s,c):c}}Fe.mergeEvaluated={props:ox({mergeNames:(t,e,r)=>t.if((0,ar._)`${r} !== true && ${e} !== undefined`,()=>{t.if((0,ar._)`${e} === true`,()=>t.assign(r,!0),()=>t.assign(r,(0,ar._)`${r} || {}`).code((0,ar._)`Object.assign(${r}, ${e})`))}),mergeToName:(t,e,r)=>t.if((0,ar._)`${r} !== true`,()=>{e===!0?t.assign(r,!0):(t.assign(r,(0,ar._)`${r} || {}`),M_(t,r,e))}),mergeValues:(t,e)=>t===!0?!0:{...t,...e},resultToName:bO}),items:ox({mergeNames:(t,e,r)=>t.if((0,ar._)`${r} !== true && ${e} !== undefined`,()=>t.assign(r,(0,ar._)`${e} === true ? true : ${r} > ${e} ? ${r} : ${e}`)),mergeToName:(t,e,r)=>t.if((0,ar._)`${r} !== true`,()=>t.assign(r,e===!0?!0:(0,ar._)`${r} > ${e} ? ${r} : ${e}`)),mergeValues:(t,e)=>t===!0?!0:Math.max(t,e),resultToName:(t,e)=>t.var("items",e)})};function bO(t,e){if(e===!0)return t.var("props",!0);const r=t.var("props",(0,ar._)`{}`);return e!==void 0&&M_(t,r,e),r}Fe.evaluatedPropsToName=bO;function M_(t,e,r){Object.keys(r).forEach(n=>t.assign((0,ar._)`${e}${(0,ar.getProperty)(n)}`,!0))}Fe.setEvaluated=M_;const ax={};function KV(t,e){return t.scopeValue("func",{ref:e,code:ax[e.code]||(ax[e.code]=new IV._Code(e.code))})}Fe.useFunc=KV;var Yb;(function(t){t[t.Num=0]="Num",t[t.Str=1]="Str"})(Yb||(Fe.Type=Yb={}));function LV(t,e,r){if(t instanceof ar.Name){const n=e===Yb.Num;return r?n?(0,ar._)`"[" + ${t} + "]"`:(0,ar._)`"['" + ${t} + "']"`:n?(0,ar._)`"/" + ${t}`:(0,ar._)`"/" + ${t}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,ar.getProperty)(t).toString():"/"+j_(t)}Fe.getErrorPath=LV;function _O(t,e,r=t.opts.strictSchema){if(r){if(e=`strict mode: ${e}`,r===!0)throw new Error(e);t.self.logger.warn(e)}}Fe.checkStrictMode=_O;var Qo={};Object.defineProperty(Qo,"__esModule",{value:!0});const Rn=St,qV={data:new Rn.Name("data"),valCxt:new Rn.Name("valCxt"),instancePath:new Rn.Name("instancePath"),parentData:new Rn.Name("parentData"),parentDataProperty:new Rn.Name("parentDataProperty"),rootData:new Rn.Name("rootData"),dynamicAnchors:new Rn.Name("dynamicAnchors"),vErrors:new Rn.Name("vErrors"),errors:new Rn.Name("errors"),this:new Rn.Name("this"),self:new Rn.Name("self"),scope:new Rn.Name("scope"),json:new Rn.Name("json"),jsonPos:new Rn.Name("jsonPos"),jsonLen:new Rn.Name("jsonLen"),jsonPart:new Rn.Name("jsonPart")};Qo.default=qV;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.extendErrors=t.resetErrorsCount=t.reportExtraError=t.reportError=t.keyword$DataError=t.keywordError=void 0;const e=St,r=Fe,n=Qo;t.keywordError={message:({keyword:b})=>(0,e.str)`must pass "${b}" keyword validation`},t.keyword$DataError={message:({keyword:b,schemaType:w})=>w?(0,e.str)`"${b}" keyword must be ${w} ($data)`:(0,e.str)`"${b}" keyword is invalid ($data)`};function s(b,w=t.keywordError,g,v){const{it:m}=b,{gen:_,compositeRule:x,allErrors:D}=m,E=d(b,w,g);v??(x||D)?c(_,E):l(m,(0,e._)`[${E}]`)}t.reportError=s;function i(b,w=t.keywordError,g){const{it:v}=b,{gen:m,compositeRule:_,allErrors:x}=v,D=d(b,w,g);c(m,D),_||x||l(v,n.default.vErrors)}t.reportExtraError=i;function o(b,w){b.assign(n.default.errors,w),b.if((0,e._)`${n.default.vErrors} !== null`,()=>b.if(w,()=>b.assign((0,e._)`${n.default.vErrors}.length`,w),()=>b.assign(n.default.vErrors,null)))}t.resetErrorsCount=o;function a({gen:b,keyword:w,schemaValue:g,data:v,errsCount:m,it:_}){if(m===void 0)throw new Error("ajv implementation error");const x=b.name("err");b.forRange("i",m,n.default.errors,D=>{b.const(x,(0,e._)`${n.default.vErrors}[${D}]`),b.if((0,e._)`${x}.instancePath === undefined`,()=>b.assign((0,e._)`${x}.instancePath`,(0,e.strConcat)(n.default.instancePath,_.errorPath))),b.assign((0,e._)`${x}.schemaPath`,(0,e.str)`${_.errSchemaPath}/${w}`),_.opts.verbose&&(b.assign((0,e._)`${x}.schema`,g),b.assign((0,e._)`${x}.data`,v))})}t.extendErrors=a;function c(b,w){const g=b.const("err",w);b.if((0,e._)`${n.default.vErrors} === null`,()=>b.assign(n.default.vErrors,(0,e._)`[${g}]`),(0,e._)`${n.default.vErrors}.push(${g})`),b.code((0,e._)`${n.default.errors}++`)}function l(b,w){const{gen:g,validateName:v,schemaEnv:m}=b;m.$async?g.throw((0,e._)`new ${b.ValidationError}(${w})`):(g.assign((0,e._)`${v}.errors`,w),g.return(!1))}const u={keyword:new e.Name("keyword"),schemaPath:new e.Name("schemaPath"),params:new e.Name("params"),propertyName:new e.Name("propertyName"),message:new e.Name("message"),schema:new e.Name("schema"),parentSchema:new e.Name("parentSchema")};function d(b,w,g){const{createErrors:v}=b.it;return v===!1?(0,e._)`{}`:h(b,w,g)}function h(b,w,g={}){const{gen:v,it:m}=b,_=[f(m,g),p(b,g)];return y(b,w,_),v.object(..._)}function f({errorPath:b},{instancePath:w}){const g=w?(0,e.str)`${b}${(0,r.getErrorPath)(w,r.Type.Str)}`:b;return[n.default.instancePath,(0,e.strConcat)(n.default.instancePath,g)]}function p({keyword:b,it:{errSchemaPath:w}},{schemaPath:g,parentSchema:v}){let m=v?w:(0,e.str)`${w}/${b}`;return g&&(m=(0,e.str)`${m}${(0,r.getErrorPath)(g,r.Type.Str)}`),[u.schemaPath,m]}function y(b,{params:w,message:g},v){const{keyword:m,data:_,schemaValue:x,it:D}=b,{opts:E,propertyName:A,topSchemaRef:S,schemaPath:O}=D;v.push([u.keyword,m],[u.params,typeof w=="function"?w(b):w||(0,e._)`{}`]),E.messages&&v.push([u.message,typeof g=="function"?g(b):g]),E.verbose&&v.push([u.schema,x],[u.parentSchema,(0,e._)`${S}${O}`],[n.default.data,_]),A&&v.push([u.propertyName,A])}})(uy);Object.defineProperty(of,"__esModule",{value:!0});of.boolOrEmptySchema=of.topBoolOrEmptySchema=void 0;const VV=uy,zV=St,HV=Qo,WV={message:"boolean schema is false"};function JV(t){const{gen:e,schema:r,validateName:n}=t;r===!1?EO(t,!1):typeof r=="object"&&r.$async===!0?e.return(HV.default.data):(e.assign((0,zV._)`${n}.errors`,null),e.return(!0))}of.topBoolOrEmptySchema=JV;function GV(t,e){const{gen:r,schema:n}=t;n===!1?(r.var(e,!1),EO(t)):r.var(e,!0)}of.boolOrEmptySchema=GV;function EO(t,e){const{gen:r,data:n}=t,s={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,VV.reportError)(s,WV,void 0,e)}var Qr={},Wl={};Object.defineProperty(Wl,"__esModule",{value:!0});Wl.getRules=Wl.isJSONType=void 0;const ZV=["string","number","integer","boolean","null","object","array"],XV=new Set(ZV);function YV(t){return typeof t=="string"&&XV.has(t)}Wl.isJSONType=YV;function QV(){const t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...t,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}Wl.getRules=QV;var Ka={};Object.defineProperty(Ka,"__esModule",{value:!0});Ka.shouldUseRule=Ka.shouldUseGroup=Ka.schemaHasRulesForType=void 0;function ez({schema:t,self:e},r){const n=e.RULES.types[r];return n&&n!==!0&&AO(t,n)}Ka.schemaHasRulesForType=ez;function AO(t,e){return e.rules.some(r=>SO(t,r))}Ka.shouldUseGroup=AO;function SO(t,e){var r;return t[e.keyword]!==void 0||((r=e.definition.implements)===null||r===void 0?void 0:r.some(n=>t[n]!==void 0))}Ka.shouldUseRule=SO;Object.defineProperty(Qr,"__esModule",{value:!0});Qr.reportTypeError=Qr.checkDataTypes=Qr.checkDataType=Qr.coerceAndCheckDataType=Qr.getJSONTypes=Qr.getSchemaTypes=Qr.DataType=void 0;const tz=Wl,rz=Ka,nz=uy,wt=St,$O=Fe;var Vd;(function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong"})(Vd||(Qr.DataType=Vd={}));function iz(t){const e=xO(t.type);if(e.includes("null")){if(t.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&t.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');t.nullable===!0&&e.push("null")}return e}Qr.getSchemaTypes=iz;function xO(t){const e=Array.isArray(t)?t:t?[t]:[];if(e.every(tz.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}Qr.getJSONTypes=xO;function sz(t,e){const{gen:r,data:n,opts:s}=t,i=oz(e,s.coerceTypes),o=e.length>0&&!(i.length===0&&e.length===1&&(0,rz.schemaHasRulesForType)(t,e[0]));if(o){const a=U_(e,n,s.strictNumbers,Vd.Wrong);r.if(a,()=>{i.length?az(t,e,i):K_(t)})}return o}Qr.coerceAndCheckDataType=sz;const DO=new Set(["string","number","integer","boolean","null"]);function oz(t,e){return e?t.filter(r=>DO.has(r)||e==="array"&&r==="array"):[]}function az(t,e,r){const{gen:n,data:s,opts:i}=t,o=n.let("dataType",(0,wt._)`typeof ${s}`),a=n.let("coerced",(0,wt._)`undefined`);i.coerceTypes==="array"&&n.if((0,wt._)`${o} == 'object' && Array.isArray(${s}) && ${s}.length == 1`,()=>n.assign(s,(0,wt._)`${s}[0]`).assign(o,(0,wt._)`typeof ${s}`).if(U_(e,s,i.strictNumbers),()=>n.assign(a,s))),n.if((0,wt._)`${a} !== undefined`);for(const l of r)(DO.has(l)||l==="array"&&i.coerceTypes==="array")&&c(l);n.else(),K_(t),n.endIf(),n.if((0,wt._)`${a} !== undefined`,()=>{n.assign(s,a),uz(t,a)});function c(l){switch(l){case"string":n.elseIf((0,wt._)`${o} == "number" || ${o} == "boolean"`).assign(a,(0,wt._)`"" + ${s}`).elseIf((0,wt._)`${s} === null`).assign(a,(0,wt._)`""`);return;case"number":n.elseIf((0,wt._)`${o} == "boolean" || ${s} === null
              || (${o} == "string" && ${s} && ${s} == +${s})`).assign(a,(0,wt._)`+${s}`);return;case"integer":n.elseIf((0,wt._)`${o} === "boolean" || ${s} === null
              || (${o} === "string" && ${s} && ${s} == +${s} && !(${s} % 1))`).assign(a,(0,wt._)`+${s}`);return;case"boolean":n.elseIf((0,wt._)`${s} === "false" || ${s} === 0 || ${s} === null`).assign(a,!1).elseIf((0,wt._)`${s} === "true" || ${s} === 1`).assign(a,!0);return;case"null":n.elseIf((0,wt._)`${s} === "" || ${s} === 0 || ${s} === false`),n.assign(a,null);return;case"array":n.elseIf((0,wt._)`${o} === "string" || ${o} === "number"
              || ${o} === "boolean" || ${s} === null`).assign(a,(0,wt._)`[${s}]`)}}}function uz({gen:t,parentData:e,parentDataProperty:r},n){t.if((0,wt._)`${e} !== undefined`,()=>t.assign((0,wt._)`${e}[${r}]`,n))}function Qb(t,e,r,n=Vd.Correct){const s=n===Vd.Correct?wt.operators.EQ:wt.operators.NEQ;let i;switch(t){case"null":return(0,wt._)`${e} ${s} null`;case"array":i=(0,wt._)`Array.isArray(${e})`;break;case"object":i=(0,wt._)`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":i=o((0,wt._)`!(${e} % 1) && !isNaN(${e})`);break;case"number":i=o();break;default:return(0,wt._)`typeof ${e} ${s} ${t}`}return n===Vd.Correct?i:(0,wt.not)(i);function o(a=wt.nil){return(0,wt.and)((0,wt._)`typeof ${e} == "number"`,a,r?(0,wt._)`isFinite(${e})`:wt.nil)}}Qr.checkDataType=Qb;function U_(t,e,r,n){if(t.length===1)return Qb(t[0],e,r,n);let s;const i=(0,$O.toHash)(t);if(i.array&&i.object){const o=(0,wt._)`typeof ${e} != "object"`;s=i.null?o:(0,wt._)`!${e} || ${o}`,delete i.null,delete i.array,delete i.object}else s=wt.nil;i.number&&delete i.integer;for(const o in i)s=(0,wt.and)(s,Qb(o,e,r,n));return s}Qr.checkDataTypes=U_;const cz={message:({schema:t})=>`must be ${t}`,params:({schema:t,schemaValue:e})=>typeof t=="string"?(0,wt._)`{type: ${t}}`:(0,wt._)`{type: ${e}}`};function K_(t){const e=lz(t);(0,nz.reportError)(e,cz)}Qr.reportTypeError=K_;function lz(t){const{gen:e,data:r,schema:n}=t,s=(0,$O.schemaRefOrVal)(t,n,"type");return{gen:e,keyword:"type",data:r,schema:n.type,schemaCode:s,schemaValue:s,parentSchema:n,params:{},it:t}}var Rg={};Object.defineProperty(Rg,"__esModule",{value:!0});Rg.assignDefaults=void 0;const wd=St,dz=Fe;function fz(t,e){const{properties:r,items:n}=t.schema;if(e==="object"&&r)for(const s in r)ux(t,s,r[s].default);else e==="array"&&Array.isArray(n)&&n.forEach((s,i)=>ux(t,i,s.default))}Rg.assignDefaults=fz;function ux(t,e,r){const{gen:n,compositeRule:s,data:i,opts:o}=t;if(r===void 0)return;const a=(0,wd._)`${i}${(0,wd.getProperty)(e)}`;if(s){(0,dz.checkStrictMode)(t,`default is ignored for: ${a}`);return}let c=(0,wd._)`${a} === undefined`;o.useDefaults==="empty"&&(c=(0,wd._)`${c} || ${a} === null || ${a} === ""`),n.if(c,(0,wd._)`${a} = ${(0,wd.stringify)(r)}`)}var To={},Pt={};Object.defineProperty(Pt,"__esModule",{value:!0});Pt.validateUnion=Pt.validateArray=Pt.usePattern=Pt.callValidateCode=Pt.schemaProperties=Pt.allSchemaProperties=Pt.noPropertyInData=Pt.propertyInData=Pt.isOwnProperty=Pt.hasPropFunc=Pt.reportMissingProp=Pt.checkMissingProp=Pt.checkReportMissingProp=void 0;const hr=St,L_=Fe,Au=Qo,pz=Fe;function hz(t,e){const{gen:r,data:n,it:s}=t;r.if(V_(r,n,e,s.opts.ownProperties),()=>{t.setParams({missingProperty:(0,hr._)`${e}`},!0),t.error()})}Pt.checkReportMissingProp=hz;function yz({gen:t,data:e,it:{opts:r}},n,s){return(0,hr.or)(...n.map(i=>(0,hr.and)(V_(t,e,i,r.ownProperties),(0,hr._)`${s} = ${i}`)))}Pt.checkMissingProp=yz;function mz(t,e){t.setParams({missingProperty:e},!0),t.error()}Pt.reportMissingProp=mz;function PO(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,hr._)`Object.prototype.hasOwnProperty`})}Pt.hasPropFunc=PO;function q_(t,e,r){return(0,hr._)`${PO(t)}.call(${e}, ${r})`}Pt.isOwnProperty=q_;function gz(t,e,r,n){const s=(0,hr._)`${e}${(0,hr.getProperty)(r)} !== undefined`;return n?(0,hr._)`${s} && ${q_(t,e,r)}`:s}Pt.propertyInData=gz;function V_(t,e,r,n){const s=(0,hr._)`${e}${(0,hr.getProperty)(r)} === undefined`;return n?(0,hr.or)(s,(0,hr.not)(q_(t,e,r))):s}Pt.noPropertyInData=V_;function CO(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}Pt.allSchemaProperties=CO;function vz(t,e){return CO(e).filter(r=>!(0,L_.alwaysValidSchema)(t,e[r]))}Pt.schemaProperties=vz;function wz({schemaCode:t,data:e,it:{gen:r,topSchemaRef:n,schemaPath:s,errorPath:i},it:o},a,c,l){const u=l?(0,hr._)`${t}, ${e}, ${n}${s}`:e,d=[[Au.default.instancePath,(0,hr.strConcat)(Au.default.instancePath,i)],[Au.default.parentData,o.parentData],[Au.default.parentDataProperty,o.parentDataProperty],[Au.default.rootData,Au.default.rootData]];o.opts.dynamicRef&&d.push([Au.default.dynamicAnchors,Au.default.dynamicAnchors]);const h=(0,hr._)`${u}, ${r.object(...d)}`;return c!==hr.nil?(0,hr._)`${a}.call(${c}, ${h})`:(0,hr._)`${a}(${h})`}Pt.callValidateCode=wz;const bz=(0,hr._)`new RegExp`;function _z({gen:t,it:{opts:e}},r){const n=e.unicodeRegExp?"u":"",{regExp:s}=e.code,i=s(r,n);return t.scopeValue("pattern",{key:i.toString(),ref:i,code:(0,hr._)`${s.code==="new RegExp"?bz:(0,pz.useFunc)(t,s)}(${r}, ${n})`})}Pt.usePattern=_z;function Ez(t){const{gen:e,data:r,keyword:n,it:s}=t,i=e.name("valid");if(s.allErrors){const a=e.let("valid",!0);return o(()=>e.assign(a,!1)),a}return e.var(i,!0),o(()=>e.break()),i;function o(a){const c=e.const("len",(0,hr._)`${r}.length`);e.forRange("i",0,c,l=>{t.subschema({keyword:n,dataProp:l,dataPropType:L_.Type.Num},i),e.if((0,hr.not)(i),a)})}}Pt.validateArray=Ez;function Az(t){const{gen:e,schema:r,keyword:n,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(c=>(0,L_.alwaysValidSchema)(s,c))&&!s.opts.unevaluated)return;const o=e.let("valid",!1),a=e.name("_valid");e.block(()=>r.forEach((c,l)=>{const u=t.subschema({keyword:n,schemaProp:l,compositeRule:!0},a);e.assign(o,(0,hr._)`${o} || ${a}`),t.mergeValidEvaluated(u,a)||e.if((0,hr.not)(o))})),t.result(o,()=>t.reset(),()=>t.error(!0))}Pt.validateUnion=Az;Object.defineProperty(To,"__esModule",{value:!0});To.validateKeywordUsage=To.validSchemaType=To.funcKeywordCode=To.macroKeywordCode=void 0;const Jn=St,pl=Qo,Sz=Pt,$z=uy;function xz(t,e){const{gen:r,keyword:n,schema:s,parentSchema:i,it:o}=t,a=e.macro.call(o.self,s,i,o),c=kO(r,n,a);o.opts.validateSchema!==!1&&o.self.validateSchema(a,!0);const l=r.name("valid");t.subschema({schema:a,schemaPath:Jn.nil,errSchemaPath:`${o.errSchemaPath}/${n}`,topSchemaRef:c,compositeRule:!0},l),t.pass(l,()=>t.error(!0))}To.macroKeywordCode=xz;function Dz(t,e){var r;const{gen:n,keyword:s,schema:i,parentSchema:o,$data:a,it:c}=t;Cz(c,e);const l=!a&&e.compile?e.compile.call(c.self,i,o,c):e.validate,u=kO(n,s,l),d=n.let("valid");t.block$data(d,h),t.ok((r=e.valid)!==null&&r!==void 0?r:d);function h(){if(e.errors===!1)y(),e.modifying&&cx(t),b(()=>t.error());else{const w=e.async?f():p();e.modifying&&cx(t),b(()=>Pz(t,w))}}function f(){const w=n.let("ruleErrs",null);return n.try(()=>y((0,Jn._)`await `),g=>n.assign(d,!1).if((0,Jn._)`${g} instanceof ${c.ValidationError}`,()=>n.assign(w,(0,Jn._)`${g}.errors`),()=>n.throw(g))),w}function p(){const w=(0,Jn._)`${u}.errors`;return n.assign(w,null),y(Jn.nil),w}function y(w=e.async?(0,Jn._)`await `:Jn.nil){const g=c.opts.passContext?pl.default.this:pl.default.self,v=!("compile"in e&&!a||e.schema===!1);n.assign(d,(0,Jn._)`${w}${(0,Sz.callValidateCode)(t,u,g,v)}`,e.modifying)}function b(w){var g;n.if((0,Jn.not)((g=e.valid)!==null&&g!==void 0?g:d),w)}}To.funcKeywordCode=Dz;function cx(t){const{gen:e,data:r,it:n}=t;e.if(n.parentData,()=>e.assign(r,(0,Jn._)`${n.parentData}[${n.parentDataProperty}]`))}function Pz(t,e){const{gen:r}=t;r.if((0,Jn._)`Array.isArray(${e})`,()=>{r.assign(pl.default.vErrors,(0,Jn._)`${pl.default.vErrors} === null ? ${e} : ${pl.default.vErrors}.concat(${e})`).assign(pl.default.errors,(0,Jn._)`${pl.default.vErrors}.length`),(0,$z.extendErrors)(t)},()=>t.error())}function Cz({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function kO(t,e,r){if(r===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,Jn.stringify)(r)})}function kz(t,e,r=!1){return!e.length||e.some(n=>n==="array"?Array.isArray(t):n==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==n||r&&typeof t>"u")}To.validSchemaType=kz;function Oz({schema:t,opts:e,self:r,errSchemaPath:n},s,i){if(Array.isArray(s.keyword)?!s.keyword.includes(i):s.keyword!==i)throw new Error("ajv implementation error");const o=s.dependencies;if(o!=null&&o.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${i}: ${o.join(",")}`);if(s.validateSchema&&!s.validateSchema(t[i])){const c=`keyword "${i}" value is invalid at path "${n}": `+r.errorsText(s.validateSchema.errors);if(e.validateSchema==="log")r.logger.error(c);else throw new Error(c)}}To.validateKeywordUsage=Oz;var uc={};Object.defineProperty(uc,"__esModule",{value:!0});uc.extendSubschemaMode=uc.extendSubschemaData=uc.getSubschema=void 0;const Co=St,OO=Fe;function Tz(t,{keyword:e,schemaProp:r,schema:n,schemaPath:s,errSchemaPath:i,topSchemaRef:o}){if(e!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){const a=t.schema[e];return r===void 0?{schema:a,schemaPath:(0,Co._)`${t.schemaPath}${(0,Co.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[r],schemaPath:(0,Co._)`${t.schemaPath}${(0,Co.getProperty)(e)}${(0,Co.getProperty)(r)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,OO.escapeFragment)(r)}`}}if(n!==void 0){if(s===void 0||i===void 0||o===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:s,topSchemaRef:o,errSchemaPath:i}}throw new Error('either "keyword" or "schema" must be passed')}uc.getSubschema=Tz;function Iz(t,e,{dataProp:r,dataPropType:n,data:s,dataTypes:i,propertyName:o}){if(s!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:a}=e;if(r!==void 0){const{errorPath:l,dataPathArr:u,opts:d}=e,h=a.let("data",(0,Co._)`${e.data}${(0,Co.getProperty)(r)}`,!0);c(h),t.errorPath=(0,Co.str)`${l}${(0,OO.getErrorPath)(r,n,d.jsPropertySyntax)}`,t.parentDataProperty=(0,Co._)`${r}`,t.dataPathArr=[...u,t.parentDataProperty]}if(s!==void 0){const l=s instanceof Co.Name?s:a.let("data",s,!0);c(l),o!==void 0&&(t.propertyName=o)}i&&(t.dataTypes=i);function c(l){t.data=l,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,l]}}uc.extendSubschemaData=Iz;function Bz(t,{jtdDiscriminator:e,jtdMetadata:r,compositeRule:n,createErrors:s,allErrors:i}){n!==void 0&&(t.compositeRule=n),s!==void 0&&(t.createErrors=s),i!==void 0&&(t.allErrors=i),t.jtdDiscriminator=e,t.jtdMetadata=r}uc.extendSubschemaMode=Bz;var kn={},TO={exports:{}},nc=TO.exports=function(t,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var n=typeof r=="function"?r:r.pre||function(){},s=r.post||function(){};u0(e,n,s,t,"",t)};nc.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};nc.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};nc.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};nc.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function u0(t,e,r,n,s,i,o,a,c,l){if(n&&typeof n=="object"&&!Array.isArray(n)){e(n,s,i,o,a,c,l);for(var u in n){var d=n[u];if(Array.isArray(d)){if(u in nc.arrayKeywords)for(var h=0;h<d.length;h++)u0(t,e,r,d[h],s+"/"+u+"/"+h,i,s,u,n,h)}else if(u in nc.propsKeywords){if(d&&typeof d=="object")for(var f in d)u0(t,e,r,d[f],s+"/"+u+"/"+Fz(f),i,s,u,n,f)}else(u in nc.keywords||t.allKeys&&!(u in nc.skipKeywords))&&u0(t,e,r,d,s+"/"+u,i,s,u,n)}r(n,s,i,o,a,c,l)}}function Fz(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}var IO=TO.exports;Object.defineProperty(kn,"__esModule",{value:!0});kn.getSchemaRefs=kn.resolveUrl=kn.normalizeId=kn._getFullPath=kn.getFullPath=kn.inlineRef=void 0;const Nz=Fe,Rz=Ig,jz=IO,Mz=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function Uz(t,e=!0){return typeof t=="boolean"?!0:e===!0?!e1(t):e?BO(t)<=e:!1}kn.inlineRef=Uz;const Kz=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function e1(t){for(const e in t){if(Kz.has(e))return!0;const r=t[e];if(Array.isArray(r)&&r.some(e1)||typeof r=="object"&&e1(r))return!0}return!1}function BO(t){let e=0;for(const r in t){if(r==="$ref")return 1/0;if(e++,!Mz.has(r)&&(typeof t[r]=="object"&&(0,Nz.eachItem)(t[r],n=>e+=BO(n)),e===1/0))return 1/0}return e}function FO(t,e="",r){r!==!1&&(e=zd(e));const n=t.parse(e);return NO(t,n)}kn.getFullPath=FO;function NO(t,e){return t.serialize(e).split("#")[0]+"#"}kn._getFullPath=NO;const Lz=/#\/?$/;function zd(t){return t?t.replace(Lz,""):""}kn.normalizeId=zd;function qz(t,e,r){return r=zd(r),t.resolve(e,r)}kn.resolveUrl=qz;const Vz=/^[a-z_][-a-z0-9._]*$/i;function zz(t,e){if(typeof t=="boolean")return{};const{schemaId:r,uriResolver:n}=this.opts,s=zd(t[r]||e),i={"":s},o=FO(n,s,!1),a={},c=new Set;return jz(t,{allKeys:!0},(d,h,f,p)=>{if(p===void 0)return;const y=o+h;let b=i[p];typeof d[r]=="string"&&(b=w.call(this,d[r])),g.call(this,d.$anchor),g.call(this,d.$dynamicAnchor),i[h]=b;function w(v){const m=this.opts.uriResolver.resolve;if(v=zd(b?m(b,v):v),c.has(v))throw u(v);c.add(v);let _=this.refs[v];return typeof _=="string"&&(_=this.refs[_]),typeof _=="object"?l(d,_.schema,v):v!==zd(y)&&(v[0]==="#"?(l(d,a[v],v),a[v]=d):this.refs[v]=y),v}function g(v){if(typeof v=="string"){if(!Vz.test(v))throw new Error(`invalid anchor "${v}"`);w.call(this,`#${v}`)}}}),a;function l(d,h,f){if(h!==void 0&&!Rz(d,h))throw u(f)}function u(d){return new Error(`reference "${d}" resolves to more than one schema`)}}kn.getSchemaRefs=zz;Object.defineProperty(zs,"__esModule",{value:!0});zs.getData=zs.KeywordCxt=zs.validateFunctionCode=void 0;const RO=of,lx=Qr,z_=Ka,q0=Qr,Hz=Rg,eh=To,_w=uc,ze=St,pt=Qo,Wz=kn,La=Fe,yp=uy;function Jz(t){if(UO(t)&&(KO(t),MO(t))){Xz(t);return}jO(t,()=>(0,RO.topBoolOrEmptySchema)(t))}zs.validateFunctionCode=Jz;function jO({gen:t,validateName:e,schema:r,schemaEnv:n,opts:s},i){s.code.es5?t.func(e,(0,ze._)`${pt.default.data}, ${pt.default.valCxt}`,n.$async,()=>{t.code((0,ze._)`"use strict"; ${dx(r,s)}`),Zz(t,s),t.code(i)}):t.func(e,(0,ze._)`${pt.default.data}, ${Gz(s)}`,n.$async,()=>t.code(dx(r,s)).code(i))}function Gz(t){return(0,ze._)`{${pt.default.instancePath}="", ${pt.default.parentData}, ${pt.default.parentDataProperty}, ${pt.default.rootData}=${pt.default.data}${t.dynamicRef?(0,ze._)`, ${pt.default.dynamicAnchors}={}`:ze.nil}}={}`}function Zz(t,e){t.if(pt.default.valCxt,()=>{t.var(pt.default.instancePath,(0,ze._)`${pt.default.valCxt}.${pt.default.instancePath}`),t.var(pt.default.parentData,(0,ze._)`${pt.default.valCxt}.${pt.default.parentData}`),t.var(pt.default.parentDataProperty,(0,ze._)`${pt.default.valCxt}.${pt.default.parentDataProperty}`),t.var(pt.default.rootData,(0,ze._)`${pt.default.valCxt}.${pt.default.rootData}`),e.dynamicRef&&t.var(pt.default.dynamicAnchors,(0,ze._)`${pt.default.valCxt}.${pt.default.dynamicAnchors}`)},()=>{t.var(pt.default.instancePath,(0,ze._)`""`),t.var(pt.default.parentData,(0,ze._)`undefined`),t.var(pt.default.parentDataProperty,(0,ze._)`undefined`),t.var(pt.default.rootData,pt.default.data),e.dynamicRef&&t.var(pt.default.dynamicAnchors,(0,ze._)`{}`)})}function Xz(t){const{schema:e,opts:r,gen:n}=t;jO(t,()=>{r.$comment&&e.$comment&&qO(t),rH(t),n.let(pt.default.vErrors,null),n.let(pt.default.errors,0),r.unevaluated&&Yz(t),LO(t),sH(t)})}function Yz(t){const{gen:e,validateName:r}=t;t.evaluated=e.const("evaluated",(0,ze._)`${r}.evaluated`),e.if((0,ze._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,ze._)`${t.evaluated}.props`,(0,ze._)`undefined`)),e.if((0,ze._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,ze._)`${t.evaluated}.items`,(0,ze._)`undefined`))}function dx(t,e){const r=typeof t=="object"&&t[e.schemaId];return r&&(e.code.source||e.code.process)?(0,ze._)`/*# sourceURL=${r} */`:ze.nil}function Qz(t,e){if(UO(t)&&(KO(t),MO(t))){eH(t,e);return}(0,RO.boolOrEmptySchema)(t,e)}function MO({schema:t,self:e}){if(typeof t=="boolean")return!t;for(const r in t)if(e.RULES.all[r])return!0;return!1}function UO(t){return typeof t.schema!="boolean"}function eH(t,e){const{schema:r,gen:n,opts:s}=t;s.$comment&&r.$comment&&qO(t),nH(t),iH(t);const i=n.const("_errs",pt.default.errors);LO(t,i),n.var(e,(0,ze._)`${i} === ${pt.default.errors}`)}function KO(t){(0,La.checkUnknownRules)(t),tH(t)}function LO(t,e){if(t.opts.jtd)return fx(t,[],!1,e);const r=(0,lx.getSchemaTypes)(t.schema),n=(0,lx.coerceAndCheckDataType)(t,r);fx(t,r,!n,e)}function tH(t){const{schema:e,errSchemaPath:r,opts:n,self:s}=t;e.$ref&&n.ignoreKeywordsWithRef&&(0,La.schemaHasRulesButRef)(e,s.RULES)&&s.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function rH(t){const{schema:e,opts:r}=t;e.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,La.checkStrictMode)(t,"default is ignored in the schema root")}function nH(t){const e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,Wz.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function iH(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function qO({gen:t,schemaEnv:e,schema:r,errSchemaPath:n,opts:s}){const i=r.$comment;if(s.$comment===!0)t.code((0,ze._)`${pt.default.self}.logger.log(${i})`);else if(typeof s.$comment=="function"){const o=(0,ze.str)`${n}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,ze._)`${pt.default.self}.opts.$comment(${i}, ${o}, ${a}.schema)`)}}function sH(t){const{gen:e,schemaEnv:r,validateName:n,ValidationError:s,opts:i}=t;r.$async?e.if((0,ze._)`${pt.default.errors} === 0`,()=>e.return(pt.default.data),()=>e.throw((0,ze._)`new ${s}(${pt.default.vErrors})`)):(e.assign((0,ze._)`${n}.errors`,pt.default.vErrors),i.unevaluated&&oH(t),e.return((0,ze._)`${pt.default.errors} === 0`))}function oH({gen:t,evaluated:e,props:r,items:n}){r instanceof ze.Name&&t.assign((0,ze._)`${e}.props`,r),n instanceof ze.Name&&t.assign((0,ze._)`${e}.items`,n)}function fx(t,e,r,n){const{gen:s,schema:i,data:o,allErrors:a,opts:c,self:l}=t,{RULES:u}=l;if(i.$ref&&(c.ignoreKeywordsWithRef||!(0,La.schemaHasRulesButRef)(i,u))){s.block(()=>HO(t,"$ref",u.all.$ref.definition));return}c.jtd||aH(t,e),s.block(()=>{for(const h of u.rules)d(h);d(u.post)});function d(h){(0,z_.shouldUseGroup)(i,h)&&(h.type?(s.if((0,q0.checkDataType)(h.type,o,c.strictNumbers)),px(t,h),e.length===1&&e[0]===h.type&&r&&(s.else(),(0,q0.reportTypeError)(t)),s.endIf()):px(t,h),a||s.if((0,ze._)`${pt.default.errors} === ${n||0}`))}}function px(t,e){const{gen:r,schema:n,opts:{useDefaults:s}}=t;s&&(0,Hz.assignDefaults)(t,e.type),r.block(()=>{for(const i of e.rules)(0,z_.shouldUseRule)(n,i)&&HO(t,i.keyword,i.definition,e.type)})}function aH(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(uH(t,e),t.opts.allowUnionTypes||cH(t,e),lH(t,t.dataTypes))}function uH(t,e){if(e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(r=>{VO(t.dataTypes,r)||H_(t,`type "${r}" not allowed by context "${t.dataTypes.join(",")}"`)}),fH(t,e)}}function cH(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&H_(t,"use allowUnionTypes to allow union type keyword")}function lH(t,e){const r=t.self.RULES.all;for(const n in r){const s=r[n];if(typeof s=="object"&&(0,z_.shouldUseRule)(t.schema,s)){const{type:i}=s.definition;i.length&&!i.some(o=>dH(e,o))&&H_(t,`missing type "${i.join(",")}" for keyword "${n}"`)}}}function dH(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function VO(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function fH(t,e){const r=[];for(const n of t.dataTypes)VO(e,n)?r.push(n):e.includes("integer")&&n==="number"&&r.push("integer");t.dataTypes=r}function H_(t,e){const r=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${r}" (strictTypes)`,(0,La.checkStrictMode)(t,e,t.opts.strictTypes)}let zO=class{constructor(e,r,n){if((0,eh.validateKeywordUsage)(e,r,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=r.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,La.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=r,this.$data)this.schemaCode=e.gen.const("vSchema",WO(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,eh.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=e.gen.const("_errs",pt.default.errors))}result(e,r,n){this.failResult((0,ze.not)(e),r,n)}failResult(e,r,n){this.gen.if(e),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,r){this.failResult((0,ze.not)(e),void 0,r)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);const{schemaCode:r}=this;this.fail((0,ze._)`${r} !== undefined && (${(0,ze.or)(this.invalid$data(),e)})`)}error(e,r,n){if(r){this.setParams(r),this._error(e,n),this.setParams({});return}this._error(e,n)}_error(e,r){(e?yp.reportExtraError:yp.reportError)(this,this.def.error,r)}$dataError(){(0,yp.reportError)(this,this.def.$dataError||yp.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,yp.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,r){r?Object.assign(this.params,e):this.params=e}block$data(e,r,n=ze.nil){this.gen.block(()=>{this.check$data(e,n),r()})}check$data(e=ze.nil,r=ze.nil){if(!this.$data)return;const{gen:n,schemaCode:s,schemaType:i,def:o}=this;n.if((0,ze.or)((0,ze._)`${s} === undefined`,r)),e!==ze.nil&&n.assign(e,!0),(i.length||o.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==ze.nil&&n.assign(e,!1)),n.else()}invalid$data(){const{gen:e,schemaCode:r,schemaType:n,def:s,it:i}=this;return(0,ze.or)(o(),a());function o(){if(n.length){if(!(r instanceof ze.Name))throw new Error("ajv implementation error");const c=Array.isArray(n)?n:[n];return(0,ze._)`${(0,q0.checkDataTypes)(c,r,i.opts.strictNumbers,q0.DataType.Wrong)}`}return ze.nil}function a(){if(s.validateSchema){const c=e.scopeValue("validate$data",{ref:s.validateSchema});return(0,ze._)`!${c}(${r})`}return ze.nil}}subschema(e,r){const n=(0,_w.getSubschema)(this.it,e);(0,_w.extendSubschemaData)(n,this.it,e),(0,_w.extendSubschemaMode)(n,e);const s={...this.it,...n,items:void 0,props:void 0};return Qz(s,r),s}mergeEvaluated(e,r){const{it:n,gen:s}=this;n.opts.unevaluated&&(n.props!==!0&&e.props!==void 0&&(n.props=La.mergeEvaluated.props(s,e.props,n.props,r)),n.items!==!0&&e.items!==void 0&&(n.items=La.mergeEvaluated.items(s,e.items,n.items,r)))}mergeValidEvaluated(e,r){const{it:n,gen:s}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return s.if(r,()=>this.mergeEvaluated(e,ze.Name)),!0}};zs.KeywordCxt=zO;function HO(t,e,r,n){const s=new zO(t,r,e);"code"in r?r.code(s,n):s.$data&&r.validate?(0,eh.funcKeywordCode)(s,r):"macro"in r?(0,eh.macroKeywordCode)(s,r):(r.compile||r.validate)&&(0,eh.funcKeywordCode)(s,r)}const pH=/^\/(?:[^~]|~0|~1)*$/,hH=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function WO(t,{dataLevel:e,dataNames:r,dataPathArr:n}){let s,i;if(t==="")return pt.default.rootData;if(t[0]==="/"){if(!pH.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);s=t,i=pt.default.rootData}else{const l=hH.exec(t);if(!l)throw new Error(`Invalid JSON-pointer: ${t}`);const u=+l[1];if(s=l[2],s==="#"){if(u>=e)throw new Error(c("property/index",u));return n[e-u]}if(u>e)throw new Error(c("data",u));if(i=r[e-u],!s)return i}let o=i;const a=s.split("/");for(const l of a)l&&(i=(0,ze._)`${i}${(0,ze.getProperty)((0,La.unescapeJsonPointer)(l))}`,o=(0,ze._)`${o} && ${i}`);return o;function c(l,u){return`Cannot access ${l} ${u} levels up, current level is ${e}`}}zs.getData=WO;var cy={};Object.defineProperty(cy,"__esModule",{value:!0});let yH=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};cy.default=yH;var vf={};Object.defineProperty(vf,"__esModule",{value:!0});const Ew=kn;let mH=class extends Error{constructor(e,r,n,s){super(s||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,Ew.resolveUrl)(e,r,n),this.missingSchema=(0,Ew.normalizeId)((0,Ew.getFullPath)(e,this.missingRef))}};vf.default=mH;var gi={};Object.defineProperty(gi,"__esModule",{value:!0});gi.resolveSchema=gi.getCompilingSchema=gi.resolveRef=gi.compileSchema=gi.SchemaEnv=void 0;const Cs=St,gH=cy,Xc=Qo,Ms=kn,hx=Fe,vH=zs;let jg=class{constructor(e){var r;this.refs={},this.dynamicAnchors={};let n;typeof e.schema=="object"&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(r=e.baseId)!==null&&r!==void 0?r:(0,Ms.normalizeId)(n==null?void 0:n[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=n==null?void 0:n.$async,this.refs={}}};gi.SchemaEnv=jg;function W_(t){const e=JO.call(this,t);if(e)return e;const r=(0,Ms.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:n,lines:s}=this.opts.code,{ownProperties:i}=this.opts,o=new Cs.CodeGen(this.scope,{es5:n,lines:s,ownProperties:i});let a;t.$async&&(a=o.scopeValue("Error",{ref:gH.default,code:(0,Cs._)`require("ajv/dist/runtime/validation_error").default`}));const c=o.scopeName("validate");t.validateName=c;const l={gen:o,allErrors:this.opts.allErrors,data:Xc.default.data,parentData:Xc.default.parentData,parentDataProperty:Xc.default.parentDataProperty,dataNames:[Xc.default.data],dataPathArr:[Cs.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:o.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,Cs.stringify)(t.schema)}:{ref:t.schema}),validateName:c,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:r,baseId:t.baseId||r,schemaPath:Cs.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,Cs._)`""`,opts:this.opts,self:this};let u;try{this._compilations.add(t),(0,vH.validateFunctionCode)(l),o.optimize(this.opts.code.optimize);const d=o.toString();u=`${o.scopeRefs(Xc.default.scope)}return ${d}`,this.opts.code.process&&(u=this.opts.code.process(u,t));const f=new Function(`${Xc.default.self}`,`${Xc.default.scope}`,u)(this,this.scope.get());if(this.scope.value(c,{ref:f}),f.errors=null,f.schema=t.schema,f.schemaEnv=t,t.$async&&(f.$async=!0),this.opts.code.source===!0&&(f.source={validateName:c,validateCode:d,scopeValues:o._values}),this.opts.unevaluated){const{props:p,items:y}=l;f.evaluated={props:p instanceof Cs.Name?void 0:p,items:y instanceof Cs.Name?void 0:y,dynamicProps:p instanceof Cs.Name,dynamicItems:y instanceof Cs.Name},f.source&&(f.source.evaluated=(0,Cs.stringify)(f.evaluated))}return t.validate=f,t}catch(d){throw delete t.validate,delete t.validateName,u&&this.logger.error("Error compiling schema, function code:",u),d}finally{this._compilations.delete(t)}}gi.compileSchema=W_;function wH(t,e,r){var n;r=(0,Ms.resolveUrl)(this.opts.uriResolver,e,r);const s=t.refs[r];if(s)return s;let i=EH.call(this,t,r);if(i===void 0){const o=(n=t.localRefs)===null||n===void 0?void 0:n[r],{schemaId:a}=this.opts;o&&(i=new jg({schema:o,schemaId:a,root:t,baseId:e}))}if(i!==void 0)return t.refs[r]=bH.call(this,i)}gi.resolveRef=wH;function bH(t){return(0,Ms.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:W_.call(this,t)}function JO(t){for(const e of this._compilations)if(_H(e,t))return e}gi.getCompilingSchema=JO;function _H(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function EH(t,e){let r;for(;typeof(r=this.refs[e])=="string";)e=r;return r||this.schemas[e]||Mg.call(this,t,e)}function Mg(t,e){const r=this.opts.uriResolver.parse(e),n=(0,Ms._getFullPath)(this.opts.uriResolver,r);let s=(0,Ms.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&n===s)return Aw.call(this,r,t);const i=(0,Ms.normalizeId)(n),o=this.refs[i]||this.schemas[i];if(typeof o=="string"){const a=Mg.call(this,t,o);return typeof(a==null?void 0:a.schema)!="object"?void 0:Aw.call(this,r,a)}if(typeof(o==null?void 0:o.schema)=="object"){if(o.validate||W_.call(this,o),i===(0,Ms.normalizeId)(e)){const{schema:a}=o,{schemaId:c}=this.opts,l=a[c];return l&&(s=(0,Ms.resolveUrl)(this.opts.uriResolver,s,l)),new jg({schema:a,schemaId:c,root:t,baseId:s})}return Aw.call(this,r,o)}}gi.resolveSchema=Mg;const AH=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Aw(t,{baseId:e,schema:r,root:n}){var s;if(((s=t.fragment)===null||s===void 0?void 0:s[0])!=="/")return;for(const a of t.fragment.slice(1).split("/")){if(typeof r=="boolean")return;const c=r[(0,hx.unescapeFragment)(a)];if(c===void 0)return;r=c;const l=typeof r=="object"&&r[this.opts.schemaId];!AH.has(a)&&l&&(e=(0,Ms.resolveUrl)(this.opts.uriResolver,e,l))}let i;if(typeof r!="boolean"&&r.$ref&&!(0,hx.schemaHasRulesButRef)(r,this.RULES)){const a=(0,Ms.resolveUrl)(this.opts.uriResolver,e,r.$ref);i=Mg.call(this,n,a)}const{schemaId:o}=this.opts;if(i=i||new jg({schema:r,schemaId:o,root:n,baseId:e}),i.schema!==i.root.schema)return i}const SH="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",$H="Meta-schema for $data reference (JSON AnySchema extension proposal)",xH="object",DH=["$data"],PH={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},CH=!1,kH={$id:SH,description:$H,type:xH,required:DH,properties:PH,additionalProperties:CH};var J_={},Ug={exports:{}};const OH={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};var TH={HEX:OH};const{HEX:IH}=TH;function GO(t){if(XO(t,".")<3)return{host:t,isIPV4:!1};const e=t.match(/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/u)||[],[r]=e;return r?{host:FH(r,"."),isIPV4:!0}:{host:t,isIPV4:!1}}function t1(t,e=!1){let r="",n=!0;for(const s of t){if(IH[s]===void 0)return;s!=="0"&&n===!0&&(n=!1),n||(r+=s)}return e&&r.length===0&&(r="0"),r}function BH(t){let e=0;const r={error:!1,address:"",zone:""},n=[],s=[];let i=!1,o=!1,a=!1;function c(){if(s.length){if(i===!1){const l=t1(s);if(l!==void 0)n.push(l);else return r.error=!0,!1}s.length=0}return!0}for(let l=0;l<t.length;l++){const u=t[l];if(!(u==="["||u==="]"))if(u===":"){if(o===!0&&(a=!0),!c())break;if(e++,n.push(":"),e>7){r.error=!0;break}l-1>=0&&t[l-1]===":"&&(o=!0);continue}else if(u==="%"){if(!c())break;i=!0}else{s.push(u);continue}}return s.length&&(i?r.zone=s.join(""):a?n.push(s.join("")):n.push(t1(s))),r.address=n.join(""),r}function ZO(t,e={}){if(XO(t,":")<2)return{host:t,isIPV6:!1};const r=BH(t);if(r.error)return{host:t,isIPV6:!1};{let n=r.address,s=r.address;return r.zone&&(n+="%"+r.zone,s+="%25"+r.zone),{host:n,escapedHost:s,isIPV6:!0}}}function FH(t,e){let r="",n=!0;const s=t.length;for(let i=0;i<s;i++){const o=t[i];o==="0"&&n?(i+1<=s&&t[i+1]===e||i+1===s)&&(r+=o,n=!1):(o===e?n=!0:n=!1,r+=o)}return r}function XO(t,e){let r=0;for(let n=0;n<t.length;n++)t[n]===e&&r++;return r}const yx=/^\.\.?\//u,mx=/^\/\.(?:\/|$)/u,gx=/^\/\.\.(?:\/|$)/u,NH=/^\/?(?:.|\n)*?(?=\/|$)/u;function RH(t){const e=[];for(;t.length;)if(t.match(yx))t=t.replace(yx,"");else if(t.match(mx))t=t.replace(mx,"/");else if(t.match(gx))t=t.replace(gx,"/"),e.pop();else if(t==="."||t==="..")t="";else{const r=t.match(NH);if(r){const n=r[0];t=t.slice(n.length),e.push(n)}else throw new Error("Unexpected dot segment condition")}return e.join("")}function jH(t,e){const r=e!==!0?escape:unescape;return t.scheme!==void 0&&(t.scheme=r(t.scheme)),t.userinfo!==void 0&&(t.userinfo=r(t.userinfo)),t.host!==void 0&&(t.host=r(t.host)),t.path!==void 0&&(t.path=r(t.path)),t.query!==void 0&&(t.query=r(t.query)),t.fragment!==void 0&&(t.fragment=r(t.fragment)),t}function MH(t,e){const r=[];if(t.userinfo!==void 0&&(r.push(t.userinfo),r.push("@")),t.host!==void 0){let n=unescape(t.host);const s=GO(n);if(s.isIPV4)n=s.host;else{const i=ZO(s.host,{isIPV4:!1});i.isIPV6===!0?n=`[${i.escapedHost}]`:n=t.host}r.push(n)}return(typeof t.port=="number"||typeof t.port=="string")&&(r.push(":"),r.push(String(t.port))),r.length?r.join(""):void 0}var UH={recomposeAuthority:MH,normalizeComponentEncoding:jH,removeDotSegments:RH,normalizeIPv4:GO,normalizeIPv6:ZO,stringArrayToHexStripped:t1};const KH=/^[\da-f]{8}\b-[\da-f]{4}\b-[\da-f]{4}\b-[\da-f]{4}\b-[\da-f]{12}$/iu,LH=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu;function YO(t){return typeof t.secure=="boolean"?t.secure:String(t.scheme).toLowerCase()==="wss"}function QO(t){return t.host||(t.error=t.error||"HTTP URIs must have a host."),t}function eT(t){const e=String(t.scheme).toLowerCase()==="https";return(t.port===(e?443:80)||t.port==="")&&(t.port=void 0),t.path||(t.path="/"),t}function qH(t){return t.secure=YO(t),t.resourceName=(t.path||"/")+(t.query?"?"+t.query:""),t.path=void 0,t.query=void 0,t}function VH(t){if((t.port===(YO(t)?443:80)||t.port==="")&&(t.port=void 0),typeof t.secure=="boolean"&&(t.scheme=t.secure?"wss":"ws",t.secure=void 0),t.resourceName){const[e,r]=t.resourceName.split("?");t.path=e&&e!=="/"?e:void 0,t.query=r,t.resourceName=void 0}return t.fragment=void 0,t}function zH(t,e){if(!t.path)return t.error="URN can not be parsed",t;const r=t.path.match(LH);if(r){const n=e.scheme||t.scheme||"urn";t.nid=r[1].toLowerCase(),t.nss=r[2];const s=`${n}:${e.nid||t.nid}`,i=G_[s];t.path=void 0,i&&(t=i.parse(t,e))}else t.error=t.error||"URN can not be parsed.";return t}function HH(t,e){const r=e.scheme||t.scheme||"urn",n=t.nid.toLowerCase(),s=`${r}:${e.nid||n}`,i=G_[s];i&&(t=i.serialize(t,e));const o=t,a=t.nss;return o.path=`${n||e.nid}:${a}`,e.skipEscape=!0,o}function WH(t,e){const r=t;return r.uuid=r.nss,r.nss=void 0,!e.tolerant&&(!r.uuid||!KH.test(r.uuid))&&(r.error=r.error||"UUID is not valid."),r}function JH(t){const e=t;return e.nss=(t.uuid||"").toLowerCase(),e}const tT={scheme:"http",domainHost:!0,parse:QO,serialize:eT},GH={scheme:"https",domainHost:tT.domainHost,parse:QO,serialize:eT},c0={scheme:"ws",domainHost:!0,parse:qH,serialize:VH},ZH={scheme:"wss",domainHost:c0.domainHost,parse:c0.parse,serialize:c0.serialize},XH={scheme:"urn",parse:zH,serialize:HH,skipNormalize:!0},YH={scheme:"urn:uuid",parse:WH,serialize:JH,skipNormalize:!0},G_={http:tT,https:GH,ws:c0,wss:ZH,urn:XH,"urn:uuid":YH};var QH=G_;const{normalizeIPv6:eW,normalizeIPv4:tW,removeDotSegments:qp,recomposeAuthority:rW,normalizeComponentEncoding:hm}=UH,Z_=QH;function nW(t,e){return typeof t=="string"?t=Io(Za(t,e),e):typeof t=="object"&&(t=Za(Io(t,e),e)),t}function iW(t,e,r){const n=Object.assign({scheme:"null"},r),s=rT(Za(t,n),Za(e,n),n,!0);return Io(s,{...n,skipEscape:!0})}function rT(t,e,r,n){const s={};return n||(t=Za(Io(t,r),r),e=Za(Io(e,r),r)),r=r||{},!r.tolerant&&e.scheme?(s.scheme=e.scheme,s.userinfo=e.userinfo,s.host=e.host,s.port=e.port,s.path=qp(e.path||""),s.query=e.query):(e.userinfo!==void 0||e.host!==void 0||e.port!==void 0?(s.userinfo=e.userinfo,s.host=e.host,s.port=e.port,s.path=qp(e.path||""),s.query=e.query):(e.path?(e.path.charAt(0)==="/"?s.path=qp(e.path):((t.userinfo!==void 0||t.host!==void 0||t.port!==void 0)&&!t.path?s.path="/"+e.path:t.path?s.path=t.path.slice(0,t.path.lastIndexOf("/")+1)+e.path:s.path=e.path,s.path=qp(s.path)),s.query=e.query):(s.path=t.path,e.query!==void 0?s.query=e.query:s.query=t.query),s.userinfo=t.userinfo,s.host=t.host,s.port=t.port),s.scheme=t.scheme),s.fragment=e.fragment,s}function sW(t,e,r){return typeof t=="string"?(t=unescape(t),t=Io(hm(Za(t,r),!0),{...r,skipEscape:!0})):typeof t=="object"&&(t=Io(hm(t,!0),{...r,skipEscape:!0})),typeof e=="string"?(e=unescape(e),e=Io(hm(Za(e,r),!0),{...r,skipEscape:!0})):typeof e=="object"&&(e=Io(hm(e,!0),{...r,skipEscape:!0})),t.toLowerCase()===e.toLowerCase()}function Io(t,e){const r={host:t.host,scheme:t.scheme,userinfo:t.userinfo,port:t.port,path:t.path,query:t.query,nid:t.nid,nss:t.nss,uuid:t.uuid,fragment:t.fragment,reference:t.reference,resourceName:t.resourceName,secure:t.secure,error:""},n=Object.assign({},e),s=[],i=Z_[(n.scheme||r.scheme||"").toLowerCase()];i&&i.serialize&&i.serialize(r,n),r.path!==void 0&&(n.skipEscape?r.path=unescape(r.path):(r.path=escape(r.path),r.scheme!==void 0&&(r.path=r.path.split("%3A").join(":")))),n.reference!=="suffix"&&r.scheme&&(s.push(r.scheme),s.push(":"));const o=rW(r,n);if(o!==void 0&&(n.reference!=="suffix"&&s.push("//"),s.push(o),r.path&&r.path.charAt(0)!=="/"&&s.push("/")),r.path!==void 0){let a=r.path;!n.absolutePath&&(!i||!i.absolutePath)&&(a=qp(a)),o===void 0&&(a=a.replace(/^\/\//u,"/%2F")),s.push(a)}return r.query!==void 0&&(s.push("?"),s.push(r.query)),r.fragment!==void 0&&(s.push("#"),s.push(r.fragment)),s.join("")}const oW=Array.from({length:127},(t,e)=>/[^!"$&'()*+,\-.;=_`a-z{}~]/u.test(String.fromCharCode(e)));function aW(t){let e=0;for(let r=0,n=t.length;r<n;++r)if(e=t.charCodeAt(r),e>126||oW[e])return!0;return!1}const uW=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function Za(t,e){const r=Object.assign({},e),n={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},s=t.indexOf("%")!==-1;let i=!1;r.reference==="suffix"&&(t=(r.scheme?r.scheme+":":"")+"//"+t);const o=t.match(uW);if(o){if(n.scheme=o[1],n.userinfo=o[3],n.host=o[4],n.port=parseInt(o[5],10),n.path=o[6]||"",n.query=o[7],n.fragment=o[8],isNaN(n.port)&&(n.port=o[5]),n.host){const c=tW(n.host);if(c.isIPV4===!1){const l=eW(c.host,{isIPV4:!1});n.host=l.host.toLowerCase(),i=l.isIPV6}else n.host=c.host,i=!0}n.scheme===void 0&&n.userinfo===void 0&&n.host===void 0&&n.port===void 0&&!n.path&&n.query===void 0?n.reference="same-document":n.scheme===void 0?n.reference="relative":n.fragment===void 0?n.reference="absolute":n.reference="uri",r.reference&&r.reference!=="suffix"&&r.reference!==n.reference&&(n.error=n.error||"URI is not a "+r.reference+" reference.");const a=Z_[(r.scheme||n.scheme||"").toLowerCase()];if(!r.unicodeSupport&&(!a||!a.unicodeSupport)&&n.host&&(r.domainHost||a&&a.domainHost)&&i===!1&&aW(n.host))try{n.host=URL.domainToASCII(n.host.toLowerCase())}catch(c){n.error=n.error||"Host's domain name can not be converted to ASCII: "+c}(!a||a&&!a.skipNormalize)&&(s&&n.scheme!==void 0&&(n.scheme=unescape(n.scheme)),s&&n.userinfo!==void 0&&(n.userinfo=unescape(n.userinfo)),s&&n.host!==void 0&&(n.host=unescape(n.host)),n.path!==void 0&&n.path.length&&(n.path=escape(unescape(n.path))),n.fragment!==void 0&&n.fragment.length&&(n.fragment=encodeURI(decodeURIComponent(n.fragment)))),a&&a.parse&&a.parse(n,r)}else n.error=n.error||"URI can not be parsed.";return n}const X_={SCHEMES:Z_,normalize:nW,resolve:iW,resolveComponents:rT,equal:sW,serialize:Io,parse:Za};Ug.exports=X_;Ug.exports.default=X_;Ug.exports.fastUri=X_;var cW=Ug.exports;Object.defineProperty(J_,"__esModule",{value:!0});const nT=cW;nT.code='require("ajv/dist/runtime/uri").default';J_.default=nT;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;var e=zs;Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return e.KeywordCxt}});var r=St;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return r.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return r.CodeGen}});const n=cy,s=vf,i=Wl,o=gi,a=St,c=kn,l=Qr,u=Fe,d=kH,h=J_,f=(M,k)=>new RegExp(M,k);f.code="new RegExp";const p=["removeAdditional","useDefaults","coerceTypes"],y=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),b={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},w={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},g=200;function v(M){var k,H,U,$,T,z,ne,ue,ye,_e,Se,We,te,se,ce,K,C,B,X,ae,ge,be,Ne,Oe,W;const J=M.strict,he=(k=M.code)===null||k===void 0?void 0:k.optimize,we=he===!0||he===void 0?1:he||0,Ce=(U=(H=M.code)===null||H===void 0?void 0:H.regExp)!==null&&U!==void 0?U:f,Mt=($=M.uriResolver)!==null&&$!==void 0?$:h.default;return{strictSchema:(z=(T=M.strictSchema)!==null&&T!==void 0?T:J)!==null&&z!==void 0?z:!0,strictNumbers:(ue=(ne=M.strictNumbers)!==null&&ne!==void 0?ne:J)!==null&&ue!==void 0?ue:!0,strictTypes:(_e=(ye=M.strictTypes)!==null&&ye!==void 0?ye:J)!==null&&_e!==void 0?_e:"log",strictTuples:(We=(Se=M.strictTuples)!==null&&Se!==void 0?Se:J)!==null&&We!==void 0?We:"log",strictRequired:(se=(te=M.strictRequired)!==null&&te!==void 0?te:J)!==null&&se!==void 0?se:!1,code:M.code?{...M.code,optimize:we,regExp:Ce}:{optimize:we,regExp:Ce},loopRequired:(ce=M.loopRequired)!==null&&ce!==void 0?ce:g,loopEnum:(K=M.loopEnum)!==null&&K!==void 0?K:g,meta:(C=M.meta)!==null&&C!==void 0?C:!0,messages:(B=M.messages)!==null&&B!==void 0?B:!0,inlineRefs:(X=M.inlineRefs)!==null&&X!==void 0?X:!0,schemaId:(ae=M.schemaId)!==null&&ae!==void 0?ae:"$id",addUsedSchema:(ge=M.addUsedSchema)!==null&&ge!==void 0?ge:!0,validateSchema:(be=M.validateSchema)!==null&&be!==void 0?be:!0,validateFormats:(Ne=M.validateFormats)!==null&&Ne!==void 0?Ne:!0,unicodeRegExp:(Oe=M.unicodeRegExp)!==null&&Oe!==void 0?Oe:!0,int32range:(W=M.int32range)!==null&&W!==void 0?W:!0,uriResolver:Mt}}class m{constructor(k={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,k=this.opts={...k,...v(k)};const{es5:H,lines:U}=this.opts.code;this.scope=new a.ValueScope({scope:{},prefixes:y,es5:H,lines:U}),this.logger=I(k.logger);const $=k.validateFormats;k.validateFormats=!1,this.RULES=(0,i.getRules)(),_.call(this,b,k,"NOT SUPPORTED"),_.call(this,w,k,"DEPRECATED","warn"),this._metaOpts=S.call(this),k.formats&&E.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),k.keywords&&A.call(this,k.keywords),typeof k.meta=="object"&&this.addMetaSchema(k.meta),D.call(this),k.validateFormats=$}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:k,meta:H,schemaId:U}=this.opts;let $=d;U==="id"&&($={...d},$.id=$.$id,delete $.$id),H&&k&&this.addMetaSchema($,$[U],!1)}defaultMeta(){const{meta:k,schemaId:H}=this.opts;return this.opts.defaultMeta=typeof k=="object"?k[H]||k:void 0}validate(k,H){let U;if(typeof k=="string"){if(U=this.getSchema(k),!U)throw new Error(`no schema with key or ref "${k}"`)}else U=this.compile(k);const $=U(H);return"$async"in U||(this.errors=U.errors),$}compile(k,H){const U=this._addSchema(k,H);return U.validate||this._compileSchemaEnv(U)}compileAsync(k,H){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:U}=this.opts;return $.call(this,k,H);async function $(_e,Se){await T.call(this,_e.$schema);const We=this._addSchema(_e,Se);return We.validate||z.call(this,We)}async function T(_e){_e&&!this.getSchema(_e)&&await $.call(this,{$ref:_e},!0)}async function z(_e){try{return this._compileSchemaEnv(_e)}catch(Se){if(!(Se instanceof s.default))throw Se;return ne.call(this,Se),await ue.call(this,Se.missingSchema),z.call(this,_e)}}function ne({missingSchema:_e,missingRef:Se}){if(this.refs[_e])throw new Error(`AnySchema ${_e} is loaded but ${Se} cannot be resolved`)}async function ue(_e){const Se=await ye.call(this,_e);this.refs[_e]||await T.call(this,Se.$schema),this.refs[_e]||this.addSchema(Se,_e,H)}async function ye(_e){const Se=this._loading[_e];if(Se)return Se;try{return await(this._loading[_e]=U(_e))}finally{delete this._loading[_e]}}}addSchema(k,H,U,$=this.opts.validateSchema){if(Array.isArray(k)){for(const z of k)this.addSchema(z,void 0,U,$);return this}let T;if(typeof k=="object"){const{schemaId:z}=this.opts;if(T=k[z],T!==void 0&&typeof T!="string")throw new Error(`schema ${z} must be string`)}return H=(0,c.normalizeId)(H||T),this._checkUnique(H),this.schemas[H]=this._addSchema(k,U,H,$,!0),this}addMetaSchema(k,H,U=this.opts.validateSchema){return this.addSchema(k,H,!0,U),this}validateSchema(k,H){if(typeof k=="boolean")return!0;let U;if(U=k.$schema,U!==void 0&&typeof U!="string")throw new Error("$schema must be a string");if(U=U||this.opts.defaultMeta||this.defaultMeta(),!U)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const $=this.validate(U,k);if(!$&&H){const T="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(T);else throw new Error(T)}return $}getSchema(k){let H;for(;typeof(H=x.call(this,k))=="string";)k=H;if(H===void 0){const{schemaId:U}=this.opts,$=new o.SchemaEnv({schema:{},schemaId:U});if(H=o.resolveSchema.call(this,$,k),!H)return;this.refs[k]=H}return H.validate||this._compileSchemaEnv(H)}removeSchema(k){if(k instanceof RegExp)return this._removeAllSchemas(this.schemas,k),this._removeAllSchemas(this.refs,k),this;switch(typeof k){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const H=x.call(this,k);return typeof H=="object"&&this._cache.delete(H.schema),delete this.schemas[k],delete this.refs[k],this}case"object":{const H=k;this._cache.delete(H);let U=k[this.opts.schemaId];return U&&(U=(0,c.normalizeId)(U),delete this.schemas[U],delete this.refs[U]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(k){for(const H of k)this.addKeyword(H);return this}addKeyword(k,H){let U;if(typeof k=="string")U=k,typeof H=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),H.keyword=U);else if(typeof k=="object"&&H===void 0){if(H=k,U=H.keyword,Array.isArray(U)&&!U.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(j.call(this,U,H),!H)return(0,u.eachItem)(U,T=>F.call(this,T)),this;ee.call(this,H);const $={...H,type:(0,l.getJSONTypes)(H.type),schemaType:(0,l.getJSONTypes)(H.schemaType)};return(0,u.eachItem)(U,$.type.length===0?T=>F.call(this,T,$):T=>$.type.forEach(z=>F.call(this,T,$,z))),this}getKeyword(k){const H=this.RULES.all[k];return typeof H=="object"?H.definition:!!H}removeKeyword(k){const{RULES:H}=this;delete H.keywords[k],delete H.all[k];for(const U of H.rules){const $=U.rules.findIndex(T=>T.keyword===k);$>=0&&U.rules.splice($,1)}return this}addFormat(k,H){return typeof H=="string"&&(H=new RegExp(H)),this.formats[k]=H,this}errorsText(k=this.errors,{separator:H=", ",dataVar:U="data"}={}){return!k||k.length===0?"No errors":k.map($=>`${U}${$.instancePath} ${$.message}`).reduce(($,T)=>$+H+T)}$dataMetaSchema(k,H){const U=this.RULES.all;k=JSON.parse(JSON.stringify(k));for(const $ of H){const T=$.split("/").slice(1);let z=k;for(const ne of T)z=z[ne];for(const ne in U){const ue=U[ne];if(typeof ue!="object")continue;const{$data:ye}=ue.definition,_e=z[ne];ye&&_e&&(z[ne]=Z(_e))}}return k}_removeAllSchemas(k,H){for(const U in k){const $=k[U];(!H||H.test(U))&&(typeof $=="string"?delete k[U]:$&&!$.meta&&(this._cache.delete($.schema),delete k[U]))}}_addSchema(k,H,U,$=this.opts.validateSchema,T=this.opts.addUsedSchema){let z;const{schemaId:ne}=this.opts;if(typeof k=="object")z=k[ne];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof k!="boolean")throw new Error("schema must be object or boolean")}let ue=this._cache.get(k);if(ue!==void 0)return ue;U=(0,c.normalizeId)(z||U);const ye=c.getSchemaRefs.call(this,k,U);return ue=new o.SchemaEnv({schema:k,schemaId:ne,meta:H,baseId:U,localRefs:ye}),this._cache.set(ue.schema,ue),T&&!U.startsWith("#")&&(U&&this._checkUnique(U),this.refs[U]=ue),$&&this.validateSchema(k,!0),ue}_checkUnique(k){if(this.schemas[k]||this.refs[k])throw new Error(`schema with key or id "${k}" already exists`)}_compileSchemaEnv(k){if(k.meta?this._compileMetaSchema(k):o.compileSchema.call(this,k),!k.validate)throw new Error("ajv implementation error");return k.validate}_compileMetaSchema(k){const H=this.opts;this.opts=this._metaOpts;try{o.compileSchema.call(this,k)}finally{this.opts=H}}}m.ValidationError=n.default,m.MissingRefError=s.default,t.default=m;function _(M,k,H,U="error"){for(const $ in M){const T=$;T in k&&this.logger[U](`${H}: option ${$}. ${M[T]}`)}}function x(M){return M=(0,c.normalizeId)(M),this.schemas[M]||this.refs[M]}function D(){const M=this.opts.schemas;if(M)if(Array.isArray(M))this.addSchema(M);else for(const k in M)this.addSchema(M[k],k)}function E(){for(const M in this.opts.formats){const k=this.opts.formats[M];k&&this.addFormat(M,k)}}function A(M){if(Array.isArray(M)){this.addVocabulary(M);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const k in M){const H=M[k];H.keyword||(H.keyword=k),this.addKeyword(H)}}function S(){const M={...this.opts};for(const k of p)delete M[k];return M}const O={log(){},warn(){},error(){}};function I(M){if(M===!1)return O;if(M===void 0)return console;if(M.log&&M.warn&&M.error)return M;throw new Error("logger must implement log, warn and error methods")}const N=/^[a-z_$][a-z0-9_$:-]*$/i;function j(M,k){const{RULES:H}=this;if((0,u.eachItem)(M,U=>{if(H.keywords[U])throw new Error(`Keyword ${U} is already defined`);if(!N.test(U))throw new Error(`Keyword ${U} has invalid name`)}),!!k&&k.$data&&!("code"in k||"validate"in k))throw new Error('$data keyword must have "code" or "validate" function')}function F(M,k,H){var U;const $=k==null?void 0:k.post;if(H&&$)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:T}=this;let z=$?T.post:T.rules.find(({type:ue})=>ue===H);if(z||(z={type:H,rules:[]},T.rules.push(z)),T.keywords[M]=!0,!k)return;const ne={keyword:M,definition:{...k,type:(0,l.getJSONTypes)(k.type),schemaType:(0,l.getJSONTypes)(k.schemaType)}};k.before?V.call(this,z,ne,k.before):z.rules.push(ne),T.all[M]=ne,(U=k.implements)===null||U===void 0||U.forEach(ue=>this.addKeyword(ue))}function V(M,k,H){const U=M.rules.findIndex($=>$.keyword===H);U>=0?M.rules.splice(U,0,k):(M.rules.push(k),this.logger.warn(`rule ${H} is not defined`))}function ee(M){let{metaSchema:k}=M;k!==void 0&&(M.$data&&this.opts.$data&&(k=Z(k)),M.validateSchema=this.compile(k,!0))}const G={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function Z(M){return{anyOf:[M,G]}}})(mO);var Y_={},Q_={},eE={};Object.defineProperty(eE,"__esModule",{value:!0});const lW={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};eE.default=lW;var Jl={};Object.defineProperty(Jl,"__esModule",{value:!0});Jl.callRef=Jl.getValidate=void 0;const dW=vf,vx=Pt,pi=St,bd=Qo,wx=gi,ym=Fe,fW={keyword:"$ref",schemaType:"string",code(t){const{gen:e,schema:r,it:n}=t,{baseId:s,schemaEnv:i,validateName:o,opts:a,self:c}=n,{root:l}=i;if((r==="#"||r==="#/")&&s===l.baseId)return d();const u=wx.resolveRef.call(c,l,s,r);if(u===void 0)throw new dW.default(n.opts.uriResolver,s,r);if(u instanceof wx.SchemaEnv)return h(u);return f(u);function d(){if(i===l)return l0(t,o,i,i.$async);const p=e.scopeValue("root",{ref:l});return l0(t,(0,pi._)`${p}.validate`,l,l.$async)}function h(p){const y=iT(t,p);l0(t,y,p,p.$async)}function f(p){const y=e.scopeValue("schema",a.code.source===!0?{ref:p,code:(0,pi.stringify)(p)}:{ref:p}),b=e.name("valid"),w=t.subschema({schema:p,dataTypes:[],schemaPath:pi.nil,topSchemaRef:y,errSchemaPath:r},b);t.mergeEvaluated(w),t.ok(b)}}};function iT(t,e){const{gen:r}=t;return e.validate?r.scopeValue("validate",{ref:e.validate}):(0,pi._)`${r.scopeValue("wrapper",{ref:e})}.validate`}Jl.getValidate=iT;function l0(t,e,r,n){const{gen:s,it:i}=t,{allErrors:o,schemaEnv:a,opts:c}=i,l=c.passContext?bd.default.this:pi.nil;n?u():d();function u(){if(!a.$async)throw new Error("async schema referenced by sync schema");const p=s.let("valid");s.try(()=>{s.code((0,pi._)`await ${(0,vx.callValidateCode)(t,e,l)}`),f(e),o||s.assign(p,!0)},y=>{s.if((0,pi._)`!(${y} instanceof ${i.ValidationError})`,()=>s.throw(y)),h(y),o||s.assign(p,!1)}),t.ok(p)}function d(){t.result((0,vx.callValidateCode)(t,e,l),()=>f(e),()=>h(e))}function h(p){const y=(0,pi._)`${p}.errors`;s.assign(bd.default.vErrors,(0,pi._)`${bd.default.vErrors} === null ? ${y} : ${bd.default.vErrors}.concat(${y})`),s.assign(bd.default.errors,(0,pi._)`${bd.default.vErrors}.length`)}function f(p){var y;if(!i.opts.unevaluated)return;const b=(y=r==null?void 0:r.validate)===null||y===void 0?void 0:y.evaluated;if(i.props!==!0)if(b&&!b.dynamicProps)b.props!==void 0&&(i.props=ym.mergeEvaluated.props(s,b.props,i.props));else{const w=s.var("props",(0,pi._)`${p}.evaluated.props`);i.props=ym.mergeEvaluated.props(s,w,i.props,pi.Name)}if(i.items!==!0)if(b&&!b.dynamicItems)b.items!==void 0&&(i.items=ym.mergeEvaluated.items(s,b.items,i.items));else{const w=s.var("items",(0,pi._)`${p}.evaluated.items`);i.items=ym.mergeEvaluated.items(s,w,i.items,pi.Name)}}}Jl.callRef=l0;Jl.default=fW;Object.defineProperty(Q_,"__esModule",{value:!0});const pW=eE,hW=Jl,yW=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",pW.default,hW.default];Q_.default=yW;var tE={},rE={};Object.defineProperty(rE,"__esModule",{value:!0});const V0=St,Su=V0.operators,z0={maximum:{okStr:"<=",ok:Su.LTE,fail:Su.GT},minimum:{okStr:">=",ok:Su.GTE,fail:Su.LT},exclusiveMaximum:{okStr:"<",ok:Su.LT,fail:Su.GTE},exclusiveMinimum:{okStr:">",ok:Su.GT,fail:Su.LTE}},mW={message:({keyword:t,schemaCode:e})=>(0,V0.str)`must be ${z0[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,V0._)`{comparison: ${z0[t].okStr}, limit: ${e}}`},gW={keyword:Object.keys(z0),type:"number",schemaType:"number",$data:!0,error:mW,code(t){const{keyword:e,data:r,schemaCode:n}=t;t.fail$data((0,V0._)`${r} ${z0[e].fail} ${n} || isNaN(${r})`)}};rE.default=gW;var nE={};Object.defineProperty(nE,"__esModule",{value:!0});const th=St,vW={message:({schemaCode:t})=>(0,th.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,th._)`{multipleOf: ${t}}`},wW={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:vW,code(t){const{gen:e,data:r,schemaCode:n,it:s}=t,i=s.opts.multipleOfPrecision,o=e.let("res"),a=i?(0,th._)`Math.abs(Math.round(${o}) - ${o}) > 1e-${i}`:(0,th._)`${o} !== parseInt(${o})`;t.fail$data((0,th._)`(${n} === 0 || (${o} = ${r}/${n}, ${a}))`)}};nE.default=wW;var iE={},sE={};Object.defineProperty(sE,"__esModule",{value:!0});function sT(t){const e=t.length;let r=0,n=0,s;for(;n<e;)r++,s=t.charCodeAt(n++),s>=55296&&s<=56319&&n<e&&(s=t.charCodeAt(n),(s&64512)===56320&&n++);return r}sE.default=sT;sT.code='require("ajv/dist/runtime/ucs2length").default';Object.defineProperty(iE,"__esModule",{value:!0});const hl=St,bW=Fe,_W=sE,EW={message({keyword:t,schemaCode:e}){const r=t==="maxLength"?"more":"fewer";return(0,hl.str)`must NOT have ${r} than ${e} characters`},params:({schemaCode:t})=>(0,hl._)`{limit: ${t}}`},AW={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:EW,code(t){const{keyword:e,data:r,schemaCode:n,it:s}=t,i=e==="maxLength"?hl.operators.GT:hl.operators.LT,o=s.opts.unicode===!1?(0,hl._)`${r}.length`:(0,hl._)`${(0,bW.useFunc)(t.gen,_W.default)}(${r})`;t.fail$data((0,hl._)`${o} ${i} ${n}`)}};iE.default=AW;var oE={};Object.defineProperty(oE,"__esModule",{value:!0});const SW=Pt,H0=St,$W={message:({schemaCode:t})=>(0,H0.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,H0._)`{pattern: ${t}}`},xW={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:$W,code(t){const{data:e,$data:r,schema:n,schemaCode:s,it:i}=t,o=i.opts.unicodeRegExp?"u":"",a=r?(0,H0._)`(new RegExp(${s}, ${o}))`:(0,SW.usePattern)(t,n);t.fail$data((0,H0._)`!${a}.test(${e})`)}};oE.default=xW;var aE={};Object.defineProperty(aE,"__esModule",{value:!0});const rh=St,DW={message({keyword:t,schemaCode:e}){const r=t==="maxProperties"?"more":"fewer";return(0,rh.str)`must NOT have ${r} than ${e} properties`},params:({schemaCode:t})=>(0,rh._)`{limit: ${t}}`},PW={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:DW,code(t){const{keyword:e,data:r,schemaCode:n}=t,s=e==="maxProperties"?rh.operators.GT:rh.operators.LT;t.fail$data((0,rh._)`Object.keys(${r}).length ${s} ${n}`)}};aE.default=PW;var uE={};Object.defineProperty(uE,"__esModule",{value:!0});const mp=Pt,nh=St,CW=Fe,kW={message:({params:{missingProperty:t}})=>(0,nh.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,nh._)`{missingProperty: ${t}}`},OW={keyword:"required",type:"object",schemaType:"array",$data:!0,error:kW,code(t){const{gen:e,schema:r,schemaCode:n,data:s,$data:i,it:o}=t,{opts:a}=o;if(!i&&r.length===0)return;const c=r.length>=a.loopRequired;if(o.allErrors?l():u(),a.strictRequired){const f=t.parentSchema.properties,{definedProperties:p}=t.it;for(const y of r)if((f==null?void 0:f[y])===void 0&&!p.has(y)){const b=o.schemaEnv.baseId+o.errSchemaPath,w=`required property "${y}" is not defined at "${b}" (strictRequired)`;(0,CW.checkStrictMode)(o,w,o.opts.strictRequired)}}function l(){if(c||i)t.block$data(nh.nil,d);else for(const f of r)(0,mp.checkReportMissingProp)(t,f)}function u(){const f=e.let("missing");if(c||i){const p=e.let("valid",!0);t.block$data(p,()=>h(f,p)),t.ok(p)}else e.if((0,mp.checkMissingProp)(t,r,f)),(0,mp.reportMissingProp)(t,f),e.else()}function d(){e.forOf("prop",n,f=>{t.setParams({missingProperty:f}),e.if((0,mp.noPropertyInData)(e,s,f,a.ownProperties),()=>t.error())})}function h(f,p){t.setParams({missingProperty:f}),e.forOf(f,n,()=>{e.assign(p,(0,mp.propertyInData)(e,s,f,a.ownProperties)),e.if((0,nh.not)(p),()=>{t.error(),e.break()})},nh.nil)}}};uE.default=OW;var cE={};Object.defineProperty(cE,"__esModule",{value:!0});const ih=St,TW={message({keyword:t,schemaCode:e}){const r=t==="maxItems"?"more":"fewer";return(0,ih.str)`must NOT have ${r} than ${e} items`},params:({schemaCode:t})=>(0,ih._)`{limit: ${t}}`},IW={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:TW,code(t){const{keyword:e,data:r,schemaCode:n}=t,s=e==="maxItems"?ih.operators.GT:ih.operators.LT;t.fail$data((0,ih._)`${r}.length ${s} ${n}`)}};cE.default=IW;var lE={};Object.defineProperty(lE,"__esModule",{value:!0});const Sw=Qr,xn=St,BW=Fe,FW=gf,NW={message:({params:{i:t,j:e}})=>(0,xn.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,xn._)`{i: ${t}, j: ${e}}`},RW={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:NW,code(t){const{gen:e,data:r,$data:n,schema:s,parentSchema:i,schemaCode:o,it:a}=t;if(!n&&!s)return;const c=e.let("valid"),l=i.items?(0,Sw.getSchemaTypes)(i.items):[];t.block$data(c,u,(0,xn._)`${o} === false`),t.ok(c);function u(){const p=e.let("i",(0,xn._)`${r}.length`),y=e.let("j");t.setParams({i:p,j:y}),e.assign(c,!0),e.if((0,xn._)`${p} > 1`,()=>(d()?h:f)(p,y))}function d(){return l.length>0&&!l.some(p=>p==="object"||p==="array")}function h(p,y){const b=e.name("item"),w=(0,Sw.checkDataTypes)(l,b,a.opts.strictNumbers,Sw.DataType.Wrong),g=e.const("indices",(0,xn._)`{}`);e.for((0,xn._)`;${p}--;`,()=>{e.let(b,(0,xn._)`${r}[${p}]`),e.if(w,(0,xn._)`continue`),l.length>1&&e.if((0,xn._)`typeof ${b} == "string"`,(0,xn._)`${b} += "_"`),e.if((0,xn._)`typeof ${g}[${b}] == "number"`,()=>{e.assign(y,(0,xn._)`${g}[${b}]`),t.error(),e.assign(c,!1).break()}).code((0,xn._)`${g}[${b}] = ${p}`)})}function f(p,y){const b=(0,BW.useFunc)(e,FW.default),w=e.name("outer");e.label(w).for((0,xn._)`;${p}--;`,()=>e.for((0,xn._)`${y} = ${p}; ${y}--;`,()=>e.if((0,xn._)`${b}(${r}[${p}], ${r}[${y}])`,()=>{t.error(),e.assign(c,!1).break(w)})))}}};lE.default=RW;var dE={};Object.defineProperty(dE,"__esModule",{value:!0});const r1=St,jW=Fe,MW=gf,UW={message:"must be equal to constant",params:({schemaCode:t})=>(0,r1._)`{allowedValue: ${t}}`},KW={keyword:"const",$data:!0,error:UW,code(t){const{gen:e,data:r,$data:n,schemaCode:s,schema:i}=t;n||i&&typeof i=="object"?t.fail$data((0,r1._)`!${(0,jW.useFunc)(e,MW.default)}(${r}, ${s})`):t.fail((0,r1._)`${i} !== ${r}`)}};dE.default=KW;var fE={};Object.defineProperty(fE,"__esModule",{value:!0});const Vp=St,LW=Fe,qW=gf,VW={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,Vp._)`{allowedValues: ${t}}`},zW={keyword:"enum",schemaType:"array",$data:!0,error:VW,code(t){const{gen:e,data:r,$data:n,schema:s,schemaCode:i,it:o}=t;if(!n&&s.length===0)throw new Error("enum must have non-empty array");const a=s.length>=o.opts.loopEnum;let c;const l=()=>c??(c=(0,LW.useFunc)(e,qW.default));let u;if(a||n)u=e.let("valid"),t.block$data(u,d);else{if(!Array.isArray(s))throw new Error("ajv implementation error");const f=e.const("vSchema",i);u=(0,Vp.or)(...s.map((p,y)=>h(f,y)))}t.pass(u);function d(){e.assign(u,!1),e.forOf("v",i,f=>e.if((0,Vp._)`${l()}(${r}, ${f})`,()=>e.assign(u,!0).break()))}function h(f,p){const y=s[p];return typeof y=="object"&&y!==null?(0,Vp._)`${l()}(${r}, ${f}[${p}])`:(0,Vp._)`${r} === ${y}`}}};fE.default=zW;Object.defineProperty(tE,"__esModule",{value:!0});const HW=rE,WW=nE,JW=iE,GW=oE,ZW=aE,XW=uE,YW=cE,QW=lE,eJ=dE,tJ=fE,rJ=[HW.default,WW.default,JW.default,GW.default,ZW.default,XW.default,YW.default,QW.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},eJ.default,tJ.default];tE.default=rJ;var pE={},wf={};Object.defineProperty(wf,"__esModule",{value:!0});wf.validateAdditionalItems=void 0;const yl=St,n1=Fe,nJ={message:({params:{len:t}})=>(0,yl.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,yl._)`{limit: ${t}}`},iJ={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:nJ,code(t){const{parentSchema:e,it:r}=t,{items:n}=e;if(!Array.isArray(n)){(0,n1.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}oT(t,n)}};function oT(t,e){const{gen:r,schema:n,data:s,keyword:i,it:o}=t;o.items=!0;const a=r.const("len",(0,yl._)`${s}.length`);if(n===!1)t.setParams({len:e.length}),t.pass((0,yl._)`${a} <= ${e.length}`);else if(typeof n=="object"&&!(0,n1.alwaysValidSchema)(o,n)){const l=r.var("valid",(0,yl._)`${a} <= ${e.length}`);r.if((0,yl.not)(l),()=>c(l)),t.ok(l)}function c(l){r.forRange("i",e.length,a,u=>{t.subschema({keyword:i,dataProp:u,dataPropType:n1.Type.Num},l),o.allErrors||r.if((0,yl.not)(l),()=>r.break())})}}wf.validateAdditionalItems=oT;wf.default=iJ;var hE={},bf={};Object.defineProperty(bf,"__esModule",{value:!0});bf.validateTuple=void 0;const bx=St,d0=Fe,sJ=Pt,oJ={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){const{schema:e,it:r}=t;if(Array.isArray(e))return aT(t,"additionalItems",e);r.items=!0,!(0,d0.alwaysValidSchema)(r,e)&&t.ok((0,sJ.validateArray)(t))}};function aT(t,e,r=t.schema){const{gen:n,parentSchema:s,data:i,keyword:o,it:a}=t;u(s),a.opts.unevaluated&&r.length&&a.items!==!0&&(a.items=d0.mergeEvaluated.items(n,r.length,a.items));const c=n.name("valid"),l=n.const("len",(0,bx._)`${i}.length`);r.forEach((d,h)=>{(0,d0.alwaysValidSchema)(a,d)||(n.if((0,bx._)`${l} > ${h}`,()=>t.subschema({keyword:o,schemaProp:h,dataProp:h},c)),t.ok(c))});function u(d){const{opts:h,errSchemaPath:f}=a,p=r.length,y=p===d.minItems&&(p===d.maxItems||d[e]===!1);if(h.strictTuples&&!y){const b=`"${o}" is ${p}-tuple, but minItems or maxItems/${e} are not specified or different at path "${f}"`;(0,d0.checkStrictMode)(a,b,h.strictTuples)}}}bf.validateTuple=aT;bf.default=oJ;Object.defineProperty(hE,"__esModule",{value:!0});const aJ=bf,uJ={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,aJ.validateTuple)(t,"items")};hE.default=uJ;var yE={};Object.defineProperty(yE,"__esModule",{value:!0});const _x=St,cJ=Fe,lJ=Pt,dJ=wf,fJ={message:({params:{len:t}})=>(0,_x.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,_x._)`{limit: ${t}}`},pJ={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:fJ,code(t){const{schema:e,parentSchema:r,it:n}=t,{prefixItems:s}=r;n.items=!0,!(0,cJ.alwaysValidSchema)(n,e)&&(s?(0,dJ.validateAdditionalItems)(t,s):t.ok((0,lJ.validateArray)(t)))}};yE.default=pJ;var mE={};Object.defineProperty(mE,"__esModule",{value:!0});const us=St,mm=Fe,hJ={message:({params:{min:t,max:e}})=>e===void 0?(0,us.str)`must contain at least ${t} valid item(s)`:(0,us.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,us._)`{minContains: ${t}}`:(0,us._)`{minContains: ${t}, maxContains: ${e}}`},yJ={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:hJ,code(t){const{gen:e,schema:r,parentSchema:n,data:s,it:i}=t;let o,a;const{minContains:c,maxContains:l}=n;i.opts.next?(o=c===void 0?1:c,a=l):o=1;const u=e.const("len",(0,us._)`${s}.length`);if(t.setParams({min:o,max:a}),a===void 0&&o===0){(0,mm.checkStrictMode)(i,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&o>a){(0,mm.checkStrictMode)(i,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,mm.alwaysValidSchema)(i,r)){let y=(0,us._)`${u} >= ${o}`;a!==void 0&&(y=(0,us._)`${y} && ${u} <= ${a}`),t.pass(y);return}i.items=!0;const d=e.name("valid");a===void 0&&o===1?f(d,()=>e.if(d,()=>e.break())):o===0?(e.let(d,!0),a!==void 0&&e.if((0,us._)`${s}.length > 0`,h)):(e.let(d,!1),h()),t.result(d,()=>t.reset());function h(){const y=e.name("_valid"),b=e.let("count",0);f(y,()=>e.if(y,()=>p(b)))}function f(y,b){e.forRange("i",0,u,w=>{t.subschema({keyword:"contains",dataProp:w,dataPropType:mm.Type.Num,compositeRule:!0},y),b()})}function p(y){e.code((0,us._)`${y}++`),a===void 0?e.if((0,us._)`${y} >= ${o}`,()=>e.assign(d,!0).break()):(e.if((0,us._)`${y} > ${a}`,()=>e.assign(d,!1).break()),o===1?e.assign(d,!0):e.if((0,us._)`${y} >= ${o}`,()=>e.assign(d,!0)))}}};mE.default=yJ;var uT={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.validateSchemaDeps=t.validatePropertyDeps=t.error=void 0;const e=St,r=Fe,n=Pt;t.error={message:({params:{property:c,depsCount:l,deps:u}})=>{const d=l===1?"property":"properties";return(0,e.str)`must have ${d} ${u} when property ${c} is present`},params:({params:{property:c,depsCount:l,deps:u,missingProperty:d}})=>(0,e._)`{property: ${c},
    missingProperty: ${d},
    depsCount: ${l},
    deps: ${u}}`};const s={keyword:"dependencies",type:"object",schemaType:"object",error:t.error,code(c){const[l,u]=i(c);o(c,l),a(c,u)}};function i({schema:c}){const l={},u={};for(const d in c){if(d==="__proto__")continue;const h=Array.isArray(c[d])?l:u;h[d]=c[d]}return[l,u]}function o(c,l=c.schema){const{gen:u,data:d,it:h}=c;if(Object.keys(l).length===0)return;const f=u.let("missing");for(const p in l){const y=l[p];if(y.length===0)continue;const b=(0,n.propertyInData)(u,d,p,h.opts.ownProperties);c.setParams({property:p,depsCount:y.length,deps:y.join(", ")}),h.allErrors?u.if(b,()=>{for(const w of y)(0,n.checkReportMissingProp)(c,w)}):(u.if((0,e._)`${b} && (${(0,n.checkMissingProp)(c,y,f)})`),(0,n.reportMissingProp)(c,f),u.else())}}t.validatePropertyDeps=o;function a(c,l=c.schema){const{gen:u,data:d,keyword:h,it:f}=c,p=u.name("valid");for(const y in l)(0,r.alwaysValidSchema)(f,l[y])||(u.if((0,n.propertyInData)(u,d,y,f.opts.ownProperties),()=>{const b=c.subschema({keyword:h,schemaProp:y},p);c.mergeValidEvaluated(b,p)},()=>u.var(p,!0)),c.ok(p))}t.validateSchemaDeps=a,t.default=s})(uT);var gE={};Object.defineProperty(gE,"__esModule",{value:!0});const cT=St,mJ=Fe,gJ={message:"property name must be valid",params:({params:t})=>(0,cT._)`{propertyName: ${t.propertyName}}`},vJ={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:gJ,code(t){const{gen:e,schema:r,data:n,it:s}=t;if((0,mJ.alwaysValidSchema)(s,r))return;const i=e.name("valid");e.forIn("key",n,o=>{t.setParams({propertyName:o}),t.subschema({keyword:"propertyNames",data:o,dataTypes:["string"],propertyName:o,compositeRule:!0},i),e.if((0,cT.not)(i),()=>{t.error(!0),s.allErrors||e.break()})}),t.ok(i)}};gE.default=vJ;var Kg={};Object.defineProperty(Kg,"__esModule",{value:!0});const gm=Pt,Ts=St,wJ=Qo,vm=Fe,bJ={message:"must NOT have additional properties",params:({params:t})=>(0,Ts._)`{additionalProperty: ${t.additionalProperty}}`},_J={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:bJ,code(t){const{gen:e,schema:r,parentSchema:n,data:s,errsCount:i,it:o}=t;if(!i)throw new Error("ajv implementation error");const{allErrors:a,opts:c}=o;if(o.props=!0,c.removeAdditional!=="all"&&(0,vm.alwaysValidSchema)(o,r))return;const l=(0,gm.allSchemaProperties)(n.properties),u=(0,gm.allSchemaProperties)(n.patternProperties);d(),t.ok((0,Ts._)`${i} === ${wJ.default.errors}`);function d(){e.forIn("key",s,b=>{!l.length&&!u.length?p(b):e.if(h(b),()=>p(b))})}function h(b){let w;if(l.length>8){const g=(0,vm.schemaRefOrVal)(o,n.properties,"properties");w=(0,gm.isOwnProperty)(e,g,b)}else l.length?w=(0,Ts.or)(...l.map(g=>(0,Ts._)`${b} === ${g}`)):w=Ts.nil;return u.length&&(w=(0,Ts.or)(w,...u.map(g=>(0,Ts._)`${(0,gm.usePattern)(t,g)}.test(${b})`))),(0,Ts.not)(w)}function f(b){e.code((0,Ts._)`delete ${s}[${b}]`)}function p(b){if(c.removeAdditional==="all"||c.removeAdditional&&r===!1){f(b);return}if(r===!1){t.setParams({additionalProperty:b}),t.error(),a||e.break();return}if(typeof r=="object"&&!(0,vm.alwaysValidSchema)(o,r)){const w=e.name("valid");c.removeAdditional==="failing"?(y(b,w,!1),e.if((0,Ts.not)(w),()=>{t.reset(),f(b)})):(y(b,w),a||e.if((0,Ts.not)(w),()=>e.break()))}}function y(b,w,g){const v={keyword:"additionalProperties",dataProp:b,dataPropType:vm.Type.Str};g===!1&&Object.assign(v,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema(v,w)}}};Kg.default=_J;var vE={};Object.defineProperty(vE,"__esModule",{value:!0});const EJ=zs,Ex=Pt,$w=Fe,Ax=Kg,AJ={keyword:"properties",type:"object",schemaType:"object",code(t){const{gen:e,schema:r,parentSchema:n,data:s,it:i}=t;i.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&Ax.default.code(new EJ.KeywordCxt(i,Ax.default,"additionalProperties"));const o=(0,Ex.allSchemaProperties)(r);for(const d of o)i.definedProperties.add(d);i.opts.unevaluated&&o.length&&i.props!==!0&&(i.props=$w.mergeEvaluated.props(e,(0,$w.toHash)(o),i.props));const a=o.filter(d=>!(0,$w.alwaysValidSchema)(i,r[d]));if(a.length===0)return;const c=e.name("valid");for(const d of a)l(d)?u(d):(e.if((0,Ex.propertyInData)(e,s,d,i.opts.ownProperties)),u(d),i.allErrors||e.else().var(c,!0),e.endIf()),t.it.definedProperties.add(d),t.ok(c);function l(d){return i.opts.useDefaults&&!i.compositeRule&&r[d].default!==void 0}function u(d){t.subschema({keyword:"properties",schemaProp:d,dataProp:d},c)}}};vE.default=AJ;var wE={};Object.defineProperty(wE,"__esModule",{value:!0});const Sx=Pt,wm=St,$x=Fe,xx=Fe,SJ={keyword:"patternProperties",type:"object",schemaType:"object",code(t){const{gen:e,schema:r,data:n,parentSchema:s,it:i}=t,{opts:o}=i,a=(0,Sx.allSchemaProperties)(r),c=a.filter(y=>(0,$x.alwaysValidSchema)(i,r[y]));if(a.length===0||c.length===a.length&&(!i.opts.unevaluated||i.props===!0))return;const l=o.strictSchema&&!o.allowMatchingProperties&&s.properties,u=e.name("valid");i.props!==!0&&!(i.props instanceof wm.Name)&&(i.props=(0,xx.evaluatedPropsToName)(e,i.props));const{props:d}=i;h();function h(){for(const y of a)l&&f(y),i.allErrors?p(y):(e.var(u,!0),p(y),e.if(u))}function f(y){for(const b in l)new RegExp(y).test(b)&&(0,$x.checkStrictMode)(i,`property ${b} matches pattern ${y} (use allowMatchingProperties)`)}function p(y){e.forIn("key",n,b=>{e.if((0,wm._)`${(0,Sx.usePattern)(t,y)}.test(${b})`,()=>{const w=c.includes(y);w||t.subschema({keyword:"patternProperties",schemaProp:y,dataProp:b,dataPropType:xx.Type.Str},u),i.opts.unevaluated&&d!==!0?e.assign((0,wm._)`${d}[${b}]`,!0):!w&&!i.allErrors&&e.if((0,wm.not)(u),()=>e.break())})})}}};wE.default=SJ;var bE={};Object.defineProperty(bE,"__esModule",{value:!0});const $J=Fe,xJ={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){const{gen:e,schema:r,it:n}=t;if((0,$J.alwaysValidSchema)(n,r)){t.fail();return}const s=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},s),t.failResult(s,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};bE.default=xJ;var _E={};Object.defineProperty(_E,"__esModule",{value:!0});const DJ=Pt,PJ={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:DJ.validateUnion,error:{message:"must match a schema in anyOf"}};_E.default=PJ;var EE={};Object.defineProperty(EE,"__esModule",{value:!0});const f0=St,CJ=Fe,kJ={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,f0._)`{passingSchemas: ${t.passing}}`},OJ={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:kJ,code(t){const{gen:e,schema:r,parentSchema:n,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(s.opts.discriminator&&n.discriminator)return;const i=r,o=e.let("valid",!1),a=e.let("passing",null),c=e.name("_valid");t.setParams({passing:a}),e.block(l),t.result(o,()=>t.reset(),()=>t.error(!0));function l(){i.forEach((u,d)=>{let h;(0,CJ.alwaysValidSchema)(s,u)?e.var(c,!0):h=t.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},c),d>0&&e.if((0,f0._)`${c} && ${o}`).assign(o,!1).assign(a,(0,f0._)`[${a}, ${d}]`).else(),e.if(c,()=>{e.assign(o,!0),e.assign(a,d),h&&t.mergeEvaluated(h,f0.Name)})})}}};EE.default=OJ;var AE={};Object.defineProperty(AE,"__esModule",{value:!0});const TJ=Fe,IJ={keyword:"allOf",schemaType:"array",code(t){const{gen:e,schema:r,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");const s=e.name("valid");r.forEach((i,o)=>{if((0,TJ.alwaysValidSchema)(n,i))return;const a=t.subschema({keyword:"allOf",schemaProp:o},s);t.ok(s),t.mergeEvaluated(a)})}};AE.default=IJ;var SE={};Object.defineProperty(SE,"__esModule",{value:!0});const W0=St,lT=Fe,BJ={message:({params:t})=>(0,W0.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,W0._)`{failingKeyword: ${t.ifClause}}`},FJ={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:BJ,code(t){const{gen:e,parentSchema:r,it:n}=t;r.then===void 0&&r.else===void 0&&(0,lT.checkStrictMode)(n,'"if" without "then" and "else" is ignored');const s=Dx(n,"then"),i=Dx(n,"else");if(!s&&!i)return;const o=e.let("valid",!0),a=e.name("_valid");if(c(),t.reset(),s&&i){const u=e.let("ifClause");t.setParams({ifClause:u}),e.if(a,l("then",u),l("else",u))}else s?e.if(a,l("then")):e.if((0,W0.not)(a),l("else"));t.pass(o,()=>t.error(!0));function c(){const u=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(u)}function l(u,d){return()=>{const h=t.subschema({keyword:u},a);e.assign(o,a),t.mergeValidEvaluated(h,o),d?e.assign(d,(0,W0._)`${u}`):t.setParams({ifClause:u})}}}};function Dx(t,e){const r=t.schema[e];return r!==void 0&&!(0,lT.alwaysValidSchema)(t,r)}SE.default=FJ;var $E={};Object.defineProperty($E,"__esModule",{value:!0});const NJ=Fe,RJ={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:r}){e.if===void 0&&(0,NJ.checkStrictMode)(r,`"${t}" without "if" is ignored`)}};$E.default=RJ;Object.defineProperty(pE,"__esModule",{value:!0});const jJ=wf,MJ=hE,UJ=bf,KJ=yE,LJ=mE,qJ=uT,VJ=gE,zJ=Kg,HJ=vE,WJ=wE,JJ=bE,GJ=_E,ZJ=EE,XJ=AE,YJ=SE,QJ=$E;function eG(t=!1){const e=[JJ.default,GJ.default,ZJ.default,XJ.default,YJ.default,QJ.default,VJ.default,zJ.default,qJ.default,HJ.default,WJ.default];return t?e.push(MJ.default,KJ.default):e.push(jJ.default,UJ.default),e.push(LJ.default),e}pE.default=eG;var xE={},DE={};Object.defineProperty(DE,"__esModule",{value:!0});const Tr=St,tG={message:({schemaCode:t})=>(0,Tr.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,Tr._)`{format: ${t}}`},rG={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:tG,code(t,e){const{gen:r,data:n,$data:s,schema:i,schemaCode:o,it:a}=t,{opts:c,errSchemaPath:l,schemaEnv:u,self:d}=a;if(!c.validateFormats)return;s?h():f();function h(){const p=r.scopeValue("formats",{ref:d.formats,code:c.code.formats}),y=r.const("fDef",(0,Tr._)`${p}[${o}]`),b=r.let("fType"),w=r.let("format");r.if((0,Tr._)`typeof ${y} == "object" && !(${y} instanceof RegExp)`,()=>r.assign(b,(0,Tr._)`${y}.type || "string"`).assign(w,(0,Tr._)`${y}.validate`),()=>r.assign(b,(0,Tr._)`"string"`).assign(w,y)),t.fail$data((0,Tr.or)(g(),v()));function g(){return c.strictSchema===!1?Tr.nil:(0,Tr._)`${o} && !${w}`}function v(){const m=u.$async?(0,Tr._)`(${y}.async ? await ${w}(${n}) : ${w}(${n}))`:(0,Tr._)`${w}(${n})`,_=(0,Tr._)`(typeof ${w} == "function" ? ${m} : ${w}.test(${n}))`;return(0,Tr._)`${w} && ${w} !== true && ${b} === ${e} && !${_}`}}function f(){const p=d.formats[i];if(!p){g();return}if(p===!0)return;const[y,b,w]=v(p);y===e&&t.pass(m());function g(){if(c.strictSchema===!1){d.logger.warn(_());return}throw new Error(_());function _(){return`unknown format "${i}" ignored in schema at path "${l}"`}}function v(_){const x=_ instanceof RegExp?(0,Tr.regexpCode)(_):c.code.formats?(0,Tr._)`${c.code.formats}${(0,Tr.getProperty)(i)}`:void 0,D=r.scopeValue("formats",{key:i,ref:_,code:x});return typeof _=="object"&&!(_ instanceof RegExp)?[_.type||"string",_.validate,(0,Tr._)`${D}.validate`]:["string",_,D]}function m(){if(typeof p=="object"&&!(p instanceof RegExp)&&p.async){if(!u.$async)throw new Error("async format in sync schema");return(0,Tr._)`await ${w}(${n})`}return typeof b=="function"?(0,Tr._)`${w}(${n})`:(0,Tr._)`${w}.test(${n})`}}}};DE.default=rG;Object.defineProperty(xE,"__esModule",{value:!0});const nG=DE,iG=[nG.default];xE.default=iG;var af={};Object.defineProperty(af,"__esModule",{value:!0});af.contentVocabulary=af.metadataVocabulary=void 0;af.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];af.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"];Object.defineProperty(Y_,"__esModule",{value:!0});const sG=Q_,oG=tE,aG=pE,uG=xE,Px=af,cG=[sG.default,oG.default,(0,aG.default)(),uG.default,Px.metadataVocabulary,Px.contentVocabulary];Y_.default=cG;var PE={},Lg={};Object.defineProperty(Lg,"__esModule",{value:!0});Lg.DiscrError=void 0;var Cx;(function(t){t.Tag="tag",t.Mapping="mapping"})(Cx||(Lg.DiscrError=Cx={}));Object.defineProperty(PE,"__esModule",{value:!0});const Td=St,i1=Lg,kx=gi,lG=vf,dG=Fe,fG={message:({params:{discrError:t,tagName:e}})=>t===i1.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:r}})=>(0,Td._)`{error: ${t}, tag: ${r}, tagValue: ${e}}`},pG={keyword:"discriminator",type:"object",schemaType:"object",error:fG,code(t){const{gen:e,data:r,schema:n,parentSchema:s,it:i}=t,{oneOf:o}=s;if(!i.opts.discriminator)throw new Error("discriminator: requires discriminator option");const a=n.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!o)throw new Error("discriminator: requires oneOf keyword");const c=e.let("valid",!1),l=e.const("tag",(0,Td._)`${r}${(0,Td.getProperty)(a)}`);e.if((0,Td._)`typeof ${l} == "string"`,()=>u(),()=>t.error(!1,{discrError:i1.DiscrError.Tag,tag:l,tagName:a})),t.ok(c);function u(){const f=h();e.if(!1);for(const p in f)e.elseIf((0,Td._)`${l} === ${p}`),e.assign(c,d(f[p]));e.else(),t.error(!1,{discrError:i1.DiscrError.Mapping,tag:l,tagName:a}),e.endIf()}function d(f){const p=e.name("valid"),y=t.subschema({keyword:"oneOf",schemaProp:f},p);return t.mergeEvaluated(y,Td.Name),p}function h(){var f;const p={},y=w(s);let b=!0;for(let m=0;m<o.length;m++){let _=o[m];if(_!=null&&_.$ref&&!(0,dG.schemaHasRulesButRef)(_,i.self.RULES)){const D=_.$ref;if(_=kx.resolveRef.call(i.self,i.schemaEnv.root,i.baseId,D),_ instanceof kx.SchemaEnv&&(_=_.schema),_===void 0)throw new lG.default(i.opts.uriResolver,i.baseId,D)}const x=(f=_==null?void 0:_.properties)===null||f===void 0?void 0:f[a];if(typeof x!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);b=b&&(y||w(_)),g(x,m)}if(!b)throw new Error(`discriminator: "${a}" must be required`);return p;function w({required:m}){return Array.isArray(m)&&m.includes(a)}function g(m,_){if(m.const)v(m.const,_);else if(m.enum)for(const x of m.enum)v(x,_);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function v(m,_){if(typeof m!="string"||m in p)throw new Error(`discriminator: "${a}" values must be unique strings`);p[m]=_}}}};PE.default=pG;const hG="http://json-schema.org/draft-07/schema#",yG="http://json-schema.org/draft-07/schema#",mG="Core schema meta-schema",gG={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},vG=["object","boolean"],wG={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},bG={$schema:hG,$id:yG,title:mG,definitions:gG,type:vG,properties:wG,default:!0};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.MissingRefError=e.ValidationError=e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=e.Ajv=void 0;const r=mO,n=Y_,s=PE,i=bG,o=["/properties"],a="http://json-schema.org/draft-07/schema";class c extends r.default{_addVocabularies(){super._addVocabularies(),n.default.forEach(p=>this.addVocabulary(p)),this.opts.discriminator&&this.addKeyword(s.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const p=this.opts.$data?this.$dataMetaSchema(i,o):i;this.addMetaSchema(p,a,!1),this.refs["http://json-schema.org/schema"]=a}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(a)?a:void 0)}}e.Ajv=c,t.exports=e=c,t.exports.Ajv=c,Object.defineProperty(e,"__esModule",{value:!0}),e.default=c;var l=zs;Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return l.KeywordCxt}});var u=St;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return u._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return u.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return u.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return u.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return u.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return u.CodeGen}});var d=cy;Object.defineProperty(e,"ValidationError",{enumerable:!0,get:function(){return d.default}});var h=vf;Object.defineProperty(e,"MissingRefError",{enumerable:!0,get:function(){return h.default}})})(Zb,Zb.exports);var dT=Zb.exports;const _G=Jo(dT);var s1={exports:{}},fT={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.formatNames=t.fastFormats=t.fullFormats=void 0;function e(A,S){return{validate:A,compare:S}}t.fullFormats={date:e(i,o),time:e(c,l),"date-time":e(d,h),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:y,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:E,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:w,int32:{type:"number",validate:m},int64:{type:"number",validate:_},float:{type:"number",validate:x},double:{type:"number",validate:x},password:!0,binary:!0},t.fastFormats={...t.fullFormats,date:e(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,o),time:e(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,l),"date-time":e(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,h),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i},t.formatNames=Object.keys(t.fullFormats);function r(A){return A%4===0&&(A%100!==0||A%400===0)}const n=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,s=[0,31,28,31,30,31,30,31,31,30,31,30,31];function i(A){const S=n.exec(A);if(!S)return!1;const O=+S[1],I=+S[2],N=+S[3];return I>=1&&I<=12&&N>=1&&N<=(I===2&&r(O)?29:s[I])}function o(A,S){if(A&&S)return A>S?1:A<S?-1:0}const a=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i;function c(A,S){const O=a.exec(A);if(!O)return!1;const I=+O[1],N=+O[2],j=+O[3],F=O[5];return(I<=23&&N<=59&&j<=59||I===23&&N===59&&j===60)&&(!S||F!=="")}function l(A,S){if(!(A&&S))return;const O=a.exec(A),I=a.exec(S);if(O&&I)return A=O[1]+O[2]+O[3]+(O[4]||""),S=I[1]+I[2]+I[3]+(I[4]||""),A>S?1:A<S?-1:0}const u=/t|\s/i;function d(A){const S=A.split(u);return S.length===2&&i(S[0])&&c(S[1],!0)}function h(A,S){if(!(A&&S))return;const[O,I]=A.split(u),[N,j]=S.split(u),F=o(O,N);if(F!==void 0)return F||l(I,j)}const f=/\/|:/,p=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function y(A){return f.test(A)&&p.test(A)}const b=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function w(A){return b.lastIndex=0,b.test(A)}const g=-(2**31),v=2**31-1;function m(A){return Number.isInteger(A)&&A<=v&&A>=g}function _(A){return Number.isInteger(A)}function x(){return!0}const D=/[^\\]\\Z/;function E(A){if(D.test(A))return!1;try{return new RegExp(A),!0}catch{return!1}}})(fT);var pT={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.formatLimitDefinition=void 0;const e=dT,r=St,n=r.operators,s={formatMaximum:{okStr:"<=",ok:n.LTE,fail:n.GT},formatMinimum:{okStr:">=",ok:n.GTE,fail:n.LT},formatExclusiveMaximum:{okStr:"<",ok:n.LT,fail:n.GTE},formatExclusiveMinimum:{okStr:">",ok:n.GT,fail:n.LTE}},i={message:({keyword:a,schemaCode:c})=>r.str`should be ${s[a].okStr} ${c}`,params:({keyword:a,schemaCode:c})=>r._`{comparison: ${s[a].okStr}, limit: ${c}}`};t.formatLimitDefinition={keyword:Object.keys(s),type:"string",schemaType:"string",$data:!0,error:i,code(a){const{gen:c,data:l,schemaCode:u,keyword:d,it:h}=a,{opts:f,self:p}=h;if(!f.validateFormats)return;const y=new e.KeywordCxt(h,p.RULES.all.format.definition,"format");y.$data?b():w();function b(){const v=c.scopeValue("formats",{ref:p.formats,code:f.code.formats}),m=c.const("fmt",r._`${v}[${y.schemaCode}]`);a.fail$data(r.or(r._`typeof ${m} != "object"`,r._`${m} instanceof RegExp`,r._`typeof ${m}.compare != "function"`,g(m)))}function w(){const v=y.schema,m=p.formats[v];if(!m||m===!0)return;if(typeof m!="object"||m instanceof RegExp||typeof m.compare!="function")throw new Error(`"${d}": format "${v}" does not define "compare" function`);const _=c.scopeValue("formats",{key:v,ref:m,code:f.code.formats?r._`${f.code.formats}${r.getProperty(v)}`:void 0});a.fail$data(g(_))}function g(v){return r._`${v}.compare(${l}, ${u}) ${s[d].fail} 0`}},dependencies:["format"]};const o=a=>(a.addKeyword(t.formatLimitDefinition),a);t.default=o})(pT);(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});const r=fT,n=pT,s=St,i=new s.Name("fullFormats"),o=new s.Name("fastFormats"),a=(l,u={keywords:!0})=>{if(Array.isArray(u))return c(l,u,r.fullFormats,i),l;const[d,h]=u.mode==="fast"?[r.fastFormats,o]:[r.fullFormats,i],f=u.formats||r.formatNames;return c(l,f,d,h),u.keywords&&n.default(l),l};a.get=(l,u="full")=>{const h=(u==="fast"?r.fastFormats:r.fullFormats)[l];if(!h)throw new Error(`Unknown format "${l}"`);return h};function c(l,u,d,h){var f,p;(f=(p=l.opts.code).formats)!==null&&f!==void 0||(p.formats=s._`require("ajv-formats/dist/formats").${h}`);for(const y of u)l.addFormat(y,d[y])}t.exports=e=a,Object.defineProperty(e,"__esModule",{value:!0}),e.default=a})(s1,s1.exports);var EG=s1.exports;const AG=Jo(EG);class SG extends Yo{constructor(e){super(e)}getName(){return"FilterEvaluation"}handle(e,r){const n=zt.nodes(e,"$..fields[*]");r.forEach((s,i)=>{this.createNoFieldResults(e,i,s),n.forEach(o=>{let a=[];o.value.path&&(a=gs.extractInputField(s.credential,o.value.path));let c=!1;for(const l of a)if(this.evaluateFilter(l,o.value)){c=!0;const u={result:{...a[0]},valid:!0,format:s.format};this.getResults().push({...this.createResultObject(zt.stringify(o.path.slice(0,3)),i,u)})}if(!c)if(a.length){const l={result:{...a[0]},valid:!1,format:s.format};this.createResponse(o,i,l,qr.INPUT_CANDIDATE_FAILED_FILTER_EVALUATION)}else{const l={valid:!1,format:s.format};this.createResponse(o,i,l,qr.INPUT_CANDIDATE_DOESNT_CONTAIN_PROPERTY)}})}),this.updatePresentationSubmission(e)}createNoFieldResults(e,r,n){e.input_descriptors.map((i,o)=>({index:o,inDesc:i})).filter(i=>{var o,a,c;return((o=i.inDesc.constraints)==null?void 0:o.fields)===void 0||((c=(a=i.inDesc.constraints)==null?void 0:a.fields)==null?void 0:c.length)===0}).forEach(i=>{const o={result:[],valid:!0,format:n.format};this.getResults().push({...this.createResultObject(`$.input_descriptors[${i.index}]`,r,o)})})}createResponse(e,r,n,s){this.getResults().push({...this.createResultObject(zt.stringify(e.path.slice(0,3)),r,n),status:$e.ERROR,message:s})}createResultObject(e,r,n){return{input_descriptor_path:e,verifiable_credential_path:`$[${r}]`,evaluator:this.getName(),status:$e.INFO,message:qr.INPUT_CANDIDATE_IS_ELIGIBLE_FOR_PRESENTATION_SUBMISSION,payload:n}}evaluateFilter(e,r){var s;(s=r.filter)!=null&&s.format&&r.filter.format==="date"&&this.transformDateFormat(e);const n=new _G({verbose:!0,code:{source:!0,lines:!0,esm:!1},allowUnionTypes:!0,allErrors:!0,strict:!1});return AG(n),r.filter?n.validate(r.filter,e.value):!0}transformDateFormat(e){const r=new Date(e.value);let n=r.getUTCMonth()+1+"";n.length===1&&(n="0"+n);let s=r.getUTCDate()+"";s.length===1&&(s="0"+s),e.value=r.getUTCFullYear()+"-"+n+"-"+s,e.value=r.toISOString().substring(0,r.toISOString().indexOf("T"))}}var Xt={},hT={},yT={};Object.defineProperty(yT,"__esModule",{value:!0});var mT={};Object.defineProperty(mT,"__esModule",{value:!0});var gT={};Object.defineProperty(gT,"__esModule",{value:!0});var vT={};Object.defineProperty(vT,"__esModule",{value:!0});var wT={};Object.defineProperty(wT,"__esModule",{value:!0});var bT={};Object.defineProperty(bT,"__esModule",{value:!0});var qg={};Object.defineProperty(qg,"__esModule",{value:!0});qg.Directives=void 0;qg.Directives={Required:"required",Allowed:"allowed",Disallowed:"disallowed"};var Vg={};Object.defineProperty(Vg,"__esModule",{value:!0});Vg.ExchangeStatus=void 0;Vg.ExchangeStatus={Created:"CREATED",Submitted:"SUBMITTED",HolderDeclined:"HOLDER_DECLINED",Expired:"EXPIRED",Accepted:"ACCEPTED",VerifierDeclined:"VERIFIER_DECLINED"};var _T={};Object.defineProperty(_T,"__esModule",{value:!0});var ET={};Object.defineProperty(ET,"__esModule",{value:!0});var AT={};Object.defineProperty(AT,"__esModule",{value:!0});var ST={};Object.defineProperty(ST,"__esModule",{value:!0});var $T={};Object.defineProperty($T,"__esModule",{value:!0});var xT={};Object.defineProperty(xT,"__esModule",{value:!0});var DT={};Object.defineProperty(DT,"__esModule",{value:!0});var PT={};Object.defineProperty(PT,"__esModule",{value:!0});var CT={};Object.defineProperty(CT,"__esModule",{value:!0});var kT={};Object.defineProperty(kT,"__esModule",{value:!0});var OT={};Object.defineProperty(OT,"__esModule",{value:!0});var TT={};Object.defineProperty(TT,"__esModule",{value:!0});var IT={};Object.defineProperty(IT,"__esModule",{value:!0});var BT={};Object.defineProperty(BT,"__esModule",{value:!0});var FT={};Object.defineProperty(FT,"__esModule",{value:!0});var NT={};Object.defineProperty(NT,"__esModule",{value:!0});var RT={};Object.defineProperty(RT,"__esModule",{value:!0});var jT={};Object.defineProperty(jT,"__esModule",{value:!0});var zg={};Object.defineProperty(zg,"__esModule",{value:!0});zg.Optionality=void 0;zg.Optionality={Required:"required",Preferred:"preferred"};var MT={};Object.defineProperty(MT,"__esModule",{value:!0});var UT={};Object.defineProperty(UT,"__esModule",{value:!0});var KT={};Object.defineProperty(KT,"__esModule",{value:!0});var LT={};Object.defineProperty(LT,"__esModule",{value:!0});var qT={};Object.defineProperty(qT,"__esModule",{value:!0});var VT={};Object.defineProperty(VT,"__esModule",{value:!0});var zT={};Object.defineProperty(zT,"__esModule",{value:!0});var HT={};Object.defineProperty(HT,"__esModule",{value:!0});var WT={};Object.defineProperty(WT,"__esModule",{value:!0});var Hg={};Object.defineProperty(Hg,"__esModule",{value:!0});Hg.Rules=void 0;Hg.Rules={All:"all",Pick:"pick"};var JT={};Object.defineProperty(JT,"__esModule",{value:!0});var GT={};Object.defineProperty(GT,"__esModule",{value:!0});var Wg={};Object.defineProperty(Wg,"__esModule",{value:!0});Wg.Status=void 0;Wg.Status={Success:"SUCCESS",Warn:"WARN",Error:"ERROR"};var ZT={};Object.defineProperty(ZT,"__esModule",{value:!0});var XT={};Object.defineProperty(XT,"__esModule",{value:!0});var YT={};Object.defineProperty(YT,"__esModule",{value:!0});var QT={};Object.defineProperty(QT,"__esModule",{value:!0});(function(t){var e=Zt&&Zt.__createBinding||(Object.create?function(n,s,i,o){o===void 0&&(o=i);var a=Object.getOwnPropertyDescriptor(s,i);(!a||("get"in a?!s.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return s[i]}}),Object.defineProperty(n,o,a)}:function(n,s,i,o){o===void 0&&(o=i),n[o]=s[i]}),r=Zt&&Zt.__exportStar||function(n,s){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(s,i)&&e(s,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(yT,t),r(mT,t),r(gT,t),r(vT,t),r(wT,t),r(bT,t),r(qg,t),r(Vg,t),r(_T,t),r(ET,t),r(AT,t),r(ST,t),r($T,t),r(xT,t),r(DT,t),r(PT,t),r(CT,t),r(kT,t),r(OT,t),r(TT,t),r(IT,t),r(BT,t),r(FT,t),r(NT,t),r(RT,t),r(jT,t),r(zg,t),r(MT,t),r(UT,t),r(KT,t),r(LT,t),r(qT,t),r(VT,t),r(zT,t),r(HT,t),r(WT,t),r(Hg,t),r(JT,t),r(GT,t),r(Wg,t),r(ZT,t),r(XT,t),r(YT,t),r(QT,t)})(hT);(function(t){var e=Zt&&Zt.__createBinding||(Object.create?function(n,s,i,o){o===void 0&&(o=i);var a=Object.getOwnPropertyDescriptor(s,i);(!a||("get"in a?!s.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return s[i]}}),Object.defineProperty(n,o,a)}:function(n,s,i,o){o===void 0&&(o=i),n[o]=s[i]}),r=Zt&&Zt.__exportStar||function(n,s){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(s,i)&&e(s,n,i)};Object.defineProperty(t,"__esModule",{value:!0}),r(hT,t)})(Xt);class $G extends Yo{constructor(r){super(r);de(this,"fieldIdzInputDescriptorsSameSubjectRequired");de(this,"fieldIdzInputDescriptorsSameSubjectPreferred");de(this,"fieldIds");de(this,"isHolder");de(this,"credentialsSubjectsByPath");de(this,"credentialsByPath");de(this,"messages");this.fieldIdzInputDescriptorsSameSubjectRequired=new Map,this.fieldIdzInputDescriptorsSameSubjectPreferred=new Map,this.isHolder=[],this.fieldIds=[],this.credentialsSubjectsByPath=new Map,this.credentialsByPath=new Map,this.messages=new Map,this.messages.set($e.INFO,"The field ids requiring the subject to be the holder"),this.messages.set($e.WARN,"The field ids preferring the subject to be the holder"),this.messages.set($e.ERROR,"The field id missing")}getName(){return"IsHolderEvaluation"}handle(r,n){this.findIsHolderFieldIdsToInputDescriptorsSets(r),this.findAllCredentialSubjects(n),this.confirmAllFieldSetHasSameSubject(this.fieldIdzInputDescriptorsSameSubjectRequired,$e.INFO,Xt.Optionality.Required),this.confirmAllFieldSetHasSameSubject(this.fieldIdzInputDescriptorsSameSubjectPreferred,$e.WARN,Xt.Optionality.Preferred),this.updatePresentationSubmission(r)}findIsHolderFieldIdsToInputDescriptorsSets(r){var i;this.fieldIds.push(...zt.nodes(r,"$..fields[*].id")),this.isHolder.push(...zt.nodes(r,"$..is_holder[*]"));const n=(i=this.fieldIds)==null?void 0:i.map(o=>o.value),s=[];s.push(...this.evaluateFields(this.fieldIdzInputDescriptorsSameSubjectPreferred,this.isHolder,n,Xt.Optionality.Preferred)),s.push(...this.evaluateFields(this.fieldIdzInputDescriptorsSameSubjectRequired,this.isHolder,n,Xt.Optionality.Required)),s.forEach(o=>this.getResults().push(this.createResult(o[1],o[0],["",{}],$e.ERROR,void 0)))}evaluateFields(r,n,s,i){const o=[];return n.filter(a=>a.value.directive===i).filter(a=>a.value.field_id.every(c=>s.includes(c))).forEach(a=>r.set(zt.stringify(a.path.slice(0,3)),a.value.field_id)),n.filter(a=>a.value.directive===i).filter(a=>!a.value.field_id.every(c=>s.includes(c))).forEach(a=>o.push([zt.stringify(a.path.slice(0,3)),a.value.field_id])),o}findAllCredentialSubjects(r){const n=zt.nodes(r.map(s=>s.credential),"$..credentialSubject");for(let s=0;s<n.length;s++){const i=n[s],o=zt.stringify(i.path.slice(0,2));this.credentialsSubjectsByPath.set(o,i.value),this.credentialsByPath.set(o,r[s])}}confirmAllFieldSetHasSameSubject(r,n,s){const i=Array.from(r).flatMap(l=>Array.from(this.credentialsSubjectsByPath).filter(u=>l[1].find(d=>Object.keys(u[1]).includes(d)))),o=this.mapCredentialPathsToInputDescriptors(s),a=Array.from(i).flatMap(l=>Object.keys(l[1]).filter(u=>u!=="id")),c=Array.from(r.values()).flatMap(l=>l.every(u=>a.includes(u)))[0];i.forEach(l=>{const u=o.get(l[0]);c&&l[1].id&&this.client.dids.includes(l[1].id)?this.getResults().push(this.createResult(Object.keys(l[1]).filter(d=>d!=="id"),u,l,n,this.credentialsByPath.get(l[0]))):this.getResults().push(this.createResult(Object.keys(l[1]).filter(d=>d!=="id"),u,l,$e.ERROR,this.credentialsByPath.get(l[0])))})}mapCredentialPathsToInputDescriptors(r){var s;const n=new Map;return(s=this.fieldIds)==null||s.forEach(i=>{const o=zt.stringify(i.path.slice(0,3));this.credentialsSubjectsByPath.forEach((a,c)=>{const l=this.isHolder.find(u=>zt.stringify(u.path.slice(0,3))===o);Object.keys(a).includes(i.value)&&(l==null?void 0:l.value.directive)===r&&n.set(c,o)})}),n}createResult(r,n,s,i,o,a){return{input_descriptor_path:n,verifiable_credential_path:s[0],evaluator:this.getName(),status:i,payload:{fieldIdSet:r,credentialSubject:s[1],...o?{format:o.format}:{}},message:a??this.messages.get(i)}}}class xG extends Yo{constructor(e){super(e)}getName(){return"LimitDisclosureEvaluation"}handle(e,r){e.input_descriptors.forEach((n,s)=>{var i,o,a;(i=n.constraints)!=null&&i.fields&&(((o=n.constraints)==null?void 0:o.limit_disclosure)===Xt.Optionality.Required||((a=n.constraints)==null?void 0:a.limit_disclosure)===Xt.Optionality.Preferred)&&this.evaluateLimitDisclosure(r,n.constraints,s)})}isLimitDisclosureSupported(e,r,n,s){const i=this.client.limitDisclosureSignatureSuites,o=e.decoded.proof;return!o||Array.isArray(o)||!o.type?!1:i!=null&&i.includes(o.type)?!0:(s==Xt.Optionality.Required&&this.createLimitDisclosureNotSupportedResult(n,r),!1)}evaluateLimitDisclosure(e,r,n){const s=r==null?void 0:r.fields,i=r.limit_disclosure;e.forEach((o,a)=>{i&&this.isLimitDisclosureSupported(o,a,n,i)&&this.enforceLimitDisclosure(o.credential,s,n,a,e,i)})}enforceLimitDisclosure(e,r,n,s,i,o){const a=this.createVcWithRequiredFields(e,r,n,s);a&&(i[s].credential=a,this.createSuccessResult(n,`$[${s}]`,o))}createVcWithRequiredFields(e,r,n,s){let i={};i=Object.assign(i,e),i.credentialSubject={};for(const o of r)if(o.path){const a=gs.extractInputField(e,o.path);if(a.length>0)i=this.copyResultPathToDestinationCredential(a[0],e,i);else{this.createMandatoryFieldNotFoundResult(n,s,o.path);return}}return i}copyResultPathToDestinationCredential(e,r,n){let s={...r.credentialSubject};return e.path.forEach(i=>{s[i]&&(s={[i]:s[i]})}),n.credentialSubject={...n.credentialSubject,...s},n}createSuccessResult(e,r,n){return this.getResults().push({input_descriptor_path:`$.input_descriptors[${e}]`,verifiable_credential_path:`${r}`,evaluator:this.getName(),status:n===Xt.Optionality.Required?$e.INFO:$e.WARN,message:qr.LIMIT_DISCLOSURE_APPLIED,payload:void 0})}createMandatoryFieldNotFoundResult(e,r,n){return this.getResults().push({input_descriptor_path:`$.input_descriptors[${e}]`,verifiable_credential_path:`$[${r}]`,evaluator:this.getName(),status:$e.ERROR,message:qr.VERIFIABLE_CREDENTIAL_MANDATORY_FIELD_NOT_PRESENT,payload:n})}createLimitDisclosureNotSupportedResult(e,r){return this.getResults().push({input_descriptor_path:`$.input_descriptors[${e}]`,verifiable_credential_path:`$[${r}]`,evaluator:this.getName(),status:$e.ERROR,message:qr.LIMIT_DISCLOSURE_NOT_SUPPORTED})}}class DG extends Yo{constructor(e){super(e)}getName(){return"MarkForSubmissionEvaluation"}handle(e,r){const n=[...this.getResults()],s=n.filter(o=>o.status===$e.ERROR),i=this.retrieveNoErrorStatus(n,s);this.client.wrappedVcs=r,this.produceErrorResults(s),this.produceSuccessResults(i,e)}retrieveNoErrorStatus(e,r){return e.filter(s=>s.status!==$e.ERROR).filter(s=>!r.find(i=>s.input_descriptor_path===i.input_descriptor_path&&s.verifiable_credential_path===i.verifiable_credential_path))}produceSuccessResults(e,r){this.removeDuplicate(e).forEach(n=>{const i=zt.nodes(r,n.input_descriptor_path)[0].value.group;this.getResults().push({input_descriptor_path:n.input_descriptor_path,verifiable_credential_path:n.verifiable_credential_path,evaluator:this.getName(),status:$e.INFO,payload:{group:i},message:qr.INPUT_CANDIDATE_IS_ELIGIBLE_FOR_PRESENTATION_SUBMISSION})})}produceErrorResults(e){this.removeDuplicate(e).forEach(r=>{const n={...r.payload};n.evaluator=r.evaluator,this.getResults().push({...r,evaluator:this.getName(),message:qr.INPUT_CANDIDATE_IS_NOT_ELIGIBLE_FOR_PRESENTATION_SUBMISSION,payload:n})})}}class PG extends Yo{constructor(e){super(e)}getName(){return"PredicateRelatedFieldEvaluation"}handle(e){e.input_descriptors.forEach((r,n)=>{r.constraints&&this.examinePredicateRelatedField(n,r.constraints)})}examinePredicateRelatedField(e,r){if(r!=null&&r.fields)for(let n=0;n<r.fields.length;n++)for(let s=0;s<this.getResults().length;s++)this.examinePredicateForFilterEvaluationResult(this.getResults(),s,e,r,n)}examinePredicateForFilterEvaluationResult(e,r,n,s,i){var a;const o=this.retrieveResultInputDescriptorIdx(e[r].input_descriptor_path);if(e[r].payload&&e[r].payload.result&&e[r].payload.result.path&&e[r].evaluator==="FilterEvaluation"&&n===o&&s&&s.fields&&s.fields[i]&&s.fields[i].predicate&&s.fields[i].path&&((a=s.fields[i].path)!=null&&a.includes(this.concatenatePath(e[r].payload.result.path)))){const c={...e[r].payload.result},l=this.createResultObject(n,r,c,e);s.fields[i].predicate===Xt.Optionality.Required||(l.payload.value=!0),e.push(l)}}retrieveResultInputDescriptorIdx(e){const r="$.input_descriptors[",n=e.indexOf(r),s=e.substring(n+r.length),i=s.indexOf("]"),o=s.substring(0,i);return parseInt(o)}concatenatePath(e){let r="";for(let n=0;n<e.length;n++)typeof e[n]=="number"?(r=r.substring(0,r.length-1),r+="[*]."):r+=e[n]+".";return r.substring(0,r.length-1)}createResultObject(e,r,n,s){return{input_descriptor_path:`$.input_descriptors[${e}]`,verifiable_credential_path:s[r].verifiable_credential_path,evaluator:this.getName(),status:$e.INFO,message:qr.INPUT_CANDIDATE_IS_ELIGIBLE_FOR_PRESENTATION_SUBMISSION,payload:n}}}class CG extends Yo{constructor(r){super(r);de(this,"fieldIds");de(this,"sameSubject");de(this,"messages");this.fieldIds=[],this.sameSubject=[],this.messages=new Map,this.messages.set($e.INFO,"The field ids requiring the same subject to belong to same subject"),this.messages.set($e.WARN,"The field ids preferring the same subject to belong to same subject"),this.messages.set($e.ERROR,"The fields ids not belong to the same subject")}getName(){return"SameSubjectEvaluation"}handle(r,n){const s=this.mapSameSubjectFieldIdsToInputDescriptors(r),i=this.mapCredentialsToResultObjecs(n,s),o=this.countSameSubjectOccurrences(s,i);this.generateErrorResults(o,i),this.updatePresentationSubmission(r)}mapSameSubjectFieldIdsToInputDescriptors(r){this.fieldIds.push(...zt.nodes(r,"$..fields[*].id")),this.sameSubject.push(...zt.nodes(r,"$..same_subject[*]"));const n=[];return this.fieldIds.forEach(s=>{const i=this.sameSubject.find(o=>o.value.field_id.includes(s.value));i&&n.push([s,i])}),n}generateErrorResults(r,n){r.forEach((s,i)=>{const o=n.filter(a=>i===a.payload.fieldIdSet).map(a=>a.payload.credentialSubject.id);(o.length!==s||new Set(o).size!==1)&&n.forEach((a,c,l)=>{a.payload.fieldIdSet===i&&(a.status=$e.ERROR,a.message=this.messages.get($e.ERROR),l[c]=a)})}),this.client.results.push(...n)}countSameSubjectOccurrences(r,n){const s=new Map;return r.forEach(i=>{n.filter(a=>i[1].value.field_id===a.payload.fieldIdSet)&&(s.has(i[1].value.field_id)&&s.get(i[1].value.field_id)?s.set(i[1].value.field_id,s.get(i[1].value.field_id)+1):s.set(i[1].value.field_id,1))}),s}mapCredentialsToResultObjecs(r,n){const s=[...zt.nodes(r.map(o=>o.credential),"$..credentialSubject")],i=[];return s.forEach(o=>{const a=n.find(c=>zt.query(o.value,`$..${c[0].value}`).length!==0);a&&a[1].value.directive===Xt.Optionality.Required?i.push({input_descriptor_path:zt.stringify(a[0].path.slice(0,3)),status:$e.INFO,evaluator:this.getName(),payload:{fieldIdSet:a[1].value.field_id,credentialSubject:o.value},message:this.messages.get($e.INFO),verifiable_credential_path:zt.stringify(o.path.slice(0,2))}):a&&a[1].value.directive===Xt.Optionality.Preferred&&i.push({input_descriptor_path:zt.stringify(a[0].path.slice(0,3)),status:$e.WARN,evaluator:this.getName(),payload:{fieldIdSet:a[1].value.field_id,credentialSubject:o.value},message:this.messages.get($e.WARN),verifiable_credential_path:zt.stringify(o.path.slice(0,2))})}),i}}class kG extends Yo{constructor(e){super(e)}getName(){return"SubjectIsIssuerEvaluation"}handle(e,r){e.input_descriptors.forEach((n,s)=>{const i=n.constraints;(i==null?void 0:i.subject_is_issuer)===Xt.Optionality.Required?this.checkSubjectIsIssuer(n.id,r,s):this.getResults().push(...r.map((o,a)=>this.generateSuccessResult(s,`$[${a}]`,o,"not applicable")))}),this.updatePresentationSubmission(e)}checkSubjectIsIssuer(e,r,n){this.client.presentationSubmission.descriptor_map.forEach(s=>{if(s.id===e){const i=gs.extractInputField(r.map(o=>o.credential),[s.path]);for(const o of i){const a=kV(o.value);o&&o.value&&CV(o.value).every(c=>c===a)?this.getResults().push(this.generateSuccessResult(n,s.path,sf.CredentialMapper.toWrappedVerifiableCredential(o.value))):this.getResults().push(this.generateErrorResult(n,s.path,sf.CredentialMapper.toWrappedVerifiableCredential(o.value)))}}})}generateErrorResult(e,r,n){return{input_descriptor_path:`$.input_descriptors[${e}]`,evaluator:this.getName(),status:$e.ERROR,message:qr.SUBJECT_IS_NOT_ISSUER,verifiable_credential_path:r,payload:{format:n.format}}}generateSuccessResult(e,r,n,s){return{input_descriptor_path:`$.input_descriptors[${e}]`,evaluator:this.getName(),status:$e.INFO,message:s??qr.SUBJECT_IS_ISSUER,verifiable_credential_path:r,payload:{format:n.format}}}}let OG=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,r)=>(r&=63,r<36?e+=r.toString(36):r<62?e+=(r-26).toString(36).toUpperCase():r>62?e+="-":e+="_",e),"");const Pa=class Pa extends Yo{constructor(e){super(e)}getName(){return"UriEvaluation"}handle(e,r){e.input_descriptors.forEach((s,i)=>{const o=e.getVersion()!==Vs.v2?s.schema.map(a=>a.uri):[];r.forEach((a,c)=>{const l=Pa.buildVcContextAndSchemaUris(a.credential,e.getVersion());this.evaluateUris(a,l,o,i,c,e.getVersion())})});const n=this.getResults().filter(s=>s.status===$e.INFO).map(s=>{var o;return{id:zt.nodes(e,s.input_descriptor_path)[0].value.id,format:(o=s.payload)==null?void 0:o.format,path:s.verifiable_credential_path}});this.client.generatePresentationSubmission&&(!this.presentationSubmission||Object.keys(this.presentationSubmission).length===0)&&(this.presentationSubmission={id:OG(),definition_id:e.id,descriptor_map:n})}evaluateUris(e,r,n,s,i,o){let a=!1;if(o===Vs.v1){for(let c=0;c<n.length;c++)Pa.containsHashlink(n[c])&&this.getResults().push(this.createWarnResultObject(s,i));for(let c=0;c<r.length;c++)n.find(l=>l===r[c])!=null&&(a=!0)}else a=!0;a?this.getResults().push(this.createSuccessResultObject(e,n,s,i)):this.getResults().push(this.createErrorResultObject(e,n,s,i))}static buildVcContextAndSchemaUris(e,r){const n=[];return Array.isArray(e["@context"])?e["@context"].forEach(s=>n.push(s)):n.push(e["@context"]),Array.isArray(e.credentialSchema)&&e.credentialSchema.length>0?e.credentialSchema.forEach(s=>n.push(s.id)):e.credentialSchema&&n.push(e.credentialSchema.id),r===Vs.v1&&(Array.isArray(e.type)?e.type.forEach(s=>n.push(s)):e.type&&n.push(e.type)),n}createSuccessResultObject(e,r,n,s){const i=this.createResult(n,s);return i.status=$e.INFO,i.message=qr.URI_EVALUATION_PASSED,i.payload={format:e.format,vcContext:e.credential["@context"],vcCredentialSchema:e.credential.credentialSchema,inputDescriptorsUris:r},i}createErrorResultObject(e,r,n,s){const i=this.createResult(n,s);return i.status=$e.ERROR,i.message=qr.URI_EVALUATION_DIDNT_PASS,i.payload={format:e.format,vcContext:e.credential["@context"],vcCredentialSchema:e.credential.credentialSchema,inputDescriptorsUris:r},i}createWarnResultObject(e,r){const n=this.createResult(e,r);return n.status=$e.WARN,n.message=qr.URI_EVALUATION_DIDNT_PASS,n.payload=qr.INPUT_DESCRIPTOR_CONTEXT_CONTAINS_HASHLINK_VERIFICATION_NOT_SUPPORTED,n}createResult(e,r){return{input_descriptor_path:`$.input_descriptors[${e}]`,verifiable_credential_path:`$[${r}]`,evaluator:this.getName(),status:$e.INFO,message:void 0}}static containsHashlink(e){return!(this.matchAll(e,Pa.HASHLINK_QUERY_URL_REGEX).next().done&&this.matchAll(e,Pa.HASHLINK_URL_ENCODED_REGEX).next().done)}};de(Pa,"matchAll",require("string.prototype.matchall")),de(Pa,"HASHLINK_URL_ENCODED_REGEX",/hl:[a-zA-Z0-9]+:[a-zA-Z0-9]+/g),de(Pa,"HASHLINK_QUERY_URL_REGEX",/https*?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&/=]*)(hl=[a-zA-Z0-9]+)/g);let o1=Pa;class TG extends Yo{constructor(e){super(e)}getName(){return"FormatRestrictionEvaluation"}handle(e,r){e.input_descriptors.forEach((n,s)=>{r.forEach((i,o)=>{!this.client.restrictToFormats||Object.keys(this.client.restrictToFormats).includes(i.format)?this.getResults().push(this.generateSuccessResult(s,`$[${o}]`,i,`${i.format} is allowed`)):this.getResults().push(this.generateErrorResult(s,`$[${o}]`,i))})}),this.updatePresentationSubmission(e)}generateErrorResult(e,r,n){return{input_descriptor_path:`$.input_descriptors[${e}]`,evaluator:this.getName(),status:$e.ERROR,message:qr.FORMAT_RESTRICTION_DIDNT_PASS,verifiable_credential_path:r,payload:{format:n.format}}}generateSuccessResult(e,r,n,s){return{input_descriptor_path:`$.input_descriptors[${e}]`,evaluator:this.getName(),status:$e.INFO,message:s??qr.FORMAT_RESTRICTION_PASSED,verifiable_credential_path:r,payload:{format:n.format}}}}class IG extends Yo{constructor(e){super(e)}getName(){return"DIDRestrictionEvaluation"}handle(e,r){e.input_descriptors.forEach((n,s)=>{r.forEach((i,o)=>{const a=typeof i.credential.issuer=="object"?i.credential.issuer.id:i.credential.issuer;!this.client.hasRestrictToDIDMethods()||!a||OV(a,this.client.restrictToDIDMethods)||!a.toLowerCase().startsWith("did:")?this.getResults().push(this.generateSuccessResult(s,`$[${o}]`,i,`${a} is allowed`)):this.getResults().push(this.generateErrorResult(s,`$[${o}]`,i))})}),this.updatePresentationSubmission(e)}generateErrorResult(e,r,n){return{input_descriptor_path:`$.input_descriptors[${e}]`,evaluator:this.getName(),status:$e.ERROR,message:qr.FORMAT_RESTRICTION_DIDNT_PASS,verifiable_credential_path:r,payload:{format:n.format}}}generateSuccessResult(e,r,n,s){return{input_descriptor_path:`$.input_descriptors[${e}]`,evaluator:this.getName(),status:$e.INFO,message:s??qr.FORMAT_RESTRICTION_PASSED,verifiable_credential_path:r,payload:{format:n.format}}}}const Ox=[sf.IProofType.BbsBlsSignatureProof2020];class BG{constructor(){de(this,"failed_catched",{tag:"root",status:$e.ERROR,message:qr.UNKNOWN_EXCEPTION,stacktrace:""});de(this,"_results");de(this,"_wrappedVcs");de(this,"_presentationSubmission");de(this,"_dids");de(this,"_limitDisclosureSignatureSuites");de(this,"_restrictToFormats");de(this,"_restrictToDIDMethods");de(this,"_generatePresentationSubmission");this._results=[],this._wrappedVcs=[],this._presentationSubmission={},this._dids=[],this._limitDisclosureSignatureSuites=Ox,this._restrictToDIDMethods=[],this._generatePresentationSubmission=!0}evaluate(e,r,n){this._restrictToDIDMethods=n!=null&&n.restrictToDIDMethods?L0(n==null?void 0:n.restrictToDIDMethods):[],this._dids=n!=null&&n.holderDIDs?TV(n.holderDIDs,this._restrictToDIDMethods):[],this._limitDisclosureSignatureSuites=n==null?void 0:n.limitDisclosureSignatureSuites,this._restrictToFormats=n==null?void 0:n.restrictToFormats,this._generatePresentationSubmission=(n==null?void 0:n.generatePresentationSubmission)!==void 0?n.generatePresentationSubmission:!0,n!=null&&n.presentationSubmission&&(this._presentationSubmission=n.presentationSubmission);let s=this.initEvaluationHandlers();for(s==null||s.handle(e,r);s!=null&&s.hasNext();){s=s.getNext();try{s==null||s.handle(e,r)}catch(i){throw this.failed_catched.message+=i.message,this.failed_catched.stacktrace=i,this.failed_catched}}}get results(){return this._results}get dids(){return this._dids}set dids(e){this._dids=e}assertPresentationSubmission(){if(!this.generatePresentationSubmission&&(!this.presentationSubmission||Object.keys(this.presentationSubmission).length===0))throw Error("No presentation submission present, but required option was set")}get generatePresentationSubmission(){return this._generatePresentationSubmission}set generatePresentationSubmission(e){this._generatePresentationSubmission=e}get presentationSubmission(){return this._presentationSubmission}set presentationSubmission(e){this._presentationSubmission=e}get wrappedVcs(){return this._wrappedVcs}set wrappedVcs(e){this._wrappedVcs=e}get limitDisclosureSignatureSuites(){return this._limitDisclosureSignatureSuites||Ox}set limitDisclosureSignatureSuites(e){this._limitDisclosureSignatureSuites=e}get restrictToDIDMethods(){return this._restrictToDIDMethods}set restrictToDIDMethods(e){this._restrictToDIDMethods=L0(e)}hasRestrictToDIDMethods(){return this.restrictToDIDMethods&&this.restrictToDIDMethods.length>0}get restrictToFormats(){return this._restrictToFormats}set restrictToFormats(e){this._restrictToFormats=e}initEvaluationHandlers(){const e=new o1(this);return e.setNext(new IG(this)).setNext(new TG(this)).setNext(new SG(this)).setNext(new PG(this)).setNext(new xG(this)).setNext(new kG(this)).setNext(new $G(this)).setNext(new CG(this)).setNext(new DG(this)),e}}class gp{constructor(){de(this,"_client");this._client=new BG}getEvaluationClient(){return this._client}selectFrom(e,r,n){var a;let s;this._client.evaluate(e,r,n);const i=[...this.formatNotInfo($e.WARN)],o=[...this.formatNotInfo($e.ERROR)];if(e.submission_requirements){const c=this._client.results.filter(p=>p.evaluator==="MarkForSubmissionEvaluation"&&p.payload.group&&p.status!==$e.ERROR),l=Array.from(new Set(c));let u;try{u=this.matchSubmissionRequirements(e,e.submission_requirements,l)}catch(p){const y={status:$e.ERROR,message:JSON.stringify(p),tag:"matchSubmissionRequirements"};return{errors:o?[...o,y]:[y],warnings:i,areRequiredCredentialsPresent:$e.ERROR}}const h=this.extractMatches(u).map(p=>zt.nodes(this._client.wrappedVcs.map(y=>y.original),p)[0].value),f=this.determineAreRequiredCredentialsPresent(e,u);s={errors:f===$e.INFO?[]:o,matches:[...u],areRequiredCredentialsPresent:f,verifiableCredential:h,warnings:i}}else{const c=this._client.results.filter(u=>u.evaluator==="MarkForSubmissionEvaluation"&&u.status!==$e.ERROR);if(this.checkWithoutSubmissionRequirements(c,e).length)return{errors:o,matches:[],areRequiredCredentialsPresent:$e.ERROR,verifiableCredential:r.map(u=>u.original),warnings:i};{const u=this.matchWithoutSubmissionRequirements(c,e),h=this.extractMatches(u).map(f=>zt.nodes(this._client.wrappedVcs.map(p=>p.original),f)[0].value);s={errors:[],matches:[...u],areRequiredCredentialsPresent:$e.INFO,verifiableCredential:h,warnings:i}}}return this.fillSelectableCredentialsToVerifiableCredentialsMapping(s,r),s.areRequiredCredentialsPresent=this.determineAreRequiredCredentialsPresent(e,s==null?void 0:s.matches),this.remapMatches(r.map(c=>c.original),s.matches,s==null?void 0:s.verifiableCredential),(a=s.matches)==null||a.forEach(c=>{this.updateSubmissionRequirementMatchPathToAlias(c,"verifiableCredential")}),s.areRequiredCredentialsPresent===$e.INFO?s.errors=[]:(s.errors=o,s.warnings=i,s.verifiableCredential=r.map(c=>c.original)),s}remapMatches(e,r,n){r==null||r.forEach(s=>{s.from_nested?this.remapMatches(e,s.from_nested,n):(s.vc_path.forEach((i,o,a)=>{const c=zt.query(e,i)[0],l=n==null?void 0:n.findIndex(u=>JSON.stringify(u)===JSON.stringify(c));if(l===-1)throw new Error(`The index of the VerifiableCredential in your current call can't be found in your previously submitted credentials. Are you trying to send a new Credential?
verifiableCredential: ${c}`);a[o]=`$[${l}]`}),s.name)})}extractMatches(e){const r=[];return e.forEach(n=>{r.push(...n.vc_path),n.from_nested&&r.push(...this.extractMatches(n.from_nested))}),Array.from(new Set(r))}checkWithoutSubmissionRequirements(e,r){const n=[];if(!r.input_descriptors)return[];if(!e.length)return[{input_descriptor_path:"",evaluator:"checkWithoutSubmissionRequirement",verifiable_credential_path:"",status:$e.ERROR,payload:"Not all the InputDescriptors are addressed"}];const s=r.input_descriptors,i=Ci.getDistinctFieldInObject(e,"input_descriptor_path");if(i.length!==s.length){const o=i.map(a=>gs.extractInputField(r,[a])[0].value).map(a=>a.id);for(let a=0;a<r.input_descriptors.length;a++)o.indexOf(r.input_descriptors[a].id)==-1&&n.push({input_descriptor_path:`$.input_descriptors[${a}]`,evaluator:"checkWithoutSubmissionRequirement",verifiable_credential_path:"",status:$e.ERROR,payload:"Not all the InputDescriptors are addressed"})}return n}matchSubmissionRequirements(e,r,n){const s=[];for(const i of r){const o={name:e.name||e.id,rule:i.rule,vc_path:[]};if(i.from&&(o.from=i.from),i.min&&(o.min=i.min),i.max&&(o.max=i.max),i.count&&(o.count=i.count),i.from){const a=this.mapMatchingDescriptors(e,i,n);a&&(o.vc_path.push(...a.vc_path),o.name=a.name,s.push(o))}else if(i.from_nested)try{o.from_nested=this.matchSubmissionRequirements(e,i.from_nested,n),s.push(o)}catch(a){throw new Error(`Error in handling value of from_nested: ${i.from_nested}: err: ${a}`)}else throw new Error("Invalid SubmissionRequirement object: Must contain either 'from' or 'from_nested'")}return s}matchWithoutSubmissionRequirements(e,r){const n=[],s=this.createIdToVcMap(e);for(const[i,o]of s.entries())if(!(!o||!o.length))for(const a of o){const c=gs.extractInputField(r,[i]);c.length&&n.push({name:c[0].value.name||c[0].value.id,rule:Xt.Rules.All,vc_path:[a]})}return this.removeDuplicateSubmissionRequirementMatches(n)}mapMatchingDescriptors(e,r,n){var i;const s={rule:r.rule,vc_path:[]};if(r!=null&&r.from){s.from=r.from;for(const o of n){const a=zt.query(e,o.input_descriptor_path)[0];a.group&&a.group.indexOf(r.from)===-1||(s.name=a.name||a.id,o.payload.group.includes(r.from)&&((i=s.vc_path)==null?void 0:i.indexOf(o.verifiable_credential_path))===-1&&s.vc_path.push(o.verifiable_credential_path))}}return s}evaluate(e,r,n){var i,o,a,c;this._client.evaluate(e,r,n);const s={areRequiredCredentialsPresent:$e.INFO,verifiableCredential:r.map(l=>l.original)};if(s.warnings=this.formatNotInfo($e.WARN),s.errors=this.formatNotInfo($e.ERROR),this._client.assertPresentationSubmission(),(i=this._client.presentationSubmission)!=null&&i.descriptor_map.length){const l=(o=this._client.presentationSubmission)==null?void 0:o.descriptor_map.length;for(let u=0;u<l;u++)this._client.presentationSubmission.descriptor_map[u]&&this._client.presentationSubmission.descriptor_map.push(this._client.presentationSubmission.descriptor_map[u]);this._client.presentationSubmission.descriptor_map.splice(0,l),s.value=JSON.parse(JSON.stringify(this._client.presentationSubmission))}return this._client.generatePresentationSubmission&&this.updatePresentationSubmissionPathToAlias("verifiableCredential",s.value),s.verifiableCredential=this._client.wrappedVcs.map(l=>l.original),s.areRequiredCredentialsPresent=(c=(a=s.value)==null?void 0:a.descriptor_map)!=null&&c.length?$e.INFO:$e.ERROR,s}formatNotInfo(e){return this._client.results.filter(r=>r.status===e).map(r=>{const n=r.verifiable_credential_path.substring(1);return{tag:r.evaluator,status:r.status,message:`${r.message}: ${r.input_descriptor_path}: $.verifiableCredential${n}`}})}submissionFrom(e,r){if(!this._client.results.length)throw Error("You need to call evaluate() before pex.presentationFrom()");if(!this._client.generatePresentationSubmission)return this._client.presentationSubmission;if(e.submission_requirements){const i=this._client.results.filter(d=>d.evaluator==="MarkForSubmissionEvaluation"&&d.payload.group&&d.status!==$e.ERROR),[o,a]=this.matchUserSelectedVcs(i,r),c=new Map;"input_descriptors"in e&&e.input_descriptors.forEach(d=>{d.group&&d.group.forEach(h=>{c.has(h)?c.set(h,c.get(h)+1):c.set(h,1)})});const l=this.evaluateRequirements(e.submission_requirements,o,c,0),u=a.filter(d=>l[1].find(h=>h.verifiable_credential_path===d[1]));return this.updatePresentationSubmission(u),this.updatePresentationSubmissionPathToAlias("verifiableCredential"),this._client.presentationSubmission}const n=this._client.results.filter(i=>i.evaluator==="MarkForSubmissionEvaluation"&&i.status!==$e.ERROR),s=this.matchUserSelectedVcs(n,r);return this.updatePresentationSubmission(s[1]),this.updatePresentationSubmissionPathToAlias("verifiableCredential"),this._client.presentationSubmission}updatePresentationSubmission(e){this._client.generatePresentationSubmission&&(this._client.presentationSubmission.descriptor_map=this._client.presentationSubmission.descriptor_map.filter(r=>e.find(n=>n[0]===r.path)).map(r=>{const n=e.find(s=>s[0]===r.path);return n&&(r.path=n[1]),r}))}matchUserSelectedVcs(e,r){const n=r.map((o,a)=>[a,JSON.stringify(o.original)]),s=this._client.wrappedVcs.map((o,a)=>[a,JSON.stringify(o.original)]),i=[];return n.forEach((o,a)=>{s.forEach((c,l)=>{c[1]===o[1]&&i.push([`$[${l}]`,`$[${a}]`])})}),e=e.filter(o=>i.find(a=>a[0]===o.verifiable_credential_path)).map(o=>{const a=i.find(c=>c[0]===o.verifiable_credential_path);return a&&(o.verifiable_credential_path=a[1]),o}),[e,i]}evaluateRequirements(e,r,n,s){let i=0;const o=[];for(const a of e)if(a.from){if(a.rule===Xt.Rules.All){const[c,l]=this.countMatchingInputDescriptors(a,r);if(c!==n.get(a.from))throw Error(`Not all input descriptors are members of group ${a.from}`);i++,o.push(...l)}else if(a.rule===Xt.Rules.Pick){const[c,l]=this.countMatchingInputDescriptors(a,r);try{this.handleCount(a,c,s),i++}catch(u){if(s===0)throw u}o.push(...l)}}else if(a.from_nested){const[c,l]=this.evaluateRequirements(a.from_nested,r,n,++s);i+=c,o.push(...l),this.handleCount(a,c,s)}return[i,o]}countMatchingInputDescriptors(e,r){let n=0;const s=[];for(const i of r)i.payload.group.includes(e.from)&&(s.push(i),n++);return[n,s]}handleCount(e,r,n){if(e.count&&r!==e.count)throw Error(`Count: expected: ${e.count} actual: ${r} at level: ${n}`);if(e.min&&r<e.min)throw Error(`Min: expected: ${e.min} actual: ${r} at level: ${n}`);if(e.max&&r>e.max)throw Error(`Max: expected: ${e.max} actual: ${r} at level: ${n}`)}removeDuplicateSubmissionRequirementMatches(e){return e.filter((r,n)=>{const s=JSON.stringify(r);return n===e.findIndex(i=>JSON.stringify(i)===s)})}fillSelectableCredentialsToVerifiableCredentialsMapping(e,r){var n;e&&((n=e.verifiableCredential)==null||n.forEach(s=>{var o;const i=Ci.isString(s)?r.findIndex(a=>s===a.original):r.findIndex(a=>JSON.stringify(s.proof)===JSON.stringify(a.credential.proof));if(i===-1)throw new Error("index is not right");(o=e.vcIndexes)==null||o.push(i)}))}determineAreRequiredCredentialsPresent(e,r,n){if(!r||!r.length)return $e.ERROR;const s=r.map(i=>this.determineSubmissionRequirementStatus(e,i));if(n){if(n.rule===Xt.Rules.All&&s.includes($e.ERROR))return $e.ERROR;const i=s.filter(o=>o!==$e.ERROR).length;if(n.count)return n.count>i?$e.ERROR:n.count<i?$e.WARN:$e.INFO;if(n.min&&n.min>i)return $e.ERROR;if(n.max&&n.max<i)return $e.WARN}else return s.includes($e.ERROR)?$e.ERROR:s.includes($e.WARN)?$e.WARN:$e.INFO;return $e.INFO}determineSubmissionRequirementStatus(e,r){if(r.from&&r.from_nested)throw new Error("Invalid submission_requirement object: MUST contain either a from or from_nested property.");if(!r.from&&!r.from_nested&&r.vc_path.length!==1)return $e.ERROR;if(r.from){const n=this.countGroupIDs(e.input_descriptors,r.from);switch(r.rule){case Xt.Rules.All:return r.vc_path.length===n?$e.INFO:$e.WARN;case Xt.Rules.Pick:return this.getPickRuleStatus(r);default:return $e.ERROR}}else if(r.from_nested)return this.determineAreRequiredCredentialsPresent(e,r.from_nested,r);return $e.INFO}getPickRuleStatus(e){return e.vc_path.length===0?$e.ERROR:e.count&&e.vc_path.length!==e.count?e.vc_path.length>e.count?$e.WARN:$e.ERROR:e.min&&e.vc_path.length<e.min?$e.ERROR:e.max&&e.vc_path.length>e.max?$e.WARN:$e.INFO}updateSubmissionRequirementMatchPathToAlias(e,r){const n=[];e.vc_path.forEach(s=>{n.push(s.replace("$","$."+r))}),e.vc_path=n,e.from_nested&&e.from_nested.forEach(s=>{this.updateSubmissionRequirementMatchPathToAlias(s,r)})}updatePresentationSubmissionPathToAlias(e,r){r?r.descriptor_map.forEach(n=>{this.replacePathWithAlias(n,e)}):this._client.generatePresentationSubmission&&this._client.presentationSubmission.descriptor_map.forEach(n=>{this.replacePathWithAlias(n,e)})}replacePathWithAlias(e,r){e.path=e.path.replace("$","$."+r),e.path_nested&&this.replacePathWithAlias(e.path_nested,r)}createIdToVcMap(e){const r=new Map,n=new Map;for(let s=0;s<e.length;s++){const i=e[s].input_descriptor_path;if(n.has(i)){const o=n.get(i);o&&o.push(e[s])}else n.set(i,[e[s]])}for(const[s,i]of n.entries()){const o=[];for(let a=0;a<i.length;a++)o.indexOf(i[a].verifiable_credential_path)===-1&&o.push(i[a].verifiable_credential_path);r.set(s,o)}return r}countGroupIDs(e,r){let n=0;for(const s of e)s.group&&s.group.includes(r)&&n++;return n}}var sh;(function(t){t[t.EXTERNAL=0]="EXTERNAL",t[t.PRESENTATION=1]="PRESENTATION"})(sh||(sh={}));var Tx;(function(t){t.Jwk="Jwk",t.Base58="Base58",t.Hex="Hex",t.Multibase="Multibase"})(Tx||(Tx={}));var CE={exports:{}};CE.exports=kE;CE.exports.default=kE;const Mr={additionalProperties:!1,properties:{const:{$ref:"#/definitions/OneOfNumberString"},enum:{items:{$ref:"#/definitions/OneOfNumberString"},type:"array"},exclusiveMaximum:{$ref:"#/definitions/OneOfNumberString"},exclusiveMinimum:{$ref:"#/definitions/OneOfNumberString"},format:{type:"string"},maxLength:{type:"number"},maximum:{$ref:"#/definitions/OneOfNumberString"},minLength:{type:"number"},minimum:{$ref:"#/definitions/OneOfNumberString"},not:{type:"object"},pattern:{type:"string"},type:{type:"string"}},required:["type"],type:"object"},FG=Object.prototype.hasOwnProperty,xw={type:["number","string"]};function Wr(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(typeof t!="number"&&typeof t!="string"){const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:xw.type},message:"must be number,string",schema:xw.type,parentSchema:xw,data:t};i===null?i=[a]:i.push(a),o++}return Wr.errors=i,o===0}function p0(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.type===void 0){const a={instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:"type"},message:"must have required property 'type'",schema:Mr.required,parentSchema:Mr,data:t};i===null?i=[a]:i.push(a),o++}for(const a in t)if(!FG.call(Mr.properties,a)){const c={instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:a},message:"must NOT have additional properties",schema:!1,parentSchema:Mr,data:t};i===null?i=[c]:i.push(c),o++}if(t.const!==void 0&&(Wr(t.const,{instancePath:e+"/const",parentData:t,parentDataProperty:"const",rootData:s})||(i=i===null?Wr.errors:i.concat(Wr.errors),o=i.length)),t.enum!==void 0){let a=t.enum;if(Array.isArray(a)){const c=a.length;for(let l=0;l<c;l++)Wr(a[l],{instancePath:e+"/enum/"+l,parentData:a,parentDataProperty:l,rootData:s})||(i=i===null?Wr.errors:i.concat(Wr.errors),o=i.length)}else{const c={instancePath:e+"/enum",schemaPath:"#/properties/enum/type",keyword:"type",params:{type:"array"},message:"must be array",schema:Mr.properties.enum.type,parentSchema:Mr.properties.enum,data:a};i===null?i=[c]:i.push(c),o++}}if(t.exclusiveMaximum!==void 0&&(Wr(t.exclusiveMaximum,{instancePath:e+"/exclusiveMaximum",parentData:t,parentDataProperty:"exclusiveMaximum",rootData:s})||(i=i===null?Wr.errors:i.concat(Wr.errors),o=i.length)),t.exclusiveMinimum!==void 0&&(Wr(t.exclusiveMinimum,{instancePath:e+"/exclusiveMinimum",parentData:t,parentDataProperty:"exclusiveMinimum",rootData:s})||(i=i===null?Wr.errors:i.concat(Wr.errors),o=i.length)),t.format!==void 0){let a=t.format;if(typeof a!="string"){const c={instancePath:e+"/format",schemaPath:"#/properties/format/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Mr.properties.format.type,parentSchema:Mr.properties.format,data:a};i===null?i=[c]:i.push(c),o++}}if(t.maxLength!==void 0){let a=t.maxLength;if(typeof a!="number"){const c={instancePath:e+"/maxLength",schemaPath:"#/properties/maxLength/type",keyword:"type",params:{type:"number"},message:"must be number",schema:Mr.properties.maxLength.type,parentSchema:Mr.properties.maxLength,data:a};i===null?i=[c]:i.push(c),o++}}if(t.maximum!==void 0&&(Wr(t.maximum,{instancePath:e+"/maximum",parentData:t,parentDataProperty:"maximum",rootData:s})||(i=i===null?Wr.errors:i.concat(Wr.errors),o=i.length)),t.minLength!==void 0){let a=t.minLength;if(typeof a!="number"){const c={instancePath:e+"/minLength",schemaPath:"#/properties/minLength/type",keyword:"type",params:{type:"number"},message:"must be number",schema:Mr.properties.minLength.type,parentSchema:Mr.properties.minLength,data:a};i===null?i=[c]:i.push(c),o++}}if(t.minimum!==void 0&&(Wr(t.minimum,{instancePath:e+"/minimum",parentData:t,parentDataProperty:"minimum",rootData:s})||(i=i===null?Wr.errors:i.concat(Wr.errors),o=i.length)),t.not!==void 0){let a=t.not;if(!(a&&typeof a=="object"&&!Array.isArray(a))){const c={instancePath:e+"/not",schemaPath:"#/properties/not/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Mr.properties.not.type,parentSchema:Mr.properties.not,data:a};i===null?i=[c]:i.push(c),o++}}if(t.pattern!==void 0){let a=t.pattern;if(typeof a!="string"){const c={instancePath:e+"/pattern",schemaPath:"#/properties/pattern/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Mr.properties.pattern.type,parentSchema:Mr.properties.pattern,data:a};i===null?i=[c]:i.push(c),o++}}if(t.type!==void 0){let a=t.type;if(typeof a!="string"){const c={instancePath:e+"/type",schemaPath:"#/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string",schema:Mr.properties.type.type,parentSchema:Mr.properties.type,data:a};i===null?i=[c]:i.push(c),o++}}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:Mr.type,parentSchema:Mr,data:t};i===null?i=[a]:i.push(a),o++}return p0.errors=i,o===0}function kE(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;return p0(t,{instancePath:e,parentData:r,parentDataProperty:n,rootData:s})||(i=i===null?p0.errors:i.concat(p0.errors),o=i.length),kE.errors=i,o===0}var NG=CE.exports;const RG=Jo(NG);var OE={exports:{}};OE.exports=TE;OE.exports.default=TE;const er={additionalProperties:!1,properties:{const:{$ref:"#/definitions/OneOfNumberString"},enum:{items:{$ref:"#/definitions/OneOfNumberString"},type:"array"},exclusiveMaximum:{$ref:"#/definitions/OneOfNumberString"},exclusiveMinimum:{$ref:"#/definitions/OneOfNumberString"},format:{type:"string"},formatExclusiveMaximum:{type:"string"},formatExclusiveMinimum:{type:"string"},formatMaximum:{type:"string"},formatMinimum:{type:"string"},maxLength:{type:"number"},maximum:{$ref:"#/definitions/OneOfNumberString"},minLength:{type:"number"},minimum:{$ref:"#/definitions/OneOfNumberString"},not:{type:"object"},pattern:{type:"string"},type:{type:"string"}},required:["type"],type:"object"},jG=Object.prototype.hasOwnProperty,Dw={type:["number","string"]};function Jr(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(typeof t!="number"&&typeof t!="string"){const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:Dw.type},message:"must be number,string",schema:Dw.type,parentSchema:Dw,data:t};i===null?i=[a]:i.push(a),o++}return Jr.errors=i,o===0}function h0(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.type===void 0){const a={instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:"type"},message:"must have required property 'type'",schema:er.required,parentSchema:er,data:t};i===null?i=[a]:i.push(a),o++}for(const a in t)if(!jG.call(er.properties,a)){const c={instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:a},message:"must NOT have additional properties",schema:!1,parentSchema:er,data:t};i===null?i=[c]:i.push(c),o++}if(t.const!==void 0&&(Jr(t.const,{instancePath:e+"/const",parentData:t,parentDataProperty:"const",rootData:s})||(i=i===null?Jr.errors:i.concat(Jr.errors),o=i.length)),t.enum!==void 0){let a=t.enum;if(Array.isArray(a)){const c=a.length;for(let l=0;l<c;l++)Jr(a[l],{instancePath:e+"/enum/"+l,parentData:a,parentDataProperty:l,rootData:s})||(i=i===null?Jr.errors:i.concat(Jr.errors),o=i.length)}else{const c={instancePath:e+"/enum",schemaPath:"#/properties/enum/type",keyword:"type",params:{type:"array"},message:"must be array",schema:er.properties.enum.type,parentSchema:er.properties.enum,data:a};i===null?i=[c]:i.push(c),o++}}if(t.exclusiveMaximum!==void 0&&(Jr(t.exclusiveMaximum,{instancePath:e+"/exclusiveMaximum",parentData:t,parentDataProperty:"exclusiveMaximum",rootData:s})||(i=i===null?Jr.errors:i.concat(Jr.errors),o=i.length)),t.exclusiveMinimum!==void 0&&(Jr(t.exclusiveMinimum,{instancePath:e+"/exclusiveMinimum",parentData:t,parentDataProperty:"exclusiveMinimum",rootData:s})||(i=i===null?Jr.errors:i.concat(Jr.errors),o=i.length)),t.format!==void 0){let a=t.format;if(typeof a!="string"){const c={instancePath:e+"/format",schemaPath:"#/properties/format/type",keyword:"type",params:{type:"string"},message:"must be string",schema:er.properties.format.type,parentSchema:er.properties.format,data:a};i===null?i=[c]:i.push(c),o++}}if(t.formatExclusiveMaximum!==void 0){let a=t.formatExclusiveMaximum;if(typeof a!="string"){const c={instancePath:e+"/formatExclusiveMaximum",schemaPath:"#/properties/formatExclusiveMaximum/type",keyword:"type",params:{type:"string"},message:"must be string",schema:er.properties.formatExclusiveMaximum.type,parentSchema:er.properties.formatExclusiveMaximum,data:a};i===null?i=[c]:i.push(c),o++}}if(t.formatExclusiveMinimum!==void 0){let a=t.formatExclusiveMinimum;if(typeof a!="string"){const c={instancePath:e+"/formatExclusiveMinimum",schemaPath:"#/properties/formatExclusiveMinimum/type",keyword:"type",params:{type:"string"},message:"must be string",schema:er.properties.formatExclusiveMinimum.type,parentSchema:er.properties.formatExclusiveMinimum,data:a};i===null?i=[c]:i.push(c),o++}}if(t.formatMaximum!==void 0){let a=t.formatMaximum;if(typeof a!="string"){const c={instancePath:e+"/formatMaximum",schemaPath:"#/properties/formatMaximum/type",keyword:"type",params:{type:"string"},message:"must be string",schema:er.properties.formatMaximum.type,parentSchema:er.properties.formatMaximum,data:a};i===null?i=[c]:i.push(c),o++}}if(t.formatMinimum!==void 0){let a=t.formatMinimum;if(typeof a!="string"){const c={instancePath:e+"/formatMinimum",schemaPath:"#/properties/formatMinimum/type",keyword:"type",params:{type:"string"},message:"must be string",schema:er.properties.formatMinimum.type,parentSchema:er.properties.formatMinimum,data:a};i===null?i=[c]:i.push(c),o++}}if(t.maxLength!==void 0){let a=t.maxLength;if(typeof a!="number"){const c={instancePath:e+"/maxLength",schemaPath:"#/properties/maxLength/type",keyword:"type",params:{type:"number"},message:"must be number",schema:er.properties.maxLength.type,parentSchema:er.properties.maxLength,data:a};i===null?i=[c]:i.push(c),o++}}if(t.maximum!==void 0&&(Jr(t.maximum,{instancePath:e+"/maximum",parentData:t,parentDataProperty:"maximum",rootData:s})||(i=i===null?Jr.errors:i.concat(Jr.errors),o=i.length)),t.minLength!==void 0){let a=t.minLength;if(typeof a!="number"){const c={instancePath:e+"/minLength",schemaPath:"#/properties/minLength/type",keyword:"type",params:{type:"number"},message:"must be number",schema:er.properties.minLength.type,parentSchema:er.properties.minLength,data:a};i===null?i=[c]:i.push(c),o++}}if(t.minimum!==void 0&&(Jr(t.minimum,{instancePath:e+"/minimum",parentData:t,parentDataProperty:"minimum",rootData:s})||(i=i===null?Jr.errors:i.concat(Jr.errors),o=i.length)),t.not!==void 0){let a=t.not;if(!(a&&typeof a=="object"&&!Array.isArray(a))){const c={instancePath:e+"/not",schemaPath:"#/properties/not/type",keyword:"type",params:{type:"object"},message:"must be object",schema:er.properties.not.type,parentSchema:er.properties.not,data:a};i===null?i=[c]:i.push(c),o++}}if(t.pattern!==void 0){let a=t.pattern;if(typeof a!="string"){const c={instancePath:e+"/pattern",schemaPath:"#/properties/pattern/type",keyword:"type",params:{type:"string"},message:"must be string",schema:er.properties.pattern.type,parentSchema:er.properties.pattern,data:a};i===null?i=[c]:i.push(c),o++}}if(t.type!==void 0){let a=t.type;if(typeof a!="string"){const c={instancePath:e+"/type",schemaPath:"#/properties/type/type",keyword:"type",params:{type:"string"},message:"must be string",schema:er.properties.type.type,parentSchema:er.properties.type,data:a};i===null?i=[c]:i.push(c),o++}}}else{const a={instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object",schema:er.type,parentSchema:er,data:t};i===null?i=[a]:i.push(a),o++}return h0.errors=i,o===0}function TE(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:s=t}={}){let i=null,o=0;return h0(t,{instancePath:e,parentData:r,parentDataProperty:n,rootData:s})||(i=i===null?h0.errors:i.concat(h0.errors),o=i.length),TE.errors=i,o===0}var MG=OE.exports;const UG=Jo(MG);class tu{constructor(e,r){de(this,"parentTag");de(this,"myTag");this.parentTag=e,this.myTag=r}getTag(){return this.parentTag!=null?this.parentTag+"."+this.myTag:this.myTag}toChecked(e){return new j0(this.getTag(),$e.ERROR,e)}}class J0 extends tu{constructor(r){super(r,"fields");de(this,"mustHaveValidJsonPathsMsg",'field object "path" property must contain array of valid json paths');de(this,"pathObjMustHaveValidJsonPathMsg",'field object "path" property must contain valid json paths.');de(this,"filterMustBeValidJsonSchemaMsg",'field object "filter" property must be valid json schema');de(this,"filterIsMustInPresenceOfPredicateMsg",'field object must have a "filter" property if "predicate" is present');de(this,"filterIsNotValidJsonSchemaDescriptorMsg",'could not parse "filter" object as a valid json schema descriptor.');de(this,"purposeShouldBeANonEmptyStringMsg","purpose should be a non empty string");de(this,"shouldBeKnownOptionMsg","Unknown predicate property")}getValidations(r){let n=[];if(r)for(let s=0;s<r.length;s++)n=[...n,...this.getValidationsFor(r[s],s)];return n}getValidationsFor(r,n){return[{tag:this.getMyTag(n),target:r,predicate:this.mustHaveValidJsonPaths(),message:this.mustHaveValidJsonPathsMsg},{tag:this.getMyTag(n),target:r,predicate:this.filterMustBeValidJsonSchema(),message:this.filterMustBeValidJsonSchemaMsg},{tag:this.getMyTag(n),target:r,predicate:this.filterIsMustInPresenceOfPredicate(),message:this.filterIsMustInPresenceOfPredicateMsg},{tag:this.getMyTag(n),target:r,predicate:s=>J0.optionalNonEmptyString(s==null?void 0:s.purpose),message:this.purposeShouldBeANonEmptyStringMsg},{tag:this.getMyTag(n),target:r,predicate:s=>J0.shouldBeKnownOption(s==null?void 0:s.predicate),message:this.shouldBeKnownOptionMsg}]}getMyTag(r){return this.parentTag+"."+this.myTag+"["+r+"]"}mustHaveValidJsonPaths(){return r=>r.path!=null&&r.path.length>0&&this._validateJsonPaths(r.path)}_validateJsonPaths(r){const n=[];if(r.forEach(s=>{try{zt.parse(s)}catch{n.push(s)}}),n.length>0)throw this.toChecked(this.pathObjMustHaveValidJsonPathMsg+" Got: "+JSON.stringify(n));return!0}filterMustBeValidJsonSchema(){return r=>this._validateFilter(r.filter)}_validateFilter(r){if(r==null)return!0;let n=!1;try{n=UG(r),n||(n=RG(r))}catch{throw this.toChecked(this.filterIsNotValidJsonSchemaDescriptorMsg+" Got "+JSON.stringify(r))}return n}filterIsMustInPresenceOfPredicate(){return r=>!(r.predicate!=null&&r.filter==null)}static optionalNonEmptyString(r){return r==null||r.length>0}static shouldBeKnownOption(r){return r==null||r==Xt.Optionality.Required||r==Xt.Optionality.Preferred}}class Xu extends tu{constructor(r){super(r,"constraints");de(this,"disclosureLimitShouldHaveKnownValueMsg","limit_disclosure should have known value");de(this,"statusShouldHaveKnownValueMsg","Unknown status property");de(this,"statusDirectiveShouldHaveKnownValueMsg","status directive should have known value");de(this,"subjectIsIssuerShouldBeKnownValueMsg","subject_is_issuer should be known value");de(this,"fieldIdIsMandatoryMsg","field_id property is mandatory");de(this,"fieldIdMustBeArrayOfStringsMsg","field_id property must be an array of strings");de(this,"fieldIdMustCorrespondToFieldIdMsg","field_id must correspond to a present field object id property");de(this,"directivePropertyIsMandatoryMsg","directive property is mandatory");de(this,"oneOfTheKnownDirectivePropertiesMandatoryMsg","directive property must be one of [required, preferred]")}getValidations(r){let n=[];return r&&(n=[{tag:this.getTag(),target:r,predicate:s=>Xu.disclosureLimitShouldHaveKnownValue(s.limit_disclosure),message:this.disclosureLimitShouldHaveKnownValueMsg},{tag:this.getTag(),target:r,predicate:s=>Xu.statusShouldHaveKnownValue(s.statuses),message:this.statusShouldHaveKnownValueMsg},{tag:this.getTag(),target:r,predicate:Xu.statusDirectiveShouldHaveKnownValue(),message:this.statusDirectiveShouldHaveKnownValueMsg},{tag:this.getTag(),target:r,predicate:s=>Xu.shouldBeKnownOption(s.is_holder),message:this.subjectIsIssuerShouldBeKnownValueMsg},{tag:this.getTag(),target:r,predicate:s=>this.fieldIdInSubjectMustCorrespondToFieldId(s,s.is_holder),message:this.fieldIdMustCorrespondToFieldIdMsg},{tag:this.getTag(),target:r,predicate:s=>this.fieldIdInSubjectMustCorrespondToFieldId(s,s.same_subject),message:this.fieldIdMustCorrespondToFieldIdMsg},...this.getSubjectsValidations(r==null?void 0:r.is_holder),...this.getSubjectsValidations(r==null?void 0:r.same_subject),...this.getFieldsValidations(r)]),n}getFieldsValidations(r){var n;return(n=r==null?void 0:r.fields)!=null&&n.length?new J0(this.getTag()).getValidations(r.fields):[]}static disclosureLimitShouldHaveKnownValue(r){return!r||r===Xt.Optionality.Preferred||r===Xt.Optionality.Required}static statusShouldHaveKnownValue(r){return r==null||r.active!=null||r.revoked!=null||r.suspended!=null}static statusDirectiveShouldHaveKnownValue(){return r=>{var n,s,i;return this.pdStatusShouldBeKnown((n=r==null?void 0:r.statuses)==null?void 0:n.active)&&this.pdStatusShouldBeKnown((s=r==null?void 0:r.statuses)==null?void 0:s.revoked)&&this.pdStatusShouldBeKnown((i=r==null?void 0:r.statuses)==null?void 0:i.suspended)}}static pdStatusShouldBeKnown(r){return!r||r.directive===Xt.Directives.Allowed||r.directive===Xt.Directives.Disallowed||r.directive===Xt.Directives.Required}static shouldBeKnownOption(r){return r?r.filter(n=>n.directive!==Xt.Optionality.Preferred&&n.directive!==Xt.Optionality.Required).length===0:!0}getSubjectsValidations(r){if(r){let n=[];for(let s=0;s<r.length;s++)n=[{tag:this.getMyTag(s),target:r[s],predicate:i=>Array.isArray(i.field_id),message:this.fieldIdMustBeArrayOfStringsMsg},{tag:this.getMyTag(s),target:r[s],predicate:i=>!!i.field_id,message:this.fieldIdIsMandatoryMsg},{tag:this.getMyTag(s),target:r[s],predicate:i=>i.field_id.length===i.field_id.filter(o=>typeof o=="string").length,message:this.fieldIdMustBeArrayOfStringsMsg},{tag:this.getMyTag(s),target:r[s],predicate:i=>i.directive!==void 0,message:this.directivePropertyIsMandatoryMsg},{tag:this.getMyTag(s),target:r[s],predicate:i=>i.directive===Xt.Optionality.Preferred||i.directive===Xt.Optionality.Required,message:this.oneOfTheKnownDirectivePropertiesMandatoryMsg}];return n}return[]}getMyTag(r){return this.parentTag+"."+this.myTag+"["+r+"]"}fieldIdInSubjectMustCorrespondToFieldId(r,n){if(n){for(const s of n)for(const i of s.field_id)if(!Xu.isValidFieldId(r,i))return!1}return!0}static isValidFieldId(r,n){return r!=null&&r.fields?r.fields.map(s=>s.id).includes(n):!1}}class Ix extends tu{constructor(r){super(r,"input_descriptor");de(this,"idMustBeNonEmptyStringMsg","input descriptor id must be non-empty string");de(this,"nameShouldBeNonEmptyStringMsg","input descriptor name should be non-empty string");de(this,"purposeShouldBeNonEmptyStringMsg","input descriptor purpose should be non-empty string");de(this,"shouldHaveValidSchemaURIMsg","schema should have valid URI")}getValidations(r){let n=[];return n.push({tag:this.getTag(),target:r,predicate:s=>this.shouldHaveUniqueIds(s),message:"input descriptor ids must be unique"},{tag:this.getTag(),target:r,predicate:s=>this.shouldHaveUniqueFieldsIds(s),message:"fields id must be unique"}),r.forEach((s,i)=>{n=[...n,...this.getValidationFor(s,i),...this.constraintsValidations(s,i)]}),n}getValidationFor(r,n){return[{tag:this.getMyTag(n),target:r,predicate:s=>Zu.nonEmptyString(s==null?void 0:s.id),message:this.idMustBeNonEmptyStringMsg},{tag:this.getMyTag(n),target:r,predicate:this.isValidSchema(),message:this.shouldHaveValidSchemaURIMsg},{tag:this.getMyTag(n),target:r,predicate:s=>Zu.optionalNonEmptyString(s==null?void 0:s.name),message:this.nameShouldBeNonEmptyStringMsg},{tag:this.getMyTag(n),target:r,predicate:s=>Zu.optionalNonEmptyString(s==null?void 0:s.purpose),message:this.purposeShouldBeNonEmptyStringMsg}]}shouldHaveUniqueFieldsIds(r){const n=[],s=new Set,i=[];return r.map(o=>{var a;return(a=o.constraints)==null?void 0:a.fields}).forEach(o=>{o&&i.push(...o)}),i.forEach(o=>{o.id&&n.push(o.id)}),n.forEach(o=>s.add(o)),n.length===s.size}shouldHaveUniqueIds(r){const n=[],s=new Set;return r.forEach(i=>n.push(i.id)),n.forEach(i=>s.add(i)),n.length===s.size}getMyTag(r){return this.parentTag+"."+this.myTag+"["+r+"]"}isValidSchema(){return r=>r.schema.filter(n=>this.isAValidURI(n.uri)&&(n.required==null||typeof n.required=="boolean")).length>0}isAValidURI(r){if(r){if(!Zu.nonEmptyString(r))return!1}else return!1;if(r.startsWith("http://")||r.startsWith("https://"))try{new URL(r)}catch{return Zu.isValidDIDURI(r)}return!0}constraintsValidations(r,n){return r.constraints?new Xu(this.getMyTag(n)).getValidations(r.constraints):[]}}class Bx extends tu{constructor(r){super(r,"input_descriptor");de(this,"idMustBeNonEmptyStringMsg","input descriptor id must be non-empty string");de(this,"nameShouldBeNonEmptyStringMsg","input descriptor name should be non-empty string");de(this,"purposeShouldBeNonEmptyStringMsg","input descriptor purpose should be non-empty string")}getValidations(r){let n=[];return n.push({tag:this.getTag(),target:r,predicate:s=>this.shouldNotHaveSchema(s),message:"input descriptor should not have schema property"},{tag:this.getTag(),target:r,predicate:s=>this.shouldHaveUniqueIds(s),message:"input descriptor ids must be unique"},{tag:this.getTag(),target:r,predicate:s=>this.shouldHaveUniqueFieldsIds(s),message:"fields id must be unique"}),r.forEach((s,i)=>{n=[...n,...this.getValidationFor(s,i),...this.constraintsValidations(s,i)]}),n}getValidationFor(r,n){return[{tag:this.getMyTag(n),target:r,predicate:s=>Zu.nonEmptyString(s==null?void 0:s.id),message:this.idMustBeNonEmptyStringMsg},{tag:this.getMyTag(n),target:r,predicate:s=>Zu.optionalNonEmptyString(s==null?void 0:s.name),message:this.nameShouldBeNonEmptyStringMsg},{tag:this.getMyTag(n),target:r,predicate:s=>Zu.optionalNonEmptyString(s==null?void 0:s.purpose),message:this.purposeShouldBeNonEmptyStringMsg}]}shouldHaveUniqueFieldsIds(r){const n=[],s=new Set,i=[];return r.map(o=>{var a;return(a=o.constraints)==null?void 0:a.fields}).forEach(o=>{o&&i.push(...o)}),i.forEach(o=>{o.id&&n.push(o.id)}),n.forEach(o=>s.add(o)),n.length===s.size}shouldHaveUniqueIds(r){const n=[],s=new Set;return r.forEach(i=>n.push(i.id)),n.forEach(i=>s.add(i)),n.length===s.size}getMyTag(r){return this.parentTag+"."+this.myTag+"["+r+"]"}constraintsValidations(r,n){return r.constraints?new Xu(this.getMyTag(n)).getValidations(r.constraints):[]}shouldNotHaveSchema(r){let n=!1;return r.forEach(s=>{s.schema&&(n=!0)}),!n}}class e8{static getJwtAlgos(){return["HS256","HS384","HS512","RS256","RS384","RS512","ES256","ES384","ES512","PS256","PS384","PS512","none","RSA1_5","RSA-OAEP","RSA-OAEP-256","A128KW","A192KW","A256KW","dir","ECDH-ES","ECDH-ES+A128KW","ECDH-ES+A192KW","ECDH-ES+A256KW","A128GCMKW","A192GCMKW","A256GCMKW","PBES2-HS256+A128KW","PBES2-HS384+A192KW","PBES2-HS512+A256KW"]}}class t8{static getLdpTypes(){return["Ed25519VerificationKey2018","Ed25519Signature2018","RsaSignature2018","EcdsaSecp256k1Signature2019","EcdsaSecp256k1RecoverySignature2020","JsonWebSignature2020","GpgSignature2020","JcsEd25519Signature2020","BbsBlsSignature2020","Bls12381G2Key2020"]}}class Yu extends tu{constructor(r){super(r,"submission_requirements");de(this,"ruleIsMandatoryMsg","rule is a mandatory field");de(this,"needsOneFromOrFromNestedMsg","needs exactly one of from or from_nested");de(this,"fromNestedShouldBeArrayMsg","The value of the from_nested property MUST be an array");de(this,"isCountPositiveIntMsg","count must be a practical positive number");de(this,"isMinPositiveIntMsg","min must be a practical positive number");de(this,"isMaxPositiveIntMsg","max must be a practical positive number");de(this,"ruleShouldBePickOrAllMsg","rule should be either pick or all")}getValidations(r){let n=[];if(r!=null&&r.length>0)for(let s=0;s<r.length;s++)n=[...n,...this.getMyValidations(s,r),...this.getSubValidations(s,r)];return n}getMyValidations(r,n){return[{tag:this.getMyTag(r),target:n[r],predicate:Yu.ruleIsMandatory,message:this.ruleIsMandatoryMsg},{tag:this.getMyTag(r),target:n[r],predicate:Yu.needsOneFromOrFromNested,message:this.needsOneFromOrFromNestedMsg},{tag:this.getMyTag(r),target:n[r],predicate:Yu.fromNestedShouldBeArray,message:this.fromNestedShouldBeArrayMsg},{tag:this.getMyTag(r),target:n[r],predicate:this.isCountPositiveInt,message:this.isCountPositiveIntMsg},{tag:this.getMyTag(r),target:n[r],predicate:this.isMinPositiveInt,message:this.isMinPositiveIntMsg},{tag:this.getMyTag(r),target:n[r],predicate:this.isMaxPositiveInt,message:this.isMaxPositiveIntMsg},{tag:this.getMyTag(r),target:n[r],predicate:Yu.ruleShouldBePickOrAll,message:this.ruleShouldBePickOrAllMsg}]}getMyTag(r){return this.parentTag+"."+this.myTag+"["+r+"]"}getSubValidations(r,n){const s=n[r].from_nested;return s!=null?new Yu(this.getFromNestedTag(r)).getValidations(s):[]}getFromNestedTag(r){return this.getMyTag(r)+".from_nested"}isCountPositiveInt(r){return r.rule!=="pick"||r.count==null||0<r.count}isMinPositiveInt(r){return r.rule!=="pick"||r.min==null||0<=r.min}isMaxPositiveInt(r){return r.rule!=="pick"||r.max==null||0<r.max}static ruleIsMandatory(r){return r.rule!=null}static needsOneFromOrFromNested(r){return r.from==null!=(r.from_nested==null)}static fromNestedShouldBeArray(r){return r.from_nested==null||Array.isArray(r.from_nested)}static ruleShouldBePickOrAll(r){return r.rule==="pick"||r.rule==="all"}}class es extends tu{constructor(e){super(e,"presentation_definition")}getValidations(e){return e.submission_requirements?[...this.myValidations(e),...new Ix(this.myTag).getValidations(e.input_descriptors),...new Yu(this.myTag).getValidations(e.submission_requirements)]:[...this.myValidations(e),...new Ix(this.myTag).getValidations(e.input_descriptors)]}myValidations(e){return[{tag:this.getTag(),target:e,predicate:r=>r!=null,message:"presentation_definition should be non null."},{tag:this.getTag(),target:e,predicate:this.shouldBeAsPerJsonSchema(),message:"presentation_definition should be as per json schema."},{tag:this.getTag(),target:e,predicate:r=>es.nonEmptyString(r==null?void 0:r.id),message:"id should not be empty"},{tag:this.getTag(),target:e,predicate:r=>es.optionalNonEmptyString(r==null?void 0:r.name),message:"name should be a non-empty string"},{tag:this.getTag(),target:e,predicate:r=>es.optionalNonEmptyString(r==null?void 0:r.purpose),message:"purpose should be a non-empty string"},{tag:this.getTag(),target:e,predicate:r=>es.formatValuesShouldNotBeEmpty(r==null?void 0:r.format),message:"formats values should not empty"},{tag:this.getTag(),target:e,predicate:r=>es.formatValuesShouldBeAmongKnownValues(r==null?void 0:r.format),message:"formats should only have known identifiers for alg or proof_type"},{tag:this.getTag(),target:e,predicate:r=>es.groupShouldMatchSubmissionRequirements(r),message:"input descriptor group should match the from in submission requirements."},{tag:this.getTag(),target:e,predicate:r=>es.shouldNotHaveFrameProperty(r),message:"input descriptor should not have frame property."}]}static optionalNonEmptyString(e){return e==null||e.length>0}static nonEmptyString(e){return e!=null&&e.length>0}static formatValuesShouldNotBeEmpty(e){var n,s,i,o,a,c;let r=!0;return(e==null?void 0:e.jwt)!=null&&(r=r&&((n=e.jwt.alg)==null?void 0:n.length)>0),(e==null?void 0:e.jwt_vc)!=null&&(r=r&&((s=e.jwt_vc.alg)==null?void 0:s.length)>0),(e==null?void 0:e.jwt_vp)!=null&&(r=r&&((i=e.jwt_vp.alg)==null?void 0:i.length)>0),(e==null?void 0:e.ldp)!=null&&(r=r&&((o=e.ldp.proof_type)==null?void 0:o.length)>0),(e==null?void 0:e.ldp_vc)!=null&&(r=r&&((a=e.ldp_vc.proof_type)==null?void 0:a.length)>0),(e==null?void 0:e.ldp_vp)!=null&&(r=r&&((c=e.ldp_vp.proof_type)==null?void 0:c.length)>0),r}static formatValuesShouldBeAmongKnownValues(e){let r=[];if(e){const n=e8.getJwtAlgos(),s=t8.getLdpTypes();r=[];for(const[i,o]of Object.entries(e))i.startsWith("jwt")?r.push(...es.isJWTAlgoKnown(o,n)):r.push(...es.isLDPProofKnown(o,s))}return r.length===0}static isJWTAlgoKnown(e,r){const n=[];if(e!=null&&e.alg!=null)for(const s of e.alg)r.includes(s)||n.push(s);return n}static isLDPProofKnown(e,r){const n=[];if(e!=null&&e.proof_type!=null)for(const s of e.proof_type)r.includes(s)||n.push(s);return n}static groupShouldMatchSubmissionRequirements(e){if(e.submission_requirements!=null&&e.submission_requirements.length>0){const r=[];e.input_descriptors.forEach(a=>{a.group&&r.push(...a.group)});const n=new Set(r),s=[];es.flatten(e.submission_requirements).forEach(a=>{a.from&&(Array.isArray(a.from)?s.push(...a.from):s.push(a.from))});const i=new Set(s);return new Set([...i].filter(a=>a!=null&&a.length>0&&!n.has(a))).size===0}return!0}static flatten(e){return e==null?void 0:e.reduce((r,n)=>r.concat(Array.isArray(n.from_nested)?this.flatten(n.from_nested):n),[])}shouldBeAsPerJsonSchema(){return e=>pO({presentation_definition:e})}static shouldNotHaveFrameProperty(e){return!e.frame}}class IE extends tu{constructor(r){super(r,"frame");de(this,"frameIsValidMsg","frame value is not valid")}getValidations(r){let n=[];return n=[...n,...this.getMyValidations(r)],n}getMyValidations(r){return[{tag:this.getMyTag(),target:r,predicate:IE.frameIsValid,message:this.frameIsValidMsg}]}getMyTag(){return this.parentTag+"."+this.myTag}static frameIsValid(r){if(!r||Array.isArray(r)||typeof r!="object")return!1;const n=r;if(n&&n["@id"]){for(const s of Ci.asArray(r["@id"]))if(!(Ci.isObject(s)||Ci.isUrlAbsolute(s))||Ci.isString(s)&&s.indexOf("_:")===0)return!1}if(n["@types"]){for(const s of Ci.asArray(r["@types"]))if(!(Ci.isObject(s)||Ci.isUrlAbsolute(s))||Ci.isString(s)&&s.indexOf("_:")===0)return!1}return!0}}class Fs extends tu{constructor(e){super(e,"presentation_definition")}getValidations(e){let r=[];return e.submission_requirements?r=[...this.myValidations(e),...new Bx(this.myTag).getValidations(e.input_descriptors),...new Yu(this.myTag).getValidations(e.submission_requirements)]:r=[...this.myValidations(e),...new Bx(this.myTag).getValidations(e.input_descriptors)],e.frame&&r.push(...new IE(this.myTag).getValidations(e.frame)),r}myValidations(e){return[{tag:this.getTag(),target:e,predicate:r=>r!=null,message:"presentation_definition should be non null."},{tag:this.getTag(),target:e,predicate:this.shouldBeAsPerJsonSchema(),message:"presentation_definition should be as per json schema."},{tag:this.getTag(),target:e,predicate:r=>Fs.nonEmptyString(r==null?void 0:r.id),message:"id should not be empty"},{tag:this.getTag(),target:e,predicate:r=>Fs.optionalNonEmptyString(r==null?void 0:r.name),message:"name should be a non-empty string"},{tag:this.getTag(),target:e,predicate:r=>Fs.optionalNonEmptyString(r==null?void 0:r.purpose),message:"purpose should be a non-empty string"},{tag:this.getTag(),target:e,predicate:r=>Fs.formatValuesShouldNotBeEmpty(r==null?void 0:r.format),message:"formats values should not empty"},{tag:this.getTag(),target:e,predicate:r=>Fs.formatValuesShouldBeAmongKnownValues(r==null?void 0:r.format),message:"formats should only have known identifiers for alg or proof_type"},{tag:this.getTag(),target:e,predicate:r=>Fs.groupShouldMatchSubmissionRequirements(r),message:"input descriptor group should match the from in submission requirements."}]}static optionalNonEmptyString(e){return e==null||e.length>0}static nonEmptyString(e){return e!=null&&e.length>0}static formatValuesShouldNotBeEmpty(e){var n,s,i,o,a,c;let r=!0;return(e==null?void 0:e.jwt)!=null&&(r=r&&((n=e.jwt.alg)==null?void 0:n.length)>0),(e==null?void 0:e.jwt_vc)!=null&&(r=r&&((s=e.jwt_vc.alg)==null?void 0:s.length)>0),(e==null?void 0:e.jwt_vp)!=null&&(r=r&&((i=e.jwt_vp.alg)==null?void 0:i.length)>0),(e==null?void 0:e.ldp)!=null&&(r=r&&((o=e.ldp.proof_type)==null?void 0:o.length)>0),(e==null?void 0:e.ldp_vc)!=null&&(r=r&&((a=e.ldp_vc.proof_type)==null?void 0:a.length)>0),(e==null?void 0:e.ldp_vp)!=null&&(r=r&&((c=e.ldp_vp.proof_type)==null?void 0:c.length)>0),r}static formatValuesShouldBeAmongKnownValues(e){let r=[];if(e){const n=e8.getJwtAlgos(),s=t8.getLdpTypes();r=[];for(const[i,o]of Object.entries(e))i.startsWith("jwt")?r.push(...Fs.isJWTAlgoKnown(o,n)):r.push(...Fs.isLDPProofKnown(o,s))}return r.length===0}static isJWTAlgoKnown(e,r){const n=[];if(e!=null&&e.alg!=null)for(const s of e.alg)r.includes(s)||n.push(s);return n}static isLDPProofKnown(e,r){const n=[];if(e!=null&&e.proof_type!=null)for(const s of e.proof_type)r.includes(s)||n.push(s);return n}static groupShouldMatchSubmissionRequirements(e){if(e.submission_requirements!=null&&e.submission_requirements.length>0){const r=[];e.input_descriptors.forEach(a=>{a.group&&r.push(...a.group)});const n=new Set(r),s=[];Fs.flatten(e.submission_requirements).forEach(a=>{a.from&&s.push(...a.from)});const i=new Set(s);return new Set([...i].filter(a=>a!=null&&a.length>0&&!n.has(a))).size===0}return!0}static flatten(e){return e==null?void 0:e.reduce((r,n)=>r.concat(Array.isArray(n.from_nested)?this.flatten(n.from_nested):n),[])}shouldBeAsPerJsonSchema(){return e=>yO({presentation_definition:e})}}class li extends tu{constructor(e){super(e,"presentation_submission")}getValidations(e){return[{tag:this.getTag(),target:e,predicate:r=>r!=null,message:"presentation_submission should be non null."},{tag:this.getTag(),target:e,predicate:r=>li.nonEmptyString(r==null?void 0:r.id),message:"id should not be empty"},{tag:this.getTag(),target:e,predicate:r=>li.nonEmptyString(r==null?void 0:r.definition_id),message:"presentation_definition_id should not be empty"},{tag:this.getTag(),target:e,predicate:r=>li.descriptorMapMustBePresent(r==null?void 0:r.descriptor_map),message:"descriptor_map should be a non-empty list"},{tag:this.getTag(),target:e,predicate:r=>li.idMustBeSameForEachLevelOfNesting(r==null?void 0:r.descriptor_map),message:"each descriptor should have a one id in it, on all levels"},{tag:this.getTag(),target:e,predicate:r=>li.formatsShouldBeKnown(r==null?void 0:r.descriptor_map),message:"each format should be one of the known format"},{tag:this.getTag(),target:e,predicate:r=>li.pathsShouldBeValidJsonPaths(r==null?void 0:r.descriptor_map),message:"each path should be a valid jsonPath"}]}static nonEmptyString(e){return e!=null&&e.length>0}static descriptorMapMustBePresent(e){return e!=null&&e.length>0}static idMustBeSameForEachLevelOfNesting(e){let r=!0;if(e!=null)for(let n=0;n<e.length;n++)r=r&&li.isIdSameForEachLevelOfNesting(e[n],e[n].id);return r}static isIdSameForEachLevelOfNesting(e,r){let n=!0;return e!=null&&e.path_nested!=null&&(e.path_nested.id==r?n=n&&li.isIdSameForEachLevelOfNesting(e.path_nested,r):n=!1),n}static formatsShouldBeKnown(e){let r=!0;if(e!=null){const n=["jwt","jwt_vc","jwt_vp","ldp","ldp_vc","ldp_vp"];for(let s=0;s<e.length;s++)r=li.formatShouldBeKnown(e[s],n)}return r}static formatShouldBeKnown(e,r){let n=!0;return e!=null&&(n=r.includes(e.format)),e.path_nested!=null&&(n=n&&li.formatShouldBeKnown(e.path_nested,r)),n}static pathsShouldBeValidJsonPaths(e){let r=!0;if(e!=null)for(let n=0;n<e.length;n++)r=li.pathShouldBeValid(e[n],[]);return r}static pathShouldBeValid(e,r){if(e!=null){try{zt.parse(e.path)}catch{r.push(e.path)}e.path_nested!=null&&li.pathShouldBeValid(e.path_nested,r)}if(r.length>0)throw new j0("",$e.ERROR,"These were not parsable json paths: "+JSON.stringify(r));return!0}}const KG=t=>{const e=t.map(a=>s(a));function r(a){return new j0(a.tag,$e.ERROR,a.message)}function n(a){return new j0(a,$e.INFO,"ok")}function s(a){let c;try{a.predicate(a.target)?c=n(a.tag):c=r(a)}catch{c=r(a)}return c}const i=(a,c)=>(c.status!==$e.INFO&&a.push(c),a),o=e.reduce(i,[]);return PL(o)?o:[n("root")]};class Fx{validate(e){let r=[];for(const n of e)r=r.concat(n.bundler.getValidations(n.target));return KG(r)}}class Qu{constructor(){de(this,"_evaluationClientWrapper");this._evaluationClientWrapper=new gp}evaluatePresentation(e,r,n){const s=(n==null?void 0:n.generatePresentationSubmission)!==void 0?n.generatePresentationSubmission:(n==null?void 0:n.presentationSubmission)!==void 0,i=Wn.toInternalPresentationDefinition(e),o=JSON.parse(JSON.stringify(r)),a=Wn.mapExternalVerifiablePresentationToWrappedVP(o),c=(n==null?void 0:n.presentationSubmission)||a.presentation.presentation_submission;if(!c&&!s)throw Error("Either a presentation submission as part of the VP or provided separately was expected");const l=a.presentation.holder?[a.presentation.holder]:[],u={...n,holderDIDs:l,presentationSubmission:c,generatePresentationSubmission:s},d=this._evaluationClientWrapper.evaluate(i,a.vcs,u);return d.value&&d.value.descriptor_map.length&&new gp().selectFrom(i,a.vcs,u).areRequiredCredentialsPresent!==$e.ERROR&&(d.errors=[]),d}evaluateCredentials(e,r,n){const s=Wn.mapExternalVerifiableCredentialsToWrappedVcs(r);this._evaluationClientWrapper=new gp;const i=Wn.toInternalPresentationDefinition(e),o=this._evaluationClientWrapper.evaluate(i,s,n);if(o.value&&o.value.descriptor_map.length){const c=new gp().selectFrom(i,s,n);o.areRequiredCredentialsPresent=c.areRequiredCredentialsPresent,o.errors=c.errors}else o.areRequiredCredentialsPresent=$e.ERROR;return o}selectFrom(e,r,n){const s=JSON.parse(JSON.stringify(r)),i=Wn.toInternalPresentationDefinition(e);return this._evaluationClientWrapper=new gp,this._evaluationClientWrapper.selectFrom(i,Wn.mapExternalVerifiableCredentialsToWrappedVcs(s),n)}presentationSubmissionFrom(e,r){const n=Wn.toInternalPresentationDefinition(e);return this._evaluationClientWrapper.submissionFrom(n,Wn.mapExternalVerifiableCredentialsToWrappedVcs(r))}presentationFrom(e,r,n){const s=(n==null?void 0:n.presentationSubmissionLocation)??sh.PRESENTATION,i=this.presentationSubmissionFrom(e,r);return{presentation:Qu.constructPresentation(r,{...n,presentationSubmission:s===sh.PRESENTATION?i:void 0}),presentationSubmissionLocation:s,presentationSubmission:i}}static constructPresentation(e,r){var o,a,c,l;const n=r==null?void 0:r.holderDID,s=Array.isArray((o=r==null?void 0:r.basePresentationPayload)==null?void 0:o.type)?((a=r==null?void 0:r.basePresentationPayload)==null?void 0:a.type)||[]:(c=r==null?void 0:r.basePresentationPayload)!=null&&c.type?[r.basePresentationPayload.type]:[],i=(l=r==null?void 0:r.basePresentationPayload)!=null&&l["@context"]?Array.isArray(r.basePresentationPayload["@context"])?r.basePresentationPayload["@context"]:[r.basePresentationPayload["@context"]]:[];return i.includes("https://www.w3.org/2018/credentials/v1")||i.push("https://www.w3.org/2018/credentials/v1"),s.includes("VerifiablePresentation")||s.push("VerifiablePresentation"),r!=null&&r.presentationSubmission&&(s.includes("PresentationSubmission")||s.push("PresentationSubmission"),i.includes("https://identity.foundation/presentation-exchange/submission/v1")||i.push("https://identity.foundation/presentation-exchange/submission/v1")),{...r==null?void 0:r.basePresentationPayload,"@context":i,type:s,holder:n,...!!(r!=null&&r.presentationSubmission)&&{presentation_submission:r.presentationSubmission},verifiableCredential:Array.isArray(e)?e:[e]}}static validateDefinition(e){const r=Gb(e);if(r.error)throw r.error;const n=[];return r.version===Vs.v1?n.push({bundler:new es("root"),target:Wn.modelEntityToInternalPresentationDefinitionV1(e)}):n.push({bundler:new Fs("root"),target:Wn.modelEntityInternalPresentationDefinitionV2(e)}),new Fx().validate(n)}static validateSubmission(e){return new Fx().validate([{bundler:new li("root"),target:e}])}async verifiablePresentationFrom(e,r,n,s){const{holderDID:i,signatureOptions:o,proofOptions:a}=s,c=s.presentationSubmissionLocation??sh.PRESENTATION;function l(){let g=[];if(a!=null&&a.typeSupportsSelectiveDisclosure){if(!(a!=null&&a.type))throw Error("Please provide a proof type if you enable selective disclosure");g=[a.type]}return g}const u=i?[i]:[],d=l(),h=this.evaluateCredentials(e,r,{holderDIDs:u,limitDisclosureSignatureSuites:d}),f=this.presentationFrom(e,h.verifiableCredential,{...s,presentationSubmissionLocation:c}),p=this.evaluatePresentation(e,f.presentation,{limitDisclosureSignatureSuites:d});if(!p.value)throw new Error("Could not get evaluation results from presentationResult");const y={type:a==null?void 0:a.type,verificationMethod:o==null?void 0:o.verificationMethod,created:a!=null&&a.created?a.created:new Date().toISOString(),proofPurpose:a==null?void 0:a.proofPurpose,proofValue:o==null?void 0:o.proofValue,jws:o==null?void 0:o.jws,challenge:a==null?void 0:a.challenge,nonce:a==null?void 0:a.nonce,domain:a==null?void 0:a.domain},b={options:s,presentation:f.presentation,presentationDefinition:e,selectedCredentials:r,proof:y,presentationSubmission:p.value,evaluationResults:p};return{verifiablePresentation:await n(b),presentationSubmissionLocation:c,presentationSubmission:p.value}}static definitionVersionDiscovery(e){return Gb(e)}}class G0{static selectCredentials({vcJwts:e,presentationDefinition:r}){var n,s;this.resetPex();const i=this.pex.selectFrom(r,e);return((n=i.errors)===null||n===void 0?void 0:n.length)!==0?[]:Array.from(new Set((s=i.verifiableCredential)!==null&&s!==void 0?s:[]))}static satisfiesPresentationDefinition({vcJwts:e,presentationDefinition:r}){var n,s,i;this.resetPex();const o=this.pex.evaluateCredentials(r,e);if(!((n=o.warnings)===null||n===void 0)&&n.length&&console.warn("Warnings were generated during the evaluation process: "+JSON.stringify(o.warnings)),o.areRequiredCredentialsPresent.toString()!=="info"||!((s=o.errors)===null||s===void 0)&&s.length){let a="Failed to create Verifiable Presentation JWT due to: ";throw o.areRequiredCredentialsPresent&&(a+="Required Credentials Not Present: "+JSON.stringify(o.areRequiredCredentialsPresent)),!((i=o.errors)===null||i===void 0)&&i.length&&(a+="Errors: "+JSON.stringify(o.errors)),new Error(a)}}static createPresentationFromCredentials({vcJwts:e,presentationDefinition:r}){var n,s,i;this.resetPex();const o=Qu.validateDefinition(r);Nx(o);const a=this.pex.evaluateCredentials(r,e);if(!((n=a.warnings)===null||n===void 0)&&n.length&&console.warn("Warnings were generated during the evaluation process: "+JSON.stringify(a.warnings)),a.areRequiredCredentialsPresent.toString()!=="info"||!((s=a.errors)===null||s===void 0)&&s.length){let u="Failed to create Verifiable Presentation JWT due to: ";throw a.areRequiredCredentialsPresent&&(u+="Required Credentials Not Present: "+JSON.stringify(a.areRequiredCredentialsPresent)),!((i=a.errors)===null||i===void 0)&&i.length&&(u+="Errors: "+JSON.stringify(a.errors)),new Error(u)}const c=this.pex.presentationFrom(r,e),l=Qu.validateSubmission(c.presentationSubmission);return Nx(l),c}static validateDefinition({presentationDefinition:e}){return Qu.validateDefinition(e)}static validateSubmission({presentationSubmission:e}){return Qu.validateSubmission(e)}static evaluatePresentation({presentationDefinition:e,presentation:r}){return this.resetPex(),this.pex.evaluatePresentation(e,r)}static resetPex(){this.pex=new Qu}}G0.pex=new Qu;function Nx(t){let e="Failed to pass validation check due to: ";if(Array.isArray(t)){if(!t.every(r=>r.status==="info"))throw e+="Validation Errors: "+JSON.stringify(t),new Error(e)}else if(t.status!=="info")throw e+="Validation Errors: "+JSON.stringify(t),new Error(e)}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const LG=4,Rx=0,jx=1,qG=2;function _f(t){let e=t.length;for(;--e>=0;)t[e]=0}const VG=0,r8=1,zG=2,HG=3,WG=258,BE=29,ly=256,kh=ly+1+BE,Hd=30,FE=19,n8=2*kh+1,El=15,Pw=16,JG=7,NE=256,i8=16,s8=17,o8=18,a1=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),y0=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),GG=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),a8=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ZG=512,Ia=new Array((kh+2)*2);_f(Ia);const oh=new Array(Hd*2);_f(oh);const Oh=new Array(ZG);_f(Oh);const Th=new Array(WG-HG+1);_f(Th);const RE=new Array(BE);_f(RE);const Z0=new Array(Hd);_f(Z0);function Cw(t,e,r,n,s){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=s,this.has_stree=t&&t.length}let u8,c8,l8;function kw(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}const d8=t=>t<256?Oh[t]:Oh[256+(t>>>7)],Ih=(t,e)=>{t.pending_buf[t.pending++]=e&255,t.pending_buf[t.pending++]=e>>>8&255},wi=(t,e,r)=>{t.bi_valid>Pw-r?(t.bi_buf|=e<<t.bi_valid&65535,Ih(t,t.bi_buf),t.bi_buf=e>>Pw-t.bi_valid,t.bi_valid+=r-Pw):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)},ko=(t,e,r)=>{wi(t,r[e*2],r[e*2+1])},f8=(t,e)=>{let r=0;do r|=t&1,t>>>=1,r<<=1;while(--e>0);return r>>>1},XG=t=>{t.bi_valid===16?(Ih(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)},YG=(t,e)=>{const r=e.dyn_tree,n=e.max_code,s=e.stat_desc.static_tree,i=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,c=e.stat_desc.max_length;let l,u,d,h,f,p,y=0;for(h=0;h<=El;h++)t.bl_count[h]=0;for(r[t.heap[t.heap_max]*2+1]=0,l=t.heap_max+1;l<n8;l++)u=t.heap[l],h=r[r[u*2+1]*2+1]+1,h>c&&(h=c,y++),r[u*2+1]=h,!(u>n)&&(t.bl_count[h]++,f=0,u>=a&&(f=o[u-a]),p=r[u*2],t.opt_len+=p*(h+f),i&&(t.static_len+=p*(s[u*2+1]+f)));if(y!==0){do{for(h=c-1;t.bl_count[h]===0;)h--;t.bl_count[h]--,t.bl_count[h+1]+=2,t.bl_count[c]--,y-=2}while(y>0);for(h=c;h!==0;h--)for(u=t.bl_count[h];u!==0;)d=t.heap[--l],!(d>n)&&(r[d*2+1]!==h&&(t.opt_len+=(h-r[d*2+1])*r[d*2],r[d*2+1]=h),u--)}},p8=(t,e,r)=>{const n=new Array(El+1);let s=0,i,o;for(i=1;i<=El;i++)s=s+r[i-1]<<1,n[i]=s;for(o=0;o<=e;o++){let a=t[o*2+1];a!==0&&(t[o*2]=f8(n[a]++,a))}},QG=()=>{let t,e,r,n,s;const i=new Array(El+1);for(r=0,n=0;n<BE-1;n++)for(RE[n]=r,t=0;t<1<<a1[n];t++)Th[r++]=n;for(Th[r-1]=n,s=0,n=0;n<16;n++)for(Z0[n]=s,t=0;t<1<<y0[n];t++)Oh[s++]=n;for(s>>=7;n<Hd;n++)for(Z0[n]=s<<7,t=0;t<1<<y0[n]-7;t++)Oh[256+s++]=n;for(e=0;e<=El;e++)i[e]=0;for(t=0;t<=143;)Ia[t*2+1]=8,t++,i[8]++;for(;t<=255;)Ia[t*2+1]=9,t++,i[9]++;for(;t<=279;)Ia[t*2+1]=7,t++,i[7]++;for(;t<=287;)Ia[t*2+1]=8,t++,i[8]++;for(p8(Ia,kh+1,i),t=0;t<Hd;t++)oh[t*2+1]=5,oh[t*2]=f8(t,5);u8=new Cw(Ia,a1,ly+1,kh,El),c8=new Cw(oh,y0,0,Hd,El),l8=new Cw(new Array(0),GG,0,FE,JG)},h8=t=>{let e;for(e=0;e<kh;e++)t.dyn_ltree[e*2]=0;for(e=0;e<Hd;e++)t.dyn_dtree[e*2]=0;for(e=0;e<FE;e++)t.bl_tree[e*2]=0;t.dyn_ltree[NE*2]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},y8=t=>{t.bi_valid>8?Ih(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},Mx=(t,e,r,n)=>{const s=e*2,i=r*2;return t[s]<t[i]||t[s]===t[i]&&n[e]<=n[r]},Ow=(t,e,r)=>{const n=t.heap[r];let s=r<<1;for(;s<=t.heap_len&&(s<t.heap_len&&Mx(e,t.heap[s+1],t.heap[s],t.depth)&&s++,!Mx(e,n,t.heap[s],t.depth));)t.heap[r]=t.heap[s],r=s,s<<=1;t.heap[r]=n},Ux=(t,e,r)=>{let n,s,i=0,o,a;if(t.sym_next!==0)do n=t.pending_buf[t.sym_buf+i++]&255,n+=(t.pending_buf[t.sym_buf+i++]&255)<<8,s=t.pending_buf[t.sym_buf+i++],n===0?ko(t,s,e):(o=Th[s],ko(t,o+ly+1,e),a=a1[o],a!==0&&(s-=RE[o],wi(t,s,a)),n--,o=d8(n),ko(t,o,r),a=y0[o],a!==0&&(n-=Z0[o],wi(t,n,a)));while(i<t.sym_next);ko(t,NE,e)},u1=(t,e)=>{const r=e.dyn_tree,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,i=e.stat_desc.elems;let o,a,c=-1,l;for(t.heap_len=0,t.heap_max=n8,o=0;o<i;o++)r[o*2]!==0?(t.heap[++t.heap_len]=c=o,t.depth[o]=0):r[o*2+1]=0;for(;t.heap_len<2;)l=t.heap[++t.heap_len]=c<2?++c:0,r[l*2]=1,t.depth[l]=0,t.opt_len--,s&&(t.static_len-=n[l*2+1]);for(e.max_code=c,o=t.heap_len>>1;o>=1;o--)Ow(t,r,o);l=i;do o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],Ow(t,r,1),a=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=a,r[l*2]=r[o*2]+r[a*2],t.depth[l]=(t.depth[o]>=t.depth[a]?t.depth[o]:t.depth[a])+1,r[o*2+1]=r[a*2+1]=l,t.heap[1]=l++,Ow(t,r,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],YG(t,e),p8(r,c,t.bl_count)},Kx=(t,e,r)=>{let n,s=-1,i,o=e[0*2+1],a=0,c=7,l=4;for(o===0&&(c=138,l=3),e[(r+1)*2+1]=65535,n=0;n<=r;n++)i=o,o=e[(n+1)*2+1],!(++a<c&&i===o)&&(a<l?t.bl_tree[i*2]+=a:i!==0?(i!==s&&t.bl_tree[i*2]++,t.bl_tree[i8*2]++):a<=10?t.bl_tree[s8*2]++:t.bl_tree[o8*2]++,a=0,s=i,o===0?(c=138,l=3):i===o?(c=6,l=3):(c=7,l=4))},Lx=(t,e,r)=>{let n,s=-1,i,o=e[0*2+1],a=0,c=7,l=4;for(o===0&&(c=138,l=3),n=0;n<=r;n++)if(i=o,o=e[(n+1)*2+1],!(++a<c&&i===o)){if(a<l)do ko(t,i,t.bl_tree);while(--a!==0);else i!==0?(i!==s&&(ko(t,i,t.bl_tree),a--),ko(t,i8,t.bl_tree),wi(t,a-3,2)):a<=10?(ko(t,s8,t.bl_tree),wi(t,a-3,3)):(ko(t,o8,t.bl_tree),wi(t,a-11,7));a=0,s=i,o===0?(c=138,l=3):i===o?(c=6,l=3):(c=7,l=4)}},eZ=t=>{let e;for(Kx(t,t.dyn_ltree,t.l_desc.max_code),Kx(t,t.dyn_dtree,t.d_desc.max_code),u1(t,t.bl_desc),e=FE-1;e>=3&&t.bl_tree[a8[e]*2+1]===0;e--);return t.opt_len+=3*(e+1)+5+5+4,e},tZ=(t,e,r,n)=>{let s;for(wi(t,e-257,5),wi(t,r-1,5),wi(t,n-4,4),s=0;s<n;s++)wi(t,t.bl_tree[a8[s]*2+1],3);Lx(t,t.dyn_ltree,e-1),Lx(t,t.dyn_dtree,r-1)},rZ=t=>{let e=4093624447,r;for(r=0;r<=31;r++,e>>>=1)if(e&1&&t.dyn_ltree[r*2]!==0)return Rx;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return jx;for(r=32;r<ly;r++)if(t.dyn_ltree[r*2]!==0)return jx;return Rx};let qx=!1;const nZ=t=>{qx||(QG(),qx=!0),t.l_desc=new kw(t.dyn_ltree,u8),t.d_desc=new kw(t.dyn_dtree,c8),t.bl_desc=new kw(t.bl_tree,l8),t.bi_buf=0,t.bi_valid=0,h8(t)},m8=(t,e,r,n)=>{wi(t,(VG<<1)+(n?1:0),3),y8(t),Ih(t,r),Ih(t,~r),r&&t.pending_buf.set(t.window.subarray(e,e+r),t.pending),t.pending+=r},iZ=t=>{wi(t,r8<<1,3),ko(t,NE,Ia),XG(t)},sZ=(t,e,r,n)=>{let s,i,o=0;t.level>0?(t.strm.data_type===qG&&(t.strm.data_type=rZ(t)),u1(t,t.l_desc),u1(t,t.d_desc),o=eZ(t),s=t.opt_len+3+7>>>3,i=t.static_len+3+7>>>3,i<=s&&(s=i)):s=i=r+5,r+4<=s&&e!==-1?m8(t,e,r,n):t.strategy===LG||i===s?(wi(t,(r8<<1)+(n?1:0),3),Ux(t,Ia,oh)):(wi(t,(zG<<1)+(n?1:0),3),tZ(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),Ux(t,t.dyn_ltree,t.dyn_dtree)),h8(t),n&&y8(t)},oZ=(t,e,r)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=r,e===0?t.dyn_ltree[r*2]++:(t.matches++,e--,t.dyn_ltree[(Th[r]+ly+1)*2]++,t.dyn_dtree[d8(e)*2]++),t.sym_next===t.sym_end);var aZ=nZ,uZ=m8,cZ=sZ,lZ=oZ,dZ=iZ,fZ={_tr_init:aZ,_tr_stored_block:uZ,_tr_flush_block:cZ,_tr_tally:lZ,_tr_align:dZ};const pZ=(t,e,r,n)=>{let s=t&65535|0,i=t>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do s=s+e[n++]|0,i=i+s|0;while(--o);s%=65521,i%=65521}return s|i<<16|0};var Bh=pZ;const hZ=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},yZ=new Uint32Array(hZ()),mZ=(t,e,r,n)=>{const s=yZ,i=n+r;t^=-1;for(let o=n;o<i;o++)t=t>>>8^s[(t^e[o])&255];return t^-1};var on=mZ,Fh={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Jg={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:gZ,_tr_stored_block:c1,_tr_flush_block:vZ,_tr_tally:cc,_tr_align:wZ}=fZ,{Z_NO_FLUSH:lc,Z_PARTIAL_FLUSH:bZ,Z_FULL_FLUSH:_Z,Z_FINISH:hs,Z_BLOCK:Vx,Z_OK:Pn,Z_STREAM_END:zx,Z_STREAM_ERROR:Mo,Z_DATA_ERROR:EZ,Z_BUF_ERROR:Tw,Z_DEFAULT_COMPRESSION:AZ,Z_FILTERED:SZ,Z_HUFFMAN_ONLY:bm,Z_RLE:$Z,Z_FIXED:xZ,Z_DEFAULT_STRATEGY:DZ,Z_UNKNOWN:PZ,Z_DEFLATED:Gg}=Jg,CZ=9,kZ=15,OZ=8,TZ=29,IZ=256,l1=IZ+1+TZ,BZ=30,FZ=19,NZ=2*l1+1,RZ=15,Nt=3,ic=258,Uo=ic+Nt+1,jZ=32,uf=42,jE=57,d1=69,f1=73,p1=91,h1=103,Al=113,zp=666,Qn=1,Ef=2,Gl=3,Af=4,MZ=3,Sl=(t,e)=>(t.msg=Fh[e],e),Hx=t=>t*2-(t>4?9:0),ec=t=>{let e=t.length;for(;--e>=0;)t[e]=0},UZ=t=>{let e,r,n,s=t.w_size;e=t.hash_size,n=e;do r=t.head[--n],t.head[n]=r>=s?r-s:0;while(--e);e=s,n=e;do r=t.prev[--n],t.prev[n]=r>=s?r-s:0;while(--e)};let KZ=(t,e,r)=>(e<<t.hash_shift^r)&t.hash_mask,dc=KZ;const xi=t=>{const e=t.state;let r=e.pending;r>t.avail_out&&(r=t.avail_out),r!==0&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+r),t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,e.pending===0&&(e.pending_out=0))},Fi=(t,e)=>{vZ(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,xi(t.strm)},Kt=(t,e)=>{t.pending_buf[t.pending++]=e},vp=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=e&255},y1=(t,e,r,n)=>{let s=t.avail_in;return s>n&&(s=n),s===0?0:(t.avail_in-=s,e.set(t.input.subarray(t.next_in,t.next_in+s),r),t.state.wrap===1?t.adler=Bh(t.adler,e,s,r):t.state.wrap===2&&(t.adler=on(t.adler,e,s,r)),t.next_in+=s,t.total_in+=s,s)},g8=(t,e)=>{let r=t.max_chain_length,n=t.strstart,s,i,o=t.prev_length,a=t.nice_match;const c=t.strstart>t.w_size-Uo?t.strstart-(t.w_size-Uo):0,l=t.window,u=t.w_mask,d=t.prev,h=t.strstart+ic;let f=l[n+o-1],p=l[n+o];t.prev_length>=t.good_match&&(r>>=2),a>t.lookahead&&(a=t.lookahead);do if(s=e,!(l[s+o]!==p||l[s+o-1]!==f||l[s]!==l[n]||l[++s]!==l[n+1])){n+=2,s++;do;while(l[++n]===l[++s]&&l[++n]===l[++s]&&l[++n]===l[++s]&&l[++n]===l[++s]&&l[++n]===l[++s]&&l[++n]===l[++s]&&l[++n]===l[++s]&&l[++n]===l[++s]&&n<h);if(i=ic-(h-n),n=h-ic,i>o){if(t.match_start=e,o=i,i>=a)break;f=l[n+o-1],p=l[n+o]}}while((e=d[e&u])>c&&--r!==0);return o<=t.lookahead?o:t.lookahead},cf=t=>{const e=t.w_size;let r,n,s;do{if(n=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-Uo)&&(t.window.set(t.window.subarray(e,e+e-n),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),UZ(t),n+=e),t.strm.avail_in===0)break;if(r=y1(t.strm,t.window,t.strstart+t.lookahead,n),t.lookahead+=r,t.lookahead+t.insert>=Nt)for(s=t.strstart-t.insert,t.ins_h=t.window[s],t.ins_h=dc(t,t.ins_h,t.window[s+1]);t.insert&&(t.ins_h=dc(t,t.ins_h,t.window[s+Nt-1]),t.prev[s&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=s,s++,t.insert--,!(t.lookahead+t.insert<Nt)););}while(t.lookahead<Uo&&t.strm.avail_in!==0)},v8=(t,e)=>{let r=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,n,s,i,o=0,a=t.strm.avail_in;do{if(n=65535,i=t.bi_valid+42>>3,t.strm.avail_out<i||(i=t.strm.avail_out-i,s=t.strstart-t.block_start,n>s+t.strm.avail_in&&(n=s+t.strm.avail_in),n>i&&(n=i),n<r&&(n===0&&e!==hs||e===lc||n!==s+t.strm.avail_in)))break;o=e===hs&&n===s+t.strm.avail_in?1:0,c1(t,0,0,o),t.pending_buf[t.pending-4]=n,t.pending_buf[t.pending-3]=n>>8,t.pending_buf[t.pending-2]=~n,t.pending_buf[t.pending-1]=~n>>8,xi(t.strm),s&&(s>n&&(s=n),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+s),t.strm.next_out),t.strm.next_out+=s,t.strm.avail_out-=s,t.strm.total_out+=s,t.block_start+=s,n-=s),n&&(y1(t.strm,t.strm.output,t.strm.next_out,n),t.strm.next_out+=n,t.strm.avail_out-=n,t.strm.total_out+=n)}while(o===0);return a-=t.strm.avail_in,a&&(a>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=a&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-a,t.strm.next_in),t.strstart),t.strstart+=a,t.insert+=a>t.w_size-t.insert?t.w_size-t.insert:a),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),o?Af:e!==lc&&e!==hs&&t.strm.avail_in===0&&t.strstart===t.block_start?Ef:(i=t.window_size-t.strstart,t.strm.avail_in>i&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,i+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),i>t.strm.avail_in&&(i=t.strm.avail_in),i&&(y1(t.strm,t.window,t.strstart,i),t.strstart+=i,t.insert+=i>t.w_size-t.insert?t.w_size-t.insert:i),t.high_water<t.strstart&&(t.high_water=t.strstart),i=t.bi_valid+42>>3,i=t.pending_buf_size-i>65535?65535:t.pending_buf_size-i,r=i>t.w_size?t.w_size:i,s=t.strstart-t.block_start,(s>=r||(s||e===hs)&&e!==lc&&t.strm.avail_in===0&&s<=i)&&(n=s>i?i:s,o=e===hs&&t.strm.avail_in===0&&n===s?1:0,c1(t,t.block_start,n,o),t.block_start+=n,xi(t.strm)),o?Gl:Qn)},Iw=(t,e)=>{let r,n;for(;;){if(t.lookahead<Uo){if(cf(t),t.lookahead<Uo&&e===lc)return Qn;if(t.lookahead===0)break}if(r=0,t.lookahead>=Nt&&(t.ins_h=dc(t,t.ins_h,t.window[t.strstart+Nt-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),r!==0&&t.strstart-r<=t.w_size-Uo&&(t.match_length=g8(t,r)),t.match_length>=Nt)if(n=cc(t,t.strstart-t.match_start,t.match_length-Nt),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=Nt){t.match_length--;do t.strstart++,t.ins_h=dc(t,t.ins_h,t.window[t.strstart+Nt-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!==0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=dc(t,t.ins_h,t.window[t.strstart+1]);else n=cc(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(Fi(t,!1),t.strm.avail_out===0))return Qn}return t.insert=t.strstart<Nt-1?t.strstart:Nt-1,e===hs?(Fi(t,!0),t.strm.avail_out===0?Gl:Af):t.sym_next&&(Fi(t,!1),t.strm.avail_out===0)?Qn:Ef},_d=(t,e)=>{let r,n,s;for(;;){if(t.lookahead<Uo){if(cf(t),t.lookahead<Uo&&e===lc)return Qn;if(t.lookahead===0)break}if(r=0,t.lookahead>=Nt&&(t.ins_h=dc(t,t.ins_h,t.window[t.strstart+Nt-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=Nt-1,r!==0&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-Uo&&(t.match_length=g8(t,r),t.match_length<=5&&(t.strategy===SZ||t.match_length===Nt&&t.strstart-t.match_start>4096)&&(t.match_length=Nt-1)),t.prev_length>=Nt&&t.match_length<=t.prev_length){s=t.strstart+t.lookahead-Nt,n=cc(t,t.strstart-1-t.prev_match,t.prev_length-Nt),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=s&&(t.ins_h=dc(t,t.ins_h,t.window[t.strstart+Nt-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!==0);if(t.match_available=0,t.match_length=Nt-1,t.strstart++,n&&(Fi(t,!1),t.strm.avail_out===0))return Qn}else if(t.match_available){if(n=cc(t,0,t.window[t.strstart-1]),n&&Fi(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return Qn}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=cc(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<Nt-1?t.strstart:Nt-1,e===hs?(Fi(t,!0),t.strm.avail_out===0?Gl:Af):t.sym_next&&(Fi(t,!1),t.strm.avail_out===0)?Qn:Ef},LZ=(t,e)=>{let r,n,s,i;const o=t.window;for(;;){if(t.lookahead<=ic){if(cf(t),t.lookahead<=ic&&e===lc)return Qn;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=Nt&&t.strstart>0&&(s=t.strstart-1,n=o[s],n===o[++s]&&n===o[++s]&&n===o[++s])){i=t.strstart+ic;do;while(n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&s<i);t.match_length=ic-(i-s),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=Nt?(r=cc(t,1,t.match_length-Nt),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=cc(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(Fi(t,!1),t.strm.avail_out===0))return Qn}return t.insert=0,e===hs?(Fi(t,!0),t.strm.avail_out===0?Gl:Af):t.sym_next&&(Fi(t,!1),t.strm.avail_out===0)?Qn:Ef},qZ=(t,e)=>{let r;for(;;){if(t.lookahead===0&&(cf(t),t.lookahead===0)){if(e===lc)return Qn;break}if(t.match_length=0,r=cc(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(Fi(t,!1),t.strm.avail_out===0))return Qn}return t.insert=0,e===hs?(Fi(t,!0),t.strm.avail_out===0?Gl:Af):t.sym_next&&(Fi(t,!1),t.strm.avail_out===0)?Qn:Ef};function uo(t,e,r,n,s){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=s}const Hp=[new uo(0,0,0,0,v8),new uo(4,4,8,4,Iw),new uo(4,5,16,8,Iw),new uo(4,6,32,32,Iw),new uo(4,4,16,16,_d),new uo(8,16,32,32,_d),new uo(8,16,128,128,_d),new uo(8,32,128,256,_d),new uo(32,128,258,1024,_d),new uo(32,258,258,4096,_d)],VZ=t=>{t.window_size=2*t.w_size,ec(t.head),t.max_lazy_match=Hp[t.level].max_lazy,t.good_match=Hp[t.level].good_length,t.nice_match=Hp[t.level].nice_length,t.max_chain_length=Hp[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=Nt-1,t.match_available=0,t.ins_h=0};function zZ(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Gg,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(NZ*2),this.dyn_dtree=new Uint16Array((2*BZ+1)*2),this.bl_tree=new Uint16Array((2*FZ+1)*2),ec(this.dyn_ltree),ec(this.dyn_dtree),ec(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(RZ+1),this.heap=new Uint16Array(2*l1+1),ec(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*l1+1),ec(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const dy=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.status!==uf&&e.status!==jE&&e.status!==d1&&e.status!==f1&&e.status!==p1&&e.status!==h1&&e.status!==Al&&e.status!==zp?1:0},w8=t=>{if(dy(t))return Sl(t,Mo);t.total_in=t.total_out=0,t.data_type=PZ;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap===2?jE:e.wrap?uf:Al,t.adler=e.wrap===2?0:1,e.last_flush=-2,gZ(e),Pn},b8=t=>{const e=w8(t);return e===Pn&&VZ(t.state),e},HZ=(t,e)=>dy(t)||t.state.wrap!==2?Mo:(t.state.gzhead=e,Pn),_8=(t,e,r,n,s,i)=>{if(!t)return Mo;let o=1;if(e===AZ&&(e=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),s<1||s>CZ||r!==Gg||n<8||n>15||e<0||e>9||i<0||i>xZ||n===8&&o!==1)return Sl(t,Mo);n===8&&(n=9);const a=new zZ;return t.state=a,a.strm=t,a.status=uf,a.wrap=o,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=s+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+Nt-1)/Nt),a.window=new Uint8Array(a.w_size*2),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<s+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=(a.lit_bufsize-1)*3,a.level=e,a.strategy=i,a.method=r,b8(t)},WZ=(t,e)=>_8(t,e,Gg,kZ,OZ,DZ),JZ=(t,e)=>{if(dy(t)||e>Vx||e<0)return t?Sl(t,Mo):Mo;const r=t.state;if(!t.output||t.avail_in!==0&&!t.input||r.status===zp&&e!==hs)return Sl(t,t.avail_out===0?Tw:Mo);const n=r.last_flush;if(r.last_flush=e,r.pending!==0){if(xi(t),t.avail_out===0)return r.last_flush=-1,Pn}else if(t.avail_in===0&&Hx(e)<=Hx(n)&&e!==hs)return Sl(t,Tw);if(r.status===zp&&t.avail_in!==0)return Sl(t,Tw);if(r.status===uf&&r.wrap===0&&(r.status=Al),r.status===uf){let s=Gg+(r.w_bits-8<<4)<<8,i=-1;if(r.strategy>=bm||r.level<2?i=0:r.level<6?i=1:r.level===6?i=2:i=3,s|=i<<6,r.strstart!==0&&(s|=jZ),s+=31-s%31,vp(r,s),r.strstart!==0&&(vp(r,t.adler>>>16),vp(r,t.adler&65535)),t.adler=1,r.status=Al,xi(t),r.pending!==0)return r.last_flush=-1,Pn}if(r.status===jE){if(t.adler=0,Kt(r,31),Kt(r,139),Kt(r,8),r.gzhead)Kt(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Kt(r,r.gzhead.time&255),Kt(r,r.gzhead.time>>8&255),Kt(r,r.gzhead.time>>16&255),Kt(r,r.gzhead.time>>24&255),Kt(r,r.level===9?2:r.strategy>=bm||r.level<2?4:0),Kt(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(Kt(r,r.gzhead.extra.length&255),Kt(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=on(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=d1;else if(Kt(r,0),Kt(r,0),Kt(r,0),Kt(r,0),Kt(r,0),Kt(r,r.level===9?2:r.strategy>=bm||r.level<2?4:0),Kt(r,MZ),r.status=Al,xi(t),r.pending!==0)return r.last_flush=-1,Pn}if(r.status===d1){if(r.gzhead.extra){let s=r.pending,i=(r.gzhead.extra.length&65535)-r.gzindex;for(;r.pending+i>r.pending_buf_size;){let a=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+a),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>s&&(t.adler=on(t.adler,r.pending_buf,r.pending-s,s)),r.gzindex+=a,xi(t),r.pending!==0)return r.last_flush=-1,Pn;s=0,i-=a}let o=new Uint8Array(r.gzhead.extra);r.pending_buf.set(o.subarray(r.gzindex,r.gzindex+i),r.pending),r.pending+=i,r.gzhead.hcrc&&r.pending>s&&(t.adler=on(t.adler,r.pending_buf,r.pending-s,s)),r.gzindex=0}r.status=f1}if(r.status===f1){if(r.gzhead.name){let s=r.pending,i;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>s&&(t.adler=on(t.adler,r.pending_buf,r.pending-s,s)),xi(t),r.pending!==0)return r.last_flush=-1,Pn;s=0}r.gzindex<r.gzhead.name.length?i=r.gzhead.name.charCodeAt(r.gzindex++)&255:i=0,Kt(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>s&&(t.adler=on(t.adler,r.pending_buf,r.pending-s,s)),r.gzindex=0}r.status=p1}if(r.status===p1){if(r.gzhead.comment){let s=r.pending,i;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>s&&(t.adler=on(t.adler,r.pending_buf,r.pending-s,s)),xi(t),r.pending!==0)return r.last_flush=-1,Pn;s=0}r.gzindex<r.gzhead.comment.length?i=r.gzhead.comment.charCodeAt(r.gzindex++)&255:i=0,Kt(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>s&&(t.adler=on(t.adler,r.pending_buf,r.pending-s,s))}r.status=h1}if(r.status===h1){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(xi(t),r.pending!==0))return r.last_flush=-1,Pn;Kt(r,t.adler&255),Kt(r,t.adler>>8&255),t.adler=0}if(r.status=Al,xi(t),r.pending!==0)return r.last_flush=-1,Pn}if(t.avail_in!==0||r.lookahead!==0||e!==lc&&r.status!==zp){let s=r.level===0?v8(r,e):r.strategy===bm?qZ(r,e):r.strategy===$Z?LZ(r,e):Hp[r.level].func(r,e);if((s===Gl||s===Af)&&(r.status=zp),s===Qn||s===Gl)return t.avail_out===0&&(r.last_flush=-1),Pn;if(s===Ef&&(e===bZ?wZ(r):e!==Vx&&(c1(r,0,0,!1),e===_Z&&(ec(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),xi(t),t.avail_out===0))return r.last_flush=-1,Pn}return e!==hs?Pn:r.wrap<=0?zx:(r.wrap===2?(Kt(r,t.adler&255),Kt(r,t.adler>>8&255),Kt(r,t.adler>>16&255),Kt(r,t.adler>>24&255),Kt(r,t.total_in&255),Kt(r,t.total_in>>8&255),Kt(r,t.total_in>>16&255),Kt(r,t.total_in>>24&255)):(vp(r,t.adler>>>16),vp(r,t.adler&65535)),xi(t),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?Pn:zx)},GZ=t=>{if(dy(t))return Mo;const e=t.state.status;return t.state=null,e===Al?Sl(t,EZ):Pn},ZZ=(t,e)=>{let r=e.length;if(dy(t))return Mo;const n=t.state,s=n.wrap;if(s===2||s===1&&n.status!==uf||n.lookahead)return Mo;if(s===1&&(t.adler=Bh(t.adler,e,r,0)),n.wrap=0,r>=n.w_size){s===0&&(ec(n.head),n.strstart=0,n.block_start=0,n.insert=0);let c=new Uint8Array(n.w_size);c.set(e.subarray(r-n.w_size,r),0),e=c,r=n.w_size}const i=t.avail_in,o=t.next_in,a=t.input;for(t.avail_in=r,t.next_in=0,t.input=e,cf(n);n.lookahead>=Nt;){let c=n.strstart,l=n.lookahead-(Nt-1);do n.ins_h=dc(n,n.ins_h,n.window[c+Nt-1]),n.prev[c&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=c,c++;while(--l);n.strstart=c,n.lookahead=Nt-1,cf(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=Nt-1,n.match_available=0,t.next_in=o,t.input=a,t.avail_in=i,n.wrap=s,Pn};var XZ=WZ,YZ=_8,QZ=b8,eX=w8,tX=HZ,rX=JZ,nX=GZ,iX=ZZ,sX="pako deflate (from Nodeca project)",ah={deflateInit:XZ,deflateInit2:YZ,deflateReset:QZ,deflateResetKeep:eX,deflateSetHeader:tX,deflate:rX,deflateEnd:nX,deflateSetDictionary:iX,deflateInfo:sX};const oX=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var aX=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)oX(r,n)&&(t[n]=r[n])}}return t},uX=t=>{let e=0;for(let n=0,s=t.length;n<s;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,s=0,i=t.length;n<i;n++){let o=t[n];r.set(o,s),s+=o.length}return r},Zg={assign:aX,flattenChunks:uX};let E8=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{E8=!1}const Nh=new Uint8Array(256);for(let t=0;t<256;t++)Nh[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Nh[254]=Nh[254]=1;var cX=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,s,i,o=t.length,a=0;for(s=0;s<o;s++)r=t.charCodeAt(s),(r&64512)===55296&&s+1<o&&(n=t.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),a+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(a),i=0,s=0;i<a;s++)r=t.charCodeAt(s),(r&64512)===55296&&s+1<o&&(n=t.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),r<128?e[i++]=r:r<2048?(e[i++]=192|r>>>6,e[i++]=128|r&63):r<65536?(e[i++]=224|r>>>12,e[i++]=128|r>>>6&63,e[i++]=128|r&63):(e[i++]=240|r>>>18,e[i++]=128|r>>>12&63,e[i++]=128|r>>>6&63,e[i++]=128|r&63);return e};const lX=(t,e)=>{if(e<65534&&t.subarray&&E8)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r};var dX=(t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,s;const i=new Array(r*2);for(s=0,n=0;n<r;){let o=t[n++];if(o<128){i[s++]=o;continue}let a=Nh[o];if(a>4){i[s++]=65533,n+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&n<r;)o=o<<6|t[n++]&63,a--;if(a>1){i[s++]=65533;continue}o<65536?i[s++]=o:(o-=65536,i[s++]=55296|o>>10&1023,i[s++]=56320|o&1023)}return lX(i,s)},fX=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+Nh[t[r]]>e?r:e},Rh={string2buf:cX,buf2string:dX,utf8border:fX};function pX(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var A8=pX;const S8=Object.prototype.toString,{Z_NO_FLUSH:hX,Z_SYNC_FLUSH:yX,Z_FULL_FLUSH:mX,Z_FINISH:gX,Z_OK:X0,Z_STREAM_END:vX,Z_DEFAULT_COMPRESSION:wX,Z_DEFAULT_STRATEGY:bX,Z_DEFLATED:_X}=Jg;function ME(t){this.options=Zg.assign({level:wX,method:_X,chunkSize:16384,windowBits:15,memLevel:8,strategy:bX},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new A8,this.strm.avail_out=0;let r=ah.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==X0)throw new Error(Fh[r]);if(e.header&&ah.deflateSetHeader(this.strm,e.header),e.dictionary){let n;if(typeof e.dictionary=="string"?n=Rh.string2buf(e.dictionary):S8.call(e.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(e.dictionary):n=e.dictionary,r=ah.deflateSetDictionary(this.strm,n),r!==X0)throw new Error(Fh[r]);this._dict_set=!0}}ME.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize;let s,i;if(this.ended)return!1;for(e===~~e?i=e:i=e===!0?gX:hX,typeof t=="string"?r.input=Rh.string2buf(t):S8.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(i===yX||i===mX)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(s=ah.deflate(r,i),s===vX)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),s=ah.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===X0;if(r.avail_out===0){this.onData(r.output);continue}if(i>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0};ME.prototype.onData=function(t){this.chunks.push(t)};ME.prototype.onEnd=function(t){t===X0&&(this.result=Zg.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};const _m=16209,EX=16191;var AX=function(e,r){let n,s,i,o,a,c,l,u,d,h,f,p,y,b,w,g,v,m,_,x,D,E,A,S;const O=e.state;n=e.next_in,A=e.input,s=n+(e.avail_in-5),i=e.next_out,S=e.output,o=i-(r-e.avail_out),a=i+(e.avail_out-257),c=O.dmax,l=O.wsize,u=O.whave,d=O.wnext,h=O.window,f=O.hold,p=O.bits,y=O.lencode,b=O.distcode,w=(1<<O.lenbits)-1,g=(1<<O.distbits)-1;e:do{p<15&&(f+=A[n++]<<p,p+=8,f+=A[n++]<<p,p+=8),v=y[f&w];t:for(;;){if(m=v>>>24,f>>>=m,p-=m,m=v>>>16&255,m===0)S[i++]=v&65535;else if(m&16){_=v&65535,m&=15,m&&(p<m&&(f+=A[n++]<<p,p+=8),_+=f&(1<<m)-1,f>>>=m,p-=m),p<15&&(f+=A[n++]<<p,p+=8,f+=A[n++]<<p,p+=8),v=b[f&g];r:for(;;){if(m=v>>>24,f>>>=m,p-=m,m=v>>>16&255,m&16){if(x=v&65535,m&=15,p<m&&(f+=A[n++]<<p,p+=8,p<m&&(f+=A[n++]<<p,p+=8)),x+=f&(1<<m)-1,x>c){e.msg="invalid distance too far back",O.mode=_m;break e}if(f>>>=m,p-=m,m=i-o,x>m){if(m=x-m,m>u&&O.sane){e.msg="invalid distance too far back",O.mode=_m;break e}if(D=0,E=h,d===0){if(D+=l-m,m<_){_-=m;do S[i++]=h[D++];while(--m);D=i-x,E=S}}else if(d<m){if(D+=l+d-m,m-=d,m<_){_-=m;do S[i++]=h[D++];while(--m);if(D=0,d<_){m=d,_-=m;do S[i++]=h[D++];while(--m);D=i-x,E=S}}}else if(D+=d-m,m<_){_-=m;do S[i++]=h[D++];while(--m);D=i-x,E=S}for(;_>2;)S[i++]=E[D++],S[i++]=E[D++],S[i++]=E[D++],_-=3;_&&(S[i++]=E[D++],_>1&&(S[i++]=E[D++]))}else{D=i-x;do S[i++]=S[D++],S[i++]=S[D++],S[i++]=S[D++],_-=3;while(_>2);_&&(S[i++]=S[D++],_>1&&(S[i++]=S[D++]))}}else if(m&64){e.msg="invalid distance code",O.mode=_m;break e}else{v=b[(v&65535)+(f&(1<<m)-1)];continue r}break}}else if(m&64)if(m&32){O.mode=EX;break e}else{e.msg="invalid literal/length code",O.mode=_m;break e}else{v=y[(v&65535)+(f&(1<<m)-1)];continue t}break}}while(n<s&&i<a);_=p>>3,n-=_,p-=_<<3,f&=(1<<p)-1,e.next_in=n,e.next_out=i,e.avail_in=n<s?5+(s-n):5-(n-s),e.avail_out=i<a?257+(a-i):257-(i-a),O.hold=f,O.bits=p};const Ed=15,Wx=852,Jx=592,Gx=0,Bw=1,Zx=2,SX=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),$X=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),xX=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),DX=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),PX=(t,e,r,n,s,i,o,a)=>{const c=a.bits;let l=0,u=0,d=0,h=0,f=0,p=0,y=0,b=0,w=0,g=0,v,m,_,x,D,E=null,A;const S=new Uint16Array(Ed+1),O=new Uint16Array(Ed+1);let I=null,N,j,F;for(l=0;l<=Ed;l++)S[l]=0;for(u=0;u<n;u++)S[e[r+u]]++;for(f=c,h=Ed;h>=1&&S[h]===0;h--);if(f>h&&(f=h),h===0)return s[i++]=1<<24|64<<16|0,s[i++]=1<<24|64<<16|0,a.bits=1,0;for(d=1;d<h&&S[d]===0;d++);for(f<d&&(f=d),b=1,l=1;l<=Ed;l++)if(b<<=1,b-=S[l],b<0)return-1;if(b>0&&(t===Gx||h!==1))return-1;for(O[1]=0,l=1;l<Ed;l++)O[l+1]=O[l]+S[l];for(u=0;u<n;u++)e[r+u]!==0&&(o[O[e[r+u]]++]=u);if(t===Gx?(E=I=o,A=20):t===Bw?(E=SX,I=$X,A=257):(E=xX,I=DX,A=0),g=0,u=0,l=d,D=i,p=f,y=0,_=-1,w=1<<f,x=w-1,t===Bw&&w>Wx||t===Zx&&w>Jx)return 1;for(;;){N=l-y,o[u]+1<A?(j=0,F=o[u]):o[u]>=A?(j=I[o[u]-A],F=E[o[u]-A]):(j=96,F=0),v=1<<l-y,m=1<<p,d=m;do m-=v,s[D+(g>>y)+m]=N<<24|j<<16|F|0;while(m!==0);for(v=1<<l-1;g&v;)v>>=1;if(v!==0?(g&=v-1,g+=v):g=0,u++,--S[l]===0){if(l===h)break;l=e[r+o[u]]}if(l>f&&(g&x)!==_){for(y===0&&(y=f),D+=d,p=l-y,b=1<<p;p+y<h&&(b-=S[p+y],!(b<=0));)p++,b<<=1;if(w+=1<<p,t===Bw&&w>Wx||t===Zx&&w>Jx)return 1;_=g&x,s[_]=f<<24|p<<16|D-i|0}}return g!==0&&(s[D+g]=l-y<<24|64<<16|0),a.bits=f,0};var uh=PX;const CX=0,$8=1,x8=2,{Z_FINISH:Xx,Z_BLOCK:kX,Z_TREES:Em,Z_OK:Zl,Z_STREAM_END:OX,Z_NEED_DICT:TX,Z_STREAM_ERROR:_s,Z_DATA_ERROR:D8,Z_MEM_ERROR:P8,Z_BUF_ERROR:IX,Z_DEFLATED:Yx}=Jg,Xg=16180,Qx=16181,eD=16182,tD=16183,rD=16184,nD=16185,iD=16186,sD=16187,oD=16188,aD=16189,Y0=16190,wa=16191,Fw=16192,uD=16193,Nw=16194,cD=16195,lD=16196,dD=16197,fD=16198,Am=16199,Sm=16200,pD=16201,hD=16202,yD=16203,mD=16204,gD=16205,Rw=16206,vD=16207,wD=16208,_r=16209,C8=16210,k8=16211,BX=852,FX=592,NX=15,RX=NX,bD=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function jX(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const id=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<Xg||e.mode>k8?1:0},O8=t=>{if(id(t))return _s;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=Xg,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(BX),e.distcode=e.distdyn=new Int32Array(FX),e.sane=1,e.back=-1,Zl},T8=t=>{if(id(t))return _s;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,O8(t)},I8=(t,e)=>{let r;if(id(t))return _s;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?_s:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,T8(t))},B8=(t,e)=>{if(!t)return _s;const r=new jX;t.state=r,r.strm=t,r.window=null,r.mode=Xg;const n=I8(t,e);return n!==Zl&&(t.state=null),n},MX=t=>B8(t,RX);let _D=!0,jw,Mw;const UX=t=>{if(_D){jw=new Int32Array(512),Mw=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(uh($8,t.lens,0,288,jw,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;uh(x8,t.lens,0,32,Mw,0,t.work,{bits:5}),_D=!1}t.lencode=jw,t.lenbits=9,t.distcode=Mw,t.distbits=5},F8=(t,e,r,n)=>{let s;const i=t.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(e.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):(s=i.wsize-i.wnext,s>n&&(s=n),i.window.set(e.subarray(r-n,r-n+s),i.wnext),n-=s,n?(i.window.set(e.subarray(r-n,r),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=s,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=s))),0},KX=(t,e)=>{let r,n,s,i,o,a,c,l,u,d,h,f,p,y,b=0,w,g,v,m,_,x,D,E;const A=new Uint8Array(4);let S,O;const I=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(id(t)||!t.output||!t.input&&t.avail_in!==0)return _s;r=t.state,r.mode===wa&&(r.mode=Fw),o=t.next_out,s=t.output,c=t.avail_out,i=t.next_in,n=t.input,a=t.avail_in,l=r.hold,u=r.bits,d=a,h=c,E=Zl;e:for(;;)switch(r.mode){case Xg:if(r.wrap===0){r.mode=Fw;break}for(;u<16;){if(a===0)break e;a--,l+=n[i++]<<u,u+=8}if(r.wrap&2&&l===35615){r.wbits===0&&(r.wbits=15),r.check=0,A[0]=l&255,A[1]=l>>>8&255,r.check=on(r.check,A,2,0),l=0,u=0,r.mode=Qx;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((l&255)<<8)+(l>>8))%31){t.msg="incorrect header check",r.mode=_r;break}if((l&15)!==Yx){t.msg="unknown compression method",r.mode=_r;break}if(l>>>=4,u-=4,D=(l&15)+8,r.wbits===0&&(r.wbits=D),D>15||D>r.wbits){t.msg="invalid window size",r.mode=_r;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=l&512?aD:wa,l=0,u=0;break;case Qx:for(;u<16;){if(a===0)break e;a--,l+=n[i++]<<u,u+=8}if(r.flags=l,(r.flags&255)!==Yx){t.msg="unknown compression method",r.mode=_r;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=_r;break}r.head&&(r.head.text=l>>8&1),r.flags&512&&r.wrap&4&&(A[0]=l&255,A[1]=l>>>8&255,r.check=on(r.check,A,2,0)),l=0,u=0,r.mode=eD;case eD:for(;u<32;){if(a===0)break e;a--,l+=n[i++]<<u,u+=8}r.head&&(r.head.time=l),r.flags&512&&r.wrap&4&&(A[0]=l&255,A[1]=l>>>8&255,A[2]=l>>>16&255,A[3]=l>>>24&255,r.check=on(r.check,A,4,0)),l=0,u=0,r.mode=tD;case tD:for(;u<16;){if(a===0)break e;a--,l+=n[i++]<<u,u+=8}r.head&&(r.head.xflags=l&255,r.head.os=l>>8),r.flags&512&&r.wrap&4&&(A[0]=l&255,A[1]=l>>>8&255,r.check=on(r.check,A,2,0)),l=0,u=0,r.mode=rD;case rD:if(r.flags&1024){for(;u<16;){if(a===0)break e;a--,l+=n[i++]<<u,u+=8}r.length=l,r.head&&(r.head.extra_len=l),r.flags&512&&r.wrap&4&&(A[0]=l&255,A[1]=l>>>8&255,r.check=on(r.check,A,2,0)),l=0,u=0}else r.head&&(r.head.extra=null);r.mode=nD;case nD:if(r.flags&1024&&(f=r.length,f>a&&(f=a),f&&(r.head&&(D=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(i,i+f),D)),r.flags&512&&r.wrap&4&&(r.check=on(r.check,n,f,i)),a-=f,i+=f,r.length-=f),r.length))break e;r.length=0,r.mode=iD;case iD:if(r.flags&2048){if(a===0)break e;f=0;do D=n[i+f++],r.head&&D&&r.length<65536&&(r.head.name+=String.fromCharCode(D));while(D&&f<a);if(r.flags&512&&r.wrap&4&&(r.check=on(r.check,n,f,i)),a-=f,i+=f,D)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=sD;case sD:if(r.flags&4096){if(a===0)break e;f=0;do D=n[i+f++],r.head&&D&&r.length<65536&&(r.head.comment+=String.fromCharCode(D));while(D&&f<a);if(r.flags&512&&r.wrap&4&&(r.check=on(r.check,n,f,i)),a-=f,i+=f,D)break e}else r.head&&(r.head.comment=null);r.mode=oD;case oD:if(r.flags&512){for(;u<16;){if(a===0)break e;a--,l+=n[i++]<<u,u+=8}if(r.wrap&4&&l!==(r.check&65535)){t.msg="header crc mismatch",r.mode=_r;break}l=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=wa;break;case aD:for(;u<32;){if(a===0)break e;a--,l+=n[i++]<<u,u+=8}t.adler=r.check=bD(l),l=0,u=0,r.mode=Y0;case Y0:if(r.havedict===0)return t.next_out=o,t.avail_out=c,t.next_in=i,t.avail_in=a,r.hold=l,r.bits=u,TX;t.adler=r.check=1,r.mode=wa;case wa:if(e===kX||e===Em)break e;case Fw:if(r.last){l>>>=u&7,u-=u&7,r.mode=Rw;break}for(;u<3;){if(a===0)break e;a--,l+=n[i++]<<u,u+=8}switch(r.last=l&1,l>>>=1,u-=1,l&3){case 0:r.mode=uD;break;case 1:if(UX(r),r.mode=Am,e===Em){l>>>=2,u-=2;break e}break;case 2:r.mode=lD;break;case 3:t.msg="invalid block type",r.mode=_r}l>>>=2,u-=2;break;case uD:for(l>>>=u&7,u-=u&7;u<32;){if(a===0)break e;a--,l+=n[i++]<<u,u+=8}if((l&65535)!==(l>>>16^65535)){t.msg="invalid stored block lengths",r.mode=_r;break}if(r.length=l&65535,l=0,u=0,r.mode=Nw,e===Em)break e;case Nw:r.mode=cD;case cD:if(f=r.length,f){if(f>a&&(f=a),f>c&&(f=c),f===0)break e;s.set(n.subarray(i,i+f),o),a-=f,i+=f,c-=f,o+=f,r.length-=f;break}r.mode=wa;break;case lD:for(;u<14;){if(a===0)break e;a--,l+=n[i++]<<u,u+=8}if(r.nlen=(l&31)+257,l>>>=5,u-=5,r.ndist=(l&31)+1,l>>>=5,u-=5,r.ncode=(l&15)+4,l>>>=4,u-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=_r;break}r.have=0,r.mode=dD;case dD:for(;r.have<r.ncode;){for(;u<3;){if(a===0)break e;a--,l+=n[i++]<<u,u+=8}r.lens[I[r.have++]]=l&7,l>>>=3,u-=3}for(;r.have<19;)r.lens[I[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,S={bits:r.lenbits},E=uh(CX,r.lens,0,19,r.lencode,0,r.work,S),r.lenbits=S.bits,E){t.msg="invalid code lengths set",r.mode=_r;break}r.have=0,r.mode=fD;case fD:for(;r.have<r.nlen+r.ndist;){for(;b=r.lencode[l&(1<<r.lenbits)-1],w=b>>>24,g=b>>>16&255,v=b&65535,!(w<=u);){if(a===0)break e;a--,l+=n[i++]<<u,u+=8}if(v<16)l>>>=w,u-=w,r.lens[r.have++]=v;else{if(v===16){for(O=w+2;u<O;){if(a===0)break e;a--,l+=n[i++]<<u,u+=8}if(l>>>=w,u-=w,r.have===0){t.msg="invalid bit length repeat",r.mode=_r;break}D=r.lens[r.have-1],f=3+(l&3),l>>>=2,u-=2}else if(v===17){for(O=w+3;u<O;){if(a===0)break e;a--,l+=n[i++]<<u,u+=8}l>>>=w,u-=w,D=0,f=3+(l&7),l>>>=3,u-=3}else{for(O=w+7;u<O;){if(a===0)break e;a--,l+=n[i++]<<u,u+=8}l>>>=w,u-=w,D=0,f=11+(l&127),l>>>=7,u-=7}if(r.have+f>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=_r;break}for(;f--;)r.lens[r.have++]=D}}if(r.mode===_r)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=_r;break}if(r.lenbits=9,S={bits:r.lenbits},E=uh($8,r.lens,0,r.nlen,r.lencode,0,r.work,S),r.lenbits=S.bits,E){t.msg="invalid literal/lengths set",r.mode=_r;break}if(r.distbits=6,r.distcode=r.distdyn,S={bits:r.distbits},E=uh(x8,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,S),r.distbits=S.bits,E){t.msg="invalid distances set",r.mode=_r;break}if(r.mode=Am,e===Em)break e;case Am:r.mode=Sm;case Sm:if(a>=6&&c>=258){t.next_out=o,t.avail_out=c,t.next_in=i,t.avail_in=a,r.hold=l,r.bits=u,AX(t,h),o=t.next_out,s=t.output,c=t.avail_out,i=t.next_in,n=t.input,a=t.avail_in,l=r.hold,u=r.bits,r.mode===wa&&(r.back=-1);break}for(r.back=0;b=r.lencode[l&(1<<r.lenbits)-1],w=b>>>24,g=b>>>16&255,v=b&65535,!(w<=u);){if(a===0)break e;a--,l+=n[i++]<<u,u+=8}if(g&&!(g&240)){for(m=w,_=g,x=v;b=r.lencode[x+((l&(1<<m+_)-1)>>m)],w=b>>>24,g=b>>>16&255,v=b&65535,!(m+w<=u);){if(a===0)break e;a--,l+=n[i++]<<u,u+=8}l>>>=m,u-=m,r.back+=m}if(l>>>=w,u-=w,r.back+=w,r.length=v,g===0){r.mode=gD;break}if(g&32){r.back=-1,r.mode=wa;break}if(g&64){t.msg="invalid literal/length code",r.mode=_r;break}r.extra=g&15,r.mode=pD;case pD:if(r.extra){for(O=r.extra;u<O;){if(a===0)break e;a--,l+=n[i++]<<u,u+=8}r.length+=l&(1<<r.extra)-1,l>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=hD;case hD:for(;b=r.distcode[l&(1<<r.distbits)-1],w=b>>>24,g=b>>>16&255,v=b&65535,!(w<=u);){if(a===0)break e;a--,l+=n[i++]<<u,u+=8}if(!(g&240)){for(m=w,_=g,x=v;b=r.distcode[x+((l&(1<<m+_)-1)>>m)],w=b>>>24,g=b>>>16&255,v=b&65535,!(m+w<=u);){if(a===0)break e;a--,l+=n[i++]<<u,u+=8}l>>>=m,u-=m,r.back+=m}if(l>>>=w,u-=w,r.back+=w,g&64){t.msg="invalid distance code",r.mode=_r;break}r.offset=v,r.extra=g&15,r.mode=yD;case yD:if(r.extra){for(O=r.extra;u<O;){if(a===0)break e;a--,l+=n[i++]<<u,u+=8}r.offset+=l&(1<<r.extra)-1,l>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=_r;break}r.mode=mD;case mD:if(c===0)break e;if(f=h-c,r.offset>f){if(f=r.offset-f,f>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=_r;break}f>r.wnext?(f-=r.wnext,p=r.wsize-f):p=r.wnext-f,f>r.length&&(f=r.length),y=r.window}else y=s,p=o-r.offset,f=r.length;f>c&&(f=c),c-=f,r.length-=f;do s[o++]=y[p++];while(--f);r.length===0&&(r.mode=Sm);break;case gD:if(c===0)break e;s[o++]=r.length,c--,r.mode=Sm;break;case Rw:if(r.wrap){for(;u<32;){if(a===0)break e;a--,l|=n[i++]<<u,u+=8}if(h-=c,t.total_out+=h,r.total+=h,r.wrap&4&&h&&(t.adler=r.check=r.flags?on(r.check,s,h,o-h):Bh(r.check,s,h,o-h)),h=c,r.wrap&4&&(r.flags?l:bD(l))!==r.check){t.msg="incorrect data check",r.mode=_r;break}l=0,u=0}r.mode=vD;case vD:if(r.wrap&&r.flags){for(;u<32;){if(a===0)break e;a--,l+=n[i++]<<u,u+=8}if(r.wrap&4&&l!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=_r;break}l=0,u=0}r.mode=wD;case wD:E=OX;break e;case _r:E=D8;break e;case C8:return P8;case k8:default:return _s}return t.next_out=o,t.avail_out=c,t.next_in=i,t.avail_in=a,r.hold=l,r.bits=u,(r.wsize||h!==t.avail_out&&r.mode<_r&&(r.mode<Rw||e!==Xx))&&F8(t,t.output,t.next_out,h-t.avail_out),d-=t.avail_in,h-=t.avail_out,t.total_in+=d,t.total_out+=h,r.total+=h,r.wrap&4&&h&&(t.adler=r.check=r.flags?on(r.check,s,h,t.next_out-h):Bh(r.check,s,h,t.next_out-h)),t.data_type=r.bits+(r.last?64:0)+(r.mode===wa?128:0)+(r.mode===Am||r.mode===Nw?256:0),(d===0&&h===0||e===Xx)&&E===Zl&&(E=IX),E},LX=t=>{if(id(t))return _s;let e=t.state;return e.window&&(e.window=null),t.state=null,Zl},qX=(t,e)=>{if(id(t))return _s;const r=t.state;return r.wrap&2?(r.head=e,e.done=!1,Zl):_s},VX=(t,e)=>{const r=e.length;let n,s,i;return id(t)||(n=t.state,n.wrap!==0&&n.mode!==Y0)?_s:n.mode===Y0&&(s=1,s=Bh(s,e,r,0),s!==n.check)?D8:(i=F8(t,e,r,r),i?(n.mode=C8,P8):(n.havedict=1,Zl))};var zX=T8,HX=I8,WX=O8,JX=MX,GX=B8,ZX=KX,XX=LX,YX=qX,QX=VX,eY="pako inflate (from Nodeca project)",Ba={inflateReset:zX,inflateReset2:HX,inflateResetKeep:WX,inflateInit:JX,inflateInit2:GX,inflate:ZX,inflateEnd:XX,inflateGetHeader:YX,inflateSetDictionary:QX,inflateInfo:eY};function tY(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var rY=tY;const N8=Object.prototype.toString,{Z_NO_FLUSH:nY,Z_FINISH:iY,Z_OK:jh,Z_STREAM_END:Uw,Z_NEED_DICT:Kw,Z_STREAM_ERROR:sY,Z_DATA_ERROR:ED,Z_MEM_ERROR:oY}=Jg;function UE(t){this.options=Zg.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new A8,this.strm.avail_out=0;let r=Ba.inflateInit2(this.strm,e.windowBits);if(r!==jh)throw new Error(Fh[r]);if(this.header=new rY,Ba.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Rh.string2buf(e.dictionary):N8.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Ba.inflateSetDictionary(this.strm,e.dictionary),r!==jh)))throw new Error(Fh[r])}UE.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let i,o,a;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?iY:nY,N8.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),i=Ba.inflate(r,o),i===Kw&&s&&(i=Ba.inflateSetDictionary(r,s),i===jh?i=Ba.inflate(r,o):i===ED&&(i=Kw));r.avail_in>0&&i===Uw&&r.state.wrap>0&&t[r.next_in]!==0;)Ba.inflateReset(r),i=Ba.inflate(r,o);switch(i){case sY:case ED:case Kw:case oY:return this.onEnd(i),this.ended=!0,!1}if(a=r.avail_out,r.next_out&&(r.avail_out===0||i===Uw))if(this.options.to==="string"){let c=Rh.utf8border(r.output,r.next_out),l=r.next_out-c,u=Rh.buf2string(r.output,c);r.next_out=l,r.avail_out=n-l,l&&r.output.set(r.output.subarray(c,c+l),0),this.onData(u)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(i===jh&&a===0)){if(i===Uw)return i=Ba.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};UE.prototype.onData=function(t){this.chunks.push(t)};UE.prototype.onEnd=function(t){t===jh&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Zg.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function aY(){return new Date().toISOString().replace(/\.\d+Z$/,"Z")}function AD(t){return new Date(t*1e3).toISOString().replace(/\.\d{3}/,"")}function uY(t){if(!/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$/.test(t))return!1;const r=new Date(t);return!isNaN(r.getTime())}function cY(t){if(!/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d+)?(Z|[+-]\d{2}:\d{2})$/.test(t))return!1;const r=new Date(t);return!isNaN(r.getTime())}const SD="VerifiablePresentation";class wp{static validateCredentialPayload(e){this.validateContext(e.vcDataModel["@context"]),this.validateVcType(e.type),this.validateCredentialSubject(e.vcDataModel.credentialSubject),e.vcDataModel.issuanceDate&&this.validateTimestamp(e.vcDataModel.issuanceDate),e.vcDataModel.expirationDate&&this.validateTimestamp(e.vcDataModel.expirationDate)}static validateContext(e){const r=this.asArray(e);if(r.length<1||r.indexOf(m1)===-1)throw new Error(`@context is missing default context "${m1}"`)}static validateVcType(e){const r=this.asArray(e);if(r.length<1||r.indexOf(ch)===-1)throw new Error(`type is missing default "${ch}"`)}static validateVpType(e){const r=this.asArray(e);if(r.length<1||r.indexOf(SD)===-1)throw new Error(`type is missing default "${SD}"`)}static validateCredentialSubject(e){if(Object.keys(e).length===0)throw new Error("credentialSubject must not be empty")}static validateTimestamp(e){if(!uY(e)&&!cY(e))throw new Error("timestamp is not valid xml schema 112 timestamp")}static asArray(e){return Array.isArray(e)?e:[e]}}var Lw=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};const m1="https://www.w3.org/2018/credentials/v1",ch="VerifiableCredential";class Q0{constructor(e){this.vcDataModel=e}get type(){return this.vcDataModel.type[this.vcDataModel.type.length-1]}get issuer(){return this.vcDataModel.issuer.toString()}get subject(){return Array.isArray(this.vcDataModel.credentialSubject)?this.vcDataModel.credentialSubject[0].id:this.vcDataModel.credentialSubject.id}sign(e){return Lw(this,void 0,void 0,function*(){return yield jo.sign({signerDid:e.did,payload:Object.assign({vc:this.vcDataModel,nbf:Math.floor(new Date(this.vcDataModel.issuanceDate).getTime()/1e3),jti:this.vcDataModel.id,iss:e.did.uri,sub:this.subject,iat:Math.floor(Date.now()/1e3)},this.vcDataModel.expirationDate&&{exp:Math.floor(new Date(this.vcDataModel.expirationDate).getTime()/1e3)})})})}toString(){return JSON.stringify(this.vcDataModel)}static create(e){return Lw(this,void 0,void 0,function*(){const{type:r,issuer:n,subject:s,data:i,issuanceDate:o,expirationDate:a,credentialStatus:c,credentialSchema:l,evidence:u}=e,d=JSON.parse(JSON.stringify(i));if(typeof d!="object")throw new Error("Expected data to be parseable into a JSON object");if(!n||!s)throw new Error("Issuer and subject must be defined");if(typeof n!="string"||typeof s!="string")throw new Error("Issuer and subject must be of type string");const h=Object.assign({id:s},d),f=[m1];c!==null&&f.push(lY);const p=Object.assign(Object.assign(Object.assign(Object.assign({"@context":f,type:Array.isArray(r)?[ch,...r]:r?[ch,r]:[ch],id:`urn:uuid:${h7()}`,issuer:n,issuanceDate:o||aY(),credentialSubject:h},a&&{expirationDate:a}),c&&{credentialStatus:c}),l&&{credentialSchema:l}),u&&{evidence:u});return qw(p),new Q0(p)})}static verify(e){return Lw(this,arguments,void 0,function*({vcJwt:r}){const{payload:n}=yield jo.verify({jwt:r}),{exp:s,iss:i,nbf:o,jti:a,sub:c,vc:l}=n;if(!l)throw new Error("vc property missing.");const u=n.vc;if(s&&u.expirationDate&&s!==Math.floor(new Date(u.expirationDate).getTime()/1e3))throw new Error("Verification failed: exp claim does not match expirationDate");if(s&&(u.expirationDate=AD(s)),!i)throw new Error("Verification failed: iss claim is required");if(i!==u.issuer)throw new Error("Verification failed: iss claim does not match expected issuer");if(o&&o>Math.floor(Date.now()/1e3))throw new Error("Verification failed: nbf claim is in the future");if(o&&u.issuanceDate&&o!==Math.floor(new Date(u.issuanceDate).getTime()/1e3))throw new Error("Verification failed: nbf claim does not match issuanceDate");if(o&&(u.issuanceDate=AD(o)),c&&!Array.isArray(u.credentialSubject)&&c!==u.credentialSubject.id)throw new Error("Verification failed: sub claim does not match credentialSubject.id");if(c&&!Array.isArray(u.credentialSubject)&&(u.credentialSubject.id=c),a&&a!==u.id)throw new Error("Verification failed: jti claim does not match id");return a&&(u.id=a),qw(u),{issuer:n.iss,subject:n.sub,vc:u}})}static parseJwt({vcJwt:e}){const n=jo.parse({jwt:e}).decoded.payload.vc;if(!n)throw Error("Jwt payload missing vc property");return qw(n),new Q0(n)}}function qw(t){wp.validateContext(t["@context"]),wp.validateVcType(t.type),wp.validateCredentialSubject(t.credentialSubject),t.issuanceDate&&wp.validateTimestamp(t.issuanceDate),t.expirationDate&&wp.validateTimestamp(t.expirationDate)}const lY="https://w3id.org/vc/status-list/2021/v1";var $D;(function(t){t.revocation="revocation",t.suspension="suspension"})($D||($D={}));var g1={exports:{}},R8={},Hs={},lf={},fy={},Tt={},Mh={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.regexpCode=t.getEsmExportName=t.getProperty=t.safeStringify=t.stringify=t.strConcat=t.addCodeArg=t.str=t._=t.nil=t._Code=t.Name=t.IDENTIFIER=t._CodeOrName=void 0;class e{}t._CodeOrName=e,t.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class r extends e{constructor(g){if(super(),!t.IDENTIFIER.test(g))throw new Error("CodeGen: name must be a valid identifier");this.str=g}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}t.Name=r;class n extends e{constructor(g){super(),this._items=typeof g=="string"?[g]:g}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const g=this._items[0];return g===""||g==='""'}get str(){var g;return(g=this._str)!==null&&g!==void 0?g:this._str=this._items.reduce((v,m)=>`${v}${m}`,"")}get names(){var g;return(g=this._names)!==null&&g!==void 0?g:this._names=this._items.reduce((v,m)=>(m instanceof r&&(v[m.str]=(v[m.str]||0)+1),v),{})}}t._Code=n,t.nil=new n("");function s(w,...g){const v=[w[0]];let m=0;for(;m<g.length;)a(v,g[m]),v.push(w[++m]);return new n(v)}t._=s;const i=new n("+");function o(w,...g){const v=[f(w[0])];let m=0;for(;m<g.length;)v.push(i),a(v,g[m]),v.push(i,f(w[++m]));return c(v),new n(v)}t.str=o;function a(w,g){g instanceof n?w.push(...g._items):g instanceof r?w.push(g):w.push(d(g))}t.addCodeArg=a;function c(w){let g=1;for(;g<w.length-1;){if(w[g]===i){const v=l(w[g-1],w[g+1]);if(v!==void 0){w.splice(g-1,3,v);continue}w[g++]="+"}g++}}function l(w,g){if(g==='""')return w;if(w==='""')return g;if(typeof w=="string")return g instanceof r||w[w.length-1]!=='"'?void 0:typeof g!="string"?`${w.slice(0,-1)}${g}"`:g[0]==='"'?w.slice(0,-1)+g.slice(1):void 0;if(typeof g=="string"&&g[0]==='"'&&!(w instanceof r))return`"${w}${g.slice(1)}`}function u(w,g){return g.emptyStr()?w:w.emptyStr()?g:o`${w}${g}`}t.strConcat=u;function d(w){return typeof w=="number"||typeof w=="boolean"||w===null?w:f(Array.isArray(w)?w.join(","):w)}function h(w){return new n(f(w))}t.stringify=h;function f(w){return JSON.stringify(w).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}t.safeStringify=f;function p(w){return typeof w=="string"&&t.IDENTIFIER.test(w)?new n(`.${w}`):s`[${w}]`}t.getProperty=p;function y(w){if(typeof w=="string"&&t.IDENTIFIER.test(w))return new n(`${w}`);throw new Error(`CodeGen: invalid export name: ${w}, use explicit $id name mapping`)}t.getEsmExportName=y;function b(w){return new n(w.toString())}t.regexpCode=b})(Mh);var v1={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ValueScope=t.ValueScopeName=t.Scope=t.varKinds=t.UsedValueState=void 0;const e=Mh;class r extends Error{constructor(l){super(`CodeGen: "code" for ${l} not defined`),this.value=l.value}}var n;(function(c){c[c.Started=0]="Started",c[c.Completed=1]="Completed"})(n=t.UsedValueState||(t.UsedValueState={})),t.varKinds={const:new e.Name("const"),let:new e.Name("let"),var:new e.Name("var")};class s{constructor({prefixes:l,parent:u}={}){this._names={},this._prefixes=l,this._parent=u}toName(l){return l instanceof e.Name?l:this.name(l)}name(l){return new e.Name(this._newName(l))}_newName(l){const u=this._names[l]||this._nameGroup(l);return`${l}${u.index++}`}_nameGroup(l){var u,d;if(!((d=(u=this._parent)===null||u===void 0?void 0:u._prefixes)===null||d===void 0)&&d.has(l)||this._prefixes&&!this._prefixes.has(l))throw new Error(`CodeGen: prefix "${l}" is not allowed in this scope`);return this._names[l]={prefix:l,index:0}}}t.Scope=s;class i extends e.Name{constructor(l,u){super(u),this.prefix=l}setValue(l,{property:u,itemIndex:d}){this.value=l,this.scopePath=(0,e._)`.${new e.Name(u)}[${d}]`}}t.ValueScopeName=i;const o=(0,e._)`\n`;class a extends s{constructor(l){super(l),this._values={},this._scope=l.scope,this.opts={...l,_n:l.lines?o:e.nil}}get(){return this._scope}name(l){return new i(l,this._newName(l))}value(l,u){var d;if(u.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const h=this.toName(l),{prefix:f}=h,p=(d=u.key)!==null&&d!==void 0?d:u.ref;let y=this._values[f];if(y){const g=y.get(p);if(g)return g}else y=this._values[f]=new Map;y.set(p,h);const b=this._scope[f]||(this._scope[f]=[]),w=b.length;return b[w]=u.ref,h.setValue(u,{property:f,itemIndex:w}),h}getValue(l,u){const d=this._values[l];if(d)return d.get(u)}scopeRefs(l,u=this._values){return this._reduceValues(u,d=>{if(d.scopePath===void 0)throw new Error(`CodeGen: name "${d}" has no value`);return(0,e._)`${l}${d.scopePath}`})}scopeCode(l=this._values,u,d){return this._reduceValues(l,h=>{if(h.value===void 0)throw new Error(`CodeGen: name "${h}" has no value`);return h.value.code},u,d)}_reduceValues(l,u,d={},h){let f=e.nil;for(const p in l){const y=l[p];if(!y)continue;const b=d[p]=d[p]||new Map;y.forEach(w=>{if(b.has(w))return;b.set(w,n.Started);let g=u(w);if(g){const v=this.opts.es5?t.varKinds.var:t.varKinds.const;f=(0,e._)`${f}${v} ${w} = ${g};${this.opts._n}`}else if(g=h==null?void 0:h(w))f=(0,e._)`${f}${g}${this.opts._n}`;else throw new r(w);b.set(w,n.Completed)})}return f}}t.ValueScope=a})(v1);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.or=t.and=t.not=t.CodeGen=t.operators=t.varKinds=t.ValueScopeName=t.ValueScope=t.Scope=t.Name=t.regexpCode=t.stringify=t.getProperty=t.nil=t.strConcat=t.str=t._=void 0;const e=Mh,r=v1;var n=Mh;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(t,"strConcat",{enumerable:!0,get:function(){return n.strConcat}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(t,"getProperty",{enumerable:!0,get:function(){return n.getProperty}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(t,"regexpCode",{enumerable:!0,get:function(){return n.regexpCode}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return n.Name}});var s=v1;Object.defineProperty(t,"Scope",{enumerable:!0,get:function(){return s.Scope}}),Object.defineProperty(t,"ValueScope",{enumerable:!0,get:function(){return s.ValueScope}}),Object.defineProperty(t,"ValueScopeName",{enumerable:!0,get:function(){return s.ValueScopeName}}),Object.defineProperty(t,"varKinds",{enumerable:!0,get:function(){return s.varKinds}}),t.operators={GT:new e._Code(">"),GTE:new e._Code(">="),LT:new e._Code("<"),LTE:new e._Code("<="),EQ:new e._Code("==="),NEQ:new e._Code("!=="),NOT:new e._Code("!"),OR:new e._Code("||"),AND:new e._Code("&&"),ADD:new e._Code("+")};class i{optimizeNodes(){return this}optimizeNames($,T){return this}}class o extends i{constructor($,T,z){super(),this.varKind=$,this.name=T,this.rhs=z}render({es5:$,_n:T}){const z=$?r.varKinds.var:this.varKind,ne=this.rhs===void 0?"":` = ${this.rhs}`;return`${z} ${this.name}${ne};`+T}optimizeNames($,T){if($[this.name.str])return this.rhs&&(this.rhs=j(this.rhs,$,T)),this}get names(){return this.rhs instanceof e._CodeOrName?this.rhs.names:{}}}class a extends i{constructor($,T,z){super(),this.lhs=$,this.rhs=T,this.sideEffects=z}render({_n:$}){return`${this.lhs} = ${this.rhs};`+$}optimizeNames($,T){if(!(this.lhs instanceof e.Name&&!$[this.lhs.str]&&!this.sideEffects))return this.rhs=j(this.rhs,$,T),this}get names(){const $=this.lhs instanceof e.Name?{}:{...this.lhs.names};return N($,this.rhs)}}class c extends a{constructor($,T,z,ne){super($,z,ne),this.op=T}render({_n:$}){return`${this.lhs} ${this.op}= ${this.rhs};`+$}}class l extends i{constructor($){super(),this.label=$,this.names={}}render({_n:$}){return`${this.label}:`+$}}class u extends i{constructor($){super(),this.label=$,this.names={}}render({_n:$}){return`break${this.label?` ${this.label}`:""};`+$}}class d extends i{constructor($){super(),this.error=$}render({_n:$}){return`throw ${this.error};`+$}get names(){return this.error.names}}class h extends i{constructor($){super(),this.code=$}render({_n:$}){return`${this.code};`+$}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames($,T){return this.code=j(this.code,$,T),this}get names(){return this.code instanceof e._CodeOrName?this.code.names:{}}}class f extends i{constructor($=[]){super(),this.nodes=$}render($){return this.nodes.reduce((T,z)=>T+z.render($),"")}optimizeNodes(){const{nodes:$}=this;let T=$.length;for(;T--;){const z=$[T].optimizeNodes();Array.isArray(z)?$.splice(T,1,...z):z?$[T]=z:$.splice(T,1)}return $.length>0?this:void 0}optimizeNames($,T){const{nodes:z}=this;let ne=z.length;for(;ne--;){const ue=z[ne];ue.optimizeNames($,T)||(F($,ue.names),z.splice(ne,1))}return z.length>0?this:void 0}get names(){return this.nodes.reduce(($,T)=>I($,T.names),{})}}class p extends f{render($){return"{"+$._n+super.render($)+"}"+$._n}}class y extends f{}class b extends p{}b.kind="else";class w extends p{constructor($,T){super(T),this.condition=$}render($){let T=`if(${this.condition})`+super.render($);return this.else&&(T+="else "+this.else.render($)),T}optimizeNodes(){super.optimizeNodes();const $=this.condition;if($===!0)return this.nodes;let T=this.else;if(T){const z=T.optimizeNodes();T=this.else=Array.isArray(z)?new b(z):z}if(T)return $===!1?T instanceof w?T:T.nodes:this.nodes.length?this:new w(V($),T instanceof w?[T]:T.nodes);if(!($===!1||!this.nodes.length))return this}optimizeNames($,T){var z;if(this.else=(z=this.else)===null||z===void 0?void 0:z.optimizeNames($,T),!!(super.optimizeNames($,T)||this.else))return this.condition=j(this.condition,$,T),this}get names(){const $=super.names;return N($,this.condition),this.else&&I($,this.else.names),$}}w.kind="if";class g extends p{}g.kind="for";class v extends g{constructor($){super(),this.iteration=$}render($){return`for(${this.iteration})`+super.render($)}optimizeNames($,T){if(super.optimizeNames($,T))return this.iteration=j(this.iteration,$,T),this}get names(){return I(super.names,this.iteration.names)}}class m extends g{constructor($,T,z,ne){super(),this.varKind=$,this.name=T,this.from=z,this.to=ne}render($){const T=$.es5?r.varKinds.var:this.varKind,{name:z,from:ne,to:ue}=this;return`for(${T} ${z}=${ne}; ${z}<${ue}; ${z}++)`+super.render($)}get names(){const $=N(super.names,this.from);return N($,this.to)}}class _ extends g{constructor($,T,z,ne){super(),this.loop=$,this.varKind=T,this.name=z,this.iterable=ne}render($){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render($)}optimizeNames($,T){if(super.optimizeNames($,T))return this.iterable=j(this.iterable,$,T),this}get names(){return I(super.names,this.iterable.names)}}class x extends p{constructor($,T,z){super(),this.name=$,this.args=T,this.async=z}render($){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render($)}}x.kind="func";class D extends f{render($){return"return "+super.render($)}}D.kind="return";class E extends p{render($){let T="try"+super.render($);return this.catch&&(T+=this.catch.render($)),this.finally&&(T+=this.finally.render($)),T}optimizeNodes(){var $,T;return super.optimizeNodes(),($=this.catch)===null||$===void 0||$.optimizeNodes(),(T=this.finally)===null||T===void 0||T.optimizeNodes(),this}optimizeNames($,T){var z,ne;return super.optimizeNames($,T),(z=this.catch)===null||z===void 0||z.optimizeNames($,T),(ne=this.finally)===null||ne===void 0||ne.optimizeNames($,T),this}get names(){const $=super.names;return this.catch&&I($,this.catch.names),this.finally&&I($,this.finally.names),$}}class A extends p{constructor($){super(),this.error=$}render($){return`catch(${this.error})`+super.render($)}}A.kind="catch";class S extends p{render($){return"finally"+super.render($)}}S.kind="finally";class O{constructor($,T={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...T,_n:T.lines?`
`:""},this._extScope=$,this._scope=new r.Scope({parent:$}),this._nodes=[new y]}toString(){return this._root.render(this.opts)}name($){return this._scope.name($)}scopeName($){return this._extScope.name($)}scopeValue($,T){const z=this._extScope.value($,T);return(this._values[z.prefix]||(this._values[z.prefix]=new Set)).add(z),z}getScopeValue($,T){return this._extScope.getValue($,T)}scopeRefs($){return this._extScope.scopeRefs($,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def($,T,z,ne){const ue=this._scope.toName(T);return z!==void 0&&ne&&(this._constants[ue.str]=z),this._leafNode(new o($,ue,z)),ue}const($,T,z){return this._def(r.varKinds.const,$,T,z)}let($,T,z){return this._def(r.varKinds.let,$,T,z)}var($,T,z){return this._def(r.varKinds.var,$,T,z)}assign($,T,z){return this._leafNode(new a($,T,z))}add($,T){return this._leafNode(new c($,t.operators.ADD,T))}code($){return typeof $=="function"?$():$!==e.nil&&this._leafNode(new h($)),this}object(...$){const T=["{"];for(const[z,ne]of $)T.length>1&&T.push(","),T.push(z),(z!==ne||this.opts.es5)&&(T.push(":"),(0,e.addCodeArg)(T,ne));return T.push("}"),new e._Code(T)}if($,T,z){if(this._blockNode(new w($)),T&&z)this.code(T).else().code(z).endIf();else if(T)this.code(T).endIf();else if(z)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf($){return this._elseNode(new w($))}else(){return this._elseNode(new b)}endIf(){return this._endBlockNode(w,b)}_for($,T){return this._blockNode($),T&&this.code(T).endFor(),this}for($,T){return this._for(new v($),T)}forRange($,T,z,ne,ue=this.opts.es5?r.varKinds.var:r.varKinds.let){const ye=this._scope.toName($);return this._for(new m(ue,ye,T,z),()=>ne(ye))}forOf($,T,z,ne=r.varKinds.const){const ue=this._scope.toName($);if(this.opts.es5){const ye=T instanceof e.Name?T:this.var("_arr",T);return this.forRange("_i",0,(0,e._)`${ye}.length`,_e=>{this.var(ue,(0,e._)`${ye}[${_e}]`),z(ue)})}return this._for(new _("of",ne,ue,T),()=>z(ue))}forIn($,T,z,ne=this.opts.es5?r.varKinds.var:r.varKinds.const){if(this.opts.ownProperties)return this.forOf($,(0,e._)`Object.keys(${T})`,z);const ue=this._scope.toName($);return this._for(new _("in",ne,ue,T),()=>z(ue))}endFor(){return this._endBlockNode(g)}label($){return this._leafNode(new l($))}break($){return this._leafNode(new u($))}return($){const T=new D;if(this._blockNode(T),this.code($),T.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(D)}try($,T,z){if(!T&&!z)throw new Error('CodeGen: "try" without "catch" and "finally"');const ne=new E;if(this._blockNode(ne),this.code($),T){const ue=this.name("e");this._currNode=ne.catch=new A(ue),T(ue)}return z&&(this._currNode=ne.finally=new S,this.code(z)),this._endBlockNode(A,S)}throw($){return this._leafNode(new d($))}block($,T){return this._blockStarts.push(this._nodes.length),$&&this.code($).endBlock(T),this}endBlock($){const T=this._blockStarts.pop();if(T===void 0)throw new Error("CodeGen: not in self-balancing block");const z=this._nodes.length-T;if(z<0||$!==void 0&&z!==$)throw new Error(`CodeGen: wrong number of nodes: ${z} vs ${$} expected`);return this._nodes.length=T,this}func($,T=e.nil,z,ne){return this._blockNode(new x($,T,z)),ne&&this.code(ne).endFunc(),this}endFunc(){return this._endBlockNode(x)}optimize($=1){for(;$-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode($){return this._currNode.nodes.push($),this}_blockNode($){this._currNode.nodes.push($),this._nodes.push($)}_endBlockNode($,T){const z=this._currNode;if(z instanceof $||T&&z instanceof T)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${T?`${$.kind}/${T.kind}`:$.kind}"`)}_elseNode($){const T=this._currNode;if(!(T instanceof w))throw new Error('CodeGen: "else" without "if"');return this._currNode=T.else=$,this}get _root(){return this._nodes[0]}get _currNode(){const $=this._nodes;return $[$.length-1]}set _currNode($){const T=this._nodes;T[T.length-1]=$}}t.CodeGen=O;function I(U,$){for(const T in $)U[T]=(U[T]||0)+($[T]||0);return U}function N(U,$){return $ instanceof e._CodeOrName?I(U,$.names):U}function j(U,$,T){if(U instanceof e.Name)return z(U);if(!ne(U))return U;return new e._Code(U._items.reduce((ue,ye)=>(ye instanceof e.Name&&(ye=z(ye)),ye instanceof e._Code?ue.push(...ye._items):ue.push(ye),ue),[]));function z(ue){const ye=T[ue.str];return ye===void 0||$[ue.str]!==1?ue:(delete $[ue.str],ye)}function ne(ue){return ue instanceof e._Code&&ue._items.some(ye=>ye instanceof e.Name&&$[ye.str]===1&&T[ye.str]!==void 0)}}function F(U,$){for(const T in $)U[T]=(U[T]||0)-($[T]||0)}function V(U){return typeof U=="boolean"||typeof U=="number"||U===null?!U:(0,e._)`!${H(U)}`}t.not=V;const ee=k(t.operators.AND);function G(...U){return U.reduce(ee)}t.and=G;const Z=k(t.operators.OR);function M(...U){return U.reduce(Z)}t.or=M;function k(U){return($,T)=>$===e.nil?T:T===e.nil?$:(0,e._)`${H($)} ${U} ${H(T)}`}function H(U){return U instanceof e.Name?U:(0,e._)`(${U})`}})(Tt);var Ut={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.checkStrictMode=t.getErrorPath=t.Type=t.useFunc=t.setEvaluated=t.evaluatedPropsToName=t.mergeEvaluated=t.eachItem=t.unescapeJsonPointer=t.escapeJsonPointer=t.escapeFragment=t.unescapeFragment=t.schemaRefOrVal=t.schemaHasRulesButRef=t.schemaHasRules=t.checkUnknownRules=t.alwaysValidSchema=t.toHash=void 0;const e=Tt,r=Mh;function n(x){const D={};for(const E of x)D[E]=!0;return D}t.toHash=n;function s(x,D){return typeof D=="boolean"?D:Object.keys(D).length===0?!0:(i(x,D),!o(D,x.self.RULES.all))}t.alwaysValidSchema=s;function i(x,D=x.schema){const{opts:E,self:A}=x;if(!E.strictSchema||typeof D=="boolean")return;const S=A.RULES.keywords;for(const O in D)S[O]||_(x,`unknown keyword: "${O}"`)}t.checkUnknownRules=i;function o(x,D){if(typeof x=="boolean")return!x;for(const E in x)if(D[E])return!0;return!1}t.schemaHasRules=o;function a(x,D){if(typeof x=="boolean")return!x;for(const E in x)if(E!=="$ref"&&D.all[E])return!0;return!1}t.schemaHasRulesButRef=a;function c({topSchemaRef:x,schemaPath:D},E,A,S){if(!S){if(typeof E=="number"||typeof E=="boolean")return E;if(typeof E=="string")return(0,e._)`${E}`}return(0,e._)`${x}${D}${(0,e.getProperty)(A)}`}t.schemaRefOrVal=c;function l(x){return h(decodeURIComponent(x))}t.unescapeFragment=l;function u(x){return encodeURIComponent(d(x))}t.escapeFragment=u;function d(x){return typeof x=="number"?`${x}`:x.replace(/~/g,"~0").replace(/\//g,"~1")}t.escapeJsonPointer=d;function h(x){return x.replace(/~1/g,"/").replace(/~0/g,"~")}t.unescapeJsonPointer=h;function f(x,D){if(Array.isArray(x))for(const E of x)D(E);else D(x)}t.eachItem=f;function p({mergeNames:x,mergeToName:D,mergeValues:E,resultToName:A}){return(S,O,I,N)=>{const j=I===void 0?O:I instanceof e.Name?(O instanceof e.Name?x(S,O,I):D(S,O,I),I):O instanceof e.Name?(D(S,I,O),O):E(O,I);return N===e.Name&&!(j instanceof e.Name)?A(S,j):j}}t.mergeEvaluated={props:p({mergeNames:(x,D,E)=>x.if((0,e._)`${E} !== true && ${D} !== undefined`,()=>{x.if((0,e._)`${D} === true`,()=>x.assign(E,!0),()=>x.assign(E,(0,e._)`${E} || {}`).code((0,e._)`Object.assign(${E}, ${D})`))}),mergeToName:(x,D,E)=>x.if((0,e._)`${E} !== true`,()=>{D===!0?x.assign(E,!0):(x.assign(E,(0,e._)`${E} || {}`),b(x,E,D))}),mergeValues:(x,D)=>x===!0?!0:{...x,...D},resultToName:y}),items:p({mergeNames:(x,D,E)=>x.if((0,e._)`${E} !== true && ${D} !== undefined`,()=>x.assign(E,(0,e._)`${D} === true ? true : ${E} > ${D} ? ${E} : ${D}`)),mergeToName:(x,D,E)=>x.if((0,e._)`${E} !== true`,()=>x.assign(E,D===!0?!0:(0,e._)`${E} > ${D} ? ${E} : ${D}`)),mergeValues:(x,D)=>x===!0?!0:Math.max(x,D),resultToName:(x,D)=>x.var("items",D)})};function y(x,D){if(D===!0)return x.var("props",!0);const E=x.var("props",(0,e._)`{}`);return D!==void 0&&b(x,E,D),E}t.evaluatedPropsToName=y;function b(x,D,E){Object.keys(E).forEach(A=>x.assign((0,e._)`${D}${(0,e.getProperty)(A)}`,!0))}t.setEvaluated=b;const w={};function g(x,D){return x.scopeValue("func",{ref:D,code:w[D.code]||(w[D.code]=new r._Code(D.code))})}t.useFunc=g;var v;(function(x){x[x.Num=0]="Num",x[x.Str=1]="Str"})(v=t.Type||(t.Type={}));function m(x,D,E){if(x instanceof e.Name){const A=D===v.Num;return E?A?(0,e._)`"[" + ${x} + "]"`:(0,e._)`"['" + ${x} + "']"`:A?(0,e._)`"/" + ${x}`:(0,e._)`"/" + ${x}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return E?(0,e.getProperty)(x).toString():"/"+d(x)}t.getErrorPath=m;function _(x,D,E=x.opts.strictSchema){if(E){if(D=`strict mode: ${D}`,E===!0)throw new Error(D);x.self.logger.warn(D)}}t.checkStrictMode=_})(Ut);var ea={};Object.defineProperty(ea,"__esModule",{value:!0});const jn=Tt,dY={data:new jn.Name("data"),valCxt:new jn.Name("valCxt"),instancePath:new jn.Name("instancePath"),parentData:new jn.Name("parentData"),parentDataProperty:new jn.Name("parentDataProperty"),rootData:new jn.Name("rootData"),dynamicAnchors:new jn.Name("dynamicAnchors"),vErrors:new jn.Name("vErrors"),errors:new jn.Name("errors"),this:new jn.Name("this"),self:new jn.Name("self"),scope:new jn.Name("scope"),json:new jn.Name("json"),jsonPos:new jn.Name("jsonPos"),jsonLen:new jn.Name("jsonLen"),jsonPart:new jn.Name("jsonPart")};ea.default=dY;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.extendErrors=t.resetErrorsCount=t.reportExtraError=t.reportError=t.keyword$DataError=t.keywordError=void 0;const e=Tt,r=Ut,n=ea;t.keywordError={message:({keyword:b})=>(0,e.str)`must pass "${b}" keyword validation`},t.keyword$DataError={message:({keyword:b,schemaType:w})=>w?(0,e.str)`"${b}" keyword must be ${w} ($data)`:(0,e.str)`"${b}" keyword is invalid ($data)`};function s(b,w=t.keywordError,g,v){const{it:m}=b,{gen:_,compositeRule:x,allErrors:D}=m,E=d(b,w,g);v??(x||D)?c(_,E):l(m,(0,e._)`[${E}]`)}t.reportError=s;function i(b,w=t.keywordError,g){const{it:v}=b,{gen:m,compositeRule:_,allErrors:x}=v,D=d(b,w,g);c(m,D),_||x||l(v,n.default.vErrors)}t.reportExtraError=i;function o(b,w){b.assign(n.default.errors,w),b.if((0,e._)`${n.default.vErrors} !== null`,()=>b.if(w,()=>b.assign((0,e._)`${n.default.vErrors}.length`,w),()=>b.assign(n.default.vErrors,null)))}t.resetErrorsCount=o;function a({gen:b,keyword:w,schemaValue:g,data:v,errsCount:m,it:_}){if(m===void 0)throw new Error("ajv implementation error");const x=b.name("err");b.forRange("i",m,n.default.errors,D=>{b.const(x,(0,e._)`${n.default.vErrors}[${D}]`),b.if((0,e._)`${x}.instancePath === undefined`,()=>b.assign((0,e._)`${x}.instancePath`,(0,e.strConcat)(n.default.instancePath,_.errorPath))),b.assign((0,e._)`${x}.schemaPath`,(0,e.str)`${_.errSchemaPath}/${w}`),_.opts.verbose&&(b.assign((0,e._)`${x}.schema`,g),b.assign((0,e._)`${x}.data`,v))})}t.extendErrors=a;function c(b,w){const g=b.const("err",w);b.if((0,e._)`${n.default.vErrors} === null`,()=>b.assign(n.default.vErrors,(0,e._)`[${g}]`),(0,e._)`${n.default.vErrors}.push(${g})`),b.code((0,e._)`${n.default.errors}++`)}function l(b,w){const{gen:g,validateName:v,schemaEnv:m}=b;m.$async?g.throw((0,e._)`new ${b.ValidationError}(${w})`):(g.assign((0,e._)`${v}.errors`,w),g.return(!1))}const u={keyword:new e.Name("keyword"),schemaPath:new e.Name("schemaPath"),params:new e.Name("params"),propertyName:new e.Name("propertyName"),message:new e.Name("message"),schema:new e.Name("schema"),parentSchema:new e.Name("parentSchema")};function d(b,w,g){const{createErrors:v}=b.it;return v===!1?(0,e._)`{}`:h(b,w,g)}function h(b,w,g={}){const{gen:v,it:m}=b,_=[f(m,g),p(b,g)];return y(b,w,_),v.object(..._)}function f({errorPath:b},{instancePath:w}){const g=w?(0,e.str)`${b}${(0,r.getErrorPath)(w,r.Type.Str)}`:b;return[n.default.instancePath,(0,e.strConcat)(n.default.instancePath,g)]}function p({keyword:b,it:{errSchemaPath:w}},{schemaPath:g,parentSchema:v}){let m=v?w:(0,e.str)`${w}/${b}`;return g&&(m=(0,e.str)`${m}${(0,r.getErrorPath)(g,r.Type.Str)}`),[u.schemaPath,m]}function y(b,{params:w,message:g},v){const{keyword:m,data:_,schemaValue:x,it:D}=b,{opts:E,propertyName:A,topSchemaRef:S,schemaPath:O}=D;v.push([u.keyword,m],[u.params,typeof w=="function"?w(b):w||(0,e._)`{}`]),E.messages&&v.push([u.message,typeof g=="function"?g(b):g]),E.verbose&&v.push([u.schema,x],[u.parentSchema,(0,e._)`${S}${O}`],[n.default.data,_]),A&&v.push([u.propertyName,A])}})(fy);Object.defineProperty(lf,"__esModule",{value:!0});lf.boolOrEmptySchema=lf.topBoolOrEmptySchema=void 0;const fY=fy,pY=Tt,hY=ea,yY={message:"boolean schema is false"};function mY(t){const{gen:e,schema:r,validateName:n}=t;r===!1?j8(t,!1):typeof r=="object"&&r.$async===!0?e.return(hY.default.data):(e.assign((0,pY._)`${n}.errors`,null),e.return(!0))}lf.topBoolOrEmptySchema=mY;function gY(t,e){const{gen:r,schema:n}=t;n===!1?(r.var(e,!1),j8(t)):r.var(e,!0)}lf.boolOrEmptySchema=gY;function j8(t,e){const{gen:r,data:n}=t,s={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,fY.reportError)(s,yY,void 0,e)}var py={},Xl={};Object.defineProperty(Xl,"__esModule",{value:!0});Xl.getRules=Xl.isJSONType=void 0;const vY=["string","number","integer","boolean","null","object","array"],wY=new Set(vY);function bY(t){return typeof t=="string"&&wY.has(t)}Xl.isJSONType=bY;function _Y(){const t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...t,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}Xl.getRules=_Y;var qa={};Object.defineProperty(qa,"__esModule",{value:!0});qa.shouldUseRule=qa.shouldUseGroup=qa.schemaHasRulesForType=void 0;function EY({schema:t,self:e},r){const n=e.RULES.types[r];return n&&n!==!0&&M8(t,n)}qa.schemaHasRulesForType=EY;function M8(t,e){return e.rules.some(r=>U8(t,r))}qa.shouldUseGroup=M8;function U8(t,e){var r;return t[e.keyword]!==void 0||((r=e.definition.implements)===null||r===void 0?void 0:r.some(n=>t[n]!==void 0))}qa.shouldUseRule=U8;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.reportTypeError=t.checkDataTypes=t.checkDataType=t.coerceAndCheckDataType=t.getJSONTypes=t.getSchemaTypes=t.DataType=void 0;const e=Xl,r=qa,n=fy,s=Tt,i=Ut;var o;(function(v){v[v.Correct=0]="Correct",v[v.Wrong=1]="Wrong"})(o=t.DataType||(t.DataType={}));function a(v){const m=c(v.type);if(m.includes("null")){if(v.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!m.length&&v.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');v.nullable===!0&&m.push("null")}return m}t.getSchemaTypes=a;function c(v){const m=Array.isArray(v)?v:v?[v]:[];if(m.every(e.isJSONType))return m;throw new Error("type must be JSONType or JSONType[]: "+m.join(","))}t.getJSONTypes=c;function l(v,m){const{gen:_,data:x,opts:D}=v,E=d(m,D.coerceTypes),A=m.length>0&&!(E.length===0&&m.length===1&&(0,r.schemaHasRulesForType)(v,m[0]));if(A){const S=y(m,x,D.strictNumbers,o.Wrong);_.if(S,()=>{E.length?h(v,m,E):w(v)})}return A}t.coerceAndCheckDataType=l;const u=new Set(["string","number","integer","boolean","null"]);function d(v,m){return m?v.filter(_=>u.has(_)||m==="array"&&_==="array"):[]}function h(v,m,_){const{gen:x,data:D,opts:E}=v,A=x.let("dataType",(0,s._)`typeof ${D}`),S=x.let("coerced",(0,s._)`undefined`);E.coerceTypes==="array"&&x.if((0,s._)`${A} == 'object' && Array.isArray(${D}) && ${D}.length == 1`,()=>x.assign(D,(0,s._)`${D}[0]`).assign(A,(0,s._)`typeof ${D}`).if(y(m,D,E.strictNumbers),()=>x.assign(S,D))),x.if((0,s._)`${S} !== undefined`);for(const I of _)(u.has(I)||I==="array"&&E.coerceTypes==="array")&&O(I);x.else(),w(v),x.endIf(),x.if((0,s._)`${S} !== undefined`,()=>{x.assign(D,S),f(v,S)});function O(I){switch(I){case"string":x.elseIf((0,s._)`${A} == "number" || ${A} == "boolean"`).assign(S,(0,s._)`"" + ${D}`).elseIf((0,s._)`${D} === null`).assign(S,(0,s._)`""`);return;case"number":x.elseIf((0,s._)`${A} == "boolean" || ${D} === null
              || (${A} == "string" && ${D} && ${D} == +${D})`).assign(S,(0,s._)`+${D}`);return;case"integer":x.elseIf((0,s._)`${A} === "boolean" || ${D} === null
              || (${A} === "string" && ${D} && ${D} == +${D} && !(${D} % 1))`).assign(S,(0,s._)`+${D}`);return;case"boolean":x.elseIf((0,s._)`${D} === "false" || ${D} === 0 || ${D} === null`).assign(S,!1).elseIf((0,s._)`${D} === "true" || ${D} === 1`).assign(S,!0);return;case"null":x.elseIf((0,s._)`${D} === "" || ${D} === 0 || ${D} === false`),x.assign(S,null);return;case"array":x.elseIf((0,s._)`${A} === "string" || ${A} === "number"
              || ${A} === "boolean" || ${D} === null`).assign(S,(0,s._)`[${D}]`)}}}function f({gen:v,parentData:m,parentDataProperty:_},x){v.if((0,s._)`${m} !== undefined`,()=>v.assign((0,s._)`${m}[${_}]`,x))}function p(v,m,_,x=o.Correct){const D=x===o.Correct?s.operators.EQ:s.operators.NEQ;let E;switch(v){case"null":return(0,s._)`${m} ${D} null`;case"array":E=(0,s._)`Array.isArray(${m})`;break;case"object":E=(0,s._)`${m} && typeof ${m} == "object" && !Array.isArray(${m})`;break;case"integer":E=A((0,s._)`!(${m} % 1) && !isNaN(${m})`);break;case"number":E=A();break;default:return(0,s._)`typeof ${m} ${D} ${v}`}return x===o.Correct?E:(0,s.not)(E);function A(S=s.nil){return(0,s.and)((0,s._)`typeof ${m} == "number"`,S,_?(0,s._)`isFinite(${m})`:s.nil)}}t.checkDataType=p;function y(v,m,_,x){if(v.length===1)return p(v[0],m,_,x);let D;const E=(0,i.toHash)(v);if(E.array&&E.object){const A=(0,s._)`typeof ${m} != "object"`;D=E.null?A:(0,s._)`!${m} || ${A}`,delete E.null,delete E.array,delete E.object}else D=s.nil;E.number&&delete E.integer;for(const A in E)D=(0,s.and)(D,p(A,m,_,x));return D}t.checkDataTypes=y;const b={message:({schema:v})=>`must be ${v}`,params:({schema:v,schemaValue:m})=>typeof v=="string"?(0,s._)`{type: ${v}}`:(0,s._)`{type: ${m}}`};function w(v){const m=g(v);(0,n.reportError)(m,b)}t.reportTypeError=w;function g(v){const{gen:m,data:_,schema:x}=v,D=(0,i.schemaRefOrVal)(v,x,"type");return{gen:m,keyword:"type",data:_,schema:x.type,schemaCode:D,schemaValue:D,parentSchema:x,params:{},it:v}}})(py);var Yg={};Object.defineProperty(Yg,"__esModule",{value:!0});Yg.assignDefaults=void 0;const Ad=Tt,AY=Ut;function SY(t,e){const{properties:r,items:n}=t.schema;if(e==="object"&&r)for(const s in r)xD(t,s,r[s].default);else e==="array"&&Array.isArray(n)&&n.forEach((s,i)=>xD(t,i,s.default))}Yg.assignDefaults=SY;function xD(t,e,r){const{gen:n,compositeRule:s,data:i,opts:o}=t;if(r===void 0)return;const a=(0,Ad._)`${i}${(0,Ad.getProperty)(e)}`;if(s){(0,AY.checkStrictMode)(t,`default is ignored for: ${a}`);return}let c=(0,Ad._)`${a} === undefined`;o.useDefaults==="empty"&&(c=(0,Ad._)`${c} || ${a} === null || ${a} === ""`),n.if(c,(0,Ad._)`${a} = ${(0,Ad.stringify)(r)}`)}var Bo={},Ct={};Object.defineProperty(Ct,"__esModule",{value:!0});Ct.validateUnion=Ct.validateArray=Ct.usePattern=Ct.callValidateCode=Ct.schemaProperties=Ct.allSchemaProperties=Ct.noPropertyInData=Ct.propertyInData=Ct.isOwnProperty=Ct.hasPropFunc=Ct.reportMissingProp=Ct.checkMissingProp=Ct.checkReportMissingProp=void 0;const yr=Tt,KE=Ut,$u=ea,$Y=Ut;function xY(t,e){const{gen:r,data:n,it:s}=t;r.if(qE(r,n,e,s.opts.ownProperties),()=>{t.setParams({missingProperty:(0,yr._)`${e}`},!0),t.error()})}Ct.checkReportMissingProp=xY;function DY({gen:t,data:e,it:{opts:r}},n,s){return(0,yr.or)(...n.map(i=>(0,yr.and)(qE(t,e,i,r.ownProperties),(0,yr._)`${s} = ${i}`)))}Ct.checkMissingProp=DY;function PY(t,e){t.setParams({missingProperty:e},!0),t.error()}Ct.reportMissingProp=PY;function K8(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,yr._)`Object.prototype.hasOwnProperty`})}Ct.hasPropFunc=K8;function LE(t,e,r){return(0,yr._)`${K8(t)}.call(${e}, ${r})`}Ct.isOwnProperty=LE;function CY(t,e,r,n){const s=(0,yr._)`${e}${(0,yr.getProperty)(r)} !== undefined`;return n?(0,yr._)`${s} && ${LE(t,e,r)}`:s}Ct.propertyInData=CY;function qE(t,e,r,n){const s=(0,yr._)`${e}${(0,yr.getProperty)(r)} === undefined`;return n?(0,yr.or)(s,(0,yr.not)(LE(t,e,r))):s}Ct.noPropertyInData=qE;function L8(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}Ct.allSchemaProperties=L8;function kY(t,e){return L8(e).filter(r=>!(0,KE.alwaysValidSchema)(t,e[r]))}Ct.schemaProperties=kY;function OY({schemaCode:t,data:e,it:{gen:r,topSchemaRef:n,schemaPath:s,errorPath:i},it:o},a,c,l){const u=l?(0,yr._)`${t}, ${e}, ${n}${s}`:e,d=[[$u.default.instancePath,(0,yr.strConcat)($u.default.instancePath,i)],[$u.default.parentData,o.parentData],[$u.default.parentDataProperty,o.parentDataProperty],[$u.default.rootData,$u.default.rootData]];o.opts.dynamicRef&&d.push([$u.default.dynamicAnchors,$u.default.dynamicAnchors]);const h=(0,yr._)`${u}, ${r.object(...d)}`;return c!==yr.nil?(0,yr._)`${a}.call(${c}, ${h})`:(0,yr._)`${a}(${h})`}Ct.callValidateCode=OY;const TY=(0,yr._)`new RegExp`;function IY({gen:t,it:{opts:e}},r){const n=e.unicodeRegExp?"u":"",{regExp:s}=e.code,i=s(r,n);return t.scopeValue("pattern",{key:i.toString(),ref:i,code:(0,yr._)`${s.code==="new RegExp"?TY:(0,$Y.useFunc)(t,s)}(${r}, ${n})`})}Ct.usePattern=IY;function BY(t){const{gen:e,data:r,keyword:n,it:s}=t,i=e.name("valid");if(s.allErrors){const a=e.let("valid",!0);return o(()=>e.assign(a,!1)),a}return e.var(i,!0),o(()=>e.break()),i;function o(a){const c=e.const("len",(0,yr._)`${r}.length`);e.forRange("i",0,c,l=>{t.subschema({keyword:n,dataProp:l,dataPropType:KE.Type.Num},i),e.if((0,yr.not)(i),a)})}}Ct.validateArray=BY;function FY(t){const{gen:e,schema:r,keyword:n,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(c=>(0,KE.alwaysValidSchema)(s,c))&&!s.opts.unevaluated)return;const o=e.let("valid",!1),a=e.name("_valid");e.block(()=>r.forEach((c,l)=>{const u=t.subschema({keyword:n,schemaProp:l,compositeRule:!0},a);e.assign(o,(0,yr._)`${o} || ${a}`),t.mergeValidEvaluated(u,a)||e.if((0,yr.not)(o))})),t.result(o,()=>t.reset(),()=>t.error(!0))}Ct.validateUnion=FY;Object.defineProperty(Bo,"__esModule",{value:!0});Bo.validateKeywordUsage=Bo.validSchemaType=Bo.funcKeywordCode=Bo.macroKeywordCode=void 0;const Gn=Tt,ml=ea,NY=Ct,RY=fy;function jY(t,e){const{gen:r,keyword:n,schema:s,parentSchema:i,it:o}=t,a=e.macro.call(o.self,s,i,o),c=q8(r,n,a);o.opts.validateSchema!==!1&&o.self.validateSchema(a,!0);const l=r.name("valid");t.subschema({schema:a,schemaPath:Gn.nil,errSchemaPath:`${o.errSchemaPath}/${n}`,topSchemaRef:c,compositeRule:!0},l),t.pass(l,()=>t.error(!0))}Bo.macroKeywordCode=jY;function MY(t,e){var r;const{gen:n,keyword:s,schema:i,parentSchema:o,$data:a,it:c}=t;KY(c,e);const l=!a&&e.compile?e.compile.call(c.self,i,o,c):e.validate,u=q8(n,s,l),d=n.let("valid");t.block$data(d,h),t.ok((r=e.valid)!==null&&r!==void 0?r:d);function h(){if(e.errors===!1)y(),e.modifying&&DD(t),b(()=>t.error());else{const w=e.async?f():p();e.modifying&&DD(t),b(()=>UY(t,w))}}function f(){const w=n.let("ruleErrs",null);return n.try(()=>y((0,Gn._)`await `),g=>n.assign(d,!1).if((0,Gn._)`${g} instanceof ${c.ValidationError}`,()=>n.assign(w,(0,Gn._)`${g}.errors`),()=>n.throw(g))),w}function p(){const w=(0,Gn._)`${u}.errors`;return n.assign(w,null),y(Gn.nil),w}function y(w=e.async?(0,Gn._)`await `:Gn.nil){const g=c.opts.passContext?ml.default.this:ml.default.self,v=!("compile"in e&&!a||e.schema===!1);n.assign(d,(0,Gn._)`${w}${(0,NY.callValidateCode)(t,u,g,v)}`,e.modifying)}function b(w){var g;n.if((0,Gn.not)((g=e.valid)!==null&&g!==void 0?g:d),w)}}Bo.funcKeywordCode=MY;function DD(t){const{gen:e,data:r,it:n}=t;e.if(n.parentData,()=>e.assign(r,(0,Gn._)`${n.parentData}[${n.parentDataProperty}]`))}function UY(t,e){const{gen:r}=t;r.if((0,Gn._)`Array.isArray(${e})`,()=>{r.assign(ml.default.vErrors,(0,Gn._)`${ml.default.vErrors} === null ? ${e} : ${ml.default.vErrors}.concat(${e})`).assign(ml.default.errors,(0,Gn._)`${ml.default.vErrors}.length`),(0,RY.extendErrors)(t)},()=>t.error())}function KY({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function q8(t,e,r){if(r===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,Gn.stringify)(r)})}function LY(t,e,r=!1){return!e.length||e.some(n=>n==="array"?Array.isArray(t):n==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==n||r&&typeof t>"u")}Bo.validSchemaType=LY;function qY({schema:t,opts:e,self:r,errSchemaPath:n},s,i){if(Array.isArray(s.keyword)?!s.keyword.includes(i):s.keyword!==i)throw new Error("ajv implementation error");const o=s.dependencies;if(o!=null&&o.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${i}: ${o.join(",")}`);if(s.validateSchema&&!s.validateSchema(t[i])){const c=`keyword "${i}" value is invalid at path "${n}": `+r.errorsText(s.validateSchema.errors);if(e.validateSchema==="log")r.logger.error(c);else throw new Error(c)}}Bo.validateKeywordUsage=qY;var fc={};Object.defineProperty(fc,"__esModule",{value:!0});fc.extendSubschemaMode=fc.extendSubschemaData=fc.getSubschema=void 0;const Oo=Tt,V8=Ut;function VY(t,{keyword:e,schemaProp:r,schema:n,schemaPath:s,errSchemaPath:i,topSchemaRef:o}){if(e!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){const a=t.schema[e];return r===void 0?{schema:a,schemaPath:(0,Oo._)`${t.schemaPath}${(0,Oo.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[r],schemaPath:(0,Oo._)`${t.schemaPath}${(0,Oo.getProperty)(e)}${(0,Oo.getProperty)(r)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,V8.escapeFragment)(r)}`}}if(n!==void 0){if(s===void 0||i===void 0||o===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:s,topSchemaRef:o,errSchemaPath:i}}throw new Error('either "keyword" or "schema" must be passed')}fc.getSubschema=VY;function zY(t,e,{dataProp:r,dataPropType:n,data:s,dataTypes:i,propertyName:o}){if(s!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:a}=e;if(r!==void 0){const{errorPath:l,dataPathArr:u,opts:d}=e,h=a.let("data",(0,Oo._)`${e.data}${(0,Oo.getProperty)(r)}`,!0);c(h),t.errorPath=(0,Oo.str)`${l}${(0,V8.getErrorPath)(r,n,d.jsPropertySyntax)}`,t.parentDataProperty=(0,Oo._)`${r}`,t.dataPathArr=[...u,t.parentDataProperty]}if(s!==void 0){const l=s instanceof Oo.Name?s:a.let("data",s,!0);c(l),o!==void 0&&(t.propertyName=o)}i&&(t.dataTypes=i);function c(l){t.data=l,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,l]}}fc.extendSubschemaData=zY;function HY(t,{jtdDiscriminator:e,jtdMetadata:r,compositeRule:n,createErrors:s,allErrors:i}){n!==void 0&&(t.compositeRule=n),s!==void 0&&(t.createErrors=s),i!==void 0&&(t.allErrors=i),t.jtdDiscriminator=e,t.jtdMetadata=r}fc.extendSubschemaMode=HY;var On={};Object.defineProperty(On,"__esModule",{value:!0});On.getSchemaRefs=On.resolveUrl=On.normalizeId=On._getFullPath=On.getFullPath=On.inlineRef=void 0;const WY=Ut,JY=Ig,GY=IO,ZY=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function XY(t,e=!0){return typeof t=="boolean"?!0:e===!0?!w1(t):e?z8(t)<=e:!1}On.inlineRef=XY;const YY=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function w1(t){for(const e in t){if(YY.has(e))return!0;const r=t[e];if(Array.isArray(r)&&r.some(w1)||typeof r=="object"&&w1(r))return!0}return!1}function z8(t){let e=0;for(const r in t){if(r==="$ref")return 1/0;if(e++,!ZY.has(r)&&(typeof t[r]=="object"&&(0,WY.eachItem)(t[r],n=>e+=z8(n)),e===1/0))return 1/0}return e}function H8(t,e="",r){r!==!1&&(e=Wd(e));const n=t.parse(e);return W8(t,n)}On.getFullPath=H8;function W8(t,e){return t.serialize(e).split("#")[0]+"#"}On._getFullPath=W8;const QY=/#\/?$/;function Wd(t){return t?t.replace(QY,""):""}On.normalizeId=Wd;function eQ(t,e,r){return r=Wd(r),t.resolve(e,r)}On.resolveUrl=eQ;const tQ=/^[a-z_][-a-z0-9._]*$/i;function rQ(t,e){if(typeof t=="boolean")return{};const{schemaId:r,uriResolver:n}=this.opts,s=Wd(t[r]||e),i={"":s},o=H8(n,s,!1),a={},c=new Set;return GY(t,{allKeys:!0},(d,h,f,p)=>{if(p===void 0)return;const y=o+h;let b=i[p];typeof d[r]=="string"&&(b=w.call(this,d[r])),g.call(this,d.$anchor),g.call(this,d.$dynamicAnchor),i[h]=b;function w(v){const m=this.opts.uriResolver.resolve;if(v=Wd(b?m(b,v):v),c.has(v))throw u(v);c.add(v);let _=this.refs[v];return typeof _=="string"&&(_=this.refs[_]),typeof _=="object"?l(d,_.schema,v):v!==Wd(y)&&(v[0]==="#"?(l(d,a[v],v),a[v]=d):this.refs[v]=y),v}function g(v){if(typeof v=="string"){if(!tQ.test(v))throw new Error(`invalid anchor "${v}"`);w.call(this,`#${v}`)}}}),a;function l(d,h,f){if(h!==void 0&&!JY(d,h))throw u(f)}function u(d){return new Error(`reference "${d}" resolves to more than one schema`)}}On.getSchemaRefs=rQ;Object.defineProperty(Hs,"__esModule",{value:!0});Hs.getData=Hs.KeywordCxt=Hs.validateFunctionCode=void 0;const J8=lf,PD=py,VE=qa,eg=py,nQ=Yg,lh=Bo,Vw=fc,He=Tt,ht=ea,iQ=On,Va=Ut,bp=fy;function sQ(t){if(X8(t)&&(Y8(t),Z8(t))){uQ(t);return}G8(t,()=>(0,J8.topBoolOrEmptySchema)(t))}Hs.validateFunctionCode=sQ;function G8({gen:t,validateName:e,schema:r,schemaEnv:n,opts:s},i){s.code.es5?t.func(e,(0,He._)`${ht.default.data}, ${ht.default.valCxt}`,n.$async,()=>{t.code((0,He._)`"use strict"; ${CD(r,s)}`),aQ(t,s),t.code(i)}):t.func(e,(0,He._)`${ht.default.data}, ${oQ(s)}`,n.$async,()=>t.code(CD(r,s)).code(i))}function oQ(t){return(0,He._)`{${ht.default.instancePath}="", ${ht.default.parentData}, ${ht.default.parentDataProperty}, ${ht.default.rootData}=${ht.default.data}${t.dynamicRef?(0,He._)`, ${ht.default.dynamicAnchors}={}`:He.nil}}={}`}function aQ(t,e){t.if(ht.default.valCxt,()=>{t.var(ht.default.instancePath,(0,He._)`${ht.default.valCxt}.${ht.default.instancePath}`),t.var(ht.default.parentData,(0,He._)`${ht.default.valCxt}.${ht.default.parentData}`),t.var(ht.default.parentDataProperty,(0,He._)`${ht.default.valCxt}.${ht.default.parentDataProperty}`),t.var(ht.default.rootData,(0,He._)`${ht.default.valCxt}.${ht.default.rootData}`),e.dynamicRef&&t.var(ht.default.dynamicAnchors,(0,He._)`${ht.default.valCxt}.${ht.default.dynamicAnchors}`)},()=>{t.var(ht.default.instancePath,(0,He._)`""`),t.var(ht.default.parentData,(0,He._)`undefined`),t.var(ht.default.parentDataProperty,(0,He._)`undefined`),t.var(ht.default.rootData,ht.default.data),e.dynamicRef&&t.var(ht.default.dynamicAnchors,(0,He._)`{}`)})}function uQ(t){const{schema:e,opts:r,gen:n}=t;G8(t,()=>{r.$comment&&e.$comment&&eI(t),pQ(t),n.let(ht.default.vErrors,null),n.let(ht.default.errors,0),r.unevaluated&&cQ(t),Q8(t),mQ(t)})}function cQ(t){const{gen:e,validateName:r}=t;t.evaluated=e.const("evaluated",(0,He._)`${r}.evaluated`),e.if((0,He._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,He._)`${t.evaluated}.props`,(0,He._)`undefined`)),e.if((0,He._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,He._)`${t.evaluated}.items`,(0,He._)`undefined`))}function CD(t,e){const r=typeof t=="object"&&t[e.schemaId];return r&&(e.code.source||e.code.process)?(0,He._)`/*# sourceURL=${r} */`:He.nil}function lQ(t,e){if(X8(t)&&(Y8(t),Z8(t))){dQ(t,e);return}(0,J8.boolOrEmptySchema)(t,e)}function Z8({schema:t,self:e}){if(typeof t=="boolean")return!t;for(const r in t)if(e.RULES.all[r])return!0;return!1}function X8(t){return typeof t.schema!="boolean"}function dQ(t,e){const{schema:r,gen:n,opts:s}=t;s.$comment&&r.$comment&&eI(t),hQ(t),yQ(t);const i=n.const("_errs",ht.default.errors);Q8(t,i),n.var(e,(0,He._)`${i} === ${ht.default.errors}`)}function Y8(t){(0,Va.checkUnknownRules)(t),fQ(t)}function Q8(t,e){if(t.opts.jtd)return kD(t,[],!1,e);const r=(0,PD.getSchemaTypes)(t.schema),n=(0,PD.coerceAndCheckDataType)(t,r);kD(t,r,!n,e)}function fQ(t){const{schema:e,errSchemaPath:r,opts:n,self:s}=t;e.$ref&&n.ignoreKeywordsWithRef&&(0,Va.schemaHasRulesButRef)(e,s.RULES)&&s.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function pQ(t){const{schema:e,opts:r}=t;e.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,Va.checkStrictMode)(t,"default is ignored in the schema root")}function hQ(t){const e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,iQ.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function yQ(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function eI({gen:t,schemaEnv:e,schema:r,errSchemaPath:n,opts:s}){const i=r.$comment;if(s.$comment===!0)t.code((0,He._)`${ht.default.self}.logger.log(${i})`);else if(typeof s.$comment=="function"){const o=(0,He.str)`${n}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,He._)`${ht.default.self}.opts.$comment(${i}, ${o}, ${a}.schema)`)}}function mQ(t){const{gen:e,schemaEnv:r,validateName:n,ValidationError:s,opts:i}=t;r.$async?e.if((0,He._)`${ht.default.errors} === 0`,()=>e.return(ht.default.data),()=>e.throw((0,He._)`new ${s}(${ht.default.vErrors})`)):(e.assign((0,He._)`${n}.errors`,ht.default.vErrors),i.unevaluated&&gQ(t),e.return((0,He._)`${ht.default.errors} === 0`))}function gQ({gen:t,evaluated:e,props:r,items:n}){r instanceof He.Name&&t.assign((0,He._)`${e}.props`,r),n instanceof He.Name&&t.assign((0,He._)`${e}.items`,n)}function kD(t,e,r,n){const{gen:s,schema:i,data:o,allErrors:a,opts:c,self:l}=t,{RULES:u}=l;if(i.$ref&&(c.ignoreKeywordsWithRef||!(0,Va.schemaHasRulesButRef)(i,u))){s.block(()=>nI(t,"$ref",u.all.$ref.definition));return}c.jtd||vQ(t,e),s.block(()=>{for(const h of u.rules)d(h);d(u.post)});function d(h){(0,VE.shouldUseGroup)(i,h)&&(h.type?(s.if((0,eg.checkDataType)(h.type,o,c.strictNumbers)),OD(t,h),e.length===1&&e[0]===h.type&&r&&(s.else(),(0,eg.reportTypeError)(t)),s.endIf()):OD(t,h),a||s.if((0,He._)`${ht.default.errors} === ${n||0}`))}}function OD(t,e){const{gen:r,schema:n,opts:{useDefaults:s}}=t;s&&(0,nQ.assignDefaults)(t,e.type),r.block(()=>{for(const i of e.rules)(0,VE.shouldUseRule)(n,i)&&nI(t,i.keyword,i.definition,e.type)})}function vQ(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(wQ(t,e),t.opts.allowUnionTypes||bQ(t,e),_Q(t,t.dataTypes))}function wQ(t,e){if(e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(r=>{tI(t.dataTypes,r)||zE(t,`type "${r}" not allowed by context "${t.dataTypes.join(",")}"`)}),AQ(t,e)}}function bQ(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&zE(t,"use allowUnionTypes to allow union type keyword")}function _Q(t,e){const r=t.self.RULES.all;for(const n in r){const s=r[n];if(typeof s=="object"&&(0,VE.shouldUseRule)(t.schema,s)){const{type:i}=s.definition;i.length&&!i.some(o=>EQ(e,o))&&zE(t,`missing type "${i.join(",")}" for keyword "${n}"`)}}}function EQ(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function tI(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function AQ(t,e){const r=[];for(const n of t.dataTypes)tI(e,n)?r.push(n):e.includes("integer")&&n==="number"&&r.push("integer");t.dataTypes=r}function zE(t,e){const r=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${r}" (strictTypes)`,(0,Va.checkStrictMode)(t,e,t.opts.strictTypes)}class rI{constructor(e,r,n){if((0,lh.validateKeywordUsage)(e,r,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=r.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,Va.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=r,this.$data)this.schemaCode=e.gen.const("vSchema",iI(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,lh.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=e.gen.const("_errs",ht.default.errors))}result(e,r,n){this.failResult((0,He.not)(e),r,n)}failResult(e,r,n){this.gen.if(e),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,r){this.failResult((0,He.not)(e),void 0,r)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);const{schemaCode:r}=this;this.fail((0,He._)`${r} !== undefined && (${(0,He.or)(this.invalid$data(),e)})`)}error(e,r,n){if(r){this.setParams(r),this._error(e,n),this.setParams({});return}this._error(e,n)}_error(e,r){(e?bp.reportExtraError:bp.reportError)(this,this.def.error,r)}$dataError(){(0,bp.reportError)(this,this.def.$dataError||bp.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,bp.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,r){r?Object.assign(this.params,e):this.params=e}block$data(e,r,n=He.nil){this.gen.block(()=>{this.check$data(e,n),r()})}check$data(e=He.nil,r=He.nil){if(!this.$data)return;const{gen:n,schemaCode:s,schemaType:i,def:o}=this;n.if((0,He.or)((0,He._)`${s} === undefined`,r)),e!==He.nil&&n.assign(e,!0),(i.length||o.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==He.nil&&n.assign(e,!1)),n.else()}invalid$data(){const{gen:e,schemaCode:r,schemaType:n,def:s,it:i}=this;return(0,He.or)(o(),a());function o(){if(n.length){if(!(r instanceof He.Name))throw new Error("ajv implementation error");const c=Array.isArray(n)?n:[n];return(0,He._)`${(0,eg.checkDataTypes)(c,r,i.opts.strictNumbers,eg.DataType.Wrong)}`}return He.nil}function a(){if(s.validateSchema){const c=e.scopeValue("validate$data",{ref:s.validateSchema});return(0,He._)`!${c}(${r})`}return He.nil}}subschema(e,r){const n=(0,Vw.getSubschema)(this.it,e);(0,Vw.extendSubschemaData)(n,this.it,e),(0,Vw.extendSubschemaMode)(n,e);const s={...this.it,...n,items:void 0,props:void 0};return lQ(s,r),s}mergeEvaluated(e,r){const{it:n,gen:s}=this;n.opts.unevaluated&&(n.props!==!0&&e.props!==void 0&&(n.props=Va.mergeEvaluated.props(s,e.props,n.props,r)),n.items!==!0&&e.items!==void 0&&(n.items=Va.mergeEvaluated.items(s,e.items,n.items,r)))}mergeValidEvaluated(e,r){const{it:n,gen:s}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return s.if(r,()=>this.mergeEvaluated(e,He.Name)),!0}}Hs.KeywordCxt=rI;function nI(t,e,r,n){const s=new rI(t,r,e);"code"in r?r.code(s,n):s.$data&&r.validate?(0,lh.funcKeywordCode)(s,r):"macro"in r?(0,lh.macroKeywordCode)(s,r):(r.compile||r.validate)&&(0,lh.funcKeywordCode)(s,r)}const SQ=/^\/(?:[^~]|~0|~1)*$/,$Q=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function iI(t,{dataLevel:e,dataNames:r,dataPathArr:n}){let s,i;if(t==="")return ht.default.rootData;if(t[0]==="/"){if(!SQ.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);s=t,i=ht.default.rootData}else{const l=$Q.exec(t);if(!l)throw new Error(`Invalid JSON-pointer: ${t}`);const u=+l[1];if(s=l[2],s==="#"){if(u>=e)throw new Error(c("property/index",u));return n[e-u]}if(u>e)throw new Error(c("data",u));if(i=r[e-u],!s)return i}let o=i;const a=s.split("/");for(const l of a)l&&(i=(0,He._)`${i}${(0,He.getProperty)((0,Va.unescapeJsonPointer)(l))}`,o=(0,He._)`${o} && ${i}`);return o;function c(l,u){return`Cannot access ${l} ${u} levels up, current level is ${e}`}}Hs.getData=iI;var hy={};Object.defineProperty(hy,"__esModule",{value:!0});let xQ=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};hy.default=xQ;var yy={};Object.defineProperty(yy,"__esModule",{value:!0});const zw=On;class DQ extends Error{constructor(e,r,n,s){super(s||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,zw.resolveUrl)(e,r,n),this.missingSchema=(0,zw.normalizeId)((0,zw.getFullPath)(e,this.missingRef))}}yy.default=DQ;var vi={};Object.defineProperty(vi,"__esModule",{value:!0});vi.resolveSchema=vi.getCompilingSchema=vi.resolveRef=vi.compileSchema=vi.SchemaEnv=void 0;const ks=Tt,PQ=hy,Yc=ea,Us=On,TD=Ut,CQ=Hs;class Qg{constructor(e){var r;this.refs={},this.dynamicAnchors={};let n;typeof e.schema=="object"&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(r=e.baseId)!==null&&r!==void 0?r:(0,Us.normalizeId)(n==null?void 0:n[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=n==null?void 0:n.$async,this.refs={}}}vi.SchemaEnv=Qg;function HE(t){const e=sI.call(this,t);if(e)return e;const r=(0,Us.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:n,lines:s}=this.opts.code,{ownProperties:i}=this.opts,o=new ks.CodeGen(this.scope,{es5:n,lines:s,ownProperties:i});let a;t.$async&&(a=o.scopeValue("Error",{ref:PQ.default,code:(0,ks._)`require("ajv/dist/runtime/validation_error").default`}));const c=o.scopeName("validate");t.validateName=c;const l={gen:o,allErrors:this.opts.allErrors,data:Yc.default.data,parentData:Yc.default.parentData,parentDataProperty:Yc.default.parentDataProperty,dataNames:[Yc.default.data],dataPathArr:[ks.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:o.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,ks.stringify)(t.schema)}:{ref:t.schema}),validateName:c,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:r,baseId:t.baseId||r,schemaPath:ks.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,ks._)`""`,opts:this.opts,self:this};let u;try{this._compilations.add(t),(0,CQ.validateFunctionCode)(l),o.optimize(this.opts.code.optimize);const d=o.toString();u=`${o.scopeRefs(Yc.default.scope)}return ${d}`,this.opts.code.process&&(u=this.opts.code.process(u,t));const f=new Function(`${Yc.default.self}`,`${Yc.default.scope}`,u)(this,this.scope.get());if(this.scope.value(c,{ref:f}),f.errors=null,f.schema=t.schema,f.schemaEnv=t,t.$async&&(f.$async=!0),this.opts.code.source===!0&&(f.source={validateName:c,validateCode:d,scopeValues:o._values}),this.opts.unevaluated){const{props:p,items:y}=l;f.evaluated={props:p instanceof ks.Name?void 0:p,items:y instanceof ks.Name?void 0:y,dynamicProps:p instanceof ks.Name,dynamicItems:y instanceof ks.Name},f.source&&(f.source.evaluated=(0,ks.stringify)(f.evaluated))}return t.validate=f,t}catch(d){throw delete t.validate,delete t.validateName,u&&this.logger.error("Error compiling schema, function code:",u),d}finally{this._compilations.delete(t)}}vi.compileSchema=HE;function kQ(t,e,r){var n;r=(0,Us.resolveUrl)(this.opts.uriResolver,e,r);const s=t.refs[r];if(s)return s;let i=IQ.call(this,t,r);if(i===void 0){const o=(n=t.localRefs)===null||n===void 0?void 0:n[r],{schemaId:a}=this.opts;o&&(i=new Qg({schema:o,schemaId:a,root:t,baseId:e}))}if(i!==void 0)return t.refs[r]=OQ.call(this,i)}vi.resolveRef=kQ;function OQ(t){return(0,Us.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:HE.call(this,t)}function sI(t){for(const e of this._compilations)if(TQ(e,t))return e}vi.getCompilingSchema=sI;function TQ(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function IQ(t,e){let r;for(;typeof(r=this.refs[e])=="string";)e=r;return r||this.schemas[e]||ev.call(this,t,e)}function ev(t,e){const r=this.opts.uriResolver.parse(e),n=(0,Us._getFullPath)(this.opts.uriResolver,r);let s=(0,Us.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&n===s)return Hw.call(this,r,t);const i=(0,Us.normalizeId)(n),o=this.refs[i]||this.schemas[i];if(typeof o=="string"){const a=ev.call(this,t,o);return typeof(a==null?void 0:a.schema)!="object"?void 0:Hw.call(this,r,a)}if(typeof(o==null?void 0:o.schema)=="object"){if(o.validate||HE.call(this,o),i===(0,Us.normalizeId)(e)){const{schema:a}=o,{schemaId:c}=this.opts,l=a[c];return l&&(s=(0,Us.resolveUrl)(this.opts.uriResolver,s,l)),new Qg({schema:a,schemaId:c,root:t,baseId:s})}return Hw.call(this,r,o)}}vi.resolveSchema=ev;const BQ=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Hw(t,{baseId:e,schema:r,root:n}){var s;if(((s=t.fragment)===null||s===void 0?void 0:s[0])!=="/")return;for(const a of t.fragment.slice(1).split("/")){if(typeof r=="boolean")return;const c=r[(0,TD.unescapeFragment)(a)];if(c===void 0)return;r=c;const l=typeof r=="object"&&r[this.opts.schemaId];!BQ.has(a)&&l&&(e=(0,Us.resolveUrl)(this.opts.uriResolver,e,l))}let i;if(typeof r!="boolean"&&r.$ref&&!(0,TD.schemaHasRulesButRef)(r,this.RULES)){const a=(0,Us.resolveUrl)(this.opts.uriResolver,e,r.$ref);i=ev.call(this,n,a)}const{schemaId:o}=this.opts;if(i=i||new Qg({schema:r,schemaId:o,root:n,baseId:e}),i.schema!==i.root.schema)return i}const FQ="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",NQ="Meta-schema for $data reference (JSON AnySchema extension proposal)",RQ="object",jQ=["$data"],MQ={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},UQ=!1,KQ={$id:FQ,description:NQ,type:RQ,required:jQ,properties:MQ,additionalProperties:UQ};var WE={};Object.defineProperty(WE,"__esModule",{value:!0});const oI=JC;oI.code='require("ajv/dist/runtime/uri").default';WE.default=oI;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;var e=Hs;Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return e.KeywordCxt}});var r=Tt;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return r.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return r.CodeGen}});const n=hy,s=yy,i=Xl,o=vi,a=Tt,c=On,l=py,u=Ut,d=KQ,h=WE,f=(M,k)=>new RegExp(M,k);f.code="new RegExp";const p=["removeAdditional","useDefaults","coerceTypes"],y=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),b={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},w={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},g=200;function v(M){var k,H,U,$,T,z,ne,ue,ye,_e,Se,We,te,se,ce,K,C,B,X,ae,ge,be,Ne,Oe,W;const J=M.strict,he=(k=M.code)===null||k===void 0?void 0:k.optimize,we=he===!0||he===void 0?1:he||0,Ce=(U=(H=M.code)===null||H===void 0?void 0:H.regExp)!==null&&U!==void 0?U:f,Mt=($=M.uriResolver)!==null&&$!==void 0?$:h.default;return{strictSchema:(z=(T=M.strictSchema)!==null&&T!==void 0?T:J)!==null&&z!==void 0?z:!0,strictNumbers:(ue=(ne=M.strictNumbers)!==null&&ne!==void 0?ne:J)!==null&&ue!==void 0?ue:!0,strictTypes:(_e=(ye=M.strictTypes)!==null&&ye!==void 0?ye:J)!==null&&_e!==void 0?_e:"log",strictTuples:(We=(Se=M.strictTuples)!==null&&Se!==void 0?Se:J)!==null&&We!==void 0?We:"log",strictRequired:(se=(te=M.strictRequired)!==null&&te!==void 0?te:J)!==null&&se!==void 0?se:!1,code:M.code?{...M.code,optimize:we,regExp:Ce}:{optimize:we,regExp:Ce},loopRequired:(ce=M.loopRequired)!==null&&ce!==void 0?ce:g,loopEnum:(K=M.loopEnum)!==null&&K!==void 0?K:g,meta:(C=M.meta)!==null&&C!==void 0?C:!0,messages:(B=M.messages)!==null&&B!==void 0?B:!0,inlineRefs:(X=M.inlineRefs)!==null&&X!==void 0?X:!0,schemaId:(ae=M.schemaId)!==null&&ae!==void 0?ae:"$id",addUsedSchema:(ge=M.addUsedSchema)!==null&&ge!==void 0?ge:!0,validateSchema:(be=M.validateSchema)!==null&&be!==void 0?be:!0,validateFormats:(Ne=M.validateFormats)!==null&&Ne!==void 0?Ne:!0,unicodeRegExp:(Oe=M.unicodeRegExp)!==null&&Oe!==void 0?Oe:!0,int32range:(W=M.int32range)!==null&&W!==void 0?W:!0,uriResolver:Mt}}class m{constructor(k={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,k=this.opts={...k,...v(k)};const{es5:H,lines:U}=this.opts.code;this.scope=new a.ValueScope({scope:{},prefixes:y,es5:H,lines:U}),this.logger=I(k.logger);const $=k.validateFormats;k.validateFormats=!1,this.RULES=(0,i.getRules)(),_.call(this,b,k,"NOT SUPPORTED"),_.call(this,w,k,"DEPRECATED","warn"),this._metaOpts=S.call(this),k.formats&&E.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),k.keywords&&A.call(this,k.keywords),typeof k.meta=="object"&&this.addMetaSchema(k.meta),D.call(this),k.validateFormats=$}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:k,meta:H,schemaId:U}=this.opts;let $=d;U==="id"&&($={...d},$.id=$.$id,delete $.$id),H&&k&&this.addMetaSchema($,$[U],!1)}defaultMeta(){const{meta:k,schemaId:H}=this.opts;return this.opts.defaultMeta=typeof k=="object"?k[H]||k:void 0}validate(k,H){let U;if(typeof k=="string"){if(U=this.getSchema(k),!U)throw new Error(`no schema with key or ref "${k}"`)}else U=this.compile(k);const $=U(H);return"$async"in U||(this.errors=U.errors),$}compile(k,H){const U=this._addSchema(k,H);return U.validate||this._compileSchemaEnv(U)}compileAsync(k,H){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:U}=this.opts;return $.call(this,k,H);async function $(_e,Se){await T.call(this,_e.$schema);const We=this._addSchema(_e,Se);return We.validate||z.call(this,We)}async function T(_e){_e&&!this.getSchema(_e)&&await $.call(this,{$ref:_e},!0)}async function z(_e){try{return this._compileSchemaEnv(_e)}catch(Se){if(!(Se instanceof s.default))throw Se;return ne.call(this,Se),await ue.call(this,Se.missingSchema),z.call(this,_e)}}function ne({missingSchema:_e,missingRef:Se}){if(this.refs[_e])throw new Error(`AnySchema ${_e} is loaded but ${Se} cannot be resolved`)}async function ue(_e){const Se=await ye.call(this,_e);this.refs[_e]||await T.call(this,Se.$schema),this.refs[_e]||this.addSchema(Se,_e,H)}async function ye(_e){const Se=this._loading[_e];if(Se)return Se;try{return await(this._loading[_e]=U(_e))}finally{delete this._loading[_e]}}}addSchema(k,H,U,$=this.opts.validateSchema){if(Array.isArray(k)){for(const z of k)this.addSchema(z,void 0,U,$);return this}let T;if(typeof k=="object"){const{schemaId:z}=this.opts;if(T=k[z],T!==void 0&&typeof T!="string")throw new Error(`schema ${z} must be string`)}return H=(0,c.normalizeId)(H||T),this._checkUnique(H),this.schemas[H]=this._addSchema(k,U,H,$,!0),this}addMetaSchema(k,H,U=this.opts.validateSchema){return this.addSchema(k,H,!0,U),this}validateSchema(k,H){if(typeof k=="boolean")return!0;let U;if(U=k.$schema,U!==void 0&&typeof U!="string")throw new Error("$schema must be a string");if(U=U||this.opts.defaultMeta||this.defaultMeta(),!U)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const $=this.validate(U,k);if(!$&&H){const T="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(T);else throw new Error(T)}return $}getSchema(k){let H;for(;typeof(H=x.call(this,k))=="string";)k=H;if(H===void 0){const{schemaId:U}=this.opts,$=new o.SchemaEnv({schema:{},schemaId:U});if(H=o.resolveSchema.call(this,$,k),!H)return;this.refs[k]=H}return H.validate||this._compileSchemaEnv(H)}removeSchema(k){if(k instanceof RegExp)return this._removeAllSchemas(this.schemas,k),this._removeAllSchemas(this.refs,k),this;switch(typeof k){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const H=x.call(this,k);return typeof H=="object"&&this._cache.delete(H.schema),delete this.schemas[k],delete this.refs[k],this}case"object":{const H=k;this._cache.delete(H);let U=k[this.opts.schemaId];return U&&(U=(0,c.normalizeId)(U),delete this.schemas[U],delete this.refs[U]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(k){for(const H of k)this.addKeyword(H);return this}addKeyword(k,H){let U;if(typeof k=="string")U=k,typeof H=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),H.keyword=U);else if(typeof k=="object"&&H===void 0){if(H=k,U=H.keyword,Array.isArray(U)&&!U.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(j.call(this,U,H),!H)return(0,u.eachItem)(U,T=>F.call(this,T)),this;ee.call(this,H);const $={...H,type:(0,l.getJSONTypes)(H.type),schemaType:(0,l.getJSONTypes)(H.schemaType)};return(0,u.eachItem)(U,$.type.length===0?T=>F.call(this,T,$):T=>$.type.forEach(z=>F.call(this,T,$,z))),this}getKeyword(k){const H=this.RULES.all[k];return typeof H=="object"?H.definition:!!H}removeKeyword(k){const{RULES:H}=this;delete H.keywords[k],delete H.all[k];for(const U of H.rules){const $=U.rules.findIndex(T=>T.keyword===k);$>=0&&U.rules.splice($,1)}return this}addFormat(k,H){return typeof H=="string"&&(H=new RegExp(H)),this.formats[k]=H,this}errorsText(k=this.errors,{separator:H=", ",dataVar:U="data"}={}){return!k||k.length===0?"No errors":k.map($=>`${U}${$.instancePath} ${$.message}`).reduce(($,T)=>$+H+T)}$dataMetaSchema(k,H){const U=this.RULES.all;k=JSON.parse(JSON.stringify(k));for(const $ of H){const T=$.split("/").slice(1);let z=k;for(const ne of T)z=z[ne];for(const ne in U){const ue=U[ne];if(typeof ue!="object")continue;const{$data:ye}=ue.definition,_e=z[ne];ye&&_e&&(z[ne]=Z(_e))}}return k}_removeAllSchemas(k,H){for(const U in k){const $=k[U];(!H||H.test(U))&&(typeof $=="string"?delete k[U]:$&&!$.meta&&(this._cache.delete($.schema),delete k[U]))}}_addSchema(k,H,U,$=this.opts.validateSchema,T=this.opts.addUsedSchema){let z;const{schemaId:ne}=this.opts;if(typeof k=="object")z=k[ne];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof k!="boolean")throw new Error("schema must be object or boolean")}let ue=this._cache.get(k);if(ue!==void 0)return ue;U=(0,c.normalizeId)(z||U);const ye=c.getSchemaRefs.call(this,k,U);return ue=new o.SchemaEnv({schema:k,schemaId:ne,meta:H,baseId:U,localRefs:ye}),this._cache.set(ue.schema,ue),T&&!U.startsWith("#")&&(U&&this._checkUnique(U),this.refs[U]=ue),$&&this.validateSchema(k,!0),ue}_checkUnique(k){if(this.schemas[k]||this.refs[k])throw new Error(`schema with key or id "${k}" already exists`)}_compileSchemaEnv(k){if(k.meta?this._compileMetaSchema(k):o.compileSchema.call(this,k),!k.validate)throw new Error("ajv implementation error");return k.validate}_compileMetaSchema(k){const H=this.opts;this.opts=this._metaOpts;try{o.compileSchema.call(this,k)}finally{this.opts=H}}}t.default=m,m.ValidationError=n.default,m.MissingRefError=s.default;function _(M,k,H,U="error"){for(const $ in M){const T=$;T in k&&this.logger[U](`${H}: option ${$}. ${M[T]}`)}}function x(M){return M=(0,c.normalizeId)(M),this.schemas[M]||this.refs[M]}function D(){const M=this.opts.schemas;if(M)if(Array.isArray(M))this.addSchema(M);else for(const k in M)this.addSchema(M[k],k)}function E(){for(const M in this.opts.formats){const k=this.opts.formats[M];k&&this.addFormat(M,k)}}function A(M){if(Array.isArray(M)){this.addVocabulary(M);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const k in M){const H=M[k];H.keyword||(H.keyword=k),this.addKeyword(H)}}function S(){const M={...this.opts};for(const k of p)delete M[k];return M}const O={log(){},warn(){},error(){}};function I(M){if(M===!1)return O;if(M===void 0)return console;if(M.log&&M.warn&&M.error)return M;throw new Error("logger must implement log, warn and error methods")}const N=/^[a-z_$][a-z0-9_$:-]*$/i;function j(M,k){const{RULES:H}=this;if((0,u.eachItem)(M,U=>{if(H.keywords[U])throw new Error(`Keyword ${U} is already defined`);if(!N.test(U))throw new Error(`Keyword ${U} has invalid name`)}),!!k&&k.$data&&!("code"in k||"validate"in k))throw new Error('$data keyword must have "code" or "validate" function')}function F(M,k,H){var U;const $=k==null?void 0:k.post;if(H&&$)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:T}=this;let z=$?T.post:T.rules.find(({type:ue})=>ue===H);if(z||(z={type:H,rules:[]},T.rules.push(z)),T.keywords[M]=!0,!k)return;const ne={keyword:M,definition:{...k,type:(0,l.getJSONTypes)(k.type),schemaType:(0,l.getJSONTypes)(k.schemaType)}};k.before?V.call(this,z,ne,k.before):z.rules.push(ne),T.all[M]=ne,(U=k.implements)===null||U===void 0||U.forEach(ue=>this.addKeyword(ue))}function V(M,k,H){const U=M.rules.findIndex($=>$.keyword===H);U>=0?M.rules.splice(U,0,k):(M.rules.push(k),this.logger.warn(`rule ${H} is not defined`))}function ee(M){let{metaSchema:k}=M;k!==void 0&&(M.$data&&this.opts.$data&&(k=Z(k)),M.validateSchema=this.compile(k,!0))}const G={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function Z(M){return{anyOf:[M,G]}}})(R8);var JE={},GE={},ZE={};Object.defineProperty(ZE,"__esModule",{value:!0});const LQ={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};ZE.default=LQ;var Yl={};Object.defineProperty(Yl,"__esModule",{value:!0});Yl.callRef=Yl.getValidate=void 0;const qQ=yy,ID=Ct,hi=Tt,Sd=ea,BD=vi,$m=Ut,VQ={keyword:"$ref",schemaType:"string",code(t){const{gen:e,schema:r,it:n}=t,{baseId:s,schemaEnv:i,validateName:o,opts:a,self:c}=n,{root:l}=i;if((r==="#"||r==="#/")&&s===l.baseId)return d();const u=BD.resolveRef.call(c,l,s,r);if(u===void 0)throw new qQ.default(n.opts.uriResolver,s,r);if(u instanceof BD.SchemaEnv)return h(u);return f(u);function d(){if(i===l)return m0(t,o,i,i.$async);const p=e.scopeValue("root",{ref:l});return m0(t,(0,hi._)`${p}.validate`,l,l.$async)}function h(p){const y=aI(t,p);m0(t,y,p,p.$async)}function f(p){const y=e.scopeValue("schema",a.code.source===!0?{ref:p,code:(0,hi.stringify)(p)}:{ref:p}),b=e.name("valid"),w=t.subschema({schema:p,dataTypes:[],schemaPath:hi.nil,topSchemaRef:y,errSchemaPath:r},b);t.mergeEvaluated(w),t.ok(b)}}};function aI(t,e){const{gen:r}=t;return e.validate?r.scopeValue("validate",{ref:e.validate}):(0,hi._)`${r.scopeValue("wrapper",{ref:e})}.validate`}Yl.getValidate=aI;function m0(t,e,r,n){const{gen:s,it:i}=t,{allErrors:o,schemaEnv:a,opts:c}=i,l=c.passContext?Sd.default.this:hi.nil;n?u():d();function u(){if(!a.$async)throw new Error("async schema referenced by sync schema");const p=s.let("valid");s.try(()=>{s.code((0,hi._)`await ${(0,ID.callValidateCode)(t,e,l)}`),f(e),o||s.assign(p,!0)},y=>{s.if((0,hi._)`!(${y} instanceof ${i.ValidationError})`,()=>s.throw(y)),h(y),o||s.assign(p,!1)}),t.ok(p)}function d(){t.result((0,ID.callValidateCode)(t,e,l),()=>f(e),()=>h(e))}function h(p){const y=(0,hi._)`${p}.errors`;s.assign(Sd.default.vErrors,(0,hi._)`${Sd.default.vErrors} === null ? ${y} : ${Sd.default.vErrors}.concat(${y})`),s.assign(Sd.default.errors,(0,hi._)`${Sd.default.vErrors}.length`)}function f(p){var y;if(!i.opts.unevaluated)return;const b=(y=r==null?void 0:r.validate)===null||y===void 0?void 0:y.evaluated;if(i.props!==!0)if(b&&!b.dynamicProps)b.props!==void 0&&(i.props=$m.mergeEvaluated.props(s,b.props,i.props));else{const w=s.var("props",(0,hi._)`${p}.evaluated.props`);i.props=$m.mergeEvaluated.props(s,w,i.props,hi.Name)}if(i.items!==!0)if(b&&!b.dynamicItems)b.items!==void 0&&(i.items=$m.mergeEvaluated.items(s,b.items,i.items));else{const w=s.var("items",(0,hi._)`${p}.evaluated.items`);i.items=$m.mergeEvaluated.items(s,w,i.items,hi.Name)}}}Yl.callRef=m0;Yl.default=VQ;Object.defineProperty(GE,"__esModule",{value:!0});const zQ=ZE,HQ=Yl,WQ=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",zQ.default,HQ.default];GE.default=WQ;var XE={},YE={};Object.defineProperty(YE,"__esModule",{value:!0});const tg=Tt,xu=tg.operators,rg={maximum:{okStr:"<=",ok:xu.LTE,fail:xu.GT},minimum:{okStr:">=",ok:xu.GTE,fail:xu.LT},exclusiveMaximum:{okStr:"<",ok:xu.LT,fail:xu.GTE},exclusiveMinimum:{okStr:">",ok:xu.GT,fail:xu.LTE}},JQ={message:({keyword:t,schemaCode:e})=>(0,tg.str)`must be ${rg[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,tg._)`{comparison: ${rg[t].okStr}, limit: ${e}}`},GQ={keyword:Object.keys(rg),type:"number",schemaType:"number",$data:!0,error:JQ,code(t){const{keyword:e,data:r,schemaCode:n}=t;t.fail$data((0,tg._)`${r} ${rg[e].fail} ${n} || isNaN(${r})`)}};YE.default=GQ;var QE={};Object.defineProperty(QE,"__esModule",{value:!0});const dh=Tt,ZQ={message:({schemaCode:t})=>(0,dh.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,dh._)`{multipleOf: ${t}}`},XQ={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:ZQ,code(t){const{gen:e,data:r,schemaCode:n,it:s}=t,i=s.opts.multipleOfPrecision,o=e.let("res"),a=i?(0,dh._)`Math.abs(Math.round(${o}) - ${o}) > 1e-${i}`:(0,dh._)`${o} !== parseInt(${o})`;t.fail$data((0,dh._)`(${n} === 0 || (${o} = ${r}/${n}, ${a}))`)}};QE.default=XQ;var e2={},t2={};Object.defineProperty(t2,"__esModule",{value:!0});function uI(t){const e=t.length;let r=0,n=0,s;for(;n<e;)r++,s=t.charCodeAt(n++),s>=55296&&s<=56319&&n<e&&(s=t.charCodeAt(n),(s&64512)===56320&&n++);return r}t2.default=uI;uI.code='require("ajv/dist/runtime/ucs2length").default';Object.defineProperty(e2,"__esModule",{value:!0});const gl=Tt,YQ=Ut,QQ=t2,eee={message({keyword:t,schemaCode:e}){const r=t==="maxLength"?"more":"fewer";return(0,gl.str)`must NOT have ${r} than ${e} characters`},params:({schemaCode:t})=>(0,gl._)`{limit: ${t}}`},tee={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:eee,code(t){const{keyword:e,data:r,schemaCode:n,it:s}=t,i=e==="maxLength"?gl.operators.GT:gl.operators.LT,o=s.opts.unicode===!1?(0,gl._)`${r}.length`:(0,gl._)`${(0,YQ.useFunc)(t.gen,QQ.default)}(${r})`;t.fail$data((0,gl._)`${o} ${i} ${n}`)}};e2.default=tee;var r2={};Object.defineProperty(r2,"__esModule",{value:!0});const ree=Ct,ng=Tt,nee={message:({schemaCode:t})=>(0,ng.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,ng._)`{pattern: ${t}}`},iee={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:nee,code(t){const{data:e,$data:r,schema:n,schemaCode:s,it:i}=t,o=i.opts.unicodeRegExp?"u":"",a=r?(0,ng._)`(new RegExp(${s}, ${o}))`:(0,ree.usePattern)(t,n);t.fail$data((0,ng._)`!${a}.test(${e})`)}};r2.default=iee;var n2={};Object.defineProperty(n2,"__esModule",{value:!0});const fh=Tt,see={message({keyword:t,schemaCode:e}){const r=t==="maxProperties"?"more":"fewer";return(0,fh.str)`must NOT have ${r} than ${e} properties`},params:({schemaCode:t})=>(0,fh._)`{limit: ${t}}`},oee={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:see,code(t){const{keyword:e,data:r,schemaCode:n}=t,s=e==="maxProperties"?fh.operators.GT:fh.operators.LT;t.fail$data((0,fh._)`Object.keys(${r}).length ${s} ${n}`)}};n2.default=oee;var i2={};Object.defineProperty(i2,"__esModule",{value:!0});const _p=Ct,ph=Tt,aee=Ut,uee={message:({params:{missingProperty:t}})=>(0,ph.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,ph._)`{missingProperty: ${t}}`},cee={keyword:"required",type:"object",schemaType:"array",$data:!0,error:uee,code(t){const{gen:e,schema:r,schemaCode:n,data:s,$data:i,it:o}=t,{opts:a}=o;if(!i&&r.length===0)return;const c=r.length>=a.loopRequired;if(o.allErrors?l():u(),a.strictRequired){const f=t.parentSchema.properties,{definedProperties:p}=t.it;for(const y of r)if((f==null?void 0:f[y])===void 0&&!p.has(y)){const b=o.schemaEnv.baseId+o.errSchemaPath,w=`required property "${y}" is not defined at "${b}" (strictRequired)`;(0,aee.checkStrictMode)(o,w,o.opts.strictRequired)}}function l(){if(c||i)t.block$data(ph.nil,d);else for(const f of r)(0,_p.checkReportMissingProp)(t,f)}function u(){const f=e.let("missing");if(c||i){const p=e.let("valid",!0);t.block$data(p,()=>h(f,p)),t.ok(p)}else e.if((0,_p.checkMissingProp)(t,r,f)),(0,_p.reportMissingProp)(t,f),e.else()}function d(){e.forOf("prop",n,f=>{t.setParams({missingProperty:f}),e.if((0,_p.noPropertyInData)(e,s,f,a.ownProperties),()=>t.error())})}function h(f,p){t.setParams({missingProperty:f}),e.forOf(f,n,()=>{e.assign(p,(0,_p.propertyInData)(e,s,f,a.ownProperties)),e.if((0,ph.not)(p),()=>{t.error(),e.break()})},ph.nil)}}};i2.default=cee;var s2={};Object.defineProperty(s2,"__esModule",{value:!0});const hh=Tt,lee={message({keyword:t,schemaCode:e}){const r=t==="maxItems"?"more":"fewer";return(0,hh.str)`must NOT have ${r} than ${e} items`},params:({schemaCode:t})=>(0,hh._)`{limit: ${t}}`},dee={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:lee,code(t){const{keyword:e,data:r,schemaCode:n}=t,s=e==="maxItems"?hh.operators.GT:hh.operators.LT;t.fail$data((0,hh._)`${r}.length ${s} ${n}`)}};s2.default=dee;var o2={};Object.defineProperty(o2,"__esModule",{value:!0});const Ww=py,Dn=Tt,fee=Ut,pee=ry,hee={message:({params:{i:t,j:e}})=>(0,Dn.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,Dn._)`{i: ${t}, j: ${e}}`},yee={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:hee,code(t){const{gen:e,data:r,$data:n,schema:s,parentSchema:i,schemaCode:o,it:a}=t;if(!n&&!s)return;const c=e.let("valid"),l=i.items?(0,Ww.getSchemaTypes)(i.items):[];t.block$data(c,u,(0,Dn._)`${o} === false`),t.ok(c);function u(){const p=e.let("i",(0,Dn._)`${r}.length`),y=e.let("j");t.setParams({i:p,j:y}),e.assign(c,!0),e.if((0,Dn._)`${p} > 1`,()=>(d()?h:f)(p,y))}function d(){return l.length>0&&!l.some(p=>p==="object"||p==="array")}function h(p,y){const b=e.name("item"),w=(0,Ww.checkDataTypes)(l,b,a.opts.strictNumbers,Ww.DataType.Wrong),g=e.const("indices",(0,Dn._)`{}`);e.for((0,Dn._)`;${p}--;`,()=>{e.let(b,(0,Dn._)`${r}[${p}]`),e.if(w,(0,Dn._)`continue`),l.length>1&&e.if((0,Dn._)`typeof ${b} == "string"`,(0,Dn._)`${b} += "_"`),e.if((0,Dn._)`typeof ${g}[${b}] == "number"`,()=>{e.assign(y,(0,Dn._)`${g}[${b}]`),t.error(),e.assign(c,!1).break()}).code((0,Dn._)`${g}[${b}] = ${p}`)})}function f(p,y){const b=(0,fee.useFunc)(e,pee.default),w=e.name("outer");e.label(w).for((0,Dn._)`;${p}--;`,()=>e.for((0,Dn._)`${y} = ${p}; ${y}--;`,()=>e.if((0,Dn._)`${b}(${r}[${p}], ${r}[${y}])`,()=>{t.error(),e.assign(c,!1).break(w)})))}}};o2.default=yee;var a2={};Object.defineProperty(a2,"__esModule",{value:!0});const b1=Tt,mee=Ut,gee=ry,vee={message:"must be equal to constant",params:({schemaCode:t})=>(0,b1._)`{allowedValue: ${t}}`},wee={keyword:"const",$data:!0,error:vee,code(t){const{gen:e,data:r,$data:n,schemaCode:s,schema:i}=t;n||i&&typeof i=="object"?t.fail$data((0,b1._)`!${(0,mee.useFunc)(e,gee.default)}(${r}, ${s})`):t.fail((0,b1._)`${i} !== ${r}`)}};a2.default=wee;var u2={};Object.defineProperty(u2,"__esModule",{value:!0});const Wp=Tt,bee=Ut,_ee=ry,Eee={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,Wp._)`{allowedValues: ${t}}`},Aee={keyword:"enum",schemaType:"array",$data:!0,error:Eee,code(t){const{gen:e,data:r,$data:n,schema:s,schemaCode:i,it:o}=t;if(!n&&s.length===0)throw new Error("enum must have non-empty array");const a=s.length>=o.opts.loopEnum;let c;const l=()=>c??(c=(0,bee.useFunc)(e,_ee.default));let u;if(a||n)u=e.let("valid"),t.block$data(u,d);else{if(!Array.isArray(s))throw new Error("ajv implementation error");const f=e.const("vSchema",i);u=(0,Wp.or)(...s.map((p,y)=>h(f,y)))}t.pass(u);function d(){e.assign(u,!1),e.forOf("v",i,f=>e.if((0,Wp._)`${l()}(${r}, ${f})`,()=>e.assign(u,!0).break()))}function h(f,p){const y=s[p];return typeof y=="object"&&y!==null?(0,Wp._)`${l()}(${r}, ${f}[${p}])`:(0,Wp._)`${r} === ${y}`}}};u2.default=Aee;Object.defineProperty(XE,"__esModule",{value:!0});const See=YE,$ee=QE,xee=e2,Dee=r2,Pee=n2,Cee=i2,kee=s2,Oee=o2,Tee=a2,Iee=u2,Bee=[See.default,$ee.default,xee.default,Dee.default,Pee.default,Cee.default,kee.default,Oee.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},Tee.default,Iee.default];XE.default=Bee;var c2={},Sf={};Object.defineProperty(Sf,"__esModule",{value:!0});Sf.validateAdditionalItems=void 0;const vl=Tt,_1=Ut,Fee={message:({params:{len:t}})=>(0,vl.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,vl._)`{limit: ${t}}`},Nee={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:Fee,code(t){const{parentSchema:e,it:r}=t,{items:n}=e;if(!Array.isArray(n)){(0,_1.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}cI(t,n)}};function cI(t,e){const{gen:r,schema:n,data:s,keyword:i,it:o}=t;o.items=!0;const a=r.const("len",(0,vl._)`${s}.length`);if(n===!1)t.setParams({len:e.length}),t.pass((0,vl._)`${a} <= ${e.length}`);else if(typeof n=="object"&&!(0,_1.alwaysValidSchema)(o,n)){const l=r.var("valid",(0,vl._)`${a} <= ${e.length}`);r.if((0,vl.not)(l),()=>c(l)),t.ok(l)}function c(l){r.forRange("i",e.length,a,u=>{t.subschema({keyword:i,dataProp:u,dataPropType:_1.Type.Num},l),o.allErrors||r.if((0,vl.not)(l),()=>r.break())})}}Sf.validateAdditionalItems=cI;Sf.default=Nee;var l2={},$f={};Object.defineProperty($f,"__esModule",{value:!0});$f.validateTuple=void 0;const FD=Tt,g0=Ut,Ree=Ct,jee={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){const{schema:e,it:r}=t;if(Array.isArray(e))return lI(t,"additionalItems",e);r.items=!0,!(0,g0.alwaysValidSchema)(r,e)&&t.ok((0,Ree.validateArray)(t))}};function lI(t,e,r=t.schema){const{gen:n,parentSchema:s,data:i,keyword:o,it:a}=t;u(s),a.opts.unevaluated&&r.length&&a.items!==!0&&(a.items=g0.mergeEvaluated.items(n,r.length,a.items));const c=n.name("valid"),l=n.const("len",(0,FD._)`${i}.length`);r.forEach((d,h)=>{(0,g0.alwaysValidSchema)(a,d)||(n.if((0,FD._)`${l} > ${h}`,()=>t.subschema({keyword:o,schemaProp:h,dataProp:h},c)),t.ok(c))});function u(d){const{opts:h,errSchemaPath:f}=a,p=r.length,y=p===d.minItems&&(p===d.maxItems||d[e]===!1);if(h.strictTuples&&!y){const b=`"${o}" is ${p}-tuple, but minItems or maxItems/${e} are not specified or different at path "${f}"`;(0,g0.checkStrictMode)(a,b,h.strictTuples)}}}$f.validateTuple=lI;$f.default=jee;Object.defineProperty(l2,"__esModule",{value:!0});const Mee=$f,Uee={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,Mee.validateTuple)(t,"items")};l2.default=Uee;var d2={};Object.defineProperty(d2,"__esModule",{value:!0});const ND=Tt,Kee=Ut,Lee=Ct,qee=Sf,Vee={message:({params:{len:t}})=>(0,ND.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,ND._)`{limit: ${t}}`},zee={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:Vee,code(t){const{schema:e,parentSchema:r,it:n}=t,{prefixItems:s}=r;n.items=!0,!(0,Kee.alwaysValidSchema)(n,e)&&(s?(0,qee.validateAdditionalItems)(t,s):t.ok((0,Lee.validateArray)(t)))}};d2.default=zee;var f2={};Object.defineProperty(f2,"__esModule",{value:!0});const cs=Tt,xm=Ut,Hee={message:({params:{min:t,max:e}})=>e===void 0?(0,cs.str)`must contain at least ${t} valid item(s)`:(0,cs.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,cs._)`{minContains: ${t}}`:(0,cs._)`{minContains: ${t}, maxContains: ${e}}`},Wee={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:Hee,code(t){const{gen:e,schema:r,parentSchema:n,data:s,it:i}=t;let o,a;const{minContains:c,maxContains:l}=n;i.opts.next?(o=c===void 0?1:c,a=l):o=1;const u=e.const("len",(0,cs._)`${s}.length`);if(t.setParams({min:o,max:a}),a===void 0&&o===0){(0,xm.checkStrictMode)(i,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&o>a){(0,xm.checkStrictMode)(i,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,xm.alwaysValidSchema)(i,r)){let y=(0,cs._)`${u} >= ${o}`;a!==void 0&&(y=(0,cs._)`${y} && ${u} <= ${a}`),t.pass(y);return}i.items=!0;const d=e.name("valid");a===void 0&&o===1?f(d,()=>e.if(d,()=>e.break())):o===0?(e.let(d,!0),a!==void 0&&e.if((0,cs._)`${s}.length > 0`,h)):(e.let(d,!1),h()),t.result(d,()=>t.reset());function h(){const y=e.name("_valid"),b=e.let("count",0);f(y,()=>e.if(y,()=>p(b)))}function f(y,b){e.forRange("i",0,u,w=>{t.subschema({keyword:"contains",dataProp:w,dataPropType:xm.Type.Num,compositeRule:!0},y),b()})}function p(y){e.code((0,cs._)`${y}++`),a===void 0?e.if((0,cs._)`${y} >= ${o}`,()=>e.assign(d,!0).break()):(e.if((0,cs._)`${y} > ${a}`,()=>e.assign(d,!1).break()),o===1?e.assign(d,!0):e.if((0,cs._)`${y} >= ${o}`,()=>e.assign(d,!0)))}}};f2.default=Wee;var dI={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.validateSchemaDeps=t.validatePropertyDeps=t.error=void 0;const e=Tt,r=Ut,n=Ct;t.error={message:({params:{property:c,depsCount:l,deps:u}})=>{const d=l===1?"property":"properties";return(0,e.str)`must have ${d} ${u} when property ${c} is present`},params:({params:{property:c,depsCount:l,deps:u,missingProperty:d}})=>(0,e._)`{property: ${c},
    missingProperty: ${d},
    depsCount: ${l},
    deps: ${u}}`};const s={keyword:"dependencies",type:"object",schemaType:"object",error:t.error,code(c){const[l,u]=i(c);o(c,l),a(c,u)}};function i({schema:c}){const l={},u={};for(const d in c){if(d==="__proto__")continue;const h=Array.isArray(c[d])?l:u;h[d]=c[d]}return[l,u]}function o(c,l=c.schema){const{gen:u,data:d,it:h}=c;if(Object.keys(l).length===0)return;const f=u.let("missing");for(const p in l){const y=l[p];if(y.length===0)continue;const b=(0,n.propertyInData)(u,d,p,h.opts.ownProperties);c.setParams({property:p,depsCount:y.length,deps:y.join(", ")}),h.allErrors?u.if(b,()=>{for(const w of y)(0,n.checkReportMissingProp)(c,w)}):(u.if((0,e._)`${b} && (${(0,n.checkMissingProp)(c,y,f)})`),(0,n.reportMissingProp)(c,f),u.else())}}t.validatePropertyDeps=o;function a(c,l=c.schema){const{gen:u,data:d,keyword:h,it:f}=c,p=u.name("valid");for(const y in l)(0,r.alwaysValidSchema)(f,l[y])||(u.if((0,n.propertyInData)(u,d,y,f.opts.ownProperties),()=>{const b=c.subschema({keyword:h,schemaProp:y},p);c.mergeValidEvaluated(b,p)},()=>u.var(p,!0)),c.ok(p))}t.validateSchemaDeps=a,t.default=s})(dI);var p2={};Object.defineProperty(p2,"__esModule",{value:!0});const fI=Tt,Jee=Ut,Gee={message:"property name must be valid",params:({params:t})=>(0,fI._)`{propertyName: ${t.propertyName}}`},Zee={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:Gee,code(t){const{gen:e,schema:r,data:n,it:s}=t;if((0,Jee.alwaysValidSchema)(s,r))return;const i=e.name("valid");e.forIn("key",n,o=>{t.setParams({propertyName:o}),t.subschema({keyword:"propertyNames",data:o,dataTypes:["string"],propertyName:o,compositeRule:!0},i),e.if((0,fI.not)(i),()=>{t.error(!0),s.allErrors||e.break()})}),t.ok(i)}};p2.default=Zee;var tv={};Object.defineProperty(tv,"__esModule",{value:!0});const Dm=Ct,Is=Tt,Xee=ea,Pm=Ut,Yee={message:"must NOT have additional properties",params:({params:t})=>(0,Is._)`{additionalProperty: ${t.additionalProperty}}`},Qee={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:Yee,code(t){const{gen:e,schema:r,parentSchema:n,data:s,errsCount:i,it:o}=t;if(!i)throw new Error("ajv implementation error");const{allErrors:a,opts:c}=o;if(o.props=!0,c.removeAdditional!=="all"&&(0,Pm.alwaysValidSchema)(o,r))return;const l=(0,Dm.allSchemaProperties)(n.properties),u=(0,Dm.allSchemaProperties)(n.patternProperties);d(),t.ok((0,Is._)`${i} === ${Xee.default.errors}`);function d(){e.forIn("key",s,b=>{!l.length&&!u.length?p(b):e.if(h(b),()=>p(b))})}function h(b){let w;if(l.length>8){const g=(0,Pm.schemaRefOrVal)(o,n.properties,"properties");w=(0,Dm.isOwnProperty)(e,g,b)}else l.length?w=(0,Is.or)(...l.map(g=>(0,Is._)`${b} === ${g}`)):w=Is.nil;return u.length&&(w=(0,Is.or)(w,...u.map(g=>(0,Is._)`${(0,Dm.usePattern)(t,g)}.test(${b})`))),(0,Is.not)(w)}function f(b){e.code((0,Is._)`delete ${s}[${b}]`)}function p(b){if(c.removeAdditional==="all"||c.removeAdditional&&r===!1){f(b);return}if(r===!1){t.setParams({additionalProperty:b}),t.error(),a||e.break();return}if(typeof r=="object"&&!(0,Pm.alwaysValidSchema)(o,r)){const w=e.name("valid");c.removeAdditional==="failing"?(y(b,w,!1),e.if((0,Is.not)(w),()=>{t.reset(),f(b)})):(y(b,w),a||e.if((0,Is.not)(w),()=>e.break()))}}function y(b,w,g){const v={keyword:"additionalProperties",dataProp:b,dataPropType:Pm.Type.Str};g===!1&&Object.assign(v,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema(v,w)}}};tv.default=Qee;var h2={};Object.defineProperty(h2,"__esModule",{value:!0});const ete=Hs,RD=Ct,Jw=Ut,jD=tv,tte={keyword:"properties",type:"object",schemaType:"object",code(t){const{gen:e,schema:r,parentSchema:n,data:s,it:i}=t;i.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&jD.default.code(new ete.KeywordCxt(i,jD.default,"additionalProperties"));const o=(0,RD.allSchemaProperties)(r);for(const d of o)i.definedProperties.add(d);i.opts.unevaluated&&o.length&&i.props!==!0&&(i.props=Jw.mergeEvaluated.props(e,(0,Jw.toHash)(o),i.props));const a=o.filter(d=>!(0,Jw.alwaysValidSchema)(i,r[d]));if(a.length===0)return;const c=e.name("valid");for(const d of a)l(d)?u(d):(e.if((0,RD.propertyInData)(e,s,d,i.opts.ownProperties)),u(d),i.allErrors||e.else().var(c,!0),e.endIf()),t.it.definedProperties.add(d),t.ok(c);function l(d){return i.opts.useDefaults&&!i.compositeRule&&r[d].default!==void 0}function u(d){t.subschema({keyword:"properties",schemaProp:d,dataProp:d},c)}}};h2.default=tte;var y2={};Object.defineProperty(y2,"__esModule",{value:!0});const MD=Ct,Cm=Tt,UD=Ut,KD=Ut,rte={keyword:"patternProperties",type:"object",schemaType:"object",code(t){const{gen:e,schema:r,data:n,parentSchema:s,it:i}=t,{opts:o}=i,a=(0,MD.allSchemaProperties)(r),c=a.filter(y=>(0,UD.alwaysValidSchema)(i,r[y]));if(a.length===0||c.length===a.length&&(!i.opts.unevaluated||i.props===!0))return;const l=o.strictSchema&&!o.allowMatchingProperties&&s.properties,u=e.name("valid");i.props!==!0&&!(i.props instanceof Cm.Name)&&(i.props=(0,KD.evaluatedPropsToName)(e,i.props));const{props:d}=i;h();function h(){for(const y of a)l&&f(y),i.allErrors?p(y):(e.var(u,!0),p(y),e.if(u))}function f(y){for(const b in l)new RegExp(y).test(b)&&(0,UD.checkStrictMode)(i,`property ${b} matches pattern ${y} (use allowMatchingProperties)`)}function p(y){e.forIn("key",n,b=>{e.if((0,Cm._)`${(0,MD.usePattern)(t,y)}.test(${b})`,()=>{const w=c.includes(y);w||t.subschema({keyword:"patternProperties",schemaProp:y,dataProp:b,dataPropType:KD.Type.Str},u),i.opts.unevaluated&&d!==!0?e.assign((0,Cm._)`${d}[${b}]`,!0):!w&&!i.allErrors&&e.if((0,Cm.not)(u),()=>e.break())})})}}};y2.default=rte;var m2={};Object.defineProperty(m2,"__esModule",{value:!0});const nte=Ut,ite={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){const{gen:e,schema:r,it:n}=t;if((0,nte.alwaysValidSchema)(n,r)){t.fail();return}const s=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},s),t.failResult(s,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};m2.default=ite;var g2={};Object.defineProperty(g2,"__esModule",{value:!0});const ste=Ct,ote={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:ste.validateUnion,error:{message:"must match a schema in anyOf"}};g2.default=ote;var v2={};Object.defineProperty(v2,"__esModule",{value:!0});const v0=Tt,ate=Ut,ute={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,v0._)`{passingSchemas: ${t.passing}}`},cte={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:ute,code(t){const{gen:e,schema:r,parentSchema:n,it:s}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(s.opts.discriminator&&n.discriminator)return;const i=r,o=e.let("valid",!1),a=e.let("passing",null),c=e.name("_valid");t.setParams({passing:a}),e.block(l),t.result(o,()=>t.reset(),()=>t.error(!0));function l(){i.forEach((u,d)=>{let h;(0,ate.alwaysValidSchema)(s,u)?e.var(c,!0):h=t.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},c),d>0&&e.if((0,v0._)`${c} && ${o}`).assign(o,!1).assign(a,(0,v0._)`[${a}, ${d}]`).else(),e.if(c,()=>{e.assign(o,!0),e.assign(a,d),h&&t.mergeEvaluated(h,v0.Name)})})}}};v2.default=cte;var w2={};Object.defineProperty(w2,"__esModule",{value:!0});const lte=Ut,dte={keyword:"allOf",schemaType:"array",code(t){const{gen:e,schema:r,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");const s=e.name("valid");r.forEach((i,o)=>{if((0,lte.alwaysValidSchema)(n,i))return;const a=t.subschema({keyword:"allOf",schemaProp:o},s);t.ok(s),t.mergeEvaluated(a)})}};w2.default=dte;var b2={};Object.defineProperty(b2,"__esModule",{value:!0});const ig=Tt,pI=Ut,fte={message:({params:t})=>(0,ig.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,ig._)`{failingKeyword: ${t.ifClause}}`},pte={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:fte,code(t){const{gen:e,parentSchema:r,it:n}=t;r.then===void 0&&r.else===void 0&&(0,pI.checkStrictMode)(n,'"if" without "then" and "else" is ignored');const s=LD(n,"then"),i=LD(n,"else");if(!s&&!i)return;const o=e.let("valid",!0),a=e.name("_valid");if(c(),t.reset(),s&&i){const u=e.let("ifClause");t.setParams({ifClause:u}),e.if(a,l("then",u),l("else",u))}else s?e.if(a,l("then")):e.if((0,ig.not)(a),l("else"));t.pass(o,()=>t.error(!0));function c(){const u=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(u)}function l(u,d){return()=>{const h=t.subschema({keyword:u},a);e.assign(o,a),t.mergeValidEvaluated(h,o),d?e.assign(d,(0,ig._)`${u}`):t.setParams({ifClause:u})}}}};function LD(t,e){const r=t.schema[e];return r!==void 0&&!(0,pI.alwaysValidSchema)(t,r)}b2.default=pte;var _2={};Object.defineProperty(_2,"__esModule",{value:!0});const hte=Ut,yte={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:r}){e.if===void 0&&(0,hte.checkStrictMode)(r,`"${t}" without "if" is ignored`)}};_2.default=yte;Object.defineProperty(c2,"__esModule",{value:!0});const mte=Sf,gte=l2,vte=$f,wte=d2,bte=f2,_te=dI,Ete=p2,Ate=tv,Ste=h2,$te=y2,xte=m2,Dte=g2,Pte=v2,Cte=w2,kte=b2,Ote=_2;function Tte(t=!1){const e=[xte.default,Dte.default,Pte.default,Cte.default,kte.default,Ote.default,Ete.default,Ate.default,_te.default,Ste.default,$te.default];return t?e.push(gte.default,wte.default):e.push(mte.default,vte.default),e.push(bte.default),e}c2.default=Tte;var E2={},A2={};Object.defineProperty(A2,"__esModule",{value:!0});const Ir=Tt,Ite={message:({schemaCode:t})=>(0,Ir.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,Ir._)`{format: ${t}}`},Bte={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:Ite,code(t,e){const{gen:r,data:n,$data:s,schema:i,schemaCode:o,it:a}=t,{opts:c,errSchemaPath:l,schemaEnv:u,self:d}=a;if(!c.validateFormats)return;s?h():f();function h(){const p=r.scopeValue("formats",{ref:d.formats,code:c.code.formats}),y=r.const("fDef",(0,Ir._)`${p}[${o}]`),b=r.let("fType"),w=r.let("format");r.if((0,Ir._)`typeof ${y} == "object" && !(${y} instanceof RegExp)`,()=>r.assign(b,(0,Ir._)`${y}.type || "string"`).assign(w,(0,Ir._)`${y}.validate`),()=>r.assign(b,(0,Ir._)`"string"`).assign(w,y)),t.fail$data((0,Ir.or)(g(),v()));function g(){return c.strictSchema===!1?Ir.nil:(0,Ir._)`${o} && !${w}`}function v(){const m=u.$async?(0,Ir._)`(${y}.async ? await ${w}(${n}) : ${w}(${n}))`:(0,Ir._)`${w}(${n})`,_=(0,Ir._)`(typeof ${w} == "function" ? ${m} : ${w}.test(${n}))`;return(0,Ir._)`${w} && ${w} !== true && ${b} === ${e} && !${_}`}}function f(){const p=d.formats[i];if(!p){g();return}if(p===!0)return;const[y,b,w]=v(p);y===e&&t.pass(m());function g(){if(c.strictSchema===!1){d.logger.warn(_());return}throw new Error(_());function _(){return`unknown format "${i}" ignored in schema at path "${l}"`}}function v(_){const x=_ instanceof RegExp?(0,Ir.regexpCode)(_):c.code.formats?(0,Ir._)`${c.code.formats}${(0,Ir.getProperty)(i)}`:void 0,D=r.scopeValue("formats",{key:i,ref:_,code:x});return typeof _=="object"&&!(_ instanceof RegExp)?[_.type||"string",_.validate,(0,Ir._)`${D}.validate`]:["string",_,D]}function m(){if(typeof p=="object"&&!(p instanceof RegExp)&&p.async){if(!u.$async)throw new Error("async format in sync schema");return(0,Ir._)`await ${w}(${n})`}return typeof b=="function"?(0,Ir._)`${w}(${n})`:(0,Ir._)`${w}.test(${n})`}}}};A2.default=Bte;Object.defineProperty(E2,"__esModule",{value:!0});const Fte=A2,Nte=[Fte.default];E2.default=Nte;var df={};Object.defineProperty(df,"__esModule",{value:!0});df.contentVocabulary=df.metadataVocabulary=void 0;df.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];df.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"];Object.defineProperty(JE,"__esModule",{value:!0});const Rte=GE,jte=XE,Mte=c2,Ute=E2,qD=df,Kte=[Rte.default,jte.default,(0,Mte.default)(),Ute.default,qD.metadataVocabulary,qD.contentVocabulary];JE.default=Kte;var S2={},hI={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DiscrError=void 0,function(e){e.Tag="tag",e.Mapping="mapping"}(t.DiscrError||(t.DiscrError={}))})(hI);Object.defineProperty(S2,"__esModule",{value:!0});const Id=Tt,E1=hI,VD=vi,Lte=Ut,qte={message:({params:{discrError:t,tagName:e}})=>t===E1.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:r}})=>(0,Id._)`{error: ${t}, tag: ${r}, tagValue: ${e}}`},Vte={keyword:"discriminator",type:"object",schemaType:"object",error:qte,code(t){const{gen:e,data:r,schema:n,parentSchema:s,it:i}=t,{oneOf:o}=s;if(!i.opts.discriminator)throw new Error("discriminator: requires discriminator option");const a=n.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!o)throw new Error("discriminator: requires oneOf keyword");const c=e.let("valid",!1),l=e.const("tag",(0,Id._)`${r}${(0,Id.getProperty)(a)}`);e.if((0,Id._)`typeof ${l} == "string"`,()=>u(),()=>t.error(!1,{discrError:E1.DiscrError.Tag,tag:l,tagName:a})),t.ok(c);function u(){const f=h();e.if(!1);for(const p in f)e.elseIf((0,Id._)`${l} === ${p}`),e.assign(c,d(f[p]));e.else(),t.error(!1,{discrError:E1.DiscrError.Mapping,tag:l,tagName:a}),e.endIf()}function d(f){const p=e.name("valid"),y=t.subschema({keyword:"oneOf",schemaProp:f},p);return t.mergeEvaluated(y,Id.Name),p}function h(){var f;const p={},y=w(s);let b=!0;for(let m=0;m<o.length;m++){let _=o[m];_!=null&&_.$ref&&!(0,Lte.schemaHasRulesButRef)(_,i.self.RULES)&&(_=VD.resolveRef.call(i.self,i.schemaEnv.root,i.baseId,_==null?void 0:_.$ref),_ instanceof VD.SchemaEnv&&(_=_.schema));const x=(f=_==null?void 0:_.properties)===null||f===void 0?void 0:f[a];if(typeof x!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);b=b&&(y||w(_)),g(x,m)}if(!b)throw new Error(`discriminator: "${a}" must be required`);return p;function w({required:m}){return Array.isArray(m)&&m.includes(a)}function g(m,_){if(m.const)v(m.const,_);else if(m.enum)for(const x of m.enum)v(x,_);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function v(m,_){if(typeof m!="string"||m in p)throw new Error(`discriminator: "${a}" values must be unique strings`);p[m]=_}}}};S2.default=Vte;const zte="http://json-schema.org/draft-07/schema#",Hte="http://json-schema.org/draft-07/schema#",Wte="Core schema meta-schema",Jte={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},Gte=["object","boolean"],Zte={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},Xte={$schema:zte,$id:Hte,title:Wte,definitions:Jte,type:Gte,properties:Zte,default:!0};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.MissingRefError=e.ValidationError=e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;const r=R8,n=JE,s=S2,i=Xte,o=["/properties"],a="http://json-schema.org/draft-07/schema";class c extends r.default{_addVocabularies(){super._addVocabularies(),n.default.forEach(p=>this.addVocabulary(p)),this.opts.discriminator&&this.addKeyword(s.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const p=this.opts.$data?this.$dataMetaSchema(i,o):i;this.addMetaSchema(p,a,!1),this.refs["http://json-schema.org/schema"]=a}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(a)?a:void 0)}}t.exports=e=c,Object.defineProperty(e,"__esModule",{value:!0}),e.default=c;var l=Hs;Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return l.KeywordCxt}});var u=Tt;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return u._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return u.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return u.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return u.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return u.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return u.CodeGen}});var d=hy;Object.defineProperty(e,"ValidationError",{enumerable:!0,get:function(){return d.default}});var h=yy;Object.defineProperty(e,"MissingRefError",{enumerable:!0,get:function(){return h.default}})})(g1,g1.exports);var Yte=g1.exports;const Qte=Jo(Yte);class os extends qo{constructor(r,n,s,i){super(r,n,s);de(this,"validNext",new Set(["quote","close"]));de(this,"kind","rfq");de(this,"metadata");de(this,"data");de(this,"privateData");this.metadata=r,this.data=n,this.privateData=i}static async parse(r,n){const s=Es.rawToMessageModel(r),i=new os(s.metadata,s.data,s.signature,s.privateData);return await i.verify(),n!=null&&n.requireAllPrivateData?i.verifyAllPrivateData():i.verifyPresentPrivateData(),i}validate(){super.validate(),this.privateData!==void 0&&Ah(this.privateData,"rfqPrivate")}static create(r){const n=qo.generateId("rfq"),s={...r.metadata,kind:"rfq",id:n,exchangeId:n,createdAt:new Date().toISOString(),protocol:r.metadata.protocol??"1.0"},{data:i,privateData:o}=os.hashPrivateData(r.data),a=new os(s,i,void 0,o);return a.validateData(),a}static hashPrivateData(r){const n=Bs.uint8Array(Kj(16)).toBase64Url(),{claims:s,payin:i,payout:o,...a}=r,{paymentDetails:c,...l}=i,{paymentDetails:u,...d}=o,h={...a,payin:l,payout:d};return c!==void 0&&(h.payin.paymentDetailsHash=os.digestPrivateData(n,c)),u!==void 0&&(h.payout.paymentDetailsHash=os.digestPrivateData(n,u)),s!==void 0&&(s==null?void 0:s.length)>0&&(h.claimsHash=os.digestPrivateData(n,s)),{data:h,privateData:{salt:n,payin:{paymentDetails:c},payout:{paymentDetails:u},claims:s}}}verifyAllPrivateData(){if(this.privateData===void 0)throw new Error("Could not verify all privateData because privateData property is missing");this.data.payin.paymentDetailsHash!==void 0&&this.verifyPayinDetailsHash(),this.data.payout.paymentDetailsHash!==void 0&&this.verifyPayoutDetailsHash(),this.data.claimsHash!==void 0&&this.verifyClaimsHash()}verifyPresentPrivateData(){var r,n,s,i,o;this.data.payin.paymentDetailsHash!==void 0&&((n=(r=this.privateData)==null?void 0:r.payin)==null?void 0:n.paymentDetails)!==void 0&&this.verifyPayinDetailsHash(),this.data.payout.paymentDetailsHash!==void 0&&((i=(s=this.privateData)==null?void 0:s.payout)==null?void 0:i.paymentDetails)!==void 0&&this.verifyPayoutDetailsHash(),this.data.claimsHash!==void 0&&((o=this.privateData)==null?void 0:o.claims)!==void 0&&this.verifyClaimsHash()}verifyPayinDetailsHash(){var n,s;if(os.digestPrivateData(this.privateData.salt,(s=(n=this.privateData)==null?void 0:n.payin)==null?void 0:s.paymentDetails)!==this.data.payin.paymentDetailsHash)throw new Error("Private data integrity check failed: data.payin.paymentDetailsHash does not match digest of privateData.payin.paymentDetails")}verifyPayoutDetailsHash(){var n,s;if(os.digestPrivateData(this.privateData.salt,(s=(n=this.privateData)==null?void 0:n.payout)==null?void 0:s.paymentDetails)!==this.data.payout.paymentDetailsHash)throw new Error("Private data integrity check failed: data.payout.paymentDetailsHash does not match digest of privateData.payout.paymentDetails")}verifyClaimsHash(){var i;const r=this.data.claimsHash,n=(i=this.privateData)==null?void 0:i.claims;if(os.digestPrivateData(this.privateData.salt,n)!==r)throw new Error("Private data integrity check failed: data.claimsHash does not match digest of privateData.claims")}static digestPrivateData(r,n){const s=[r,n],i=Tl.digest(s);return Bs.uint8Array(i).toBase64Url()}async verifyOfferingRequirements(r){var s,i,o,a;if(r.metadata.protocol!==this.metadata.protocol)throw new Error(`protocol version mismatch. (rfq) ${this.metadata.protocol} !== ${r.metadata.protocol} (offering)`);if(r.metadata.id!==this.data.offeringId)throw new Error(`offering id mismatch. (rfq) ${this.data.offeringId} !== ${r.metadata.id} (offering)`);let n;if(r.data.payin.max){n=Yy(this.data.payin.amount);const c=Yy(r.data.payin.max);if(n.isGreaterThan(c))throw new Error(`rfq payinAmount exceeds offering's maxAmount. (rfq) ${this.data.payin.amount} > ${r.data.payin.max} (offering)`)}if(r.data.payin.min){n??(n=Yy(this.data.payin.amount));const c=Yy(r.data.payin.min);if(n.isLessThan(c))throw new Error(`rfq payinAmount is below offering's minAmount. (rfq) ${this.data.payin.amount} > ${r.data.payin.min} (offering)`)}this.verifyPaymentMethod(this.data.payin.kind,this.data.payin.paymentDetailsHash,(i=(s=this.privateData)==null?void 0:s.payin)==null?void 0:i.paymentDetails,r.data.payin.methods,"payin"),this.verifyPaymentMethod(this.data.payout.kind,this.data.payout.paymentDetailsHash,(a=(o=this.privateData)==null?void 0:o.payout)==null?void 0:a.paymentDetails,r.data.payout.methods,"payout"),await this.verifyClaims(r)}verifyPaymentMethod(r,n,s,i,o){const a=i.filter(u=>u.kind===r);if(!a.length){const u=i.map(d=>d.kind).join(", ");throw new Error(`offering does not support rfq's ${o}Method kind. (rfq) ${r} was not found in: [${u}] (offering)`)}const c=new Qte.default,l=new Set;for(const u of a)if(u.requiredPaymentDetails){const d=c.compile(u.requiredPaymentDetails);if(d(s))return;l.add(d.errors)}else{if(n===void 0)return;l.add(new Error("paymentDetails must be omitted when requiredPaymentDetails is omitted"))}throw new Error(`rfq ${o}Method paymentDetails could not be validated against offering requiredPaymentDetails. Schema validation errors: ${Array.from(l).join()}`)}async verifyClaims(r){var s;if(!r.data.requiredClaims)return;const n=G0.selectCredentials({vcJwts:((s=this.privateData)==null?void 0:s.claims)??[],presentationDefinition:r.data.requiredClaims});if(n.length===0)throw new Error("claims do not fulfill the offering's requirements");for(let i of n)await Q0.verify({vcJwt:i})}toJSON(){const r=super.toJSON();return this.privateData!==void 0&&(r.privateData=this.privateData),r}}class sg extends qo{constructor(r,n,s){super(r,n,s);de(this,"validNext",new Set(["order","close"]));de(this,"kind","quote");de(this,"metadata");de(this,"data");this.metadata=r,this.data=n}static async parse(r){const n=Es.rawToMessageModel(r),s=new sg(n.metadata,n.data,n.signature);return await s.verify(),s}static create(r){const n={...r.metadata,kind:"quote",id:qo.generateId("quote"),createdAt:new Date().toISOString(),protocol:r.metadata.protocol??"1.0"},s=new sg(n,r.data);return s.validateData(),s}}class Uh extends qo{constructor(r,n,s){super(r,n,s);de(this,"validNext",new Set(["orderstatus"]));de(this,"kind","order");de(this,"metadata");de(this,"data");this.metadata=r,this.data=n}static async parse(r){const n=Es.rawToMessageModel(r),s=new Uh(n.metadata,n.data,n.signature);return await s.verify(),s}static create(r){const n={...r.metadata,kind:"order",id:qo.generateId("order"),createdAt:new Date().toISOString(),protocol:r.metadata.protocol??"1.0"},s=new Uh(n,{});return s.validateData(),s}}class og extends qo{constructor(r,n,s){super(r,n,s);de(this,"validNext",new Set(["orderstatus","close"]));de(this,"kind","orderstatus");de(this,"metadata");de(this,"data");this.metadata=r,this.data=n}static async parse(r){const n=Es.rawToMessageModel(r),s=new og(n.metadata,n.data,n.signature);return await s.verify(),s}static create(r){const n={...r.metadata,kind:"orderstatus",id:qo.generateId("orderstatus"),createdAt:new Date().toISOString(),protocol:r.metadata.protocol??"1.0"},s=new og(n,r.data);return s.validateData(),s}get orderStatus(){return this.data.orderStatus}}class ff extends qo{constructor(r,n,s){super(r,n,s);de(this,"validNext",new Set([]));de(this,"kind","close");de(this,"metadata");de(this,"data");this.metadata=r,this.data=n}static async parse(r){const n=Es.rawToMessageModel(r),s=new ff(n.metadata,n.data,n.signature);return await s.verify(),s}static create(r){const n={...r.metadata,kind:"close",id:qo.generateId("close"),createdAt:new Date().toISOString(),protocol:r.metadata.protocol??"1.0"},s=new ff(n,r.data);return s.validateData(),s}get reason(){return this.data.reason}}class Es{constructor(){}static async parseMessage(e){const r=Es.rawToMessageModel(e);let n;switch(r.metadata.kind){case"rfq":n=new os(r.metadata,r.data,r.signature,r.privateData);break;case"quote":n=new sg(r.metadata,r.data,r.signature);break;case"order":n=new Uh(r.metadata,r.data,r.signature);break;case"orderstatus":n=new og(r.metadata,r.data,r.signature);break;case"close":n=new ff(r.metadata,r.data,r.signature);break;default:throw new Error(`Unrecognized message kind (${r.metadata.kind})`)}return await n.verify(),n}static async parseResource(e){const r=Es.rawToResourceModel(e);let n;switch(r.metadata.kind){case"offering":n=new Kh(r.metadata,r.data,r.signature);break;case"balance":n=new ag(r.metadata,r.data,r.signature);break;default:throw new Error(`Unrecognized resource kind (${r.metadata.kind})`)}return await n.verify(),n}static rawToMessageModel(e){try{return typeof e=="string"?JSON.parse(e):e}catch(r){const n=r instanceof Error?r.message:r;throw new Error(`parse: Failed to parse message. Error: ${n}`)}}static rawToResourceModel(e){try{return typeof e=="string"?JSON.parse(e):e}catch(r){const n=r instanceof Error?r.message:r;throw new Error(`parse: Failed to parse resource. Error: ${n}`)}}}class Kh extends T0{constructor(r,n,s){super(r,n,s);de(this,"kind","offering");de(this,"metadata");de(this,"data");this.metadata=r,this.data=n}static async parse(r){const n=Es.rawToResourceModel(r),s=new Kh(n.metadata,n.data,n.signature);return await s.verify(),s}static create(r){const n={...r.metadata,kind:"offering",id:T0.generateId("offering"),createdAt:new Date().toISOString(),protocol:r.metadata.protocol??"1.0"},s=new Kh(n,r.data);return s.validateData(),s}}class ag extends T0{constructor(r,n,s){super(r,n,s);de(this,"kind","balance");de(this,"metadata");de(this,"data");this.metadata=r,this.data=n}static async parse(r){const n=Es.rawToResourceModel(r),s=new ag(n.metadata,n.data,n.signature);return await s.verify(),s}static create(r){const n={...r.metadata,kind:"balance",id:T0.generateId("balance"),createdAt:new Date().toISOString(),protocol:r.metadata.protocol??"1.0"},s=new ag(n,r.data);return s.validateData(),s}}class Ep extends Error{constructor(r){super(r.message,{cause:r.cause});de(this,"recipientDid");de(this,"url");this.name=this.constructor.name,this.recipientDid=r.recipientDid,this.url=r.url}}class Ap extends Error{constructor(r){super();de(this,"statusCode");de(this,"details");de(this,"recipientDid");de(this,"url");this.name=this.constructor.name,this.statusCode=r.statusCode,this.details=r.details,this.recipientDid=r.recipientDid,this.url=r.url}}class yI extends Error{constructor(e){super(e),this.name=this.constructor.name}}class ere extends yI{}class tre extends yI{}class my extends Error{constructor(e){super(e.message,{cause:e.cause}),this.name=this.constructor.name}}class rre extends my{}class nre extends my{}class ire extends my{}class sre extends my{}class ore extends my{}var zD;(function(t){t.authentication="authentication",t.assertionMethod="assertionMethod",t.keyAgreement="keyAgreement",t.capabilityInvocation="capabilityInvocation",t.capabilityDelegation="capabilityDelegation"})(zD||(zD={}));var HD;(function(t){t.InvalidDid="invalidDid",t.MethodNotSupported="methodNotSupported",t.InternalError="internalError",t.InvalidDidDocument="invalidDidDocument",t.InvalidDidDocumentLength="invalidDidDocumentLength",t.InvalidDidUrl="invalidDidUrl",t.InvalidPreviousDidProof="invalidPreviousDidProof",t.InvalidPublicKey="invalidPublicKey",t.InvalidPublicKeyLength="invalidPublicKeyLength",t.InvalidPublicKeyType="invalidPublicKeyType",t.InvalidSignature="invalidSignature",t.NotFound="notFound",t.RepresentationNotSupported="representationNotSupported",t.UnsupportedPublicKeyType="unsupportedPublicKeyType"})(HD||(HD={}));function are(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var y=0,b=0,w=0,g=p.length;w!==g&&p[w]===0;)w++,y++;for(var v=(g-w)*u+1>>>0,m=new Uint8Array(v);w!==g;){for(var _=p[w],x=0,D=v-1;(_!==0||x<b)&&D!==-1;D--,x++)_+=256*m[D]>>>0,m[D]=_%a>>>0,_=_/a>>>0;if(_!==0)throw new Error("Non-zero carry");b=x,w++}for(var E=v-b;E!==v&&m[E]===0;)E++;for(var A=c.repeat(y);E<v;++E)A+=t.charAt(m[E]);return A}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var y=0;if(p[y]!==" "){for(var b=0,w=0;p[y]===c;)b++,y++;for(var g=(p.length-y)*l+1>>>0,v=new Uint8Array(g);p[y];){var m=r[p.charCodeAt(y)];if(m===255)return;for(var _=0,x=g-1;(m!==0||_<w)&&x!==-1;x--,_++)m+=a*v[x]>>>0,v[x]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");w=_,y++}if(p[y]!==" "){for(var D=g-w;D!==g&&v[D]===0;)D++;for(var E=new Uint8Array(b+(g-D)),A=b;D!==g;)E[A++]=v[D++];return E}}}function f(p){var y=h(p);if(y)return y;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var ure=are,cre=ure;const lre=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};let dre=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},fre=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return mI(this,e)}},pre=class{constructor(e){this.decoders=e}or(e){return mI(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const mI=(t,e)=>new pre({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let hre=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new dre(e,r,n),this.decoder=new fre(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const gI=({name:t,prefix:e,encode:r,decode:n})=>new hre(t,e,r,n),vI=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:s}=cre(r,e);return gI({prefix:t,name:e,encode:n,decode:i=>lre(s(i))})},yre=(t,e,r,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},mre=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},Li=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>gI({prefix:e,name:t,encode(s){return mre(s,n,r)},decode(s){return yre(s,n,r,t)}});Li({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});Li({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});Li({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});Li({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});Li({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});Li({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});Li({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});Li({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});Li({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});vI({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});vI({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});Li({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});Li({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});Li({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});Li({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});new TextEncoder;new TextDecoder;var gre=wI,WD=128,vre=127,wre=~vre,bre=Math.pow(2,31);function wI(t,e,r){e=e||[],r=r||0;for(var n=r;t>=bre;)e[r++]=t&255|WD,t/=128;for(;t&wre;)e[r++]=t&255|WD,t>>>=7;return e[r]=t|0,wI.bytes=r-n+1,e}var _re=A1,Ere=128,JD=127;function A1(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw A1.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&JD)<<s:(o&JD)*Math.pow(2,s),s+=7}while(o>=Ere);return A1.bytes=i-n,r}var Are=Math.pow(2,7),Sre=Math.pow(2,14),$re=Math.pow(2,21),xre=Math.pow(2,28),Dre=Math.pow(2,35),Pre=Math.pow(2,42),Cre=Math.pow(2,49),kre=Math.pow(2,56),Ore=Math.pow(2,63),Tre=function(t){return t<Are?1:t<Sre?2:t<$re?3:t<xre?4:t<Dre?5:t<Pre?6:t<Cre?7:t<kre?8:t<Ore?9:10},Ire={encode:gre,decode:_re,encodingLength:Tre},ug=Ire;const GD=(t,e=0)=>[ug.decode(t,e),ug.decode.bytes],Bre=(t,e,r=0)=>(ug.encode(t,e,r),e),Fre=t=>ug.encodingLength(t);let Pc=class Vu{static addPrefix(e){var r;let{code:n,data:s,name:i}=e;if(!(i?!n:n))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(n=Vu.codeToName.has(n)?n:Vu.nameToCode.get(i),n===void 0)throw new Error(`Unsupported multicodec: ${(r=e.name)!==null&&r!==void 0?r:e.code}`);const o=Fre(n),a=new Uint8Array(o+s.byteLength);return a.set(s,o),Bre(n,a),a}static getCodeFromData(e){const{prefixedData:r}=e,[n,s]=GD(r);return n}static getCodeFromName(e){const{name:r}=e,n=Vu.nameToCode.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static getNameFromCode(e){const{code:r}=e,n=Vu.codeToName.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static registerCodec(e){Vu.codeToName.set(e.code,e.name),Vu.nameToCode.set(e.name,e.code)}static removePrefix(e){const{prefixedData:r}=e,[n,s]=GD(r),i=Vu.codeToName.get(n);if(i===void 0)throw new Error(`Unsupported multicodec: ${n}`);return{code:n,data:r.slice(s),name:i}}};Pc.codeToName=new Map;Pc.nameToCode=new Map;Pc.registerCodec({code:237,name:"ed25519-pub"});Pc.registerCodec({code:4864,name:"ed25519-priv"});Pc.registerCodec({code:236,name:"x25519-pub"});Pc.registerCodec({code:4866,name:"x25519-priv"});Pc.registerCodec({code:231,name:"secp256k1-pub"});Pc.registerCodec({code:4865,name:"secp256k1-priv"});function Nre({didDocument:t,id:e,type:r}){var n,s;return(s=(n=t==null?void 0:t.service)===null||n===void 0?void 0:n.filter(i=>!(e&&i.id!==e||r&&i.type!==r)))!==null&&s!==void 0?s:[]}var ZD;(function(t){t[t.Discoverable=0]="Discoverable",t[t.Organization=1]="Organization",t[t.Government=2]="Government",t[t.Corporation=3]="Corporation",t[t.LocalBusiness=4]="LocalBusiness",t[t.SoftwarePackage=5]="SoftwarePackage",t[t.WebApp=6]="WebApp",t[t.FinancialInstitution=7]="FinancialInstitution"})(ZD||(ZD={}));var ki;(function(t){t[t.Ed25519=0]="Ed25519",t[t.secp256k1=1]="secp256k1",t[t.secp256r1=2]="secp256r1",t[t.X25519=3]="X25519"})(ki||(ki={}));var XD;(function(t){t.authentication="auth",t.assertionMethod="asm",t.capabilityDelegation="del",t.capabilityInvocation="inv",t.keyAgreement="agm"})(XD||(XD={}));ki.Ed25519,ki.secp256k1,ki.secp256r1,ki.secp256r1,ki.secp256k1,ki.secp256r1,ki.X25519;ki.Ed25519+"",ki.secp256k1+"",ki.secp256r1+"",ki.X25519+"";var Wu;(function(t){t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.secp256r1="secp256r1",t.X25519="X25519"})(Wu||(Wu={}));Wu.Ed25519,Wu.secp256k1,Wu.secp256r1,Wu.secp256r1,Wu.secp256k1,Wu.secp256r1;var xa;(function(t){t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.secp256r1="secp256r1",t.X25519="X25519"})(xa||(xa={}));xa.Ed25519,xa.secp256k1,xa.secp256r1,xa.secp256r1,xa.secp256k1,xa.secp256r1,xa.X25519;const bI="%[a-f0-9]{2}",YD=new RegExp("("+bI+")|([^%]+?)","gi"),QD=new RegExp("("+bI+")+","gi");function S1(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;const r=t.slice(0,e),n=t.slice(e);return Array.prototype.concat.call([],S1(r),S1(n))}function Rre(t){try{return decodeURIComponent(t)}catch{let e=t.match(YD)||[];for(let r=1;r<e.length;r++)t=S1(e,r).join(""),e=t.match(YD)||[];return t}}function jre(t){const e={"%FE%FF":"��","%FF%FE":"��"};let r=QD.exec(t);for(;r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{const s=Rre(r[0]);s!==r[0]&&(e[r[0]]=s)}r=QD.exec(t)}e["%C2"]="�";const n=Object.keys(e);for(const s of n)t=t.replace(new RegExp(s,"g"),e[s]);return t}function Mre(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return decodeURIComponent(t)}catch{return jre(t)}}function _I(t,e){if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t===""||e==="")return[];const r=t.indexOf(e);return r===-1?[]:[t.slice(0,r),t.slice(r+e.length)]}function Ure(t,e){const r={};if(Array.isArray(e))for(const n of e){const s=Object.getOwnPropertyDescriptor(t,n);s!=null&&s.enumerable&&Object.defineProperty(r,n,s)}else for(const n of Reflect.ownKeys(t)){const s=Object.getOwnPropertyDescriptor(t,n);if(s.enumerable){const i=t[n];e(n,i,t)&&Object.defineProperty(r,n,s)}}return r}const Kre=t=>t==null,Lre=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),$1=Symbol("encodeFragmentIdentifier");function qre(t){switch(t.arrayFormat){case"index":return e=>(r,n)=>{const s=r.length;return n===void 0||t.skipNull&&n===null||t.skipEmptyString&&n===""?r:n===null?[...r,[Ur(e,t),"[",s,"]"].join("")]:[...r,[Ur(e,t),"[",Ur(s,t),"]=",Ur(n,t)].join("")]};case"bracket":return e=>(r,n)=>n===void 0||t.skipNull&&n===null||t.skipEmptyString&&n===""?r:n===null?[...r,[Ur(e,t),"[]"].join("")]:[...r,[Ur(e,t),"[]=",Ur(n,t)].join("")];case"colon-list-separator":return e=>(r,n)=>n===void 0||t.skipNull&&n===null||t.skipEmptyString&&n===""?r:n===null?[...r,[Ur(e,t),":list="].join("")]:[...r,[Ur(e,t),":list=",Ur(n,t)].join("")];case"comma":case"separator":case"bracket-separator":{const e=t.arrayFormat==="bracket-separator"?"[]=":"=";return r=>(n,s)=>s===void 0||t.skipNull&&s===null||t.skipEmptyString&&s===""?n:(s=s===null?"":s,n.length===0?[[Ur(r,t),e,Ur(s,t)].join("")]:[[n,Ur(s,t)].join(t.arrayFormatSeparator)])}default:return e=>(r,n)=>n===void 0||t.skipNull&&n===null||t.skipEmptyString&&n===""?r:n===null?[...r,Ur(e,t)]:[...r,[Ur(e,t),"=",Ur(n,t)].join("")]}}function Vre(t){let e;switch(t.arrayFormat){case"index":return(r,n,s)=>{if(e=/\[(\d*)]$/.exec(r),r=r.replace(/\[\d*]$/,""),!e){s[r]=n;return}s[r]===void 0&&(s[r]={}),s[r][e[1]]=n};case"bracket":return(r,n,s)=>{if(e=/(\[])$/.exec(r),r=r.replace(/\[]$/,""),!e){s[r]=n;return}if(s[r]===void 0){s[r]=[n];return}s[r]=[...s[r],n]};case"colon-list-separator":return(r,n,s)=>{if(e=/(:list)$/.exec(r),r=r.replace(/:list$/,""),!e){s[r]=n;return}if(s[r]===void 0){s[r]=[n];return}s[r]=[...s[r],n]};case"comma":case"separator":return(r,n,s)=>{const i=typeof n=="string"&&n.includes(t.arrayFormatSeparator),o=typeof n=="string"&&!i&&Fa(n,t).includes(t.arrayFormatSeparator);n=o?Fa(n,t):n;const a=i||o?n.split(t.arrayFormatSeparator).map(c=>Fa(c,t)):n===null?n:Fa(n,t);s[r]=a};case"bracket-separator":return(r,n,s)=>{const i=/(\[])$/.test(r);if(r=r.replace(/\[]$/,""),!i){s[r]=n&&Fa(n,t);return}const o=n===null?[]:n.split(t.arrayFormatSeparator).map(a=>Fa(a,t));if(s[r]===void 0){s[r]=o;return}s[r]=[...s[r],...o]};default:return(r,n,s)=>{if(s[r]===void 0){s[r]=n;return}s[r]=[...[s[r]].flat(),n]}}}function EI(t){if(typeof t!="string"||t.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function Ur(t,e){return e.encode?e.strict?Lre(t):encodeURIComponent(t):t}function Fa(t,e){return e.decode?Mre(t):t}function AI(t){return Array.isArray(t)?t.sort():typeof t=="object"?AI(Object.keys(t)).sort((e,r)=>Number(e)-Number(r)).map(e=>t[e]):t}function SI(t){const e=t.indexOf("#");return e!==-1&&(t=t.slice(0,e)),t}function zre(t){let e="";const r=t.indexOf("#");return r!==-1&&(e=t.slice(r)),e}function e5(t,e){return e.parseNumbers&&!Number.isNaN(Number(t))&&typeof t=="string"&&t.trim()!==""?t=Number(t):e.parseBooleans&&t!==null&&(t.toLowerCase()==="true"||t.toLowerCase()==="false")&&(t=t.toLowerCase()==="true"),t}function $2(t){t=SI(t);const e=t.indexOf("?");return e===-1?"":t.slice(e+1)}function x2(t,e){e={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,...e},EI(e.arrayFormatSeparator);const r=Vre(e),n=Object.create(null);if(typeof t!="string"||(t=t.trim().replace(/^[?#&]/,""),!t))return n;for(const s of t.split("&")){if(s==="")continue;const i=e.decode?s.replace(/\+/g," "):s;let[o,a]=_I(i,"=");o===void 0&&(o=i),a=a===void 0?null:["comma","separator","bracket-separator"].includes(e.arrayFormat)?a:Fa(a,e),r(Fa(o,e),a,n)}for(const[s,i]of Object.entries(n))if(typeof i=="object"&&i!==null)for(const[o,a]of Object.entries(i))i[o]=e5(a,e);else n[s]=e5(i,e);return e.sort===!1?n:(e.sort===!0?Object.keys(n).sort():Object.keys(n).sort(e.sort)).reduce((s,i)=>{const o=n[i];return s[i]=o&&typeof o=="object"&&!Array.isArray(o)?AI(o):o,s},Object.create(null))}function $I(t,e){if(!t)return"";e={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...e},EI(e.arrayFormatSeparator);const r=o=>e.skipNull&&Kre(t[o])||e.skipEmptyString&&t[o]==="",n=qre(e),s={};for(const[o,a]of Object.entries(t))r(o)||(s[o]=a);const i=Object.keys(s);return e.sort!==!1&&i.sort(e.sort),i.map(o=>{const a=t[o];return a===void 0?"":a===null?Ur(o,e):Array.isArray(a)?a.length===0&&e.arrayFormat==="bracket-separator"?Ur(o,e)+"[]":a.reduce(n(o),[]).join("&"):Ur(o,e)+"="+Ur(a,e)}).filter(o=>o.length>0).join("&")}function xI(t,e){var s;e={decode:!0,...e};let[r,n]=_I(t,"#");return r===void 0&&(r=t),{url:((s=r==null?void 0:r.split("?"))==null?void 0:s[0])??"",query:x2($2(t),e),...e&&e.parseFragmentIdentifier&&n?{fragmentIdentifier:Fa(n,e)}:{}}}function DI(t,e){e={encode:!0,strict:!0,[$1]:!0,...e};const r=SI(t.url).split("?")[0]||"",n=$2(t.url),s={...x2(n,{sort:!1}),...t.query};let i=$I(s,e);i&&(i=`?${i}`);let o=zre(t.url);if(t.fragmentIdentifier){const a=new URL(r);a.hash=t.fragmentIdentifier,o=e[$1]?a.hash:`#${t.fragmentIdentifier}`}return`${r}${i}${o}`}function PI(t,e,r){r={parseFragmentIdentifier:!0,[$1]:!1,...r};const{url:n,query:s,fragmentIdentifier:i}=xI(t,r);return DI({url:n,query:Ure(s,e),fragmentIdentifier:i},r)}function Hre(t,e,r){const n=Array.isArray(e)?s=>!e.includes(s):(s,i)=>!e(s,i);return PI(t,n,r)}const Wre=Object.freeze(Object.defineProperty({__proto__:null,exclude:Hre,extract:$2,parse:x2,parseUrl:xI,pick:PI,stringify:$I,stringifyUrl:DI},Symbol.toStringTag,{value:"Module"})),t5=["aud","iss","exp","iat","jti"];class Cn{static async createExchange(e,r){await e.verify();const{to:n}=e.metadata,s=JSON.stringify({rfq:e,replyTo:r==null?void 0:r.replyTo});await Cn.sendMessage(n,"POST","/exchanges",s)}static async submitOrder(e){await e.verify();const{to:r,exchangeId:n}=e.metadata,s=JSON.stringify(e);await Cn.sendMessage(r,"PUT",`/exchanges/${n}`,s)}static async submitClose(e){await e.verify();const{to:r,exchangeId:n}=e.metadata,s=JSON.stringify(e);await Cn.sendMessage(r,"PUT",`/exchanges/${n}`,s)}static async sendMessage(e,r,n,s){const o=`${await Cn.getPfiServiceEndpoint(e)}${n}`;let a;try{a=await fetch(o,{method:r,headers:{"content-type":"application/json"},body:s})}catch(c){throw new Ep({message:`Failed to send message to ${e}`,recipientDid:e,url:o,cause:c})}if(!a.ok){const c=await a.json();throw new Ap({statusCode:a.status,details:c,recipientDid:e,url:o})}}static async getOfferings(e){const{pfiDid:r}=e,s=`${await Cn.getPfiServiceEndpoint(r)}/offerings`;let i;try{i=await fetch(s)}catch(l){throw new Ep({message:`Failed to get offerings from ${r}`,recipientDid:r,url:s,cause:l})}const o=[];if(!i.ok){const l=await i.json();throw new Ap({statusCode:i.status,details:l,recipientDid:r,url:s})}const c=(await i.json()).data;for(let l of c){const u=await Kh.parse(l);o.push(u)}return o}static async getBalances(e){const{pfiDid:r,did:n}=e,i=`${await Cn.getPfiServiceEndpoint(r)}/balances`,o=await Cn.generateRequestToken({requesterDid:n,pfiDid:r});let a;try{a=await fetch(i,{headers:{authorization:`Bearer ${o}`}})}catch(u){throw new Ep({message:`Failed to get balances from ${r}`,recipientDid:r,url:i,cause:u})}if(!a.ok){const u=await a.json();throw new Ap({statusCode:a.status,details:u,recipientDid:r,url:i})}return(await a.json()).data}static async getExchange(e){const{pfiDid:r,exchangeId:n,did:s}=e,o=`${await Cn.getPfiServiceEndpoint(r)}/exchanges/${n}`,a=await Cn.generateRequestToken({requesterDid:s,pfiDid:r});let c;try{c=await fetch(o,{headers:{authorization:`Bearer ${a}`}})}catch(d){throw new Ep({message:`Failed to get exchange from ${r}`,recipientDid:r,url:o,cause:d})}const l=[];if(!c.ok){const d=await c.json();throw new Ap({statusCode:c.status,details:d,recipientDid:r,url:o})}const u=await c.json();for(let d of u.data){const h=await Es.parseMessage(d);l.push(h)}return l}static async getExchanges(e){const{pfiDid:r,filter:n,did:s}=e,i=await Cn.getPfiServiceEndpoint(r),o=n?`?${Wre.stringify(n)}`:"",a=`${i}/exchanges${o}`,c=await Cn.generateRequestToken({requesterDid:s,pfiDid:r});let l;try{l=await fetch(a,{headers:{authorization:`Bearer ${c}`}})}catch(h){throw new Ep({message:`Failed to get exchanges from ${r}`,recipientDid:r,url:a,cause:h})}const u=[];if(!l.ok){const h=await l.json();throw new Ap({statusCode:l.status,details:h,recipientDid:r,url:a})}const d=await l.json();for(let h of d.data){const f=[];for(let p of h){const y=await Es.parseMessage(p);f.push(y)}u.push(f)}return u}static async getPfiServiceEndpoint(e){let r;try{r=await hU(e)}catch(s){throw new ere(s.message)}const[n]=Nre({didDocument:r,type:"PFI"});if(!(n!=null&&n.serviceEndpoint))throw new tre(`${e} has no PFI service entry`);return n.serviceEndpoint}static async generateRequestToken(e){const{pfiDid:r,requesterDid:n}=e,s=Date.now(),i=s+dU("1m"),o={aud:r,iss:n.uri,exp:Math.floor(i/1e3),iat:Math.floor(s/1e3),jti:O1().getSuffix()};try{return await jo.sign({signerDid:n,payload:o})}catch(a){throw new rre({message:a.message,cause:a})}}static async verifyRequestToken(e){let r;try{r=await jo.verify({jwt:e.requestToken})}catch(a){throw new nre({message:a.message,cause:a})}const{header:n,payload:s}=r;for(let a of t5)if(!s[a])throw new ire({message:`Request token missing ${a} claim. Expected ${t5}.`});if(s.aud!==e.pfiDid)throw new sre({message:"Request token contains invalid audience. Expected aud property to be PFI DID."});const i=n.kid,o=s.iss;if(!i.includes(o))throw new ore({message:"Request token issuer does not match signer"});return o}}var Lh;(function(t){t.authentication="authentication",t.assertionMethod="assertionMethod",t.keyAgreement="keyAgreement",t.capabilityInvocation="capabilityInvocation",t.capabilityDelegation="capabilityDelegation"})(Lh||(Lh={}));const ei={"@context":"https://w3id.org/did-resolution/v1",didResolutionMetadata:{},didDocument:null,didDocumentMetadata:{}};class Gt{constructor({method:e,id:r,path:n,query:s,fragment:i,params:o}){this.uri=`did:${e}:${r}`,this.method=e,this.id=r,this.path=n,this.query=s,this.fragment=i,this.params=o}static parse(e){if(!e)return null;const r=Gt.DID_URI_PATTERN.exec(e);if(!r||!r.groups)return null;const{method:n,id:s,path:i,query:o,fragment:a}=r.groups,c={uri:`did:${n}:${s}`,method:n,id:s};if(i&&(c.path=i),o&&(c.query=o.slice(1)),a&&(c.fragment=a.slice(1)),o){const l={},u=o.slice(1).split("&");for(const d of u){const[h,f]=d.split("=");l[h]=f}c.params=l}return c}}Gt.METHOD_PATTERN="([a-z0-9]+)";Gt.PCT_ENCODED_PATTERN="(?:%[0-9a-fA-F]{2})";Gt.ID_CHAR_PATTERN=`(?:[a-zA-Z0-9._-]|${Gt.PCT_ENCODED_PATTERN})`;Gt.METHOD_ID_PATTERN=`((?:${Gt.ID_CHAR_PATTERN}*:)*(${Gt.ID_CHAR_PATTERN}+))`;Gt.PATH_PATTERN="(/[^#?]*)?";Gt.QUERY_PATTERN="([?][^#]*)?";Gt.FRAGMENT_PATTERN="(#.*)?";Gt.DID_URI_PATTERN=new RegExp(`^did:(?<method>${Gt.METHOD_PATTERN}):(?<id>${Gt.METHOD_ID_PATTERN})(?<path>${Gt.PATH_PATTERN})(?<query>${Gt.QUERY_PATTERN})(?<fragment>${Gt.FRAGMENT_PATTERN})$`);class Ze extends Error{constructor(e,r){super(`${e}: ${r}`),this.code=e,this.name="DidError",Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ze)}}var it;(function(t){t.InvalidDid="invalidDid",t.MethodNotSupported="methodNotSupported",t.InternalError="internalError",t.InvalidDidDocument="invalidDidDocument",t.InvalidDidDocumentLength="invalidDidDocumentLength",t.InvalidDidUrl="invalidDidUrl",t.InvalidPreviousDidProof="invalidPreviousDidProof",t.InvalidPublicKey="invalidPublicKey",t.InvalidPublicKeyLength="invalidPublicKeyLength",t.InvalidPublicKeyType="invalidPublicKeyType",t.InvalidSignature="invalidSignature",t.NotFound="notFound",t.RepresentationNotSupported="representationNotSupported",t.UnsupportedPublicKeyType="unsupportedPublicKeyType"})(it||(it={}));function Jre(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var y=0,b=0,w=0,g=p.length;w!==g&&p[w]===0;)w++,y++;for(var v=(g-w)*u+1>>>0,m=new Uint8Array(v);w!==g;){for(var _=p[w],x=0,D=v-1;(_!==0||x<b)&&D!==-1;D--,x++)_+=256*m[D]>>>0,m[D]=_%a>>>0,_=_/a>>>0;if(_!==0)throw new Error("Non-zero carry");b=x,w++}for(var E=v-b;E!==v&&m[E]===0;)E++;for(var A=c.repeat(y);E<v;++E)A+=t.charAt(m[E]);return A}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var y=0;if(p[y]!==" "){for(var b=0,w=0;p[y]===c;)b++,y++;for(var g=(p.length-y)*l+1>>>0,v=new Uint8Array(g);p[y];){var m=r[p.charCodeAt(y)];if(m===255)return;for(var _=0,x=g-1;(m!==0||_<w)&&x!==-1;x--,_++)m+=a*v[x]>>>0,v[x]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");w=_,y++}if(p[y]!==" "){for(var D=g-w;D!==g&&v[D]===0;)D++;for(var E=new Uint8Array(b+(g-D)),A=b;D!==g;)E[A++]=v[D++];return E}}}function f(p){var y=h(p);if(y)return y;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var Gre=Jre,Zre=Gre;const Xre=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};class Yre{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Qre{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return CI(this,e)}}class ene{constructor(e){this.decoders=e}or(e){return CI(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const CI=(t,e)=>new ene({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class tne{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new Yre(e,r,n),this.decoder=new Qre(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const kI=({name:t,prefix:e,encode:r,decode:n})=>new tne(t,e,r,n),OI=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:s}=Zre(r,e);return kI({prefix:t,name:e,encode:n,decode:i=>Xre(s(i))})},rne=(t,e,r,n)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|d,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},nne=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},qi=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>kI({prefix:e,name:t,encode(s){return nne(s,n,r)},decode(s){return rne(s,n,r,t)}});qi({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});qi({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});qi({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});qi({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});qi({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});qi({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});qi({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});qi({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});const r5=qi({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),km=OI({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});OI({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});qi({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});qi({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const ba=qi({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});qi({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function ine(t){return t.byteOffset!==0||t.byteLength!==t.buffer.byteLength}function sne(t){return typeof t!="object"||t===null?!1:typeof t[Symbol.asyncIterator]=="function"}function x1(t){const r=Object.prototype.toString.call(t).match(/\s([a-zA-Z0-9]+)/),[n,s]=r;return s}var Sp=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},n5=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}};const Om=new TextEncoder,Qc=new TextDecoder;class Me{constructor(e,r){this.data=e,this.format=r}static arrayBuffer(e){return new Me(e,"ArrayBuffer")}static asyncIterable(e){if(!sne(e))throw new TypeError("Input must be of type AsyncIterable.");return new Me(e,"AsyncIterable")}static base32Z(e){return new Me(e,"Base32Z")}static base58Btc(e){return new Me(e,"Base58Btc")}static base64Url(e){return new Me(e,"Base64Url")}static bufferSource(e){return new Me(e,"BufferSource")}static hex(e){if(typeof e!="string")throw new TypeError("Hex input must be a string.");if(e.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new Me(e,"Hex")}static multibase(e){return new Me(e,"Multibase")}static object(e){return new Me(e,"Object")}static string(e){return new Me(e,"String")}static uint8Array(e){return new Me(e,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return km.baseDecode(this.data).buffer;case"Base64Url":return ba.baseDecode(this.data).buffer;case"BufferSource":{if(x1(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return ine(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return Sp(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return r5.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return km.baseEncode(e)}case"Multibase":return this.data.substring(1);case"Uint8Array":return km.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{const e=new Uint8Array(this.data);return ba.baseEncode(e)}case"BufferSource":{const e=this.toUint8Array();return ba.baseEncode(e)}case"Object":{const e=JSON.stringify(this.data),r=Om.encode(e);return ba.baseEncode(r)}case"String":{const e=Om.encode(this.data);return ba.baseEncode(e)}case"Uint8Array":return ba.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){var e,r,n,s;return Sp(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const c=[];try{for(var i=!0,o=n5(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const u=s;c.push(u)}}catch(u){r={error:u}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return new Blob(c)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){const e=Array.from({length:256},(r,n)=>n.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{const r=this.toUint8Array();return Me.uint8Array(r).toHex()}case"Base64Url":{const r=this.toUint8Array();return Me.uint8Array(r).toHex()}case"Uint8Array":{let r="";for(let n=0;n<this.data.length;n++)r+=e[this.data[n]];return r}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{const e=ba.baseDecode(this.data),r=Qc.decode(e);return JSON.parse(r)}case"String":return JSON.parse(this.data);case"Uint8Array":{const e=Qc.decode(this.data);return JSON.parse(e)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return Sp(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toStringAsync();return JSON.parse(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return Qc.decode(this.data);case"Base64Url":{const e=ba.baseDecode(this.data);return Qc.decode(e)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return Qc.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){var e,r,n,s;return Sp(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let c="";try{for(var i=!0,o=n5(this.data),a;a=yield o.next(),e=a.done,!e;i=!0){s=a.value,i=!1;const l=s;typeof l=="string"?c+=l:c+=Qc.decode(l,{stream:!0})}}catch(l){r={error:l}}finally{try{!i&&!e&&(n=o.return)&&(yield n.call(o))}finally{if(r)throw r.error}}return c+=Qc.decode(void 0,{stream:!1}),c}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return r5.baseDecode(this.data);case"Base58Btc":return km.baseDecode(this.data);case"Base64Url":return ba.baseDecode(this.data);case"BufferSource":{const e=x1(this.data);if(e==="Uint8Array")return this.data;if(e==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{const e=new Uint8Array(this.data.length/2);for(let r=0;r<this.data.length;r+=2){const n=parseInt(this.data.substring(r,r+2),16);if(isNaN(n))throw new TypeError("Input is not a valid hexadecimal string.");e[r/2]=n}return e}case"Object":{const e=JSON.stringify(this.data);return Om.encode(e)}case"String":return Om.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return Sp(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{const e=yield this.toArrayBufferAsync();return new Uint8Array(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}}var one=TI,i5=128,ane=127,une=~ane,cne=Math.pow(2,31);function TI(t,e,r){e=e||[],r=r||0;for(var n=r;t>=cne;)e[r++]=t&255|i5,t/=128;for(;t&une;)e[r++]=t&255|i5,t>>>=7;return e[r]=t|0,TI.bytes=r-n+1,e}var lne=D1,dne=128,s5=127;function D1(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw D1.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&s5)<<s:(o&s5)*Math.pow(2,s),s+=7}while(o>=dne);return D1.bytes=i-n,r}var fne=Math.pow(2,7),pne=Math.pow(2,14),hne=Math.pow(2,21),yne=Math.pow(2,28),mne=Math.pow(2,35),gne=Math.pow(2,42),vne=Math.pow(2,49),wne=Math.pow(2,56),bne=Math.pow(2,63),_ne=function(t){return t<fne?1:t<pne?2:t<hne?3:t<yne?4:t<mne?5:t<gne?6:t<vne?7:t<wne?8:t<bne?9:10},Ene={encode:one,decode:lne,encodingLength:_ne},cg=Ene;const o5=(t,e=0)=>[cg.decode(t,e),cg.decode.bytes],Ane=(t,e,r=0)=>(cg.encode(t,e,r),e),Sne=t=>cg.encodingLength(t);class Lr{static addPrefix(e){var r;let{code:n,data:s,name:i}=e;if(!(i?!n:n))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(n=Lr.codeToName.has(n)?n:Lr.nameToCode.get(i),n===void 0)throw new Error(`Unsupported multicodec: ${(r=e.name)!==null&&r!==void 0?r:e.code}`);const o=Sne(n),a=new Uint8Array(o+s.byteLength);return a.set(s,o),Ane(n,a),a}static getCodeFromData(e){const{prefixedData:r}=e,[n,s]=o5(r);return n}static getCodeFromName(e){const{name:r}=e,n=Lr.nameToCode.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static getNameFromCode(e){const{code:r}=e,n=Lr.codeToName.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static registerCodec(e){Lr.codeToName.set(e.code,e.name),Lr.nameToCode.set(e.name,e.code)}static removePrefix(e){const{prefixedData:r}=e,[n,s]=o5(r),i=Lr.codeToName.get(n);if(i===void 0)throw new Error(`Unsupported multicodec: ${n}`);return{code:n,data:r.slice(s),name:i}}}Lr.codeToName=new Map;Lr.nameToCode=new Map;Lr.registerCodec({code:237,name:"ed25519-pub"});Lr.registerCodec({code:4864,name:"ed25519-priv"});Lr.registerCodec({code:236,name:"x25519-pub"});Lr.registerCodec({code:4866,name:"x25519-priv"});Lr.registerCodec({code:231,name:"secp256k1-pub"});Lr.registerCodec({code:4865,name:"secp256k1-priv"});function II(t){Object.keys(t).forEach(e=>{t[e]===void 0?delete t[e]:typeof t[e]=="object"&&II(t[e])})}var el=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};class $ne{constructor(){this.store=new Map}clear(){return el(this,void 0,void 0,function*(){this.store.clear()})}close(){return el(this,void 0,void 0,function*(){})}delete(e){return el(this,void 0,void 0,function*(){return this.store.delete(e)})}get(e){return el(this,void 0,void 0,function*(){return this.store.get(e)})}has(e){return el(this,void 0,void 0,function*(){return this.store.has(e)})}list(){return el(this,void 0,void 0,function*(){return Array.from(this.store.values())})}set(e,r){return el(this,void 0,void 0,function*(){this.store.set(e,r)})}}function xne(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function BI(t,...e){if(!xne(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function a5(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Dne(t,e){BI(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Gw=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),co=(t,e)=>t<<32-e|t>>>e;new Uint8Array(new Uint32Array([287454020]).buffer)[0];function Pne(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function FI(t){return typeof t=="string"&&(t=Pne(t)),BI(t),t}class Cne{clone(){return this._cloneInto()}}function kne(t){const e=n=>t().update(FI(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function One(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),c=n?4:0,l=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+l,a,n)}const Tne=(t,e,r)=>t&e^~t&r,Ine=(t,e,r)=>t&e^t&r^e&r;class Bne extends Cne{constructor(e,r,n,s){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Gw(this.buffer)}update(e){a5(this);const{view:r,buffer:n,blockLen:s}=this;e=FI(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Gw(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){a5(this),Dne(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)r[d]=0;One(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=Gw(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%r&&e.buffer.set(n),e}}const Fne=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Du=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Pu=new Uint32Array(64);class Nne extends Bne{constructor(){super(64,32,8,!1),this.A=Du[0]|0,this.B=Du[1]|0,this.C=Du[2]|0,this.D=Du[3]|0,this.E=Du[4]|0,this.F=Du[5]|0,this.G=Du[6]|0,this.H=Du[7]|0}get(){const{A:e,B:r,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,r,n,s,i,o,a,c]}set(e,r,n,s,i,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let d=0;d<16;d++,r+=4)Pu[d]=e.getUint32(r,!1);for(let d=16;d<64;d++){const h=Pu[d-15],f=Pu[d-2],p=co(h,7)^co(h,18)^h>>>3,y=co(f,17)^co(f,19)^f>>>10;Pu[d]=y+Pu[d-7]+p+Pu[d-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=co(a,6)^co(a,11)^co(a,25),f=u+h+Tne(a,c,l)+Fne[d]+Pu[d]|0,y=(co(n,2)^co(n,13)^co(n,22))+Ine(n,s,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=s,s=n,n=f+y|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(n,s,i,o,a,c,l,u)}roundClean(){Pu.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const qh=kne(()=>new Nne);var Rne=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};class NI{static digest(e){return Rne(this,arguments,void 0,function*({data:r}){return qh(r)})}}class D2{}var jne=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};class Mne extends D2{digest(e){return jne(this,arguments,void 0,function*({algorithm:r,data:n}){switch(r){case"SHA-256":return yield NI.digest({data:n})}})}}function Une(t){const e=n=>{if(n!==null&&typeof n=="object"&&!Array.isArray(n)){const s=Object.keys(n).sort(),i={};for(const o of s)i[o]=e(n[o]);return i}return n},r=e(t);return JSON.stringify(r)}var Kne=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};const u5="urn:jwk:";function nr(t){return Kne(this,arguments,void 0,function*({jwk:e}){const r=e.kty;let n;if(r==="EC")n={crv:e.crv,kty:e.kty,x:e.x,y:e.y};else if(r==="oct")n={k:e.k,kty:e.kty};else if(r==="OKP")n={crv:e.crv,kty:e.kty,x:e.x};else if(r==="RSA")n={e:e.e,kty:e.kty,n:e.n};else throw new Error(`Unsupported key type: ${r}`);II(n);const s=Une(n),i=Me.string(s).toUint8Array(),o=yield NI.digest({data:i});return Me.uint8Array(o).toBase64Url()})}function Rl(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="EC"||typeof t.d!="string"||typeof t.x!="string")}function P2(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t)||"d"in t||t.kty!=="EC"||typeof t.x!="string")}function jl(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="OKP"||typeof t.d!="string"||typeof t.x!="string")}function C2(t){return!(!t||typeof t!="object"||"d"in t||!("kty"in t&&"crv"in t&&"x"in t)||t.kty!=="OKP"||typeof t.x!="string")}function Lne(t){if(!t||typeof t!="object")return!1;switch(t.kty){case"EC":case"OKP":case"RSA":return"d"in t;case"oct":return"k"in t;default:return!1}}var En=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},qne=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};class Sr{static adjustSignatureToLowS(e){return En(this,arguments,void 0,function*({signature:r}){const n=qe.Signature.fromCompact(r);return n.hasHighS()?n.normalizeS().toCompactRawBytes():r})}static bytesToPrivateKey(e){return En(this,arguments,void 0,function*({privateKeyBytes:r}){const n=yield Sr.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"secp256k1",d:Me.uint8Array(r).toBase64Url(),x:Me.uint8Array(n.x).toBase64Url(),y:Me.uint8Array(n.y).toBase64Url()};return s.kid=yield nr({jwk:s}),s})}static bytesToPublicKey(e){return En(this,arguments,void 0,function*({publicKeyBytes:r}){const n=yield Sr.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"secp256k1",x:Me.uint8Array(n.x).toBase64Url(),y:Me.uint8Array(n.y).toBase64Url()};return s.kid=yield nr({jwk:s}),s})}static compressPublicKey(e){return En(this,arguments,void 0,function*({publicKeyBytes:r}){return qe.ProjectivePoint.fromHex(r).toRawBytes(!0)})}static computePublicKey(e){return En(this,arguments,void 0,function*({key:r}){const n=yield Sr.privateKeyToBytes({privateKey:r}),s=yield Sr.getCurvePoint({keyBytes:n}),i={kty:"EC",crv:"secp256k1",x:Me.uint8Array(s.x).toBase64Url(),y:Me.uint8Array(s.y).toBase64Url()};return i.kid=yield nr({jwk:i}),i})}static convertDerToCompactSignature(e){return En(this,arguments,void 0,function*({derSignature:r}){return qe.Signature.fromDER(r).toCompactRawBytes()})}static decompressPublicKey(e){return En(this,arguments,void 0,function*({publicKeyBytes:r}){return qe.ProjectivePoint.fromHex(r).toRawBytes(!1)})}static generateKey(){return En(this,void 0,void 0,function*(){const e=qe.utils.randomPrivateKey(),r=yield Sr.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield nr({jwk:r}),r})}static getPublicKey(e){return En(this,arguments,void 0,function*({key:r}){var n;if(!(Rl(r)&&r.crv==="secp256k1"))throw new Error("Secp256k1: The provided key is not a secp256k1 private JWK.");let s=qne(r,["d"]);return(n=s.kid)!==null&&n!==void 0||(s.kid=yield nr({jwk:s})),s})}static privateKeyToBytes(e){return En(this,arguments,void 0,function*({privateKey:r}){if(!Rl(r))throw new Error("Secp256k1: The provided key is not a valid EC private key.");return Me.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return En(this,arguments,void 0,function*({publicKey:r}){if(!(P2(r)&&r.y))throw new Error("Secp256k1: The provided key is not a valid EC public key.");const n=new Uint8Array([4]),s=Me.base64Url(r.x).toUint8Array(),i=Me.base64Url(r.y).toUint8Array();return new Uint8Array([...n,...s,...i])})}static sharedSecret(e){return En(this,arguments,void 0,function*({privateKeyA:r,publicKeyB:n}){if("x"in r&&"x"in n&&r.x===n.x)throw new Error("Secp256k1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const s=yield Sr.privateKeyToBytes({privateKey:r}),i=yield Sr.publicKeyToBytes({publicKey:n});return qe.getSharedSecret(s,i,!0).slice(1)})}static sign(e){return En(this,arguments,void 0,function*({data:r,key:n}){const s=yield Sr.privateKeyToBytes({privateKey:n}),i=qh(r);return qe.sign(i,s).toCompactRawBytes()})}static validatePrivateKey(e){return En(this,arguments,void 0,function*({privateKeyBytes:r}){return qe.utils.isValidPrivateKey(r)})}static validatePublicKey(e){return En(this,arguments,void 0,function*({publicKeyBytes:r}){try{qe.ProjectivePoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return En(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=yield Sr.publicKeyToBytes({publicKey:r}),o=qh(s);return qe.verify(n,o,i,{lowS:!1})})}static getCurvePoint(e){return En(this,arguments,void 0,function*({keyBytes:r}){r.byteLength===32&&(r=qe.getPublicKey(r));const n=qe.ProjectivePoint.fromHex(r),s=fr(n.x,32),i=fr(n.y,32);return{x:s,y:i}})}}var An=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},Vne=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};class Dr{static adjustSignatureToLowS(e){return An(this,arguments,void 0,function*({signature:r}){const n=Ve.Signature.fromCompact(r);return n.hasHighS()?n.normalizeS().toCompactRawBytes():r})}static bytesToPrivateKey(e){return An(this,arguments,void 0,function*({privateKeyBytes:r}){const n=yield Dr.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"P-256",d:Me.uint8Array(r).toBase64Url(),x:Me.uint8Array(n.x).toBase64Url(),y:Me.uint8Array(n.y).toBase64Url()};return s.kid=yield nr({jwk:s}),s})}static bytesToPublicKey(e){return An(this,arguments,void 0,function*({publicKeyBytes:r}){const n=yield Dr.getCurvePoint({keyBytes:r}),s={kty:"EC",crv:"P-256",x:Me.uint8Array(n.x).toBase64Url(),y:Me.uint8Array(n.y).toBase64Url()};return s.kid=yield nr({jwk:s}),s})}static compressPublicKey(e){return An(this,arguments,void 0,function*({publicKeyBytes:r}){return Ve.ProjectivePoint.fromHex(r).toRawBytes(!0)})}static computePublicKey(e){return An(this,arguments,void 0,function*({key:r}){const n=yield Dr.privateKeyToBytes({privateKey:r}),s=yield Dr.getCurvePoint({keyBytes:n}),i={kty:"EC",crv:"P-256",x:Me.uint8Array(s.x).toBase64Url(),y:Me.uint8Array(s.y).toBase64Url()};return i.kid=yield nr({jwk:i}),i})}static convertDerToCompactSignature(e){return An(this,arguments,void 0,function*({derSignature:r}){return Ve.Signature.fromDER(r).toCompactRawBytes()})}static decompressPublicKey(e){return An(this,arguments,void 0,function*({publicKeyBytes:r}){return Ve.ProjectivePoint.fromHex(r).toRawBytes(!1)})}static generateKey(){return An(this,void 0,void 0,function*(){const e=Ve.utils.randomPrivateKey(),r=yield Dr.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield nr({jwk:r}),r})}static getPublicKey(e){return An(this,arguments,void 0,function*({key:r}){var n;if(!(Rl(r)&&r.crv==="P-256"))throw new Error("Secp256r1: The provided key is not a 'P-256' private JWK.");let s=Vne(r,["d"]);return(n=s.kid)!==null&&n!==void 0||(s.kid=yield nr({jwk:s})),s})}static privateKeyToBytes(e){return An(this,arguments,void 0,function*({privateKey:r}){if(!Rl(r))throw new Error("Secp256r1: The provided key is not a valid EC private key.");return Me.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return An(this,arguments,void 0,function*({publicKey:r}){if(!(P2(r)&&r.y))throw new Error("Secp256r1: The provided key is not a valid EC public key.");const n=new Uint8Array([4]),s=Me.base64Url(r.x).toUint8Array(),i=Me.base64Url(r.y).toUint8Array();return new Uint8Array([...n,...s,...i])})}static sharedSecret(e){return An(this,arguments,void 0,function*({privateKeyA:r,publicKeyB:n}){if("x"in r&&"x"in n&&r.x===n.x)throw new Error("Secp256r1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const s=yield Dr.privateKeyToBytes({privateKey:r}),i=yield Dr.publicKeyToBytes({publicKey:n});return Ve.getSharedSecret(s,i,!0).slice(1)})}static sign(e){return An(this,arguments,void 0,function*({data:r,key:n}){const s=yield Dr.privateKeyToBytes({privateKey:n}),i=qh(r);return Ve.sign(i,s).toCompactRawBytes()})}static validatePrivateKey(e){return An(this,arguments,void 0,function*({privateKeyBytes:r}){return Ve.utils.isValidPrivateKey(r)})}static validatePublicKey(e){return An(this,arguments,void 0,function*({publicKeyBytes:r}){try{Ve.ProjectivePoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return An(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=yield Dr.publicKeyToBytes({publicKey:r}),o=qh(s);return Ve.verify(n,o,i,{lowS:!1})})}static getCurvePoint(e){return An(this,arguments,void 0,function*({keyBytes:r}){r.byteLength===32&&(r=Ve.getPublicKey(r));const n=Ve.ProjectivePoint.fromHex(r),s=fr(n.x,32),i=fr(n.y,32);return{x:s,y:i}})}}var $p=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};class c5 extends D2{computePublicKey(e){return $p(this,arguments,void 0,function*({key:r}){if(!Rl(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":{const n=yield Sr.computePublicKey({key:r});return n.alg="ES256K",n}case"P-256":{const n=yield Dr.computePublicKey({key:r});return n.alg="ES256",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}generateKey(e){return $p(this,arguments,void 0,function*({algorithm:r}){switch(r){case"ES256K":case"secp256k1":{const n=yield Sr.generateKey();return n.alg="ES256K",n}case"ES256":case"secp256r1":{const n=yield Dr.generateKey();return n.alg="ES256",n}}})}getPublicKey(e){return $p(this,arguments,void 0,function*({key:r}){if(!Rl(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":{const n=yield Sr.getPublicKey({key:r});return n.alg="ES256K",n}case"P-256":{const n=yield Dr.getPublicKey({key:r});return n.alg="ES256",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}sign(e){return $p(this,arguments,void 0,function*({key:r,data:n}){if(!Rl(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":return yield Sr.sign({key:r,data:n});case"P-256":return yield Dr.sign({key:r,data:n});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}verify(e){return $p(this,arguments,void 0,function*({key:r,signature:n,data:s}){if(!P2(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) public key.");switch(r.crv){case"secp256k1":return yield Sr.verify({key:r,signature:n,data:s});case"P-256":return yield Dr.verify({key:r,signature:n,data:s});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}}var Xi=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},zne=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};class Pr{static bytesToPrivateKey(e){return Xi(this,arguments,void 0,function*({privateKeyBytes:r}){const n=Ht.getPublicKey(r),s={crv:"Ed25519",d:Me.uint8Array(r).toBase64Url(),kty:"OKP",x:Me.uint8Array(n).toBase64Url()};return s.kid=yield nr({jwk:s}),s})}static bytesToPublicKey(e){return Xi(this,arguments,void 0,function*({publicKeyBytes:r}){const n={kty:"OKP",crv:"Ed25519",x:Me.uint8Array(r).toBase64Url()};return n.kid=yield nr({jwk:n}),n})}static computePublicKey(e){return Xi(this,arguments,void 0,function*({key:r}){const n=yield Pr.privateKeyToBytes({privateKey:r}),s=Ht.getPublicKey(n),i={kty:"OKP",crv:"Ed25519",x:Me.uint8Array(s).toBase64Url()};return i.kid=yield nr({jwk:i}),i})}static convertPrivateKeyToX25519(e){return Xi(this,arguments,void 0,function*({privateKey:r}){const n=yield Pr.privateKeyToBytes({privateKey:r}),s=Zh(n),i=Tn.getPublicKey(s),o={kty:"OKP",crv:"X25519",d:Me.uint8Array(s).toBase64Url(),x:Me.uint8Array(i).toBase64Url()};return o.kid=yield nr({jwk:o}),o})}static convertPublicKeyToX25519(e){return Xi(this,arguments,void 0,function*({publicKey:r}){const n=yield Pr.publicKeyToBytes({publicKey:r});if(!(yield Pr.validatePublicKey({publicKeyBytes:n})))throw new Error("Ed25519: Invalid public key.");const i=Gh(n),o={kty:"OKP",crv:"X25519",x:Me.uint8Array(i).toBase64Url()};return o.kid=yield nr({jwk:o}),o})}static generateKey(){return Xi(this,void 0,void 0,function*(){const e=Ht.utils.randomPrivateKey(),r=yield Pr.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield nr({jwk:r}),r})}static getPublicKey(e){return Xi(this,arguments,void 0,function*({key:r}){var n;if(!(jl(r)&&r.crv==="Ed25519"))throw new Error("Ed25519: The provided key is not an Ed25519 private JWK.");let s=zne(r,["d"]);return(n=s.kid)!==null&&n!==void 0||(s.kid=yield nr({jwk:s})),s})}static privateKeyToBytes(e){return Xi(this,arguments,void 0,function*({privateKey:r}){if(!jl(r))throw new Error("Ed25519: The provided key is not a valid OKP private key.");return Me.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return Xi(this,arguments,void 0,function*({publicKey:r}){if(!C2(r))throw new Error("Ed25519: The provided key is not a valid OKP public key.");return Me.base64Url(r.x).toUint8Array()})}static sign(e){return Xi(this,arguments,void 0,function*({key:r,data:n}){const s=yield Pr.privateKeyToBytes({privateKey:r});return Ht.sign(n,s)})}static validatePublicKey(e){return Xi(this,arguments,void 0,function*({publicKeyBytes:r}){try{Ht.ExtendedPoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return Xi(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=yield Pr.publicKeyToBytes({publicKey:r});return Ht.verify(n,s,i)})}}var xp=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};class Hne extends D2{computePublicKey(e){return xp(this,arguments,void 0,function*({key:r}){if(!jl(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":{const n=yield Pr.computePublicKey({key:r});return n.alg="EdDSA",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}generateKey(e){return xp(this,arguments,void 0,function*({algorithm:r}){switch(r){case"Ed25519":{const n=yield Pr.generateKey();return n.alg="EdDSA",n}}})}getPublicKey(e){return xp(this,arguments,void 0,function*({key:r}){if(!jl(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":{const n=yield Pr.getPublicKey({key:r});return n.alg="EdDSA",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}sign(e){return xp(this,arguments,void 0,function*({key:r,data:n}){if(!jl(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":return yield Pr.sign({key:r,data:n});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}verify(e){return xp(this,arguments,void 0,function*({key:r,signature:n,data:s}){if(!C2(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) public key.");switch(r.crv){case"Ed25519":return yield Pr.verify({key:r,signature:n,data:s});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}}var _a=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};const Zw={Ed25519:{implementation:Hne,names:["Ed25519"]},secp256k1:{implementation:c5,names:["ES256K","secp256k1"]},secp256r1:{implementation:c5,names:["ES256","secp256r1"]},"SHA-256":{implementation:Mne,names:["SHA-256"]}};class Xa{constructor(e){var r;this._algorithmInstances=new Map,this._keyStore=(r=e==null?void 0:e.keyStore)!==null&&r!==void 0?r:new $ne}digest(e){return _a(this,arguments,void 0,function*({algorithm:r,data:n}){return yield this.getAlgorithm({algorithm:r}).digest({algorithm:r,data:n})})}exportKey(e){return _a(this,arguments,void 0,function*({keyUri:r}){return yield this.getPrivateKey({keyUri:r})})}generateKey(e){return _a(this,arguments,void 0,function*({algorithm:r}){const s=yield this.getAlgorithm({algorithm:r}).generateKey({algorithm:r});if((s==null?void 0:s.kid)===void 0)throw new Error("Generated key is missing a required property: kid");const i=`${u5}${s.kid}`;return yield this._keyStore.set(i,s),i})}getKeyUri(e){return _a(this,arguments,void 0,function*({key:r}){const n=yield nr({jwk:r});return`${u5}${n}`})}getPublicKey(e){return _a(this,arguments,void 0,function*({keyUri:r}){const n=yield this.getPrivateKey({keyUri:r}),s=this.getAlgorithmName({key:n});return yield this.getAlgorithm({algorithm:s}).getPublicKey({key:n})})}importKey(e){return _a(this,arguments,void 0,function*({key:r}){var n;if(!Lne(r))throw new TypeError("Invalid key provided. Must be a private key in JWK format.");const s=structuredClone(r);(n=s.kid)!==null&&n!==void 0||(s.kid=yield nr({jwk:s}));const i=yield this.getKeyUri({key:s});return yield this._keyStore.set(i,s),i})}sign(e){return _a(this,arguments,void 0,function*({keyUri:r,data:n}){const s=yield this.getPrivateKey({keyUri:r}),i=this.getAlgorithmName({key:s});return this.getAlgorithm({algorithm:i}).sign({data:n,key:s})})}verify(e){return _a(this,arguments,void 0,function*({key:r,signature:n,data:s}){const i=this.getAlgorithmName({key:r});return this.getAlgorithm({algorithm:i}).verify({key:r,signature:n,data:s})})}getAlgorithm({algorithm:e}){var r;const n=(r=Zw[e])===null||r===void 0?void 0:r.implementation;if(!n)throw new Error(`Algorithm not supported: ${e}`);return this._algorithmInstances.has(n)||this._algorithmInstances.set(n,new n),this._algorithmInstances.get(n)}getAlgorithmName({key:e}){const r=e.alg,n=e.crv;for(const s in Zw){const i=Zw[s];if(r&&i.names.includes(r))return s;if(n&&i.names.includes(n))return s}throw new Error(`Unable to determine algorithm based on provided input: alg=${r}, crv=${n}`)}getPrivateKey(e){return _a(this,arguments,void 0,function*({keyUri:r}){const n=yield this._keyStore.get(r);if(!n)throw new Error(`Key not found: ${r}`);return n})}}function Wne(t){const e={Ed25519:"EdDSA","P-256":"ES256","P-384":"ES384","P-521":"ES512",secp256k1:"ES256K"};if(t.alg&&Object.values(e).includes(t.alg))return t.alg;if(t.crv&&Object.keys(e).includes(t.crv))return e[t.crv];throw new Error(`Unable to determine algorithm based on provided input: alg=${t.alg}, crv=${t.crv}. Supported 'alg' values: ${Object.values(e).join(", ")}. Supported 'crv' values: ${Object.keys(e).join(", ")}.`)}var Cu=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},Jne=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};class $l{static bytesToPrivateKey(e){return Cu(this,arguments,void 0,function*({privateKeyBytes:r}){const n=Tn.getPublicKey(r),s={kty:"OKP",crv:"X25519",d:Me.uint8Array(r).toBase64Url(),x:Me.uint8Array(n).toBase64Url()};return s.kid=yield nr({jwk:s}),s})}static bytesToPublicKey(e){return Cu(this,arguments,void 0,function*({publicKeyBytes:r}){const n={kty:"OKP",crv:"X25519",x:Me.uint8Array(r).toBase64Url()};return n.kid=yield nr({jwk:n}),n})}static computePublicKey(e){return Cu(this,arguments,void 0,function*({key:r}){const n=yield $l.privateKeyToBytes({privateKey:r}),s=Tn.getPublicKey(n),i={kty:"OKP",crv:"X25519",x:Me.uint8Array(s).toBase64Url()};return i.kid=yield nr({jwk:i}),i})}static generateKey(){return Cu(this,void 0,void 0,function*(){const e=Tn.utils.randomPrivateKey(),r=yield $l.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield nr({jwk:r}),r})}static getPublicKey(e){return Cu(this,arguments,void 0,function*({key:r}){var n;if(!(jl(r)&&r.crv==="X25519"))throw new Error("X25519: The provided key is not an X25519 private JWK.");let s=Jne(r,["d"]);return(n=s.kid)!==null&&n!==void 0||(s.kid=yield nr({jwk:s})),s})}static privateKeyToBytes(e){return Cu(this,arguments,void 0,function*({privateKey:r}){if(!jl(r))throw new Error("X25519: The provided key is not a valid OKP private key.");return Me.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return Cu(this,arguments,void 0,function*({publicKey:r}){if(!C2(r))throw new Error("X25519: The provided key is not a valid OKP public key.");return Me.base64Url(r.x).toUint8Array()})}static sharedSecret(e){return Cu(this,arguments,void 0,function*({privateKeyA:r,publicKeyB:n}){if("x"in r&&"x"in n&&r.x===n.x)throw new Error("X25519: ECDH shared secret cannot be computed from a single key pair's public and private keys.");const s=yield $l.privateKeyToBytes({privateKey:r}),i=yield $l.publicKeyToBytes({publicKey:n});return Tn.getSharedSecret(s,i)})}}function qs(t){if(typeof t=="string"&&t.length!==0)return t.split("#").pop()}function RI({didDocument:t}){var e,r;if(!t)throw new TypeError("Required parameter missing: 'didDocument'");const n=[];return n.push(...(r=(e=t.verificationMethod)===null||e===void 0?void 0:e.filter(P1))!==null&&r!==void 0?r:[]),Object.keys(Lh).forEach(s=>{var i,o;n.push(...(o=(i=t[s])===null||i===void 0?void 0:i.filter(P1))!==null&&o!==void 0?o:[])}),n}function Gne({didDocument:t}){const r=RI({didDocument:t}).map(n=>n.type);return[...new Set(r)]}function Zne({didDocument:t,methodId:e}){const r=[];return Object.keys(Lh).forEach(n=>{if(Array.isArray(t[n])){const s=t[n],i=qs(e);s.some(a=>{const c=qs(a)===i,l=P1(a)&&qs(a.id)===i;return c||l})&&r.push(n)}}),r}function P1(t){return!(!t||typeof t!="object"||t===null||!("id"in t&&"type"in t&&"controller"in t)||typeof t.id!="string"||typeof t.type!="string"||typeof t.controller!="string")}function jI({keyBytes:t,multicodecCode:e,multicodecName:r}){const n=Lr.addPrefix({code:e,data:t,name:r}),s=Me.uint8Array(n).toBase58Btc();return Me.base58Btc(s).toMultibase()}function l5({multibaseKeyId:t}){try{const e=Me.multibase(t).toBase58Btc(),r=Me.base58Btc(e).toUint8Array(),{code:n,data:s,name:i}=Lr.removePrefix({prefixedData:r});return{keyBytes:s,multicodecCode:n,multicodecName:i}}catch{throw new Ze(it.InvalidDid,`Invalid multibase identifier: ${t}`)}}var Dp=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};class Wo{constructor({uri:e,document:r,metadata:n,keyManager:s}){this.uri=e,this.document=r,this.metadata=n,this.keyManager=s}export(){return Dp(this,void 0,void 0,function*(){if(!(Array.isArray(this.document.verificationMethod)&&this.document.verificationMethod.length>0))throw new Error(`DID document for '${this.uri}' is missing verification methods`);let e={uri:this.uri,document:this.document,metadata:this.metadata};if("exportKey"in this.keyManager&&typeof this.keyManager.exportKey=="function"){const r=[];for(let n of this.document.verificationMethod){if(!n.publicKeyJwk)throw new Error(`Verification method '${n.id}' does not contain a public key in JWK format`);const s=yield this.keyManager.getKeyUri({key:n.publicKeyJwk}),i=yield this.keyManager.exportKey({keyUri:s});r.push(Object.assign({},i))}e.privateKeys=r}return e})}getSigner(e){return Dp(this,void 0,void 0,function*(){var r;const n=(r=this.document.verificationMethod)===null||r===void 0?void 0:r.find(c=>{var l,u;return qs(c.id)===((l=qs(e==null?void 0:e.methodId))!==null&&l!==void 0?l:qs((u=this.document.assertionMethod)===null||u===void 0?void 0:u[0]))});if(!(n&&n.publicKeyJwk))throw new Ze(it.InternalError,"A verification method intended for signing could not be determined from the DID Document");const s=yield this.keyManager.getKeyUri({key:n.publicKeyJwk}),i=yield this.keyManager.getPublicKey({keyUri:s}),o=this.keyManager;return{algorithm:Wne(i),keyId:n.id,sign(c){return Dp(this,arguments,void 0,function*({data:l}){return yield o.sign({data:l,keyUri:s})})},verify(c){return Dp(this,arguments,void 0,function*({data:l,signature:u}){return yield o.verify({data:l,key:i,signature:u})})}}})}static import(e){return Dp(this,arguments,void 0,function*({portableDid:r,keyManager:n=new Xa}){var s;const i=RI({didDocument:r.document});if(i.length===0)throw new Ze(it.InvalidDidDocument,"At least one verification method is required but 0 were given");for(let a of(s=r.privateKeys)!==null&&s!==void 0?s:[])yield n.importKey({key:a});for(let a of i){if(!a.publicKeyJwk)throw new Error(`Verification method '${a.id}' does not contain a public key in JWK format`);const c=yield n.getKeyUri({key:a.publicKeyJwk});yield n.getPublicKey({keyUri:c})}return new Wo({uri:r.uri,document:r.document,metadata:r.metadata,keyManager:n})})}}var d5=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};class gy{static getSigningMethod(e){return d5(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement getSigningMethod()")})}static resolve(e,r){return d5(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement resolve()")})}}var ln=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},f5=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};const p5="https://diddht.tbddev.org",Xne=0,ku=7200,w0=";",zn=",";var C1;(function(t){t[t.Discoverable=0]="Discoverable",t[t.Organization=1]="Organization",t[t.Government=2]="Government",t[t.Corporation=3]="Corporation",t[t.LocalBusiness=4]="LocalBusiness",t[t.SoftwarePackage=5]="SoftwarePackage",t[t.WebApp=6]="WebApp",t[t.FinancialInstitution=7]="FinancialInstitution"})(C1||(C1={}));var Yn;(function(t){t[t.Ed25519=0]="Ed25519",t[t.secp256k1=1]="secp256k1",t[t.secp256r1=2]="secp256r1",t[t.X25519=3]="X25519"})(Yn||(Yn={}));var k1;(function(t){t.authentication="auth",t.assertionMethod="asm",t.capabilityDelegation="del",t.capabilityInvocation="inv",t.keyAgreement="agm"})(k1||(k1={}));const MI={Ed25519:Yn.Ed25519,ES256K:Yn.secp256k1,ES256:Yn.secp256r1,"P-256":Yn.secp256r1,secp256k1:Yn.secp256k1,secp256r1:Yn.secp256r1,X25519:Yn.X25519},h5={[Yn.Ed25519]:"EdDSA",[Yn.secp256k1]:"ES256K",[Yn.secp256r1]:"ES256",[Yn.X25519]:"ECDH-ES+A256KW"};class vc extends gy{static create(){return ln(this,arguments,void 0,function*({keyManager:e=new Xa,options:r={}}={}){var n,s,i,o,a,c,l,u,d,h,f;if(!((n=r.verificationMethods)===null||n===void 0)&&n.some(_=>!(_.algorithm in MI)))throw new Error("One or more verification method algorithms are not supported");const p=(s=r.verificationMethods)===null||s===void 0?void 0:s.filter(_=>"id"in _).map(_=>_.id);if(p&&p.length!==new Set(p).size)throw new Error("One or more verification method IDs are not unique");if(!((i=r.services)===null||i===void 0)&&i.some(_=>!_.id||!_.type||!_.serviceEndpoint))throw new Error("One or more services are missing required properties");const y=yield e.generateKey({algorithm:"Ed25519"}),b=yield e.getPublicKey({keyUri:y}),w=yield Kr.identityKeyToIdentifier({identityKey:b}),g=Object.assign(Object.assign({id:w},r.alsoKnownAs&&{alsoKnownAs:r.alsoKnownAs}),r.controllers&&{controller:r.controllers}),v=[...(o=r.verificationMethods)!==null&&o!==void 0?o:[]];v!=null&&v.some(_=>{var x;return((x=_.id)===null||x===void 0?void 0:x.split("#").pop())==="0"})||v.unshift({algorithm:"Ed25519",id:"0",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]});for(const _ of v){const x=_.id&&_.id.split("#").pop()==="0"?y:yield e.generateKey({algorithm:_.algorithm}),D=yield e.getPublicKey({keyUri:x});let E=(c=(a=_.id)!==null&&a!==void 0?a:D.kid)!==null&&c!==void 0?c:yield nr({jwk:D});E=`${w}#${qs(E)}`,(l=g.verificationMethod)!==null&&l!==void 0||(g.verificationMethod=[]),g.verificationMethod.push({id:E,type:"JsonWebKey",controller:(u=_.controller)!==null&&u!==void 0?u:w,publicKeyJwk:D});for(const A of(d=_.purposes)!==null&&d!==void 0?d:[])g[A]||(g[A]=[]),g[A].push(E)}(h=r.services)===null||h===void 0||h.forEach(_=>{var x;(x=g.service)!==null&&x!==void 0||(g.service=[]),_.id=`${w}#${_.id.split("#").pop()}`,g.service.push(_)});const m=new Wo({uri:w,document:g,metadata:Object.assign({published:!1},r.types&&{types:r.types}),keyManager:e});if(!((f=r.publish)!==null&&f!==void 0)||f){const _=yield vc.publish({did:m,gatewayUri:r.gatewayUri});m.metadata=_.didDocumentMetadata}return m})}static import(e){return ln(this,arguments,void 0,function*({portableDid:r,keyManager:n=new Xa}){var s;const i=Gt.parse(r.uri);if((i==null?void 0:i.method)!==vc.methodName)throw new Ze(it.MethodNotSupported,"Method not supported");const o=yield Wo.import({portableDid:r,keyManager:n});if(!(!((s=o.document.verificationMethod)===null||s===void 0)&&s.some(a=>{var c;return((c=a.id)===null||c===void 0?void 0:c.split("#").pop())==="0"})))throw new Ze(it.InvalidDidDocument,"DID document must contain an Identity Key");return o})}static getSigningMethod(e){return ln(this,arguments,void 0,function*({didDocument:r,methodId:n="#0"}){var s;const i=Gt.parse(r.id);if(i&&i.method!==this.methodName)throw new Ze(it.MethodNotSupported,`Method not supported: ${i.method}`);const o=(s=r.verificationMethod)===null||s===void 0?void 0:s.find(a=>{var c,l;return qs(a.id)===((c=qs(n))!==null&&c!==void 0?c:qs((l=r.assertionMethod)===null||l===void 0?void 0:l[0]))});if(!(o&&o.publicKeyJwk))throw new Ze(it.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static publish(e){return ln(this,arguments,void 0,function*({did:r,gatewayUri:n=p5}){return yield Na.put({did:r,gatewayUri:n})})}static resolve(e){return ln(this,arguments,void 0,function*(r,n={}){var s;const i=(s=n==null?void 0:n.gatewayUri)!==null&&s!==void 0?s:p5;try{yield Kr.identifierToIdentityKey({didUri:r});const{didDocument:o,didDocumentMetadata:a}=yield Na.get({didUri:r,gatewayUri:i});return Object.assign(Object.assign({},ei),{didDocument:o,didDocumentMetadata:a})}catch(o){if(!(o instanceof Ze))throw new Error(o);return Object.assign(Object.assign({},ei),{didResolutionMetadata:Object.assign({error:o.code},o.message&&{errorMessage:o.message})})}})}}vc.methodName="dht";class Na{static get(e){return ln(this,arguments,void 0,function*({didUri:r,gatewayUri:n}){const s=Kr.identifierToIdentityKeyBytes({didUri:r}),i=yield Na.pkarrGet({gatewayUri:n,publicKeyBytes:s}),o=yield Kr.parseBep44GetMessage({bep44Message:i}),a=yield Na.fromDnsPacket({didUri:r,dnsPacket:o});return a.didDocumentMetadata.versionId=i.seq.toString(),a})}static put(e){return ln(this,arguments,void 0,function*({did:r,gatewayUri:n}){const s=yield Na.toDnsPacket({didDocument:r.document,didMetadata:r.metadata,authoritativeGatewayUris:[n]}),i=yield Kr.createBep44PutMessage({dnsPacket:s,publicKeyBytes:Kr.identifierToIdentityKeyBytes({didUri:r.uri}),signer:yield r.getSigner({methodId:"0"})}),o=yield Na.pkarrPut({gatewayUri:n,bep44Message:i});return{didDocument:r.document,didDocumentMetadata:Object.assign(Object.assign({},r.metadata),{published:o,versionId:i.seq.toString()}),didRegistrationMetadata:{}}})}static pkarrGet(e){return ln(this,arguments,void 0,function*({gatewayUri:r,publicKeyBytes:n}){const s=Me.uint8Array(n).toBase32Z(),i=new URL(s,r).href;let o;try{if(o=yield fetch(i,{method:"GET"}),!o.ok)throw new Ze(it.NotFound,`Pkarr record not found for: ${s}`)}catch(l){throw l instanceof Ze?l:new Ze(it.InternalError,`Failed to fetch Pkarr record: ${l.message}`)}const a=yield o.arrayBuffer();if(!a)throw new Ze(it.NotFound,`Pkarr record not found for: ${s}`);if(a.byteLength<72)throw new Ze(it.InvalidDidDocumentLength,`Pkarr response must be at least 72 bytes but got: ${a.byteLength}`);if(a.byteLength>1072)throw new Ze(it.InvalidDidDocumentLength,`Pkarr response exceeds 1000 byte limit: ${a.byteLength}`);return{k:n,seq:Number(new DataView(a).getBigUint64(64)),sig:new Uint8Array(a,0,64),v:new Uint8Array(a,72)}})}static pkarrPut(e){return ln(this,arguments,void 0,function*({gatewayUri:r,bep44Message:n}){const s=Me.uint8Array(n.k).toBase32Z(),i=new URL(s,r).href,o=new Uint8Array(n.v.length+72);o.set(n.sig,0),new DataView(o.buffer).setBigUint64(n.sig.length,BigInt(n.seq)),o.set(n.v,n.sig.length+8);let a;try{a=yield fetch(i,{method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:o})}catch(c){throw new Ze(it.InternalError,`Failed to put Pkarr record for identifier ${s}: ${c.message}`)}return a.ok})}static fromDnsPacket(e){return ln(this,arguments,void 0,function*({didUri:r,dnsPacket:n}){var s,i,o;const a={id:r},c={published:!0},l=new Map;for(const u of(s=n==null?void 0:n.answers)!==null&&s!==void 0?s:[]){if(u.type!=="TXT")continue;const d=u.name.split(".")[0].substring(1);switch(!0){case d.startsWith("aka"):{const h=Kr.parseTxtDataToString(u.data);a.alsoKnownAs=h.split(zn);break}case d.startsWith("cnt"):{const h=Kr.parseTxtDataToString(u.data);a.controller=h.includes(zn)?h.split(zn):h;break}case d.startsWith("k"):{const{id:h,t:f,k:p,c:y,a:b}=Kr.parseTxtDataToObject(u.data),w=Me.base64Url(p).toUint8Array(),g=Yn[Number(f)];let v=yield Kr.keyConverter(g).bytesToPublicKey({publicKeyBytes:w});v.alg=b||h5[Number(f)];const m=d==="k0"?"0":h!==void 0?h:yield nr({jwk:v});(i=a.verificationMethod)!==null&&i!==void 0||(a.verificationMethod=[]);const _=`${r}#${m}`;a.verificationMethod.push({id:_,type:"JsonWebKey",controller:y??r,publicKeyJwk:v}),l.set(d,_);break}case d.startsWith("s"):{const h=Kr.parseTxtDataToObject(u.data),{id:f,t:p,se:y}=h,b=f5(h,["id","t","se"]),w=y.includes(zn)?y.split(zn):[y],g=Object.fromEntries(Object.entries(b).map(([v,m])=>[v,m.includes(zn)?m.split(zn):m]));(o=a.service)!==null&&o!==void 0||(a.service=[]),a.service.push(Object.assign(Object.assign({},g),{id:`${r}#${f}`,type:p,serviceEndpoint:w}));break}case d.startsWith("typ"):{const{id:h}=Kr.parseTxtDataToObject(u.data);c.types=h.split(zn).map(f=>Number(f));break}case d.startsWith("did"):{const h=g=>g.split(zn).map(v=>l.get(v)).filter(v=>typeof v=="string"),{auth:f,asm:p,del:y,inv:b,agm:w}=Kr.parseTxtDataToObject(u.data);f&&(a.authentication=h(f)),p&&(a.assertionMethod=h(p)),y&&(a.capabilityDelegation=h(y)),b&&(a.capabilityInvocation=h(b)),w&&(a.keyAgreement=h(w));break}}}return{didDocument:a,didDocumentMetadata:c,didResolutionMetadata:{}}})}static toDnsPacket(e){return ln(this,arguments,void 0,function*({didDocument:r,didMetadata:n,authoritativeGatewayUris:s,previousDidProof:i}){var o,a,c,l,u;const d=[],h=[],f=new Map,p=[],y=[];if(i!==void 0){const{signature:g,previousDid:v}=i;yield Kr.validatePreviousDidProof({newDid:r.id,previousDidProof:i}),d.push({type:"TXT",name:"_prv._did.",ttl:ku,data:`id=${v};s=${g}`})}if(r.alsoKnownAs&&d.push({type:"TXT",name:"_aka._did.",ttl:ku,data:r.alsoKnownAs.join(zn)}),r.controller){const g=Array.isArray(r.controller)?r.controller.join(zn):r.controller;d.push({type:"TXT",name:"_cnt._did.",ttl:ku,data:g})}for(const[g,v]of(a=(o=r.verificationMethod)===null||o===void 0?void 0:o.entries())!==null&&a!==void 0?a:[]){const m=`k${g}`;y.push(m);let _=v.id.split("#").pop();f.set(_,m);const x=v.publicKeyJwk;if(!(x!=null&&x.crv&&x.crv in MI))throw new Ze(it.InvalidPublicKeyType,`Verification method '${v.id}' contains an unsupported key type: ${(c=x==null?void 0:x.crv)!==null&&c!==void 0?c:"undefined"}`);const D=Yn[x.crv],E=yield Kr.keyConverter(x.crv).publicKeyToBytes({publicKey:x}),A=Me.uint8Array(E).toBase64Url(),S=[`t=${D}`,`k=${A}`];_!=="0"&&(yield nr({jwk:x}))!==_&&S.unshift(`id=${_}`),x.alg!==h5[D]&&S.push(`a=${x.alg}`),v.controller!==r.id&&S.push(`c=${v.controller}`),d.push({type:"TXT",name:`_${m}._did.`,ttl:ku,data:S.join(w0)})}(l=r.service)===null||l===void 0||l.forEach((g,v)=>{const m=`s${v}`;p.push(m);let{id:_,type:x,serviceEndpoint:D}=g,E=f5(g,["id","type","serviceEndpoint"]);_=qs(_),D=Array.isArray(D)?D.join(","):D;const S=Object.entries(Object.assign({id:_,t:x,se:D},E)).map(([I,N])=>`${I}=${N}`).join(w0),O=Kr.chunkDataIfNeeded(S);d.push({type:"TXT",name:`_${m}._did.`,ttl:ku,data:O})});const b=[`v=${Xne}`];if(y.length&&b.push(`vm=${y.join(zn)}`),Object.keys(Lh).forEach(g=>{var v;const m=(v=r[g])===null||v===void 0?void 0:v.map(_=>f.get(_.split("#").pop()));if(m){const _=k1[g];b.push(`${_}=${m.join(zn)}`)}}),p.length&&b.push(`svc=${p.join(zn)}`),!((u=n.types)===null||u===void 0)&&u.length){const v=n.types.map(m=>typeof m=="string"?C1[m]:m);d.push({type:"TXT",name:"_typ._did.",ttl:ku,data:`id=${v.join(zn)}`})}d.push({type:"TXT",name:"_did."+Na.getUniqueDidSuffix(r.id)+".",ttl:ku,data:b.join(w0)});for(const g of s||[])h.push({type:"NS",name:"_did."+Na.getUniqueDidSuffix(r.id)+".",ttl:ku,data:g+"."});return{id:0,type:"response",flags:__,answers:[...d,...h]}})}static getUniqueDidSuffix(e){return e.split(":")[2]}}class Kr{static createBep44PutMessage(e){return ln(this,arguments,void 0,function*({dnsPacket:r,publicKeyBytes:n,signer:s}){const i=Math.ceil(Date.now()/1e3),o=Eh(r),a=Qd.encode({seq:i,v:o}).subarray(1,-1);if(a.length>1e3)throw new Ze(it.InvalidDidDocumentLength,`DNS packet exceeds the 1000 byte maximum size: ${a.length} bytes`);const c=yield s.sign({data:a});return{k:n,seq:i,sig:c,v:o}})}static identifierToIdentityKey(e){return ln(this,arguments,void 0,function*({didUri:r}){let n=Kr.identifierToIdentityKeyBytes({didUri:r});return yield Pr.bytesToPublicKey({publicKeyBytes:n})})}static identifierToIdentityKeyBytes({didUri:e}){const r=Gt.parse(e);if(!r)throw new Ze(it.InvalidDid,`Invalid DID URI: ${e}`);if(r.method!==vc.methodName)throw new Ze(it.MethodNotSupported,`Method not supported: ${r.method}`);let n;try{n=Me.base32Z(r.id).toUint8Array()}catch{throw new Ze(it.InvalidPublicKey,"Failed to decode method-specific identifier")}if(n.length!==32)throw new Ze(it.InvalidPublicKeyLength,`Invalid public key length: ${n.length}`);return n}static identityKeyToIdentifier(e){return ln(this,arguments,void 0,function*({identityKey:r}){const n=yield Pr.publicKeyToBytes({publicKey:r}),s=Me.uint8Array(n).toBase32Z();return`did:${vc.methodName}:${s}`})}static keyConverter(e){const n={Ed25519:Pr,"P-256":{publicKeyToBytes:s=>ln(this,[s],void 0,function*({publicKey:i}){const o=yield Dr.publicKeyToBytes({publicKey:i});return yield Dr.compressPublicKey({publicKeyBytes:o})}),bytesToPublicKey:Dr.bytesToPublicKey,privateKeyToBytes:Dr.privateKeyToBytes,bytesToPrivateKey:Dr.bytesToPrivateKey},secp256k1:{publicKeyToBytes:s=>ln(this,[s],void 0,function*({publicKey:i}){const o=yield Sr.publicKeyToBytes({publicKey:i});return yield Sr.compressPublicKey({publicKeyBytes:o})}),bytesToPublicKey:Sr.bytesToPublicKey,privateKeyToBytes:Sr.privateKeyToBytes,bytesToPrivateKey:Sr.bytesToPrivateKey},X25519:$l}[e];if(!n)throw new Ze(it.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static parseBep44GetMessage(e){return ln(this,arguments,void 0,function*({bep44Message:r}){const n=yield Pr.bytesToPublicKey({publicKeyBytes:r.k}),s=Qd.encode({seq:r.seq,v:r.v}).subarray(1,-1);if(!(yield Pr.verify({key:n,signature:r.sig,data:s})))throw new Ze(it.InvalidSignature,"Invalid signature for DHT BEP44 message");return E_(r.v)})}static parseTxtDataToObject(e){return this.parseTxtDataToString(e).split(w0).reduce((r,n)=>{const[s,i]=n.split("=");return r[s]=i,r},{})}static parseTxtDataToString(e){if(typeof e=="string")return e;if(e instanceof Uint8Array)return Me.uint8Array(e).toString();if(Array.isArray(e))return e.map(r=>this.parseTxtDataToString(r)).join("");throw new Ze(it.InternalError,"Pkarr returned DNS TXT record with invalid data type")}static validatePreviousDidProof(e){return ln(this,arguments,void 0,function*({newDid:r,previousDidProof:n}){const s=yield Kr.identifierToIdentityKey({didUri:n.previousDid}),i=Kr.identifierToIdentityKeyBytes({didUri:r}),o=Me.base64Url(n.signature).toUint8Array();if(!(yield Pr.verify({key:s,data:i,signature:o})))throw new Ze(it.InvalidPreviousDidProof,"The previous DID proof is invalid.")})}static chunkDataIfNeeded(e){if(e.length<=255)return e;const r=[];for(let n=0;n<e.length;n+=255)r.push(e.slice(n,n+255));return r}}var tc=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},Do;(function(t){t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.secp256r1="secp256r1",t.X25519="X25519"})(Do||(Do={}));const Yne={Ed25519:Do.Ed25519,ES256K:Do.secp256k1,ES256:Do.secp256r1,"P-256":Do.secp256r1,secp256k1:Do.secp256k1,secp256r1:Do.secp256r1},y5="https://ion.tbd.engineering";class Nd extends gy{static create(){return tc(this,arguments,void 0,function*({keyManager:e=new Xa,options:r={}}={}){var n,s,i,o,a,c,l;if(!((n=r.verificationMethods)===null||n===void 0)&&n.some(_=>!(_.algorithm in Yne)))throw new Error("One or more verification method algorithms are not supported");const u=(s=r.verificationMethods)===null||s===void 0?void 0:s.filter(_=>"id"in _).map(_=>_.id);if(u&&u.length!==new Set(u).size)throw new Error("One or more verification method IDs are not unique");if(!((i=r.services)===null||i===void 0)&&i.some(_=>!_.id||!_.type||!_.serviceEndpoint))throw new Error("One or more services are missing required properties");const d={algorithm:"Ed25519",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]},h=[];for(const _ of(o=r.verificationMethods)!==null&&o!==void 0?o:[d]){const x=yield e.generateKey({algorithm:_.algorithm}),D=yield e.getPublicKey({keyUri:x});h.push({id:_.id,publicKeyJwk:D,purposes:(a=_.purposes)!==null&&a!==void 0?a:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]})}const f=yield e.generateKey({algorithm:Do.secp256k1}),p=yield e.getPublicKey({keyUri:f}),y=yield e.generateKey({algorithm:Do.secp256k1}),b=yield e.getPublicKey({keyUri:y}),w=yield ds.computeLongFormDidUri({recoveryKey:p,updateKey:b,services:(c=r.services)!==null&&c!==void 0?c:[],verificationMethods:h}),{didDocument:g,didResolutionMetadata:v}=yield Nd.resolve(w,{gatewayUri:r.gatewayUri});if(g===null)throw new Error(`Unable to resolve DID during creation: ${v==null?void 0:v.error}`);const m=new Wo({uri:w,document:g,metadata:{published:!1,canonicalId:w.split(":",3).join(":"),recoveryKey:p,updateKey:b},keyManager:e});if(!((l=r.publish)!==null&&l!==void 0)||l){const _=yield Nd.publish({did:m,gatewayUri:r.gatewayUri});m.metadata=_.didDocumentMetadata}return m})}static getSigningMethod(e){return tc(this,arguments,void 0,function*({didDocument:r,methodId:n}){var s;const i=Gt.parse(r.id);if(i&&i.method!==this.methodName)throw new Ze(it.MethodNotSupported,`Method not supported: ${i.method}`);const o=(s=r.verificationMethod)===null||s===void 0?void 0:s.find(a=>{var c;return a.id===(n??((c=r.assertionMethod)===null||c===void 0?void 0:c[0]))});if(!(o&&o.publicKeyJwk))throw new Ze(it.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static import(e){return tc(this,arguments,void 0,function*({portableDid:r,keyManager:n=new Xa}){const s=Gt.parse(r.uri);if((s==null?void 0:s.method)!==Nd.methodName)throw new Ze(it.MethodNotSupported,"Method not supported");return yield Wo.import({portableDid:r,keyManager:n})})}static publish(e){return tc(this,arguments,void 0,function*({did:r,gatewayUri:n=y5}){var s,i,o;const a=(i=(s=r.document.verificationMethod)===null||s===void 0?void 0:s.map(u=>({id:u.id,publicKeyJwk:u.publicKeyJwk,purposes:Zne({didDocument:r.document,methodId:u.id})})))!==null&&i!==void 0?i:[],c=yield ds.createIonDocument({services:(o=r.document.service)!==null&&o!==void 0?o:[],verificationMethods:a}),l=yield ds.constructCreateRequest({ionDocument:c,recoveryKey:r.metadata.recoveryKey,updateKey:r.metadata.updateKey});try{const u=ds.appendPathToUrl({baseUrl:n,path:"/operations"}),d=yield fetch(u,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});return{didDocument:r.document,didDocumentMetadata:Object.assign(Object.assign({},r.metadata),{published:d.ok}),didRegistrationMetadata:{}}}catch{return{didDocument:null,didDocumentMetadata:{published:!1},didRegistrationMetadata:{error:it.InternalError,errorMessage:`Failed to publish DID document for: ${r.uri}`}}}})}static resolve(e){return tc(this,arguments,void 0,function*(r,n={}){var s,i;const o=Gt.parse(r);if(!o)return Object.assign(Object.assign({},ei),{didResolutionMetadata:{error:"invalidDid"}});if(o.method!==Nd.methodName)return Object.assign(Object.assign({},ei),{didResolutionMetadata:{error:"methodNotSupported"}});const a=(s=n==null?void 0:n.gatewayUri)!==null&&s!==void 0?s:y5;try{const c=ds.appendPathToUrl({baseUrl:a,path:`/identifiers/${r}`}),l=yield fetch(c);if(!l.ok)throw new Ze(it.NotFound,`Unable to find DID document for: ${r}`);const{didDocument:u,didDocumentMetadata:d}=yield l.json();return Object.assign(Object.assign(Object.assign({},ei),u&&{didDocument:u}),{didDocumentMetadata:Object.assign({published:(i=d==null?void 0:d.method)===null||i===void 0?void 0:i.published},d)})}catch(c){if(!(c instanceof Ze))throw new Error(c);return Object.assign(Object.assign({},ei),{didResolutionMetadata:Object.assign({error:c.code},c.message&&{errorMessage:c.message})})}})}}Nd.methodName="ion";class ds{static appendPathToUrl({baseUrl:e,path:r}){const n=new URL(e);return n.pathname=n.pathname.endsWith("/")?n.pathname:n.pathname+"/",n.pathname+=r.startsWith("/")?r.substring(1):r,n.toString()}static computeLongFormDidUri(e){return tc(this,arguments,void 0,function*({recoveryKey:r,updateKey:n,services:s,verificationMethods:i}){const o=yield ds.createIonDocument({services:s,verificationMethods:i}),a=ds.normalizeJwk(r),c=ds.normalizeJwk(n);return yield ty.createLongFormDid({document:o,recoveryKey:a,updateKey:c})})}static constructCreateRequest(e){return tc(this,arguments,void 0,function*({ionDocument:r,recoveryKey:n,updateKey:s}){return yield Kn.createCreateRequest({document:r,recoveryKey:ds.normalizeJwk(n),updateKey:ds.normalizeJwk(s)})})}static createIonDocument(e){return tc(this,arguments,void 0,function*({services:r,verificationMethods:n}){var s,i;const o=[];for(const l of n){let u=(i=(s=l.id)!==null&&s!==void 0?s:l.publicKeyJwk.kid)!==null&&i!==void 0?i:yield nr({jwk:l.publicKeyJwk});u=`${u.split("#").pop()}`;const d={id:u,publicKeyJwk:ds.normalizeJwk(l.publicKeyJwk),purposes:l.purposes,type:"JsonWebKey2020"};o.push(d)}const a=r.map(l=>Object.assign(Object.assign({},l),{id:`${l.id.split("#").pop()}`}));return{publicKeys:o,services:a}})}static normalizeJwk(e){const r=e.kty;let n;if(r==="EC")n={crv:e.crv,kty:e.kty,x:e.x,y:e.y};else if(r==="oct")n={k:e.k,kty:e.kty};else if(r==="OKP")n={crv:e.crv,kty:e.kty,x:e.x};else if(r==="RSA")n={e:e.e,kty:e.kty,n:e.n};else throw new Error(`Unsupported key type: ${r}`);return n}}var Tm=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};class Rd extends gy{static create(){return Tm(this,arguments,void 0,function*({keyManager:e=new Xa,options:r={}}={}){var n,s,i,o;if(r.algorithm&&r.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(r.verificationMethods&&r.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");const a=(o=(n=r.algorithm)!==null&&n!==void 0?n:(i=(s=r.verificationMethods)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.algorithm)!==null&&o!==void 0?o:"Ed25519",c=yield e.generateKey({algorithm:a}),l=yield e.getPublicKey({keyUri:c}),u=Me.object(l).toBase64Url(),d=`did:${Rd.methodName}:${u}`,f=(yield Rd.resolve(d)).didDocument;return new Wo({uri:d,document:f,metadata:{},keyManager:e})})}static getSigningMethod(e){return Tm(this,arguments,void 0,function*({didDocument:r}){var n;const s=Gt.parse(r.id);if(s&&s.method!==this.methodName)throw new Ze(it.MethodNotSupported,`Method not supported: ${s.method}`);const[i]=(n=r.verificationMethod)!==null&&n!==void 0?n:[];if(!(i&&i.publicKeyJwk))throw new Ze(it.InternalError,"A verification method intended for signing could not be determined from the DID Document");return i})}static import(e){return Tm(this,arguments,void 0,function*({portableDid:r,keyManager:n=new Xa}){const s=Gt.parse(r.uri);if((s==null?void 0:s.method)!==Rd.methodName)throw new Ze(it.MethodNotSupported,"Method not supported");const i=yield Wo.import({portableDid:r,keyManager:n});if(i.document.verificationMethod.length!==1)throw new Ze(it.InvalidDidDocument,"DID document must contain exactly one verification method");return i})}static resolve(e,r){return Tm(this,void 0,void 0,function*(){const n=Gt.parse(e);let s;try{s=Me.base64Url(n.id).toObject()}catch{}if(!n||!s)return Object.assign(Object.assign({},ei),{didResolutionMetadata:{error:"invalidDid"}});if(n.method!==Rd.methodName)return Object.assign(Object.assign({},ei),{didResolutionMetadata:{error:"methodNotSupported"}});const i={"@context":["https://www.w3.org/ns/did/v1"],id:n.uri},o=`${i.id}#0`;switch(i.verificationMethod=[{id:o,type:"JsonWebKey",controller:i.id,publicKeyJwk:s}],i.authentication=[o],i.assertionMethod=[o],i.capabilityInvocation=[o],i.capabilityDelegation=[o],i.keyAgreement=[o],s.use){case"sig":{delete i.keyAgreement;break}case"enc":{delete i.authentication,delete i.assertionMethod,delete i.capabilityInvocation,delete i.capabilityDelegation;break}}return Object.assign(Object.assign({},ei),{didDocument:i})})}}Rd.methodName="jwk";var js=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})},Da;(function(t){t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.secp256r1="secp256r1",t.X25519="X25519"})(Da||(Da={}));const Xw={Ed25519VerificationKey2020:"https://w3id.org/security/suites/ed25519-2020/v1",JsonWebKey2020:"https://w3id.org/security/suites/jws-2020/v1",X25519KeyAgreementKey2020:"https://w3id.org/security/suites/x25519-2020/v1"},Qne={Ed25519:Da.Ed25519,ES256K:Da.secp256k1,ES256:Da.secp256r1,"P-256":Da.secp256r1,secp256k1:Da.secp256k1,secp256r1:Da.secp256r1,X25519:Da.X25519};class _o extends gy{static create(){return js(this,arguments,void 0,function*({keyManager:e=new Xa,options:r={}}={}){var n,s,i,o;if(r.algorithm&&r.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(r.verificationMethods&&r.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");const a=(o=(n=r.algorithm)!==null&&n!==void 0?n:(i=(s=r.verificationMethods)===null||s===void 0?void 0:s[0])===null||i===void 0?void 0:i.algorithm)!==null&&o!==void 0?o:"Ed25519",c=yield e.generateKey({algorithm:a}),l=yield e.getPublicKey({keyUri:c}),u=yield an.publicKeyToMultibaseId({publicKey:l}),d=`did:${_o.methodName}:${u}`,f=(yield _o.resolve(d,r)).didDocument;return new Wo({uri:d,document:f,metadata:{},keyManager:e})})}static getSigningMethod(e){return js(this,arguments,void 0,function*({didDocument:r}){var n;const s=Gt.parse(r.id);if(s&&s.method!==this.methodName)throw new Ze(it.MethodNotSupported,`Method not supported: ${s.method}`);const[i]=r.assertionMethod||[],o=(n=r.verificationMethod)===null||n===void 0?void 0:n.find(a=>a.id===i);if(!(o&&o.publicKeyJwk))throw new Ze(it.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static import(e){return js(this,arguments,void 0,function*({portableDid:r,keyManager:n=new Xa}){const s=Gt.parse(r.uri);if((s==null?void 0:s.method)!==_o.methodName)throw new Ze(it.MethodNotSupported,"Method not supported");const i=yield Wo.import({portableDid:r,keyManager:n});if(i.document.verificationMethod.length!==1)throw new Ze(it.InvalidDidDocument,"DID document must contain exactly one verification method");return i})}static resolve(e,r){return js(this,void 0,void 0,function*(){try{const n=yield _o.createDocument({didUri:e,options:r});return Object.assign(Object.assign({},ei),{didDocument:n})}catch(n){if(!(n instanceof Ze))throw new Error(n);return Object.assign(Object.assign({},ei),{didResolutionMetadata:Object.assign({error:n.code},n.message&&{errorMessage:n.message})})}})}static createDocument(e){return js(this,arguments,void 0,function*({didUri:r,options:n={}}){const{defaultContext:s="https://www.w3.org/ns/did/v1",enableEncryptionKeyDerivation:i=!1,enableExperimentalPublicKeyTypes:o=!1,publicKeyFormat:a="JsonWebKey2020"}=n,c={id:""},l=Gt.parse(r);if(!l)throw new Ze(it.InvalidDid,`Invalid DID URI: ${r}`);const u=l.id;if(l.method!==_o.methodName)throw new Ze(it.MethodNotSupported,`Method not supported: ${l.method}`);if(!_o.validateIdentifier(l))throw new Ze(it.InvalidDid,`Invalid DID URI: ${r}`);const d=yield _o.createSignatureMethod({didUri:r,multibaseValue:u,options:{enableExperimentalPublicKeyTypes:o,publicKeyFormat:a}});if(c.id=l.uri,c.verificationMethod=[d],c.authentication=[d.id],c.assertionMethod=[d.id],c.capabilityInvocation=[d.id],c.capabilityDelegation=[d.id],i===!0){const p=a==="Ed25519VerificationKey2020"?"X25519KeyAgreementKey2020":"JsonWebKey2020",y=yield this.createEncryptionMethod({didUri:r,multibaseValue:u,options:{enableExperimentalPublicKeyTypes:o,publicKeyFormat:p}});c.verificationMethod.push(y),c.keyAgreement=[y.id]}const h=[s];return Gne({didDocument:c}).forEach(p=>{const y=Xw[p];h.push(y)}),c["@context"]=h,c})}static createEncryptionMethod(e){return js(this,arguments,void 0,function*({didUri:r,multibaseValue:n,options:s}){const{enableExperimentalPublicKeyTypes:i,publicKeyFormat:o}=s,a={id:"",type:"",controller:""},{keyBytes:c,multicodecCode:l}=yield _o.deriveEncryptionKey({multibaseValue:n}),u=c.byteLength,d=an.MULTICODEC_PUBLIC_KEY_LENGTH[l];if(u!==d)throw new Ze(it.InvalidPublicKeyLength,`Expected ${u} bytes. Actual: ${d}`);const h=jI({keyBytes:c,multicodecCode:l});a.id=`${r}#${h}`;try{new URL(a.id)}catch{throw new Ze(it.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(o in Xw))throw new Ze(it.UnsupportedPublicKeyType,`Unsupported format: ${o}`);if(i===!1&&!["Multikey","JsonWebKey2020","X25519KeyAgreementKey2020"].includes(o))throw new Ze(it.InvalidPublicKeyType,`Specified '${o}' without setting enableExperimentalPublicKeyTypes to true.`);if(a.type=o,a.controller=r,o==="X25519KeyAgreementKey2020"&&(a.publicKeyMultibase=h),o==="JsonWebKey2020"){const{crv:p}=yield an.multicodecToJwk({code:l});a.publicKeyJwk=yield an.keyConverter(p).bytesToPublicKey({publicKeyBytes:c})}return a})}static createSignatureMethod(e){return js(this,arguments,void 0,function*({didUri:r,multibaseValue:n,options:s}){const{enableExperimentalPublicKeyTypes:i,publicKeyFormat:o}=s,a={id:"",type:"",controller:""},{keyBytes:c,multicodecCode:l,multicodecName:u}=l5({multibaseKeyId:n}),d=c.byteLength,h=an.MULTICODEC_PUBLIC_KEY_LENGTH[l];if(d!==h)throw new Ze(it.InvalidPublicKeyLength,`Expected ${d} bytes. Actual: ${h}`);let f=!1;switch(u){case"secp256k1-pub":f=yield Sr.validatePublicKey({publicKeyBytes:c});break;case"ed25519-pub":f=yield Pr.validatePublicKey({publicKeyBytes:c});break;case"x25519-pub":f=!0;break}if(!f)throw new Ze(it.InvalidPublicKey,"Invalid public key detected.");a.id=`${r}#${n}`;try{new URL(a.id)}catch{throw new Ze(it.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(o in Xw))throw new Ze(it.UnsupportedPublicKeyType,`Unsupported format: ${o}`);if(i===!1&&!["Multikey","JsonWebKey2020","Ed25519VerificationKey2020"].includes(o))throw new Ze(it.InvalidPublicKeyType,`Specified '${o}' without setting enableExperimentalPublicKeyTypes to true.`);if(a.type=o,a.controller=r,o==="Ed25519VerificationKey2020"&&(a.publicKeyMultibase=n),o==="JsonWebKey2020"){const{crv:y}=yield an.multicodecToJwk({code:l});a.publicKeyJwk=yield an.keyConverter(y).bytesToPublicKey({publicKeyBytes:c})}return a})}static deriveEncryptionKey(e){return js(this,arguments,void 0,function*({multibaseValue:r}){let n={keyBytes:new Uint8Array,multicodecCode:0};const{keyBytes:s,multicodecCode:i}=l5({multibaseKeyId:r});if(i===237){const o=yield an.keyConverter("Ed25519").bytesToPublicKey({publicKeyBytes:s}),a=yield Pr.convertPublicKeyToX25519({publicKey:o});n={keyBytes:yield an.keyConverter("Ed25519").publicKeyToBytes({publicKey:a}),multicodecCode:236}}return n})}static validateIdentifier(e){const{method:r,id:n}=e,[s]=e.uri.split(":",1);return s==="did"&&r==="key"&&Number("1")>0&&x1(n)==="String"&&n.startsWith("z")}}_o.methodName="key";class an{static jwkToMulticodec(e){return js(this,arguments,void 0,function*({jwk:r}){const n=[];r.crv&&(n.push(r.crv),r.d?n.push("private"):n.push("public"));const s=n.join(":"),i=an.JWK_TO_MULTICODEC[s];if(i===void 0)throw new Error(`Unsupported JWK to Multicodec conversion: '${s}'`);return{code:Lr.getCodeFromName({name:i}),name:i}})}static keyCompressor(e){const n={"P-256":Dr.compressPublicKey,secp256k1:Sr.compressPublicKey}[e];if(!n)throw new Ze(it.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static keyConverter(e){const n={Ed25519:Pr,"P-256":Dr,secp256k1:Sr,X25519:$l}[e];if(!n)throw new Ze(it.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static multicodecToJwk(e){return js(this,arguments,void 0,function*({code:r,name:n}){if(!(n?!r:r))throw new Error("Either 'name' or 'code' must be defined, but not both.");n=n===void 0?Lr.getNameFromCode({code:r}):n;const s=n,i=an.MULTICODEC_TO_JWK[s];if(i===void 0)throw new Error("Unsupported Multicodec to JWK conversion");return Object.assign({},i)})}static publicKeyToMultibaseId(e){return js(this,arguments,void 0,function*({publicKey:r}){var n;if(!(r!=null&&r.crv&&r.crv in Qne))throw new Ze(it.InvalidPublicKeyType,`Public key contains an unsupported key type: ${(n=r==null?void 0:r.crv)!==null&&n!==void 0?n:"undefined"}`);let s=yield an.keyConverter(r.crv).publicKeyToBytes({publicKey:r});/^(secp256k1|P-256|P-384|P-521)$/.test(r.crv)&&(s=yield an.keyCompressor(r.crv)({publicKeyBytes:s}));const{name:i}=yield an.jwkToMulticodec({jwk:r});return jI({keyBytes:s,multicodecName:i})})}}an.JWK_TO_MULTICODEC={"Ed25519:public":"ed25519-pub","Ed25519:private":"ed25519-priv","secp256k1:public":"secp256k1-pub","secp256k1:private":"secp256k1-priv","X25519:public":"x25519-pub","X25519:private":"x25519-priv"};an.MULTICODEC_PUBLIC_KEY_LENGTH={231:33,236:32,237:32};an.MULTICODEC_TO_JWK={"ed25519-pub":{crv:"Ed25519",kty:"OKP",x:""},"ed25519-priv":{crv:"Ed25519",kty:"OKP",x:"",d:""},"secp256k1-pub":{crv:"secp256k1",kty:"EC",x:"",y:""},"secp256k1-priv":{crv:"secp256k1",kty:"EC",x:"",y:"",d:""},"x25519-pub":{crv:"X25519",kty:"OKP",x:""},"x25519-priv":{crv:"X25519",kty:"OKP",x:"",d:""}};var eie=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((n=n.apply(t,e||[])).next())})};class k2 extends gy{static resolve(e,r){return eie(this,void 0,void 0,function*(){const n=Gt.parse(e);if(!n)return Object.assign(Object.assign({},ei),{didResolutionMetadata:{error:"invalidDid"}});if(n.method!==k2.methodName)return Object.assign(Object.assign({},ei),{didResolutionMetadata:{error:"methodNotSupported"}});let s=`https://${n.id.replace(/:/g,"/")}`;s=decodeURIComponent(s);const i=n.id.includes(":")?`${s}/did.json`:`${s}/.well-known/did.json`;try{const o=yield fetch(i);if(!o.ok)throw new Error("HTTP error status code returned");const a=yield o.json();return Object.assign(Object.assign({},ei),{didDocument:a})}catch{return Object.assign(Object.assign({},ei),{didResolutionMetadata:{error:"notFound"}})}})}}k2.methodName="web";const Im={aquafinance_capital:{uri:"did:dht:3fkz5ssfxbriwks3iy5nwys3q5kyx64ettp9wfn1yfekfkiguj1y",name:"AquaFinance Capital",description:"Provides exchanges with the Ghanaian Cedis: GHS to USDC, GHS to KES"},flowback_financial:{uri:"did:dht:zkp5gbsqgzn69b3y5dtt5nnpjtdq6sxyukpzo68npsf79bmtb9zy",name:"Flowback Financial",description:"Offers international rates with various currencies - USD to GBP, GBP to CAD."},vertex_liquid_assets:{uri:"did:dht:enwguxo8uzqexq14xupe4o9ymxw3nzeb9uug5ijkj9rhfbf1oy5y",name:"Vertex Liquid Assets",description:"Offers currency exchanges between African currencies - MAD to EGP, GHS to NGN."},titanium_trust:{uri:"did:dht:ozn5c51ruo7z63u1h748ug7rw5p1mq3853ytrd5gatu9a8mm8f1o",name:"Titanium Trust",description:"Provides offerings to exchange USD to African currencies - USD to GHS, USD to KES."}},Gse=()=>{const t=LI({balance:1e3,transactions:[],transactionsLoading:!0,pfiAllowlist:Object.keys(Im).map(S=>({pfiUri:Im[S].uri,pfiName:Im[S].name,pfiDescription:Im[S].description})),selectedTransaction:null,offering:null,payinCurrencies:[],payoutCurrencies:[],offerings:[],customerDid:null,customerCredentials:[]});if(typeof window<"u"){const S=localStorage.getItem("walletBalance");t.balance=parseFloat(S)||1e4}const e=async()=>{try{const O=Pf().currentUser;if(!O){console.log("User is not authenticated, redirecting to login..."),n.push("/login");return}const I=ad(ud,"donors",O.email),N=await rv(I);if(N.exists()){const j=N.data();j.balance?(t.balance=j.balance,console.log("Balance loaded from Firestore:",t.balance),localStorage.setItem("walletBalance",t.balance.toString())):(t.balance=1e4,console.log("No balance found, setting to default (1000)"))}else console.log("User document does not exist in Firestore."),t.balance=1e4,await Cf(I,{balance:t.balance})}catch(S){console.error("Error loading balance from Firestore:",S)}},r=Pf(),n=qI();VI(r,S=>{S||n.push("/login")});const s=async()=>{try{const S=[];for(const O of t.pfiAllowlist){const I=O.pfiUri,N=await Cn.getOfferings({pfiDid:I});S.push(...N)}t.offerings=S,x()}catch(S){console.error("Failed to fetch offerings:",S)}},i=async(S,O,I)=>{const N=G0.selectCredentials({vcJwts:t.customerCredentials,presentationDefinition:S.data.requiredClaims}),j=os.create({metadata:{from:t.customerDid.uri,to:S.metadata.from,protocol:"1.0"},data:{offeringId:S.id,payin:{amount:O.toString(),kind:S.data.payin.methods[0].kind,paymentDetails:{}},payout:{kind:S.data.payout.methods[0].kind,paymentDetails:I},claims:N}});try{j.verifyOfferingRequirements(S)}catch(F){console.log("Offering requirements not met",F)}await j.sign(t.customerDid),console.log("RFQ:",j);try{await Cn.createExchange(j)}catch(F){console.error("Failed to create exchange:",F)}},o=async S=>{try{const O=await Cn.getExchanges({pfiDid:S,did:t.customerDid});return d(O)}catch(O){console.error("Failed to fetch exchanges:",O)}},a=async(S,O,I)=>{const N=ff.create({metadata:{from:t.customerDid.uri,to:O,exchangeId:S},data:{reason:I}});await N.sign(t.customerDid);try{await Cn.submitClose(N)}catch(j){console.error("Failed to close exchange:",j)}},c=async(S,O)=>{const I=Uh.create({metadata:{from:t.customerDid.uri,to:O,exchangeId:S}});await I.sign(t.customerDid);try{return await Cn.submitOrder(I)}catch(N){console.error("Failed to submit order:",N)}},l=()=>{const S=async()=>{if(console.log("Polling exchanges again..."),!t.customerDid)return;const O=[];try{for(const I of t.pfiAllowlist){const N=await o(I.pfiUri);O.push(...N)}console.log("All exchanges:",O),A(O.reverse()),t.transactionsLoading=!1}catch(I){console.error("Failed to fetch exchanges:",I)}};S(),WI(S,5e3)},u=async()=>{try{const S=r.currentUser;if(!S){console.error("No user is logged in"),n.push("/login");return}const O=S.email,I=ad(ud,"donors",O),N=await rv(I);if(N.exists()){const j=N.data().did;t.customerDid=await vc.import({portableDid:JSON.parse(j)});const F=N.data().credentials;F&&(t.customerCredentials=JSON.parse(F),localStorage.setItem("customerCredentials",JSON.stringify(t.customerCredentials)))}else{t.customerDid=await vc.create({options:{publish:!0}});const j=await t.customerDid.export();await Cf(I,{email:O,did:JSON.stringify(j),credentials:JSON.stringify(t.customerCredentials),createdAt:new Date}),localStorage.setItem("customerDid",JSON.stringify(j))}}catch(S){console.error("Failed to initialize DID:",S)}},d=S=>S.map(I=>{var M,k,H,U,$,T;const N=I[I.length-1],j=I.find(z=>z.kind==="rfq"),F=I.find(z=>z.kind==="quote"),V=y(N),ee=(M=F==null?void 0:F.data.payin)==null?void 0:M.fee,G=(k=F==null?void 0:F.data.payin)==null?void 0:k.amount,Z=(H=j.privateData)==null?void 0:H.payout.paymentDetails;return{id:N.metadata.exchangeId,payinAmount:(ee?Number(G)+Number(ee):Number(G)).toString()||j.data.payinAmount,payinCurrency:((U=F.data.payin)==null?void 0:U.currencyCode)??null,payoutAmount:(($=F==null?void 0:F.data.payout)==null?void 0:$.amount)??null,payoutCurrency:(T=F.data.payout)==null?void 0:T.currencyCode,status:V,createdTime:j.createdAt,...N.kind==="quote"&&{expirationTime:F.data.expiresAt??null},from:"You",to:(Z==null?void 0:Z.address)||(Z==null?void 0:Z.accountNumber)+", "+(Z==null?void 0:Z.bankName)||(Z==null?void 0:Z.phoneNumber)+", "+(Z==null?void 0:Z.networkProvider)||"Unknown",pfiDid:j.metadata.to}}),h=async()=>{try{const O=Pf().currentUser;if(!O){console.error("No user is logged in"),n.push("/login");return}const I=ad(ud,"users",O.uid),N=await rv(I);if(N.exists()){const j=N.data();j.credentials?(t.customerCredentials=j.credentials,console.log("Credentials loaded from Firestore:",t.customerCredentials),localStorage.setItem("customerCredentials",JSON.stringify(t.customerCredentials))):console.log("No credentials found in Firestore.")}else console.log("User document does not exist in Firestore.")}catch(S){console.error("Error loading credentials from Firestore:",S)}},f=async S=>{t.customerCredentials.push(S),localStorage.setItem("customerCredentials",JSON.stringify(t.customerCredentials));const O=r.currentUser;if(O){const I=ad(ud,"donors",O.email);await Cf(I,{credentials:JSON.stringify(t.customerCredentials)},{merge:!0})}},p=S=>{const O=jo.parse({jwt:S}).decoded.payload.vc;return{title:O.type[O.type.length-1].replace(new RegExp("(?<!^)(?<![A-Z])[A-Z](?=[a-z])","g")," $&"),name:O.credentialSubject.name,countryCode:O.credentialSubject.countryOfResidence,issuanceDate:new Date(O.issuanceDate).toLocaleDateString(void 0,{dateStyle:"medium"})}};zI(()=>t.balance,async S=>{try{const I=Pf().currentUser;if(!I){console.log("User is not authenticated, redirecting to login..."),n.push("/login");return}const N=ad(ud,"users",I.uid);await Cf(N,{balance:S},{merge:!0}),console.log("Balance updated in Firestore:",S),typeof window<"u"&&localStorage.setItem("walletBalance",S.toString())}catch(O){console.error("Error updating balance in Firestore:",O)}});const y=S=>S instanceof ff?S.data.reason.toLowerCase().includes("complete")||S.data.reason.toLowerCase().includes("success")?"completed":S.data.reason.toLowerCase().includes("expired")?S.data.reason.toLowerCase():S.data.reason.toLowerCase().includes("cancelled")?"cancelled":"failed":S.kind,b=S=>{const O=y(S);switch(O){case"rfq":return"Requested";case"quote":return"Quoted";case"order":case"orderstatus":return"Pending";case"completed":return"Completed";case"expired":return"Expired";case"cancelled":return"Cancelled";case"failed":return"Failed";default:return O}},w=S=>{t.selectedTransaction=S},g=S=>{t.offering=S},v=async S=>{const O=parseFloat(S);if(!isNaN(O)&&O>0){t.balance-=O;try{const N=Pf().currentUser;if(!N){console.log("User is not authenticated, redirecting to login..."),n.push("/login");return}const j=ad(ud,"donors",N.email);await Cf(j,{balance:t.balance},{merge:!0}),console.log("Balance deducted and updated in Firestore:",t.balance),localStorage.setItem("walletBalance",t.balance.toString())}catch(I){console.error("Error deducting balance in Firestore:",I)}}},m=S=>{if(Math.abs(S)>=1)return S.toFixed(2);const O=Math.abs(S)>=.01?4:6;return parseFloat(S.toFixed(O)).toString()},_=S=>{const O=t.offerings.find(I=>I.id===S);return console.log("Selected offering:",O),O},x=()=>{const S=new Set,O=new Set;t.offerings.forEach(I=>{S.add(I.data.payin.currencyCode),O.add(I.data.payout.currencyCode)}),t.payinCurrencies=Array.from(S),t.payoutCurrencies=Array.from(O)},D=(S,O)=>t.offerings.filter(I=>I.data.payin.currencyCode===S&&I.data.payout.currencyCode===O),E=(S,O)=>{if(O.length===0||!S.data.requiredClaims)return!1;try{return G0.satisfiesPresentationDefinition({vcJwts:O,presentationDefinition:S.data.requiredClaims}),!0}catch{return!1}},A=S=>{t.transactions.map(I=>I.id);const O=[...t.transactions];S.forEach(I=>{const N=O.findIndex(j=>j.id===I.id);N>-1?O[N]=I:O.push(I)}),t.transactions=O};return HI(async()=>{console.log("Fetching offerings..."),s(),console.log("Initializing DID..."),await u(),console.log("Loading credentials..."),h(),console.log("Loading balance..."),await e()}),{state:t,selectTransaction:w,setOffering:g,deductAmount:v,formatAmount:m,fetchOfferings:s,filterOfferings:D,satisfiesOfferingRequirements:E,addCredential:f,renderCredential:p,createExchange:i,fetchExchanges:o,renderOrderStatus:b,addOrder:c,addClose:a,getOfferingById:_,pollExchanges:l}};export{Gse as u};
